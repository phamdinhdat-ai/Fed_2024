
Join ratio / total clients: 0.4 / 9
Finished creating server and clients.
Chosen Clients:  [2, 4, 8]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.094, 0.122, 0.116, 0.093, 0.095, 0.131, 0.114, 0.0]
AUC in each clients:  [242.113, 240.111, 164.162, 223.412, 259.558, 234.449, 230.275, 250.856, 0.0]
F1 Score:  [0.013, 0.014, 0.027, 0.021, 0.014, 0.016, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.083, 0.125, 0.1, 0.083, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.5623
Averaged Test Accurancy: 0.1047
Averaged Test AUC: 0.4915
Averaged Test F1_score: 0.0159
Averaged Test Recal score: 0.0821
Std Test Accurancy: 0.0365
Std Test AUC: 0.1553
Std Test F1: 0.0000
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.3195 | CT Loss: 3.2547| [0m
[91mEpoch: 0|  Loss:  8.0327 |Global loss: 8.0444| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3203 | CT Loss: 2.928| [0m
[91mEpoch: 1|  Loss:  7.6719 |Global loss: 7.6984| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3208 | CT Loss: 2.8734| [0m
[91mEpoch: 2|  Loss:  7.5866 |Global loss: 7.6257| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.3209 | CT Loss: 2.8641| [0m
[91mEpoch: 3|  Loss:  7.5447 |Global loss: 7.5967| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 2.3183 | CT Loss: 3.1997| [0m
[91mEpoch: 0|  Loss:  7.9983 |Global loss: 8.0038| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3188 | CT Loss: 2.9002| [0m
[91mEpoch: 1|  Loss:  7.6826 |Global loss: 7.6958| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3189 | CT Loss: 2.861| [0m
[91mEpoch: 2|  Loss:  7.6297 |Global loss: 7.6496| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.319 | CT Loss: 2.8394| [0m
[91mEpoch: 3|  Loss:  7.5913 |Global loss: 7.6191| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 2.3049 | CT Loss: 3.6845| [0m
[91mEpoch: 0|  Loss:  8.5876 |Global loss: 8.5876| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3055 | CT Loss: 3.626| [0m
[91mEpoch: 1|  Loss:  8.5089 |Global loss: 8.5182| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3061 | CT Loss: 3.5704| [0m
[91mEpoch: 2|  Loss:  8.4352 |Global loss: 8.4529| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.3066 | CT Loss: 3.5202| [0m
[91mEpoch: 3|  Loss:  8.3687 |Global loss: 8.3942| Local H loss: 0.0  | Global H loss: 0.0 [0m
------------------------- time cost ------------------------- 9.400995969772339
Chosen Clients:  [4, 1, 6]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.094, 0.226, 0.116, 0.283, 0.095, 0.131, 0.114, 0.0]
AUC in each clients:  [242.113, 240.111, 269.133, 223.412, 359.105, 234.449, 230.275, 250.856, 4.364]
F1 Score:  [0.013, 0.014, 0.142, 0.021, 0.154, 0.016, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.083, 0.24, 0.1, 0.258, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.5663
Averaged Test Accurancy: 0.1406
Averaged Test AUC: 0.5471
Averaged Test F1_score: 0.0442
Averaged Test Recal score: 0.1143
Std Test Accurancy: 0.0777
Std Test AUC: 0.1207
Std Test F1: 0.0001
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.3151 | CT Loss: 3.2369| [0m
[91mEpoch: 0|  Loss:  7.9623 |Global loss: 8.0319| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3141 | CT Loss: 2.9409| [0m
[91mEpoch: 1|  Loss:  7.6369 |Global loss: 7.7258| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3119 | CT Loss: 2.9091| [0m
[91mEpoch: 2|  Loss:  7.5593 |Global loss: 7.683| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.3083 | CT Loss: 2.8908| [0m
[91mEpoch: 3|  Loss:  7.4702 |Global loss: 7.6519| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 0|  NKD Loss: 2.3187 | CT Loss: 3.3698| [0m
[91mEpoch: 0|  Loss:  8.1665 |Global loss: 8.1708| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3176 | CT Loss: 2.9631| [0m
[91mEpoch: 1|  Loss:  7.7305 |Global loss: 7.756| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3163 | CT Loss: 2.9193| [0m
[91mEpoch: 2|  Loss:  7.6531 |Global loss: 7.7032| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.3144 | CT Loss: 2.9065| [0m
[91mEpoch: 3|  Loss:  7.5955 |Global loss: 7.6799| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 2.3198 | CT Loss: 3.3902| [0m
[91mEpoch: 0|  Loss:  8.1845 |Global loss: 8.1853| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3189 | CT Loss: 2.9757| [0m
[91mEpoch: 1|  Loss:  7.7377 |Global loss: 7.7592| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3181 | CT Loss: 2.929| [0m
[91mEpoch: 2|  Loss:  7.6587 |Global loss: 7.7002| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.3167 | CT Loss: 2.9105| [0m
[91mEpoch: 3|  Loss:  7.6027 |Global loss: 7.6685| Local H loss: 0.0  | Global H loss: 0.0 [0m
------------------------- time cost ------------------------- 12.258101463317871
Chosen Clients:  [4, 8, 1]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.268, 0.226, 0.116, 0.383, 0.095, 0.4, 0.114, 0.0]
AUC in each clients:  [242.113, 372.192, 269.133, 223.412, 417.665, 234.449, 357.942, 250.856, 4.364]
F1 Score:  [0.013, 0.135, 0.142, 0.021, 0.237, 0.016, 0.222, 0.017, 0.0]
Recall Score:  [0.083, 0.24, 0.24, 0.1, 0.32, 0.091, 0.292, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.6205
Averaged Test Accurancy: 0.2104
Averaged Test AUC: 0.6319
Averaged Test F1_score: 0.0892
Averaged Test Recal score: 0.1610
Std Test Accurancy: 0.1318
Std Test AUC: 0.1604
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.3051 | CT Loss: 3.0784| [0m
[91mEpoch: 0|  Loss:  7.5653 |Global loss: 7.8521| Local H loss: 0.0009  | Global H loss: 0.0012 [0m
[94mEpoch: 1|  NKD Loss: 2.3036 | CT Loss: 2.9188| [0m
[91mEpoch: 1|  Loss:  7.3118 |Global loss: 7.6811| Local H loss: 0.0017  | Global H loss: 0.0021 [0m
[94mEpoch: 2|  NKD Loss: 2.3058 | CT Loss: 2.9106| [0m
[91mEpoch: 2|  Loss:  7.2332 |Global loss: 7.665| Local H loss: 0.0025  | Global H loss: 0.0029 [0m
[94mEpoch: 3|  NKD Loss: 2.3056 | CT Loss: 2.8927| [0m
[91mEpoch: 3|  Loss:  7.1586 |Global loss: 7.6349| Local H loss: 0.0032  | Global H loss: 0.0036 [0m
[94mEpoch: 0|  NKD Loss: 2.2772 | CT Loss: 4.5563| [0m
[91mEpoch: 0|  Loss:  9.3601 |Global loss: 9.565| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.2755 | CT Loss: 3.9154| [0m
[91mEpoch: 1|  Loss:  8.6954 |Global loss: 8.9239| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.2757 | CT Loss: 4.1348| [0m
[91mEpoch: 2|  Loss:  8.9069 |Global loss: 9.1392| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2738 | CT Loss: 3.972| [0m
[91mEpoch: 3|  Loss:  8.7168 |Global loss: 8.9748| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 0|  NKD Loss: 2.3066 | CT Loss: 3.0259| [0m
[91mEpoch: 0|  Loss:  7.6365 |Global loss: 7.802| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 1|  NKD Loss: 2.3021 | CT Loss: 2.9172| [0m
[91mEpoch: 1|  Loss:  7.4136 |Global loss: 7.6777| Local H loss: 0.0005  | Global H loss: 0.0007 [0m
[94mEpoch: 2|  NKD Loss: 2.2984 | CT Loss: 2.9033| [0m
[91mEpoch: 2|  Loss:  7.2802 |Global loss: 7.6505| Local H loss: 0.0014  | Global H loss: 0.0018 [0m
[94mEpoch: 3|  NKD Loss: 2.2941 | CT Loss: 2.9036| [0m
[91mEpoch: 3|  Loss:  7.1711 |Global loss: 7.6328| Local H loss: 0.0025  | Global H loss: 0.0031 [0m
------------------------- time cost ------------------------- 9.61584186553955
Chosen Clients:  [1, 0, 2]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.409, 0.226, 0.116, 0.402, 0.095, 0.4, 0.114, 0.0]
AUC in each clients:  [242.113, 415.557, 269.133, 223.412, 447.719, 234.449, 357.942, 250.856, 6.545]
F1 Score:  [0.013, 0.213, 0.142, 0.021, 0.265, 0.016, 0.222, 0.017, 0.0]
Recall Score:  [0.083, 0.323, 0.24, 0.1, 0.326, 0.091, 0.292, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.5414
Averaged Test Accurancy: 0.2323
Averaged Test AUC: 0.6520
Averaged Test F1_score: 0.1010
Averaged Test Recal score: 0.1709
Std Test Accurancy: 0.1506
Std Test AUC: 0.1555
Std Test F1: 0.0002
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.2955 | CT Loss: 2.996| [0m
[91mEpoch: 0|  Loss:  7.1765 |Global loss: 7.7478| Local H loss: 0.0038  | Global H loss: 0.0046 [0m
[94mEpoch: 1|  NKD Loss: 2.2959 | CT Loss: 2.9101| [0m
[91mEpoch: 1|  Loss:  7.0128 |Global loss: 7.6459| Local H loss: 0.0045  | Global H loss: 0.0052 [0m
[94mEpoch: 2|  NKD Loss: 2.2962 | CT Loss: 2.8952| [0m
[91mEpoch: 2|  Loss:  6.9049 |Global loss: 7.6106| Local H loss: 0.0058  | Global H loss: 0.0063 [0m
[94mEpoch: 3|  NKD Loss: 2.2982 | CT Loss: 2.8944| [0m
[91mEpoch: 3|  Loss:  6.8317 |Global loss: 7.5807| Local H loss: 0.0069  | Global H loss: 0.0073 [0m
[94mEpoch: 0|  NKD Loss: 2.3214 | CT Loss: 3.2327| [0m
[91mEpoch: 0|  Loss:  8.0251 |Global loss: 8.0216| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3186 | CT Loss: 2.974| [0m
[91mEpoch: 1|  Loss:  7.7429 |Global loss: 7.7563| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.316 | CT Loss: 2.9347| [0m
[91mEpoch: 2|  Loss:  7.6806 |Global loss: 7.7118| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 2.3134 | CT Loss: 2.9144| [0m
[91mEpoch: 3|  Loss:  7.6364 |Global loss: 7.6861| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 2.316 | CT Loss: 3.2237| [0m
[91mEpoch: 0|  Loss:  7.8469 |Global loss: 7.9559| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.312 | CT Loss: 2.9849| [0m
[91mEpoch: 1|  Loss:  7.54 |Global loss: 7.6934| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3059 | CT Loss: 2.9603| [0m
[91mEpoch: 2|  Loss:  7.4291 |Global loss: 7.6429| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2962 | CT Loss: 2.9411| [0m
[91mEpoch: 3|  Loss:  7.281 |Global loss: 7.5914| Local H loss: 0.0007  | Global H loss: 0.0009 [0m
------------------------- time cost ------------------------- 10.924673080444336
Chosen Clients:  [5, 8, 4]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.265, 0.478, 0.629, 0.116, 0.402, 0.095, 0.4, 0.114, 0.0]
AUC in each clients:  [329.235, 437.704, 292.738, 223.412, 447.719, 234.449, 357.942, 250.856, 6.545]
F1 Score:  [0.143, 0.297, 0.45, 0.021, 0.265, 0.016, 0.222, 0.017, 0.0]
Recall Score:  [0.225, 0.391, 0.527, 0.1, 0.326, 0.091, 0.292, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.5148
Averaged Test Accurancy: 0.3013
Averaged Test AUC: 0.6874
Averaged Test F1_score: 0.1590
Averaged Test Recal score: 0.2261
Std Test Accurancy: 0.1993
Std Test AUC: 0.1610
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.327 | CT Loss: 3.3592| [0m
[91mEpoch: 0|  Loss:  8.1576 |Global loss: 8.1228| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 1|  NKD Loss: 2.3223 | CT Loss: 2.99| [0m
[91mEpoch: 1|  Loss:  7.759 |Global loss: 7.7424| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3183 | CT Loss: 2.9352| [0m
[91mEpoch: 2|  Loss:  7.6757 |Global loss: 7.6767| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.3142 | CT Loss: 2.9047| [0m
[91mEpoch: 3|  Loss:  7.613 |Global loss: 7.6344| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 0|  NKD Loss: 2.2499 | CT Loss: 4.4559| [0m
[91mEpoch: 0|  Loss:  9.168 |Global loss: 9.6026| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 1|  NKD Loss: 2.2504 | CT Loss: 3.9994| [0m
[91mEpoch: 1|  Loss:  8.6926 |Global loss: 9.1372| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 2|  NKD Loss: 2.2478 | CT Loss: 3.7837| [0m
[91mEpoch: 2|  Loss:  8.4617 |Global loss: 8.9333| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2492 | CT Loss: 3.7449| [0m
[91mEpoch: 3|  Loss:  8.4086 |Global loss: 8.8761| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 0|  NKD Loss: 2.3035 | CT Loss: 3.0655| [0m
[91mEpoch: 0|  Loss:  7.2896 |Global loss: 7.811| Local H loss: 0.0039  | Global H loss: 0.0042 [0m
[94mEpoch: 1|  NKD Loss: 2.2973 | CT Loss: 2.9159| [0m
[91mEpoch: 1|  Loss:  7.081 |Global loss: 7.6363| Local H loss: 0.0042  | Global H loss: 0.0045 [0m
[94mEpoch: 2|  NKD Loss: 2.2933 | CT Loss: 2.9035| [0m
[91mEpoch: 2|  Loss:  7.0157 |Global loss: 7.5981| Local H loss: 0.0048  | Global H loss: 0.0049 [0m
[94mEpoch: 3|  NKD Loss: 2.2801 | CT Loss: 2.8915| [0m
[91mEpoch: 3|  Loss:  6.9223 |Global loss: 7.537| Local H loss: 0.0053  | Global H loss: 0.0052 [0m
------------------------- time cost ------------------------- 9.454623222351074
Chosen Clients:  [2, 0, 4]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.265, 0.478, 0.629, 0.116, 0.537, 0.271, 0.4, 0.114, 0.0]
AUC in each clients:  [329.235, 437.704, 292.738, 223.412, 457.241, 350.306, 357.942, 250.856, 10.909]
F1 Score:  [0.143, 0.297, 0.45, 0.021, 0.381, 0.118, 0.222, 0.017, 0.0]
Recall Score:  [0.225, 0.391, 0.527, 0.1, 0.437, 0.2, 0.292, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.5267
Averaged Test Accurancy: 0.3428
Averaged Test AUC: 0.7220
Averaged Test F1_score: 0.1832
Averaged Test Recal score: 0.2506
Std Test Accurancy: 0.2014
Std Test AUC: 0.1493
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.2866 | CT Loss: 3.1056| [0m
[91mEpoch: 0|  Loss:  7.2796 |Global loss: 7.7487| Local H loss: 0.0019  | Global H loss: 0.0024 [0m
[94mEpoch: 1|  NKD Loss: 2.272 | CT Loss: 2.9813| [0m
[91mEpoch: 1|  Loss:  6.9933 |Global loss: 7.5735| Local H loss: 0.0034  | Global H loss: 0.004 [0m
[94mEpoch: 2|  NKD Loss: 2.2512 | CT Loss: 2.9577| [0m
[91mEpoch: 2|  Loss:  6.8164 |Global loss: 7.4869| Local H loss: 0.0052  | Global H loss: 0.0058 [0m
[94mEpoch: 3|  NKD Loss: 2.2247 | CT Loss: 2.9587| [0m
[91mEpoch: 3|  Loss:  6.6787 |Global loss: 7.405| Local H loss: 0.0073  | Global H loss: 0.0077 [0m
[94mEpoch: 0|  NKD Loss: 2.3079 | CT Loss: 3.0283| [0m
[91mEpoch: 0|  Loss:  7.7075 |Global loss: 7.7839| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3013 | CT Loss: 2.9206| [0m
[91mEpoch: 1|  Loss:  7.5355 |Global loss: 7.6588| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.2925 | CT Loss: 2.9094| [0m
[91mEpoch: 2|  Loss:  7.4312 |Global loss: 7.6264| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.2825 | CT Loss: 2.9058| [0m
[91mEpoch: 3|  Loss:  7.3234 |Global loss: 7.5971| Local H loss: 0.001  | Global H loss: 0.0012 [0m
[94mEpoch: 0|  NKD Loss: 2.2961 | CT Loss: 3.0715| [0m
[91mEpoch: 0|  Loss:  7.0697 |Global loss: 7.7936| Local H loss: 0.0065  | Global H loss: 0.0066 [0m
[94mEpoch: 1|  NKD Loss: 2.2872 | CT Loss: 2.9193| [0m
[91mEpoch: 1|  Loss:  6.8484 |Global loss: 7.6016| Local H loss: 0.0071  | Global H loss: 0.0071 [0m
[94mEpoch: 2|  NKD Loss: 2.2717 | CT Loss: 2.9077| [0m
[91mEpoch: 2|  Loss:  6.76 |Global loss: 7.5303| Local H loss: 0.008  | Global H loss: 0.0077 [0m
[94mEpoch: 3|  NKD Loss: 2.1899 | CT Loss: 2.9246| [0m
[91mEpoch: 3|  Loss:  6.6595 |Global loss: 7.3923| Local H loss: 0.0082  | Global H loss: 0.0074 [0m
------------------------- time cost ------------------------- 11.485032320022583
Chosen Clients:  [4, 7, 3]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.478, 0.662, 0.116, 0.605, 0.271, 0.4, 0.114, 0.0]
AUC in each clients:  [361.621, 437.704, 300.422, 223.412, 459.564, 350.306, 357.942, 250.856, 10.909]
F1 Score:  [0.269, 0.297, 0.492, 0.021, 0.446, 0.118, 0.222, 0.017, 0.0]
Recall Score:  [0.32, 0.391, 0.556, 0.1, 0.498, 0.2, 0.292, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.4279
Averaged Test Accurancy: 0.3684
Averaged Test AUC: 0.7333
Averaged Test F1_score: 0.2091
Averaged Test Recal score: 0.2711
Std Test Accurancy: 0.2156
Std Test AUC: 0.1501
Std Test F1: 0.0004
Std Test Recall: 0.0005
[94mEpoch: 0|  NKD Loss: 2.1858 | CT Loss: 3.0892| [0m
[91mEpoch: 0|  Loss:  6.7845 |Global loss: 7.6199| Local H loss: 0.0091  | Global H loss: 0.0083 [0m
[94mEpoch: 1|  NKD Loss: 1.869 | CT Loss: 2.9616| [0m
[91mEpoch: 1|  Loss:  6.3465 |Global loss: 7.1964| Local H loss: 0.0078  | Global H loss: 0.0075 [0m
[94mEpoch: 2|  NKD Loss: 1.7575 | CT Loss: 2.9445| [0m
[91mEpoch: 2|  Loss:  6.1913 |Global loss: 7.0679| Local H loss: 0.008  | Global H loss: 0.0079 [0m
[94mEpoch: 3|  NKD Loss: 1.7343 | CT Loss: 2.925| [0m
[91mEpoch: 3|  Loss:  6.0725 |Global loss: 6.9901| Local H loss: 0.0086  | Global H loss: 0.0087 [0m
[94mEpoch: 0|  NKD Loss: 2.3359 | CT Loss: 3.3133| [0m
[91mEpoch: 0|  Loss:  8.1256 |Global loss: 8.0758| Local H loss: 0.0009  | Global H loss: 0.0009 [0m
[94mEpoch: 1|  NKD Loss: 2.3184 | CT Loss: 2.9848| [0m
[91mEpoch: 1|  Loss:  7.7411 |Global loss: 7.7197| Local H loss: 0.0006  | Global H loss: 0.0006 [0m
[94mEpoch: 2|  NKD Loss: 2.3031 | CT Loss: 2.9459| [0m
[91mEpoch: 2|  Loss:  7.6344 |Global loss: 7.6392| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.256 | CT Loss: 2.9366| [0m
[91mEpoch: 3|  Loss:  7.486 |Global loss: 7.5458| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 0|  NKD Loss: 2.349 | CT Loss: 3.3211| [0m
[91mEpoch: 0|  Loss:  8.1382 |Global loss: 8.0489| Local H loss: 0.001  | Global H loss: 0.0009 [0m
[94mEpoch: 1|  NKD Loss: 2.3361 | CT Loss: 2.974| [0m
[91mEpoch: 1|  Loss:  7.7327 |Global loss: 7.6525| Local H loss: 0.0006  | Global H loss: 0.0006 [0m
[94mEpoch: 2|  NKD Loss: 2.3229 | CT Loss: 2.9296| [0m
[91mEpoch: 2|  Loss:  7.6161 |Global loss: 7.5631| Local H loss: 0.0004  | Global H loss: 0.0005 [0m
[94mEpoch: 3|  NKD Loss: 2.2916 | CT Loss: 2.9243| [0m
[91mEpoch: 3|  Loss:  7.4831 |Global loss: 7.491| Local H loss: 0.0003  | Global H loss: 0.0004 [0m
------------------------- time cost ------------------------- 12.463595628738403
Chosen Clients:  [3, 7, 1]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.478, 0.662, 0.197, 0.651, 0.271, 0.4, 0.254, 0.0]
AUC in each clients:  [361.621, 437.704, 300.422, 327.797, 464.435, 350.306, 357.942, 362.679, 10.909]
F1 Score:  [0.269, 0.297, 0.492, 0.082, 0.484, 0.118, 0.222, 0.074, 0.0]
Recall Score:  [0.32, 0.391, 0.556, 0.198, 0.547, 0.2, 0.292, 0.159, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.3827
Averaged Test Accurancy: 0.4033
Averaged Test AUC: 0.7922
Averaged Test F1_score: 0.2264
Averaged Test Recal score: 0.2959
Std Test Accurancy: 0.2018
Std Test AUC: 0.0746
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 1.9728 | CT Loss: 3.085| [0m
[91mEpoch: 0|  Loss:  7.1934 |Global loss: 7.3538| Local H loss: 0.0013  | Global H loss: 0.0016 [0m
[94mEpoch: 1|  NKD Loss: 1.7639 | CT Loss: 2.9606| [0m
[91mEpoch: 1|  Loss:  6.7331 |Global loss: 6.9935| Local H loss: 0.0011  | Global H loss: 0.0012 [0m
[94mEpoch: 2|  NKD Loss: 1.7452 | CT Loss: 2.9425| [0m
[91mEpoch: 2|  Loss:  6.5635 |Global loss: 6.9046| Local H loss: 0.0018  | Global H loss: 0.0018 [0m
[94mEpoch: 3|  NKD Loss: 1.7242 | CT Loss: 2.9413| [0m
[91mEpoch: 3|  Loss:  6.4251 |Global loss: 6.8341| Local H loss: 0.0029  | Global H loss: 0.003 [0m
[94mEpoch: 0|  NKD Loss: 1.9635 | CT Loss: 3.1527| [0m
[91mEpoch: 0|  Loss:  7.3324 |Global loss: 7.5447| Local H loss: 0.0012  | Global H loss: 0.0014 [0m
[94mEpoch: 1|  NKD Loss: 1.7899 | CT Loss: 2.985| [0m
[91mEpoch: 1|  Loss:  6.9297 |Global loss: 7.1828| Local H loss: 0.0013  | Global H loss: 0.0014 [0m
[94mEpoch: 2|  NKD Loss: 1.7571 | CT Loss: 2.9529| [0m
[91mEpoch: 2|  Loss:  6.7982 |Global loss: 7.0934| Local H loss: 0.0018  | Global H loss: 0.0018 [0m
[94mEpoch: 3|  NKD Loss: 1.734 | CT Loss: 2.9308| [0m
[91mEpoch: 3|  Loss:  6.6983 |Global loss: 7.0255| Local H loss: 0.0023  | Global H loss: 0.0021 [0m
[94mEpoch: 0|  NKD Loss: 1.9968 | CT Loss: 3.0737| [0m
[91mEpoch: 0|  Loss:  6.704 |Global loss: 7.421| Local H loss: 0.007  | Global H loss: 0.0062 [0m
[94mEpoch: 1|  NKD Loss: 1.7818 | CT Loss: 2.9306| [0m
[91mEpoch: 1|  Loss:  6.3031 |Global loss: 7.0336| Local H loss: 0.0066  | Global H loss: 0.0065 [0m
[94mEpoch: 2|  NKD Loss: 1.7503 | CT Loss: 2.9177| [0m
[91mEpoch: 2|  Loss:  6.1882 |Global loss: 6.9198| Local H loss: 0.007  | Global H loss: 0.0074 [0m
[94mEpoch: 3|  NKD Loss: 1.671 | CT Loss: 2.9316| [0m
[91mEpoch: 3|  Loss:  6.0479 |Global loss: 6.7546| Local H loss: 0.0081  | Global H loss: 0.0085 [0m
------------------------- time cost ------------------------- 12.198704957962036
Chosen Clients:  [5, 8, 2]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.662, 0.492, 0.651, 0.271, 0.4, 0.444, 0.0]
AUC in each clients:  [361.621, 434.894, 300.422, 376.588, 464.435, 350.306, 357.942, 391.995, 10.909]
F1 Score:  [0.269, 0.362, 0.492, 0.327, 0.484, 0.118, 0.222, 0.206, 0.0]
Recall Score:  [0.32, 0.424, 0.556, 0.433, 0.547, 0.2, 0.292, 0.312, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.1282
Averaged Test Accurancy: 0.4683
Averaged Test AUC: 0.8122
Averaged Test F1_score: 0.2756
Averaged Test Recal score: 0.3427
Std Test Accurancy: 0.1907
Std Test AUC: 0.0626
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.3131 | CT Loss: 3.1337| [0m
[91mEpoch: 0|  Loss:  7.7925 |Global loss: 7.7849| Local H loss: 0.0032  | Global H loss: 0.0036 [0m
[94mEpoch: 1|  NKD Loss: 2.0952 | CT Loss: 2.9681| [0m
[91mEpoch: 1|  Loss:  7.2838 |Global loss: 7.3112| Local H loss: 0.0026  | Global H loss: 0.0033 [0m
[94mEpoch: 2|  NKD Loss: 1.7689 | CT Loss: 2.9723| [0m
[91mEpoch: 2|  Loss:  6.8748 |Global loss: 7.0718| Local H loss: 0.0017  | Global H loss: 0.0021 [0m
[94mEpoch: 3|  NKD Loss: 1.6856 | CT Loss: 2.9524| [0m
[91mEpoch: 3|  Loss:  6.6701 |Global loss: 6.9232| Local H loss: 0.0017  | Global H loss: 0.0019 [0m
[94mEpoch: 0|  NKD Loss: 2.149 | CT Loss: 4.5933| [0m
[91mEpoch: 0|  Loss:  9.1567 |Global loss: 11.2847| Local H loss: 0.0093  | Global H loss: 0.0096 [0m
[94mEpoch: 1|  NKD Loss: 2.221 | CT Loss: 4.8584| [0m
[91mEpoch: 1|  Loss:  9.468 |Global loss: 10.3141| Local H loss: 0.0014  | Global H loss: 0.0013 [0m
[94mEpoch: 2|  NKD Loss: 2.2241 | CT Loss: 4.3233| [0m
[91mEpoch: 2|  Loss:  8.9438 |Global loss: 9.7394| Local H loss: 0.0012  | Global H loss: 0.0011 [0m
[94mEpoch: 3|  NKD Loss: 2.2254 | CT Loss: 4.1596| [0m
[91mEpoch: 3|  Loss:  8.7736 |Global loss: 9.5465| Local H loss: 0.001  | Global H loss: 0.001 [0m
[94mEpoch: 0|  NKD Loss: 1.837 | CT Loss: 3.1626| [0m
[91mEpoch: 0|  Loss:  6.4405 |Global loss: 7.2431| Local H loss: 0.0107  | Global H loss: 0.0098 [0m
[94mEpoch: 1|  NKD Loss: 1.6058 | CT Loss: 3.0419| [0m
[91mEpoch: 1|  Loss:  6.0489 |Global loss: 6.7308| Local H loss: 0.0083  | Global H loss: 0.0076 [0m
[94mEpoch: 2|  NKD Loss: 1.5488 | CT Loss: 2.9953| [0m
[91mEpoch: 2|  Loss:  5.8421 |Global loss: 6.5984| Local H loss: 0.0093  | Global H loss: 0.0089 [0m
[94mEpoch: 3|  NKD Loss: 1.5135 | CT Loss: 2.9919| [0m
[91mEpoch: 3|  Loss:  5.6971 |Global loss: 6.5182| Local H loss: 0.011  | Global H loss: 0.0104 [0m
------------------------- time cost ------------------------- 8.61187195777893
Chosen Clients:  [6, 5, 4]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.697, 0.492, 0.651, 0.362, 0.4, 0.444, 0.0]
AUC in each clients:  [361.621, 434.894, 303.909, 376.588, 464.435, 397.643, 357.942, 391.995, 10.939]
F1 Score:  [0.269, 0.362, 0.517, 0.327, 0.484, 0.165, 0.222, 0.206, 0.0]
Recall Score:  [0.32, 0.424, 0.582, 0.433, 0.547, 0.268, 0.292, 0.312, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.0312
Averaged Test Accurancy: 0.4832
Averaged Test AUC: 0.8258
Averaged Test F1_score: 0.2836
Averaged Test Recal score: 0.3531
Std Test Accurancy: 0.1900
Std Test AUC: 0.0537
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.3602 | CT Loss: 3.1227| [0m
[91mEpoch: 0|  Loss:  7.7998 |Global loss: 7.6832| Local H loss: 0.0036  | Global H loss: 0.0042 [0m
[94mEpoch: 1|  NKD Loss: 2.0417 | CT Loss: 2.9654| [0m
[91mEpoch: 1|  Loss:  7.1412 |Global loss: 7.1403| Local H loss: 0.0028  | Global H loss: 0.0044 [0m
[94mEpoch: 2|  NKD Loss: 1.756 | CT Loss: 2.9456| [0m
[91mEpoch: 2|  Loss:  6.7028 |Global loss: 6.855| Local H loss: 0.0015  | Global H loss: 0.0019 [0m
[94mEpoch: 3|  NKD Loss: 1.7437 | CT Loss: 2.9391| [0m
[91mEpoch: 3|  Loss:  6.5698 |Global loss: 6.7723| Local H loss: 0.0024  | Global H loss: 0.0025 [0m
[94mEpoch: 0|  NKD Loss: 1.8171 | CT Loss: 3.1505| [0m
[91mEpoch: 0|  Loss:  6.904 |Global loss: 7.43| Local H loss: 0.0037  | Global H loss: 0.0041 [0m
[94mEpoch: 1|  NKD Loss: 1.6813 | CT Loss: 2.9671| [0m
[91mEpoch: 1|  Loss:  6.5124 |Global loss: 6.9422| Local H loss: 0.0027  | Global H loss: 0.0026 [0m
[94mEpoch: 2|  NKD Loss: 1.6418 | CT Loss: 2.9544| [0m
[91mEpoch: 2|  Loss:  6.3455 |Global loss: 6.7628| Local H loss: 0.0029  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 1.4654 | CT Loss: 2.9726| [0m
[91mEpoch: 3|  Loss:  6.0873 |Global loss: 6.5724| Local H loss: 0.0038  | Global H loss: 0.004 [0m
[94mEpoch: 0|  NKD Loss: 1.8022 | CT Loss: 3.1456| [0m
[91mEpoch: 0|  Loss:  6.3392 |Global loss: 7.3893| Local H loss: 0.0101  | Global H loss: 0.0106 [0m
[94mEpoch: 1|  NKD Loss: 1.7074 | CT Loss: 2.9595| [0m
[91mEpoch: 1|  Loss:  5.9791 |Global loss: 6.9527| Local H loss: 0.0098  | Global H loss: 0.0102 [0m
[94mEpoch: 2|  NKD Loss: 1.5426 | CT Loss: 2.9609| [0m
[91mEpoch: 2|  Loss:  5.7764 |Global loss: 6.7732| Local H loss: 0.0111  | Global H loss: 0.0116 [0m
[94mEpoch: 3|  NKD Loss: 1.2578 | CT Loss: 2.951| [0m
[91mEpoch: 3|  Loss:  5.494 |Global loss: 6.6462| Local H loss: 0.0119  | Global H loss: 0.0128 [0m
------------------------- time cost ------------------------- 12.002610206604004
Chosen Clients:  [5, 6, 2]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.697, 0.492, 0.626, 0.528, 0.516, 0.444, 0.0]
AUC in each clients:  [361.621, 434.894, 303.909, 376.588, 471.878, 418.11, 381.892, 391.995, 10.939]
F1 Score:  [0.269, 0.362, 0.517, 0.327, 0.475, 0.324, 0.27, 0.206, 0.0]
Recall Score:  [0.32, 0.424, 0.582, 0.433, 0.524, 0.405, 0.361, 0.312, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.3742
Averaged Test Accurancy: 0.5149
Averaged Test AUC: 0.8396
Averaged Test F1_score: 0.3056
Averaged Test Recal score: 0.3734
Std Test Accurancy: 0.1873
Std Test AUC: 0.0527
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 1.6679 | CT Loss: 3.1643| [0m
[91mEpoch: 0|  Loss:  6.4307 |Global loss: 7.254| Local H loss: 0.0076  | Global H loss: 0.0078 [0m
[94mEpoch: 1|  NKD Loss: 1.2721 | CT Loss: 3.003| [0m
[91mEpoch: 1|  Loss:  5.824 |Global loss: 6.61| Local H loss: 0.0064  | Global H loss: 0.0072 [0m
[94mEpoch: 2|  NKD Loss: 1.1299 | CT Loss: 2.964| [0m
[91mEpoch: 2|  Loss:  5.6063 |Global loss: 6.3903| Local H loss: 0.0067  | Global H loss: 0.0075 [0m
[94mEpoch: 3|  NKD Loss: 1.1008 | CT Loss: 2.9558| [0m
[91mEpoch: 3|  Loss:  5.5037 |Global loss: 6.2995| Local H loss: 0.0075  | Global H loss: 0.0084 [0m
[94mEpoch: 0|  NKD Loss: 1.731 | CT Loss: 3.1268| [0m
[91mEpoch: 0|  Loss:  6.6448 |Global loss: 7.0795| Local H loss: 0.0053  | Global H loss: 0.0055 [0m
[94mEpoch: 1|  NKD Loss: 1.3918 | CT Loss: 3.0086| [0m
[91mEpoch: 1|  Loss:  6.0864 |Global loss: 6.5227| Local H loss: 0.0054  | Global H loss: 0.0053 [0m
[94mEpoch: 2|  NKD Loss: 1.1061 | CT Loss: 2.9928| [0m
[91mEpoch: 2|  Loss:  5.7534 |Global loss: 6.3046| Local H loss: 0.0053  | Global H loss: 0.0052 [0m
[94mEpoch: 3|  NKD Loss: 1.0492 | CT Loss: 2.9623| [0m
[91mEpoch: 3|  Loss:  5.5647 |Global loss: 6.1493| Local H loss: 0.0058  | Global H loss: 0.0055 [0m
[94mEpoch: 0|  NKD Loss: 1.5762 | CT Loss: 3.2127| [0m
[91mEpoch: 0|  Loss:  5.9133 |Global loss: 6.9842| Local H loss: 0.0154  | Global H loss: 0.0155 [0m
[94mEpoch: 1|  NKD Loss: 1.39 | CT Loss: 3.0337| [0m
[91mEpoch: 1|  Loss:  5.4833 |Global loss: 6.4083| Local H loss: 0.0149  | Global H loss: 0.0141 [0m
[94mEpoch: 2|  NKD Loss: 1.1448 | CT Loss: 3.0169| [0m
[91mEpoch: 2|  Loss:  5.1967 |Global loss: 6.2271| Local H loss: 0.0159  | Global H loss: 0.0151 [0m
[94mEpoch: 3|  NKD Loss: 1.0634 | CT Loss: 3.0134| [0m
[91mEpoch: 3|  Loss:  5.0836 |Global loss: 6.1447| Local H loss: 0.017  | Global H loss: 0.0164 [0m
------------------------- time cost ------------------------- 10.623867273330688
Chosen Clients:  [6, 8, 2]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.715, 0.492, 0.626, 0.565, 0.571, 0.444, 0.0]
AUC in each clients:  [361.621, 434.894, 310.758, 376.588, 471.878, 432.119, 396.65, 391.995, 10.939]
F1 Score:  [0.269, 0.362, 0.539, 0.327, 0.475, 0.363, 0.327, 0.206, 0.0]
Recall Score:  [0.32, 0.424, 0.597, 0.433, 0.524, 0.44, 0.399, 0.312, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.3446
Averaged Test Accurancy: 0.5280
Averaged Test AUC: 0.8491
Averaged Test F1_score: 0.3187
Averaged Test Recal score: 0.3832
Std Test Accurancy: 0.1937
Std Test AUC: 0.0574
Std Test F1: 0.0004
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 1.4157 | CT Loss: 3.1774| [0m
[91mEpoch: 0|  Loss:  6.0418 |Global loss: 6.9297| Local H loss: 0.0104  | Global H loss: 0.0106 [0m
[94mEpoch: 1|  NKD Loss: 1.075 | CT Loss: 2.9836| [0m
[91mEpoch: 1|  Loss:  5.4608 |Global loss: 6.2514| Local H loss: 0.0085  | Global H loss: 0.0087 [0m
[94mEpoch: 2|  NKD Loss: 0.9977 | CT Loss: 2.9548| [0m
[91mEpoch: 2|  Loss:  5.2945 |Global loss: 6.0692| Local H loss: 0.0086  | Global H loss: 0.0083 [0m
[94mEpoch: 3|  NKD Loss: 0.9731 | CT Loss: 2.9524| [0m
[91mEpoch: 3|  Loss:  5.1944 |Global loss: 6.0157| Local H loss: 0.0095  | Global H loss: 0.0094 [0m
[94mEpoch: 0|  NKD Loss: 2.1231 | CT Loss: 4.5594| [0m
[91mEpoch: 0|  Loss:  9.0658 |Global loss: 12.161| Local H loss: 0.0109  | Global H loss: 0.0135 [0m
[94mEpoch: 1|  NKD Loss: 2.205 | CT Loss: 4.4272| [0m
[91mEpoch: 1|  Loss:  8.9977 |Global loss: 14.3033| Local H loss: 0.0157  | Global H loss: 0.0275 [0m
[94mEpoch: 2|  NKD Loss: 2.1891 | CT Loss: 4.1909| [0m
[91mEpoch: 2|  Loss:  8.7414 |Global loss: 12.2959| Local H loss: 0.0151  | Global H loss: 0.0204 [0m
[94mEpoch: 3|  NKD Loss: 2.1812 | CT Loss: 4.1987| [0m
[91mEpoch: 3|  Loss:  8.7276 |Global loss: 11.0913| Local H loss: 0.012  | Global H loss: 0.0132 [0m
[94mEpoch: 0|  NKD Loss: 1.1851 | CT Loss: 3.283| [0m
[91mEpoch: 0|  Loss:  5.4431 |Global loss: 6.9413| Local H loss: 0.0193  | Global H loss: 0.0215 [0m
[94mEpoch: 1|  NKD Loss: 0.9855 | CT Loss: 3.0411| [0m
[91mEpoch: 1|  Loss:  4.9974 |Global loss: 6.2092| Local H loss: 0.0176  | Global H loss: 0.018 [0m
[94mEpoch: 2|  NKD Loss: 0.9535 | CT Loss: 3.0246| [0m
[91mEpoch: 2|  Loss:  4.9322 |Global loss: 6.1521| Local H loss: 0.0176  | Global H loss: 0.0177 [0m
[94mEpoch: 3|  NKD Loss: 0.8993 | CT Loss: 3.0101| [0m
[91mEpoch: 3|  Loss:  4.8073 |Global loss: 6.0339| Local H loss: 0.0192  | Global H loss: 0.0195 [0m
------------------------- time cost ------------------------- 8.43578052520752
Chosen Clients:  [5, 8, 3]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.751, 0.492, 0.626, 0.565, 0.653, 0.444, 1.0]
AUC in each clients:  [361.621, 434.894, 312.923, 376.588, 471.878, 432.119, 402.573, 391.995, 12.0]
F1 Score:  [0.269, 0.362, 0.615, 0.327, 0.475, 0.363, 0.395, 0.206, 1.0]
Recall Score:  [0.32, 0.424, 0.645, 0.433, 0.524, 0.44, 0.462, 0.312, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.3051
Averaged Test Accurancy: 0.5442
Averaged Test AUC: 0.8515
Averaged Test F1_score: 0.4458
Averaged Test Recal score: 0.5067
Std Test Accurancy: 0.1783
Std Test AUC: 0.0724
Std Test F1: 0.0259
Std Test Recall: 0.0259
[94mEpoch: 0|  NKD Loss: 1.524 | CT Loss: 3.1672| [0m
[91mEpoch: 0|  Loss:  6.1147 |Global loss: 7.2325| Local H loss: 0.0127  | Global H loss: 0.0139 [0m
[94mEpoch: 1|  NKD Loss: 1.1678 | CT Loss: 2.9799| [0m
[91mEpoch: 1|  Loss:  5.5584 |Global loss: 6.5299| Local H loss: 0.0088  | Global H loss: 0.0101 [0m
[94mEpoch: 2|  NKD Loss: 1.1051 | CT Loss: 2.9547| [0m
[91mEpoch: 2|  Loss:  5.3897 |Global loss: 6.3605| Local H loss: 0.0093  | Global H loss: 0.0106 [0m
[94mEpoch: 3|  NKD Loss: 1.082 | CT Loss: 2.9487| [0m
[91mEpoch: 3|  Loss:  5.3189 |Global loss: 6.2882| Local H loss: 0.01  | Global H loss: 0.0111 [0m
[94mEpoch: 0|  NKD Loss: 2.1197 | CT Loss: 4.5455| [0m
[91mEpoch: 0|  Loss:  9.0024 |Global loss: 12.5887| Local H loss: 0.0116  | Global H loss: 0.0157 [0m
[94mEpoch: 1|  NKD Loss: 2.1702 | CT Loss: 4.3702| [0m
[91mEpoch: 1|  Loss:  8.8601 |Global loss: 12.9563| Local H loss: 0.0149  | Global H loss: 0.0217 [0m
[94mEpoch: 2|  NKD Loss: 2.1697 | CT Loss: 4.0265| [0m
[91mEpoch: 2|  Loss:  8.5041 |Global loss: 10.7872| Local H loss: 0.0099  | Global H loss: 0.0109 [0m
[94mEpoch: 3|  NKD Loss: 2.179 | CT Loss: 4.1441| [0m
[91mEpoch: 3|  Loss:  8.6113 |Global loss: 9.954| Local H loss: 0.0023  | Global H loss: 0.0024 [0m
[94mEpoch: 0|  NKD Loss: 1.6468 | CT Loss: 3.2169| [0m
[91mEpoch: 0|  Loss:  6.4607 |Global loss: 7.1434| Local H loss: 0.0114  | Global H loss: 0.0141 [0m
[94mEpoch: 1|  NKD Loss: 1.1489 | CT Loss: 3.0402| [0m
[91mEpoch: 1|  Loss:  5.6768 |Global loss: 6.2987| Local H loss: 0.0082  | Global H loss: 0.0095 [0m
[94mEpoch: 2|  NKD Loss: 1.0714 | CT Loss: 3.0023| [0m
[91mEpoch: 2|  Loss:  5.4667 |Global loss: 6.1377| Local H loss: 0.0093  | Global H loss: 0.01 [0m
[94mEpoch: 3|  NKD Loss: 1.0573 | CT Loss: 2.9788| [0m
[91mEpoch: 3|  Loss:  5.3576 |Global loss: 6.0367| Local H loss: 0.0105  | Global H loss: 0.0107 [0m
------------------------- time cost ------------------------- 9.512866258621216
Chosen Clients:  [3, 0, 2]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.366, 0.51, 0.751, 0.541, 0.626, 0.623, 0.653, 0.444, 1.0]
AUC in each clients:  [361.621, 434.894, 312.923, 394.839, 471.878, 437.874, 402.573, 391.995, 12.0]
F1 Score:  [0.269, 0.362, 0.615, 0.406, 0.475, 0.483, 0.395, 0.206, 1.0]
Recall Score:  [0.32, 0.424, 0.645, 0.475, 0.524, 0.512, 0.462, 0.312, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 10.8186
Averaged Test Accurancy: 0.5575
Averaged Test AUC: 0.8579
Averaged Test F1_score: 0.4679
Averaged Test Recal score: 0.5193
Std Test Accurancy: 0.1751
Std Test AUC: 0.0723
Std Test F1: 0.0259
Std Test Recall: 0.0259
[94mEpoch: 0|  NKD Loss: 1.5096 | CT Loss: 3.2204| [0m
[91mEpoch: 0|  Loss:  6.013 |Global loss: 6.9454| Local H loss: 0.0153  | Global H loss: 0.0157 [0m
[94mEpoch: 1|  NKD Loss: 1.1328 | CT Loss: 3.0217| [0m
[91mEpoch: 1|  Loss:  5.4106 |Global loss: 6.2339| Local H loss: 0.0126  | Global H loss: 0.0134 [0m
[94mEpoch: 2|  NKD Loss: 1.0566 | CT Loss: 2.9796| [0m
[91mEpoch: 2|  Loss:  5.2284 |Global loss: 6.0185| Local H loss: 0.013  | Global H loss: 0.0123 [0m
[94mEpoch: 3|  NKD Loss: 1.0315 | CT Loss: 2.9662| [0m
[91mEpoch: 3|  Loss:  5.1633 |Global loss: 5.9528| Local H loss: 0.0132  | Global H loss: 0.0128 [0m
[94mEpoch: 0|  NKD Loss: 1.9898 | CT Loss: 3.1945| [0m
[91mEpoch: 0|  Loss:  7.28 |Global loss: 7.6639| Local H loss: 0.007  | Global H loss: 0.0081 [0m
[94mEpoch: 1|  NKD Loss: 1.7925 | CT Loss: 2.9888| [0m
[91mEpoch: 1|  Loss:  6.8279 |Global loss: 7.0812| Local H loss: 0.0048  | Global H loss: 0.0055 [0m
[94mEpoch: 2|  NKD Loss: 1.5515 | CT Loss: 2.9728| [0m
[91mEpoch: 2|  Loss:  6.4725 |Global loss: 6.8294| Local H loss: 0.0036  | Global H loss: 0.0046 [0m
[94mEpoch: 3|  NKD Loss: 1.359 | CT Loss: 2.9603| [0m
[91mEpoch: 3|  Loss:  6.2171 |Global loss: 6.7074| Local H loss: 0.0031  | Global H loss: 0.0038 [0m
[94mEpoch: 0|  NKD Loss: 1.2182 | CT Loss: 3.2906| [0m
[91mEpoch: 0|  Loss:  5.3621 |Global loss: 6.8478| Local H loss: 0.0243  | Global H loss: 0.0256 [0m
[94mEpoch: 1|  NKD Loss: 0.9198 | CT Loss: 3.0615| [0m
[91mEpoch: 1|  Loss:  4.8245 |Global loss: 6.1446| Local H loss: 0.0203  | Global H loss: 0.0211 [0m
[94mEpoch: 2|  NKD Loss: 0.9372 | CT Loss: 3.0467| [0m
[91mEpoch: 2|  Loss:  4.8042 |Global loss: 6.1031| Local H loss: 0.0221  | Global H loss: 0.0222 [0m
[94mEpoch: 3|  NKD Loss: 0.8768 | CT Loss: 3.0154| [0m
[91mEpoch: 3|  Loss:  4.6998 |Global loss: 5.9133| Local H loss: 0.0229  | Global H loss: 0.022 [0m
------------------------- time cost ------------------------- 10.859232664108276
Chosen Clients:  [5, 7, 0]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.346, 0.51, 0.763, 0.546, 0.626, 0.623, 0.653, 0.444, 1.0]
AUC in each clients:  [397.368, 434.894, 314.752, 397.485, 471.878, 437.874, 402.573, 391.995, 12.0]
F1 Score:  [0.183, 0.362, 0.622, 0.413, 0.475, 0.483, 0.395, 0.206, 1.0]
Recall Score:  [0.296, 0.424, 0.657, 0.481, 0.524, 0.512, 0.462, 0.312, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.3962
Averaged Test Accurancy: 0.5565
Averaged Test AUC: 0.8686
Averaged Test F1_score: 0.4599
Averaged Test Recal score: 0.5187
Std Test Accurancy: 0.1793
Std Test AUC: 0.0610
Std Test F1: 0.0259
Std Test Recall: 0.0259
[94mEpoch: 0|  NKD Loss: 1.4789 | CT Loss: 3.2699| [0m
[91mEpoch: 0|  Loss:  6.0185 |Global loss: 7.2498| Local H loss: 0.0143  | Global H loss: 0.0153 [0m
[94mEpoch: 1|  NKD Loss: 1.1287 | CT Loss: 3.0594| [0m
[91mEpoch: 1|  Loss:  5.4701 |Global loss: 6.5337| Local H loss: 0.0105  | Global H loss: 0.0118 [0m
[94mEpoch: 2|  NKD Loss: 1.0859 | CT Loss: 3.0237| [0m
[91mEpoch: 2|  Loss:  5.318 |Global loss: 6.351| Local H loss: 0.0117  | Global H loss: 0.013 [0m
[94mEpoch: 3|  NKD Loss: 1.0743 | CT Loss: 2.9979| [0m
[91mEpoch: 3|  Loss:  5.2285 |Global loss: 6.2552| Local H loss: 0.0126  | Global H loss: 0.0135 [0m
[94mEpoch: 0|  NKD Loss: 1.8385 | CT Loss: 3.3053| [0m
[91mEpoch: 0|  Loss:  7.0957 |Global loss: 7.6404| Local H loss: 0.0069  | Global H loss: 0.0086 [0m
[94mEpoch: 1|  NKD Loss: 1.6841 | CT Loss: 3.0705| [0m
[91mEpoch: 1|  Loss:  6.6104 |Global loss: 7.077| Local H loss: 0.0063  | Global H loss: 0.0079 [0m
[94mEpoch: 2|  NKD Loss: 1.4419 | CT Loss: 3.0388| [0m
[91mEpoch: 2|  Loss:  6.2951 |Global loss: 6.797| Local H loss: 0.0057  | Global H loss: 0.0071 [0m
[94mEpoch: 3|  NKD Loss: 1.2746 | CT Loss: 3.0145| [0m
[91mEpoch: 3|  Loss:  6.0533 |Global loss: 6.6321| Local H loss: 0.0061  | Global H loss: 0.007 [0m
[94mEpoch: 0|  NKD Loss: 1.4373 | CT Loss: 3.1343| [0m
[91mEpoch: 0|  Loss:  6.3898 |Global loss: 7.2192| Local H loss: 0.0051  | Global H loss: 0.0059 [0m
[94mEpoch: 1|  NKD Loss: 1.3188 | CT Loss: 2.9752| [0m
[91mEpoch: 1|  Loss:  6.0383 |Global loss: 6.7562| Local H loss: 0.0039  | Global H loss: 0.0045 [0m
[94mEpoch: 2|  NKD Loss: 1.275 | CT Loss: 2.9615| [0m
[91mEpoch: 2|  Loss:  5.8909 |Global loss: 6.6293| Local H loss: 0.0042  | Global H loss: 0.005 [0m
[94mEpoch: 3|  NKD Loss: 1.2656 | CT Loss: 2.9539| [0m
[91mEpoch: 3|  Loss:  5.7928 |Global loss: 6.5971| Local H loss: 0.0049  | Global H loss: 0.0062 [0m
------------------------- time cost ------------------------- 11.942490339279175
Chosen Clients:  [0, 7, 6]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.482, 0.51, 0.763, 0.546, 0.626, 0.681, 0.653, 0.442, 1.0]
AUC in each clients:  [413.414, 434.894, 314.752, 397.485, 471.878, 441.636, 402.573, 422.062, 12.0]
F1 Score:  [0.333, 0.362, 0.622, 0.413, 0.475, 0.519, 0.395, 0.274, 1.0]
Recall Score:  [0.415, 0.424, 0.657, 0.481, 0.524, 0.564, 0.462, 0.34, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.3797
Averaged Test Accurancy: 0.5812
Averaged Test AUC: 0.8819
Averaged Test F1_score: 0.4881
Averaged Test Recal score: 0.5408
Std Test Accurancy: 0.1620
Std Test AUC: 0.0470
Std Test F1: 0.0259
Std Test Recall: 0.0259
[94mEpoch: 0|  NKD Loss: 1.499 | CT Loss: 3.1862| [0m
[91mEpoch: 0|  Loss:  6.2144 |Global loss: 7.2582| Local H loss: 0.0091  | Global H loss: 0.0105 [0m
[94mEpoch: 1|  NKD Loss: 1.2787 | CT Loss: 2.9986| [0m
[91mEpoch: 1|  Loss:  5.7799 |Global loss: 6.7362| Local H loss: 0.0066  | Global H loss: 0.0085 [0m
[94mEpoch: 2|  NKD Loss: 1.2407 | CT Loss: 2.9716| [0m
[91mEpoch: 2|  Loss:  5.6331 |Global loss: 6.5927| Local H loss: 0.0072  | Global H loss: 0.0091 [0m
[94mEpoch: 3|  NKD Loss: 1.2472 | CT Loss: 2.9713| [0m
[91mEpoch: 3|  Loss:  5.5995 |Global loss: 6.5849| Local H loss: 0.008  | Global H loss: 0.0102 [0m
[94mEpoch: 0|  NKD Loss: 1.4998 | CT Loss: 3.3066| [0m
[91mEpoch: 0|  Loss:  6.5199 |Global loss: 7.4851| Local H loss: 0.0086  | Global H loss: 0.0101 [0m
[94mEpoch: 1|  NKD Loss: 1.3521 | CT Loss: 3.0703| [0m
[91mEpoch: 1|  Loss:  6.0714 |Global loss: 6.9414| Local H loss: 0.0083  | Global H loss: 0.0097 [0m
[94mEpoch: 2|  NKD Loss: 1.2561 | CT Loss: 3.0395| [0m
[91mEpoch: 2|  Loss:  5.8966 |Global loss: 6.7529| Local H loss: 0.0083  | Global H loss: 0.0092 [0m
[94mEpoch: 3|  NKD Loss: 1.2187 | CT Loss: 3.0192| [0m
[91mEpoch: 3|  Loss:  5.7704 |Global loss: 6.5869| Local H loss: 0.0085  | Global H loss: 0.0089 [0m
[94mEpoch: 0|  NKD Loss: 1.4653 | CT Loss: 3.3878| [0m
[91mEpoch: 0|  Loss:  6.0702 |Global loss: 7.0526| Local H loss: 0.0148  | Global H loss: 0.0145 [0m
[94mEpoch: 1|  NKD Loss: 1.0875 | CT Loss: 3.0621| [0m
[91mEpoch: 1|  Loss:  5.3326 |Global loss: 6.2171| Local H loss: 0.0108  | Global H loss: 0.0112 [0m
[94mEpoch: 2|  NKD Loss: 1.0091 | CT Loss: 3.015| [0m
[91mEpoch: 2|  Loss:  5.1753 |Global loss: 6.0538| Local H loss: 0.0112  | Global H loss: 0.0111 [0m
[94mEpoch: 3|  NKD Loss: 0.9693 | CT Loss: 2.9973| [0m
[91mEpoch: 3|  Loss:  5.0698 |Global loss: 5.9622| Local H loss: 0.0123  | Global H loss: 0.0119 [0m
------------------------- time cost ------------------------- 11.678020477294922
Chosen Clients:  [0, 3, 8]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.553, 0.51, 0.763, 0.546, 0.626, 0.681, 0.733, 0.489, 1.0]
AUC in each clients:  [423.262, 434.894, 314.752, 397.485, 471.878, 441.636, 410.829, 438.521, 12.0]
F1 Score:  [0.432, 0.362, 0.622, 0.413, 0.475, 0.519, 0.526, 0.321, 1.0]
Recall Score:  [0.484, 0.424, 0.657, 0.481, 0.524, 0.564, 0.571, 0.376, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.5680
Averaged Test Accurancy: 0.6063
Averaged Test AUC: 0.8911
Averaged Test F1_score: 0.5189
Averaged Test Recal score: 0.5646
Std Test Accurancy: 0.1525
Std Test AUC: 0.0411
Std Test F1: 0.0259
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.6047 | CT Loss: 3.1461| [0m
[91mEpoch: 0|  Loss:  6.063 |Global loss: 7.148| Local H loss: 0.013  | Global H loss: 0.0137 [0m
[94mEpoch: 1|  NKD Loss: 1.2873 | CT Loss: 2.9856| [0m
[91mEpoch: 1|  Loss:  5.5749 |Global loss: 6.5524| Local H loss: 0.0089  | Global H loss: 0.0106 [0m
[94mEpoch: 2|  NKD Loss: 1.2362 | CT Loss: 2.9793| [0m
[91mEpoch: 2|  Loss:  5.4958 |Global loss: 6.4794| Local H loss: 0.0093  | Global H loss: 0.0109 [0m
[94mEpoch: 3|  NKD Loss: 1.2018 | CT Loss: 2.9697| [0m
[91mEpoch: 3|  Loss:  5.424 |Global loss: 6.4108| Local H loss: 0.0098  | Global H loss: 0.0114 [0m
[94mEpoch: 0|  NKD Loss: 1.6645 | CT Loss: 3.291| [0m
[91mEpoch: 0|  Loss:  6.1302 |Global loss: 7.1698| Local H loss: 0.02  | Global H loss: 0.0196 [0m
[94mEpoch: 1|  NKD Loss: 1.1651 | CT Loss: 3.0922| [0m
[91mEpoch: 1|  Loss:  5.4376 |Global loss: 6.2977| Local H loss: 0.0155  | Global H loss: 0.0158 [0m
[94mEpoch: 2|  NKD Loss: 1.0749 | CT Loss: 3.0371| [0m
[91mEpoch: 2|  Loss:  5.2323 |Global loss: 6.0044| Local H loss: 0.0147  | Global H loss: 0.0138 [0m
[94mEpoch: 3|  NKD Loss: 1.0571 | CT Loss: 3.0264| [0m
[91mEpoch: 3|  Loss:  5.1927 |Global loss: 5.9781| Local H loss: 0.0151  | Global H loss: 0.0142 [0m
[94mEpoch: 0|  NKD Loss: 2.1183 | CT Loss: 4.4324| [0m
[91mEpoch: 0|  Loss:  8.8324 |Global loss: 11.6079| Local H loss: 0.0097  | Global H loss: 0.0141 [0m
[94mEpoch: 1|  NKD Loss: 2.1964 | CT Loss: 4.2401| [0m
[91mEpoch: 1|  Loss:  8.6982 |Global loss: 10.0625| Local H loss: 0.0098  | Global H loss: 0.0121 [0m
[94mEpoch: 2|  NKD Loss: 2.2057 | CT Loss: 4.1638| [0m
[91mEpoch: 2|  Loss:  8.6129 |Global loss: 9.6524| Local H loss: 0.0046  | Global H loss: 0.0051 [0m
[94mEpoch: 3|  NKD Loss: 2.2054 | CT Loss: 4.0816| [0m
[91mEpoch: 3|  Loss:  8.5143 |Global loss: 9.5254| Local H loss: 0.0038  | Global H loss: 0.0042 [0m
------------------------- time cost ------------------------- 9.362731456756592
Chosen Clients:  [7, 8, 5]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.609, 0.51, 0.763, 0.691, 0.626, 0.681, 0.733, 0.489, 1.0]
AUC in each clients:  [427.021, 434.894, 314.752, 401.816, 471.878, 441.636, 410.829, 438.521, 12.0]
F1 Score:  [0.469, 0.362, 0.622, 0.575, 0.475, 0.519, 0.526, 0.321, 1.0]
Recall Score:  [0.546, 0.424, 0.657, 0.624, 0.524, 0.564, 0.571, 0.376, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.4111
Averaged Test Accurancy: 0.6308
Averaged Test AUC: 0.8933
Averaged Test F1_score: 0.5410
Averaged Test Recal score: 0.5873
Std Test Accurancy: 0.1436
Std Test AUC: 0.0402
Std Test F1: 0.0259
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.6143 | CT Loss: 3.4012| [0m
[91mEpoch: 0|  Loss:  6.5278 |Global loss: 7.6588| Local H loss: 0.0108  | Global H loss: 0.0141 [0m
[94mEpoch: 1|  NKD Loss: 1.4133 | CT Loss: 3.1106| [0m
[91mEpoch: 1|  Loss:  5.9578 |Global loss: 6.8472| Local H loss: 0.0107  | Global H loss: 0.0123 [0m
[94mEpoch: 2|  NKD Loss: 1.3262 | CT Loss: 3.0592| [0m
[91mEpoch: 2|  Loss:  5.7885 |Global loss: 6.5793| Local H loss: 0.0102  | Global H loss: 0.0109 [0m
[94mEpoch: 3|  NKD Loss: 1.2705 | CT Loss: 3.025| [0m
[91mEpoch: 3|  Loss:  5.6689 |Global loss: 6.4341| Local H loss: 0.0095  | Global H loss: 0.0096 [0m
[94mEpoch: 0|  NKD Loss: 2.1083 | CT Loss: 4.3707| [0m
[91mEpoch: 0|  Loss:  8.6983 |Global loss: 12.387| Local H loss: 0.0112  | Global H loss: 0.0195 [0m
[94mEpoch: 1|  NKD Loss: 2.1583 | CT Loss: 4.2537| [0m
[91mEpoch: 1|  Loss:  8.6023 |Global loss: 10.1251| Local H loss: 0.0032  | Global H loss: 0.0037 [0m
[94mEpoch: 2|  NKD Loss: 2.1806 | CT Loss: 4.2113| [0m
[91mEpoch: 2|  Loss:  8.5607 |Global loss: 9.8035| Local H loss: 0.0018  | Global H loss: 0.0021 [0m
[94mEpoch: 3|  NKD Loss: 2.1921 | CT Loss: 4.1934| [0m
[91mEpoch: 3|  Loss:  8.5328 |Global loss: 9.6745| Local H loss: 0.0018  | Global H loss: 0.002 [0m
[94mEpoch: 0|  NKD Loss: 1.6909 | CT Loss: 3.4127| [0m
[91mEpoch: 0|  Loss:  6.3182 |Global loss: 7.6171| Local H loss: 0.0163  | Global H loss: 0.018 [0m
[94mEpoch: 1|  NKD Loss: 1.2577 | CT Loss: 3.1465| [0m
[91mEpoch: 1|  Loss:  5.5243 |Global loss: 6.4313| Local H loss: 0.0123  | Global H loss: 0.0138 [0m
[94mEpoch: 2|  NKD Loss: 1.1808 | CT Loss: 3.0918| [0m
[91mEpoch: 2|  Loss:  5.3131 |Global loss: 6.2524| Local H loss: 0.0139  | Global H loss: 0.0149 [0m
[94mEpoch: 3|  NKD Loss: 1.0792 | CT Loss: 3.0755| [0m
[91mEpoch: 3|  Loss:  5.1713 |Global loss: 6.0976| Local H loss: 0.015  | Global H loss: 0.0156 [0m
------------------------- time cost ------------------------- 9.459123611450195
Chosen Clients:  [7, 8, 3]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.609, 0.51, 0.763, 0.691, 0.626, 0.76, 0.733, 0.631, 1.0]
AUC in each clients:  [427.021, 434.894, 314.752, 401.816, 471.878, 443.368, 410.829, 441.907, 12.0]
F1 Score:  [0.469, 0.362, 0.622, 0.575, 0.475, 0.595, 0.526, 0.413, 1.0]
Recall Score:  [0.546, 0.424, 0.657, 0.624, 0.524, 0.643, 0.571, 0.489, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.7108
Averaged Test Accurancy: 0.6601
Averaged Test AUC: 0.8946
Averaged Test F1_score: 0.5597
Averaged Test Recal score: 0.6087
Std Test Accurancy: 0.1305
Std Test AUC: 0.0396
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.5962 | CT Loss: 3.3438| [0m
[91mEpoch: 0|  Loss:  6.2599 |Global loss: 7.3679| Local H loss: 0.0132  | Global H loss: 0.0151 [0m
[94mEpoch: 1|  NKD Loss: 1.3516 | CT Loss: 3.122| [0m
[91mEpoch: 1|  Loss:  5.792 |Global loss: 6.6799| Local H loss: 0.0112  | Global H loss: 0.0117 [0m
[94mEpoch: 2|  NKD Loss: 1.2739 | CT Loss: 3.0784| [0m
[91mEpoch: 2|  Loss:  5.6384 |Global loss: 6.4309| Local H loss: 0.01  | Global H loss: 0.01 [0m
[94mEpoch: 3|  NKD Loss: 1.1719 | CT Loss: 3.0546| [0m
[91mEpoch: 3|  Loss:  5.4839 |Global loss: 6.2601| Local H loss: 0.01  | Global H loss: 0.0094 [0m
[94mEpoch: 0|  NKD Loss: 2.1193 | CT Loss: 4.3256| [0m
[91mEpoch: 0|  Loss:  8.5771 |Global loss: 10.9377| Local H loss: 0.0078  | Global H loss: 0.0101 [0m
[94mEpoch: 1|  NKD Loss: 2.1959 | CT Loss: 4.2379| [0m
[91mEpoch: 1|  Loss:  8.5479 |Global loss: 10.166| Local H loss: 0.0114  | Global H loss: 0.0155 [0m
[94mEpoch: 2|  NKD Loss: 2.1896 | CT Loss: 4.1819| [0m
[91mEpoch: 2|  Loss:  8.4594 |Global loss: 9.6882| Local H loss: 0.0026  | Global H loss: 0.003 [0m
[94mEpoch: 3|  NKD Loss: 2.2025 | CT Loss: 4.1917| [0m
[91mEpoch: 3|  Loss:  8.4608 |Global loss: 9.6462| Local H loss: 0.0044  | Global H loss: 0.0048 [0m
[94mEpoch: 0|  NKD Loss: 1.6186 | CT Loss: 3.4662| [0m
[91mEpoch: 0|  Loss:  6.18 |Global loss: 7.1364| Local H loss: 0.0212  | Global H loss: 0.0198 [0m
[94mEpoch: 1|  NKD Loss: 1.2143 | CT Loss: 3.2169| [0m
[91mEpoch: 1|  Loss:  5.5406 |Global loss: 6.491| Local H loss: 0.0163  | Global H loss: 0.0175 [0m
[94mEpoch: 2|  NKD Loss: 1.0579 | CT Loss: 3.1435| [0m
[91mEpoch: 2|  Loss:  5.2887 |Global loss: 6.1279| Local H loss: 0.0149  | Global H loss: 0.0154 [0m
[94mEpoch: 3|  NKD Loss: 1.0245 | CT Loss: 3.1083| [0m
[91mEpoch: 3|  Loss:  5.2094 |Global loss: 6.0237| Local H loss: 0.0152  | Global H loss: 0.0153 [0m
------------------------- time cost ------------------------- 9.377921104431152
Chosen Clients:  [1, 6, 2]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.609, 0.51, 0.763, 0.678, 0.626, 0.76, 0.733, 0.598, 1.0]
AUC in each clients:  [427.021, 434.894, 314.752, 400.435, 471.878, 443.368, 410.829, 442.688, 12.0]
F1 Score:  [0.469, 0.362, 0.622, 0.54, 0.475, 0.595, 0.526, 0.403, 1.0]
Recall Score:  [0.546, 0.424, 0.657, 0.609, 0.524, 0.643, 0.571, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.5393
Averaged Test Accurancy: 0.6540
Averaged Test AUC: 0.8945
Averaged Test F1_score: 0.5547
Averaged Test Recal score: 0.6051
Std Test Accurancy: 0.1331
Std Test AUC: 0.0395
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.5313 | CT Loss: 3.327| [0m
[91mEpoch: 0|  Loss:  6.3107 |Global loss: 7.2967| Local H loss: 0.0124  | Global H loss: 0.0172 [0m
[94mEpoch: 1|  NKD Loss: 1.2696 | CT Loss: 3.1246| [0m
[91mEpoch: 1|  Loss:  5.8347 |Global loss: 6.5795| Local H loss: 0.0101  | Global H loss: 0.0123 [0m
[94mEpoch: 2|  NKD Loss: 1.1932 | CT Loss: 3.0831| [0m
[91mEpoch: 2|  Loss:  5.6886 |Global loss: 6.4417| Local H loss: 0.0102  | Global H loss: 0.0121 [0m
[94mEpoch: 3|  NKD Loss: 1.0625 | CT Loss: 3.051| [0m
[91mEpoch: 3|  Loss:  5.4852 |Global loss: 6.2262| Local H loss: 0.0099  | Global H loss: 0.011 [0m
[94mEpoch: 0|  NKD Loss: 1.4949 | CT Loss: 3.4922| [0m
[91mEpoch: 0|  Loss:  6.0899 |Global loss: 7.1707| Local H loss: 0.0175  | Global H loss: 0.0182 [0m
[94mEpoch: 1|  NKD Loss: 1.0877 | CT Loss: 3.234| [0m
[91mEpoch: 1|  Loss:  5.4481 |Global loss: 6.3955| Local H loss: 0.0123  | Global H loss: 0.014 [0m
[94mEpoch: 2|  NKD Loss: 1.0077 | CT Loss: 3.1557| [0m
[91mEpoch: 2|  Loss:  5.2549 |Global loss: 6.155| Local H loss: 0.0112  | Global H loss: 0.0126 [0m
[94mEpoch: 3|  NKD Loss: 0.9632 | CT Loss: 3.1267| [0m
[91mEpoch: 3|  Loss:  5.1342 |Global loss: 6.0874| Local H loss: 0.0117  | Global H loss: 0.0137 [0m
[94mEpoch: 0|  NKD Loss: 1.1729 | CT Loss: 3.3524| [0m
[91mEpoch: 0|  Loss:  5.2936 |Global loss: 6.6253| Local H loss: 0.0259  | Global H loss: 0.0258 [0m
[94mEpoch: 1|  NKD Loss: 0.8339 | CT Loss: 3.1809| [0m
[91mEpoch: 1|  Loss:  4.7922 |Global loss: 5.8895| Local H loss: 0.0197  | Global H loss: 0.0199 [0m
[94mEpoch: 2|  NKD Loss: 0.7676 | CT Loss: 3.1573| [0m
[91mEpoch: 2|  Loss:  4.6727 |Global loss: 5.7581| Local H loss: 0.0204  | Global H loss: 0.0203 [0m
[94mEpoch: 3|  NKD Loss: 0.7089 | CT Loss: 3.1309| [0m
[91mEpoch: 3|  Loss:  4.5474 |Global loss: 5.6358| Local H loss: 0.0207  | Global H loss: 0.0206 [0m
------------------------- time cost ------------------------- 10.798294305801392
Chosen Clients:  [4, 3, 0]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.609, 0.508, 0.748, 0.678, 0.626, 0.76, 0.742, 0.598, 1.0]
AUC in each clients:  [427.021, 446.603, 315.494, 400.435, 471.878, 443.368, 411.478, 442.688, 12.0]
F1 Score:  [0.469, 0.357, 0.613, 0.54, 0.475, 0.595, 0.545, 0.403, 1.0]
Recall Score:  [0.546, 0.422, 0.648, 0.609, 0.524, 0.643, 0.58, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.4679
Averaged Test Accurancy: 0.6534
Averaged Test AUC: 0.8980
Averaged Test F1_score: 0.5552
Averaged Test Recal score: 0.6049
Std Test Accurancy: 0.1330
Std Test AUC: 0.0369
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.5997 | CT Loss: 3.3736| [0m
[91mEpoch: 0|  Loss:  6.2636 |Global loss: 7.8485| Local H loss: 0.0151  | Global H loss: 0.0204 [0m
[94mEpoch: 1|  NKD Loss: 1.293 | CT Loss: 3.1617| [0m
[91mEpoch: 1|  Loss:  5.6814 |Global loss: 6.8031| Local H loss: 0.0129  | Global H loss: 0.0159 [0m
[94mEpoch: 2|  NKD Loss: 1.2049 | CT Loss: 3.1223| [0m
[91mEpoch: 2|  Loss:  5.5148 |Global loss: 6.5954| Local H loss: 0.0139  | Global H loss: 0.0164 [0m
[94mEpoch: 3|  NKD Loss: 1.1746 | CT Loss: 3.0878| [0m
[91mEpoch: 3|  Loss:  5.414 |Global loss: 6.4026| Local H loss: 0.0141  | Global H loss: 0.0157 [0m
[94mEpoch: 0|  NKD Loss: 1.3679 | CT Loss: 3.3151| [0m
[91mEpoch: 0|  Loss:  5.7228 |Global loss: 6.7911| Local H loss: 0.0191  | Global H loss: 0.0213 [0m
[94mEpoch: 1|  NKD Loss: 1.0014 | CT Loss: 3.1389| [0m
[91mEpoch: 1|  Loss:  5.1832 |Global loss: 5.9958| Local H loss: 0.0149  | Global H loss: 0.0155 [0m
[94mEpoch: 2|  NKD Loss: 0.8957 | CT Loss: 3.0944| [0m
[91mEpoch: 2|  Loss:  4.9971 |Global loss: 5.815| Local H loss: 0.0144  | Global H loss: 0.0145 [0m
[94mEpoch: 3|  NKD Loss: 0.8901 | CT Loss: 3.0912| [0m
[91mEpoch: 3|  Loss:  4.9624 |Global loss: 5.7506| Local H loss: 0.0151  | Global H loss: 0.0145 [0m
[94mEpoch: 0|  NKD Loss: 1.4377 | CT Loss: 3.3135| [0m
[91mEpoch: 0|  Loss:  5.9787 |Global loss: 7.3476| Local H loss: 0.0153  | Global H loss: 0.0179 [0m
[94mEpoch: 1|  NKD Loss: 1.1667 | CT Loss: 3.1027| [0m
[91mEpoch: 1|  Loss:  5.508 |Global loss: 6.4787| Local H loss: 0.0103  | Global H loss: 0.0113 [0m
[94mEpoch: 2|  NKD Loss: 1.089 | CT Loss: 3.0802| [0m
[91mEpoch: 2|  Loss:  5.3898 |Global loss: 6.2671| Local H loss: 0.0098  | Global H loss: 0.01 [0m
[94mEpoch: 3|  NKD Loss: 0.991 | CT Loss: 3.0557| [0m
[91mEpoch: 3|  Loss:  5.2317 |Global loss: 6.0807| Local H loss: 0.0093  | Global H loss: 0.0093 [0m
------------------------- time cost ------------------------- 11.546035051345825
Chosen Clients:  [8, 0, 1]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.625, 0.508, 0.748, 0.694, 0.645, 0.76, 0.742, 0.598, 1.0]
AUC in each clients:  [432.906, 446.603, 315.494, 404.889, 471.184, 443.368, 411.478, 442.688, 12.0]
F1 Score:  [0.494, 0.357, 0.613, 0.56, 0.499, 0.595, 0.545, 0.403, 1.0]
Recall Score:  [0.564, 0.422, 0.648, 0.625, 0.543, 0.643, 0.58, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.6874
Averaged Test Accurancy: 0.6601
Averaged Test AUC: 0.9005
Averaged Test F1_score: 0.5629
Averaged Test Recal score: 0.6108
Std Test Accurancy: 0.1307
Std Test AUC: 0.0358
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 2.1238 | CT Loss: 4.7445| [0m
[91mEpoch: 0|  Loss:  8.9201 |Global loss: 14.6672| Local H loss: 0.0145  | Global H loss: 0.0295 [0m
[94mEpoch: 1|  NKD Loss: 2.1606 | CT Loss: 4.5379| [0m
[91mEpoch: 1|  Loss:  8.7359 |Global loss: 12.4274| Local H loss: 0.0196  | Global H loss: 0.0405 [0m
[94mEpoch: 2|  NKD Loss: 2.1644 | CT Loss: 4.3824| [0m
[91mEpoch: 2|  Loss:  8.5755 |Global loss: 10.8278| Local H loss: 0.0172  | Global H loss: 0.0279 [0m
[94mEpoch: 3|  NKD Loss: 2.1828 | CT Loss: 4.2743| [0m
[91mEpoch: 3|  Loss:  8.4693 |Global loss: 9.9186| Local H loss: 0.0101  | Global H loss: 0.0134 [0m
[94mEpoch: 0|  NKD Loss: 1.3194 | CT Loss: 3.2071| [0m
[91mEpoch: 0|  Loss:  5.6939 |Global loss: 7.1249| Local H loss: 0.0154  | Global H loss: 0.0175 [0m
[94mEpoch: 1|  NKD Loss: 1.0292 | CT Loss: 3.0624| [0m
[91mEpoch: 1|  Loss:  5.2327 |Global loss: 6.1997| Local H loss: 0.0112  | Global H loss: 0.0112 [0m
[94mEpoch: 2|  NKD Loss: 0.9668 | CT Loss: 3.0468| [0m
[91mEpoch: 2|  Loss:  5.118 |Global loss: 6.064| Local H loss: 0.0114  | Global H loss: 0.0113 [0m
[94mEpoch: 3|  NKD Loss: 0.9277 | CT Loss: 3.0431| [0m
[91mEpoch: 3|  Loss:  5.0389 |Global loss: 5.9733| Local H loss: 0.0122  | Global H loss: 0.0119 [0m
[94mEpoch: 0|  NKD Loss: 1.3407 | CT Loss: 3.234| [0m
[91mEpoch: 0|  Loss:  5.926 |Global loss: 7.2676| Local H loss: 0.014  | Global H loss: 0.0188 [0m
[94mEpoch: 1|  NKD Loss: 1.0164 | CT Loss: 3.0534| [0m
[91mEpoch: 1|  Loss:  5.3912 |Global loss: 6.2356| Local H loss: 0.0105  | Global H loss: 0.0118 [0m
[94mEpoch: 2|  NKD Loss: 0.9837 | CT Loss: 3.0395| [0m
[91mEpoch: 2|  Loss:  5.3222 |Global loss: 6.135| Local H loss: 0.0108  | Global H loss: 0.0116 [0m
[94mEpoch: 3|  NKD Loss: 0.9142 | CT Loss: 3.0238| [0m
[91mEpoch: 3|  Loss:  5.1847 |Global loss: 6.0217| Local H loss: 0.011  | Global H loss: 0.011 [0m
------------------------- time cost ------------------------- 9.55045771598816
Chosen Clients:  [2, 0, 3]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.677, 0.526, 0.748, 0.694, 0.645, 0.76, 0.742, 0.598, 1.0]
AUC in each clients:  [439.119, 453.494, 315.494, 404.889, 471.184, 443.368, 411.478, 442.688, 12.0]
F1 Score:  [0.584, 0.377, 0.613, 0.56, 0.499, 0.595, 0.545, 0.403, 1.0]
Recall Score:  [0.638, 0.439, 0.648, 0.625, 0.543, 0.643, 0.58, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.7379
Averaged Test Accurancy: 0.6692
Averaged Test AUC: 0.9040
Averaged Test F1_score: 0.5751
Averaged Test Recal score: 0.6209
Std Test Accurancy: 0.1253
Std Test AUC: 0.0341
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.2252 | CT Loss: 3.4345| [0m
[91mEpoch: 0|  Loss:  5.3922 |Global loss: 7.1974| Local H loss: 0.0303  | Global H loss: 0.032 [0m
[94mEpoch: 1|  NKD Loss: 0.8634 | CT Loss: 3.2278| [0m
[91mEpoch: 1|  Loss:  4.8503 |Global loss: 6.1946| Local H loss: 0.023  | Global H loss: 0.024 [0m
[94mEpoch: 2|  NKD Loss: 0.803 | CT Loss: 3.1613| [0m
[91mEpoch: 2|  Loss:  4.6815 |Global loss: 5.9587| Local H loss: 0.0235  | Global H loss: 0.0237 [0m
[94mEpoch: 3|  NKD Loss: 0.7986 | CT Loss: 3.1271| [0m
[91mEpoch: 3|  Loss:  4.663 |Global loss: 5.8115| Local H loss: 0.0237  | Global H loss: 0.0227 [0m
[94mEpoch: 0|  NKD Loss: 1.3748 | CT Loss: 3.1934| [0m
[91mEpoch: 0|  Loss:  5.6043 |Global loss: 7.1482| Local H loss: 0.0187  | Global H loss: 0.0215 [0m
[94mEpoch: 1|  NKD Loss: 1.0036 | CT Loss: 3.0469| [0m
[91mEpoch: 1|  Loss:  5.0698 |Global loss: 6.0829| Local H loss: 0.0135  | Global H loss: 0.0133 [0m
[94mEpoch: 2|  NKD Loss: 0.9504 | CT Loss: 3.0363| [0m
[91mEpoch: 2|  Loss:  4.9637 |Global loss: 5.962| Local H loss: 0.0146  | Global H loss: 0.0139 [0m
[94mEpoch: 3|  NKD Loss: 0.8909 | CT Loss: 3.0283| [0m
[91mEpoch: 3|  Loss:  4.8715 |Global loss: 5.8848| Local H loss: 0.0153  | Global H loss: 0.0144 [0m
[94mEpoch: 0|  NKD Loss: 1.5183 | CT Loss: 3.4444| [0m
[91mEpoch: 0|  Loss:  5.9497 |Global loss: 7.7625| Local H loss: 0.0261  | Global H loss: 0.0304 [0m
[94mEpoch: 1|  NKD Loss: 0.9317 | CT Loss: 3.2261| [0m
[91mEpoch: 1|  Loss:  5.176 |Global loss: 6.2669| Local H loss: 0.0168  | Global H loss: 0.0176 [0m
[94mEpoch: 2|  NKD Loss: 0.8428 | CT Loss: 3.1721| [0m
[91mEpoch: 2|  Loss:  5.0137 |Global loss: 6.0135| Local H loss: 0.0165  | Global H loss: 0.0172 [0m
[94mEpoch: 3|  NKD Loss: 0.819 | CT Loss: 3.1451| [0m
[91mEpoch: 3|  Loss:  4.9256 |Global loss: 5.8794| Local H loss: 0.0168  | Global H loss: 0.0166 [0m
------------------------- time cost ------------------------- 11.246938228607178
Chosen Clients:  [8, 3, 6]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.526, 0.751, 0.696, 0.645, 0.76, 0.742, 0.598, 1.0]
AUC in each clients:  [441.718, 453.494, 318.872, 407.366, 471.184, 443.368, 411.478, 442.688, 12.0]
F1 Score:  [0.603, 0.377, 0.615, 0.572, 0.499, 0.595, 0.545, 0.403, 1.0]
Recall Score:  [0.66, 0.439, 0.653, 0.627, 0.543, 0.643, 0.58, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.8373
Averaged Test Accurancy: 0.6726
Averaged Test AUC: 0.9063
Averaged Test F1_score: 0.5788
Averaged Test Recal score: 0.6241
Std Test Accurancy: 0.1249
Std Test AUC: 0.0347
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 2.108 | CT Loss: 4.6114| [0m
[91mEpoch: 0|  Loss:  8.7203 |Global loss: 16.8152| Local H loss: 0.0125  | Global H loss: 0.0356 [0m
[94mEpoch: 1|  NKD Loss: 2.1345 | CT Loss: 4.278| [0m
[91mEpoch: 1|  Loss:  8.3893 |Global loss: 11.3353| Local H loss: 0.019  | Global H loss: 0.0326 [0m
[94mEpoch: 2|  NKD Loss: 2.1545 | CT Loss: 4.219| [0m
[91mEpoch: 2|  Loss:  8.3269 |Global loss: 10.1552| Local H loss: 0.0122  | Global H loss: 0.0163 [0m
[94mEpoch: 3|  NKD Loss: 2.1517 | CT Loss: 4.1862| [0m
[91mEpoch: 3|  Loss:  8.2625 |Global loss: 9.9715| Local H loss: 0.007  | Global H loss: 0.0082 [0m
[94mEpoch: 0|  NKD Loss: 1.2532 | CT Loss: 3.329| [0m
[91mEpoch: 0|  Loss:  5.5388 |Global loss: 7.2646| Local H loss: 0.0224  | Global H loss: 0.0274 [0m
[94mEpoch: 1|  NKD Loss: 0.9013 | CT Loss: 3.1623| [0m
[91mEpoch: 1|  Loss:  5.0118 |Global loss: 6.0855| Local H loss: 0.0185  | Global H loss: 0.0188 [0m
[94mEpoch: 2|  NKD Loss: 0.819 | CT Loss: 3.124| [0m
[91mEpoch: 2|  Loss:  4.9046 |Global loss: 5.8979| Local H loss: 0.0168  | Global H loss: 0.0168 [0m
[94mEpoch: 3|  NKD Loss: 0.7938 | CT Loss: 3.1001| [0m
[91mEpoch: 3|  Loss:  4.8243 |Global loss: 5.8107| Local H loss: 0.018  | Global H loss: 0.0172 [0m
[94mEpoch: 0|  NKD Loss: 1.6835 | CT Loss: 3.5426| [0m
[91mEpoch: 0|  Loss:  6.3592 |Global loss: 8.6827| Local H loss: 0.0209  | Global H loss: 0.0311 [0m
[94mEpoch: 1|  NKD Loss: 1.2437 | CT Loss: 3.2465| [0m
[91mEpoch: 1|  Loss:  5.5585 |Global loss: 6.6665| Local H loss: 0.014  | Global H loss: 0.0174 [0m
[94mEpoch: 2|  NKD Loss: 0.9729 | CT Loss: 3.1421| [0m
[91mEpoch: 2|  Loss:  5.11 |Global loss: 5.9848| Local H loss: 0.0136  | Global H loss: 0.0143 [0m
[94mEpoch: 3|  NKD Loss: 0.9247 | CT Loss: 3.1192| [0m
[91mEpoch: 3|  Loss:  4.9906 |Global loss: 5.9075| Local H loss: 0.0155  | Global H loss: 0.0154 [0m
------------------------- time cost ------------------------- 8.941632747650146
Chosen Clients:  [3, 2, 6]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.526, 0.751, 0.702, 0.645, 0.76, 0.767, 0.598, 1.0]
AUC in each clients:  [441.718, 453.494, 318.872, 410.095, 471.184, 443.368, 417.111, 442.688, 12.0]
F1 Score:  [0.603, 0.377, 0.615, 0.586, 0.499, 0.595, 0.583, 0.403, 1.0]
Recall Score:  [0.66, 0.439, 0.653, 0.633, 0.543, 0.643, 0.609, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.0160
Averaged Test Accurancy: 0.6763
Averaged Test AUC: 0.9085
Averaged Test F1_score: 0.5846
Averaged Test Recal score: 0.6280
Std Test Accurancy: 0.1256
Std Test AUC: 0.0346
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.284 | CT Loss: 3.2972| [0m
[91mEpoch: 0|  Loss:  5.4769 |Global loss: 7.1178| Local H loss: 0.0255  | Global H loss: 0.0276 [0m
[94mEpoch: 1|  NKD Loss: 0.8659 | CT Loss: 3.1141| [0m
[91mEpoch: 1|  Loss:  4.8775 |Global loss: 5.9307| Local H loss: 0.019  | Global H loss: 0.0187 [0m
[94mEpoch: 2|  NKD Loss: 0.8069 | CT Loss: 3.1003| [0m
[91mEpoch: 2|  Loss:  4.7888 |Global loss: 5.8074| Local H loss: 0.0203  | Global H loss: 0.0187 [0m
[94mEpoch: 3|  NKD Loss: 0.7862 | CT Loss: 3.0877| [0m
[91mEpoch: 3|  Loss:  4.7414 |Global loss: 5.7549| Local H loss: 0.0206  | Global H loss: 0.0189 [0m
[94mEpoch: 0|  NKD Loss: 1.3483 | CT Loss: 3.4205| [0m
[91mEpoch: 0|  Loss:  5.5072 |Global loss: 7.2929| Local H loss: 0.0318  | Global H loss: 0.0332 [0m
[94mEpoch: 1|  NKD Loss: 0.8651 | CT Loss: 3.1527| [0m
[91mEpoch: 1|  Loss:  4.7567 |Global loss: 5.9961| Local H loss: 0.0247  | Global H loss: 0.0242 [0m
[94mEpoch: 2|  NKD Loss: 0.7761 | CT Loss: 3.1164| [0m
[91mEpoch: 2|  Loss:  4.6031 |Global loss: 5.769| Local H loss: 0.0243  | Global H loss: 0.0229 [0m
[94mEpoch: 3|  NKD Loss: 0.7703 | CT Loss: 3.1082| [0m
[91mEpoch: 3|  Loss:  4.5478 |Global loss: 5.6496| Local H loss: 0.0267  | Global H loss: 0.0236 [0m
[94mEpoch: 0|  NKD Loss: 1.3693 | CT Loss: 3.4546| [0m
[91mEpoch: 0|  Loss:  5.7391 |Global loss: 7.327| Local H loss: 0.0224  | Global H loss: 0.0269 [0m
[94mEpoch: 1|  NKD Loss: 0.9474 | CT Loss: 3.1549| [0m
[91mEpoch: 1|  Loss:  5.0003 |Global loss: 5.9051| Local H loss: 0.0175  | Global H loss: 0.017 [0m
[94mEpoch: 2|  NKD Loss: 0.8846 | CT Loss: 3.1124| [0m
[91mEpoch: 2|  Loss:  4.8473 |Global loss: 5.7545| Local H loss: 0.018  | Global H loss: 0.0169 [0m
[94mEpoch: 3|  NKD Loss: 0.8219 | CT Loss: 3.0885| [0m
[91mEpoch: 3|  Loss:  4.7568 |Global loss: 5.607| Local H loss: 0.0168  | Global H loss: 0.0153 [0m
------------------------- time cost ------------------------- 10.492782592773438
Chosen Clients:  [6, 1, 4]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.526, 0.789, 0.738, 0.645, 0.76, 0.827, 0.598, 1.0]
AUC in each clients:  [441.718, 453.494, 319.855, 411.977, 471.184, 443.368, 419.252, 442.688, 12.0]
F1 Score:  [0.603, 0.377, 0.698, 0.624, 0.499, 0.595, 0.644, 0.403, 1.0]
Recall Score:  [0.66, 0.439, 0.707, 0.667, 0.543, 0.643, 0.67, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.0309
Averaged Test Accurancy: 0.6913
Averaged Test AUC: 0.9098
Averaged Test F1_score: 0.6048
Averaged Test Recal score: 0.6446
Std Test Accurancy: 0.1309
Std Test AUC: 0.0350
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.6339 | CT Loss: 3.402| [0m
[91mEpoch: 0|  Loss:  5.9809 |Global loss: 8.4108| Local H loss: 0.0246  | Global H loss: 0.0326 [0m
[94mEpoch: 1|  NKD Loss: 1.0183 | CT Loss: 3.1355| [0m
[91mEpoch: 1|  Loss:  4.9889 |Global loss: 5.9395| Local H loss: 0.0215  | Global H loss: 0.0187 [0m
[94mEpoch: 2|  NKD Loss: 0.8859 | CT Loss: 3.102| [0m
[91mEpoch: 2|  Loss:  4.784 |Global loss: 5.6635| Local H loss: 0.0202  | Global H loss: 0.0173 [0m
[94mEpoch: 3|  NKD Loss: 0.828 | CT Loss: 3.0837| [0m
[91mEpoch: 3|  Loss:  4.696 |Global loss: 5.6006| Local H loss: 0.021  | Global H loss: 0.0184 [0m
[94mEpoch: 0|  NKD Loss: 1.3758 | CT Loss: 3.2767| [0m
[91mEpoch: 0|  Loss:  5.8894 |Global loss: 7.4387| Local H loss: 0.0178  | Global H loss: 0.0232 [0m
[94mEpoch: 1|  NKD Loss: 0.921 | CT Loss: 3.0389| [0m
[91mEpoch: 1|  Loss:  5.1725 |Global loss: 6.0469| Local H loss: 0.0121  | Global H loss: 0.0124 [0m
[94mEpoch: 2|  NKD Loss: 0.901 | CT Loss: 3.0114| [0m
[91mEpoch: 2|  Loss:  5.0749 |Global loss: 5.9327| Local H loss: 0.0123  | Global H loss: 0.012 [0m
[94mEpoch: 3|  NKD Loss: 0.8757 | CT Loss: 2.9881| [0m
[91mEpoch: 3|  Loss:  5.0178 |Global loss: 5.8232| Local H loss: 0.0116  | Global H loss: 0.0106 [0m
[94mEpoch: 0|  NKD Loss: 1.6674 | CT Loss: 3.4479| [0m
[91mEpoch: 0|  Loss:  6.2608 |Global loss: 8.3245| Local H loss: 0.0194  | Global H loss: 0.0292 [0m
[94mEpoch: 1|  NKD Loss: 1.2764 | CT Loss: 3.1365| [0m
[91mEpoch: 1|  Loss:  5.499 |Global loss: 6.7231| Local H loss: 0.0173  | Global H loss: 0.0209 [0m
[94mEpoch: 2|  NKD Loss: 1.1487 | CT Loss: 3.0924| [0m
[91mEpoch: 2|  Loss:  5.3257 |Global loss: 6.3539| Local H loss: 0.0164  | Global H loss: 0.0179 [0m
[94mEpoch: 3|  NKD Loss: 1.0628 | CT Loss: 3.0647| [0m
[91mEpoch: 3|  Loss:  5.1851 |Global loss: 6.1674| Local H loss: 0.0158  | Global H loss: 0.0167 [0m
------------------------- time cost ------------------------- 11.775758743286133
Chosen Clients:  [1, 7, 2]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.618, 0.789, 0.738, 0.738, 0.76, 0.827, 0.598, 1.0]
AUC in each clients:  [441.718, 458.685, 319.855, 411.977, 481.307, 443.368, 423.496, 442.688, 12.0]
F1 Score:  [0.603, 0.478, 0.698, 0.624, 0.572, 0.595, 0.648, 0.403, 1.0]
Recall Score:  [0.66, 0.518, 0.707, 0.667, 0.625, 0.643, 0.673, 0.472, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.0734
Averaged Test Accurancy: 0.7168
Averaged Test AUC: 0.9150
Averaged Test F1_score: 0.6246
Averaged Test Recal score: 0.6628
Std Test Accurancy: 0.1122
Std Test AUC: 0.0332
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.3147 | CT Loss: 3.2247| [0m
[91mEpoch: 0|  Loss:  5.6593 |Global loss: 7.1747| Local H loss: 0.0186  | Global H loss: 0.0219 [0m
[94mEpoch: 1|  NKD Loss: 0.9223 | CT Loss: 3.0226| [0m
[91mEpoch: 1|  Loss:  5.0315 |Global loss: 6.0495| Local H loss: 0.0139  | Global H loss: 0.0137 [0m
[94mEpoch: 2|  NKD Loss: 0.8863 | CT Loss: 3.0005| [0m
[91mEpoch: 2|  Loss:  4.9455 |Global loss: 5.8495| Local H loss: 0.0138  | Global H loss: 0.0125 [0m
[94mEpoch: 3|  NKD Loss: 0.8907 | CT Loss: 3.0015| [0m
[91mEpoch: 3|  Loss:  4.9103 |Global loss: 5.8421| Local H loss: 0.0155  | Global H loss: 0.0137 [0m
[94mEpoch: 0|  NKD Loss: 1.4256 | CT Loss: 3.3511| [0m
[91mEpoch: 0|  Loss:  6.0239 |Global loss: 7.4823| Local H loss: 0.0146  | Global H loss: 0.0191 [0m
[94mEpoch: 1|  NKD Loss: 1.1239 | CT Loss: 3.0842| [0m
[91mEpoch: 1|  Loss:  5.4155 |Global loss: 6.2889| Local H loss: 0.0115  | Global H loss: 0.0122 [0m
[94mEpoch: 2|  NKD Loss: 1.0787 | CT Loss: 3.0611| [0m
[91mEpoch: 2|  Loss:  5.3213 |Global loss: 6.1247| Local H loss: 0.0108  | Global H loss: 0.0107 [0m
[94mEpoch: 3|  NKD Loss: 0.9829 | CT Loss: 3.0306| [0m
[91mEpoch: 3|  Loss:  5.1592 |Global loss: 5.9009| Local H loss: 0.0095  | Global H loss: 0.0092 [0m
[94mEpoch: 0|  NKD Loss: 1.1368 | CT Loss: 3.3483| [0m
[91mEpoch: 0|  Loss:  5.1783 |Global loss: 6.8985| Local H loss: 0.0323  | Global H loss: 0.035 [0m
[94mEpoch: 1|  NKD Loss: 0.7653 | CT Loss: 3.1272| [0m
[91mEpoch: 1|  Loss:  4.5501 |Global loss: 5.581| Local H loss: 0.0306  | Global H loss: 0.0253 [0m
[94mEpoch: 2|  NKD Loss: 0.7485 | CT Loss: 3.1089| [0m
[91mEpoch: 2|  Loss:  4.4904 |Global loss: 5.4329| Local H loss: 0.0289  | Global H loss: 0.0239 [0m
[94mEpoch: 3|  NKD Loss: 0.7026 | CT Loss: 3.1023| [0m
[91mEpoch: 3|  Loss:  4.4187 |Global loss: 5.322| Local H loss: 0.031  | Global H loss: 0.0238 [0m
------------------------- time cost ------------------------- 11.091598749160767
Chosen Clients:  [3, 2, 8]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.6, 0.813, 0.738, 0.738, 0.76, 0.827, 0.71, 1.0]
AUC in each clients:  [441.718, 463.47, 321.87, 411.977, 481.307, 443.368, 423.496, 455.328, 12.0]
F1 Score:  [0.603, 0.476, 0.719, 0.624, 0.572, 0.595, 0.648, 0.541, 1.0]
Recall Score:  [0.66, 0.506, 0.735, 0.667, 0.625, 0.643, 0.673, 0.577, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.2523
Averaged Test Accurancy: 0.7318
Averaged Test AUC: 0.9202
Averaged Test F1_score: 0.6420
Averaged Test Recal score: 0.6762
Std Test Accurancy: 0.1039
Std Test AUC: 0.0293
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.2963 | CT Loss: 3.3417| [0m
[91mEpoch: 0|  Loss:  5.5082 |Global loss: 7.2178| Local H loss: 0.0274  | Global H loss: 0.03 [0m
[94mEpoch: 1|  NKD Loss: 0.846 | CT Loss: 3.1083| [0m
[91mEpoch: 1|  Loss:  4.7771 |Global loss: 5.9009| Local H loss: 0.0213  | Global H loss: 0.0202 [0m
[94mEpoch: 2|  NKD Loss: 0.8301 | CT Loss: 3.0866| [0m
[91mEpoch: 2|  Loss:  4.7218 |Global loss: 5.7707| Local H loss: 0.0224  | Global H loss: 0.0203 [0m
[94mEpoch: 3|  NKD Loss: 0.7529 | CT Loss: 3.0705| [0m
[91mEpoch: 3|  Loss:  4.6261 |Global loss: 5.637| Local H loss: 0.0215  | Global H loss: 0.0191 [0m
[94mEpoch: 0|  NKD Loss: 1.3148 | CT Loss: 3.4336| [0m
[91mEpoch: 0|  Loss:  5.4209 |Global loss: 7.2816| Local H loss: 0.0368  | Global H loss: 0.0363 [0m
[94mEpoch: 1|  NKD Loss: 0.7517 | CT Loss: 3.1195| [0m
[91mEpoch: 1|  Loss:  4.5018 |Global loss: 5.5454| Local H loss: 0.0311  | Global H loss: 0.0258 [0m
[94mEpoch: 2|  NKD Loss: 0.7085 | CT Loss: 3.1005| [0m
[91mEpoch: 2|  Loss:  4.3966 |Global loss: 5.315| Local H loss: 0.0296  | Global H loss: 0.0245 [0m
[94mEpoch: 3|  NKD Loss: 0.6711 | CT Loss: 3.0962| [0m
[91mEpoch: 3|  Loss:  4.3522 |Global loss: 5.1989| Local H loss: 0.0281  | Global H loss: 0.0227 [0m
[94mEpoch: 0|  NKD Loss: 2.1494 | CT Loss: 4.5268| [0m
[91mEpoch: 0|  Loss:  8.5772 |Global loss: 19.0836| Local H loss: 0.013  | Global H loss: 0.0419 [0m
[94mEpoch: 1|  NKD Loss: 2.1094 | CT Loss: 4.2278| [0m
[91mEpoch: 1|  Loss:  8.2036 |Global loss: 10.7735| Local H loss: 0.015  | Global H loss: 0.0194 [0m
[94mEpoch: 2|  NKD Loss: 2.0999 | CT Loss: 4.1939| [0m
[91mEpoch: 2|  Loss:  8.1204 |Global loss: 10.2633| Local H loss: 0.0079  | Global H loss: 0.0093 [0m
[94mEpoch: 3|  NKD Loss: 2.1185 | CT Loss: 4.2009| [0m
[91mEpoch: 3|  Loss:  8.1074 |Global loss: 10.0181| Local H loss: 0.0109  | Global H loss: 0.0121 [0m
------------------------- time cost ------------------------- 8.156551122665405
Chosen Clients:  [3, 6, 1]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.6, 0.807, 0.745, 0.738, 0.76, 0.827, 0.71, 1.0]
AUC in each clients:  [441.718, 463.47, 321.36, 412.52, 481.307, 443.368, 423.496, 455.328, 12.0]
F1 Score:  [0.603, 0.476, 0.73, 0.631, 0.572, 0.595, 0.648, 0.541, 1.0]
Recall Score:  [0.66, 0.506, 0.731, 0.673, 0.625, 0.643, 0.673, 0.577, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.2078
Averaged Test Accurancy: 0.7320
Averaged Test AUC: 0.9202
Averaged Test F1_score: 0.6440
Averaged Test Recal score: 0.6764
Std Test Accurancy: 0.1034
Std Test AUC: 0.0291
Std Test F1: 0.0258
Std Test Recall: 0.0258
[94mEpoch: 0|  NKD Loss: 1.2419 | CT Loss: 3.2705| [0m
[91mEpoch: 0|  Loss:  5.2871 |Global loss: 7.0079| Local H loss: 0.0277  | Global H loss: 0.0299 [0m
[94mEpoch: 1|  NKD Loss: 0.8013 | CT Loss: 3.0936| [0m
[91mEpoch: 1|  Loss:  4.6615 |Global loss: 5.677| Local H loss: 0.023  | Global H loss: 0.0202 [0m
[94mEpoch: 2|  NKD Loss: 0.7447 | CT Loss: 3.0557| [0m
[91mEpoch: 2|  Loss:  4.5828 |Global loss: 5.5125| Local H loss: 0.0219  | Global H loss: 0.0187 [0m
[94mEpoch: 3|  NKD Loss: 0.7479 | CT Loss: 3.054| [0m
[91mEpoch: 3|  Loss:  4.5347 |Global loss: 5.4125| Local H loss: 0.0228  | Global H loss: 0.0183 [0m
[94mEpoch: 0|  NKD Loss: 1.3636 | CT Loss: 3.4586| [0m
[91mEpoch: 0|  Loss:  5.6125 |Global loss: 7.2994| Local H loss: 0.0288  | Global H loss: 0.0311 [0m
[94mEpoch: 1|  NKD Loss: 0.7809 | CT Loss: 3.1855| [0m
[91mEpoch: 1|  Loss:  4.7645 |Global loss: 5.6877| Local H loss: 0.0214  | Global H loss: 0.0196 [0m
[94mEpoch: 2|  NKD Loss: 0.7234 | CT Loss: 3.1255| [0m
[91mEpoch: 2|  Loss:  4.6325 |Global loss: 5.5288| Local H loss: 0.0199  | Global H loss: 0.0173 [0m
[94mEpoch: 3|  NKD Loss: 0.7014 | CT Loss: 3.0999| [0m
[91mEpoch: 3|  Loss:  4.5528 |Global loss: 5.4383| Local H loss: 0.0213  | Global H loss: 0.0186 [0m
[94mEpoch: 0|  NKD Loss: 1.2649 | CT Loss: 3.1947| [0m
[91mEpoch: 0|  Loss:  5.4861 |Global loss: 7.1197| Local H loss: 0.0199  | Global H loss: 0.022 [0m
[94mEpoch: 1|  NKD Loss: 0.9096 | CT Loss: 3.0092| [0m
[91mEpoch: 1|  Loss:  4.9069 |Global loss: 5.9157| Local H loss: 0.0158  | Global H loss: 0.0142 [0m
[94mEpoch: 2|  NKD Loss: 0.8669 | CT Loss: 3.0012| [0m
[91mEpoch: 2|  Loss:  4.8234 |Global loss: 5.8119| Local H loss: 0.016  | Global H loss: 0.014 [0m
[94mEpoch: 3|  NKD Loss: 0.8319 | CT Loss: 2.9899| [0m
[91mEpoch: 3|  Loss:  4.7405 |Global loss: 5.7086| Local H loss: 0.0161  | Global H loss: 0.0141 [0m
------------------------- time cost ------------------------- 11.498994588851929
Chosen Clients:  [4, 2, 0]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.7, 0.681, 0.807, 0.752, 0.738, 0.76, 0.824, 0.71, 1.0]
AUC in each clients:  [441.718, 468.526, 321.36, 415.939, 481.307, 443.368, 423.137, 455.328, 12.0]
F1 Score:  [0.603, 0.568, 0.73, 0.639, 0.572, 0.595, 0.646, 0.541, 1.0]
Recall Score:  [0.66, 0.586, 0.731, 0.68, 0.625, 0.643, 0.67, 0.577, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.3057
Averaged Test Accurancy: 0.7435
Averaged Test AUC: 0.9224
Averaged Test F1_score: 0.6549
Averaged Test Recal score: 0.6858
Std Test Accurancy: 0.0912
Std Test AUC: 0.0284
Std Test F1: 0.0258
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.6357 | CT Loss: 3.4726| [0m
[91mEpoch: 0|  Loss:  6.1712 |Global loss: 8.7172| Local H loss: 0.0236  | Global H loss: 0.0353 [0m
[94mEpoch: 1|  NKD Loss: 1.1947 | CT Loss: 3.1983| [0m
[91mEpoch: 1|  Loss:  5.4204 |Global loss: 6.7194| Local H loss: 0.0187  | Global H loss: 0.0224 [0m
[94mEpoch: 2|  NKD Loss: 1.0872 | CT Loss: 3.1124| [0m
[91mEpoch: 2|  Loss:  5.1932 |Global loss: 6.2293| Local H loss: 0.018  | Global H loss: 0.0186 [0m
[94mEpoch: 3|  NKD Loss: 1.0199 | CT Loss: 3.0804| [0m
[91mEpoch: 3|  Loss:  5.1003 |Global loss: 6.0801| Local H loss: 0.017  | Global H loss: 0.0175 [0m
[94mEpoch: 0|  NKD Loss: 1.1833 | CT Loss: 3.3123| [0m
[91mEpoch: 0|  Loss:  5.0646 |Global loss: 7.1345| Local H loss: 0.0352  | Global H loss: 0.0355 [0m
[94mEpoch: 1|  NKD Loss: 0.6884 | CT Loss: 3.1162| [0m
[91mEpoch: 1|  Loss:  4.3634 |Global loss: 5.3913| Local H loss: 0.0322  | Global H loss: 0.0258 [0m
[94mEpoch: 2|  NKD Loss: 0.6726 | CT Loss: 3.1106| [0m
[91mEpoch: 2|  Loss:  4.3279 |Global loss: 5.2714| Local H loss: 0.0318  | Global H loss: 0.0259 [0m
[94mEpoch: 3|  NKD Loss: 0.6202 | CT Loss: 3.0914| [0m
[91mEpoch: 3|  Loss:  4.2336 |Global loss: 5.0991| Local H loss: 0.0308  | Global H loss: 0.025 [0m
[94mEpoch: 0|  NKD Loss: 1.4621 | CT Loss: 3.2491| [0m
[91mEpoch: 0|  Loss:  5.6522 |Global loss: 8.0173| Local H loss: 0.0202  | Global H loss: 0.0297 [0m
[94mEpoch: 1|  NKD Loss: 1.0751 | CT Loss: 3.0334| [0m
[91mEpoch: 1|  Loss:  4.9934 |Global loss: 6.3936| Local H loss: 0.0165  | Global H loss: 0.0196 [0m
[94mEpoch: 2|  NKD Loss: 1.0371 | CT Loss: 3.0259| [0m
[91mEpoch: 2|  Loss:  4.8891 |Global loss: 6.0884| Local H loss: 0.0192  | Global H loss: 0.0184 [0m
[94mEpoch: 3|  NKD Loss: 0.9574 | CT Loss: 3.0134| [0m
[91mEpoch: 3|  Loss:  4.7834 |Global loss: 5.8937| Local H loss: 0.0199  | Global H loss: 0.018 [0m
------------------------- time cost ------------------------- 11.337405443191528
Chosen Clients:  [7, 4, 0]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.758, 0.681, 0.855, 0.752, 0.757, 0.76, 0.824, 0.71, 1.0]
AUC in each clients:  [445.542, 468.526, 322.405, 415.939, 485.97, 443.368, 423.137, 455.328, 12.0]
F1 Score:  [0.698, 0.568, 0.809, 0.639, 0.599, 0.595, 0.646, 0.541, 1.0]
Recall Score:  [0.719, 0.586, 0.794, 0.68, 0.639, 0.643, 0.67, 0.577, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.1243
Averaged Test Accurancy: 0.7579
Averaged Test AUC: 0.9249
Averaged Test F1_score: 0.6772
Averaged Test Recal score: 0.7009
Std Test Accurancy: 0.0896
Std Test AUC: 0.0276
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.3666 | CT Loss: 3.3077| [0m
[91mEpoch: 0|  Loss:  5.7752 |Global loss: 7.5088| Local H loss: 0.0179  | Global H loss: 0.0227 [0m
[94mEpoch: 1|  NKD Loss: 1.0446 | CT Loss: 3.0691| [0m
[91mEpoch: 1|  Loss:  5.1802 |Global loss: 6.116| Local H loss: 0.0133  | Global H loss: 0.0133 [0m
[94mEpoch: 2|  NKD Loss: 0.992 | CT Loss: 3.0431| [0m
[91mEpoch: 2|  Loss:  5.0798 |Global loss: 5.9642| Local H loss: 0.0132  | Global H loss: 0.0129 [0m
[94mEpoch: 3|  NKD Loss: 0.9904 | CT Loss: 3.0285| [0m
[91mEpoch: 3|  Loss:  5.0312 |Global loss: 5.8845| Local H loss: 0.013  | Global H loss: 0.0123 [0m
[94mEpoch: 0|  NKD Loss: 1.5625 | CT Loss: 3.334| [0m
[91mEpoch: 0|  Loss:  5.9012 |Global loss: 7.994| Local H loss: 0.0251  | Global H loss: 0.0321 [0m
[94mEpoch: 1|  NKD Loss: 1.1559 | CT Loss: 3.1015| [0m
[91mEpoch: 1|  Loss:  5.2354 |Global loss: 6.474| Local H loss: 0.0199  | Global H loss: 0.0213 [0m
[94mEpoch: 2|  NKD Loss: 1.0952 | CT Loss: 3.0926| [0m
[91mEpoch: 2|  Loss:  5.1352 |Global loss: 6.2392| Local H loss: 0.0209  | Global H loss: 0.021 [0m
[94mEpoch: 3|  NKD Loss: 1.0088 | CT Loss: 3.0668| [0m
[91mEpoch: 3|  Loss:  4.9945 |Global loss: 6.0939| Local H loss: 0.0216  | Global H loss: 0.0207 [0m
[94mEpoch: 0|  NKD Loss: 1.3795 | CT Loss: 3.1763| [0m
[91mEpoch: 0|  Loss:  5.3848 |Global loss: 7.6446| Local H loss: 0.0226  | Global H loss: 0.0294 [0m
[94mEpoch: 1|  NKD Loss: 0.997 | CT Loss: 3.0287| [0m
[91mEpoch: 1|  Loss:  4.7988 |Global loss: 6.024| Local H loss: 0.0216  | Global H loss: 0.0204 [0m
[94mEpoch: 2|  NKD Loss: 0.9186 | CT Loss: 3.0203| [0m
[91mEpoch: 2|  Loss:  4.6724 |Global loss: 5.8668| Local H loss: 0.0235  | Global H loss: 0.0209 [0m
[94mEpoch: 3|  NKD Loss: 0.9191 | CT Loss: 3.0162| [0m
[91mEpoch: 3|  Loss:  4.6829 |Global loss: 5.8478| Local H loss: 0.0232  | Global H loss: 0.0202 [0m
------------------------- time cost ------------------------- 11.828813314437866
Chosen Clients:  [6, 3, 4]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.795, 0.681, 0.855, 0.752, 0.761, 0.76, 0.824, 0.769, 1.0]
AUC in each clients:  [447.46, 468.526, 322.405, 415.939, 487.341, 443.368, 423.137, 462.617, 12.0]
F1 Score:  [0.744, 0.568, 0.809, 0.639, 0.608, 0.595, 0.646, 0.603, 1.0]
Recall Score:  [0.756, 0.586, 0.794, 0.68, 0.645, 0.643, 0.67, 0.639, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.1146
Averaged Test Accurancy: 0.7712
Averaged Test AUC: 0.9278
Averaged Test F1_score: 0.6902
Averaged Test Recal score: 0.7126
Std Test Accurancy: 0.0844
Std Test AUC: 0.0255
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.4717 | CT Loss: 3.4259| [0m
[91mEpoch: 0|  Loss:  5.6321 |Global loss: 7.6275| Local H loss: 0.032  | Global H loss: 0.0345 [0m
[94mEpoch: 1|  NKD Loss: 0.9044 | CT Loss: 3.1179| [0m
[91mEpoch: 1|  Loss:  4.7523 |Global loss: 5.8228| Local H loss: 0.024  | Global H loss: 0.0221 [0m
[94mEpoch: 2|  NKD Loss: 0.8266 | CT Loss: 3.0857| [0m
[91mEpoch: 2|  Loss:  4.6265 |Global loss: 5.5346| Local H loss: 0.0234  | Global H loss: 0.0189 [0m
[94mEpoch: 3|  NKD Loss: 0.7753 | CT Loss: 3.0718| [0m
[91mEpoch: 3|  Loss:  4.5362 |Global loss: 5.428| Local H loss: 0.0237  | Global H loss: 0.0197 [0m
[94mEpoch: 0|  NKD Loss: 1.1854 | CT Loss: 3.2535| [0m
[91mEpoch: 0|  Loss:  5.1863 |Global loss: 6.9187| Local H loss: 0.0303  | Global H loss: 0.031 [0m
[94mEpoch: 1|  NKD Loss: 0.7615 | CT Loss: 3.0691| [0m
[91mEpoch: 1|  Loss:  4.5692 |Global loss: 5.5385| Local H loss: 0.0245  | Global H loss: 0.0208 [0m
[94mEpoch: 2|  NKD Loss: 0.7161 | CT Loss: 3.0509| [0m
[91mEpoch: 2|  Loss:  4.5026 |Global loss: 5.3868| Local H loss: 0.0228  | Global H loss: 0.0192 [0m
[94mEpoch: 3|  NKD Loss: 0.6652 | CT Loss: 3.0393| [0m
[91mEpoch: 3|  Loss:  4.4092 |Global loss: 5.2786| Local H loss: 0.0214  | Global H loss: 0.0181 [0m
[94mEpoch: 0|  NKD Loss: 1.4331 | CT Loss: 3.3091| [0m
[91mEpoch: 0|  Loss:  5.7217 |Global loss: 7.791| Local H loss: 0.0251  | Global H loss: 0.0309 [0m
[94mEpoch: 1|  NKD Loss: 1.1126 | CT Loss: 3.0909| [0m
[91mEpoch: 1|  Loss:  5.1286 |Global loss: 6.3846| Local H loss: 0.0218  | Global H loss: 0.0227 [0m
[94mEpoch: 2|  NKD Loss: 1.0406 | CT Loss: 3.0641| [0m
[91mEpoch: 2|  Loss:  5.0016 |Global loss: 6.1726| Local H loss: 0.023  | Global H loss: 0.0218 [0m
[94mEpoch: 3|  NKD Loss: 0.9419 | CT Loss: 3.0448| [0m
[91mEpoch: 3|  Loss:  4.8691 |Global loss: 5.9238| Local H loss: 0.0227  | Global H loss: 0.0212 [0m
------------------------- time cost ------------------------- 11.586765050888062
Chosen Clients:  [7, 8, 5]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.795, 0.681, 0.855, 0.761, 0.765, 0.76, 0.842, 0.769, 1.0]
AUC in each clients:  [447.46, 468.526, 322.405, 419.132, 489.283, 443.368, 426.434, 462.617, 12.0]
F1 Score:  [0.744, 0.568, 0.809, 0.657, 0.615, 0.595, 0.682, 0.603, 1.0]
Recall Score:  [0.756, 0.586, 0.794, 0.69, 0.649, 0.643, 0.696, 0.639, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.2267
Averaged Test Accurancy: 0.7749
Averaged Test AUC: 0.9300
Averaged Test F1_score: 0.6970
Averaged Test Recal score: 0.7170
Std Test Accurancy: 0.0845
Std Test AUC: 0.0254
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.3819 | CT Loss: 3.3527| [0m
[91mEpoch: 0|  Loss:  5.7525 |Global loss: 7.4951| Local H loss: 0.0216  | Global H loss: 0.026 [0m
[94mEpoch: 1|  NKD Loss: 1.0492 | CT Loss: 3.0806| [0m
[91mEpoch: 1|  Loss:  5.1096 |Global loss: 6.1055| Local H loss: 0.0164  | Global H loss: 0.0161 [0m
[94mEpoch: 2|  NKD Loss: 0.9891 | CT Loss: 3.0406| [0m
[91mEpoch: 2|  Loss:  4.9603 |Global loss: 5.8835| Local H loss: 0.0165  | Global H loss: 0.015 [0m
[94mEpoch: 3|  NKD Loss: 0.8974 | CT Loss: 3.0204| [0m
[91mEpoch: 3|  Loss:  4.8389 |Global loss: 5.7577| Local H loss: 0.0157  | Global H loss: 0.0142 [0m
[94mEpoch: 0|  NKD Loss: 2.0838 | CT Loss: 4.3913| [0m
[91mEpoch: 0|  Loss:  8.2211 |Global loss: 17.6269| Local H loss: 0.0116  | Global H loss: 0.0374 [0m
[94mEpoch: 1|  NKD Loss: 2.0293 | CT Loss: 4.2486| [0m
[91mEpoch: 1|  Loss:  7.9835 |Global loss: 12.7901| Local H loss: 0.018  | Global H loss: 0.0286 [0m
[94mEpoch: 2|  NKD Loss: 1.9939 | CT Loss: 4.2196| [0m
[91mEpoch: 2|  Loss:  7.8644 |Global loss: 11.6114| Local H loss: 0.0127  | Global H loss: 0.0199 [0m
[94mEpoch: 3|  NKD Loss: 2.0045 | CT Loss: 4.2106| [0m
[91mEpoch: 3|  Loss:  7.8031 |Global loss: 10.658| Local H loss: 0.014  | Global H loss: 0.0195 [0m
[94mEpoch: 0|  NKD Loss: 1.6744 | CT Loss: 3.6401| [0m
[91mEpoch: 0|  Loss:  6.4192 |Global loss: 8.2817| Local H loss: 0.0219  | Global H loss: 0.0293 [0m
[94mEpoch: 1|  NKD Loss: 1.1686 | CT Loss: 3.2895| [0m
[91mEpoch: 1|  Loss:  5.596 |Global loss: 6.5717| Local H loss: 0.0138  | Global H loss: 0.0168 [0m
[94mEpoch: 2|  NKD Loss: 1.0804 | CT Loss: 3.19| [0m
[91mEpoch: 2|  Loss:  5.3769 |Global loss: 6.1842| Local H loss: 0.0121  | Global H loss: 0.0134 [0m
[94mEpoch: 3|  NKD Loss: 0.9973 | CT Loss: 3.151| [0m
[91mEpoch: 3|  Loss:  5.2105 |Global loss: 6.0275| Local H loss: 0.0126  | Global H loss: 0.0138 [0m
------------------------- time cost ------------------------- 9.473685503005981
Chosen Clients:  [4, 3, 2]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.795, 0.681, 0.855, 0.761, 0.765, 0.747, 0.842, 0.775, 1.0]
AUC in each clients:  [447.46, 468.526, 322.405, 419.132, 489.283, 442.592, 426.434, 469.598, 12.0]
F1 Score:  [0.744, 0.568, 0.809, 0.657, 0.615, 0.594, 0.682, 0.612, 1.0]
Recall Score:  [0.756, 0.586, 0.794, 0.69, 0.649, 0.641, 0.696, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.1714
Averaged Test Accurancy: 0.7741
Averaged Test AUC: 0.9317
Averaged Test F1_score: 0.6979
Averaged Test Recal score: 0.7180
Std Test Accurancy: 0.0850
Std Test AUC: 0.0243
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.7088 | CT Loss: 3.5121| [0m
[91mEpoch: 0|  Loss:  6.2957 |Global loss: 8.3566| Local H loss: 0.0238  | Global H loss: 0.0287 [0m
[94mEpoch: 1|  NKD Loss: 1.1807 | CT Loss: 3.1683| [0m
[91mEpoch: 1|  Loss:  5.2742 |Global loss: 6.4872| Local H loss: 0.0243  | Global H loss: 0.0245 [0m
[94mEpoch: 2|  NKD Loss: 1.0208 | CT Loss: 3.0718| [0m
[91mEpoch: 2|  Loss:  4.9696 |Global loss: 6.0618| Local H loss: 0.0227  | Global H loss: 0.0217 [0m
[94mEpoch: 3|  NKD Loss: 0.9797 | CT Loss: 3.045| [0m
[91mEpoch: 3|  Loss:  4.9052 |Global loss: 5.9255| Local H loss: 0.0213  | Global H loss: 0.0201 [0m
[94mEpoch: 0|  NKD Loss: 1.3969 | CT Loss: 3.3702| [0m
[91mEpoch: 0|  Loss:  5.4843 |Global loss: 7.1736| Local H loss: 0.0361  | Global H loss: 0.0331 [0m
[94mEpoch: 1|  NKD Loss: 0.88 | CT Loss: 3.1272| [0m
[91mEpoch: 1|  Loss:  4.712 |Global loss: 5.8059| Local H loss: 0.0298  | Global H loss: 0.0245 [0m
[94mEpoch: 2|  NKD Loss: 0.7693 | CT Loss: 3.056| [0m
[91mEpoch: 2|  Loss:  4.5179 |Global loss: 5.5172| Local H loss: 0.0252  | Global H loss: 0.0211 [0m
[94mEpoch: 3|  NKD Loss: 0.7463 | CT Loss: 3.0528| [0m
[91mEpoch: 3|  Loss:  4.4948 |Global loss: 5.4878| Local H loss: 0.025  | Global H loss: 0.021 [0m
[94mEpoch: 0|  NKD Loss: 1.0106 | CT Loss: 3.2853| [0m
[91mEpoch: 0|  Loss:  4.8203 |Global loss: 6.4713| Local H loss: 0.0411  | Global H loss: 0.0361 [0m
[94mEpoch: 1|  NKD Loss: 0.6259 | CT Loss: 3.1217| [0m
[91mEpoch: 1|  Loss:  4.2803 |Global loss: 5.1981| Local H loss: 0.0326  | Global H loss: 0.0251 [0m
[94mEpoch: 2|  NKD Loss: 0.5352 | CT Loss: 3.1086| [0m
[91mEpoch: 2|  Loss:  4.1153 |Global loss: 4.9571| Local H loss: 0.0371  | Global H loss: 0.0269 [0m
[94mEpoch: 3|  NKD Loss: 0.4886 | CT Loss: 3.0897| [0m
[91mEpoch: 3|  Loss:  4.0392 |Global loss: 4.9112| Local H loss: 0.0342  | Global H loss: 0.0256 [0m
------------------------- time cost ------------------------- 10.727015256881714
Chosen Clients:  [1, 6, 3]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.795, 0.681, 0.872, 0.81, 0.77, 0.747, 0.842, 0.775, 1.0]
AUC in each clients:  [447.46, 468.526, 323.272, 418.053, 491.038, 442.592, 426.434, 469.598, 12.0]
F1 Score:  [0.744, 0.568, 0.834, 0.7, 0.607, 0.594, 0.682, 0.612, 1.0]
Recall Score:  [0.756, 0.586, 0.818, 0.732, 0.651, 0.641, 0.696, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.2970
Averaged Test Accurancy: 0.7824
Averaged Test AUC: 0.9321
Averaged Test F1_score: 0.7046
Averaged Test Recal score: 0.7256
Std Test Accurancy: 0.0847
Std Test AUC: 0.0244
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.5647 | CT Loss: 3.5042| [0m
[91mEpoch: 0|  Loss:  6.2601 |Global loss: 8.4299| Local H loss: 0.0186  | Global H loss: 0.0249 [0m
[94mEpoch: 1|  NKD Loss: 0.882 | CT Loss: 3.0379| [0m
[91mEpoch: 1|  Loss:  4.8734 |Global loss: 5.904| Local H loss: 0.0154  | Global H loss: 0.015 [0m
[94mEpoch: 2|  NKD Loss: 0.8318 | CT Loss: 3.0018| [0m
[91mEpoch: 2|  Loss:  4.7333 |Global loss: 5.7255| Local H loss: 0.0159  | Global H loss: 0.015 [0m
[94mEpoch: 3|  NKD Loss: 0.7935 | CT Loss: 2.9898| [0m
[91mEpoch: 3|  Loss:  4.6626 |Global loss: 5.6768| Local H loss: 0.016  | Global H loss: 0.0151 [0m
[94mEpoch: 0|  NKD Loss: 1.2996 | CT Loss: 3.3913| [0m
[91mEpoch: 0|  Loss:  5.3813 |Global loss: 7.2321| Local H loss: 0.0328  | Global H loss: 0.0348 [0m
[94mEpoch: 1|  NKD Loss: 0.8485 | CT Loss: 3.1279| [0m
[91mEpoch: 1|  Loss:  4.6537 |Global loss: 5.7245| Local H loss: 0.0259  | Global H loss: 0.0239 [0m
[94mEpoch: 2|  NKD Loss: 0.7722 | CT Loss: 3.0722| [0m
[91mEpoch: 2|  Loss:  4.4947 |Global loss: 5.5073| Local H loss: 0.0253  | Global H loss: 0.0224 [0m
[94mEpoch: 3|  NKD Loss: 0.6435 | CT Loss: 3.05| [0m
[91mEpoch: 3|  Loss:  4.3424 |Global loss: 5.2258| Local H loss: 0.0236  | Global H loss: 0.0191 [0m
[94mEpoch: 0|  NKD Loss: 1.1883 | CT Loss: 3.2538| [0m
[91mEpoch: 0|  Loss:  5.1344 |Global loss: 6.7043| Local H loss: 0.0327  | Global H loss: 0.0319 [0m
[94mEpoch: 1|  NKD Loss: 0.7182 | CT Loss: 3.0533| [0m
[91mEpoch: 1|  Loss:  4.4303 |Global loss: 5.3943| Local H loss: 0.0252  | Global H loss: 0.0213 [0m
[94mEpoch: 2|  NKD Loss: 0.6369 | CT Loss: 3.0338| [0m
[91mEpoch: 2|  Loss:  4.3049 |Global loss: 5.1986| Local H loss: 0.0257  | Global H loss: 0.0211 [0m
[94mEpoch: 3|  NKD Loss: 0.5982 | CT Loss: 3.0228| [0m
[91mEpoch: 3|  Loss:  4.2398 |Global loss: 5.0765| Local H loss: 0.0251  | Global H loss: 0.0201 [0m
------------------------- time cost ------------------------- 11.377517223358154
Chosen Clients:  [1, 2, 0]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.795, 0.734, 0.872, 0.81, 0.77, 0.747, 0.82, 0.775, 1.0]
AUC in each clients:  [447.46, 471.786, 323.272, 422.157, 491.038, 442.592, 427.524, 469.598, 12.0]
F1 Score:  [0.744, 0.635, 0.834, 0.722, 0.607, 0.594, 0.643, 0.612, 1.0]
Recall Score:  [0.756, 0.647, 0.818, 0.745, 0.651, 0.641, 0.666, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.5165
Averaged Test Accurancy: 0.7869
Averaged Test AUC: 0.9343
Averaged Test F1_score: 0.7101
Averaged Test Recal score: 0.7304
Std Test Accurancy: 0.0765
Std Test AUC: 0.0239
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.0825 | CT Loss: 3.1792| [0m
[91mEpoch: 0|  Loss:  5.1043 |Global loss: 6.7928| Local H loss: 0.0226  | Global H loss: 0.0266 [0m
[94mEpoch: 1|  NKD Loss: 0.7796 | CT Loss: 3.0037| [0m
[91mEpoch: 1|  Loss:  4.6068 |Global loss: 5.6451| Local H loss: 0.0182  | Global H loss: 0.0175 [0m
[94mEpoch: 2|  NKD Loss: 0.7417 | CT Loss: 2.998| [0m
[91mEpoch: 2|  Loss:  4.5464 |Global loss: 5.5421| Local H loss: 0.0195  | Global H loss: 0.018 [0m
[94mEpoch: 3|  NKD Loss: 0.7172 | CT Loss: 2.9883| [0m
[91mEpoch: 3|  Loss:  4.4771 |Global loss: 5.4895| Local H loss: 0.0207  | Global H loss: 0.019 [0m
[94mEpoch: 0|  NKD Loss: 0.9381 | CT Loss: 3.3144| [0m
[91mEpoch: 0|  Loss:  4.7557 |Global loss: 6.4622| Local H loss: 0.0425  | Global H loss: 0.0377 [0m
[94mEpoch: 1|  NKD Loss: 0.514 | CT Loss: 3.1377| [0m
[91mEpoch: 1|  Loss:  4.1515 |Global loss: 5.0893| Local H loss: 0.0344  | Global H loss: 0.0272 [0m
[94mEpoch: 2|  NKD Loss: 0.4912 | CT Loss: 3.1158| [0m
[91mEpoch: 2|  Loss:  4.0589 |Global loss: 4.9552| Local H loss: 0.0338  | Global H loss: 0.0261 [0m
[94mEpoch: 3|  NKD Loss: 0.4644 | CT Loss: 3.1088| [0m
[91mEpoch: 3|  Loss:  3.9797 |Global loss: 4.9291| Local H loss: 0.0366  | Global H loss: 0.0289 [0m
[94mEpoch: 0|  NKD Loss: 1.3214 | CT Loss: 3.2223| [0m
[91mEpoch: 0|  Loss:  5.3559 |Global loss: 7.7149| Local H loss: 0.0258  | Global H loss: 0.0333 [0m
[94mEpoch: 1|  NKD Loss: 1.0077 | CT Loss: 3.0307| [0m
[91mEpoch: 1|  Loss:  4.7575 |Global loss: 6.1665| Local H loss: 0.0237  | Global H loss: 0.0239 [0m
[94mEpoch: 2|  NKD Loss: 0.9286 | CT Loss: 3.0084| [0m
[91mEpoch: 2|  Loss:  4.6286 |Global loss: 5.8502| Local H loss: 0.0252  | Global H loss: 0.0223 [0m
[94mEpoch: 3|  NKD Loss: 0.8887 | CT Loss: 3.0042| [0m
[91mEpoch: 3|  Loss:  4.5653 |Global loss: 5.7636| Local H loss: 0.0264  | Global H loss: 0.0231 [0m
------------------------- time cost ------------------------- 10.953758955001831
Chosen Clients:  [3, 5, 8]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.839, 0.728, 0.875, 0.81, 0.77, 0.747, 0.82, 0.775, 1.0]
AUC in each clients:  [450.225, 475.49, 324.081, 422.157, 491.038, 442.592, 427.524, 469.598, 12.0]
F1 Score:  [0.801, 0.672, 0.835, 0.722, 0.607, 0.594, 0.643, 0.612, 1.0]
Recall Score:  [0.805, 0.674, 0.82, 0.745, 0.651, 0.641, 0.666, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.5181
Averaged Test Accurancy: 0.7920
Averaged Test AUC: 0.9363
Averaged Test F1_score: 0.7207
Averaged Test Recal score: 0.7391
Std Test Accurancy: 0.0775
Std Test AUC: 0.0234
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.0999 | CT Loss: 3.2139| [0m
[91mEpoch: 0|  Loss:  4.9488 |Global loss: 6.7022| Local H loss: 0.0361  | Global H loss: 0.0338 [0m
[94mEpoch: 1|  NKD Loss: 0.6374 | CT Loss: 3.0477| [0m
[91mEpoch: 1|  Loss:  4.296 |Global loss: 5.2999| Local H loss: 0.0279  | Global H loss: 0.0233 [0m
[94mEpoch: 2|  NKD Loss: 0.6066 | CT Loss: 3.0325| [0m
[91mEpoch: 2|  Loss:  4.238 |Global loss: 5.1538| Local H loss: 0.0272  | Global H loss: 0.0221 [0m
[94mEpoch: 3|  NKD Loss: 0.5579 | CT Loss: 3.0191| [0m
[91mEpoch: 3|  Loss:  4.1652 |Global loss: 5.1035| Local H loss: 0.0277  | Global H loss: 0.0223 [0m
[94mEpoch: 0|  NKD Loss: 1.4666 | CT Loss: 3.3966| [0m
[91mEpoch: 0|  Loss:  5.9436 |Global loss: 7.9116| Local H loss: 0.0203  | Global H loss: 0.0301 [0m
[94mEpoch: 1|  NKD Loss: 1.0697 | CT Loss: 3.1653| [0m
[91mEpoch: 1|  Loss:  5.282 |Global loss: 6.2683| Local H loss: 0.0154  | Global H loss: 0.0169 [0m
[94mEpoch: 2|  NKD Loss: 1.0241 | CT Loss: 3.1343| [0m
[91mEpoch: 2|  Loss:  5.1455 |Global loss: 6.07| Local H loss: 0.0153  | Global H loss: 0.0163 [0m
[94mEpoch: 3|  NKD Loss: 0.9769 | CT Loss: 3.1088| [0m
[91mEpoch: 3|  Loss:  5.059 |Global loss: 5.9345| Local H loss: 0.0155  | Global H loss: 0.0157 [0m
[94mEpoch: 0|  NKD Loss: 2.0581 | CT Loss: 4.5975| [0m
[91mEpoch: 0|  Loss:  8.1703 |Global loss: 22.3174| Local H loss: 0.0098  | Global H loss: 0.0466 [0m
[94mEpoch: 1|  NKD Loss: 1.9413 | CT Loss: 4.2249| [0m
[91mEpoch: 1|  Loss:  7.6152 |Global loss: 14.7553| Local H loss: 0.012  | Global H loss: 0.0346 [0m
[94mEpoch: 2|  NKD Loss: 1.9313 | CT Loss: 4.2164| [0m
[91mEpoch: 2|  Loss:  7.5055 |Global loss: 12.9191| Local H loss: 0.0132  | Global H loss: 0.0356 [0m
[94mEpoch: 3|  NKD Loss: 1.915 | CT Loss: 4.2059| [0m
[91mEpoch: 3|  Loss:  7.386 |Global loss: 11.347| Local H loss: 0.0153  | Global H loss: 0.0359 [0m
------------------------- time cost ------------------------- 8.873875379562378
Chosen Clients:  [2, 8, 1]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.839, 0.728, 0.875, 0.821, 0.77, 0.749, 0.82, 0.775, 1.0]
AUC in each clients:  [450.225, 475.49, 324.081, 422.863, 491.038, 443.615, 427.524, 469.598, 12.0]
F1 Score:  [0.801, 0.672, 0.835, 0.725, 0.607, 0.604, 0.643, 0.612, 1.0]
Recall Score:  [0.805, 0.674, 0.82, 0.75, 0.651, 0.648, 0.666, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.7091
Averaged Test Accurancy: 0.7936
Averaged Test AUC: 0.9367
Averaged Test F1_score: 0.7221
Averaged Test Recal score: 0.7404
Std Test Accurancy: 0.0772
Std Test AUC: 0.0231
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 0.9903 | CT Loss: 3.3683| [0m
[91mEpoch: 0|  Loss:  4.8161 |Global loss: 6.6764| Local H loss: 0.0439  | Global H loss: 0.0403 [0m
[94mEpoch: 1|  NKD Loss: 0.669 | CT Loss: 3.1508| [0m
[91mEpoch: 1|  Loss:  4.2814 |Global loss: 5.5618| Local H loss: 0.0381  | Global H loss: 0.0333 [0m
[94mEpoch: 2|  NKD Loss: 0.5779 | CT Loss: 3.1038| [0m
[91mEpoch: 2|  Loss:  4.1283 |Global loss: 5.1894| Local H loss: 0.0385  | Global H loss: 0.0312 [0m
[94mEpoch: 3|  NKD Loss: 0.5266 | CT Loss: 3.1027| [0m
[91mEpoch: 3|  Loss:  4.0648 |Global loss: 5.036| Local H loss: 0.04  | Global H loss: 0.0312 [0m
[94mEpoch: 0|  NKD Loss: 2.0059 | CT Loss: 4.5319| [0m
[91mEpoch: 0|  Loss:  7.6976 |Global loss: 19.0974| Local H loss: 0.0128  | Global H loss: 0.0458 [0m
[94mEpoch: 1|  NKD Loss: 1.9011 | CT Loss: 4.216| [0m
[91mEpoch: 1|  Loss:  7.1807 |Global loss: 13.5537| Local H loss: 0.0168  | Global H loss: 0.0421 [0m
[94mEpoch: 2|  NKD Loss: 1.8474 | CT Loss: 4.2036| [0m
[91mEpoch: 2|  Loss:  7.0041 |Global loss: 11.9624| Local H loss: 0.016  | Global H loss: 0.0387 [0m
[94mEpoch: 3|  NKD Loss: 1.8248 | CT Loss: 4.2006| [0m
[91mEpoch: 3|  Loss:  6.8649 |Global loss: 10.4793| Local H loss: 0.0198  | Global H loss: 0.0401 [0m
[94mEpoch: 0|  NKD Loss: 1.2206 | CT Loss: 3.2228| [0m
[91mEpoch: 0|  Loss:  5.2392 |Global loss: 7.1084| Local H loss: 0.0263  | Global H loss: 0.0294 [0m
[94mEpoch: 1|  NKD Loss: 0.7493 | CT Loss: 3.0055| [0m
[91mEpoch: 1|  Loss:  4.5015 |Global loss: 5.6177| Local H loss: 0.0216  | Global H loss: 0.0205 [0m
[94mEpoch: 2|  NKD Loss: 0.7141 | CT Loss: 2.9968| [0m
[91mEpoch: 2|  Loss:  4.4478 |Global loss: 5.5226| Local H loss: 0.0225  | Global H loss: 0.0205 [0m
[94mEpoch: 3|  NKD Loss: 0.6455 | CT Loss: 2.9761| [0m
[91mEpoch: 3|  Loss:  4.3248 |Global loss: 5.3527| Local H loss: 0.0229  | Global H loss: 0.0204 [0m
------------------------- time cost ------------------------- 8.41352105140686
Chosen Clients:  [3, 7, 8]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.839, 0.776, 0.887, 0.821, 0.77, 0.749, 0.82, 0.775, 1.0]
AUC in each clients:  [450.225, 477.75, 324.534, 422.863, 491.038, 443.615, 427.524, 469.598, 12.0]
F1 Score:  [0.801, 0.718, 0.856, 0.725, 0.607, 0.604, 0.643, 0.612, 1.0]
Recall Score:  [0.805, 0.721, 0.839, 0.75, 0.651, 0.648, 0.666, 0.65, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.6884
Averaged Test Accurancy: 0.8010
Averaged Test AUC: 0.9374
Averaged Test F1_score: 0.7296
Averaged Test Recal score: 0.7478
Std Test Accurancy: 0.0733
Std Test AUC: 0.0231
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.0163 | CT Loss: 3.2066| [0m
[91mEpoch: 0|  Loss:  4.7898 |Global loss: 6.4489| Local H loss: 0.0374  | Global H loss: 0.0341 [0m
[94mEpoch: 1|  NKD Loss: 0.6194 | CT Loss: 3.0415| [0m
[91mEpoch: 1|  Loss:  4.2266 |Global loss: 5.2742| Local H loss: 0.0306  | Global H loss: 0.0248 [0m
[94mEpoch: 2|  NKD Loss: 0.5881 | CT Loss: 3.0353| [0m
[91mEpoch: 2|  Loss:  4.1803 |Global loss: 5.1639| Local H loss: 0.0314  | Global H loss: 0.0248 [0m
[94mEpoch: 3|  NKD Loss: 0.5582 | CT Loss: 3.0193| [0m
[91mEpoch: 3|  Loss:  4.1215 |Global loss: 5.0449| Local H loss: 0.0299  | Global H loss: 0.0238 [0m
[94mEpoch: 0|  NKD Loss: 1.2529 | CT Loss: 3.3349| [0m
[91mEpoch: 0|  Loss:  5.5017 |Global loss: 7.3419| Local H loss: 0.0246  | Global H loss: 0.0281 [0m
[94mEpoch: 1|  NKD Loss: 0.9078 | CT Loss: 3.0775| [0m
[91mEpoch: 1|  Loss:  4.891 |Global loss: 5.9829| Local H loss: 0.0183  | Global H loss: 0.018 [0m
[94mEpoch: 2|  NKD Loss: 0.8715 | CT Loss: 3.0407| [0m
[91mEpoch: 2|  Loss:  4.7837 |Global loss: 5.7223| Local H loss: 0.0182  | Global H loss: 0.0166 [0m
[94mEpoch: 3|  NKD Loss: 0.8378 | CT Loss: 3.0316| [0m
[91mEpoch: 3|  Loss:  4.726 |Global loss: 5.6883| Local H loss: 0.0187  | Global H loss: 0.0166 [0m
[94mEpoch: 0|  NKD Loss: 1.9384 | CT Loss: 4.6467| [0m
[91mEpoch: 0|  Loss:  7.3002 |Global loss: 22.0957| Local H loss: 0.0127  | Global H loss: 0.0571 [0m
[94mEpoch: 1|  NKD Loss: 1.7341 | CT Loss: 4.1981| [0m
[91mEpoch: 1|  Loss:  6.5525 |Global loss: 14.0588| Local H loss: 0.0186  | Global H loss: 0.05 [0m
[94mEpoch: 2|  NKD Loss: 1.6733 | CT Loss: 4.1979| [0m
[91mEpoch: 2|  Loss:  6.3892 |Global loss: 11.9646| Local H loss: 0.0211  | Global H loss: 0.0508 [0m
[94mEpoch: 3|  NKD Loss: 1.6883 | CT Loss: 4.1975| [0m
[91mEpoch: 3|  Loss:  6.3198 |Global loss: 10.3673| Local H loss: 0.0282  | Global H loss: 0.0526 [0m
------------------------- time cost ------------------------- 9.19397258758545
Chosen Clients:  [5, 2, 0]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.839, 0.776, 0.887, 0.852, 0.77, 0.749, 0.82, 0.801, 1.0]
AUC in each clients:  [450.225, 477.75, 324.534, 424.76, 491.038, 443.615, 427.524, 471.57, 12.0]
F1 Score:  [0.801, 0.718, 0.856, 0.789, 0.607, 0.604, 0.643, 0.632, 1.0]
Recall Score:  [0.805, 0.721, 0.839, 0.796, 0.651, 0.648, 0.666, 0.671, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.7955
Averaged Test Accurancy: 0.8082
Averaged Test AUC: 0.9385
Averaged Test F1_score: 0.7389
Averaged Test Recal score: 0.7552
Std Test Accurancy: 0.0720
Std Test AUC: 0.0228
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.4515 | CT Loss: 3.3593| [0m
[91mEpoch: 0|  Loss:  5.7961 |Global loss: 7.8382| Local H loss: 0.0232  | Global H loss: 0.0287 [0m
[94mEpoch: 1|  NKD Loss: 1.0417 | CT Loss: 3.1099| [0m
[91mEpoch: 1|  Loss:  5.1215 |Global loss: 6.0349| Local H loss: 0.0179  | Global H loss: 0.0174 [0m
[94mEpoch: 2|  NKD Loss: 0.945 | CT Loss: 3.0757| [0m
[91mEpoch: 2|  Loss:  4.953 |Global loss: 5.8411| Local H loss: 0.0173  | Global H loss: 0.016 [0m
[94mEpoch: 3|  NKD Loss: 0.888 | CT Loss: 3.0575| [0m
[91mEpoch: 3|  Loss:  4.8755 |Global loss: 5.696| Local H loss: 0.0163  | Global H loss: 0.0153 [0m
[94mEpoch: 0|  NKD Loss: 0.9591 | CT Loss: 3.3021| [0m
[91mEpoch: 0|  Loss:  4.6774 |Global loss: 6.5547| Local H loss: 0.046  | Global H loss: 0.042 [0m
[94mEpoch: 1|  NKD Loss: 0.5364 | CT Loss: 3.1316| [0m
[91mEpoch: 1|  Loss:  4.0843 |Global loss: 5.1154| Local H loss: 0.0395  | Global H loss: 0.0312 [0m
[94mEpoch: 2|  NKD Loss: 0.4367 | CT Loss: 3.1132| [0m
[91mEpoch: 2|  Loss:  3.9284 |Global loss: 4.9261| Local H loss: 0.0385  | Global H loss: 0.0315 [0m
[94mEpoch: 3|  NKD Loss: 0.4378 | CT Loss: 3.0867| [0m
[91mEpoch: 3|  Loss:  3.9033 |Global loss: 4.8456| Local H loss: 0.0407  | Global H loss: 0.0306 [0m
[94mEpoch: 0|  NKD Loss: 1.3934 | CT Loss: 3.2257| [0m
[91mEpoch: 0|  Loss:  5.3619 |Global loss: 7.8345| Local H loss: 0.0286  | Global H loss: 0.0349 [0m
[94mEpoch: 1|  NKD Loss: 0.956 | CT Loss: 3.0179| [0m
[91mEpoch: 1|  Loss:  4.6334 |Global loss: 5.9425| Local H loss: 0.027  | Global H loss: 0.0249 [0m
[94mEpoch: 2|  NKD Loss: 0.8837 | CT Loss: 3.0093| [0m
[91mEpoch: 2|  Loss:  4.5608 |Global loss: 5.793| Local H loss: 0.0271  | Global H loss: 0.024 [0m
[94mEpoch: 3|  NKD Loss: 0.8436 | CT Loss: 2.9964| [0m
[91mEpoch: 3|  Loss:  4.4961 |Global loss: 5.7102| Local H loss: 0.0275  | Global H loss: 0.0243 [0m
------------------------- time cost ------------------------- 11.003397941589355
Chosen Clients:  [2, 5, 3]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.847, 0.776, 0.884, 0.852, 0.77, 0.764, 0.82, 0.801, 1.0]
AUC in each clients:  [451.216, 477.75, 325.223, 424.76, 491.038, 443.391, 427.524, 471.57, 12.0]
F1 Score:  [0.822, 0.718, 0.851, 0.789, 0.607, 0.626, 0.643, 0.632, 1.0]
Recall Score:  [0.819, 0.721, 0.838, 0.796, 0.651, 0.662, 0.666, 0.671, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.8816
Averaged Test Accurancy: 0.8109
Averaged Test AUC: 0.9389
Averaged Test F1_score: 0.7431
Averaged Test Recal score: 0.7582
Std Test Accurancy: 0.0701
Std Test AUC: 0.0229
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.0089 | CT Loss: 3.3041| [0m
[91mEpoch: 0|  Loss:  4.6911 |Global loss: 6.5996| Local H loss: 0.0482  | Global H loss: 0.0446 [0m
[94mEpoch: 1|  NKD Loss: 0.4569 | CT Loss: 3.1193| [0m
[91mEpoch: 1|  Loss:  3.9386 |Global loss: 5.0058| Local H loss: 0.0406  | Global H loss: 0.0333 [0m
[94mEpoch: 2|  NKD Loss: 0.4251 | CT Loss: 3.099| [0m
[91mEpoch: 2|  Loss:  3.885 |Global loss: 4.8573| Local H loss: 0.0436  | Global H loss: 0.0334 [0m
[94mEpoch: 3|  NKD Loss: 0.4165 | CT Loss: 3.0835| [0m
[91mEpoch: 3|  Loss:  3.8363 |Global loss: 4.8285| Local H loss: 0.0444  | Global H loss: 0.0339 [0m
[94mEpoch: 0|  NKD Loss: 1.4796 | CT Loss: 3.3751| [0m
[91mEpoch: 0|  Loss:  5.8174 |Global loss: 7.8801| Local H loss: 0.0245  | Global H loss: 0.0305 [0m
[94mEpoch: 1|  NKD Loss: 0.995 | CT Loss: 3.1135| [0m
[91mEpoch: 1|  Loss:  5.0303 |Global loss: 6.0779| Local H loss: 0.0179  | Global H loss: 0.0187 [0m
[94mEpoch: 2|  NKD Loss: 0.9948 | CT Loss: 3.098| [0m
[91mEpoch: 2|  Loss:  4.9936 |Global loss: 5.9337| Local H loss: 0.0189  | Global H loss: 0.0187 [0m
[94mEpoch: 3|  NKD Loss: 0.9251 | CT Loss: 3.064| [0m
[91mEpoch: 3|  Loss:  4.8587 |Global loss: 5.7759| Local H loss: 0.0182  | Global H loss: 0.0174 [0m
[94mEpoch: 0|  NKD Loss: 1.1016 | CT Loss: 3.2395| [0m
[91mEpoch: 0|  Loss:  4.8741 |Global loss: 6.7762| Local H loss: 0.0422  | Global H loss: 0.0395 [0m
[94mEpoch: 1|  NKD Loss: 0.6239 | CT Loss: 3.0435| [0m
[91mEpoch: 1|  Loss:  4.1769 |Global loss: 5.2573| Local H loss: 0.0339  | Global H loss: 0.0281 [0m
[94mEpoch: 2|  NKD Loss: 0.5668 | CT Loss: 3.019| [0m
[91mEpoch: 2|  Loss:  4.0953 |Global loss: 5.1075| Local H loss: 0.0321  | Global H loss: 0.0261 [0m
[94mEpoch: 3|  NKD Loss: 0.5484 | CT Loss: 3.0104| [0m
[91mEpoch: 3|  Loss:  4.0529 |Global loss: 5.0376| Local H loss: 0.0327  | Global H loss: 0.0262 [0m
------------------------- time cost ------------------------- 10.597750663757324
Chosen Clients:  [1, 5, 2]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.847, 0.776, 0.893, 0.841, 0.77, 0.807, 0.82, 0.801, 1.0]
AUC in each clients:  [451.216, 477.75, 325.847, 424.239, 491.038, 448.35, 427.524, 471.57, 12.0]
F1 Score:  [0.822, 0.718, 0.866, 0.793, 0.607, 0.679, 0.643, 0.632, 1.0]
Recall Score:  [0.819, 0.721, 0.849, 0.795, 0.651, 0.709, 0.666, 0.671, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0164
Averaged Test Accurancy: 0.8159
Averaged Test AUC: 0.9402
Averaged Test F1_score: 0.7511
Averaged Test Recal score: 0.7646
Std Test Accurancy: 0.0671
Std Test AUC: 0.0218
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.1451 | CT Loss: 3.2102| [0m
[91mEpoch: 0|  Loss:  5.0592 |Global loss: 6.9686| Local H loss: 0.0295  | Global H loss: 0.0317 [0m
[94mEpoch: 1|  NKD Loss: 0.7439 | CT Loss: 3.0114| [0m
[91mEpoch: 1|  Loss:  4.4583 |Global loss: 5.59| Local H loss: 0.0241  | Global H loss: 0.0228 [0m
[94mEpoch: 2|  NKD Loss: 0.713 | CT Loss: 2.9981| [0m
[91mEpoch: 2|  Loss:  4.3879 |Global loss: 5.4856| Local H loss: 0.0255  | Global H loss: 0.0232 [0m
[94mEpoch: 3|  NKD Loss: 0.6784 | CT Loss: 2.9921| [0m
[91mEpoch: 3|  Loss:  4.3285 |Global loss: 5.3867| Local H loss: 0.0264  | Global H loss: 0.0238 [0m
[94mEpoch: 0|  NKD Loss: 1.4113 | CT Loss: 3.2988| [0m
[91mEpoch: 0|  Loss:  5.6349 |Global loss: 7.4255| Local H loss: 0.0262  | Global H loss: 0.0293 [0m
[94mEpoch: 1|  NKD Loss: 0.9628 | CT Loss: 3.078| [0m
[91mEpoch: 1|  Loss:  4.9092 |Global loss: 5.8911| Local H loss: 0.0214  | Global H loss: 0.0197 [0m
[94mEpoch: 2|  NKD Loss: 0.8913 | CT Loss: 3.0499| [0m
[91mEpoch: 2|  Loss:  4.7693 |Global loss: 5.7278| Local H loss: 0.0201  | Global H loss: 0.0183 [0m
[94mEpoch: 3|  NKD Loss: 0.8548 | CT Loss: 3.0309| [0m
[91mEpoch: 3|  Loss:  4.7071 |Global loss: 5.6314| Local H loss: 0.0195  | Global H loss: 0.0174 [0m
[94mEpoch: 0|  NKD Loss: 0.9017 | CT Loss: 3.3068| [0m
[91mEpoch: 0|  Loss:  4.5796 |Global loss: 6.3633| Local H loss: 0.0505  | Global H loss: 0.045 [0m
[94mEpoch: 1|  NKD Loss: 0.4296 | CT Loss: 3.1081| [0m
[91mEpoch: 1|  Loss:  3.8614 |Global loss: 4.9238| Local H loss: 0.0446  | Global H loss: 0.0356 [0m
[94mEpoch: 2|  NKD Loss: 0.4175 | CT Loss: 3.0851| [0m
[91mEpoch: 2|  Loss:  3.8339 |Global loss: 4.7949| Local H loss: 0.043  | Global H loss: 0.034 [0m
[94mEpoch: 3|  NKD Loss: 0.4015 | CT Loss: 3.0752| [0m
[91mEpoch: 3|  Loss:  3.8147 |Global loss: 4.7799| Local H loss: 0.0448  | Global H loss: 0.034 [0m
------------------------- time cost ------------------------- 10.9368577003479
Chosen Clients:  [1, 5, 7]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.847, 0.813, 0.881, 0.841, 0.77, 0.801, 0.82, 0.801, 1.0]
AUC in each clients:  [451.216, 479.832, 325.9, 424.239, 491.038, 448.494, 427.524, 471.57, 12.0]
F1 Score:  [0.822, 0.761, 0.855, 0.793, 0.607, 0.679, 0.643, 0.632, 1.0]
Recall Score:  [0.819, 0.762, 0.837, 0.795, 0.651, 0.71, 0.666, 0.671, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9610
Averaged Test Accurancy: 0.8191
Averaged Test AUC: 0.9408
Averaged Test F1_score: 0.7547
Averaged Test Recal score: 0.7679
Std Test Accurancy: 0.0635
Std Test AUC: 0.0217
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.1118 | CT Loss: 3.2113| [0m
[91mEpoch: 0|  Loss:  4.9894 |Global loss: 6.9931| Local H loss: 0.0308  | Global H loss: 0.0342 [0m
[94mEpoch: 1|  NKD Loss: 0.7245 | CT Loss: 3.014| [0m
[91mEpoch: 1|  Loss:  4.3857 |Global loss: 5.5859| Local H loss: 0.0263  | Global H loss: 0.0259 [0m
[94mEpoch: 2|  NKD Loss: 0.6892 | CT Loss: 2.9856| [0m
[91mEpoch: 2|  Loss:  4.3015 |Global loss: 5.4047| Local H loss: 0.0274  | Global H loss: 0.0249 [0m
[94mEpoch: 3|  NKD Loss: 0.6754 | CT Loss: 2.989| [0m
[91mEpoch: 3|  Loss:  4.3023 |Global loss: 5.3845| Local H loss: 0.0282  | Global H loss: 0.0255 [0m
[94mEpoch: 0|  NKD Loss: 1.4787 | CT Loss: 3.3475| [0m
[91mEpoch: 0|  Loss:  5.7221 |Global loss: 7.9598| Local H loss: 0.027  | Global H loss: 0.0325 [0m
[94mEpoch: 1|  NKD Loss: 0.9901 | CT Loss: 3.0796| [0m
[91mEpoch: 1|  Loss:  4.927 |Global loss: 6.0097| Local H loss: 0.021  | Global H loss: 0.0206 [0m
[94mEpoch: 2|  NKD Loss: 0.9191 | CT Loss: 3.0513| [0m
[91mEpoch: 2|  Loss:  4.7791 |Global loss: 5.8141| Local H loss: 0.02  | Global H loss: 0.0193 [0m
[94mEpoch: 3|  NKD Loss: 0.8936 | CT Loss: 3.0476| [0m
[91mEpoch: 3|  Loss:  4.7244 |Global loss: 5.7012| Local H loss: 0.0208  | Global H loss: 0.0193 [0m
[94mEpoch: 0|  NKD Loss: 1.2727 | CT Loss: 3.346| [0m
[91mEpoch: 0|  Loss:  5.4948 |Global loss: 7.5703| Local H loss: 0.0263  | Global H loss: 0.0313 [0m
[94mEpoch: 1|  NKD Loss: 0.8433 | CT Loss: 3.0689| [0m
[91mEpoch: 1|  Loss:  4.7488 |Global loss: 5.906| Local H loss: 0.0215  | Global H loss: 0.0206 [0m
[94mEpoch: 2|  NKD Loss: 0.8335 | CT Loss: 3.0406| [0m
[91mEpoch: 2|  Loss:  4.6974 |Global loss: 5.7219| Local H loss: 0.022  | Global H loss: 0.0188 [0m
[94mEpoch: 3|  NKD Loss: 0.8162 | CT Loss: 3.0306| [0m
[91mEpoch: 3|  Loss:  4.6525 |Global loss: 5.6253| Local H loss: 0.0225  | Global H loss: 0.0186 [0m
------------------------- time cost ------------------------- 11.846453666687012
Chosen Clients:  [7, 0, 3]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.847, 0.799, 0.881, 0.841, 0.77, 0.843, 0.82, 0.807, 1.0]
AUC in each clients:  [451.216, 480.546, 325.9, 424.239, 491.038, 451.649, 427.524, 474.771, 12.0]
F1 Score:  [0.822, 0.761, 0.855, 0.793, 0.607, 0.717, 0.643, 0.638, 1.0]
Recall Score:  [0.819, 0.767, 0.837, 0.795, 0.651, 0.75, 0.666, 0.677, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.8469
Averaged Test Accurancy: 0.8234
Averaged Test AUC: 0.9427
Averaged Test F1_score: 0.7596
Averaged Test Recal score: 0.7736
Std Test Accurancy: 0.0625
Std Test AUC: 0.0205
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.2845 | CT Loss: 3.3181| [0m
[91mEpoch: 0|  Loss:  5.4514 |Global loss: 7.3674| Local H loss: 0.0283  | Global H loss: 0.031 [0m
[94mEpoch: 1|  NKD Loss: 0.867 | CT Loss: 3.0661| [0m
[91mEpoch: 1|  Loss:  4.7423 |Global loss: 5.875| Local H loss: 0.0239  | Global H loss: 0.0219 [0m
[94mEpoch: 2|  NKD Loss: 0.8098 | CT Loss: 3.0236| [0m
[91mEpoch: 2|  Loss:  4.6053 |Global loss: 5.6351| Local H loss: 0.0241  | Global H loss: 0.0202 [0m
[94mEpoch: 3|  NKD Loss: 0.8006 | CT Loss: 3.0244| [0m
[91mEpoch: 3|  Loss:  4.6191 |Global loss: 5.6264| Local H loss: 0.0234  | Global H loss: 0.0196 [0m
[94mEpoch: 0|  NKD Loss: 1.3125 | CT Loss: 3.1925| [0m
[91mEpoch: 0|  Loss:  5.1725 |Global loss: 7.4866| Local H loss: 0.0313  | Global H loss: 0.0356 [0m
[94mEpoch: 1|  NKD Loss: 0.9118 | CT Loss: 3.0186| [0m
[91mEpoch: 1|  Loss:  4.5218 |Global loss: 5.8614| Local H loss: 0.0318  | Global H loss: 0.0277 [0m
[94mEpoch: 2|  NKD Loss: 0.8565 | CT Loss: 2.9995| [0m
[91mEpoch: 2|  Loss:  4.4653 |Global loss: 5.749| Local H loss: 0.0307  | Global H loss: 0.0265 [0m
[94mEpoch: 3|  NKD Loss: 0.7864 | CT Loss: 2.9867| [0m
[91mEpoch: 3|  Loss:  4.3493 |Global loss: 5.6071| Local H loss: 0.0313  | Global H loss: 0.0266 [0m
[94mEpoch: 0|  NKD Loss: 1.0503 | CT Loss: 3.2176| [0m
[91mEpoch: 0|  Loss:  4.7462 |Global loss: 6.7224| Local H loss: 0.0395  | Global H loss: 0.0399 [0m
[94mEpoch: 1|  NKD Loss: 0.6013 | CT Loss: 3.0455| [0m
[91mEpoch: 1|  Loss:  4.1386 |Global loss: 5.2769| Local H loss: 0.0358  | Global H loss: 0.0291 [0m
[94mEpoch: 2|  NKD Loss: 0.5516 | CT Loss: 3.0123| [0m
[91mEpoch: 2|  Loss:  4.0547 |Global loss: 5.0714| Local H loss: 0.0338  | Global H loss: 0.0276 [0m
[94mEpoch: 3|  NKD Loss: 0.5129 | CT Loss: 3.0076| [0m
[91mEpoch: 3|  Loss:  3.9723 |Global loss: 5.0103| Local H loss: 0.0335  | Global H loss: 0.0286 [0m
------------------------- time cost ------------------------- 11.602937698364258
Chosen Clients:  [4, 3, 2]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.865, 0.799, 0.881, 0.87, 0.77, 0.843, 0.82, 0.791, 1.0]
AUC in each clients:  [452.33, 480.546, 325.9, 426.671, 491.038, 451.649, 427.524, 474.264, 12.0]
F1 Score:  [0.851, 0.761, 0.855, 0.836, 0.607, 0.717, 0.643, 0.627, 1.0]
Recall Score:  [0.843, 0.767, 0.837, 0.831, 0.651, 0.75, 0.666, 0.667, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9724
Averaged Test Accurancy: 0.8271
Averaged Test AUC: 0.9435
Averaged Test F1_score: 0.7663
Averaged Test Recal score: 0.7791
Std Test Accurancy: 0.0645
Std Test AUC: 0.0205
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.3593 | CT Loss: 3.2745| [0m
[91mEpoch: 0|  Loss:  5.4758 |Global loss: 7.5971| Local H loss: 0.0305  | Global H loss: 0.0359 [0m
[94mEpoch: 1|  NKD Loss: 0.9156 | CT Loss: 3.0658| [0m
[91mEpoch: 1|  Loss:  4.8049 |Global loss: 6.0441| Local H loss: 0.0241  | Global H loss: 0.0237 [0m
[94mEpoch: 2|  NKD Loss: 0.8249 | CT Loss: 3.0336| [0m
[91mEpoch: 2|  Loss:  4.6738 |Global loss: 5.7931| Local H loss: 0.0239  | Global H loss: 0.0223 [0m
[94mEpoch: 3|  NKD Loss: 0.7766 | CT Loss: 3.0214| [0m
[91mEpoch: 3|  Loss:  4.5992 |Global loss: 5.6973| Local H loss: 0.0226  | Global H loss: 0.021 [0m
[94mEpoch: 0|  NKD Loss: 1.2313 | CT Loss: 3.2982| [0m
[91mEpoch: 0|  Loss:  4.9755 |Global loss: 7.3034| Local H loss: 0.0433  | Global H loss: 0.0458 [0m
[94mEpoch: 1|  NKD Loss: 0.6256 | CT Loss: 3.0405| [0m
[91mEpoch: 1|  Loss:  4.1208 |Global loss: 5.2659| Local H loss: 0.0364  | Global H loss: 0.031 [0m
[94mEpoch: 2|  NKD Loss: 0.5705 | CT Loss: 3.0223| [0m
[91mEpoch: 2|  Loss:  4.0406 |Global loss: 5.1228| Local H loss: 0.036  | Global H loss: 0.0302 [0m
[94mEpoch: 3|  NKD Loss: 0.5269 | CT Loss: 3.0078| [0m
[91mEpoch: 3|  Loss:  3.9574 |Global loss: 5.0342| Local H loss: 0.0361  | Global H loss: 0.0304 [0m
[94mEpoch: 0|  NKD Loss: 0.9311 | CT Loss: 3.312| [0m
[91mEpoch: 0|  Loss:  4.5793 |Global loss: 6.6123| Local H loss: 0.0476  | Global H loss: 0.0455 [0m
[94mEpoch: 1|  NKD Loss: 0.4326 | CT Loss: 3.1081| [0m
[91mEpoch: 1|  Loss:  3.8713 |Global loss: 4.9675| Local H loss: 0.0432  | Global H loss: 0.0359 [0m
[94mEpoch: 2|  NKD Loss: 0.3952 | CT Loss: 3.091| [0m
[91mEpoch: 2|  Loss:  3.805 |Global loss: 4.8329| Local H loss: 0.0459  | Global H loss: 0.0364 [0m
[94mEpoch: 3|  NKD Loss: 0.3805 | CT Loss: 3.0726| [0m
[91mEpoch: 3|  Loss:  3.7728 |Global loss: 4.7625| Local H loss: 0.0475  | Global H loss: 0.0371 [0m
------------------------- time cost ------------------------- 10.939459085464478
Chosen Clients:  [5, 4, 7]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.865, 0.799, 0.875, 0.879, 0.801, 0.843, 0.82, 0.791, 1.0]
AUC in each clients:  [452.33, 480.546, 326.247, 427.034, 497.059, 451.649, 427.524, 474.264, 12.0]
F1 Score:  [0.851, 0.761, 0.85, 0.843, 0.647, 0.717, 0.643, 0.627, 1.0]
Recall Score:  [0.843, 0.767, 0.832, 0.838, 0.683, 0.75, 0.666, 0.667, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1398
Averaged Test Accurancy: 0.8319
Averaged Test AUC: 0.9453
Averaged Test F1_score: 0.7710
Averaged Test Recal score: 0.7829
Std Test Accurancy: 0.0611
Std Test AUC: 0.0197
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.5206 | CT Loss: 3.3827| [0m
[91mEpoch: 0|  Loss:  5.7347 |Global loss: 8.0083| Local H loss: 0.0286  | Global H loss: 0.0339 [0m
[94mEpoch: 1|  NKD Loss: 0.9886 | CT Loss: 3.0823| [0m
[91mEpoch: 1|  Loss:  4.8601 |Global loss: 6.008| Local H loss: 0.0231  | Global H loss: 0.0229 [0m
[94mEpoch: 2|  NKD Loss: 0.8857 | CT Loss: 3.0337| [0m
[91mEpoch: 2|  Loss:  4.6905 |Global loss: 5.7168| Local H loss: 0.0205  | Global H loss: 0.0195 [0m
[94mEpoch: 3|  NKD Loss: 0.8727 | CT Loss: 3.0328| [0m
[91mEpoch: 3|  Loss:  4.6633 |Global loss: 5.6644| Local H loss: 0.0223  | Global H loss: 0.0205 [0m
[94mEpoch: 0|  NKD Loss: 1.2281 | CT Loss: 3.2783| [0m
[91mEpoch: 0|  Loss:  5.3349 |Global loss: 7.393| Local H loss: 0.0303  | Global H loss: 0.0336 [0m
[94mEpoch: 1|  NKD Loss: 0.8268 | CT Loss: 3.054| [0m
[91mEpoch: 1|  Loss:  4.6745 |Global loss: 5.8668| Local H loss: 0.0253  | Global H loss: 0.0241 [0m
[94mEpoch: 2|  NKD Loss: 0.7972 | CT Loss: 3.0261| [0m
[91mEpoch: 2|  Loss:  4.6018 |Global loss: 5.7457| Local H loss: 0.0249  | Global H loss: 0.0231 [0m
[94mEpoch: 3|  NKD Loss: 0.7525 | CT Loss: 3.027| [0m
[91mEpoch: 3|  Loss:  4.5476 |Global loss: 5.6275| Local H loss: 0.0248  | Global H loss: 0.022 [0m
[94mEpoch: 0|  NKD Loss: 1.2103 | CT Loss: 3.315| [0m
[91mEpoch: 0|  Loss:  5.3348 |Global loss: 7.3861| Local H loss: 0.0293  | Global H loss: 0.0315 [0m
[94mEpoch: 1|  NKD Loss: 0.8437 | CT Loss: 3.0747| [0m
[91mEpoch: 1|  Loss:  4.7201 |Global loss: 5.9287| Local H loss: 0.0243  | Global H loss: 0.0224 [0m
[94mEpoch: 2|  NKD Loss: 0.8286 | CT Loss: 3.0358| [0m
[91mEpoch: 2|  Loss:  4.6482 |Global loss: 5.7023| Local H loss: 0.0249  | Global H loss: 0.0206 [0m
[94mEpoch: 3|  NKD Loss: 0.7866 | CT Loss: 3.0221| [0m
[91mEpoch: 3|  Loss:  4.5682 |Global loss: 5.5987| Local H loss: 0.024  | Global H loss: 0.0195 [0m
------------------------- time cost ------------------------- 11.99766755104065
Chosen Clients:  [7, 0, 5]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.865, 0.799, 0.875, 0.879, 0.812, 0.83, 0.82, 0.803, 1.0]
AUC in each clients:  [452.33, 480.546, 326.247, 427.034, 499.368, 453.298, 427.524, 475.085, 12.0]
F1 Score:  [0.851, 0.761, 0.85, 0.843, 0.669, 0.711, 0.643, 0.635, 1.0]
Recall Score:  [0.843, 0.767, 0.832, 0.838, 0.696, 0.741, 0.666, 0.674, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1738
Averaged Test Accurancy: 0.8335
Averaged Test AUC: 0.9466
Averaged Test F1_score: 0.7737
Averaged Test Recal score: 0.7841
Std Test Accurancy: 0.0593
Std Test AUC: 0.0191
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.2984 | CT Loss: 3.3704| [0m
[91mEpoch: 0|  Loss:  5.4247 |Global loss: 7.4558| Local H loss: 0.0329  | Global H loss: 0.0335 [0m
[94mEpoch: 1|  NKD Loss: 0.8538 | CT Loss: 3.0698| [0m
[91mEpoch: 1|  Loss:  4.6759 |Global loss: 5.8115| Local H loss: 0.0276  | Global H loss: 0.0227 [0m
[94mEpoch: 2|  NKD Loss: 0.7847 | CT Loss: 3.0269| [0m
[91mEpoch: 2|  Loss:  4.5465 |Global loss: 5.6007| Local H loss: 0.0254  | Global H loss: 0.0208 [0m
[94mEpoch: 3|  NKD Loss: 0.7397 | CT Loss: 3.0098| [0m
[91mEpoch: 3|  Loss:  4.4629 |Global loss: 5.4881| Local H loss: 0.0259  | Global H loss: 0.0205 [0m
[94mEpoch: 0|  NKD Loss: 1.2461 | CT Loss: 3.196| [0m
[91mEpoch: 0|  Loss:  5.0664 |Global loss: 7.1889| Local H loss: 0.0349  | Global H loss: 0.036 [0m
[94mEpoch: 1|  NKD Loss: 0.8729 | CT Loss: 3.0137| [0m
[91mEpoch: 1|  Loss:  4.4669 |Global loss: 5.7863| Local H loss: 0.0321  | Global H loss: 0.0281 [0m
[94mEpoch: 2|  NKD Loss: 0.8084 | CT Loss: 3.0006| [0m
[91mEpoch: 2|  Loss:  4.3766 |Global loss: 5.7079| Local H loss: 0.0324  | Global H loss: 0.0279 [0m
[94mEpoch: 3|  NKD Loss: 0.7666 | CT Loss: 2.9905| [0m
[91mEpoch: 3|  Loss:  4.3217 |Global loss: 5.6004| Local H loss: 0.0331  | Global H loss: 0.0278 [0m
[94mEpoch: 0|  NKD Loss: 1.4511 | CT Loss: 3.408| [0m
[91mEpoch: 0|  Loss:  5.6289 |Global loss: 7.7237| Local H loss: 0.0327  | Global H loss: 0.037 [0m
[94mEpoch: 1|  NKD Loss: 1.0504 | CT Loss: 3.1374| [0m
[91mEpoch: 1|  Loss:  4.9495 |Global loss: 5.9591| Local H loss: 0.0254  | Global H loss: 0.023 [0m
[94mEpoch: 2|  NKD Loss: 0.8188 | CT Loss: 3.0522| [0m
[91mEpoch: 2|  Loss:  4.6223 |Global loss: 5.4257| Local H loss: 0.0221  | Global H loss: 0.0183 [0m
[94mEpoch: 3|  NKD Loss: 0.7935 | CT Loss: 3.0373| [0m
[91mEpoch: 3|  Loss:  4.5524 |Global loss: 5.3541| Local H loss: 0.0237  | Global H loss: 0.0186 [0m
------------------------- time cost ------------------------- 12.070716619491577
Chosen Clients:  [7, 5, 1]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.88, 0.799, 0.875, 0.879, 0.812, 0.834, 0.82, 0.811, 1.0]
AUC in each clients:  [454.32, 480.546, 326.247, 427.034, 499.368, 457.742, 427.524, 478.94, 12.0]
F1 Score:  [0.862, 0.761, 0.85, 0.843, 0.669, 0.712, 0.643, 0.64, 1.0]
Recall Score:  [0.855, 0.767, 0.832, 0.838, 0.696, 0.738, 0.666, 0.682, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0880
Averaged Test Accurancy: 0.8370
Averaged Test AUC: 0.9493
Averaged Test F1_score: 0.7756
Averaged Test Recal score: 0.7860
Std Test Accurancy: 0.0589
Std Test AUC: 0.0174
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.3079 | CT Loss: 3.3404| [0m
[91mEpoch: 0|  Loss:  5.3601 |Global loss: 7.4145| Local H loss: 0.0355  | Global H loss: 0.0357 [0m
[94mEpoch: 1|  NKD Loss: 0.8418 | CT Loss: 3.0587| [0m
[91mEpoch: 1|  Loss:  4.6326 |Global loss: 5.7809| Local H loss: 0.0281  | Global H loss: 0.0236 [0m
[94mEpoch: 2|  NKD Loss: 0.7759 | CT Loss: 3.0233| [0m
[91mEpoch: 2|  Loss:  4.5035 |Global loss: 5.6132| Local H loss: 0.0277  | Global H loss: 0.0227 [0m
[94mEpoch: 3|  NKD Loss: 0.764 | CT Loss: 3.0221| [0m
[91mEpoch: 3|  Loss:  4.4654 |Global loss: 5.5415| Local H loss: 0.0281  | Global H loss: 0.0226 [0m
[94mEpoch: 0|  NKD Loss: 1.4474 | CT Loss: 3.3964| [0m
[91mEpoch: 0|  Loss:  5.6747 |Global loss: 7.8273| Local H loss: 0.0291  | Global H loss: 0.0322 [0m
[94mEpoch: 1|  NKD Loss: 0.9921 | CT Loss: 3.0804| [0m
[91mEpoch: 1|  Loss:  4.7932 |Global loss: 5.8665| Local H loss: 0.0259  | Global H loss: 0.0238 [0m
[94mEpoch: 2|  NKD Loss: 0.9307 | CT Loss: 3.0604| [0m
[91mEpoch: 2|  Loss:  4.7157 |Global loss: 5.7891| Local H loss: 0.0254  | Global H loss: 0.0234 [0m
[94mEpoch: 3|  NKD Loss: 0.8491 | CT Loss: 3.032| [0m
[91mEpoch: 3|  Loss:  4.5804 |Global loss: 5.6338| Local H loss: 0.0252  | Global H loss: 0.0231 [0m
[94mEpoch: 0|  NKD Loss: 1.205 | CT Loss: 3.246| [0m
[91mEpoch: 0|  Loss:  5.0897 |Global loss: 6.9204| Local H loss: 0.0348  | Global H loss: 0.0362 [0m
[94mEpoch: 1|  NKD Loss: 0.7441 | CT Loss: 3.0162| [0m
[91mEpoch: 1|  Loss:  4.3921 |Global loss: 5.5631| Local H loss: 0.0284  | Global H loss: 0.0267 [0m
[94mEpoch: 2|  NKD Loss: 0.6862 | CT Loss: 2.9934| [0m
[91mEpoch: 2|  Loss:  4.2821 |Global loss: 5.4283| Local H loss: 0.0285  | Global H loss: 0.0261 [0m
[94mEpoch: 3|  NKD Loss: 0.6614 | CT Loss: 2.9881| [0m
[91mEpoch: 3|  Loss:  4.231 |Global loss: 5.3503| Local H loss: 0.0294  | Global H loss: 0.0266 [0m
------------------------- time cost ------------------------- 11.706024408340454
Chosen Clients:  [1, 0, 5]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.88, 0.795, 0.875, 0.879, 0.812, 0.845, 0.82, 0.817, 1.0]
AUC in each clients:  [454.32, 481.719, 326.247, 427.034, 499.368, 455.283, 427.524, 479.839, 12.0]
F1 Score:  [0.862, 0.766, 0.85, 0.843, 0.669, 0.721, 0.643, 0.653, 1.0]
Recall Score:  [0.855, 0.764, 0.832, 0.838, 0.696, 0.754, 0.666, 0.688, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1065
Averaged Test Accurancy: 0.8386
Averaged Test AUC: 0.9492
Averaged Test F1_score: 0.7786
Averaged Test Recal score: 0.7881
Std Test Accurancy: 0.0585
Std Test AUC: 0.0175
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.3219 | CT Loss: 3.2767| [0m
[91mEpoch: 0|  Loss:  5.2138 |Global loss: 7.5536| Local H loss: 0.0342  | Global H loss: 0.0395 [0m
[94mEpoch: 1|  NKD Loss: 0.7013 | CT Loss: 3.01| [0m
[91mEpoch: 1|  Loss:  4.286 |Global loss: 5.5162| Local H loss: 0.0303  | Global H loss: 0.0283 [0m
[94mEpoch: 2|  NKD Loss: 0.6499 | CT Loss: 2.9901| [0m
[91mEpoch: 2|  Loss:  4.2044 |Global loss: 5.3416| Local H loss: 0.0309  | Global H loss: 0.0279 [0m
[94mEpoch: 3|  NKD Loss: 0.635 | CT Loss: 2.984| [0m
[91mEpoch: 3|  Loss:  4.1584 |Global loss: 5.2601| Local H loss: 0.0334  | Global H loss: 0.0284 [0m
[94mEpoch: 0|  NKD Loss: 1.2846 | CT Loss: 3.2055| [0m
[91mEpoch: 0|  Loss:  5.0851 |Global loss: 7.3278| Local H loss: 0.0368  | Global H loss: 0.0378 [0m
[94mEpoch: 1|  NKD Loss: 0.855 | CT Loss: 3.0098| [0m
[91mEpoch: 1|  Loss:  4.4194 |Global loss: 5.746| Local H loss: 0.0352  | Global H loss: 0.0304 [0m
[94mEpoch: 2|  NKD Loss: 0.7752 | CT Loss: 2.9909| [0m
[91mEpoch: 2|  Loss:  4.3063 |Global loss: 5.6425| Local H loss: 0.0349  | Global H loss: 0.0298 [0m
[94mEpoch: 3|  NKD Loss: 0.753 | CT Loss: 2.9838| [0m
[91mEpoch: 3|  Loss:  4.2511 |Global loss: 5.5337| Local H loss: 0.036  | Global H loss: 0.03 [0m
[94mEpoch: 0|  NKD Loss: 1.3111 | CT Loss: 3.282| [0m
[91mEpoch: 0|  Loss:  5.3168 |Global loss: 7.4199| Local H loss: 0.0309  | Global H loss: 0.0343 [0m
[94mEpoch: 1|  NKD Loss: 0.9271 | CT Loss: 3.058| [0m
[91mEpoch: 1|  Loss:  4.689 |Global loss: 5.8611| Local H loss: 0.0266  | Global H loss: 0.0247 [0m
[94mEpoch: 2|  NKD Loss: 0.8548 | CT Loss: 3.0341| [0m
[91mEpoch: 2|  Loss:  4.5649 |Global loss: 5.6384| Local H loss: 0.0265  | Global H loss: 0.024 [0m
[94mEpoch: 3|  NKD Loss: 0.8406 | CT Loss: 3.0272| [0m
[91mEpoch: 3|  Loss:  4.5614 |Global loss: 5.628| Local H loss: 0.0253  | Global H loss: 0.0228 [0m
------------------------- time cost ------------------------- 11.639554023742676
Chosen Clients:  [4, 3, 0]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.876, 0.835, 0.875, 0.879, 0.812, 0.843, 0.82, 0.817, 1.0]
AUC in each clients:  [455.345, 482.971, 326.247, 427.034, 499.368, 456.593, 427.524, 479.839, 12.0]
F1 Score:  [0.861, 0.796, 0.85, 0.843, 0.669, 0.724, 0.643, 0.653, 1.0]
Recall Score:  [0.854, 0.799, 0.832, 0.838, 0.696, 0.752, 0.666, 0.688, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1086
Averaged Test Accurancy: 0.8431
Averaged Test AUC: 0.9502
Averaged Test F1_score: 0.7821
Averaged Test Recal score: 0.7917
Std Test Accurancy: 0.0549
Std Test AUC: 0.0170
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.4453 | CT Loss: 3.3957| [0m
[91mEpoch: 0|  Loss:  5.6509 |Global loss: 8.2036| Local H loss: 0.0324  | Global H loss: 0.0405 [0m
[94mEpoch: 1|  NKD Loss: 1.0382 | CT Loss: 3.1318| [0m
[91mEpoch: 1|  Loss:  4.9751 |Global loss: 6.2591| Local H loss: 0.0269  | Global H loss: 0.0262 [0m
[94mEpoch: 2|  NKD Loss: 0.9733 | CT Loss: 3.0628| [0m
[91mEpoch: 2|  Loss:  4.7978 |Global loss: 5.8952| Local H loss: 0.0277  | Global H loss: 0.0252 [0m
[94mEpoch: 3|  NKD Loss: 0.8693 | CT Loss: 3.0157| [0m
[91mEpoch: 3|  Loss:  4.625 |Global loss: 5.7153| Local H loss: 0.0262  | Global H loss: 0.0236 [0m
[94mEpoch: 0|  NKD Loss: 1.0608 | CT Loss: 3.2438| [0m
[91mEpoch: 0|  Loss:  4.7283 |Global loss: 6.9122| Local H loss: 0.0445  | Global H loss: 0.0446 [0m
[94mEpoch: 1|  NKD Loss: 0.5419 | CT Loss: 3.0263| [0m
[91mEpoch: 1|  Loss:  3.9948 |Global loss: 5.1847| Local H loss: 0.0388  | Global H loss: 0.0326 [0m
[94mEpoch: 2|  NKD Loss: 0.5283 | CT Loss: 3.0226| [0m
[91mEpoch: 2|  Loss:  3.9684 |Global loss: 5.0561| Local H loss: 0.0404  | Global H loss: 0.033 [0m
[94mEpoch: 3|  NKD Loss: 0.4943 | CT Loss: 3.0096| [0m
[91mEpoch: 3|  Loss:  3.9114 |Global loss: 4.9659| Local H loss: 0.0404  | Global H loss: 0.0329 [0m
[94mEpoch: 0|  NKD Loss: 1.2953 | CT Loss: 3.1618| [0m
[91mEpoch: 0|  Loss:  4.9935 |Global loss: 7.2746| Local H loss: 0.0388  | Global H loss: 0.0393 [0m
[94mEpoch: 1|  NKD Loss: 0.8455 | CT Loss: 3.0115| [0m
[91mEpoch: 1|  Loss:  4.3825 |Global loss: 5.7733| Local H loss: 0.0371  | Global H loss: 0.0316 [0m
[94mEpoch: 2|  NKD Loss: 0.745 | CT Loss: 2.9872| [0m
[91mEpoch: 2|  Loss:  4.2361 |Global loss: 5.5479| Local H loss: 0.0377  | Global H loss: 0.0312 [0m
[94mEpoch: 3|  NKD Loss: 0.7011 | CT Loss: 2.9834| [0m
[91mEpoch: 3|  Loss:  4.1902 |Global loss: 5.512| Local H loss: 0.0373  | Global H loss: 0.0315 [0m
------------------------- time cost ------------------------- 11.528591871261597
Chosen Clients:  [2, 8, 1]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.878, 0.835, 0.875, 0.884, 0.805, 0.843, 0.82, 0.817, 1.0]
AUC in each clients:  [455.875, 482.971, 326.247, 427.703, 497.229, 456.593, 427.524, 479.839, 12.0]
F1 Score:  [0.866, 0.796, 0.85, 0.854, 0.672, 0.724, 0.643, 0.653, 1.0]
Recall Score:  [0.857, 0.799, 0.832, 0.847, 0.695, 0.752, 0.666, 0.688, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1839
Averaged Test Accurancy: 0.8428
Averaged Test AUC: 0.9499
Averaged Test F1_score: 0.7842
Averaged Test Recal score: 0.7929
Std Test Accurancy: 0.0560
Std Test AUC: 0.0172
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 0.8173 | CT Loss: 3.3006| [0m
[91mEpoch: 0|  Loss:  4.4398 |Global loss: 6.2988| Local H loss: 0.0496  | Global H loss: 0.0463 [0m
[94mEpoch: 1|  NKD Loss: 0.4395 | CT Loss: 3.1035| [0m
[91mEpoch: 1|  Loss:  3.8656 |Global loss: 4.9415| Local H loss: 0.0477  | Global H loss: 0.038 [0m
[94mEpoch: 2|  NKD Loss: 0.3642 | CT Loss: 3.0929| [0m
[91mEpoch: 2|  Loss:  3.7569 |Global loss: 4.7712| Local H loss: 0.0473  | Global H loss: 0.0378 [0m
[94mEpoch: 3|  NKD Loss: 0.3775 | CT Loss: 3.0768| [0m
[91mEpoch: 3|  Loss:  3.7776 |Global loss: 4.7488| Local H loss: 0.0468  | Global H loss: 0.0369 [0m
[94mEpoch: 0|  NKD Loss: 1.9287 | CT Loss: 4.4565| [0m
[91mEpoch: 0|  Loss:  6.737 |Global loss: 19.5516| Local H loss: 0.0171  | Global H loss: 0.0631 [0m
[94mEpoch: 1|  NKD Loss: 1.6397 | CT Loss: 4.2191| [0m
[91mEpoch: 1|  Loss:  6.1634 |Global loss: 17.3382| Local H loss: 0.016  | Global H loss: 0.0639 [0m
[94mEpoch: 2|  NKD Loss: 1.6406 | CT Loss: 4.2157| [0m
[91mEpoch: 2|  Loss:  6.1153 |Global loss: 14.7855| Local H loss: 0.0201  | Global H loss: 0.0656 [0m
[94mEpoch: 3|  NKD Loss: 1.53 | CT Loss: 4.2116| [0m
[91mEpoch: 3|  Loss:  5.9696 |Global loss: 12.6395| Local H loss: 0.0255  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 1.1359 | CT Loss: 3.1728| [0m
[91mEpoch: 0|  Loss:  4.8908 |Global loss: 6.5932| Local H loss: 0.0416  | Global H loss: 0.0386 [0m
[94mEpoch: 1|  NKD Loss: 0.7115 | CT Loss: 3.0174| [0m
[91mEpoch: 1|  Loss:  4.2767 |Global loss: 5.4976| Local H loss: 0.0342  | Global H loss: 0.0309 [0m
[94mEpoch: 2|  NKD Loss: 0.6427 | CT Loss: 2.9885| [0m
[91mEpoch: 2|  Loss:  4.1743 |Global loss: 5.3258| Local H loss: 0.0337  | Global H loss: 0.0296 [0m
[94mEpoch: 3|  NKD Loss: 0.6156 | CT Loss: 2.9848| [0m
[91mEpoch: 3|  Loss:  4.1073 |Global loss: 5.2313| Local H loss: 0.0348  | Global H loss: 0.03 [0m
------------------------- time cost ------------------------- 8.589508056640625
Chosen Clients:  [8, 7, 5]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.878, 0.846, 0.902, 0.884, 0.805, 0.843, 0.82, 0.817, 1.0]
AUC in each clients:  [455.875, 483.878, 327.329, 427.703, 497.229, 456.593, 427.524, 479.839, 12.0]
F1 Score:  [0.866, 0.828, 0.879, 0.854, 0.672, 0.724, 0.643, 0.653, 1.0]
Recall Score:  [0.857, 0.827, 0.863, 0.847, 0.695, 0.752, 0.666, 0.688, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.2014
Averaged Test Accurancy: 0.8468
Averaged Test AUC: 0.9504
Averaged Test F1_score: 0.7910
Averaged Test Recal score: 0.7994
Std Test Accurancy: 0.0567
Std Test AUC: 0.0174
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.9198 | CT Loss: 4.5291| [0m
[91mEpoch: 0|  Loss:  6.6375 |Global loss: 21.9553| Local H loss: 0.0189  | Global H loss: 0.0727 [0m
[94mEpoch: 1|  NKD Loss: 1.4763 | CT Loss: 4.2107| [0m
[91mEpoch: 1|  Loss:  5.862 |Global loss: 16.6691| Local H loss: 0.0208  | Global H loss: 0.0713 [0m
[94mEpoch: 2|  NKD Loss: 1.4737 | CT Loss: 4.2109| [0m
[91mEpoch: 2|  Loss:  5.8418 |Global loss: 13.8264| Local H loss: 0.0257  | Global H loss: 0.0717 [0m
[94mEpoch: 3|  NKD Loss: 1.4685 | CT Loss: 4.2094| [0m
[91mEpoch: 3|  Loss:  5.8286 |Global loss: 11.5485| Local H loss: 0.0362  | Global H loss: 0.0717 [0m
[94mEpoch: 0|  NKD Loss: 1.1507 | CT Loss: 3.293| [0m
[91mEpoch: 0|  Loss:  5.1447 |Global loss: 7.2467| Local H loss: 0.0334  | Global H loss: 0.0345 [0m
[94mEpoch: 1|  NKD Loss: 0.7948 | CT Loss: 3.055| [0m
[91mEpoch: 1|  Loss:  4.5266 |Global loss: 5.7426| Local H loss: 0.0298  | Global H loss: 0.0253 [0m
[94mEpoch: 2|  NKD Loss: 0.7629 | CT Loss: 3.0277| [0m
[91mEpoch: 2|  Loss:  4.4491 |Global loss: 5.6063| Local H loss: 0.0312  | Global H loss: 0.0246 [0m
[94mEpoch: 3|  NKD Loss: 0.7083 | CT Loss: 3.0054| [0m
[91mEpoch: 3|  Loss:  4.3499 |Global loss: 5.4629| Local H loss: 0.0301  | Global H loss: 0.0239 [0m
[94mEpoch: 0|  NKD Loss: 1.3913 | CT Loss: 3.2752| [0m
[91mEpoch: 0|  Loss:  5.3839 |Global loss: 7.4914| Local H loss: 0.0351  | Global H loss: 0.036 [0m
[94mEpoch: 1|  NKD Loss: 0.9098 | CT Loss: 3.0374| [0m
[91mEpoch: 1|  Loss:  4.6481 |Global loss: 5.8206| Local H loss: 0.0291  | Global H loss: 0.0252 [0m
[94mEpoch: 2|  NKD Loss: 0.8265 | CT Loss: 3.0229| [0m
[91mEpoch: 2|  Loss:  4.5293 |Global loss: 5.6233| Local H loss: 0.0269  | Global H loss: 0.0236 [0m
[94mEpoch: 3|  NKD Loss: 0.7807 | CT Loss: 3.0123| [0m
[91mEpoch: 3|  Loss:  4.4723 |Global loss: 5.5569| Local H loss: 0.0272  | Global H loss: 0.0232 [0m
------------------------- time cost ------------------------- 9.327560186386108
Chosen Clients:  [7, 0, 2]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.878, 0.846, 0.902, 0.884, 0.805, 0.83, 0.82, 0.834, 1.0]
AUC in each clients:  [455.875, 483.878, 327.329, 427.703, 497.229, 455.35, 427.524, 480.899, 12.0]
F1 Score:  [0.866, 0.828, 0.879, 0.854, 0.672, 0.707, 0.643, 0.704, 1.0]
Recall Score:  [0.857, 0.827, 0.863, 0.847, 0.695, 0.742, 0.666, 0.718, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1838
Averaged Test Accurancy: 0.8476
Averaged Test AUC: 0.9504
Averaged Test F1_score: 0.7948
Averaged Test Recal score: 0.8017
Std Test Accurancy: 0.0560
Std Test AUC: 0.0175
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.2493 | CT Loss: 3.3563| [0m
[91mEpoch: 0|  Loss:  5.3029 |Global loss: 7.3974| Local H loss: 0.0358  | Global H loss: 0.0366 [0m
[94mEpoch: 1|  NKD Loss: 0.7841 | CT Loss: 3.0426| [0m
[91mEpoch: 1|  Loss:  4.4835 |Global loss: 5.6634| Local H loss: 0.0306  | Global H loss: 0.0251 [0m
[94mEpoch: 2|  NKD Loss: 0.7416 | CT Loss: 3.0209| [0m
[91mEpoch: 2|  Loss:  4.4018 |Global loss: 5.5187| Local H loss: 0.0301  | Global H loss: 0.0242 [0m
[94mEpoch: 3|  NKD Loss: 0.6889 | CT Loss: 3.0073| [0m
[91mEpoch: 3|  Loss:  4.3192 |Global loss: 5.4304| Local H loss: 0.0304  | Global H loss: 0.0241 [0m
[94mEpoch: 0|  NKD Loss: 1.2989 | CT Loss: 3.1689| [0m
[91mEpoch: 0|  Loss:  5.0066 |Global loss: 7.2177| Local H loss: 0.0409  | Global H loss: 0.0398 [0m
[94mEpoch: 1|  NKD Loss: 0.8232 | CT Loss: 3.005| [0m
[91mEpoch: 1|  Loss:  4.3282 |Global loss: 5.749| Local H loss: 0.0392  | Global H loss: 0.0336 [0m
[94mEpoch: 2|  NKD Loss: 0.7562 | CT Loss: 2.994| [0m
[91mEpoch: 2|  Loss:  4.2337 |Global loss: 5.6131| Local H loss: 0.0394  | Global H loss: 0.0323 [0m
[94mEpoch: 3|  NKD Loss: 0.7158 | CT Loss: 2.987| [0m
[91mEpoch: 3|  Loss:  4.1915 |Global loss: 5.5415| Local H loss: 0.0399  | Global H loss: 0.0328 [0m
[94mEpoch: 0|  NKD Loss: 0.8345 | CT Loss: 3.2763| [0m
[91mEpoch: 0|  Loss:  4.4251 |Global loss: 6.136| Local H loss: 0.0551  | Global H loss: 0.0489 [0m
[94mEpoch: 1|  NKD Loss: 0.4076 | CT Loss: 3.1026| [0m
[91mEpoch: 1|  Loss:  3.7972 |Global loss: 4.8955| Local H loss: 0.0472  | Global H loss: 0.0397 [0m
[94mEpoch: 2|  NKD Loss: 0.3806 | CT Loss: 3.0857| [0m
[91mEpoch: 2|  Loss:  3.7615 |Global loss: 4.7823| Local H loss: 0.0474  | Global H loss: 0.0383 [0m
[94mEpoch: 3|  NKD Loss: 0.3685 | CT Loss: 3.0742| [0m
[91mEpoch: 3|  Loss:  3.758 |Global loss: 4.6947| Local H loss: 0.0495  | Global H loss: 0.0376 [0m
------------------------- time cost ------------------------- 10.953293323516846
Chosen Clients:  [8, 4, 7]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.892, 0.846, 0.908, 0.884, 0.805, 0.83, 0.82, 0.832, 1.0]
AUC in each clients:  [456.851, 483.878, 326.929, 427.703, 497.229, 455.35, 427.524, 480.54, 12.0]
F1 Score:  [0.88, 0.828, 0.882, 0.854, 0.672, 0.707, 0.643, 0.711, 1.0]
Recall Score:  [0.872, 0.827, 0.87, 0.847, 0.695, 0.742, 0.666, 0.721, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1466
Averaged Test Accurancy: 0.8498
Averaged Test AUC: 0.9505
Averaged Test F1_score: 0.7974
Averaged Test Recal score: 0.8044
Std Test Accurancy: 0.0571
Std Test AUC: 0.0173
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.9135 | CT Loss: 4.5465| [0m
[91mEpoch: 0|  Loss:  6.5847 |Global loss: 21.7074| Local H loss: 0.0224  | Global H loss: 0.0762 [0m
[94mEpoch: 1|  NKD Loss: 1.3307 | CT Loss: 4.2077| [0m
[91mEpoch: 1|  Loss:  5.662 |Global loss: 15.1199| Local H loss: 0.0258  | Global H loss: 0.0749 [0m
[94mEpoch: 2|  NKD Loss: 1.5139 | CT Loss: 4.2077| [0m
[91mEpoch: 2|  Loss:  5.8444 |Global loss: 12.7066| Local H loss: 0.0354  | Global H loss: 0.0749 [0m
[94mEpoch: 3|  NKD Loss: 1.0964 | CT Loss: 4.2022| [0m
[91mEpoch: 3|  Loss:  5.4195 |Global loss: 11.3481| Local H loss: 0.041  | Global H loss: 0.0744 [0m
[94mEpoch: 0|  NKD Loss: 1.4841 | CT Loss: 4.0474| [0m
[91mEpoch: 0|  Loss:  6.647 |Global loss: 9.7879| Local H loss: 0.0217  | Global H loss: 0.03 [0m
[94mEpoch: 1|  NKD Loss: 1.161 | CT Loss: 3.7459| [0m
[91mEpoch: 1|  Loss:  5.9104 |Global loss: 7.9663| Local H loss: 0.0229  | Global H loss: 0.0257 [0m
[94mEpoch: 2|  NKD Loss: 1.1196 | CT Loss: 3.5613| [0m
[91mEpoch: 2|  Loss:  5.649 |Global loss: 7.4345| Local H loss: 0.023  | Global H loss: 0.0242 [0m
[94mEpoch: 3|  NKD Loss: 1.1366 | CT Loss: 3.4506| [0m
[91mEpoch: 3|  Loss:  5.5343 |Global loss: 7.1796| Local H loss: 0.0242  | Global H loss: 0.0246 [0m
[94mEpoch: 0|  NKD Loss: 1.598 | CT Loss: 4.0081| [0m
[91mEpoch: 0|  Loss:  6.4762 |Global loss: 9.8035| Local H loss: 0.0283  | Global H loss: 0.0392 [0m
[94mEpoch: 1|  NKD Loss: 1.1203 | CT Loss: 3.5514| [0m
[91mEpoch: 1|  Loss:  5.4438 |Global loss: 7.6152| Local H loss: 0.0263  | Global H loss: 0.0319 [0m
[94mEpoch: 2|  NKD Loss: 1.0304 | CT Loss: 3.4318| [0m
[91mEpoch: 2|  Loss:  5.2235 |Global loss: 7.3097| Local H loss: 0.0271  | Global H loss: 0.0317 [0m
[94mEpoch: 3|  NKD Loss: 0.997 | CT Loss: 3.3624| [0m
[91mEpoch: 3|  Loss:  5.0629 |Global loss: 7.0471| Local H loss: 0.0298  | Global H loss: 0.0329 [0m
------------------------- time cost ------------------------- 9.700174570083618
Chosen Clients:  [5, 4, 0]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.892, 0.846, 0.908, 0.884, 0.786, 0.83, 0.82, 0.809, 1.0]
AUC in each clients:  [456.851, 483.878, 326.929, 427.703, 488.559, 455.35, 427.524, 476.713, 12.0]
F1 Score:  [0.88, 0.828, 0.882, 0.854, 0.642, 0.707, 0.643, 0.665, 1.0]
Recall Score:  [0.872, 0.827, 0.87, 0.847, 0.667, 0.742, 0.666, 0.69, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.5727
Averaged Test Accurancy: 0.8439
Averaged Test AUC: 0.9471
Averaged Test F1_score: 0.7890
Averaged Test Recal score: 0.7979
Std Test Accurancy: 0.0617
Std Test AUC: 0.0197
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.894 | CT Loss: 3.7967| [0m
[91mEpoch: 0|  Loss:  6.3888 |Global loss: 8.4068| Local H loss: 0.0417  | Global H loss: 0.0383 [0m
[94mEpoch: 1|  NKD Loss: 1.139 | CT Loss: 3.4803| [0m
[91mEpoch: 1|  Loss:  5.3328 |Global loss: 6.8969| Local H loss: 0.0295  | Global H loss: 0.0287 [0m
[94mEpoch: 2|  NKD Loss: 1.0961 | CT Loss: 3.394| [0m
[91mEpoch: 2|  Loss:  5.1929 |Global loss: 6.7024| Local H loss: 0.0289  | Global H loss: 0.0283 [0m
[94mEpoch: 3|  NKD Loss: 1.052 | CT Loss: 3.3398| [0m
[91mEpoch: 3|  Loss:  5.0875 |Global loss: 6.5576| Local H loss: 0.0276  | Global H loss: 0.0274 [0m
[94mEpoch: 0|  NKD Loss: 1.5144 | CT Loss: 3.6712| [0m
[91mEpoch: 0|  Loss:  6.1238 |Global loss: 8.2305| Local H loss: 0.0271  | Global H loss: 0.0305 [0m
[94mEpoch: 1|  NKD Loss: 1.1538 | CT Loss: 3.4297| [0m
[91mEpoch: 1|  Loss:  5.4749 |Global loss: 7.217| Local H loss: 0.0246  | Global H loss: 0.0261 [0m
[94mEpoch: 2|  NKD Loss: 1.0814 | CT Loss: 3.3489| [0m
[91mEpoch: 2|  Loss:  5.3187 |Global loss: 7.022| Local H loss: 0.0244  | Global H loss: 0.0255 [0m
[94mEpoch: 3|  NKD Loss: 1.0743 | CT Loss: 3.3| [0m
[91mEpoch: 3|  Loss:  5.2567 |Global loss: 6.9165| Local H loss: 0.0254  | Global H loss: 0.0256 [0m
[94mEpoch: 0|  NKD Loss: 1.6967 | CT Loss: 3.6103| [0m
[91mEpoch: 0|  Loss:  5.8861 |Global loss: 8.161| Local H loss: 0.0409  | Global H loss: 0.0397 [0m
[94mEpoch: 1|  NKD Loss: 1.1529 | CT Loss: 3.3858| [0m
[91mEpoch: 1|  Loss:  5.0908 |Global loss: 6.9791| Local H loss: 0.0324  | Global H loss: 0.0345 [0m
[94mEpoch: 2|  NKD Loss: 1.1494 | CT Loss: 3.3152| [0m
[91mEpoch: 2|  Loss:  5.0292 |Global loss: 6.8345| Local H loss: 0.0326  | Global H loss: 0.0332 [0m
[94mEpoch: 3|  NKD Loss: 1.1152 | CT Loss: 3.2672| [0m
[91mEpoch: 3|  Loss:  4.9356 |Global loss: 6.7022| Local H loss: 0.0325  | Global H loss: 0.0331 [0m
------------------------- time cost ------------------------- 12.391614198684692
Chosen Clients:  [1, 0, 8]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.874, 0.846, 0.908, 0.884, 0.757, 0.839, 0.82, 0.809, 1.0]
AUC in each clients:  [451.004, 483.878, 326.929, 427.703, 491.417, 451.414, 427.524, 476.713, 12.0]
F1 Score:  [0.865, 0.828, 0.882, 0.854, 0.627, 0.719, 0.643, 0.665, 1.0]
Recall Score:  [0.854, 0.827, 0.87, 0.847, 0.649, 0.747, 0.666, 0.69, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.3876
Averaged Test Accurancy: 0.8386
Averaged Test AUC: 0.9453
Averaged Test F1_score: 0.7870
Averaged Test Recal score: 0.7944
Std Test Accurancy: 0.0651
Std Test AUC: 0.0206
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.6209 | CT Loss: 3.6038| [0m
[91mEpoch: 0|  Loss:  5.7769 |Global loss: 8.2757| Local H loss: 0.04  | Global H loss: 0.0434 [0m
[94mEpoch: 1|  NKD Loss: 1.1561 | CT Loss: 3.3655| [0m
[91mEpoch: 1|  Loss:  5.1137 |Global loss: 6.7804| Local H loss: 0.0298  | Global H loss: 0.0319 [0m
[94mEpoch: 2|  NKD Loss: 1.1237 | CT Loss: 3.2855| [0m
[91mEpoch: 2|  Loss:  4.9912 |Global loss: 6.5863| Local H loss: 0.0287  | Global H loss: 0.0309 [0m
[94mEpoch: 3|  NKD Loss: 1.0989 | CT Loss: 3.2411| [0m
[91mEpoch: 3|  Loss:  4.8988 |Global loss: 6.4316| Local H loss: 0.0292  | Global H loss: 0.0309 [0m
[94mEpoch: 0|  NKD Loss: 1.4699 | CT Loss: 3.3773| [0m
[91mEpoch: 0|  Loss:  5.3889 |Global loss: 7.6007| Local H loss: 0.0368  | Global H loss: 0.0395 [0m
[94mEpoch: 1|  NKD Loss: 1.1536 | CT Loss: 3.2327| [0m
[91mEpoch: 1|  Loss:  4.9304 |Global loss: 6.717| Local H loss: 0.0324  | Global H loss: 0.0333 [0m
[94mEpoch: 2|  NKD Loss: 1.1357 | CT Loss: 3.2071| [0m
[91mEpoch: 2|  Loss:  4.8918 |Global loss: 6.6104| Local H loss: 0.033  | Global H loss: 0.0331 [0m
[94mEpoch: 3|  NKD Loss: 1.1022 | CT Loss: 3.1824| [0m
[91mEpoch: 3|  Loss:  4.8081 |Global loss: 6.4938| Local H loss: 0.0335  | Global H loss: 0.0335 [0m
[94mEpoch: 0|  NKD Loss: 2.3809 | CT Loss: 5.4483| [0m
[91mEpoch: 0|  Loss:  7.9408 |Global loss: 17.7234| Local H loss: 0.0377  | Global H loss: 0.0771 [0m
[94mEpoch: 1|  NKD Loss: 2.0221 | CT Loss: 4.2732| [0m
[91mEpoch: 1|  Loss:  6.4109 |Global loss: 16.2817| Local H loss: 0.0383  | Global H loss: 0.0842 [0m
[94mEpoch: 2|  NKD Loss: 1.7585 | CT Loss: 4.261| [0m
[91mEpoch: 2|  Loss:  6.1459 |Global loss: 12.8365| Local H loss: 0.0488  | Global H loss: 0.0835 [0m
[94mEpoch: 3|  NKD Loss: 1.3557 | CT Loss: 4.2475| [0m
[91mEpoch: 3|  Loss:  5.7464 |Global loss: 9.9947| Local H loss: 0.0648  | Global H loss: 0.0816 [0m
------------------------- time cost ------------------------- 9.577386617660522
Chosen Clients:  [1, 2, 6]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.833, 0.908, 0.884, 0.757, 0.839, 0.82, 0.809, 1.0]
AUC in each clients:  [453.24, 476.988, 326.929, 427.703, 491.417, 451.414, 427.524, 476.713, 12.0]
F1 Score:  [0.895, 0.819, 0.882, 0.854, 0.627, 0.719, 0.643, 0.665, 1.0]
Recall Score:  [0.885, 0.812, 0.87, 0.847, 0.649, 0.747, 0.666, 0.69, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.1932
Averaged Test Accurancy: 0.8399
Averaged Test AUC: 0.9440
Averaged Test F1_score: 0.7893
Averaged Test Recal score: 0.7962
Std Test Accurancy: 0.0666
Std Test AUC: 0.0206
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.496 | CT Loss: 3.4595| [0m
[91mEpoch: 0|  Loss:  5.5174 |Global loss: 7.954| Local H loss: 0.0325  | Global H loss: 0.0397 [0m
[94mEpoch: 1|  NKD Loss: 1.1199 | CT Loss: 3.2306| [0m
[91mEpoch: 1|  Loss:  4.9162 |Global loss: 6.5263| Local H loss: 0.0287  | Global H loss: 0.0317 [0m
[94mEpoch: 2|  NKD Loss: 1.0932 | CT Loss: 3.196| [0m
[91mEpoch: 2|  Loss:  4.8463 |Global loss: 6.4007| Local H loss: 0.03  | Global H loss: 0.0317 [0m
[94mEpoch: 3|  NKD Loss: 1.0426 | CT Loss: 3.1763| [0m
[91mEpoch: 3|  Loss:  4.7722 |Global loss: 6.2478| Local H loss: 0.0305  | Global H loss: 0.0311 [0m
[94mEpoch: 0|  NKD Loss: 1.2941 | CT Loss: 3.7041| [0m
[91mEpoch: 0|  Loss:  5.3388 |Global loss: 7.7732| Local H loss: 0.0564  | Global H loss: 0.0527 [0m
[94mEpoch: 1|  NKD Loss: 0.8966 | CT Loss: 3.5326| [0m
[91mEpoch: 1|  Loss:  4.7748 |Global loss: 6.4968| Local H loss: 0.0491  | Global H loss: 0.0443 [0m
[94mEpoch: 2|  NKD Loss: 0.859 | CT Loss: 3.4665| [0m
[91mEpoch: 2|  Loss:  4.6896 |Global loss: 6.3243| Local H loss: 0.0462  | Global H loss: 0.042 [0m
[94mEpoch: 3|  NKD Loss: 0.7847 | CT Loss: 3.4155| [0m
[91mEpoch: 3|  Loss:  4.5534 |Global loss: 6.0554| Local H loss: 0.0473  | Global H loss: 0.0411 [0m
[94mEpoch: 0|  NKD Loss: 1.6231 | CT Loss: 3.7229| [0m
[91mEpoch: 0|  Loss:  6.0003 |Global loss: 8.431| Local H loss: 0.0379  | Global H loss: 0.0398 [0m
[94mEpoch: 1|  NKD Loss: 1.1247 | CT Loss: 3.3995| [0m
[91mEpoch: 1|  Loss:  5.1903 |Global loss: 6.611| Local H loss: 0.0312  | Global H loss: 0.0298 [0m
[94mEpoch: 2|  NKD Loss: 1.0822 | CT Loss: 3.3049| [0m
[91mEpoch: 2|  Loss:  5.0556 |Global loss: 6.4043| Local H loss: 0.03  | Global H loss: 0.0286 [0m
[94mEpoch: 3|  NKD Loss: 1.0539 | CT Loss: 3.2447| [0m
[91mEpoch: 3|  Loss:  4.9472 |Global loss: 6.2629| Local H loss: 0.0311  | Global H loss: 0.029 [0m
------------------------- time cost ------------------------- 11.52338719367981
Chosen Clients:  [3, 2, 4]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.839, 0.89, 0.884, 0.757, 0.839, 0.847, 0.809, 1.0]
AUC in each clients:  [453.24, 476.77, 325.176, 427.703, 491.417, 451.414, 422.782, 476.713, 12.0]
F1 Score:  [0.895, 0.828, 0.865, 0.854, 0.627, 0.719, 0.705, 0.665, 1.0]
Recall Score:  [0.885, 0.826, 0.852, 0.847, 0.649, 0.747, 0.713, 0.69, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.8510
Averaged Test Accurancy: 0.8423
Averaged Test AUC: 0.9423
Averaged Test F1_score: 0.7953
Averaged Test Recal score: 0.8010
Std Test Accurancy: 0.0640
Std Test AUC: 0.0205
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.5998 | CT Loss: 3.6826| [0m
[91mEpoch: 0|  Loss:  5.6897 |Global loss: 8.1606| Local H loss: 0.0538  | Global H loss: 0.0495 [0m
[94mEpoch: 1|  NKD Loss: 1.0442 | CT Loss: 3.4467| [0m
[91mEpoch: 1|  Loss:  4.9161 |Global loss: 6.46| Local H loss: 0.0451  | Global H loss: 0.0404 [0m
[94mEpoch: 2|  NKD Loss: 1.0026 | CT Loss: 3.3611| [0m
[91mEpoch: 2|  Loss:  4.7761 |Global loss: 6.2028| Local H loss: 0.0455  | Global H loss: 0.0391 [0m
[94mEpoch: 3|  NKD Loss: 0.8916 | CT Loss: 3.319| [0m
[91mEpoch: 3|  Loss:  4.6381 |Global loss: 5.998| Local H loss: 0.0451  | Global H loss: 0.0381 [0m
[94mEpoch: 0|  NKD Loss: 1.3703 | CT Loss: 3.5939| [0m
[91mEpoch: 0|  Loss:  5.3337 |Global loss: 7.8851| Local H loss: 0.0472  | Global H loss: 0.0475 [0m
[94mEpoch: 1|  NKD Loss: 0.9297 | CT Loss: 3.381| [0m
[91mEpoch: 1|  Loss:  4.6843 |Global loss: 6.1917| Local H loss: 0.0447  | Global H loss: 0.0403 [0m
[94mEpoch: 2|  NKD Loss: 0.7728 | CT Loss: 3.3449| [0m
[91mEpoch: 2|  Loss:  4.4758 |Global loss: 5.8682| Local H loss: 0.0456  | Global H loss: 0.0386 [0m
[94mEpoch: 3|  NKD Loss: 0.7186 | CT Loss: 3.3342| [0m
[91mEpoch: 3|  Loss:  4.4346 |Global loss: 5.7885| Local H loss: 0.0463  | Global H loss: 0.0386 [0m
[94mEpoch: 0|  NKD Loss: 1.6457 | CT Loss: 3.4433| [0m
[91mEpoch: 0|  Loss:  5.9137 |Global loss: 8.1954| Local H loss: 0.0317  | Global H loss: 0.035 [0m
[94mEpoch: 1|  NKD Loss: 1.2637 | CT Loss: 3.2253| [0m
[91mEpoch: 1|  Loss:  5.3043 |Global loss: 6.6273| Local H loss: 0.0286  | Global H loss: 0.026 [0m
[94mEpoch: 2|  NKD Loss: 1.1887 | CT Loss: 3.1916| [0m
[91mEpoch: 2|  Loss:  5.1814 |Global loss: 6.4598| Local H loss: 0.0275  | Global H loss: 0.0242 [0m
[94mEpoch: 3|  NKD Loss: 1.1324 | CT Loss: 3.1791| [0m
[91mEpoch: 3|  Loss:  5.0995 |Global loss: 6.3371| Local H loss: 0.0264  | Global H loss: 0.0236 [0m
------------------------- time cost ------------------------- 11.310920715332031
Chosen Clients:  [4, 6, 7]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.839, 0.899, 0.886, 0.78, 0.839, 0.847, 0.809, 1.0]
AUC in each clients:  [453.24, 476.77, 325.112, 423.978, 491.229, 451.414, 422.782, 476.713, 12.0]
F1 Score:  [0.895, 0.828, 0.875, 0.862, 0.627, 0.719, 0.705, 0.665, 1.0]
Recall Score:  [0.885, 0.826, 0.863, 0.856, 0.665, 0.747, 0.713, 0.69, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 11.8983
Averaged Test Accurancy: 0.8466
Averaged Test AUC: 0.9412
Averaged Test F1_score: 0.7973
Averaged Test Recal score: 0.8050
Std Test Accurancy: 0.0606
Std Test AUC: 0.0204
Std Test F1: 0.0257
Std Test Recall: 0.0257
[94mEpoch: 0|  NKD Loss: 1.6079 | CT Loss: 3.4015| [0m
[91mEpoch: 0|  Loss:  5.7979 |Global loss: 8.0077| Local H loss: 0.0319  | Global H loss: 0.0351 [0m
[94mEpoch: 1|  NKD Loss: 1.2152 | CT Loss: 3.1782| [0m
[91mEpoch: 1|  Loss:  5.1637 |Global loss: 6.5134| Local H loss: 0.0297  | Global H loss: 0.0266 [0m
[94mEpoch: 2|  NKD Loss: 1.154 | CT Loss: 3.1593| [0m
[91mEpoch: 2|  Loss:  5.0914 |Global loss: 6.3869| Local H loss: 0.0276  | Global H loss: 0.0245 [0m
[94mEpoch: 3|  NKD Loss: 1.0879 | CT Loss: 3.1457| [0m
[91mEpoch: 3|  Loss:  4.9942 |Global loss: 6.3023| Local H loss: 0.0273  | Global H loss: 0.0249 [0m
[94mEpoch: 0|  NKD Loss: 1.4117 | CT Loss: 3.4328| [0m
[91mEpoch: 0|  Loss:  5.4844 |Global loss: 7.603| Local H loss: 0.033  | Global H loss: 0.037 [0m
[94mEpoch: 1|  NKD Loss: 1.0897 | CT Loss: 3.2145| [0m
[91mEpoch: 1|  Loss:  4.9232 |Global loss: 6.22| Local H loss: 0.0318  | Global H loss: 0.0296 [0m
[94mEpoch: 2|  NKD Loss: 0.9678 | CT Loss: 3.1907| [0m
[91mEpoch: 2|  Loss:  4.7562 |Global loss: 6.0122| Local H loss: 0.0328  | Global H loss: 0.0298 [0m
[94mEpoch: 3|  NKD Loss: 0.8686 | CT Loss: 3.174| [0m
[91mEpoch: 3|  Loss:  4.6392 |Global loss: 5.8682| Local H loss: 0.0321  | Global H loss: 0.0293 [0m
[94mEpoch: 0|  NKD Loss: 1.5877 | CT Loss: 3.5253| [0m
[91mEpoch: 0|  Loss:  5.7906 |Global loss: 8.2769| Local H loss: 0.0358  | Global H loss: 0.0393 [0m
[94mEpoch: 1|  NKD Loss: 1.1865 | CT Loss: 3.2744| [0m
[91mEpoch: 1|  Loss:  5.1141 |Global loss: 6.855| Local H loss: 0.0341  | Global H loss: 0.0333 [0m
[94mEpoch: 2|  NKD Loss: 1.0591 | CT Loss: 3.221| [0m
[91mEpoch: 2|  Loss:  4.9302 |Global loss: 6.5804| Local H loss: 0.034  | Global H loss: 0.0327 [0m
[94mEpoch: 3|  NKD Loss: 0.9804 | CT Loss: 3.1943| [0m
[91mEpoch: 3|  Loss:  4.8115 |Global loss: 6.4383| Local H loss: 0.0339  | Global H loss: 0.032 [0m
------------------------- time cost ------------------------- 12.006469964981079
Chosen Clients:  [5, 4, 1]

-------------Round number: 59-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.839, 0.899, 0.886, 0.787, 0.839, 0.871, 0.821, 1.0]
AUC in each clients:  [453.24, 476.77, 325.112, 423.978, 492.394, 451.414, 426.979, 476.682, 12.0]
F1 Score:  [0.895, 0.828, 0.875, 0.862, 0.631, 0.719, 0.725, 0.701, 1.0]
Recall Score:  [0.885, 0.826, 0.863, 0.856, 0.671, 0.747, 0.735, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.0933
Averaged Test Accurancy: 0.8522
Averaged Test AUC: 0.9426
Averaged Test F1_score: 0.8040
Averaged Test Recal score: 0.8111
Std Test Accurancy: 0.0578
Std Test AUC: 0.0199
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.4469 | CT Loss: 3.4308| [0m
[91mEpoch: 0|  Loss:  5.5575 |Global loss: 7.3919| Local H loss: 0.0348  | Global H loss: 0.0347 [0m
[94mEpoch: 1|  NKD Loss: 1.1819 | CT Loss: 3.2769| [0m
[91mEpoch: 1|  Loss:  5.1355 |Global loss: 6.5997| Local H loss: 0.0305  | Global H loss: 0.0281 [0m
[94mEpoch: 2|  NKD Loss: 1.0945 | CT Loss: 3.249| [0m
[91mEpoch: 2|  Loss:  5.0177 |Global loss: 6.4183| Local H loss: 0.0297  | Global H loss: 0.0273 [0m
[94mEpoch: 3|  NKD Loss: 1.0438 | CT Loss: 3.2384| [0m
[91mEpoch: 3|  Loss:  4.9384 |Global loss: 6.3065| Local H loss: 0.0303  | Global H loss: 0.0274 [0m
[94mEpoch: 0|  NKD Loss: 1.6811 | CT Loss: 3.3827| [0m
[91mEpoch: 0|  Loss:  5.8237 |Global loss: 7.9724| Local H loss: 0.0344  | Global H loss: 0.0348 [0m
[94mEpoch: 1|  NKD Loss: 1.2273 | CT Loss: 3.1581| [0m
[91mEpoch: 1|  Loss:  5.1305 |Global loss: 6.439| Local H loss: 0.0307  | Global H loss: 0.0266 [0m
[94mEpoch: 2|  NKD Loss: 1.1316 | CT Loss: 3.1366| [0m
[91mEpoch: 2|  Loss:  5.0173 |Global loss: 6.3173| Local H loss: 0.0291  | Global H loss: 0.0258 [0m
[94mEpoch: 3|  NKD Loss: 1.0617 | CT Loss: 3.1312| [0m
[91mEpoch: 3|  Loss:  4.926 |Global loss: 6.2239| Local H loss: 0.0285  | Global H loss: 0.0258 [0m
[94mEpoch: 0|  NKD Loss: 1.4967 | CT Loss: 3.3997| [0m
[91mEpoch: 0|  Loss:  5.4266 |Global loss: 7.7323| Local H loss: 0.0362  | Global H loss: 0.0407 [0m
[94mEpoch: 1|  NKD Loss: 1.0325 | CT Loss: 3.1805| [0m
[91mEpoch: 1|  Loss:  4.7514 |Global loss: 6.2311| Local H loss: 0.0321  | Global H loss: 0.0323 [0m
[94mEpoch: 2|  NKD Loss: 0.899 | CT Loss: 3.1522| [0m
[91mEpoch: 2|  Loss:  4.6055 |Global loss: 6.0574| Local H loss: 0.0311  | Global H loss: 0.0309 [0m
[94mEpoch: 3|  NKD Loss: 0.7928 | CT Loss: 3.1397| [0m
[91mEpoch: 3|  Loss:  4.4693 |Global loss: 5.9501| Local H loss: 0.0313  | Global H loss: 0.032 [0m
------------------------- time cost ------------------------- 12.180758714675903
Chosen Clients:  [1, 2, 8]

-------------Round number: 60-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.858, 0.899, 0.886, 0.789, 0.853, 0.871, 0.821, 1.0]
AUC in each clients:  [453.24, 478.642, 325.112, 423.978, 494.534, 452.959, 426.979, 476.682, 12.0]
F1 Score:  [0.895, 0.847, 0.875, 0.862, 0.635, 0.732, 0.725, 0.701, 1.0]
Recall Score:  [0.885, 0.844, 0.863, 0.856, 0.673, 0.76, 0.735, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.3808
Averaged Test Accurancy: 0.8570
Averaged Test AUC: 0.9441
Averaged Test F1_score: 0.8080
Averaged Test Recal score: 0.8148
Std Test Accurancy: 0.0557
Std Test AUC: 0.0191
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.4618 | CT Loss: 3.3107| [0m
[91mEpoch: 0|  Loss:  5.2781 |Global loss: 7.4933| Local H loss: 0.0385  | Global H loss: 0.0409 [0m
[94mEpoch: 1|  NKD Loss: 0.8886 | CT Loss: 3.1467| [0m
[91mEpoch: 1|  Loss:  4.5314 |Global loss: 6.0567| Local H loss: 0.0332  | Global H loss: 0.0339 [0m
[94mEpoch: 2|  NKD Loss: 0.7963 | CT Loss: 3.1363| [0m
[91mEpoch: 2|  Loss:  4.4447 |Global loss: 5.9354| Local H loss: 0.034  | Global H loss: 0.0335 [0m
[94mEpoch: 3|  NKD Loss: 0.7823 | CT Loss: 3.1247| [0m
[91mEpoch: 3|  Loss:  4.4013 |Global loss: 5.8986| Local H loss: 0.0345  | Global H loss: 0.0346 [0m
[94mEpoch: 0|  NKD Loss: 1.3644 | CT Loss: 3.4819| [0m
[91mEpoch: 0|  Loss:  5.2195 |Global loss: 7.1195| Local H loss: 0.0527  | Global H loss: 0.0467 [0m
[94mEpoch: 1|  NKD Loss: 0.785 | CT Loss: 3.2974| [0m
[91mEpoch: 1|  Loss:  4.4591 |Global loss: 5.8414| Local H loss: 0.0434  | Global H loss: 0.038 [0m
[94mEpoch: 2|  NKD Loss: 0.7248 | CT Loss: 3.2796| [0m
[91mEpoch: 2|  Loss:  4.3673 |Global loss: 5.7126| Local H loss: 0.0449  | Global H loss: 0.0385 [0m
[94mEpoch: 3|  NKD Loss: 0.6755 | CT Loss: 3.2481| [0m
[91mEpoch: 3|  Loss:  4.2887 |Global loss: 5.5934| Local H loss: 0.0463  | Global H loss: 0.0378 [0m
[94mEpoch: 0|  NKD Loss: 2.5227 | CT Loss: 5.465| [0m
[91mEpoch: 0|  Loss:  8.1074 |Global loss: 16.5878| Local H loss: 0.0412  | Global H loss: 0.077 [0m
[94mEpoch: 1|  NKD Loss: 2.9716 | CT Loss: 4.3254| [0m
[91mEpoch: 1|  Loss:  7.4182 |Global loss: 17.8555| Local H loss: 0.0384  | Global H loss: 0.0852 [0m
[94mEpoch: 2|  NKD Loss: 1.5935 | CT Loss: 4.305| [0m
[91mEpoch: 2|  Loss:  6.0342 |Global loss: 14.0664| Local H loss: 0.0339  | Global H loss: 0.086 [0m
[94mEpoch: 3|  NKD Loss: 1.0858 | CT Loss: 4.2777| [0m
[91mEpoch: 3|  Loss:  5.5059 |Global loss: 10.9022| Local H loss: 0.0459  | Global H loss: 0.0836 [0m
------------------------- time cost ------------------------- 8.739469766616821
Chosen Clients:  [5, 0, 4]

-------------Round number: 61-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.899, 0.856, 0.899, 0.886, 0.789, 0.853, 0.871, 0.821, 1.0]
AUC in each clients:  [453.24, 479.439, 325.343, 423.978, 494.534, 452.959, 426.979, 476.682, 12.0]
F1 Score:  [0.895, 0.848, 0.876, 0.862, 0.635, 0.732, 0.725, 0.701, 1.0]
Recall Score:  [0.885, 0.844, 0.864, 0.856, 0.673, 0.76, 0.735, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.3617
Averaged Test Accurancy: 0.8567
Averaged Test AUC: 0.9444
Averaged Test F1_score: 0.8082
Averaged Test Recal score: 0.8149
Std Test Accurancy: 0.0558
Std Test AUC: 0.0191
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.5206 | CT Loss: 3.4646| [0m
[91mEpoch: 0|  Loss:  5.6373 |Global loss: 7.7411| Local H loss: 0.0372  | Global H loss: 0.0373 [0m
[94mEpoch: 1|  NKD Loss: 1.1638 | CT Loss: 3.2441| [0m
[91mEpoch: 1|  Loss:  5.0603 |Global loss: 6.5002| Local H loss: 0.0319  | Global H loss: 0.0287 [0m
[94mEpoch: 2|  NKD Loss: 1.1056 | CT Loss: 3.2303| [0m
[91mEpoch: 2|  Loss:  5.0023 |Global loss: 6.4097| Local H loss: 0.0295  | Global H loss: 0.0276 [0m
[94mEpoch: 3|  NKD Loss: 1.0388 | CT Loss: 3.2113| [0m
[91mEpoch: 3|  Loss:  4.8966 |Global loss: 6.2307| Local H loss: 0.028  | Global H loss: 0.0267 [0m
[94mEpoch: 0|  NKD Loss: 1.4117 | CT Loss: 3.2985| [0m
[91mEpoch: 0|  Loss:  5.2186 |Global loss: 7.1396| Local H loss: 0.0388  | Global H loss: 0.0378 [0m
[94mEpoch: 1|  NKD Loss: 1.1301 | CT Loss: 3.1718| [0m
[91mEpoch: 1|  Loss:  4.82 |Global loss: 6.4418| Local H loss: 0.0352  | Global H loss: 0.0339 [0m
[94mEpoch: 2|  NKD Loss: 1.0368 | CT Loss: 3.1572| [0m
[91mEpoch: 2|  Loss:  4.7001 |Global loss: 6.3452| Local H loss: 0.0361  | Global H loss: 0.0345 [0m
[94mEpoch: 3|  NKD Loss: 0.9941 | CT Loss: 3.1377| [0m
[91mEpoch: 3|  Loss:  4.6469 |Global loss: 6.2385| Local H loss: 0.0365  | Global H loss: 0.0337 [0m
[94mEpoch: 0|  NKD Loss: 1.734 | CT Loss: 3.4794| [0m
[91mEpoch: 0|  Loss:  5.9534 |Global loss: 8.4077| Local H loss: 0.0351  | Global H loss: 0.0368 [0m
[94mEpoch: 1|  NKD Loss: 1.1737 | CT Loss: 3.1279| [0m
[91mEpoch: 1|  Loss:  5.0224 |Global loss: 6.376| Local H loss: 0.0309  | Global H loss: 0.0273 [0m
[94mEpoch: 2|  NKD Loss: 1.1025 | CT Loss: 3.1178| [0m
[91mEpoch: 2|  Loss:  4.9314 |Global loss: 6.2772| Local H loss: 0.0302  | Global H loss: 0.027 [0m
[94mEpoch: 3|  NKD Loss: 1.044 | CT Loss: 3.1046| [0m
[91mEpoch: 3|  Loss:  4.8435 |Global loss: 6.1823| Local H loss: 0.0306  | Global H loss: 0.0271 [0m
------------------------- time cost ------------------------- 11.940410375595093
Chosen Clients:  [6, 2, 5]

-------------Round number: 62-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.894, 0.856, 0.899, 0.886, 0.778, 0.839, 0.871, 0.821, 1.0]
AUC in each clients:  [453.956, 479.439, 325.343, 423.978, 496.039, 452.169, 426.979, 476.682, 12.0]
F1 Score:  [0.892, 0.848, 0.876, 0.862, 0.635, 0.719, 0.725, 0.701, 1.0]
Recall Score:  [0.882, 0.844, 0.864, 0.856, 0.667, 0.746, 0.735, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.6148
Averaged Test Accurancy: 0.8527
Averaged Test AUC: 0.9447
Averaged Test F1_score: 0.8064
Averaged Test Recal score: 0.8123
Std Test Accurancy: 0.0584
Std Test AUC: 0.0189
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.4761 | CT Loss: 3.3804| [0m
[91mEpoch: 0|  Loss:  5.4351 |Global loss: 7.5659| Local H loss: 0.0385  | Global H loss: 0.0378 [0m
[94mEpoch: 1|  NKD Loss: 0.8478 | CT Loss: 3.174| [0m
[91mEpoch: 1|  Loss:  4.6085 |Global loss: 5.8761| Local H loss: 0.0328  | Global H loss: 0.0304 [0m
[94mEpoch: 2|  NKD Loss: 0.7551 | CT Loss: 3.1398| [0m
[91mEpoch: 2|  Loss:  4.4769 |Global loss: 5.7296| Local H loss: 0.0331  | Global H loss: 0.0301 [0m
[94mEpoch: 3|  NKD Loss: 0.7485 | CT Loss: 3.1366| [0m
[91mEpoch: 3|  Loss:  4.4528 |Global loss: 5.6902| Local H loss: 0.0348  | Global H loss: 0.0309 [0m
[94mEpoch: 0|  NKD Loss: 1.3939 | CT Loss: 3.4329| [0m
[91mEpoch: 0|  Loss:  5.1976 |Global loss: 7.0572| Local H loss: 0.054  | Global H loss: 0.045 [0m
[94mEpoch: 1|  NKD Loss: 0.716 | CT Loss: 3.2401| [0m
[91mEpoch: 1|  Loss:  4.3211 |Global loss: 5.7055| Local H loss: 0.0457  | Global H loss: 0.0394 [0m
[94mEpoch: 2|  NKD Loss: 0.6745 | CT Loss: 3.2275| [0m
[91mEpoch: 2|  Loss:  4.2713 |Global loss: 5.6179| Local H loss: 0.0444  | Global H loss: 0.0378 [0m
[94mEpoch: 3|  NKD Loss: 0.6569 | CT Loss: 3.2172| [0m
[91mEpoch: 3|  Loss:  4.2258 |Global loss: 5.548| Local H loss: 0.0468  | Global H loss: 0.0391 [0m
[94mEpoch: 0|  NKD Loss: 1.6267 | CT Loss: 3.4428| [0m
[91mEpoch: 0|  Loss:  5.7242 |Global loss: 7.8908| Local H loss: 0.036  | Global H loss: 0.0354 [0m
[94mEpoch: 1|  NKD Loss: 1.0878 | CT Loss: 3.2099| [0m
[91mEpoch: 1|  Loss:  4.9285 |Global loss: 6.346| Local H loss: 0.0302  | Global H loss: 0.0283 [0m
[94mEpoch: 2|  NKD Loss: 1.0265 | CT Loss: 3.1985| [0m
[91mEpoch: 2|  Loss:  4.8589 |Global loss: 6.2262| Local H loss: 0.0294  | Global H loss: 0.0274 [0m
[94mEpoch: 3|  NKD Loss: 0.9849 | CT Loss: 3.2032| [0m
[91mEpoch: 3|  Loss:  4.8109 |Global loss: 6.1245| Local H loss: 0.0308  | Global H loss: 0.0275 [0m
------------------------- time cost ------------------------- 11.045313119888306
Chosen Clients:  [7, 2, 6]

-------------Round number: 63-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.894, 0.856, 0.914, 0.886, 0.778, 0.841, 0.869, 0.821, 1.0]
AUC in each clients:  [453.956, 479.439, 326.135, 423.978, 496.039, 455.285, 428.242, 476.682, 12.0]
F1 Score:  [0.892, 0.848, 0.894, 0.862, 0.635, 0.715, 0.727, 0.701, 1.0]
Recall Score:  [0.882, 0.844, 0.886, 0.856, 0.667, 0.745, 0.737, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.5490
Averaged Test Accurancy: 0.8540
Averaged Test AUC: 0.9461
Averaged Test F1_score: 0.8082
Averaged Test Recal score: 0.8149
Std Test Accurancy: 0.0592
Std Test AUC: 0.0186
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.5386 | CT Loss: 3.463| [0m
[91mEpoch: 0|  Loss:  5.631 |Global loss: 7.7022| Local H loss: 0.0403  | Global H loss: 0.0406 [0m
[94mEpoch: 1|  NKD Loss: 1.0821 | CT Loss: 3.2054| [0m
[91mEpoch: 1|  Loss:  4.9038 |Global loss: 6.4779| Local H loss: 0.0365  | Global H loss: 0.0324 [0m
[94mEpoch: 2|  NKD Loss: 1.0047 | CT Loss: 3.1672| [0m
[91mEpoch: 2|  Loss:  4.7782 |Global loss: 6.2637| Local H loss: 0.0378  | Global H loss: 0.0326 [0m
[94mEpoch: 3|  NKD Loss: 0.9511 | CT Loss: 3.1519| [0m
[91mEpoch: 3|  Loss:  4.6996 |Global loss: 6.2161| Local H loss: 0.0372  | Global H loss: 0.0327 [0m
[94mEpoch: 0|  NKD Loss: 1.3743 | CT Loss: 3.3978| [0m
[91mEpoch: 0|  Loss:  5.1397 |Global loss: 7.1738| Local H loss: 0.0521  | Global H loss: 0.0451 [0m
[94mEpoch: 1|  NKD Loss: 0.7439 | CT Loss: 3.2118| [0m
[91mEpoch: 1|  Loss:  4.3025 |Global loss: 5.6783| Local H loss: 0.0472  | Global H loss: 0.0395 [0m
[94mEpoch: 2|  NKD Loss: 0.6571 | CT Loss: 3.1882| [0m
[91mEpoch: 2|  Loss:  4.1687 |Global loss: 5.4796| Local H loss: 0.0489  | Global H loss: 0.0412 [0m
[94mEpoch: 3|  NKD Loss: 0.6303 | CT Loss: 3.1824| [0m
[91mEpoch: 3|  Loss:  4.1556 |Global loss: 5.445| Local H loss: 0.0459  | Global H loss: 0.0393 [0m
[94mEpoch: 0|  NKD Loss: 1.2691 | CT Loss: 3.2868| [0m
[91mEpoch: 0|  Loss:  5.1202 |Global loss: 6.7314| Local H loss: 0.0409  | Global H loss: 0.0372 [0m
[94mEpoch: 1|  NKD Loss: 0.7716 | CT Loss: 3.134| [0m
[91mEpoch: 1|  Loss:  4.4545 |Global loss: 5.7579| Local H loss: 0.0356  | Global H loss: 0.032 [0m
[94mEpoch: 2|  NKD Loss: 0.7422 | CT Loss: 3.1087| [0m
[91mEpoch: 2|  Loss:  4.393 |Global loss: 5.6672| Local H loss: 0.036  | Global H loss: 0.0322 [0m
[94mEpoch: 3|  NKD Loss: 0.7244 | CT Loss: 3.105| [0m
[91mEpoch: 3|  Loss:  4.3709 |Global loss: 5.6329| Local H loss: 0.0372  | Global H loss: 0.0317 [0m
------------------------- time cost ------------------------- 11.04122257232666
Chosen Clients:  [2, 3, 8]

-------------Round number: 64-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.894, 0.856, 0.89, 0.886, 0.778, 0.841, 0.871, 0.83, 1.0]
AUC in each clients:  [453.956, 479.439, 326.709, 423.978, 496.039, 455.285, 429.841, 481.0, 12.0]
F1 Score:  [0.892, 0.848, 0.867, 0.862, 0.635, 0.715, 0.732, 0.743, 1.0]
Recall Score:  [0.882, 0.844, 0.856, 0.856, 0.667, 0.745, 0.742, 0.741, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.8251
Averaged Test Accurancy: 0.8535
Averaged Test AUC: 0.9479
Averaged Test F1_score: 0.8104
Averaged Test Recal score: 0.8148
Std Test Accurancy: 0.0570
Std Test AUC: 0.0183
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.1833 | CT Loss: 3.2999| [0m
[91mEpoch: 0|  Loss:  4.8329 |Global loss: 6.4668| Local H loss: 0.0536  | Global H loss: 0.0452 [0m
[94mEpoch: 1|  NKD Loss: 0.7363 | CT Loss: 3.1754| [0m
[91mEpoch: 1|  Loss:  4.2684 |Global loss: 5.6713| Local H loss: 0.0467  | Global H loss: 0.0398 [0m
[94mEpoch: 2|  NKD Loss: 0.6558 | CT Loss: 3.1599| [0m
[91mEpoch: 2|  Loss:  4.1494 |Global loss: 5.4525| Local H loss: 0.0493  | Global H loss: 0.041 [0m
[94mEpoch: 3|  NKD Loss: 0.6512 | CT Loss: 3.1649| [0m
[91mEpoch: 3|  Loss:  4.1345 |Global loss: 5.4528| Local H loss: 0.0509  | Global H loss: 0.0413 [0m
[94mEpoch: 0|  NKD Loss: 1.3569 | CT Loss: 3.4189| [0m
[91mEpoch: 0|  Loss:  5.2216 |Global loss: 6.8755| Local H loss: 0.0512  | Global H loss: 0.043 [0m
[94mEpoch: 1|  NKD Loss: 0.8312 | CT Loss: 3.2782| [0m
[91mEpoch: 1|  Loss:  4.5552 |Global loss: 5.9412| Local H loss: 0.0445  | Global H loss: 0.0381 [0m
[94mEpoch: 2|  NKD Loss: 0.7613 | CT Loss: 3.2367| [0m
[91mEpoch: 2|  Loss:  4.4182 |Global loss: 5.7812| Local H loss: 0.0465  | Global H loss: 0.0391 [0m
[94mEpoch: 3|  NKD Loss: 0.7058 | CT Loss: 3.212| [0m
[91mEpoch: 3|  Loss:  4.3296 |Global loss: 5.6769| Local H loss: 0.0471  | Global H loss: 0.0397 [0m
[94mEpoch: 0|  NKD Loss: 2.5158 | CT Loss: 5.7326| [0m
[91mEpoch: 0|  Loss:  8.3686 |Global loss: 19.2737| Local H loss: 0.0322  | Global H loss: 0.078 [0m
[94mEpoch: 1|  NKD Loss: 1.5408 | CT Loss: 4.2884| [0m
[91mEpoch: 1|  Loss:  5.9561 |Global loss: 13.3878| Local H loss: 0.0365  | Global H loss: 0.0813 [0m
[94mEpoch: 2|  NKD Loss: 1.2501 | CT Loss: 4.2804| [0m
[91mEpoch: 2|  Loss:  5.6695 |Global loss: 10.0228| Local H loss: 0.0525  | Global H loss: 0.0772 [0m
[94mEpoch: 3|  NKD Loss: 1.4035 | CT Loss: 4.2879| [0m
[91mEpoch: 3|  Loss:  5.856 |Global loss: 7.4843| Local H loss: 0.0835  | Global H loss: 0.0697 [0m
------------------------- time cost ------------------------- 8.217253684997559
Chosen Clients:  [0, 3, 4]

-------------Round number: 65-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.894, 0.856, 0.911, 0.839, 0.778, 0.841, 0.871, 0.83, 1.0]
AUC in each clients:  [453.956, 479.439, 326.9, 422.984, 496.039, 455.285, 429.841, 481.0, 12.0]
F1 Score:  [0.892, 0.848, 0.892, 0.811, 0.635, 0.715, 0.732, 0.743, 1.0]
Recall Score:  [0.882, 0.844, 0.887, 0.799, 0.667, 0.745, 0.742, 0.741, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0016
Averaged Test Accurancy: 0.8498
Averaged Test AUC: 0.9476
Averaged Test F1_score: 0.8076
Averaged Test Recal score: 0.8119
Std Test Accurancy: 0.0589
Std Test AUC: 0.0184
Std Test F1: 0.0257
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.3763 | CT Loss: 3.2618| [0m
[91mEpoch: 0|  Loss:  5.1642 |Global loss: 7.0299| Local H loss: 0.0395  | Global H loss: 0.0371 [0m
[94mEpoch: 1|  NKD Loss: 1.011 | CT Loss: 3.1376| [0m
[91mEpoch: 1|  Loss:  4.6744 |Global loss: 6.2576| Local H loss: 0.0354  | Global H loss: 0.0326 [0m
[94mEpoch: 2|  NKD Loss: 0.9579 | CT Loss: 3.1171| [0m
[91mEpoch: 2|  Loss:  4.6103 |Global loss: 6.2145| Local H loss: 0.0348  | Global H loss: 0.0324 [0m
[94mEpoch: 3|  NKD Loss: 0.9207 | CT Loss: 3.1057| [0m
[91mEpoch: 3|  Loss:  4.5291 |Global loss: 6.127| Local H loss: 0.0379  | Global H loss: 0.0348 [0m
[94mEpoch: 0|  NKD Loss: 1.3676 | CT Loss: 3.4086| [0m
[91mEpoch: 0|  Loss:  5.2046 |Global loss: 7.0465| Local H loss: 0.0524  | Global H loss: 0.0437 [0m
[94mEpoch: 1|  NKD Loss: 0.7753 | CT Loss: 3.2149| [0m
[91mEpoch: 1|  Loss:  4.4135 |Global loss: 5.7805| Local H loss: 0.0472  | Global H loss: 0.0392 [0m
[94mEpoch: 2|  NKD Loss: 0.7178 | CT Loss: 3.1885| [0m
[91mEpoch: 2|  Loss:  4.2995 |Global loss: 5.715| Local H loss: 0.0472  | Global H loss: 0.0407 [0m
[94mEpoch: 3|  NKD Loss: 0.6998 | CT Loss: 3.1678| [0m
[91mEpoch: 3|  Loss:  4.2926 |Global loss: 5.622| Local H loss: 0.0477  | Global H loss: 0.0393 [0m
[94mEpoch: 0|  NKD Loss: 1.5739 | CT Loss: 3.3461| [0m
[91mEpoch: 0|  Loss:  5.6081 |Global loss: 7.6259| Local H loss: 0.0377  | Global H loss: 0.0362 [0m
[94mEpoch: 1|  NKD Loss: 1.1469 | CT Loss: 3.1049| [0m
[91mEpoch: 1|  Loss:  4.9358 |Global loss: 6.2789| Local H loss: 0.0332  | Global H loss: 0.0285 [0m
[94mEpoch: 2|  NKD Loss: 1.0199 | CT Loss: 3.0865| [0m
[91mEpoch: 2|  Loss:  4.7831 |Global loss: 6.1607| Local H loss: 0.031  | Global H loss: 0.0278 [0m
[94mEpoch: 3|  NKD Loss: 1.011 | CT Loss: 3.0868| [0m
[91mEpoch: 3|  Loss:  4.7712 |Global loss: 6.0792| Local H loss: 0.0319  | Global H loss: 0.0276 [0m
------------------------- time cost ------------------------- 11.986989259719849
Chosen Clients:  [6, 4, 2]

-------------Round number: 66-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.856, 0.911, 0.881, 0.825, 0.841, 0.871, 0.83, 1.0]
AUC in each clients:  [454.624, 479.439, 326.9, 425.572, 497.329, 455.285, 429.841, 481.0, 12.0]
F1 Score:  [0.879, 0.848, 0.892, 0.858, 0.703, 0.715, 0.732, 0.743, 1.0]
Recall Score:  [0.868, 0.844, 0.887, 0.849, 0.718, 0.745, 0.742, 0.741, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0306
Averaged Test Accurancy: 0.8599
Averaged Test AUC: 0.9489
Averaged Test F1_score: 0.8189
Averaged Test Recal score: 0.8216
Std Test Accurancy: 0.0505
Std Test AUC: 0.0179
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.2892 | CT Loss: 3.284| [0m
[91mEpoch: 0|  Loss:  5.0849 |Global loss: 7.1269| Local H loss: 0.0428  | Global H loss: 0.0398 [0m
[94mEpoch: 1|  NKD Loss: 0.7794 | CT Loss: 3.1242| [0m
[91mEpoch: 1|  Loss:  4.4237 |Global loss: 5.7869| Local H loss: 0.0383  | Global H loss: 0.0344 [0m
[94mEpoch: 2|  NKD Loss: 0.7556 | CT Loss: 3.108| [0m
[91mEpoch: 2|  Loss:  4.3832 |Global loss: 5.6711| Local H loss: 0.0401  | Global H loss: 0.0338 [0m
[94mEpoch: 3|  NKD Loss: 0.6975 | CT Loss: 3.0937| [0m
[91mEpoch: 3|  Loss:  4.3026 |Global loss: 5.598| Local H loss: 0.0401  | Global H loss: 0.0339 [0m
[94mEpoch: 0|  NKD Loss: 1.5997 | CT Loss: 3.2936| [0m
[91mEpoch: 0|  Loss:  5.538 |Global loss: 7.5142| Local H loss: 0.0415  | Global H loss: 0.0371 [0m
[94mEpoch: 1|  NKD Loss: 1.1442 | CT Loss: 3.0952| [0m
[91mEpoch: 1|  Loss:  4.8742 |Global loss: 6.2382| Local H loss: 0.0348  | Global H loss: 0.0296 [0m
[94mEpoch: 2|  NKD Loss: 1.0184 | CT Loss: 3.0808| [0m
[91mEpoch: 2|  Loss:  4.7364 |Global loss: 6.1176| Local H loss: 0.0338  | Global H loss: 0.0295 [0m
[94mEpoch: 3|  NKD Loss: 0.9451 | CT Loss: 3.0755| [0m
[91mEpoch: 3|  Loss:  4.6503 |Global loss: 5.9929| Local H loss: 0.033  | Global H loss: 0.0286 [0m
[94mEpoch: 0|  NKD Loss: 1.1512 | CT Loss: 3.3102| [0m
[91mEpoch: 0|  Loss:  4.7984 |Global loss: 6.523| Local H loss: 0.0534  | Global H loss: 0.0454 [0m
[94mEpoch: 1|  NKD Loss: 0.6615 | CT Loss: 3.1693| [0m
[91mEpoch: 1|  Loss:  4.1528 |Global loss: 5.4906| Local H loss: 0.0493  | Global H loss: 0.0417 [0m
[94mEpoch: 2|  NKD Loss: 0.6357 | CT Loss: 3.1569| [0m
[91mEpoch: 2|  Loss:  4.106 |Global loss: 5.4933| Local H loss: 0.0498  | Global H loss: 0.0433 [0m
[94mEpoch: 3|  NKD Loss: 0.597 | CT Loss: 3.1473| [0m
[91mEpoch: 3|  Loss:  4.0652 |Global loss: 5.3609| Local H loss: 0.0514  | Global H loss: 0.042 [0m
------------------------- time cost ------------------------- 11.156243085861206
Chosen Clients:  [3, 2, 6]

-------------Round number: 67-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.856, 0.89, 0.881, 0.816, 0.841, 0.889, 0.83, 1.0]
AUC in each clients:  [454.624, 479.439, 327.549, 425.572, 500.849, 455.285, 430.186, 481.0, 12.0]
F1 Score:  [0.879, 0.848, 0.875, 0.858, 0.689, 0.715, 0.765, 0.743, 1.0]
Recall Score:  [0.868, 0.844, 0.861, 0.849, 0.706, 0.745, 0.767, 0.741, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9746
Averaged Test Accurancy: 0.8588
Averaged Test AUC: 0.9501
Averaged Test F1_score: 0.8191
Averaged Test Recal score: 0.8201
Std Test Accurancy: 0.0507
Std Test AUC: 0.0178
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.3438 | CT Loss: 3.3411| [0m
[91mEpoch: 0|  Loss:  5.0821 |Global loss: 6.8063| Local H loss: 0.0546  | Global H loss: 0.0454 [0m
[94mEpoch: 1|  NKD Loss: 0.7942 | CT Loss: 3.1823| [0m
[91mEpoch: 1|  Loss:  4.3829 |Global loss: 5.7601| Local H loss: 0.047  | Global H loss: 0.0397 [0m
[94mEpoch: 2|  NKD Loss: 0.7236 | CT Loss: 3.1579| [0m
[91mEpoch: 2|  Loss:  4.2633 |Global loss: 5.6707| Local H loss: 0.0495  | Global H loss: 0.042 [0m
[94mEpoch: 3|  NKD Loss: 0.6937 | CT Loss: 3.1448| [0m
[91mEpoch: 3|  Loss:  4.2406 |Global loss: 5.5802| Local H loss: 0.0496  | Global H loss: 0.0412 [0m
[94mEpoch: 0|  NKD Loss: 1.1795 | CT Loss: 3.3238| [0m
[91mEpoch: 0|  Loss:  4.826 |Global loss: 6.4802| Local H loss: 0.0609  | Global H loss: 0.049 [0m
[94mEpoch: 1|  NKD Loss: 0.6395 | CT Loss: 3.1681| [0m
[91mEpoch: 1|  Loss:  4.1273 |Global loss: 5.5477| Local H loss: 0.0483  | Global H loss: 0.0425 [0m
[94mEpoch: 2|  NKD Loss: 0.6135 | CT Loss: 3.1493| [0m
[91mEpoch: 2|  Loss:  4.0587 |Global loss: 5.3735| Local H loss: 0.0532  | Global H loss: 0.0436 [0m
[94mEpoch: 3|  NKD Loss: 0.5994 | CT Loss: 3.1478| [0m
[91mEpoch: 3|  Loss:  4.0466 |Global loss: 5.3719| Local H loss: 0.0535  | Global H loss: 0.0447 [0m
[94mEpoch: 0|  NKD Loss: 1.179 | CT Loss: 3.2498| [0m
[91mEpoch: 0|  Loss:  4.9105 |Global loss: 6.5155| Local H loss: 0.0471  | Global H loss: 0.0406 [0m
[94mEpoch: 1|  NKD Loss: 0.758 | CT Loss: 3.1053| [0m
[91mEpoch: 1|  Loss:  4.3359 |Global loss: 5.7142| Local H loss: 0.0411  | Global H loss: 0.0361 [0m
[94mEpoch: 2|  NKD Loss: 0.7111 | CT Loss: 3.0788| [0m
[91mEpoch: 2|  Loss:  4.265 |Global loss: 5.6183| Local H loss: 0.0418  | Global H loss: 0.0357 [0m
[94mEpoch: 3|  NKD Loss: 0.6977 | CT Loss: 3.0761| [0m
[91mEpoch: 3|  Loss:  4.2308 |Global loss: 5.5825| Local H loss: 0.0447  | Global H loss: 0.0375 [0m
------------------------- time cost ------------------------- 10.91791844367981
Chosen Clients:  [1, 8, 7]

-------------Round number: 68-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.856, 0.89, 0.89, 0.816, 0.841, 0.896, 0.83, 1.0]
AUC in each clients:  [454.624, 479.439, 327.4, 426.851, 500.849, 455.285, 430.573, 481.0, 12.0]
F1 Score:  [0.879, 0.848, 0.872, 0.869, 0.689, 0.715, 0.782, 0.743, 1.0]
Recall Score:  [0.868, 0.844, 0.859, 0.861, 0.706, 0.745, 0.776, 0.741, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9439
Averaged Test Accurancy: 0.8607
Averaged Test AUC: 0.9505
Averaged Test F1_score: 0.8219
Averaged Test Recal score: 0.8222
Std Test Accurancy: 0.0511
Std Test AUC: 0.0177
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.2867 | CT Loss: 3.2827| [0m
[91mEpoch: 0|  Loss:  5.0481 |Global loss: 6.9952| Local H loss: 0.0424  | Global H loss: 0.0419 [0m
[94mEpoch: 1|  NKD Loss: 0.8438 | CT Loss: 3.1379| [0m
[91mEpoch: 1|  Loss:  4.4618 |Global loss: 6.0149| Local H loss: 0.0364  | Global H loss: 0.0357 [0m
[94mEpoch: 2|  NKD Loss: 0.7677 | CT Loss: 3.1047| [0m
[91mEpoch: 2|  Loss:  4.3329 |Global loss: 5.878| Local H loss: 0.0368  | Global H loss: 0.0366 [0m
[94mEpoch: 3|  NKD Loss: 0.7428 | CT Loss: 3.0935| [0m
[91mEpoch: 3|  Loss:  4.2979 |Global loss: 5.7945| Local H loss: 0.0376  | Global H loss: 0.0364 [0m
[94mEpoch: 0|  NKD Loss: 2.6352 | CT Loss: 5.2474| [0m
[91mEpoch: 0|  Loss:  8.0029 |Global loss: 15.9058| Local H loss: 0.0432  | Global H loss: 0.0773 [0m
[94mEpoch: 1|  NKD Loss: 1.8011 | CT Loss: 4.3025| [0m
[91mEpoch: 1|  Loss:  6.2171 |Global loss: 16.3807| Local H loss: 0.031  | Global H loss: 0.0819 [0m
[94mEpoch: 2|  NKD Loss: 1.094 | CT Loss: 4.284| [0m
[91mEpoch: 2|  Loss:  5.4983 |Global loss: 11.7009| Local H loss: 0.0397  | Global H loss: 0.0792 [0m
[94mEpoch: 3|  NKD Loss: 1.5756 | CT Loss: 4.2894| [0m
[91mEpoch: 3|  Loss:  6.0141 |Global loss: 8.0207| Local H loss: 0.0774  | Global H loss: 0.0723 [0m
[94mEpoch: 0|  NKD Loss: 1.4769 | CT Loss: 3.5167| [0m
[91mEpoch: 0|  Loss:  5.5912 |Global loss: 7.8287| Local H loss: 0.0416  | Global H loss: 0.0418 [0m
[94mEpoch: 1|  NKD Loss: 1.0529 | CT Loss: 3.1837| [0m
[91mEpoch: 1|  Loss:  4.8086 |Global loss: 6.4366| Local H loss: 0.0397  | Global H loss: 0.0349 [0m
[94mEpoch: 2|  NKD Loss: 1.0126 | CT Loss: 3.147| [0m
[91mEpoch: 2|  Loss:  4.7316 |Global loss: 6.2629| Local H loss: 0.0381  | Global H loss: 0.0328 [0m
[94mEpoch: 3|  NKD Loss: 0.9841 | CT Loss: 3.1337| [0m
[91mEpoch: 3|  Loss:  4.6867 |Global loss: 6.1318| Local H loss: 0.0376  | Global H loss: 0.0323 [0m
------------------------- time cost ------------------------- 9.919362306594849
Chosen Clients:  [4, 8, 1]

-------------Round number: 69-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.858, 0.89, 0.89, 0.816, 0.841, 0.896, 0.852, 1.0]
AUC in each clients:  [454.624, 481.912, 327.4, 426.851, 500.849, 455.285, 430.573, 480.214, 12.0]
F1 Score:  [0.879, 0.848, 0.872, 0.869, 0.689, 0.715, 0.782, 0.787, 1.0]
Recall Score:  [0.868, 0.844, 0.859, 0.861, 0.706, 0.745, 0.776, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9056
Averaged Test Accurancy: 0.8639
Averaged Test AUC: 0.9509
Averaged Test F1_score: 0.8268
Averaged Test Recal score: 0.8260
Std Test Accurancy: 0.0492
Std Test AUC: 0.0174
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.5289 | CT Loss: 3.2378| [0m
[91mEpoch: 0|  Loss:  5.3992 |Global loss: 7.1077| Local H loss: 0.0422  | Global H loss: 0.0357 [0m
[94mEpoch: 1|  NKD Loss: 1.1014 | CT Loss: 3.0702| [0m
[91mEpoch: 1|  Loss:  4.7878 |Global loss: 6.1933| Local H loss: 0.036  | Global H loss: 0.0308 [0m
[94mEpoch: 2|  NKD Loss: 0.9752 | CT Loss: 3.0638| [0m
[91mEpoch: 2|  Loss:  4.6576 |Global loss: 6.0419| Local H loss: 0.0352  | Global H loss: 0.0298 [0m
[94mEpoch: 3|  NKD Loss: 0.9382 | CT Loss: 3.0646| [0m
[91mEpoch: 3|  Loss:  4.6139 |Global loss: 6.0163| Local H loss: 0.0356  | Global H loss: 0.03 [0m
[94mEpoch: 0|  NKD Loss: 2.5058 | CT Loss: 5.7476| [0m
[91mEpoch: 0|  Loss:  8.3576 |Global loss: 18.9065| Local H loss: 0.0341  | Global H loss: 0.0787 [0m
[94mEpoch: 1|  NKD Loss: 2.0586 | CT Loss: 5.9025| [0m
[91mEpoch: 1|  Loss:  8.057 |Global loss: 23.7978| Local H loss: 0.0212  | Global H loss: 0.0791 [0m
[94mEpoch: 2|  NKD Loss: 1.8574 | CT Loss: 5.8665| [0m
[91mEpoch: 2|  Loss:  7.8219 |Global loss: 20.323| Local H loss: 0.0247  | Global H loss: 0.0783 [0m
[94mEpoch: 3|  NKD Loss: 1.7209 | CT Loss: 5.8137| [0m
[91mEpoch: 3|  Loss:  7.6365 |Global loss: 17.2553| Local H loss: 0.0302  | Global H loss: 0.0775 [0m
[94mEpoch: 0|  NKD Loss: 1.2692 | CT Loss: 3.253| [0m
[91mEpoch: 0|  Loss:  4.9693 |Global loss: 6.8966| Local H loss: 0.0439  | Global H loss: 0.0427 [0m
[94mEpoch: 1|  NKD Loss: 0.8205 | CT Loss: 3.1198| [0m
[91mEpoch: 1|  Loss:  4.3926 |Global loss: 5.9742| Local H loss: 0.0389  | Global H loss: 0.0374 [0m
[94mEpoch: 2|  NKD Loss: 0.738 | CT Loss: 3.0891| [0m
[91mEpoch: 2|  Loss:  4.253 |Global loss: 5.8128| Local H loss: 0.0396  | Global H loss: 0.0382 [0m
[94mEpoch: 3|  NKD Loss: 0.7186 | CT Loss: 3.0861| [0m
[91mEpoch: 3|  Loss:  4.2332 |Global loss: 5.7809| Local H loss: 0.0397  | Global H loss: 0.0385 [0m
------------------------- time cost ------------------------- 9.717859506607056
Chosen Clients:  [4, 5, 8]

-------------Round number: 70-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.862, 0.89, 0.89, 0.841, 0.841, 0.896, 0.852, 1.0]
AUC in each clients:  [454.624, 481.231, 327.4, 426.851, 501.24, 455.285, 430.573, 480.214, 12.0]
F1 Score:  [0.879, 0.855, 0.872, 0.869, 0.725, 0.715, 0.782, 0.787, 1.0]
Recall Score:  [0.868, 0.852, 0.859, 0.861, 0.735, 0.745, 0.776, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 12.9649
Averaged Test Accurancy: 0.8679
Averaged Test AUC: 0.9508
Averaged Test F1_score: 0.8316
Averaged Test Recal score: 0.8301
Std Test Accurancy: 0.0459
Std Test AUC: 0.0175
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.5206 | CT Loss: 3.2406| [0m
[91mEpoch: 0|  Loss:  5.3528 |Global loss: 7.2075| Local H loss: 0.0441  | Global H loss: 0.0373 [0m
[94mEpoch: 1|  NKD Loss: 1.1035 | CT Loss: 3.0616| [0m
[91mEpoch: 1|  Loss:  4.755 |Global loss: 6.1612| Local H loss: 0.0372  | Global H loss: 0.0317 [0m
[94mEpoch: 2|  NKD Loss: 0.9793 | CT Loss: 3.0643| [0m
[91mEpoch: 2|  Loss:  4.6132 |Global loss: 5.9951| Local H loss: 0.037  | Global H loss: 0.0307 [0m
[94mEpoch: 3|  NKD Loss: 0.9177 | CT Loss: 3.0557| [0m
[91mEpoch: 3|  Loss:  4.5609 |Global loss: 5.9821| Local H loss: 0.0354  | Global H loss: 0.0303 [0m
[94mEpoch: 0|  NKD Loss: 1.4013 | CT Loss: 3.3671| [0m
[91mEpoch: 0|  Loss:  5.3988 |Global loss: 7.004| Local H loss: 0.0392  | Global H loss: 0.0344 [0m
[94mEpoch: 1|  NKD Loss: 1.0399 | CT Loss: 3.1986| [0m
[91mEpoch: 1|  Loss:  4.8558 |Global loss: 6.347| Local H loss: 0.0301  | Global H loss: 0.0293 [0m
[94mEpoch: 2|  NKD Loss: 0.988 | CT Loss: 3.1815| [0m
[91mEpoch: 2|  Loss:  4.7766 |Global loss: 6.1504| Local H loss: 0.029  | Global H loss: 0.0288 [0m
[94mEpoch: 3|  NKD Loss: 0.934 | CT Loss: 3.1889| [0m
[91mEpoch: 3|  Loss:  4.7196 |Global loss: 6.1223| Local H loss: 0.0311  | Global H loss: 0.0303 [0m
[94mEpoch: 0|  NKD Loss: 1.8126 | CT Loss: 5.2993| [0m
[91mEpoch: 0|  Loss:  7.2147 |Global loss: 15.5181| Local H loss: 0.0331  | Global H loss: 0.076 [0m
[94mEpoch: 1|  NKD Loss: 2.1572 | CT Loss: 4.339| [0m
[91mEpoch: 1|  Loss:  6.6228 |Global loss: 12.2852| Local H loss: 0.0567  | Global H loss: 0.0857 [0m
[94mEpoch: 2|  NKD Loss: 1.8427 | CT Loss: 4.3239| [0m
[91mEpoch: 2|  Loss:  6.3239 |Global loss: 8.9603| Local H loss: 0.0873  | Global H loss: 0.082 [0m
[94mEpoch: 3|  NKD Loss: 1.7468 | CT Loss: 4.3125| [0m
[91mEpoch: 3|  Loss:  6.231 |Global loss: 6.7574| Local H loss: 0.1052  | Global H loss: 0.0796 [0m
------------------------- time cost ------------------------- 9.526996374130249
Chosen Clients:  [0, 6, 4]

-------------Round number: 71-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.882, 0.862, 0.89, 0.89, 0.848, 0.843, 0.896, 0.852, 1.0]
AUC in each clients:  [454.624, 481.231, 327.4, 426.851, 504.002, 456.524, 430.573, 480.214, 12.0]
F1 Score:  [0.879, 0.855, 0.872, 0.869, 0.772, 0.72, 0.782, 0.787, 1.0]
Recall Score:  [0.868, 0.852, 0.859, 0.861, 0.765, 0.748, 0.776, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0408
Averaged Test Accurancy: 0.8692
Averaged Test AUC: 0.9519
Averaged Test F1_score: 0.8373
Averaged Test Recal score: 0.8338
Std Test Accurancy: 0.0449
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.384 | CT Loss: 3.2213| [0m
[91mEpoch: 0|  Loss:  5.1089 |Global loss: 6.817| Local H loss: 0.0427  | Global H loss: 0.0364 [0m
[94mEpoch: 1|  NKD Loss: 0.9579 | CT Loss: 3.0959| [0m
[91mEpoch: 1|  Loss:  4.5529 |Global loss: 6.1752| Local H loss: 0.0377  | Global H loss: 0.0349 [0m
[94mEpoch: 2|  NKD Loss: 0.9086 | CT Loss: 3.0848| [0m
[91mEpoch: 2|  Loss:  4.4736 |Global loss: 6.1277| Local H loss: 0.038  | Global H loss: 0.0356 [0m
[94mEpoch: 3|  NKD Loss: 0.8886 | CT Loss: 3.0783| [0m
[91mEpoch: 3|  Loss:  4.4623 |Global loss: 6.0702| Local H loss: 0.0388  | Global H loss: 0.0359 [0m
[94mEpoch: 0|  NKD Loss: 1.2404 | CT Loss: 3.2228| [0m
[91mEpoch: 0|  Loss:  4.925 |Global loss: 6.4905| Local H loss: 0.0501  | Global H loss: 0.0406 [0m
[94mEpoch: 1|  NKD Loss: 0.7053 | CT Loss: 3.0989| [0m
[91mEpoch: 1|  Loss:  4.27 |Global loss: 5.5798| Local H loss: 0.044  | Global H loss: 0.0357 [0m
[94mEpoch: 2|  NKD Loss: 0.6148 | CT Loss: 3.0698| [0m
[91mEpoch: 2|  Loss:  4.1394 |Global loss: 5.4562| Local H loss: 0.0437  | Global H loss: 0.0354 [0m
[94mEpoch: 3|  NKD Loss: 0.6241 | CT Loss: 3.06| [0m
[91mEpoch: 3|  Loss:  4.1274 |Global loss: 5.4421| Local H loss: 0.0444  | Global H loss: 0.0363 [0m
[94mEpoch: 0|  NKD Loss: 1.5702 | CT Loss: 3.256| [0m
[91mEpoch: 0|  Loss:  5.3947 |Global loss: 7.0428| Local H loss: 0.0477  | Global H loss: 0.038 [0m
[94mEpoch: 1|  NKD Loss: 1.0534 | CT Loss: 3.0758| [0m
[91mEpoch: 1|  Loss:  4.6817 |Global loss: 6.1482| Local H loss: 0.0395  | Global H loss: 0.0329 [0m
[94mEpoch: 2|  NKD Loss: 0.9207 | CT Loss: 3.0565| [0m
[91mEpoch: 2|  Loss:  4.531 |Global loss: 5.9635| Local H loss: 0.0378  | Global H loss: 0.0317 [0m
[94mEpoch: 3|  NKD Loss: 0.8896 | CT Loss: 3.0501| [0m
[91mEpoch: 3|  Loss:  4.4764 |Global loss: 5.9007| Local H loss: 0.0376  | Global H loss: 0.0324 [0m
------------------------- time cost ------------------------- 12.017277240753174
Chosen Clients:  [4, 8, 2]

-------------Round number: 72-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.862, 0.89, 0.89, 0.835, 0.843, 0.913, 0.852, 1.0]
AUC in each clients:  [454.909, 481.231, 327.4, 426.851, 504.211, 456.524, 431.966, 480.214, 12.0]
F1 Score:  [0.88, 0.855, 0.872, 0.869, 0.767, 0.72, 0.816, 0.787, 1.0]
Recall Score:  [0.87, 0.852, 0.859, 0.861, 0.755, 0.748, 0.807, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.0409
Averaged Test Accurancy: 0.8697
Averaged Test AUC: 0.9524
Averaged Test F1_score: 0.8407
Averaged Test Recal score: 0.8363
Std Test Accurancy: 0.0471
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.4994 | CT Loss: 3.2077| [0m
[91mEpoch: 0|  Loss:  5.2722 |Global loss: 6.9612| Local H loss: 0.0465  | Global H loss: 0.0379 [0m
[94mEpoch: 1|  NKD Loss: 1.0614 | CT Loss: 3.0714| [0m
[91mEpoch: 1|  Loss:  4.6705 |Global loss: 6.1292| Local H loss: 0.0404  | Global H loss: 0.0335 [0m
[94mEpoch: 2|  NKD Loss: 0.9138 | CT Loss: 3.049| [0m
[91mEpoch: 2|  Loss:  4.4887 |Global loss: 5.9581| Local H loss: 0.039  | Global H loss: 0.0327 [0m
[94mEpoch: 3|  NKD Loss: 0.871 | CT Loss: 3.0499| [0m
[91mEpoch: 3|  Loss:  4.4277 |Global loss: 5.8656| Local H loss: 0.0389  | Global H loss: 0.033 [0m
[94mEpoch: 0|  NKD Loss: 2.163 | CT Loss: 5.053| [0m
[91mEpoch: 0|  Loss:  7.3177 |Global loss: 14.421| Local H loss: 0.0427  | Global H loss: 0.0769 [0m
[94mEpoch: 1|  NKD Loss: 2.4457 | CT Loss: 4.3364| [0m
[91mEpoch: 1|  Loss:  6.8947 |Global loss: 14.6038| Local H loss: 0.0491  | Global H loss: 0.0862 [0m
[94mEpoch: 2|  NKD Loss: 1.7006 | CT Loss: 4.3008| [0m
[91mEpoch: 2|  Loss:  6.1405 |Global loss: 10.0054| Local H loss: 0.0669  | Global H loss: 0.0843 [0m
[94mEpoch: 3|  NKD Loss: 1.5192 | CT Loss: 4.2864| [0m
[91mEpoch: 3|  Loss:  5.9779 |Global loss: 7.0652| Local H loss: 0.108  | Global H loss: 0.0804 [0m
[94mEpoch: 0|  NKD Loss: 1.1922 | CT Loss: 3.2975| [0m
[91mEpoch: 0|  Loss:  4.8033 |Global loss: 6.4593| Local H loss: 0.0638  | Global H loss: 0.0494 [0m
[94mEpoch: 1|  NKD Loss: 0.677 | CT Loss: 3.1609| [0m
[91mEpoch: 1|  Loss:  4.136 |Global loss: 5.5144| Local H loss: 0.0539  | Global H loss: 0.0452 [0m
[94mEpoch: 2|  NKD Loss: 0.6383 | CT Loss: 3.1441| [0m
[91mEpoch: 2|  Loss:  4.0808 |Global loss: 5.4353| Local H loss: 0.0545  | Global H loss: 0.0449 [0m
[94mEpoch: 3|  NKD Loss: 0.6302 | CT Loss: 3.1314| [0m
[91mEpoch: 3|  Loss:  4.0563 |Global loss: 5.3707| Local H loss: 0.0558  | Global H loss: 0.0447 [0m
------------------------- time cost ------------------------- 9.150688409805298
Chosen Clients:  [2, 6, 8]

-------------Round number: 73-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.862, 0.911, 0.89, 0.846, 0.843, 0.913, 0.852, 1.0]
AUC in each clients:  [454.909, 481.231, 327.628, 426.851, 503.766, 456.524, 431.966, 480.214, 12.0]
F1 Score:  [0.88, 0.855, 0.89, 0.869, 0.774, 0.72, 0.816, 0.787, 1.0]
Recall Score:  [0.87, 0.852, 0.881, 0.861, 0.768, 0.748, 0.807, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1204
Averaged Test Accurancy: 0.8732
Averaged Test AUC: 0.9523
Averaged Test F1_score: 0.8434
Averaged Test Recal score: 0.8402
Std Test Accurancy: 0.0465
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.0966 | CT Loss: 3.2812| [0m
[91mEpoch: 0|  Loss:  4.6749 |Global loss: 6.2963| Local H loss: 0.0624  | Global H loss: 0.0494 [0m
[94mEpoch: 1|  NKD Loss: 0.6782 | CT Loss: 3.1562| [0m
[91mEpoch: 1|  Loss:  4.0999 |Global loss: 5.5283| Local H loss: 0.0569  | Global H loss: 0.0485 [0m
[94mEpoch: 2|  NKD Loss: 0.6087 | CT Loss: 3.128| [0m
[91mEpoch: 2|  Loss:  4.0136 |Global loss: 5.3668| Local H loss: 0.0557  | Global H loss: 0.0464 [0m
[94mEpoch: 3|  NKD Loss: 0.5582 | CT Loss: 3.1269| [0m
[91mEpoch: 3|  Loss:  3.956 |Global loss: 5.2805| Local H loss: 0.0565  | Global H loss: 0.0465 [0m
[94mEpoch: 0|  NKD Loss: 1.1887 | CT Loss: 3.21| [0m
[91mEpoch: 0|  Loss:  4.8547 |Global loss: 6.4515| Local H loss: 0.0488  | Global H loss: 0.0409 [0m
[94mEpoch: 1|  NKD Loss: 0.6857 | CT Loss: 3.0771| [0m
[91mEpoch: 1|  Loss:  4.206 |Global loss: 5.5758| Local H loss: 0.0464  | Global H loss: 0.0381 [0m
[94mEpoch: 2|  NKD Loss: 0.6347 | CT Loss: 3.061| [0m
[91mEpoch: 2|  Loss:  4.1384 |Global loss: 5.5001| Local H loss: 0.0435  | Global H loss: 0.0365 [0m
[94mEpoch: 3|  NKD Loss: 0.6086 | CT Loss: 3.0558| [0m
[91mEpoch: 3|  Loss:  4.0812 |Global loss: 5.4385| Local H loss: 0.0467  | Global H loss: 0.039 [0m
[94mEpoch: 0|  NKD Loss: 2.2466 | CT Loss: 5.0594| [0m
[91mEpoch: 0|  Loss:  7.4039 |Global loss: 15.1559| Local H loss: 0.0417  | Global H loss: 0.0778 [0m
[94mEpoch: 1|  NKD Loss: 2.0012 | CT Loss: 4.3096| [0m
[91mEpoch: 1|  Loss:  6.4244 |Global loss: 12.4929| Local H loss: 0.0533  | Global H loss: 0.0839 [0m
[94mEpoch: 2|  NKD Loss: 1.5463 | CT Loss: 4.2804| [0m
[91mEpoch: 2|  Loss:  5.9697 |Global loss: 8.7686| Local H loss: 0.0816  | Global H loss: 0.0807 [0m
[94mEpoch: 3|  NKD Loss: 1.3259 | CT Loss: 4.2783| [0m
[91mEpoch: 3|  Loss:  5.77 |Global loss: 6.2912| Local H loss: 0.1107  | Global H loss: 0.0795 [0m
------------------------- time cost ------------------------- 8.269273281097412
Chosen Clients:  [2, 1, 5]

-------------Round number: 74-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.862, 0.914, 0.89, 0.846, 0.843, 0.92, 0.852, 1.0]
AUC in each clients:  [454.909, 481.231, 328.03, 426.851, 503.766, 456.524, 432.548, 480.214, 12.0]
F1 Score:  [0.88, 0.855, 0.895, 0.869, 0.774, 0.72, 0.824, 0.787, 1.0]
Recall Score:  [0.87, 0.852, 0.887, 0.861, 0.768, 0.748, 0.817, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1609
Averaged Test Accurancy: 0.8743
Averaged Test AUC: 0.9526
Averaged Test F1_score: 0.8449
Averaged Test Recal score: 0.8420
Std Test Accurancy: 0.0471
Std Test AUC: 0.0173
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.1617 | CT Loss: 3.2861| [0m
[91mEpoch: 0|  Loss:  4.7341 |Global loss: 6.368| Local H loss: 0.0646  | Global H loss: 0.0511 [0m
[94mEpoch: 1|  NKD Loss: 0.6624 | CT Loss: 3.1427| [0m
[91mEpoch: 1|  Loss:  4.0853 |Global loss: 5.4744| Local H loss: 0.0553  | Global H loss: 0.0458 [0m
[94mEpoch: 2|  NKD Loss: 0.5918 | CT Loss: 3.1252| [0m
[91mEpoch: 2|  Loss:  3.9843 |Global loss: 5.3019| Local H loss: 0.0581  | Global H loss: 0.0466 [0m
[94mEpoch: 3|  NKD Loss: 0.5687 | CT Loss: 3.1063| [0m
[91mEpoch: 3|  Loss:  3.9575 |Global loss: 5.2661| Local H loss: 0.0549  | Global H loss: 0.0447 [0m
[94mEpoch: 0|  NKD Loss: 1.2472 | CT Loss: 3.2959| [0m
[91mEpoch: 0|  Loss:  4.9618 |Global loss: 6.8795| Local H loss: 0.0458  | Global H loss: 0.0436 [0m
[94mEpoch: 1|  NKD Loss: 0.7876 | CT Loss: 3.0981| [0m
[91mEpoch: 1|  Loss:  4.2938 |Global loss: 5.9151| Local H loss: 0.0412  | Global H loss: 0.0401 [0m
[94mEpoch: 2|  NKD Loss: 0.7369 | CT Loss: 3.0827| [0m
[91mEpoch: 2|  Loss:  4.2311 |Global loss: 5.8119| Local H loss: 0.0409  | Global H loss: 0.0396 [0m
[94mEpoch: 3|  NKD Loss: 0.7226 | CT Loss: 3.0661| [0m
[91mEpoch: 3|  Loss:  4.1987 |Global loss: 5.7431| Local H loss: 0.042  | Global H loss: 0.04 [0m
[94mEpoch: 0|  NKD Loss: 1.3141 | CT Loss: 3.3474| [0m
[91mEpoch: 0|  Loss:  5.2843 |Global loss: 7.1299| Local H loss: 0.0377  | Global H loss: 0.0344 [0m
[94mEpoch: 1|  NKD Loss: 0.99 | CT Loss: 3.1913| [0m
[91mEpoch: 1|  Loss:  4.7699 |Global loss: 6.2444| Local H loss: 0.0313  | Global H loss: 0.0302 [0m
[94mEpoch: 2|  NKD Loss: 0.8898 | CT Loss: 3.1825| [0m
[91mEpoch: 2|  Loss:  4.665 |Global loss: 6.1155| Local H loss: 0.03  | Global H loss: 0.0299 [0m
[94mEpoch: 3|  NKD Loss: 0.8435 | CT Loss: 3.1776| [0m
[91mEpoch: 3|  Loss:  4.5972 |Global loss: 6.0528| Local H loss: 0.0302  | Global H loss: 0.0304 [0m
------------------------- time cost ------------------------- 11.460631608963013
Chosen Clients:  [8, 3, 2]

-------------Round number: 75-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.876, 0.92, 0.89, 0.846, 0.855, 0.92, 0.852, 1.0]
AUC in each clients:  [454.909, 482.001, 328.339, 426.851, 503.766, 458.356, 432.548, 480.214, 12.0]
F1 Score:  [0.88, 0.867, 0.898, 0.869, 0.774, 0.748, 0.824, 0.787, 1.0]
Recall Score:  [0.87, 0.866, 0.892, 0.861, 0.768, 0.765, 0.817, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.2020
Averaged Test Accurancy: 0.8783
Averaged Test AUC: 0.9534
Averaged Test F1_score: 0.8497
Averaged Test Recal score: 0.8460
Std Test Accurancy: 0.0454
Std Test AUC: 0.0169
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 2.331 | CT Loss: 5.3935| [0m
[91mEpoch: 0|  Loss:  7.8106 |Global loss: 16.9978| Local H loss: 0.0398  | Global H loss: 0.0795 [0m
[94mEpoch: 1|  NKD Loss: 1.8297 | CT Loss: 4.2896| [0m
[91mEpoch: 1|  Loss:  6.2259 |Global loss: 12.0149| Local H loss: 0.0546  | Global H loss: 0.0815 [0m
[94mEpoch: 2|  NKD Loss: 1.4624 | CT Loss: 4.2747| [0m
[91mEpoch: 2|  Loss:  5.876 |Global loss: 8.4051| Local H loss: 0.0878  | Global H loss: 0.079 [0m
[94mEpoch: 3|  NKD Loss: 1.2622 | CT Loss: 4.2741| [0m
[91mEpoch: 3|  Loss:  5.693 |Global loss: 6.1194| Local H loss: 0.11  | Global H loss: 0.076 [0m
[94mEpoch: 0|  NKD Loss: 1.3063 | CT Loss: 3.3404| [0m
[91mEpoch: 0|  Loss:  5.0496 |Global loss: 6.9384| Local H loss: 0.0557  | Global H loss: 0.0458 [0m
[94mEpoch: 1|  NKD Loss: 0.7711 | CT Loss: 3.1561| [0m
[91mEpoch: 1|  Loss:  4.3283 |Global loss: 5.7267| Local H loss: 0.0478  | Global H loss: 0.0408 [0m
[94mEpoch: 2|  NKD Loss: 0.6887 | CT Loss: 3.1267| [0m
[91mEpoch: 2|  Loss:  4.1888 |Global loss: 5.5849| Local H loss: 0.051  | Global H loss: 0.0429 [0m
[94mEpoch: 3|  NKD Loss: 0.6648 | CT Loss: 3.1302| [0m
[91mEpoch: 3|  Loss:  4.1893 |Global loss: 5.57| Local H loss: 0.0498  | Global H loss: 0.0418 [0m
[94mEpoch: 0|  NKD Loss: 1.1316 | CT Loss: 3.2858| [0m
[91mEpoch: 0|  Loss:  4.7071 |Global loss: 6.302| Local H loss: 0.0697  | Global H loss: 0.0508 [0m
[94mEpoch: 1|  NKD Loss: 0.6448 | CT Loss: 3.1291| [0m
[91mEpoch: 1|  Loss:  4.0452 |Global loss: 5.437| Local H loss: 0.0573  | Global H loss: 0.0475 [0m
[94mEpoch: 2|  NKD Loss: 0.5857 | CT Loss: 3.1188| [0m
[91mEpoch: 2|  Loss:  3.9861 |Global loss: 5.2788| Local H loss: 0.0576  | Global H loss: 0.0452 [0m
[94mEpoch: 3|  NKD Loss: 0.5726 | CT Loss: 3.1078| [0m
[91mEpoch: 3|  Loss:  3.9466 |Global loss: 5.2563| Local H loss: 0.0595  | Global H loss: 0.0467 [0m
------------------------- time cost ------------------------- 8.382752656936646
Chosen Clients:  [4, 2, 6]

-------------Round number: 76-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.876, 0.926, 0.911, 0.846, 0.855, 0.92, 0.852, 1.0]
AUC in each clients:  [454.909, 482.001, 329.077, 427.746, 503.766, 458.356, 432.548, 480.214, 12.0]
F1 Score:  [0.88, 0.867, 0.906, 0.903, 0.774, 0.748, 0.824, 0.787, 1.0]
Recall Score:  [0.87, 0.866, 0.901, 0.896, 0.768, 0.765, 0.817, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1212
Averaged Test Accurancy: 0.8812
Averaged Test AUC: 0.9538
Averaged Test F1_score: 0.8543
Averaged Test Recal score: 0.8509
Std Test Accurancy: 0.0461
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.5089 | CT Loss: 3.242| [0m
[91mEpoch: 0|  Loss:  5.2784 |Global loss: 7.1723| Local H loss: 0.0501  | Global H loss: 0.0416 [0m
[94mEpoch: 1|  NKD Loss: 1.0144 | CT Loss: 3.0506| [0m
[91mEpoch: 1|  Loss:  4.556 |Global loss: 6.0856| Local H loss: 0.0445  | Global H loss: 0.0359 [0m
[94mEpoch: 2|  NKD Loss: 0.9097 | CT Loss: 3.0372| [0m
[91mEpoch: 2|  Loss:  4.4481 |Global loss: 5.9385| Local H loss: 0.0409  | Global H loss: 0.0338 [0m
[94mEpoch: 3|  NKD Loss: 0.864 | CT Loss: 3.0324| [0m
[91mEpoch: 3|  Loss:  4.386 |Global loss: 5.8546| Local H loss: 0.0395  | Global H loss: 0.0337 [0m
[94mEpoch: 0|  NKD Loss: 1.1295 | CT Loss: 3.284| [0m
[91mEpoch: 0|  Loss:  4.6992 |Global loss: 6.4415| Local H loss: 0.0678  | Global H loss: 0.0511 [0m
[94mEpoch: 1|  NKD Loss: 0.6506 | CT Loss: 3.1253| [0m
[91mEpoch: 1|  Loss:  4.0448 |Global loss: 5.4022| Local H loss: 0.058  | Global H loss: 0.0474 [0m
[94mEpoch: 2|  NKD Loss: 0.5763 | CT Loss: 3.1064| [0m
[91mEpoch: 2|  Loss:  3.9515 |Global loss: 5.2774| Local H loss: 0.0585  | Global H loss: 0.0463 [0m
[94mEpoch: 3|  NKD Loss: 0.5597 | CT Loss: 3.1074| [0m
[91mEpoch: 3|  Loss:  3.9367 |Global loss: 5.2855| Local H loss: 0.0586  | Global H loss: 0.0474 [0m
[94mEpoch: 0|  NKD Loss: 1.1016 | CT Loss: 3.2218| [0m
[91mEpoch: 0|  Loss:  4.745 |Global loss: 6.47| Local H loss: 0.0504  | Global H loss: 0.0439 [0m
[94mEpoch: 1|  NKD Loss: 0.6593 | CT Loss: 3.0772| [0m
[91mEpoch: 1|  Loss:  4.1367 |Global loss: 5.5042| Local H loss: 0.0481  | Global H loss: 0.0403 [0m
[94mEpoch: 2|  NKD Loss: 0.6263 | CT Loss: 3.0664| [0m
[91mEpoch: 2|  Loss:  4.097 |Global loss: 5.4791| Local H loss: 0.0491  | Global H loss: 0.0402 [0m
[94mEpoch: 3|  NKD Loss: 0.6058 | CT Loss: 3.0542| [0m
[91mEpoch: 3|  Loss:  4.0671 |Global loss: 5.4409| Local H loss: 0.049  | Global H loss: 0.0399 [0m
------------------------- time cost ------------------------- 11.027897596359253
Chosen Clients:  [1, 7, 5]

-------------Round number: 77-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.876, 0.932, 0.911, 0.873, 0.855, 0.911, 0.852, 1.0]
AUC in each clients:  [454.909, 482.001, 329.179, 427.746, 505.013, 458.356, 432.58, 480.214, 12.0]
F1 Score:  [0.88, 0.867, 0.916, 0.903, 0.836, 0.748, 0.811, 0.787, 1.0]
Recall Score:  [0.87, 0.866, 0.909, 0.896, 0.821, 0.765, 0.802, 0.775, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.1981
Averaged Test Accurancy: 0.8844
Averaged Test AUC: 0.9542
Averaged Test F1_score: 0.8609
Averaged Test Recal score: 0.8560
Std Test Accurancy: 0.0436
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.1911 | CT Loss: 3.2413| [0m
[91mEpoch: 0|  Loss:  4.8245 |Global loss: 6.7596| Local H loss: 0.0481  | Global H loss: 0.0449 [0m
[94mEpoch: 1|  NKD Loss: 0.7911 | CT Loss: 3.0813| [0m
[91mEpoch: 1|  Loss:  4.2477 |Global loss: 5.9444| Local H loss: 0.0439  | Global H loss: 0.0428 [0m
[94mEpoch: 2|  NKD Loss: 0.7761 | CT Loss: 3.0655| [0m
[91mEpoch: 2|  Loss:  4.2295 |Global loss: 5.8922| Local H loss: 0.0446  | Global H loss: 0.0426 [0m
[94mEpoch: 3|  NKD Loss: 0.7346 | CT Loss: 3.0618| [0m
[91mEpoch: 3|  Loss:  4.1661 |Global loss: 5.8116| Local H loss: 0.0447  | Global H loss: 0.0431 [0m
[94mEpoch: 0|  NKD Loss: 1.4581 | CT Loss: 3.3633| [0m
[91mEpoch: 0|  Loss:  5.3728 |Global loss: 7.3441| Local H loss: 0.0444  | Global H loss: 0.042 [0m
[94mEpoch: 1|  NKD Loss: 1.0194 | CT Loss: 3.1534| [0m
[91mEpoch: 1|  Loss:  4.736 |Global loss: 6.2607| Local H loss: 0.0385  | Global H loss: 0.034 [0m
[94mEpoch: 2|  NKD Loss: 0.9549 | CT Loss: 3.1429| [0m
[91mEpoch: 2|  Loss:  4.6586 |Global loss: 6.0783| Local H loss: 0.0387  | Global H loss: 0.0323 [0m
[94mEpoch: 3|  NKD Loss: 0.8532 | CT Loss: 3.1263| [0m
[91mEpoch: 3|  Loss:  4.563 |Global loss: 6.043| Local H loss: 0.0365  | Global H loss: 0.0315 [0m
[94mEpoch: 0|  NKD Loss: 1.2133 | CT Loss: 3.3427| [0m
[91mEpoch: 0|  Loss:  5.1244 |Global loss: 6.8489| Local H loss: 0.043  | Global H loss: 0.0375 [0m
[94mEpoch: 1|  NKD Loss: 0.9393 | CT Loss: 3.1577| [0m
[91mEpoch: 1|  Loss:  4.6679 |Global loss: 6.1555| Local H loss: 0.0323  | Global H loss: 0.0307 [0m
[94mEpoch: 2|  NKD Loss: 0.8651 | CT Loss: 3.1377| [0m
[91mEpoch: 2|  Loss:  4.554 |Global loss: 6.0247| Local H loss: 0.0312  | Global H loss: 0.0313 [0m
[94mEpoch: 3|  NKD Loss: 0.8603 | CT Loss: 3.1337| [0m
[91mEpoch: 3|  Loss:  4.5315 |Global loss: 5.9915| Local H loss: 0.0309  | Global H loss: 0.031 [0m
------------------------- time cost ------------------------- 12.215428352355957
Chosen Clients:  [0, 3, 4]

-------------Round number: 78-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.878, 0.932, 0.911, 0.873, 0.857, 0.911, 0.844, 1.0]
AUC in each clients:  [454.909, 484.403, 329.179, 427.746, 505.013, 458.46, 432.58, 480.303, 12.0]
F1 Score:  [0.88, 0.871, 0.916, 0.903, 0.836, 0.743, 0.811, 0.79, 1.0]
Recall Score:  [0.87, 0.868, 0.909, 0.896, 0.821, 0.763, 0.802, 0.773, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.2120
Averaged Test Accurancy: 0.8839
Averaged Test AUC: 0.9549
Averaged Test F1_score: 0.8611
Averaged Test Recal score: 0.8558
Std Test Accurancy: 0.0443
Std Test AUC: 0.0168
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.3117 | CT Loss: 3.1908| [0m
[91mEpoch: 0|  Loss:  4.997 |Global loss: 6.7512| Local H loss: 0.0435  | Global H loss: 0.0382 [0m
[94mEpoch: 1|  NKD Loss: 0.964 | CT Loss: 3.0733| [0m
[91mEpoch: 1|  Loss:  4.5036 |Global loss: 6.111| Local H loss: 0.0401  | Global H loss: 0.0363 [0m
[94mEpoch: 2|  NKD Loss: 0.9191 | CT Loss: 3.0611| [0m
[91mEpoch: 2|  Loss:  4.4509 |Global loss: 6.0462| Local H loss: 0.04  | Global H loss: 0.0362 [0m
[94mEpoch: 3|  NKD Loss: 0.878 | CT Loss: 3.0552| [0m
[91mEpoch: 3|  Loss:  4.3982 |Global loss: 6.0131| Local H loss: 0.0395  | Global H loss: 0.0363 [0m
[94mEpoch: 0|  NKD Loss: 1.3218 | CT Loss: 3.2954| [0m
[91mEpoch: 0|  Loss:  5.0125 |Global loss: 6.7303| Local H loss: 0.0565  | Global H loss: 0.0461 [0m
[94mEpoch: 1|  NKD Loss: 0.7493 | CT Loss: 3.1359| [0m
[91mEpoch: 1|  Loss:  4.2765 |Global loss: 5.6581| Local H loss: 0.0508  | Global H loss: 0.0418 [0m
[94mEpoch: 2|  NKD Loss: 0.6869 | CT Loss: 3.11| [0m
[91mEpoch: 2|  Loss:  4.1684 |Global loss: 5.5741| Local H loss: 0.0513  | Global H loss: 0.0435 [0m
[94mEpoch: 3|  NKD Loss: 0.6718 | CT Loss: 3.1114| [0m
[91mEpoch: 3|  Loss:  4.1645 |Global loss: 5.5511| Local H loss: 0.0519  | Global H loss: 0.0426 [0m
[94mEpoch: 0|  NKD Loss: 1.5099 | CT Loss: 3.236| [0m
[91mEpoch: 0|  Loss:  5.2434 |Global loss: 7.0745| Local H loss: 0.0526  | Global H loss: 0.0405 [0m
[94mEpoch: 1|  NKD Loss: 1.0403 | CT Loss: 3.0583| [0m
[91mEpoch: 1|  Loss:  4.5884 |Global loss: 6.096| Local H loss: 0.0436  | Global H loss: 0.0359 [0m
[94mEpoch: 2|  NKD Loss: 0.8898 | CT Loss: 3.038| [0m
[91mEpoch: 2|  Loss:  4.3956 |Global loss: 5.8889| Local H loss: 0.0431  | Global H loss: 0.0359 [0m
[94mEpoch: 3|  NKD Loss: 0.8654 | CT Loss: 3.042| [0m
[91mEpoch: 3|  Loss:  4.3749 |Global loss: 5.8823| Local H loss: 0.0422  | Global H loss: 0.0356 [0m
------------------------- time cost ------------------------- 11.509666681289673
Chosen Clients:  [6, 7, 0]

-------------Round number: 79-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.901, 0.878, 0.932, 0.902, 0.871, 0.857, 0.911, 0.844, 1.0]
AUC in each clients:  [456.049, 484.403, 329.179, 427.723, 505.247, 458.46, 432.58, 480.303, 12.0]
F1 Score:  [0.899, 0.871, 0.916, 0.89, 0.844, 0.743, 0.811, 0.79, 1.0]
Recall Score:  [0.89, 0.868, 0.909, 0.882, 0.828, 0.763, 0.802, 0.773, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.2483
Averaged Test Accurancy: 0.8847
Averaged Test AUC: 0.9552
Averaged Test F1_score: 0.8627
Averaged Test Recal score: 0.8572
Std Test Accurancy: 0.0440
Std Test AUC: 0.0165
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.1062 | CT Loss: 3.2137| [0m
[91mEpoch: 0|  Loss:  4.7171 |Global loss: 6.3595| Local H loss: 0.0551  | Global H loss: 0.0461 [0m
[94mEpoch: 1|  NKD Loss: 0.6503 | CT Loss: 3.076| [0m
[91mEpoch: 1|  Loss:  4.1248 |Global loss: 5.537| Local H loss: 0.0483  | Global H loss: 0.0405 [0m
[94mEpoch: 2|  NKD Loss: 0.5932 | CT Loss: 3.0465| [0m
[91mEpoch: 2|  Loss:  4.0433 |Global loss: 5.4167| Local H loss: 0.0494  | Global H loss: 0.0402 [0m
[94mEpoch: 3|  NKD Loss: 0.6118 | CT Loss: 3.0471| [0m
[91mEpoch: 3|  Loss:  4.0592 |Global loss: 5.4525| Local H loss: 0.0497  | Global H loss: 0.0398 [0m
[94mEpoch: 0|  NKD Loss: 1.4949 | CT Loss: 3.3516| [0m
[91mEpoch: 0|  Loss:  5.3693 |Global loss: 7.2416| Local H loss: 0.0481  | Global H loss: 0.0413 [0m
[94mEpoch: 1|  NKD Loss: 0.966 | CT Loss: 3.1517| [0m
[91mEpoch: 1|  Loss:  4.6524 |Global loss: 6.2035| Local H loss: 0.0401  | Global H loss: 0.0338 [0m
[94mEpoch: 2|  NKD Loss: 0.8675 | CT Loss: 3.1281| [0m
[91mEpoch: 2|  Loss:  4.5467 |Global loss: 6.0114| Local H loss: 0.0383  | Global H loss: 0.0327 [0m
[94mEpoch: 3|  NKD Loss: 0.8566 | CT Loss: 3.1121| [0m
[91mEpoch: 3|  Loss:  4.5186 |Global loss: 5.9835| Local H loss: 0.0387  | Global H loss: 0.0326 [0m
[94mEpoch: 0|  NKD Loss: 1.2445 | CT Loss: 3.1555| [0m
[91mEpoch: 0|  Loss:  4.8627 |Global loss: 6.6104| Local H loss: 0.0452  | Global H loss: 0.039 [0m
[94mEpoch: 1|  NKD Loss: 0.8857 | CT Loss: 3.058| [0m
[91mEpoch: 1|  Loss:  4.4117 |Global loss: 6.0674| Local H loss: 0.0403  | Global H loss: 0.0369 [0m
[94mEpoch: 2|  NKD Loss: 0.8787 | CT Loss: 3.0501| [0m
[91mEpoch: 2|  Loss:  4.3872 |Global loss: 6.0625| Local H loss: 0.0405  | Global H loss: 0.037 [0m
[94mEpoch: 3|  NKD Loss: 0.816 | CT Loss: 3.0297| [0m
[91mEpoch: 3|  Loss:  4.2973 |Global loss: 5.9253| Local H loss: 0.041  | Global H loss: 0.0372 [0m
------------------------- time cost ------------------------- 11.734932661056519
Chosen Clients:  [6, 2, 5]

-------------Round number: 80-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.903, 0.878, 0.932, 0.902, 0.871, 0.857, 0.918, 0.844, 1.0]
AUC in each clients:  [453.589, 484.403, 329.179, 427.723, 505.247, 458.46, 433.055, 478.179, 12.0]
F1 Score:  [0.898, 0.871, 0.916, 0.89, 0.844, 0.743, 0.819, 0.814, 1.0]
Recall Score:  [0.89, 0.868, 0.909, 0.882, 0.828, 0.763, 0.813, 0.798, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.3936
Averaged Test Accurancy: 0.8857
Averaged Test AUC: 0.9541
Averaged Test F1_score: 0.8661
Averaged Test Recal score: 0.8612
Std Test Accurancy: 0.0442
Std Test AUC: 0.0176
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.0765 | CT Loss: 3.1934| [0m
[91mEpoch: 0|  Loss:  4.657 |Global loss: 6.2192| Local H loss: 0.0551  | Global H loss: 0.0455 [0m
[94mEpoch: 1|  NKD Loss: 0.6203 | CT Loss: 3.0661| [0m
[91mEpoch: 1|  Loss:  4.0574 |Global loss: 5.4777| Local H loss: 0.0503  | Global H loss: 0.0421 [0m
[94mEpoch: 2|  NKD Loss: 0.5845 | CT Loss: 3.048| [0m
[91mEpoch: 2|  Loss:  4.0068 |Global loss: 5.3641| Local H loss: 0.0501  | Global H loss: 0.0412 [0m
[94mEpoch: 3|  NKD Loss: 0.6099 | CT Loss: 3.0514| [0m
[91mEpoch: 3|  Loss:  4.0325 |Global loss: 5.4063| Local H loss: 0.0516  | Global H loss: 0.0425 [0m
[94mEpoch: 0|  NKD Loss: 1.1433 | CT Loss: 3.2831| [0m
[91mEpoch: 0|  Loss:  4.708 |Global loss: 6.3062| Local H loss: 0.071  | Global H loss: 0.0522 [0m
[94mEpoch: 1|  NKD Loss: 0.6156 | CT Loss: 3.1164| [0m
[91mEpoch: 1|  Loss:  4.0009 |Global loss: 5.3747| Local H loss: 0.0575  | Global H loss: 0.0465 [0m
[94mEpoch: 2|  NKD Loss: 0.61 | CT Loss: 3.105| [0m
[91mEpoch: 2|  Loss:  3.9812 |Global loss: 5.3113| Local H loss: 0.0637  | Global H loss: 0.0495 [0m
[94mEpoch: 3|  NKD Loss: 0.5761 | CT Loss: 3.1009| [0m
[91mEpoch: 3|  Loss:  3.9389 |Global loss: 5.2761| Local H loss: 0.0596  | Global H loss: 0.0471 [0m
[94mEpoch: 0|  NKD Loss: 1.3055 | CT Loss: 3.3354| [0m
[91mEpoch: 0|  Loss:  5.1819 |Global loss: 6.7645| Local H loss: 0.0438  | Global H loss: 0.0368 [0m
[94mEpoch: 1|  NKD Loss: 0.912 | CT Loss: 3.1514| [0m
[91mEpoch: 1|  Loss:  4.6015 |Global loss: 6.1215| Local H loss: 0.032  | Global H loss: 0.0319 [0m
[94mEpoch: 2|  NKD Loss: 0.8651 | CT Loss: 3.1231| [0m
[91mEpoch: 2|  Loss:  4.5077 |Global loss: 6.0108| Local H loss: 0.0313  | Global H loss: 0.0321 [0m
[94mEpoch: 3|  NKD Loss: 0.8439 | CT Loss: 3.112| [0m
[91mEpoch: 3|  Loss:  4.4605 |Global loss: 5.9484| Local H loss: 0.0335  | Global H loss: 0.0333 [0m
------------------------- time cost ------------------------- 10.822892189025879
Chosen Clients:  [3, 7, 5]

-------------Round number: 81-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.903, 0.878, 0.932, 0.902, 0.871, 0.882, 0.927, 0.844, 1.0]
AUC in each clients:  [453.589, 484.403, 329.495, 427.723, 505.247, 462.343, 433.702, 478.179, 12.0]
F1 Score:  [0.898, 0.871, 0.915, 0.89, 0.844, 0.816, 0.838, 0.814, 1.0]
Recall Score:  [0.89, 0.868, 0.91, 0.882, 0.828, 0.817, 0.832, 0.798, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.3048
Averaged Test Accurancy: 0.8900
Averaged Test AUC: 0.9554
Averaged Test F1_score: 0.8762
Averaged Test Recal score: 0.8694
Std Test Accurancy: 0.0426
Std Test AUC: 0.0173
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 1.2932 | CT Loss: 3.3047| [0m
[91mEpoch: 0|  Loss:  4.9774 |Global loss: 6.8175| Local H loss: 0.056  | Global H loss: 0.0464 [0m
[94mEpoch: 1|  NKD Loss: 0.7221 | CT Loss: 3.1367| [0m
[91mEpoch: 1|  Loss:  4.2163 |Global loss: 5.6377| Local H loss: 0.0532  | Global H loss: 0.0446 [0m
[94mEpoch: 2|  NKD Loss: 0.6866 | CT Loss: 3.1089| [0m
[91mEpoch: 2|  Loss:  4.1659 |Global loss: 5.5742| Local H loss: 0.0518  | Global H loss: 0.0434 [0m
[94mEpoch: 3|  NKD Loss: 0.6627 | CT Loss: 3.0998| [0m
[91mEpoch: 3|  Loss:  4.1184 |Global loss: 5.5042| Local H loss: 0.0542  | Global H loss: 0.0439 [0m
[94mEpoch: 0|  NKD Loss: 1.4801 | CT Loss: 3.4039| [0m
[91mEpoch: 0|  Loss:  5.4184 |Global loss: 7.2997| Local H loss: 0.0472  | Global H loss: 0.0416 [0m
[94mEpoch: 1|  NKD Loss: 0.9784 | CT Loss: 3.1427| [0m
[91mEpoch: 1|  Loss:  4.6489 |Global loss: 6.1544| Local H loss: 0.0411  | Global H loss: 0.0355 [0m
[94mEpoch: 2|  NKD Loss: 0.8539 | CT Loss: 3.1065| [0m
[91mEpoch: 2|  Loss:  4.4916 |Global loss: 5.9715| Local H loss: 0.0405  | Global H loss: 0.0345 [0m
[94mEpoch: 3|  NKD Loss: 0.818 | CT Loss: 3.0959| [0m
[91mEpoch: 3|  Loss:  4.4344 |Global loss: 5.8918| Local H loss: 0.04  | Global H loss: 0.0339 [0m
[94mEpoch: 0|  NKD Loss: 1.2068 | CT Loss: 3.2788| [0m
[91mEpoch: 0|  Loss:  4.9935 |Global loss: 6.6882| Local H loss: 0.0465  | Global H loss: 0.0389 [0m
[94mEpoch: 1|  NKD Loss: 0.8898 | CT Loss: 3.1245| [0m
[91mEpoch: 1|  Loss:  4.5139 |Global loss: 6.0582| Local H loss: 0.0352  | Global H loss: 0.0344 [0m
[94mEpoch: 2|  NKD Loss: 0.8333 | CT Loss: 3.1184| [0m
[91mEpoch: 2|  Loss:  4.4555 |Global loss: 5.985| Local H loss: 0.0328  | Global H loss: 0.0335 [0m
[94mEpoch: 3|  NKD Loss: 0.8153 | CT Loss: 3.093| [0m
[91mEpoch: 3|  Loss:  4.4043 |Global loss: 5.8987| Local H loss: 0.0326  | Global H loss: 0.033 [0m
------------------------- time cost ------------------------- 11.294576168060303
Chosen Clients:  [8, 2, 7]

-------------Round number: 82-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.903, 0.878, 0.932, 0.911, 0.871, 0.872, 0.927, 0.846, 1.0]
AUC in each clients:  [453.589, 484.403, 329.495, 429.567, 505.247, 461.457, 433.702, 479.238, 12.0]
F1 Score:  [0.898, 0.871, 0.915, 0.901, 0.844, 0.772, 0.838, 0.793, 1.0]
Recall Score:  [0.89, 0.868, 0.91, 0.892, 0.828, 0.783, 0.832, 0.776, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.3860
Averaged Test Accurancy: 0.8900
Averaged Test AUC: 0.9560
Averaged Test F1_score: 0.8702
Averaged Test Recal score: 0.8643
Std Test Accurancy: 0.0431
Std Test AUC: 0.0171
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 2.5377 | CT Loss: 5.0369| [0m
[91mEpoch: 0|  Loss:  7.6633 |Global loss: 15.6112| Local H loss: 0.048  | Global H loss: 0.0796 [0m
[94mEpoch: 1|  NKD Loss: 2.039 | CT Loss: 4.2899| [0m
[91mEpoch: 1|  Loss:  6.4308 |Global loss: 12.875| Local H loss: 0.0546  | Global H loss: 0.0824 [0m
[94mEpoch: 2|  NKD Loss: 1.438 | CT Loss: 4.2704| [0m
[91mEpoch: 2|  Loss:  5.8484 |Global loss: 8.2486| Local H loss: 0.0908  | Global H loss: 0.0811 [0m
[94mEpoch: 3|  NKD Loss: 1.2062 | CT Loss: 4.2599| [0m
[91mEpoch: 3|  Loss:  5.6163 |Global loss: 5.8333| Local H loss: 0.1061  | Global H loss: 0.0846 [0m
[94mEpoch: 0|  NKD Loss: 1.1029 | CT Loss: 3.2647| [0m
[91mEpoch: 0|  Loss:  4.6457 |Global loss: 6.2163| Local H loss: 0.0727  | Global H loss: 0.0524 [0m
[94mEpoch: 1|  NKD Loss: 0.6029 | CT Loss: 3.1129| [0m
[91mEpoch: 1|  Loss:  3.9735 |Global loss: 5.3666| Local H loss: 0.0596  | Global H loss: 0.0482 [0m
[94mEpoch: 2|  NKD Loss: 0.5794 | CT Loss: 3.1052| [0m
[91mEpoch: 2|  Loss:  3.9449 |Global loss: 5.3027| Local H loss: 0.0608  | Global H loss: 0.0477 [0m
[94mEpoch: 3|  NKD Loss: 0.5593 | CT Loss: 3.0954| [0m
[91mEpoch: 3|  Loss:  3.9146 |Global loss: 5.2404| Local H loss: 0.061  | Global H loss: 0.0483 [0m
[94mEpoch: 0|  NKD Loss: 1.4761 | CT Loss: 3.3374| [0m
[91mEpoch: 0|  Loss:  5.3403 |Global loss: 7.2562| Local H loss: 0.0473  | Global H loss: 0.0411 [0m
[94mEpoch: 1|  NKD Loss: 0.9271 | CT Loss: 3.1247| [0m
[91mEpoch: 1|  Loss:  4.5477 |Global loss: 6.0908| Local H loss: 0.0431  | Global H loss: 0.0359 [0m
[94mEpoch: 2|  NKD Loss: 0.8394 | CT Loss: 3.0982| [0m
[91mEpoch: 2|  Loss:  4.4283 |Global loss: 5.9835| Local H loss: 0.042  | Global H loss: 0.0355 [0m
[94mEpoch: 3|  NKD Loss: 0.8034 | CT Loss: 3.0842| [0m
[91mEpoch: 3|  Loss:  4.3763 |Global loss: 5.8636| Local H loss: 0.0412  | Global H loss: 0.0348 [0m
------------------------- time cost ------------------------- 8.37210726737976
Chosen Clients:  [8, 5, 4]

-------------Round number: 83-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.903, 0.878, 0.932, 0.911, 0.871, 0.872, 0.927, 0.864, 1.0]
AUC in each clients:  [453.589, 484.403, 329.054, 429.567, 505.247, 461.457, 433.702, 480.431, 12.0]
F1 Score:  [0.898, 0.871, 0.916, 0.901, 0.844, 0.772, 0.838, 0.838, 1.0]
Recall Score:  [0.89, 0.868, 0.91, 0.892, 0.828, 0.783, 0.832, 0.824, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 13.3856
Averaged Test Accurancy: 0.8924
Averaged Test AUC: 0.9562
Averaged Test F1_score: 0.8753
Averaged Test Recal score: 0.8697
Std Test Accurancy: 0.0407
Std Test AUC: 0.0167
Std Test F1: 0.0256
Std Test Recall: 0.0256
[94mEpoch: 0|  NKD Loss: 2.5369 | CT Loss: 5.2654| [0m
[91mEpoch: 0|  Loss:  7.8842 |Global loss: 16.7214| Local H loss: 0.0449  | Global H loss: 0.0802 [0m
[94mEpoch: 1|  NKD Loss: 1.8415 | CT Loss: 4.2585| [0m
[91mEpoch: 1|  Loss:  6.214 |Global loss: 10.4023| Local H loss: 0.0698  | Global H loss: 0.079 [0m
[94mEpoch: 2|  NKD Loss: 1.1901 | CT Loss: 4.2648| [0m
[91mEpoch: 2|  Loss:  5.6147 |Global loss: 7.0846| Local H loss: 0.1158  | Global H loss: 0.0787 [0m
[94mEpoch: 3|  NKD Loss: 1.1041 | CT Loss: 4.2569| [0m
[91mEpoch: 3|  Loss:  5.4723 |Global loss: 5.5445| Local H loss: 0.0725  | Global H loss: 0.1176 [0m
[94mEpoch: 0|  NKD Loss: 1.2308 | CT Loss: 3.2632| [0m
[91mEpoch: 0|  Loss:  5.0025 |Global loss: 6.7404| Local H loss: 0.047  | Global H loss: 0.0393 [0m
[94mEpoch: 1|  NKD Loss: 0.8893 | CT Loss: 3.1172| [0m
[91mEpoch: 1|  Loss:  4.5013 |Global loss: 6.0261| Local H loss: 0.0349  | Global H loss: 0.0343 [0m
[94mEpoch: 2|  NKD Loss: 0.848 | CT Loss: 3.1014| [0m
[91mEpoch: 2|  Loss:  4.436 |Global loss: 5.9723| Local H loss: 0.034  | Global H loss: 0.0345 [0m
[94mEpoch: 3|  NKD Loss: 0.7963 | CT Loss: 3.097| [0m
[91mEpoch: 3|  Loss:  4.3571 |Global loss: 5.9146| Local H loss: 0.0335  | Global H loss: 0.0351 [0m
[94mEpoch: 0|  NKD Loss: 1.459 | CT Loss: 3.2145| [0m
[91mEpoch: 0|  Loss:  5.1578 |Global loss: 6.915| Local H loss: 0.0527  | Global H loss: 0.0416 [0m
[94mEpoch: 1|  NKD Loss: 1.0171 | CT Loss: 3.0495| [0m
[91mEpoch: 1|  Loss:  4.5121 |Global loss: 6.0195| Local H loss: 0.046  | Global H loss: 0.037 [0m
[94mEpoch: 2|  NKD Loss: 0.8653 | CT Loss: 3.0279| [0m
[91mEpoch: 2|  Loss:  4.351 |Global loss: 5.8605| Local H loss: 0.0423  | Global H loss: 0.0356 [0m
[94mEpoch: 3|  NKD Loss: nan | CT Loss: nan| [0m
[91mEpoch: 3|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan [0m
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkdx.py", line 44, in train
    client.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 164, in train
    self.decomposition()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 259, in decomposition
    u, sigma, v = np.linalg.svd(param_cpu, full_matrices=False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 1681, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 121, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
