False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False

Join ratio / total clients: 0.4 / 9
Finished creating server and clients.
Chosen Clients:  [5, 8, 4]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
AUC in each clients:  [24.413, 23.836, 24.577, 26.681, 22.018, 28.126, 24.397, 25.945, 20.961]
F1 Score:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Recall Score:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72]
Averaged Train Loss: 10.4737
Averaged Test Accurancy: 0.0000
Averaged Test AUC: 0.3125
Averaged Test F1_score: 0.0000
Averaged Test Recal score: 0.0000
Std Test Accurancy: 0.0000
Std Test AUC: 0.0277
Std Test F1: 0.0000
Std Test Recall: 0.0000
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 3.608| [0m
[91mEpoch: 0|  Loss:  6.0404 |Global loss: 6.0404| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 3.5747| [0m
[91mEpoch: 1|  Loss:  5.8048 |Global loss: 5.8048| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 3.5392| [0m
[91mEpoch: 2|  Loss:  5.537 |Global loss: 5.537| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 3.5302| [0m
[91mEpoch: 3|  Loss:  5.2967 |Global loss: 5.2967| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 3.6558| [0m
[91mEpoch: 0|  Loss:  6.1133 |Global loss: 6.1133| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 3.634| [0m
[91mEpoch: 1|  Loss:  5.9352 |Global loss: 5.9352| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 3.6141| [0m
[91mEpoch: 2|  Loss:  5.7507 |Global loss: 5.7507| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 3.5839| [0m
[91mEpoch: 3|  Loss:  5.5279 |Global loss: 5.5279| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 3.6354| [0m
[91mEpoch: 0|  Loss:  6.0784 |Global loss: 6.0784| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 3.5992| [0m
[91mEpoch: 1|  Loss:  5.8408 |Global loss: 5.8408| Local H loss: -0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 3.5712| [0m
[91mEpoch: 2|  Loss:  5.5897 |Global loss: 5.5897| Local H loss: 0.0  | Global H loss: -0.0 [0m
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 3.5381| [0m
[91mEpoch: 3|  Loss:  5.3164 |Global loss: 5.3164| Local H loss: 0.0  | Global H loss: 0.0 [0m
------------------------- time cost ------------------------- 2.1333158016204834
Chosen Clients:  [0, 5, 2]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.0, 0.0, 0.0, 0.0, 0.474, 0.463, 0.0, 0.0, 0.208]
AUC in each clients:  [24.413, 23.836, 24.577, 26.681, 70.621, 71.049, 24.397, 25.945, 61.33]
F1 Score:  [0.0, 0.0, 0.0, 0.0, 0.385, 0.435, 0.0, 0.0, 0.172]
Recall Score:  [0.0, 0.0, 0.0, 0.0, 0.507, 0.572, 0.0, 0.0, 0.279]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72]
Averaged Train Loss: 10.8851
Averaged Test Accurancy: 0.1259
Averaged Test AUC: 0.4991
Averaged Test F1_score: 0.1102
Averaged Test Recal score: 0.1509
Std Test Accurancy: 0.1934
Std Test AUC: 0.2688
Std Test F1: 0.0021
Std Test Recall: 0.0029
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 4.6261| [0m
[91mEpoch: 0|  Loss:  7.0466 |Global loss: 7.1053| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 4.4114| [0m
[91mEpoch: 1|  Loss:  6.5845 |Global loss: 6.8642| Local H loss: 0.0007  | Global H loss: 0.0007 [0m
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 4.3071| [0m
[91mEpoch: 2|  Loss:  6.213 |Global loss: 6.7391| Local H loss: 0.0028  | Global H loss: 0.0029 [0m
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 4.2776| [0m
[91mEpoch: 3|  Loss:  5.978 |Global loss: 6.692| Local H loss: 0.0071  | Global H loss: 0.0066 [0m
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 4.6435| [0m
[91mEpoch: 0|  Loss:  6.1777 |Global loss: 7.1277| Local H loss: 0.0085  | Global H loss: 0.0076 [0m
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 4.499| [0m
[91mEpoch: 1|  Loss:  5.8392 |Global loss: 6.9485| Local H loss: 0.0131  | Global H loss: 0.0109 [0m
Traceback (most recent call last):
  File "/home/datpd1/datpd/Fed_2024/system/main.py", line 610, in <module>
    run(args)
  File "/home/datpd1/datpd/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/Fed_2024/system/flcore/servers/serverkdx.py", line 44, in train
    client.train()
  File "/home/datpd1/datpd/Fed_2024/system/flcore/clients/clientkdx.py", line 165, in train
    loss_g.backward()
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
