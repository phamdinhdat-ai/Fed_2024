
Join ratio / total clients: 0.4 / 15
Finished creating server and clients.
Chosen Clients:  [14, 4, 13, 5, 3, 8]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [55.643, 56.061, 56.199, 55.794, 55.242, 54.867, 54.586, 56.946, 53.139, 53.533, 54.657, 55.299, 55.6, 55.867, 54.981]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.4367
Averaged Test Accurancy: 0.0667
Averaged Test AUC: 0.4602
Averaged Test F1_score: 0.0100
Averaged Test Recal score: 0.0830
Std Test Accurancy: 0.0000
Std Test AUC: 0.0080
Std Test F1: 0.0000
Std Test Recall: 0.0000
[94mEpoch: 0|  NKD Loss: 2.3185 | CT Loss: 4.261| [0m
[91mEpoch: 0|  Loss:  8.9995 |Global loss: 9.0303| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3207 | CT Loss: 4.2402| [0m
[91mEpoch: 1|  Loss:  8.8353 |Global loss: 8.9237| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3158 | CT Loss: 4.2232| [0m
[91mEpoch: 2|  Loss:  8.6754 |Global loss: 8.813| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2943 | CT Loss: 4.2142| [0m
[91mEpoch: 3|  Loss:  8.4953 |Global loss: 8.6869| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 0|  NKD Loss: 2.3163 | CT Loss: 4.2574| [0m
[91mEpoch: 0|  Loss:  9.0055 |Global loss: 9.0363| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3177 | CT Loss: 4.2387| [0m
[91mEpoch: 1|  Loss:  8.8357 |Global loss: 8.9278| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3112 | CT Loss: 4.2272| [0m
[91mEpoch: 2|  Loss:  8.6813 |Global loss: 8.8217| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2834 | CT Loss: 4.2071| [0m
[91mEpoch: 3|  Loss:  8.46 |Global loss: 8.662| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 0|  NKD Loss: 2.3173 | CT Loss: 4.2465| [0m
[91mEpoch: 0|  Loss:  9.001 |Global loss: 9.0273| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3201 | CT Loss: 4.2274| [0m
[91mEpoch: 1|  Loss:  8.8639 |Global loss: 8.9403| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3188 | CT Loss: 4.2123| [0m
[91mEpoch: 2|  Loss:  8.7244 |Global loss: 8.8493| Local H loss: 0.0  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.3073 | CT Loss: 4.2014| [0m
[91mEpoch: 3|  Loss:  8.5736 |Global loss: 8.7517| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 0|  NKD Loss: 2.3164 | CT Loss: 4.2606| [0m
[91mEpoch: 0|  Loss:  8.9964 |Global loss: 9.028| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.316 | CT Loss: 4.2459| [0m
[91mEpoch: 1|  Loss:  8.8269 |Global loss: 8.9197| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.304 | CT Loss: 4.2331| [0m
[91mEpoch: 2|  Loss:  8.6613 |Global loss: 8.8045| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2632 | CT Loss: 4.2209| [0m
[91mEpoch: 3|  Loss:  8.442 |Global loss: 8.641| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 0|  NKD Loss: 2.3155 | CT Loss: 4.2344| [0m
[91mEpoch: 0|  Loss:  8.9744 |Global loss: 9.0074| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3159 | CT Loss: 4.22| [0m
[91mEpoch: 1|  Loss:  8.8032 |Global loss: 8.8941| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3036 | CT Loss: 4.2048| [0m
[91mEpoch: 2|  Loss:  8.643 |Global loss: 8.7794| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2599 | CT Loss: 4.1913| [0m
[91mEpoch: 3|  Loss:  8.4262 |Global loss: 8.6166| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 0|  NKD Loss: 2.316 | CT Loss: 4.2496| [0m
[91mEpoch: 0|  Loss:  8.9863 |Global loss: 9.0172| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3145 | CT Loss: 4.2336| [0m
[91mEpoch: 1|  Loss:  8.8191 |Global loss: 8.9048| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.2945 | CT Loss: 4.2237| [0m
[91mEpoch: 2|  Loss:  8.6507 |Global loss: 8.7798| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2233 | CT Loss: 4.2135| [0m
[91mEpoch: 3|  Loss:  8.4191 |Global loss: 8.6027| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
------------------------- time cost ------------------------- 3.396279811859131
Chosen Clients:  [3, 5, 9, 2, 7, 14]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.308, 0.4, 0.217, 0.067, 0.067, 0.242, 0.067, 0.067, 0.067, 0.067, 0.317, 0.258]
AUC in each clients:  [55.643, 56.061, 56.199, 98.82, 101.297, 100.337, 54.586, 56.946, 94.701, 53.533, 54.657, 55.299, 55.6, 99.427, 98.267]
F1 Score:  [0.01, 0.01, 0.01, 0.22, 0.309, 0.124, 0.01, 0.01, 0.171, 0.01, 0.01, 0.01, 0.01, 0.261, 0.214]
Recall Score:  [0.083, 0.083, 0.083, 0.407, 0.476, 0.302, 0.083, 0.083, 0.333, 0.083, 0.083, 0.083, 0.083, 0.417, 0.352]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.6561
Averaged Test Accurancy: 0.1561
Averaged Test AUC: 0.6063
Averaged Test F1_score: 0.0926
Averaged Test Recal score: 0.2023
Std Test Accurancy: 0.1160
Std Test AUC: 0.1777
Std Test F1: 0.0009
Std Test Recall: 0.0013
[94mEpoch: 0|  NKD Loss: 2.3366 | CT Loss: 5.3313| [0m
[91mEpoch: 0|  Loss:  9.5414 |Global loss: 10.152| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 1|  NKD Loss: 2.3126 | CT Loss: 5.0194| [0m
[91mEpoch: 1|  Loss:  9.0656 |Global loss: 9.7979| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 2|  NKD Loss: 2.309 | CT Loss: 5.0337| [0m
[91mEpoch: 2|  Loss:  8.962 |Global loss: 9.7986| Local H loss: 0.0026  | Global H loss: 0.0029 [0m
[94mEpoch: 3|  NKD Loss: 2.3086 | CT Loss: 5.0165| [0m
[91mEpoch: 3|  Loss:  8.83 |Global loss: 9.7749| Local H loss: 0.0032  | Global H loss: 0.0037 [0m
[94mEpoch: 0|  NKD Loss: 2.3367 | CT Loss: 5.3252| [0m
[91mEpoch: 0|  Loss:  9.4923 |Global loss: 10.1486| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 1|  NKD Loss: 2.3121 | CT Loss: 5.0728| [0m
[91mEpoch: 1|  Loss:  9.1131 |Global loss: 9.8599| Local H loss: 0.002  | Global H loss: 0.0022 [0m
[94mEpoch: 2|  NKD Loss: 2.3109 | CT Loss: 4.9832| [0m
[91mEpoch: 2|  Loss:  8.9166 |Global loss: 9.7478| Local H loss: 0.0025  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 2.3127 | CT Loss: 4.9631| [0m
[91mEpoch: 3|  Loss:  8.7741 |Global loss: 9.7116| Local H loss: 0.0032  | Global H loss: 0.0037 [0m
[94mEpoch: 0|  NKD Loss: 2.3191 | CT Loss: 5.316| [0m
[91mEpoch: 0|  Loss:  10.0582 |Global loss: 10.1192| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3099 | CT Loss: 5.0975| [0m
[91mEpoch: 1|  Loss:  9.6972 |Global loss: 9.8832| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3042 | CT Loss: 5.0798| [0m
[91mEpoch: 2|  Loss:  9.5506 |Global loss: 9.851| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.299 | CT Loss: 5.017| [0m
[91mEpoch: 3|  Loss:  9.3497 |Global loss: 9.7725| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.3195 | CT Loss: 5.3307| [0m
[91mEpoch: 0|  Loss:  10.086 |Global loss: 10.137| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3106 | CT Loss: 5.1234| [0m
[91mEpoch: 1|  Loss:  9.7434 |Global loss: 9.9205| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3071 | CT Loss: 5.0496| [0m
[91mEpoch: 2|  Loss:  9.5462 |Global loss: 9.835| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.3046 | CT Loss: 5.0091| [0m
[91mEpoch: 3|  Loss:  9.3903 |Global loss: 9.7843| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.319 | CT Loss: 5.3036| [0m
[91mEpoch: 0|  Loss:  10.0442 |Global loss: 10.1059| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3114 | CT Loss: 5.064| [0m
[91mEpoch: 1|  Loss:  9.6556 |Global loss: 9.8442| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.3068 | CT Loss: 5.0096| [0m
[91mEpoch: 2|  Loss:  9.472 |Global loss: 9.7751| Local H loss: 0.0003  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.3027 | CT Loss: 4.9856| [0m
[91mEpoch: 3|  Loss:  9.3207 |Global loss: 9.7325| Local H loss: 0.0006  | Global H loss: 0.0006 [0m
[94mEpoch: 0|  NKD Loss: 2.3178 | CT Loss: 5.3309| [0m
[91mEpoch: 0|  Loss:  9.4903 |Global loss: 10.1349| Local H loss: 0.0016  | Global H loss: 0.0017 [0m
[94mEpoch: 1|  NKD Loss: 2.2993 | CT Loss: 5.1046| [0m
[91mEpoch: 1|  Loss:  9.1335 |Global loss: 9.8848| Local H loss: 0.0017  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.2956 | CT Loss: 5.0548| [0m
[91mEpoch: 2|  Loss:  8.933 |Global loss: 9.8145| Local H loss: 0.0023  | Global H loss: 0.0026 [0m
[94mEpoch: 3|  NKD Loss: 2.2919 | CT Loss: 5.0295| [0m
[91mEpoch: 3|  Loss:  8.7476 |Global loss: 9.7702| Local H loss: 0.0032  | Global H loss: 0.0037 [0m
------------------------- time cost ------------------------- 3.4724156856536865
Chosen Clients:  [2, 5, 7, 1, 11, 14]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.233, 0.742, 0.4, 0.742, 0.067, 0.567, 0.242, 0.4, 0.067, 0.067, 0.067, 0.317, 0.933]
AUC in each clients:  [55.643, 56.061, 100.508, 116.517, 101.297, 116.631, 54.586, 102.005, 94.701, 103.336, 54.657, 55.299, 55.6, 99.427, 119.154]
F1 Score:  [0.01, 0.01, 0.184, 0.706, 0.309, 0.742, 0.01, 0.503, 0.171, 0.37, 0.01, 0.01, 0.01, 0.261, 0.924]
Recall Score:  [0.083, 0.083, 0.314, 0.785, 0.476, 0.802, 0.083, 0.641, 0.333, 0.484, 0.083, 0.083, 0.083, 0.417, 0.942]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.5556
Averaged Test Accurancy: 0.3317
Averaged Test AUC: 0.7141
Averaged Test F1_score: 0.2820
Averaged Test Recal score: 0.3795
Std Test Accurancy: 0.2831
Std Test AUC: 0.2139
Std Test F1: 0.0025
Std Test Recall: 0.0024
[94mEpoch: 0|  NKD Loss: 2.3044 | CT Loss: 5.2232| [0m
[91mEpoch: 0|  Loss:  9.4755 |Global loss: 10.0091| Local H loss: 0.0009  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.3014 | CT Loss: 4.9879| [0m
[91mEpoch: 1|  Loss:  9.1163 |Global loss: 9.7551| Local H loss: 0.0013  | Global H loss: 0.0014 [0m
[94mEpoch: 2|  NKD Loss: 2.2994 | CT Loss: 4.9421| [0m
[91mEpoch: 2|  Loss:  8.9457 |Global loss: 9.7003| Local H loss: 0.0019  | Global H loss: 0.0021 [0m
[94mEpoch: 3|  NKD Loss: 2.2977 | CT Loss: 4.9172| [0m
[91mEpoch: 3|  Loss:  8.7853 |Global loss: 9.6655| Local H loss: 0.0026  | Global H loss: 0.003 [0m
[94mEpoch: 0|  NKD Loss: 2.3218 | CT Loss: 5.2461| [0m
[91mEpoch: 0|  Loss:  8.952 |Global loss: 10.0568| Local H loss: 0.0045  | Global H loss: 0.0053 [0m
[94mEpoch: 1|  NKD Loss: 2.3218 | CT Loss: 5.004| [0m
[91mEpoch: 1|  Loss:  8.6117 |Global loss: 9.7969| Local H loss: 0.0053  | Global H loss: 0.0063 [0m
[94mEpoch: 2|  NKD Loss: 2.3222 | CT Loss: 4.9526| [0m
[91mEpoch: 2|  Loss:  8.4763 |Global loss: 9.7314| Local H loss: 0.0064  | Global H loss: 0.0077 [0m
[94mEpoch: 3|  NKD Loss: 2.3188 | CT Loss: 4.9352| [0m
[91mEpoch: 3|  Loss:  8.3685 |Global loss: 9.6975| Local H loss: 0.0075  | Global H loss: 0.0091 [0m
[94mEpoch: 0|  NKD Loss: 2.305 | CT Loss: 5.2357| [0m
[91mEpoch: 0|  Loss:  9.458 |Global loss: 10.0223| Local H loss: 0.0011  | Global H loss: 0.0012 [0m
[94mEpoch: 1|  NKD Loss: 2.2985 | CT Loss: 5.0115| [0m
[91mEpoch: 1|  Loss:  9.1095 |Global loss: 9.7782| Local H loss: 0.0015  | Global H loss: 0.0016 [0m
[94mEpoch: 2|  NKD Loss: 2.2964 | CT Loss: 4.9711| [0m
[91mEpoch: 2|  Loss:  8.939 |Global loss: 9.724| Local H loss: 0.0021  | Global H loss: 0.0024 [0m
[94mEpoch: 3|  NKD Loss: 2.2917 | CT Loss: 4.9492| [0m
[91mEpoch: 3|  Loss:  8.7669 |Global loss: 9.6789| Local H loss: 0.0029  | Global H loss: 0.0034 [0m
[94mEpoch: 0|  NKD Loss: 2.3198 | CT Loss: 5.3114| [0m
[91mEpoch: 0|  Loss:  10.0547 |Global loss: 10.1106| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3124 | CT Loss: 5.0819| [0m
[91mEpoch: 1|  Loss:  9.6911 |Global loss: 9.8567| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3081 | CT Loss: 5.0359| [0m
[91mEpoch: 2|  Loss:  9.5269 |Global loss: 9.8013| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.3045 | CT Loss: 4.9866| [0m
[91mEpoch: 3|  Loss:  9.3594 |Global loss: 9.7378| Local H loss: 0.0005  | Global H loss: 0.0006 [0m
[94mEpoch: 0|  NKD Loss: 2.3186 | CT Loss: 5.3132| [0m
[91mEpoch: 0|  Loss:  10.0526 |Global loss: 10.1135| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3095 | CT Loss: 5.0947| [0m
[91mEpoch: 1|  Loss:  9.6913 |Global loss: 9.8729| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3028 | CT Loss: 5.0399| [0m
[91mEpoch: 2|  Loss:  9.5034 |Global loss: 9.8068| Local H loss: 0.0002  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2976 | CT Loss: 5.0259| [0m
[91mEpoch: 3|  Loss:  9.3564 |Global loss: 9.7762| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.2967 | CT Loss: 5.2462| [0m
[91mEpoch: 0|  Loss:  8.8458 |Global loss: 10.0271| Local H loss: 0.0045  | Global H loss: 0.0053 [0m
[94mEpoch: 1|  NKD Loss: 2.2908 | CT Loss: 5.0417| [0m
[91mEpoch: 1|  Loss:  8.4979 |Global loss: 9.8031| Local H loss: 0.0058  | Global H loss: 0.0071 [0m
[94mEpoch: 2|  NKD Loss: 2.2863 | CT Loss: 4.9825| [0m
[91mEpoch: 2|  Loss:  8.3092 |Global loss: 9.7215| Local H loss: 0.0074  | Global H loss: 0.0092 [0m
[94mEpoch: 3|  NKD Loss: 2.2811 | CT Loss: 4.9506| [0m
[91mEpoch: 3|  Loss:  8.1518 |Global loss: 9.6621| Local H loss: 0.0095  | Global H loss: 0.0119 [0m
------------------------- time cost ------------------------- 3.455533266067505
Chosen Clients:  [11, 12, 2, 9, 0, 8]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.342, 0.85, 0.742, 0.4, 0.842, 0.067, 0.883, 0.242, 0.4, 0.067, 0.5, 0.067, 0.317, 0.975]
AUC in each clients:  [55.643, 95.333, 116.523, 116.517, 101.297, 118.508, 54.586, 116.404, 94.701, 103.336, 54.657, 107.855, 55.6, 99.427, 119.619]
F1 Score:  [0.01, 0.295, 0.853, 0.706, 0.309, 0.827, 0.01, 0.853, 0.171, 0.37, 0.01, 0.435, 0.01, 0.261, 0.973]
Recall Score:  [0.083, 0.435, 0.894, 0.785, 0.476, 0.85, 0.083, 0.9, 0.333, 0.484, 0.083, 0.586, 0.083, 0.417, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.3523
Averaged Test Accurancy: 0.4506
Averaged Test AUC: 0.7833
Averaged Test F1_score: 0.4062
Averaged Test Recal score: 0.4979
Std Test Accurancy: 0.3194
Std Test AUC: 0.2062
Std Test F1: 0.0028
Std Test Recall: 0.0026
[94mEpoch: 0|  NKD Loss: 2.2979 | CT Loss: 5.3587| [0m
[91mEpoch: 0|  Loss:  9.5606 |Global loss: 10.1436| Local H loss: 0.001  | Global H loss: 0.0011 [0m
[94mEpoch: 1|  NKD Loss: 2.2943 | CT Loss: 5.3444| [0m
[91mEpoch: 1|  Loss:  9.392 |Global loss: 10.1255| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.295 | CT Loss: 5.3347| [0m
[91mEpoch: 2|  Loss:  9.2345 |Global loss: 10.1174| Local H loss: 0.0024  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 2.2963 | CT Loss: 5.3274| [0m
[91mEpoch: 3|  Loss:  9.0875 |Global loss: 10.113| Local H loss: 0.0033  | Global H loss: 0.004 [0m
[94mEpoch: 0|  NKD Loss: 2.3179 | CT Loss: 5.392| [0m
[91mEpoch: 0|  Loss:  10.123 |Global loss: 10.1951| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3098 | CT Loss: 5.3731| [0m
[91mEpoch: 1|  Loss:  9.9627 |Global loss: 10.1687| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.3061 | CT Loss: 5.3639| [0m
[91mEpoch: 2|  Loss:  9.8328 |Global loss: 10.1564| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.3045 | CT Loss: 5.3559| [0m
[91mEpoch: 3|  Loss:  9.7057 |Global loss: 10.1457| Local H loss: 0.0007  | Global H loss: 0.0007 [0m
[94mEpoch: 0|  NKD Loss: 2.307 | CT Loss: 5.3423| [0m
[91mEpoch: 0|  Loss:  9.0957 |Global loss: 10.1372| Local H loss: 0.0038  | Global H loss: 0.0045 [0m
[94mEpoch: 1|  NKD Loss: 2.3044 | CT Loss: 5.3347| [0m
[91mEpoch: 1|  Loss:  8.9677 |Global loss: 10.1307| Local H loss: 0.005  | Global H loss: 0.006 [0m
[94mEpoch: 2|  NKD Loss: 2.3045 | CT Loss: 5.3268| [0m
[91mEpoch: 2|  Loss:  8.8505 |Global loss: 10.124| Local H loss: 0.0064  | Global H loss: 0.0078 [0m
[94mEpoch: 3|  NKD Loss: 2.3049 | CT Loss: 5.3197| [0m
[91mEpoch: 3|  Loss:  8.761 |Global loss: 10.1189| Local H loss: 0.0077  | Global H loss: 0.0095 [0m
[94mEpoch: 0|  NKD Loss: 2.2971 | CT Loss: 5.3532| [0m
[91mEpoch: 0|  Loss:  9.5452 |Global loss: 10.136| Local H loss: 0.001  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.2913 | CT Loss: 5.3381| [0m
[91mEpoch: 1|  Loss:  9.3694 |Global loss: 10.1168| Local H loss: 0.0015  | Global H loss: 0.0017 [0m
[94mEpoch: 2|  NKD Loss: 2.2853 | CT Loss: 5.3262| [0m
[91mEpoch: 2|  Loss:  9.1861 |Global loss: 10.0996| Local H loss: 0.0023  | Global H loss: 0.0027 [0m
[94mEpoch: 3|  NKD Loss: 2.2792 | CT Loss: 5.3171| [0m
[91mEpoch: 3|  Loss:  9.018 |Global loss: 10.0861| Local H loss: 0.0033  | Global H loss: 0.004 [0m
[94mEpoch: 0|  NKD Loss: 2.3192 | CT Loss: 5.3963| [0m
[91mEpoch: 0|  Loss:  10.1471 |Global loss: 10.201| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3107 | CT Loss: 5.3661| [0m
[91mEpoch: 1|  Loss:  9.9766 |Global loss: 10.1611| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.3061 | CT Loss: 5.3457| [0m
[91mEpoch: 2|  Loss:  9.8344 |Global loss: 10.137| Local H loss: 0.0003  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.3028 | CT Loss: 5.3331| [0m
[91mEpoch: 3|  Loss:  9.7057 |Global loss: 10.1205| Local H loss: 0.0006  | Global H loss: 0.0006 [0m
[94mEpoch: 0|  NKD Loss: 2.3419 | CT Loss: 5.3972| [0m
[91mEpoch: 0|  Loss:  9.6046 |Global loss: 10.2273| Local H loss: 0.0022  | Global H loss: 0.0023 [0m
[94mEpoch: 1|  NKD Loss: 2.3053 | CT Loss: 5.3719| [0m
[91mEpoch: 1|  Loss:  9.4443 |Global loss: 10.1638| Local H loss: 0.0018  | Global H loss: 0.002 [0m
[94mEpoch: 2|  NKD Loss: 2.2994 | CT Loss: 5.3606| [0m
[91mEpoch: 2|  Loss:  9.3057 |Global loss: 10.1474| Local H loss: 0.0024  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 2.2961 | CT Loss: 5.3501| [0m
[91mEpoch: 3|  Loss:  9.149 |Global loss: 10.1351| Local H loss: 0.0033  | Global H loss: 0.004 [0m
------------------------- time cost ------------------------- 3.266735315322876
Chosen Clients:  [2, 11, 14, 13, 6, 5]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.217, 0.342, 0.892, 0.742, 0.4, 0.842, 0.067, 0.883, 0.908, 0.858, 0.067, 0.733, 0.183, 0.317, 0.975]
AUC in each clients:  [94.821, 95.333, 118.946, 116.517, 101.297, 118.508, 54.586, 116.404, 118.105, 118.474, 54.657, 118.105, 102.274, 99.427, 119.619]
F1 Score:  [0.169, 0.295, 0.905, 0.706, 0.309, 0.827, 0.01, 0.853, 0.875, 0.856, 0.01, 0.728, 0.085, 0.261, 0.973]
Recall Score:  [0.283, 0.435, 0.918, 0.785, 0.476, 0.85, 0.083, 0.9, 0.9, 0.894, 0.083, 0.817, 0.25, 0.417, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.1412
Averaged Test Accurancy: 0.5617
Averaged Test AUC: 0.8595
Averaged Test F1_score: 0.5241
Averaged Test Recal score: 0.6045
Std Test Accurancy: 0.3285
Std Test AUC: 0.1755
Std Test F1: 0.0029
Std Test Recall: 0.0026
[94mEpoch: 0|  NKD Loss: 2.3064 | CT Loss: 5.312| [0m
[91mEpoch: 0|  Loss:  8.6695 |Global loss: 10.1139| Local H loss: 0.0091  | Global H loss: 0.0113 [0m
[94mEpoch: 1|  NKD Loss: 2.3011 | CT Loss: 5.3055| [0m
[91mEpoch: 1|  Loss:  8.573 |Global loss: 10.1054| Local H loss: 0.0109  | Global H loss: 0.0134 [0m
[94mEpoch: 2|  NKD Loss: 2.3027 | CT Loss: 5.3008| [0m
[91mEpoch: 2|  Loss:  8.5316 |Global loss: 10.1043| Local H loss: 0.0119  | Global H loss: 0.0147 [0m
[94mEpoch: 3|  NKD Loss: 2.2956 | CT Loss: 5.2934| [0m
[91mEpoch: 3|  Loss:  8.4433 |Global loss: 10.0906| Local H loss: 0.0138  | Global H loss: 0.017 [0m
[94mEpoch: 0|  NKD Loss: 2.2962 | CT Loss: 5.3207| [0m
[91mEpoch: 0|  Loss:  8.9337 |Global loss: 10.1079| Local H loss: 0.0047  | Global H loss: 0.0057 [0m
[94mEpoch: 1|  NKD Loss: 2.2985 | CT Loss: 5.3149| [0m
[91mEpoch: 1|  Loss:  8.8096 |Global loss: 10.1063| Local H loss: 0.0062  | Global H loss: 0.0076 [0m
[94mEpoch: 2|  NKD Loss: 2.3017 | CT Loss: 5.3114| [0m
[91mEpoch: 2|  Loss:  8.7191 |Global loss: 10.1075| Local H loss: 0.0076  | Global H loss: 0.0094 [0m
[94mEpoch: 3|  NKD Loss: 2.2975 | CT Loss: 5.3048| [0m
[91mEpoch: 3|  Loss:  8.5994 |Global loss: 10.0995| Local H loss: 0.0093  | Global H loss: 0.0116 [0m
[94mEpoch: 0|  NKD Loss: 2.2889 | CT Loss: 5.3411| [0m
[91mEpoch: 0|  Loss:  8.4677 |Global loss: 10.129| Local H loss: 0.0118  | Global H loss: 0.0149 [0m
[94mEpoch: 1|  NKD Loss: 2.2851 | CT Loss: 5.336| [0m
[91mEpoch: 1|  Loss:  8.3897 |Global loss: 10.124| Local H loss: 0.0138  | Global H loss: 0.0175 [0m
[94mEpoch: 2|  NKD Loss: 2.2746 | CT Loss: 5.326| [0m
[91mEpoch: 2|  Loss:  8.3014 |Global loss: 10.1062| Local H loss: 0.0158  | Global H loss: 0.02 [0m
[94mEpoch: 3|  NKD Loss: 2.2718 | CT Loss: 5.3222| [0m
[91mEpoch: 3|  Loss:  8.247 |Global loss: 10.1005| Local H loss: 0.0175  | Global H loss: 0.0222 [0m
[94mEpoch: 0|  NKD Loss: 2.3093 | CT Loss: 5.3878| [0m
[91mEpoch: 0|  Loss:  9.6406 |Global loss: 10.1819| Local H loss: 0.0012  | Global H loss: 0.0013 [0m
[94mEpoch: 1|  NKD Loss: 2.3027 | CT Loss: 5.3724| [0m
[91mEpoch: 1|  Loss:  9.4962 |Global loss: 10.1621| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.3019 | CT Loss: 5.3601| [0m
[91mEpoch: 2|  Loss:  9.3661 |Global loss: 10.1506| Local H loss: 0.0022  | Global H loss: 0.0025 [0m
[94mEpoch: 3|  NKD Loss: 2.3047 | CT Loss: 5.3526| [0m
[91mEpoch: 3|  Loss:  9.2496 |Global loss: 10.1457| Local H loss: 0.0029  | Global H loss: 0.0034 [0m
[94mEpoch: 0|  NKD Loss: 2.319 | CT Loss: 5.399| [0m
[91mEpoch: 0|  Loss:  10.1435 |Global loss: 10.202| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3107 | CT Loss: 5.3772| [0m
[91mEpoch: 1|  Loss:  9.9809 |Global loss: 10.1731| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.3066 | CT Loss: 5.3651| [0m
[91mEpoch: 2|  Loss:  9.8483 |Global loss: 10.1571| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 3|  NKD Loss: 2.3044 | CT Loss: 5.3541| [0m
[91mEpoch: 3|  Loss:  9.7236 |Global loss: 10.1442| Local H loss: 0.0006  | Global H loss: 0.0007 [0m
[94mEpoch: 0|  NKD Loss: 2.326 | CT Loss: 5.3242| [0m
[91mEpoch: 0|  Loss:  8.6964 |Global loss: 10.1464| Local H loss: 0.0089  | Global H loss: 0.011 [0m
[94mEpoch: 1|  NKD Loss: 2.3195 | CT Loss: 5.3173| [0m
[91mEpoch: 1|  Loss:  8.6125 |Global loss: 10.1337| Local H loss: 0.0101  | Global H loss: 0.0127 [0m
[94mEpoch: 2|  NKD Loss: 2.3183 | CT Loss: 5.3133| [0m
[91mEpoch: 2|  Loss:  8.5781 |Global loss: 10.1302| Local H loss: 0.011  | Global H loss: 0.0138 [0m
[94mEpoch: 3|  NKD Loss: 2.3152 | CT Loss: 5.3078| [0m
[91mEpoch: 3|  Loss:  8.4936 |Global loss: 10.1235| Local H loss: 0.0126  | Global H loss: 0.0158 [0m
------------------------- time cost ------------------------- 3.2119102478027344
Chosen Clients:  [8, 14, 6, 10, 0, 12]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.217, 0.342, 0.908, 0.742, 0.4, 0.908, 0.325, 0.883, 0.908, 0.858, 0.067, 0.983, 0.183, 0.767, 0.975]
AUC in each clients:  [94.821, 95.333, 119.411, 116.517, 101.297, 119.368, 97.098, 116.404, 118.105, 118.474, 54.657, 119.616, 102.274, 116.394, 119.72]
F1 Score:  [0.169, 0.295, 0.922, 0.706, 0.309, 0.899, 0.235, 0.853, 0.875, 0.856, 0.01, 0.981, 0.085, 0.767, 0.973]
Recall Score:  [0.283, 0.435, 0.932, 0.785, 0.476, 0.908, 0.417, 0.9, 0.9, 0.894, 0.083, 0.984, 0.25, 0.824, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.0015
Averaged Test Accurancy: 0.6311
Averaged Test AUC: 0.8942
Averaged Test F1_score: 0.5957
Averaged Test Recal score: 0.6699
Std Test Accurancy: 0.3205
Std Test AUC: 0.1415
Std Test F1: 0.0029
Std Test Recall: 0.0025
[94mEpoch: 0|  NKD Loss: 2.2949 | CT Loss: 5.3394| [0m
[91mEpoch: 0|  Loss:  9.0125 |Global loss: 10.1249| Local H loss: 0.0044  | Global H loss: 0.0052 [0m
[94mEpoch: 1|  NKD Loss: 2.2978 | CT Loss: 5.3312| [0m
[91mEpoch: 1|  Loss:  8.8973 |Global loss: 10.1214| Local H loss: 0.0056  | Global H loss: 0.0067 [0m
[94mEpoch: 2|  NKD Loss: 2.2978 | CT Loss: 5.3239| [0m
[91mEpoch: 2|  Loss:  8.7719 |Global loss: 10.115| Local H loss: 0.0072  | Global H loss: 0.0088 [0m
[94mEpoch: 3|  NKD Loss: 2.2999 | CT Loss: 5.3174| [0m
[91mEpoch: 3|  Loss:  8.68 |Global loss: 10.1134| Local H loss: 0.0086  | Global H loss: 0.0104 [0m
[94mEpoch: 0|  NKD Loss: 2.2595 | CT Loss: 5.3159| [0m
[91mEpoch: 0|  Loss:  8.1664 |Global loss: 10.0852| Local H loss: 0.02  | Global H loss: 0.0251 [0m
[94mEpoch: 1|  NKD Loss: 2.2593 | CT Loss: 5.3117| [0m
[91mEpoch: 1|  Loss:  8.1373 |Global loss: 10.0833| Local H loss: 0.0216  | Global H loss: 0.0269 [0m
[94mEpoch: 2|  NKD Loss: 2.2468 | CT Loss: 5.3058| [0m
[91mEpoch: 2|  Loss:  8.0643 |Global loss: 10.0665| Local H loss: 0.0241  | Global H loss: 0.0297 [0m
[94mEpoch: 3|  NKD Loss: 2.2414 | CT Loss: 5.3019| [0m
[91mEpoch: 3|  Loss:  8.0279 |Global loss: 10.0605| Local H loss: 0.0259  | Global H loss: 0.0315 [0m
[94mEpoch: 0|  NKD Loss: 2.3011 | CT Loss: 5.3441| [0m
[91mEpoch: 0|  Loss:  9.6028 |Global loss: 10.1304| Local H loss: 0.0009  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.2989 | CT Loss: 5.3345| [0m
[91mEpoch: 1|  Loss:  9.4777 |Global loss: 10.1204| Local H loss: 0.0014  | Global H loss: 0.0016 [0m
[94mEpoch: 2|  NKD Loss: 2.2976 | CT Loss: 5.3263| [0m
[91mEpoch: 2|  Loss:  9.3318 |Global loss: 10.1111| Local H loss: 0.0021  | Global H loss: 0.0025 [0m
[94mEpoch: 3|  NKD Loss: 2.2982 | CT Loss: 5.3216| [0m
[91mEpoch: 3|  Loss:  9.2106 |Global loss: 10.1081| Local H loss: 0.0029  | Global H loss: 0.0035 [0m
[94mEpoch: 0|  NKD Loss: 2.3191 | CT Loss: 5.3949| [0m
[91mEpoch: 0|  Loss:  10.1472 |Global loss: 10.1986| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3101 | CT Loss: 5.3781| [0m
[91mEpoch: 1|  Loss:  9.9938 |Global loss: 10.1742| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.305 | CT Loss: 5.3667| [0m
[91mEpoch: 2|  Loss:  9.8611 |Global loss: 10.1572| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.301 | CT Loss: 5.3573| [0m
[91mEpoch: 3|  Loss:  9.7303 |Global loss: 10.1439| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.2989 | CT Loss: 5.3259| [0m
[91mEpoch: 0|  Loss:  9.5715 |Global loss: 10.111| Local H loss: 0.0009  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.2954 | CT Loss: 5.3195| [0m
[91mEpoch: 1|  Loss:  9.4389 |Global loss: 10.1017| Local H loss: 0.0013  | Global H loss: 0.0015 [0m
[94mEpoch: 2|  NKD Loss: 2.2916 | CT Loss: 5.3155| [0m
[91mEpoch: 2|  Loss:  9.2934 |Global loss: 10.0947| Local H loss: 0.0019  | Global H loss: 0.0022 [0m
[94mEpoch: 3|  NKD Loss: 2.2866 | CT Loss: 5.3104| [0m
[91mEpoch: 3|  Loss:  9.1394 |Global loss: 10.0848| Local H loss: 0.0027  | Global H loss: 0.0033 [0m
[94mEpoch: 0|  NKD Loss: 2.304 | CT Loss: 5.3486| [0m
[91mEpoch: 0|  Loss:  9.5881 |Global loss: 10.1387| Local H loss: 0.001  | Global H loss: 0.0011 [0m
[94mEpoch: 1|  NKD Loss: 2.3042 | CT Loss: 5.3417| [0m
[91mEpoch: 1|  Loss:  9.4592 |Global loss: 10.1318| Local H loss: 0.0015  | Global H loss: 0.0017 [0m
[94mEpoch: 2|  NKD Loss: 2.3071 | CT Loss: 5.335| [0m
[91mEpoch: 2|  Loss:  9.345 |Global loss: 10.1299| Local H loss: 0.0021  | Global H loss: 0.0024 [0m
[94mEpoch: 3|  NKD Loss: 2.3077 | CT Loss: 5.327| [0m
[91mEpoch: 3|  Loss:  9.2256 |Global loss: 10.1228| Local H loss: 0.0028  | Global H loss: 0.0032 [0m
------------------------- time cost ------------------------- 3.00948429107666
Chosen Clients:  [14, 9, 4, 6, 0, 11]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.775, 0.342, 0.908, 0.742, 0.4, 0.908, 0.683, 0.883, 0.967, 0.858, 0.183, 0.983, 0.692, 0.767, 0.975]
AUC in each clients:  [116.485, 95.333, 119.411, 116.517, 101.297, 119.368, 116.018, 116.404, 119.311, 118.474, 102.425, 119.616, 116.489, 116.394, 119.73]
F1 Score:  [0.761, 0.295, 0.922, 0.706, 0.309, 0.899, 0.668, 0.853, 0.962, 0.856, 0.102, 0.981, 0.688, 0.767, 0.973]
Recall Score:  [0.83, 0.435, 0.932, 0.785, 0.476, 0.908, 0.764, 0.9, 0.968, 0.894, 0.251, 0.984, 0.76, 0.824, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.8065
Averaged Test Accurancy: 0.7378
Averaged Test AUC: 0.9518
Averaged Test F1_score: 0.7161
Averaged Test Recal score: 0.7792
Std Test Accurancy: 0.2379
Std Test AUC: 0.0627
Std Test F1: 0.0022
Std Test Recall: 0.0018
[94mEpoch: 0|  NKD Loss: 2.236 | CT Loss: 5.3003| [0m
[91mEpoch: 0|  Loss:  7.9811 |Global loss: 10.0551| Local H loss: 0.028  | Global H loss: 0.0338 [0m
[94mEpoch: 1|  NKD Loss: 2.2348 | CT Loss: 5.2953| [0m
[91mEpoch: 1|  Loss:  7.9801 |Global loss: 10.0477| Local H loss: 0.0286  | Global H loss: 0.0343 [0m
[94mEpoch: 2|  NKD Loss: 2.2245 | CT Loss: 5.2911| [0m
[91mEpoch: 2|  Loss:  7.9277 |Global loss: 10.0371| Local H loss: 0.0309  | Global H loss: 0.0367 [0m
[94mEpoch: 3|  NKD Loss: 2.2148 | CT Loss: 5.2882| [0m
[91mEpoch: 3|  Loss:  7.8823 |Global loss: 10.0268| Local H loss: 0.0331  | Global H loss: 0.039 [0m
[94mEpoch: 0|  NKD Loss: 2.2754 | CT Loss: 5.3102| [0m
[91mEpoch: 0|  Loss:  8.8386 |Global loss: 10.0779| Local H loss: 0.005  | Global H loss: 0.0063 [0m
[94mEpoch: 1|  NKD Loss: 2.2712 | CT Loss: 5.3047| [0m
[91mEpoch: 1|  Loss:  8.6708 |Global loss: 10.0707| Local H loss: 0.0071  | Global H loss: 0.0091 [0m
[94mEpoch: 2|  NKD Loss: 2.2686 | CT Loss: 5.3012| [0m
[91mEpoch: 2|  Loss:  8.5427 |Global loss: 10.0671| Local H loss: 0.0093  | Global H loss: 0.0119 [0m
[94mEpoch: 3|  NKD Loss: 2.2652 | CT Loss: 5.2973| [0m
[91mEpoch: 3|  Loss:  8.4175 |Global loss: 10.0621| Local H loss: 0.0119  | Global H loss: 0.0153 [0m
[94mEpoch: 0|  NKD Loss: 2.3175 | CT Loss: 5.3911| [0m
[91mEpoch: 0|  Loss:  9.5317 |Global loss: 10.1947| Local H loss: 0.0019  | Global H loss: 0.002 [0m
[94mEpoch: 1|  NKD Loss: 2.3014 | CT Loss: 5.3641| [0m
[91mEpoch: 1|  Loss:  9.3652 |Global loss: 10.1536| Local H loss: 0.0021  | Global H loss: 0.0024 [0m
[94mEpoch: 2|  NKD Loss: 2.2941 | CT Loss: 5.3501| [0m
[91mEpoch: 2|  Loss:  9.2033 |Global loss: 10.1326| Local H loss: 0.0028  | Global H loss: 0.0032 [0m
[94mEpoch: 3|  NKD Loss: 2.2921 | CT Loss: 5.3417| [0m
[91mEpoch: 3|  Loss:  9.045 |Global loss: 10.1246| Local H loss: 0.004  | Global H loss: 0.0048 [0m
[94mEpoch: 0|  NKD Loss: 2.2972 | CT Loss: 5.3151| [0m
[91mEpoch: 0|  Loss:  9.0875 |Global loss: 10.1022| Local H loss: 0.0038  | Global H loss: 0.0046 [0m
[94mEpoch: 1|  NKD Loss: 2.2979 | CT Loss: 5.3106| [0m
[91mEpoch: 1|  Loss:  8.9649 |Global loss: 10.1007| Local H loss: 0.0048  | Global H loss: 0.0058 [0m
[94mEpoch: 2|  NKD Loss: 2.3007 | CT Loss: 5.306| [0m
[91mEpoch: 2|  Loss:  8.8536 |Global loss: 10.1002| Local H loss: 0.0062  | Global H loss: 0.0075 [0m
[94mEpoch: 3|  NKD Loss: 2.3008 | CT Loss: 5.3022| [0m
[91mEpoch: 3|  Loss:  8.7398 |Global loss: 10.0979| Local H loss: 0.0079  | Global H loss: 0.0095 [0m
[94mEpoch: 0|  NKD Loss: 2.2847 | CT Loss: 5.3073| [0m
[91mEpoch: 0|  Loss:  8.9841 |Global loss: 10.0813| Local H loss: 0.004  | Global H loss: 0.0049 [0m
[94mEpoch: 1|  NKD Loss: 2.2817 | CT Loss: 5.3038| [0m
[91mEpoch: 1|  Loss:  8.8318 |Global loss: 10.0756| Local H loss: 0.0054  | Global H loss: 0.0068 [0m
[94mEpoch: 2|  NKD Loss: 2.281 | CT Loss: 5.301| [0m
[91mEpoch: 2|  Loss:  8.7092 |Global loss: 10.0761| Local H loss: 0.0072  | Global H loss: 0.0092 [0m
[94mEpoch: 3|  NKD Loss: 2.2805 | CT Loss: 5.2974| [0m
[91mEpoch: 3|  Loss:  8.5984 |Global loss: 10.0759| Local H loss: 0.0092  | Global H loss: 0.0119 [0m
[94mEpoch: 0|  NKD Loss: 2.2968 | CT Loss: 5.3005| [0m
[91mEpoch: 0|  Loss:  8.5064 |Global loss: 10.0972| Local H loss: 0.0112  | Global H loss: 0.0139 [0m
[94mEpoch: 1|  NKD Loss: 2.2912 | CT Loss: 5.2967| [0m
[91mEpoch: 1|  Loss:  8.418 |Global loss: 10.0889| Local H loss: 0.0131  | Global H loss: 0.0163 [0m
[94mEpoch: 2|  NKD Loss: 2.2853 | CT Loss: 5.2939| [0m
[91mEpoch: 2|  Loss:  8.3462 |Global loss: 10.0811| Local H loss: 0.0148  | Global H loss: 0.0184 [0m
[94mEpoch: 3|  NKD Loss: 2.2805 | CT Loss: 5.2904| [0m
[91mEpoch: 3|  Loss:  8.287 |Global loss: 10.0774| Local H loss: 0.0165  | Global H loss: 0.0204 [0m
------------------------- time cost ------------------------- 2.927772045135498
Chosen Clients:  [9, 14, 6, 3, 4, 13]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.342, 0.908, 0.742, 0.858, 0.908, 0.833, 0.883, 0.967, 0.975, 0.183, 0.983, 0.692, 0.767, 0.975]
AUC in each clients:  [118.555, 95.333, 119.411, 116.517, 118.639, 119.368, 118.183, 116.404, 119.311, 119.432, 102.425, 119.727, 116.489, 116.394, 119.624]
F1 Score:  [0.92, 0.295, 0.922, 0.706, 0.819, 0.899, 0.824, 0.853, 0.962, 0.973, 0.102, 0.981, 0.688, 0.767, 0.975]
Recall Score:  [0.935, 0.435, 0.932, 0.785, 0.867, 0.908, 0.875, 0.9, 0.968, 0.977, 0.251, 0.984, 0.76, 0.824, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.6409
Averaged Test Accurancy: 0.7956
Averaged Test AUC: 0.9643
Averaged Test F1_score: 0.7791
Averaged Test Recal score: 0.8252
Std Test Accurancy: 0.2277
Std Test AUC: 0.0570
Std Test F1: 0.0021
Std Test Recall: 0.0017
[94mEpoch: 0|  NKD Loss: 2.2578 | CT Loss: 5.2932| [0m
[91mEpoch: 0|  Loss:  8.3076 |Global loss: 10.0553| Local H loss: 0.0148  | Global H loss: 0.0189 [0m
[94mEpoch: 1|  NKD Loss: 2.2515 | CT Loss: 5.2906| [0m
[91mEpoch: 1|  Loss:  8.2133 |Global loss: 10.0478| Local H loss: 0.0177  | Global H loss: 0.0223 [0m
[94mEpoch: 2|  NKD Loss: 2.2468 | CT Loss: 5.2876| [0m
[91mEpoch: 2|  Loss:  8.1457 |Global loss: 10.0445| Local H loss: 0.0202  | Global H loss: 0.0252 [0m
[94mEpoch: 3|  NKD Loss: 2.2397 | CT Loss: 5.285| [0m
[91mEpoch: 3|  Loss:  8.0756 |Global loss: 10.0375| Local H loss: 0.023  | Global H loss: 0.0282 [0m
[94mEpoch: 0|  NKD Loss: 2.2123 | CT Loss: 5.285| [0m
[91mEpoch: 0|  Loss:  7.8638 |Global loss: 10.0228| Local H loss: 0.035  | Global H loss: 0.0405 [0m
[94mEpoch: 1|  NKD Loss: 2.2104 | CT Loss: 5.2797| [0m
[91mEpoch: 1|  Loss:  7.8471 |Global loss: 10.0164| Local H loss: 0.0361  | Global H loss: 0.0414 [0m
[94mEpoch: 2|  NKD Loss: 2.2034 | CT Loss: 5.2752| [0m
[91mEpoch: 2|  Loss:  7.816 |Global loss: 10.0047| Local H loss: 0.0375  | Global H loss: 0.0428 [0m
[94mEpoch: 3|  NKD Loss: 2.1917 | CT Loss: 5.271| [0m
[91mEpoch: 3|  Loss:  7.7662 |Global loss: 9.9923| Local H loss: 0.0406  | Global H loss: 0.0458 [0m
[94mEpoch: 0|  NKD Loss: 2.3061 | CT Loss: 5.3| [0m
[91mEpoch: 0|  Loss:  8.6622 |Global loss: 10.1021| Local H loss: 0.0092  | Global H loss: 0.0111 [0m
[94mEpoch: 1|  NKD Loss: 2.3042 | CT Loss: 5.2964| [0m
[91mEpoch: 1|  Loss:  8.5877 |Global loss: 10.0975| Local H loss: 0.0106  | Global H loss: 0.0127 [0m
[94mEpoch: 2|  NKD Loss: 2.3077 | CT Loss: 5.2937| [0m
[91mEpoch: 2|  Loss:  8.5203 |Global loss: 10.0994| Local H loss: 0.0122  | Global H loss: 0.0147 [0m
[94mEpoch: 3|  NKD Loss: 2.3014 | CT Loss: 5.2888| [0m
[91mEpoch: 3|  Loss:  8.4591 |Global loss: 10.0898| Local H loss: 0.0131  | Global H loss: 0.0158 [0m
[94mEpoch: 0|  NKD Loss: 2.3187 | CT Loss: 5.3878| [0m
[91mEpoch: 0|  Loss:  9.0919 |Global loss: 10.1958| Local H loss: 0.0045  | Global H loss: 0.0052 [0m
[94mEpoch: 1|  NKD Loss: 2.3144 | CT Loss: 5.3718| [0m
[91mEpoch: 1|  Loss:  8.9606 |Global loss: 10.1755| Local H loss: 0.0054  | Global H loss: 0.0064 [0m
[94mEpoch: 2|  NKD Loss: 2.318 | CT Loss: 5.3579| [0m
[91mEpoch: 2|  Loss:  8.8682 |Global loss: 10.1676| Local H loss: 0.0065  | Global H loss: 0.0078 [0m
[94mEpoch: 3|  NKD Loss: 2.3089 | CT Loss: 5.3459| [0m
[91mEpoch: 3|  Loss:  8.7319 |Global loss: 10.1502| Local H loss: 0.0077  | Global H loss: 0.0095 [0m
[94mEpoch: 0|  NKD Loss: 2.2914 | CT Loss: 5.335| [0m
[91mEpoch: 0|  Loss:  8.8863 |Global loss: 10.119| Local H loss: 0.0055  | Global H loss: 0.0067 [0m
[94mEpoch: 1|  NKD Loss: 2.2957 | CT Loss: 5.3305| [0m
[91mEpoch: 1|  Loss:  8.7738 |Global loss: 10.1198| Local H loss: 0.0072  | Global H loss: 0.0088 [0m
[94mEpoch: 2|  NKD Loss: 2.2951 | CT Loss: 5.3256| [0m
[91mEpoch: 2|  Loss:  8.6695 |Global loss: 10.1167| Local H loss: 0.0086  | Global H loss: 0.0106 [0m
[94mEpoch: 3|  NKD Loss: 2.2946 | CT Loss: 5.3219| [0m
[91mEpoch: 3|  Loss:  8.5771 |Global loss: 10.1134| Local H loss: 0.0105  | Global H loss: 0.0128 [0m
[94mEpoch: 0|  NKD Loss: 2.3063 | CT Loss: 5.345| [0m
[91mEpoch: 0|  Loss:  9.1277 |Global loss: 10.1406| Local H loss: 0.0039  | Global H loss: 0.0047 [0m
[94mEpoch: 1|  NKD Loss: 2.3068 | CT Loss: 5.3374| [0m
[91mEpoch: 1|  Loss:  9.007 |Global loss: 10.135| Local H loss: 0.005  | Global H loss: 0.0061 [0m
[94mEpoch: 2|  NKD Loss: 2.308 | CT Loss: 5.3308| [0m
[91mEpoch: 2|  Loss:  8.8908 |Global loss: 10.131| Local H loss: 0.0065  | Global H loss: 0.0079 [0m
[94mEpoch: 3|  NKD Loss: 2.3093 | CT Loss: 5.3257| [0m
[91mEpoch: 3|  Loss:  8.8165 |Global loss: 10.128| Local H loss: 0.0075  | Global H loss: 0.0092 [0m
------------------------- time cost ------------------------- 3.126352071762085
Chosen Clients:  [14, 13, 1, 4, 6, 12]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.342, 0.908, 0.883, 0.908, 0.908, 0.975, 0.883, 0.967, 0.975, 0.183, 0.983, 0.692, 0.792, 0.975]
AUC in each clients:  [118.555, 95.333, 119.411, 119.064, 119.638, 119.368, 119.308, 116.404, 119.311, 119.479, 102.425, 119.727, 116.489, 118.033, 119.661]
F1 Score:  [0.92, 0.295, 0.922, 0.877, 0.868, 0.899, 0.974, 0.853, 0.962, 0.973, 0.102, 0.981, 0.688, 0.798, 0.975]
Recall Score:  [0.935, 0.435, 0.932, 0.902, 0.9, 0.908, 0.977, 0.9, 0.968, 0.977, 0.251, 0.984, 0.76, 0.845, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.5248
Averaged Test Accurancy: 0.8194
Averaged Test AUC: 0.9679
Averaged Test F1_score: 0.8058
Averaged Test Recal score: 0.8434
Std Test Accurancy: 0.2327
Std Test AUC: 0.0581
Std Test F1: 0.0021
Std Test Recall: 0.0017
[94mEpoch: 0|  NKD Loss: 2.1912 | CT Loss: 5.2658| [0m
[91mEpoch: 0|  Loss:  7.7582 |Global loss: 9.988| Local H loss: 0.0413  | Global H loss: 0.0462 [0m
[94mEpoch: 1|  NKD Loss: 2.1842 | CT Loss: 5.2622| [0m
[91mEpoch: 1|  Loss:  7.7297 |Global loss: 9.979| Local H loss: 0.0432  | Global H loss: 0.0479 [0m
[94mEpoch: 2|  NKD Loss: 2.1802 | CT Loss: 5.2575| [0m
[91mEpoch: 2|  Loss:  7.7084 |Global loss: 9.9718| Local H loss: 0.0451  | Global H loss: 0.0495 [0m
[94mEpoch: 3|  NKD Loss: 2.1732 | CT Loss: 5.2552| [0m
[91mEpoch: 3|  Loss:  7.6809 |Global loss: 9.964| Local H loss: 0.0471  | Global H loss: 0.0512 [0m
[94mEpoch: 0|  NKD Loss: 2.309 | CT Loss: 5.3213| [0m
[91mEpoch: 0|  Loss:  8.7464 |Global loss: 10.1258| Local H loss: 0.009  | Global H loss: 0.011 [0m
[94mEpoch: 1|  NKD Loss: 2.3085 | CT Loss: 5.3173| [0m
[91mEpoch: 1|  Loss:  8.6804 |Global loss: 10.1241| Local H loss: 0.01  | Global H loss: 0.0122 [0m
[94mEpoch: 2|  NKD Loss: 2.3024 | CT Loss: 5.3129| [0m
[91mEpoch: 2|  Loss:  8.5889 |Global loss: 10.1151| Local H loss: 0.0118  | Global H loss: 0.0144 [0m
[94mEpoch: 3|  NKD Loss: 2.3024 | CT Loss: 5.3074| [0m
[91mEpoch: 3|  Loss:  8.544 |Global loss: 10.1095| Local H loss: 0.0129  | Global H loss: 0.0156 [0m
[94mEpoch: 0|  NKD Loss: 2.3108 | CT Loss: 5.3437| [0m
[91mEpoch: 0|  Loss:  9.6276 |Global loss: 10.1414| Local H loss: 0.0011  | Global H loss: 0.0012 [0m
[94mEpoch: 1|  NKD Loss: 2.3076 | CT Loss: 5.3326| [0m
[91mEpoch: 1|  Loss:  9.5081 |Global loss: 10.1265| Local H loss: 0.0014  | Global H loss: 0.0015 [0m
[94mEpoch: 2|  NKD Loss: 2.307 | CT Loss: 5.3222| [0m
[91mEpoch: 2|  Loss:  9.3986 |Global loss: 10.1168| Local H loss: 0.0018  | Global H loss: 0.002 [0m
[94mEpoch: 3|  NKD Loss: 2.3069 | CT Loss: 5.3167| [0m
[91mEpoch: 3|  Loss:  9.2777 |Global loss: 10.1106| Local H loss: 0.0024  | Global H loss: 0.0027 [0m
[94mEpoch: 0|  NKD Loss: 2.2897 | CT Loss: 5.3158| [0m
[91mEpoch: 0|  Loss:  8.4728 |Global loss: 10.1055| Local H loss: 0.0128  | Global H loss: 0.0156 [0m
[94mEpoch: 1|  NKD Loss: 2.2829 | CT Loss: 5.3134| [0m
[91mEpoch: 1|  Loss:  8.3852 |Global loss: 10.0983| Local H loss: 0.0147  | Global H loss: 0.0179 [0m
[94mEpoch: 2|  NKD Loss: 2.2757 | CT Loss: 5.3072| [0m
[91mEpoch: 2|  Loss:  8.311 |Global loss: 10.0886| Local H loss: 0.0165  | Global H loss: 0.0202 [0m
[94mEpoch: 3|  NKD Loss: 2.2687 | CT Loss: 5.3036| [0m
[91mEpoch: 3|  Loss:  8.2428 |Global loss: 10.0804| Local H loss: 0.0184  | Global H loss: 0.0227 [0m
[94mEpoch: 0|  NKD Loss: 2.296 | CT Loss: 5.2858| [0m
[91mEpoch: 0|  Loss:  8.3785 |Global loss: 10.084| Local H loss: 0.0149  | Global H loss: 0.018 [0m
[94mEpoch: 1|  NKD Loss: 2.2912 | CT Loss: 5.2818| [0m
[91mEpoch: 1|  Loss:  8.33 |Global loss: 10.0764| Local H loss: 0.0165  | Global H loss: 0.0198 [0m
[94mEpoch: 2|  NKD Loss: 2.2932 | CT Loss: 5.2808| [0m
[91mEpoch: 2|  Loss:  8.3143 |Global loss: 10.0789| Local H loss: 0.0175  | Global H loss: 0.0209 [0m
[94mEpoch: 3|  NKD Loss: 2.2866 | CT Loss: 5.2764| [0m
[91mEpoch: 3|  Loss:  8.2506 |Global loss: 10.0703| Local H loss: 0.019  | Global H loss: 0.0226 [0m
[94mEpoch: 0|  NKD Loss: 2.31 | CT Loss: 5.3197| [0m
[91mEpoch: 0|  Loss:  9.086 |Global loss: 10.1189| Local H loss: 0.0039  | Global H loss: 0.0045 [0m
[94mEpoch: 1|  NKD Loss: 2.315 | CT Loss: 5.3148| [0m
[91mEpoch: 1|  Loss:  9.0223 |Global loss: 10.1191| Local H loss: 0.0045  | Global H loss: 0.0053 [0m
[94mEpoch: 2|  NKD Loss: 2.3146 | CT Loss: 5.3086| [0m
[91mEpoch: 2|  Loss:  8.9073 |Global loss: 10.113| Local H loss: 0.0057  | Global H loss: 0.0068 [0m
[94mEpoch: 3|  NKD Loss: 2.3154 | CT Loss: 5.3023| [0m
[91mEpoch: 3|  Loss:  8.8266 |Global loss: 10.1092| Local H loss: 0.0065  | Global H loss: 0.0078 [0m
------------------------- time cost ------------------------- 2.923947811126709
Chosen Clients:  [13, 11, 12, 3, 6, 0]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.792, 0.908, 0.883, 0.958, 0.908, 0.967, 0.883, 0.967, 0.975, 0.183, 0.983, 0.825, 0.825, 0.975]
AUC in each clients:  [118.555, 115.852, 119.411, 119.064, 119.771, 119.368, 119.103, 116.404, 119.311, 119.479, 102.425, 119.727, 118.239, 118.786, 119.341]
F1 Score:  [0.92, 0.749, 0.922, 0.877, 0.952, 0.899, 0.964, 0.853, 0.962, 0.973, 0.102, 0.981, 0.819, 0.827, 0.975]
Recall Score:  [0.935, 0.826, 0.932, 0.902, 0.956, 0.908, 0.968, 0.9, 0.968, 0.977, 0.251, 0.984, 0.877, 0.873, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.4113
Averaged Test Accurancy: 0.8633
Averaged Test AUC: 0.9805
Averaged Test F1_score: 0.8517
Averaged Test Recal score: 0.8823
Std Test Accurancy: 0.1911
Std Test AUC: 0.0352
Std Test F1: 0.0018
Std Test Recall: 0.0015
[94mEpoch: 0|  NKD Loss: 2.3002 | CT Loss: 5.3042| [0m
[91mEpoch: 0|  Loss:  8.4923 |Global loss: 10.1058| Local H loss: 0.0141  | Global H loss: 0.0171 [0m
[94mEpoch: 1|  NKD Loss: 2.2955 | CT Loss: 5.3001| [0m
[91mEpoch: 1|  Loss:  8.4375 |Global loss: 10.0985| Local H loss: 0.0154  | Global H loss: 0.0185 [0m
[94mEpoch: 2|  NKD Loss: 2.2891 | CT Loss: 5.2959| [0m
[91mEpoch: 2|  Loss:  8.3882 |Global loss: 10.0905| Local H loss: 0.0166  | Global H loss: 0.0199 [0m
[94mEpoch: 3|  NKD Loss: 2.2875 | CT Loss: 5.291| [0m
[91mEpoch: 3|  Loss:  8.3496 |Global loss: 10.0844| Local H loss: 0.0175  | Global H loss: 0.021 [0m
[94mEpoch: 0|  NKD Loss: 2.2755 | CT Loss: 5.2856| [0m
[91mEpoch: 0|  Loss:  8.2208 |Global loss: 10.0686| Local H loss: 0.0184  | Global H loss: 0.0227 [0m
[94mEpoch: 1|  NKD Loss: 2.2659 | CT Loss: 5.2823| [0m
[91mEpoch: 1|  Loss:  8.1576 |Global loss: 10.0569| Local H loss: 0.0205  | Global H loss: 0.0252 [0m
[94mEpoch: 2|  NKD Loss: 2.2621 | CT Loss: 5.2798| [0m
[91mEpoch: 2|  Loss:  8.1242 |Global loss: 10.0521| Local H loss: 0.0219  | Global H loss: 0.0266 [0m
[94mEpoch: 3|  NKD Loss: 2.2578 | CT Loss: 5.276| [0m
[91mEpoch: 3|  Loss:  8.078 |Global loss: 10.0479| Local H loss: 0.0236  | Global H loss: 0.0286 [0m
[94mEpoch: 0|  NKD Loss: 2.3163 | CT Loss: 5.2977| [0m
[91mEpoch: 0|  Loss:  8.7456 |Global loss: 10.1078| Local H loss: 0.0077  | Global H loss: 0.0093 [0m
[94mEpoch: 1|  NKD Loss: 2.316 | CT Loss: 5.2922| [0m
[91mEpoch: 1|  Loss:  8.6691 |Global loss: 10.1037| Local H loss: 0.0088  | Global H loss: 0.0108 [0m
[94mEpoch: 2|  NKD Loss: 2.3107 | CT Loss: 5.2875| [0m
[91mEpoch: 2|  Loss:  8.5926 |Global loss: 10.0959| Local H loss: 0.0099  | Global H loss: 0.0122 [0m
[94mEpoch: 3|  NKD Loss: 2.3083 | CT Loss: 5.2827| [0m
[91mEpoch: 3|  Loss:  8.528 |Global loss: 10.0887| Local H loss: 0.0112  | Global H loss: 0.0138 [0m
[94mEpoch: 0|  NKD Loss: 2.3113 | CT Loss: 5.337| [0m
[91mEpoch: 0|  Loss:  8.6578 |Global loss: 10.1436| Local H loss: 0.009  | Global H loss: 0.0112 [0m
[94mEpoch: 1|  NKD Loss: 2.3037 | CT Loss: 5.3268| [0m
[91mEpoch: 1|  Loss:  8.5421 |Global loss: 10.1275| Local H loss: 0.0108  | Global H loss: 0.0136 [0m
[94mEpoch: 2|  NKD Loss: 2.3077 | CT Loss: 5.3211| [0m
[91mEpoch: 2|  Loss:  8.5208 |Global loss: 10.1296| Local H loss: 0.0115  | Global H loss: 0.0145 [0m
[94mEpoch: 3|  NKD Loss: 2.2991 | CT Loss: 5.3143| [0m
[91mEpoch: 3|  Loss:  8.4289 |Global loss: 10.1148| Local H loss: 0.0133  | Global H loss: 0.0167 [0m
[94mEpoch: 0|  NKD Loss: 2.2849 | CT Loss: 5.274| [0m
[91mEpoch: 0|  Loss:  8.2251 |Global loss: 10.0672| Local H loss: 0.0199  | Global H loss: 0.0236 [0m
[94mEpoch: 1|  NKD Loss: 2.2732 | CT Loss: 5.2719| [0m
[91mEpoch: 1|  Loss:  8.1467 |Global loss: 10.0582| Local H loss: 0.0222  | Global H loss: 0.0263 [0m
[94mEpoch: 2|  NKD Loss: 2.2655 | CT Loss: 5.2678| [0m
[91mEpoch: 2|  Loss:  8.1165 |Global loss: 10.046| Local H loss: 0.0231  | Global H loss: 0.0274 [0m
[94mEpoch: 3|  NKD Loss: 2.2615 | CT Loss: 5.2666| [0m
[91mEpoch: 3|  Loss:  8.0709 |Global loss: 10.0419| Local H loss: 0.0245  | Global H loss: 0.029 [0m
[94mEpoch: 0|  NKD Loss: 2.2792 | CT Loss: 5.2929| [0m
[91mEpoch: 0|  Loss:  8.5057 |Global loss: 10.0733| Local H loss: 0.0113  | Global H loss: 0.0144 [0m
[94mEpoch: 1|  NKD Loss: 2.2766 | CT Loss: 5.2914| [0m
[91mEpoch: 1|  Loss:  8.4109 |Global loss: 10.0704| Local H loss: 0.0137  | Global H loss: 0.0174 [0m
[94mEpoch: 2|  NKD Loss: 2.2776 | CT Loss: 5.2885| [0m
[91mEpoch: 2|  Loss:  8.3601 |Global loss: 10.0697| Local H loss: 0.0157  | Global H loss: 0.0196 [0m
[94mEpoch: 3|  NKD Loss: 2.278 | CT Loss: 5.2849| [0m
[91mEpoch: 3|  Loss:  8.3049 |Global loss: 10.0694| Local H loss: 0.0175  | Global H loss: 0.0217 [0m
------------------------- time cost ------------------------- 2.87725830078125
Chosen Clients:  [1, 9, 2, 4, 14, 8]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.792, 0.908, 0.983, 0.958, 0.908, 0.958, 0.883, 0.967, 0.975, 0.183, 0.983, 0.842, 0.85, 0.975]
AUC in each clients:  [119.075, 115.852, 119.411, 119.542, 119.771, 119.368, 119.266, 116.404, 119.311, 119.479, 102.425, 119.737, 119.045, 119.336, 119.341]
F1 Score:  [0.974, 0.749, 0.922, 0.981, 0.952, 0.899, 0.954, 0.853, 0.962, 0.973, 0.102, 0.981, 0.852, 0.84, 0.975]
Recall Score:  [0.977, 0.826, 0.932, 0.984, 0.956, 0.908, 0.958, 0.9, 0.968, 0.977, 0.251, 0.984, 0.888, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.3206
Averaged Test Accurancy: 0.8761
Averaged Test AUC: 0.9819
Averaged Test F1_score: 0.8646
Averaged Test Recal score: 0.8920
Std Test Accurancy: 0.1941
Std Test AUC: 0.0356
Std Test F1: 0.0018
Std Test Recall: 0.0015
[94mEpoch: 0|  NKD Loss: 2.3075 | CT Loss: 5.3137| [0m
[91mEpoch: 0|  Loss:  9.1507 |Global loss: 10.1082| Local H loss: 0.0032  | Global H loss: 0.0037 [0m
[94mEpoch: 1|  NKD Loss: 2.3063 | CT Loss: 5.3078| [0m
[91mEpoch: 1|  Loss:  9.0324 |Global loss: 10.1014| Local H loss: 0.004  | Global H loss: 0.0047 [0m
[94mEpoch: 2|  NKD Loss: 2.3047 | CT Loss: 5.3034| [0m
[91mEpoch: 2|  Loss:  8.9229 |Global loss: 10.0985| Local H loss: 0.0049  | Global H loss: 0.006 [0m
[94mEpoch: 3|  NKD Loss: 2.3046 | CT Loss: 5.3009| [0m
[91mEpoch: 3|  Loss:  8.8297 |Global loss: 10.0978| Local H loss: 0.006  | Global H loss: 0.0073 [0m
[94mEpoch: 0|  NKD Loss: 2.2346 | CT Loss: 5.2815| [0m
[91mEpoch: 0|  Loss:  8.0296 |Global loss: 10.0324| Local H loss: 0.0253  | Global H loss: 0.0307 [0m
[94mEpoch: 1|  NKD Loss: 2.2303 | CT Loss: 5.2792| [0m
[91mEpoch: 1|  Loss:  7.9808 |Global loss: 10.026| Local H loss: 0.0277  | Global H loss: 0.0332 [0m
[94mEpoch: 2|  NKD Loss: 2.2218 | CT Loss: 5.2766| [0m
[91mEpoch: 2|  Loss:  7.923 |Global loss: 10.0208| Local H loss: 0.0307  | Global H loss: 0.0363 [0m
[94mEpoch: 3|  NKD Loss: 2.216 | CT Loss: 5.2734| [0m
[91mEpoch: 3|  Loss:  7.8854 |Global loss: 10.0142| Local H loss: 0.0332  | Global H loss: 0.0386 [0m
[94mEpoch: 0|  NKD Loss: 2.2901 | CT Loss: 5.2889| [0m
[91mEpoch: 0|  Loss:  8.3879 |Global loss: 10.0829| Local H loss: 0.0154  | Global H loss: 0.0187 [0m
[94mEpoch: 1|  NKD Loss: 2.2859 | CT Loss: 5.2844| [0m
[91mEpoch: 1|  Loss:  8.328 |Global loss: 10.0756| Local H loss: 0.0169  | Global H loss: 0.0204 [0m
[94mEpoch: 2|  NKD Loss: 2.2845 | CT Loss: 5.2808| [0m
[91mEpoch: 2|  Loss:  8.3093 |Global loss: 10.0724| Local H loss: 0.0177  | Global H loss: 0.0213 [0m
[94mEpoch: 3|  NKD Loss: 2.2794 | CT Loss: 5.2773| [0m
[91mEpoch: 3|  Loss:  8.2573 |Global loss: 10.064| Local H loss: 0.0191  | Global H loss: 0.0227 [0m
[94mEpoch: 0|  NKD Loss: 2.2598 | CT Loss: 5.3| [0m
[91mEpoch: 0|  Loss:  8.1891 |Global loss: 10.0686| Local H loss: 0.0204  | Global H loss: 0.0249 [0m
[94mEpoch: 1|  NKD Loss: 2.2493 | CT Loss: 5.296| [0m
[91mEpoch: 1|  Loss:  8.1184 |Global loss: 10.0585| Local H loss: 0.0227  | Global H loss: 0.0277 [0m
[94mEpoch: 2|  NKD Loss: 2.2464 | CT Loss: 5.2921| [0m
[91mEpoch: 2|  Loss:  8.0904 |Global loss: 10.0541| Local H loss: 0.0241  | Global H loss: 0.0293 [0m
[94mEpoch: 3|  NKD Loss: 2.2398 | CT Loss: 5.2878| [0m
[91mEpoch: 3|  Loss:  8.0497 |Global loss: 10.044| Local H loss: 0.0261  | Global H loss: 0.0314 [0m
[94mEpoch: 0|  NKD Loss: 2.1727 | CT Loss: 5.2543| [0m
[91mEpoch: 0|  Loss:  7.6777 |Global loss: 9.9644| Local H loss: 0.0476  | Global H loss: 0.0514 [0m
[94mEpoch: 1|  NKD Loss: 2.1859 | CT Loss: 5.251| [0m
[91mEpoch: 1|  Loss:  7.7084 |Global loss: 9.9707| Local H loss: 0.0466  | Global H loss: 0.0501 [0m
[94mEpoch: 2|  NKD Loss: 2.1722 | CT Loss: 5.2485| [0m
[91mEpoch: 2|  Loss:  7.6657 |Global loss: 9.9569| Local H loss: 0.0493  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.1604 | CT Loss: 5.2442| [0m
[91mEpoch: 3|  Loss:  7.627 |Global loss: 9.9442| Local H loss: 0.0528  | Global H loss: 0.0552 [0m
[94mEpoch: 0|  NKD Loss: 2.2977 | CT Loss: 5.3121| [0m
[91mEpoch: 0|  Loss:  8.5655 |Global loss: 10.1076| Local H loss: 0.0107  | Global H loss: 0.0131 [0m
[94mEpoch: 1|  NKD Loss: 2.295 | CT Loss: 5.3083| [0m
[91mEpoch: 1|  Loss:  8.4956 |Global loss: 10.1037| Local H loss: 0.0121  | Global H loss: 0.0148 [0m
[94mEpoch: 2|  NKD Loss: 2.2987 | CT Loss: 5.3046| [0m
[91mEpoch: 2|  Loss:  8.4482 |Global loss: 10.1056| Local H loss: 0.0137  | Global H loss: 0.0167 [0m
[94mEpoch: 3|  NKD Loss: 2.2884 | CT Loss: 5.301| [0m
[91mEpoch: 3|  Loss:  8.3619 |Global loss: 10.0958| Local H loss: 0.0153  | Global H loss: 0.0187 [0m
------------------------- time cost ------------------------- 2.886723279953003
Chosen Clients:  [7, 4, 9, 5, 1, 12]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.825, 0.858, 0.983, 0.933, 0.908, 0.958, 0.883, 0.975, 0.975, 0.183, 0.983, 0.842, 0.85, 0.975]
AUC in each clients:  [119.075, 118.802, 119.336, 119.542, 119.818, 119.368, 119.266, 116.404, 119.517, 119.467, 102.425, 119.737, 119.045, 119.336, 119.227]
F1 Score:  [0.974, 0.79, 0.87, 0.981, 0.917, 0.899, 0.954, 0.853, 0.973, 0.973, 0.102, 0.981, 0.852, 0.84, 0.975]
Recall Score:  [0.977, 0.849, 0.899, 0.984, 0.928, 0.908, 0.958, 0.9, 0.977, 0.977, 0.251, 0.984, 0.888, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.2395
Averaged Test Accurancy: 0.8739
Averaged Test AUC: 0.9835
Averaged Test F1_score: 0.8623
Averaged Test Recal score: 0.8901
Std Test Accurancy: 0.1929
Std Test AUC: 0.0353
Std Test F1: 0.0018
Std Test Recall: 0.0015
[94mEpoch: 0|  NKD Loss: 2.2959 | CT Loss: 5.3336| [0m
[91mEpoch: 0|  Loss:  9.0373 |Global loss: 10.1193| Local H loss: 0.0042  | Global H loss: 0.0051 [0m
[94mEpoch: 1|  NKD Loss: 2.2953 | CT Loss: 5.3274| [0m
[91mEpoch: 1|  Loss:  8.9321 |Global loss: 10.1154| Local H loss: 0.0052  | Global H loss: 0.0064 [0m
[94mEpoch: 2|  NKD Loss: 2.2922 | CT Loss: 5.321| [0m
[91mEpoch: 2|  Loss:  8.8064 |Global loss: 10.1075| Local H loss: 0.0067  | Global H loss: 0.0083 [0m
[94mEpoch: 3|  NKD Loss: 2.2922 | CT Loss: 5.3157| [0m
[91mEpoch: 3|  Loss:  8.6904 |Global loss: 10.1042| Local H loss: 0.0085  | Global H loss: 0.0105 [0m
[94mEpoch: 0|  NKD Loss: 2.2272 | CT Loss: 5.2845| [0m
[91mEpoch: 0|  Loss:  7.9867 |Global loss: 10.0308| Local H loss: 0.029  | Global H loss: 0.0345 [0m
[94mEpoch: 1|  NKD Loss: 2.23 | CT Loss: 5.282| [0m
[91mEpoch: 1|  Loss:  7.9851 |Global loss: 10.031| Local H loss: 0.0298  | Global H loss: 0.035 [0m
[94mEpoch: 2|  NKD Loss: 2.2197 | CT Loss: 5.2795| [0m
[91mEpoch: 2|  Loss:  7.9424 |Global loss: 10.0206| Local H loss: 0.0321  | Global H loss: 0.0373 [0m
[94mEpoch: 3|  NKD Loss: 2.2173 | CT Loss: 5.2762| [0m
[91mEpoch: 3|  Loss:  7.9285 |Global loss: 10.0148| Local H loss: 0.0334  | Global H loss: 0.0384 [0m
[94mEpoch: 0|  NKD Loss: 2.2138 | CT Loss: 5.2706| [0m
[91mEpoch: 0|  Loss:  7.8586 |Global loss: 10.0099| Local H loss: 0.0344  | Global H loss: 0.0399 [0m
[94mEpoch: 1|  NKD Loss: 2.2062 | CT Loss: 5.2679| [0m
[91mEpoch: 1|  Loss:  7.8226 |Global loss: 10.0021| Local H loss: 0.0375  | Global H loss: 0.0424 [0m
[94mEpoch: 2|  NKD Loss: 2.2052 | CT Loss: 5.2654| [0m
[91mEpoch: 2|  Loss:  7.8066 |Global loss: 9.9983| Local H loss: 0.038  | Global H loss: 0.0431 [0m
[94mEpoch: 3|  NKD Loss: 2.2001 | CT Loss: 5.2628| [0m
[91mEpoch: 3|  Loss:  7.7851 |Global loss: 9.9925| Local H loss: 0.0398  | Global H loss: 0.0446 [0m
[94mEpoch: 0|  NKD Loss: 2.3094 | CT Loss: 5.3048| [0m
[91mEpoch: 0|  Loss:  8.449 |Global loss: 10.1151| Local H loss: 0.0137  | Global H loss: 0.0172 [0m
[94mEpoch: 1|  NKD Loss: 2.3012 | CT Loss: 5.2999| [0m
[91mEpoch: 1|  Loss:  8.405 |Global loss: 10.1046| Local H loss: 0.0145  | Global H loss: 0.0182 [0m
[94mEpoch: 2|  NKD Loss: 2.2956 | CT Loss: 5.2961| [0m
[91mEpoch: 2|  Loss:  8.3592 |Global loss: 10.096| Local H loss: 0.0157  | Global H loss: 0.0197 [0m
[94mEpoch: 3|  NKD Loss: 2.2914 | CT Loss: 5.294| [0m
[91mEpoch: 3|  Loss:  8.3246 |Global loss: 10.0926| Local H loss: 0.0167  | Global H loss: 0.0207 [0m
[94mEpoch: 0|  NKD Loss: 2.3035 | CT Loss: 5.2983| [0m
[91mEpoch: 0|  Loss:  8.7357 |Global loss: 10.0962| Local H loss: 0.0071  | Global H loss: 0.0088 [0m
[94mEpoch: 1|  NKD Loss: 2.2947 | CT Loss: 5.2941| [0m
[91mEpoch: 1|  Loss:  8.6116 |Global loss: 10.086| Local H loss: 0.0088  | Global H loss: 0.0111 [0m
[94mEpoch: 2|  NKD Loss: 2.2911 | CT Loss: 5.2921| [0m
[91mEpoch: 2|  Loss:  8.5169 |Global loss: 10.0819| Local H loss: 0.0105  | Global H loss: 0.0133 [0m
[94mEpoch: 3|  NKD Loss: 2.2855 | CT Loss: 5.2883| [0m
[91mEpoch: 3|  Loss:  8.4537 |Global loss: 10.0739| Local H loss: 0.0118  | Global H loss: 0.015 [0m
[94mEpoch: 0|  NKD Loss: 2.3035 | CT Loss: 5.281| [0m
[91mEpoch: 0|  Loss:  8.4588 |Global loss: 10.0862| Local H loss: 0.0127  | Global H loss: 0.0158 [0m
[94mEpoch: 1|  NKD Loss: 2.2996 | CT Loss: 5.2762| [0m
[91mEpoch: 1|  Loss:  8.405 |Global loss: 10.0778| Local H loss: 0.0136  | Global H loss: 0.017 [0m
[94mEpoch: 2|  NKD Loss: 2.2902 | CT Loss: 5.2715| [0m
[91mEpoch: 2|  Loss:  8.3238 |Global loss: 10.0656| Local H loss: 0.0154  | Global H loss: 0.0192 [0m
[94mEpoch: 3|  NKD Loss: 2.2907 | CT Loss: 5.2693| [0m
[91mEpoch: 3|  Loss:  8.2898 |Global loss: 10.0665| Local H loss: 0.0166  | Global H loss: 0.0206 [0m
------------------------- time cost ------------------------- 3.003695011138916
Chosen Clients:  [7, 13, 0, 6, 1, 5]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.917, 0.858, 0.983, 0.95, 0.942, 0.958, 0.975, 0.975, 0.975, 0.183, 0.983, 0.858, 0.85, 0.975]
AUC in each clients:  [119.075, 119.738, 119.336, 119.542, 119.829, 119.648, 119.266, 118.978, 119.517, 119.357, 102.425, 119.737, 119.451, 119.336, 119.227]
F1 Score:  [0.974, 0.878, 0.87, 0.981, 0.941, 0.936, 0.954, 0.973, 0.973, 0.973, 0.102, 0.981, 0.87, 0.84, 0.975]
Recall Score:  [0.977, 0.91, 0.899, 0.984, 0.947, 0.94, 0.958, 0.977, 0.977, 0.977, 0.251, 0.984, 0.899, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.1491
Averaged Test Accurancy: 0.8906
Averaged Test AUC: 0.9858
Averaged Test F1_score: 0.8814
Averaged Test Recal score: 0.9034
Std Test Accurancy: 0.1946
Std Test AUC: 0.0354
Std Test F1: 0.0018
Std Test Recall: 0.0015
[94mEpoch: 0|  NKD Loss: 2.2908 | CT Loss: 5.3096| [0m
[91mEpoch: 0|  Loss:  8.593 |Global loss: 10.0998| Local H loss: 0.0101  | Global H loss: 0.0126 [0m
[94mEpoch: 1|  NKD Loss: 2.2893 | CT Loss: 5.3062| [0m
[91mEpoch: 1|  Loss:  8.527 |Global loss: 10.0961| Local H loss: 0.0119  | Global H loss: 0.0147 [0m
[94mEpoch: 2|  NKD Loss: 2.2927 | CT Loss: 5.2994| [0m
[91mEpoch: 2|  Loss:  8.4619 |Global loss: 10.0936| Local H loss: 0.0131  | Global H loss: 0.0162 [0m
[94mEpoch: 3|  NKD Loss: 2.2817 | CT Loss: 5.2922| [0m
[91mEpoch: 3|  Loss:  8.3566 |Global loss: 10.077| Local H loss: 0.0156  | Global H loss: 0.0191 [0m
[94mEpoch: 0|  NKD Loss: 2.2849 | CT Loss: 5.2886| [0m
[91mEpoch: 0|  Loss:  8.3207 |Global loss: 10.0825| Local H loss: 0.0186  | Global H loss: 0.0222 [0m
[94mEpoch: 1|  NKD Loss: 2.2751 | CT Loss: 5.2856| [0m
[91mEpoch: 1|  Loss:  8.2619 |Global loss: 10.0697| Local H loss: 0.0202  | Global H loss: 0.024 [0m
[94mEpoch: 2|  NKD Loss: 2.2684 | CT Loss: 5.2815| [0m
[91mEpoch: 2|  Loss:  8.2019 |Global loss: 10.0638| Local H loss: 0.0221  | Global H loss: 0.0264 [0m
[94mEpoch: 3|  NKD Loss: 2.2636 | CT Loss: 5.2784| [0m
[91mEpoch: 3|  Loss:  8.1642 |Global loss: 10.0543| Local H loss: 0.0235  | Global H loss: 0.0277 [0m
[94mEpoch: 0|  NKD Loss: 2.2728 | CT Loss: 5.281| [0m
[91mEpoch: 0|  Loss:  8.2511 |Global loss: 10.0626| Local H loss: 0.0198  | Global H loss: 0.0241 [0m
[94mEpoch: 1|  NKD Loss: 2.2703 | CT Loss: 5.2786| [0m
[91mEpoch: 1|  Loss:  8.2072 |Global loss: 10.0608| Local H loss: 0.0216  | Global H loss: 0.0259 [0m
[94mEpoch: 2|  NKD Loss: 2.2677 | CT Loss: 5.2745| [0m
[91mEpoch: 2|  Loss:  8.1828 |Global loss: 10.055| Local H loss: 0.0229  | Global H loss: 0.0272 [0m
[94mEpoch: 3|  NKD Loss: 2.2624 | CT Loss: 5.2707| [0m
[91mEpoch: 3|  Loss:  8.1354 |Global loss: 10.0469| Local H loss: 0.0247  | Global H loss: 0.029 [0m
[94mEpoch: 0|  NKD Loss: 2.2562 | CT Loss: 5.2615| [0m
[91mEpoch: 0|  Loss:  8.0468 |Global loss: 10.0309| Local H loss: 0.0258  | Global H loss: 0.0301 [0m
[94mEpoch: 1|  NKD Loss: 2.2548 | CT Loss: 5.2601| [0m
[91mEpoch: 1|  Loss:  8.0281 |Global loss: 10.0306| Local H loss: 0.0264  | Global H loss: 0.0309 [0m
[94mEpoch: 2|  NKD Loss: 2.2463 | CT Loss: 5.2568| [0m
[91mEpoch: 2|  Loss:  7.9791 |Global loss: 10.0202| Local H loss: 0.0282  | Global H loss: 0.0329 [0m
[94mEpoch: 3|  NKD Loss: 2.24 | CT Loss: 5.2545| [0m
[91mEpoch: 3|  Loss:  7.9418 |Global loss: 10.0141| Local H loss: 0.03  | Global H loss: 0.0348 [0m
[94mEpoch: 0|  NKD Loss: 2.2796 | CT Loss: 5.2853| [0m
[91mEpoch: 0|  Loss:  8.3687 |Global loss: 10.0681| Local H loss: 0.0137  | Global H loss: 0.0174 [0m
[94mEpoch: 1|  NKD Loss: 2.2679 | CT Loss: 5.2829| [0m
[91mEpoch: 1|  Loss:  8.2915 |Global loss: 10.0553| Local H loss: 0.0156  | Global H loss: 0.0198 [0m
[94mEpoch: 2|  NKD Loss: 2.2643 | CT Loss: 5.2802| [0m
[91mEpoch: 2|  Loss:  8.2317 |Global loss: 10.0518| Local H loss: 0.0173  | Global H loss: 0.0219 [0m
[94mEpoch: 3|  NKD Loss: 2.2553 | CT Loss: 5.2769| [0m
[91mEpoch: 3|  Loss:  8.1626 |Global loss: 10.0424| Local H loss: 0.0196  | Global H loss: 0.0246 [0m
[94mEpoch: 0|  NKD Loss: 2.2794 | CT Loss: 5.2888| [0m
[91mEpoch: 0|  Loss:  8.2513 |Global loss: 10.0759| Local H loss: 0.0188  | Global H loss: 0.0233 [0m
[94mEpoch: 1|  NKD Loss: 2.2763 | CT Loss: 5.2858| [0m
[91mEpoch: 1|  Loss:  8.2237 |Global loss: 10.0707| Local H loss: 0.0194  | Global H loss: 0.024 [0m
[94mEpoch: 2|  NKD Loss: 2.2749 | CT Loss: 5.2828| [0m
[91mEpoch: 2|  Loss:  8.203 |Global loss: 10.0672| Local H loss: 0.0206  | Global H loss: 0.0251 [0m
[94mEpoch: 3|  NKD Loss: 2.2695 | CT Loss: 5.28| [0m
[91mEpoch: 3|  Loss:  8.1628 |Global loss: 10.0625| Local H loss: 0.0223  | Global H loss: 0.027 [0m
------------------------- time cost ------------------------- 2.9124677181243896
Chosen Clients:  [6, 10, 2, 12, 13, 9]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.858, 0.983, 0.95, 0.967, 0.975, 0.975, 0.975, 0.975, 0.183, 0.983, 0.858, 0.85, 0.975]
AUC in each clients:  [118.989, 119.843, 119.336, 119.542, 119.829, 119.673, 119.346, 119.203, 119.517, 119.357, 102.425, 119.737, 119.451, 119.423, 119.227]
F1 Score:  [0.974, 0.973, 0.87, 0.981, 0.941, 0.967, 0.974, 0.973, 0.973, 0.973, 0.102, 0.981, 0.87, 0.84, 0.975]
Recall Score:  [0.977, 0.977, 0.899, 0.984, 0.947, 0.971, 0.977, 0.977, 0.977, 0.977, 0.251, 0.984, 0.899, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.0797
Averaged Test Accurancy: 0.8972
Averaged Test AUC: 0.9861
Averaged Test F1_score: 0.8911
Averaged Test Recal score: 0.9112
Std Test Accurancy: 0.1966
Std Test AUC: 0.0355
Std Test F1: 0.0018
Std Test Recall: 0.0015
[94mEpoch: 0|  NKD Loss: 2.2316 | CT Loss: 5.2501| [0m
[91mEpoch: 0|  Loss:  7.9023 |Global loss: 10.0039| Local H loss: 0.0317  | Global H loss: 0.0365 [0m
[94mEpoch: 1|  NKD Loss: 2.2271 | CT Loss: 5.2472| [0m
[91mEpoch: 1|  Loss:  7.8809 |Global loss: 9.9965| Local H loss: 0.033  | Global H loss: 0.0377 [0m
[94mEpoch: 2|  NKD Loss: 2.2199 | CT Loss: 5.2464| [0m
[91mEpoch: 2|  Loss:  7.8399 |Global loss: 9.9924| Local H loss: 0.0349  | Global H loss: 0.0397 [0m
[94mEpoch: 3|  NKD Loss: 2.2142 | CT Loss: 5.2415| [0m
[91mEpoch: 3|  Loss:  7.8158 |Global loss: 9.981| Local H loss: 0.0361  | Global H loss: 0.0409 [0m
[94mEpoch: 0|  NKD Loss: 2.2965 | CT Loss: 5.3507| [0m
[91mEpoch: 0|  Loss:  9.6017 |Global loss: 10.1354| Local H loss: 0.0008  | Global H loss: 0.0009 [0m
[94mEpoch: 1|  NKD Loss: 2.2942 | CT Loss: 5.3448| [0m
[91mEpoch: 1|  Loss:  9.4696 |Global loss: 10.1253| Local H loss: 0.0013  | Global H loss: 0.0014 [0m
[94mEpoch: 2|  NKD Loss: 2.293 | CT Loss: 5.3395| [0m
[91mEpoch: 2|  Loss:  9.3279 |Global loss: 10.1191| Local H loss: 0.0019  | Global H loss: 0.0022 [0m
[94mEpoch: 3|  NKD Loss: 2.294 | CT Loss: 5.3331| [0m
[91mEpoch: 3|  Loss:  9.1922 |Global loss: 10.1163| Local H loss: 0.0029  | Global H loss: 0.0034 [0m
[94mEpoch: 0|  NKD Loss: 2.2748 | CT Loss: 5.2749| [0m
[91mEpoch: 0|  Loss:  8.2138 |Global loss: 10.0594| Local H loss: 0.021  | Global H loss: 0.0248 [0m
[94mEpoch: 1|  NKD Loss: 2.2706 | CT Loss: 5.2703| [0m
[91mEpoch: 1|  Loss:  8.1854 |Global loss: 10.0517| Local H loss: 0.022  | Global H loss: 0.0258 [0m
[94mEpoch: 2|  NKD Loss: 2.2623 | CT Loss: 5.2677| [0m
[91mEpoch: 2|  Loss:  8.1345 |Global loss: 10.0426| Local H loss: 0.023  | Global H loss: 0.0268 [0m
[94mEpoch: 3|  NKD Loss: 2.2645 | CT Loss: 5.2646| [0m
[91mEpoch: 3|  Loss:  8.119 |Global loss: 10.0427| Local H loss: 0.0242  | Global H loss: 0.028 [0m
[94mEpoch: 0|  NKD Loss: 2.2916 | CT Loss: 5.2675| [0m
[91mEpoch: 0|  Loss:  8.3 |Global loss: 10.064| Local H loss: 0.0166  | Global H loss: 0.0207 [0m
[94mEpoch: 1|  NKD Loss: 2.2815 | CT Loss: 5.2647| [0m
[91mEpoch: 1|  Loss:  8.2328 |Global loss: 10.0539| Local H loss: 0.0179  | Global H loss: 0.0223 [0m
[94mEpoch: 2|  NKD Loss: 2.2676 | CT Loss: 5.2592| [0m
[91mEpoch: 2|  Loss:  8.1508 |Global loss: 10.0364| Local H loss: 0.0202  | Global H loss: 0.025 [0m
[94mEpoch: 3|  NKD Loss: 2.2667 | CT Loss: 5.259| [0m
[91mEpoch: 3|  Loss:  8.1349 |Global loss: 10.0373| Local H loss: 0.0212  | Global H loss: 0.0261 [0m
[94mEpoch: 0|  NKD Loss: 2.2596 | CT Loss: 5.2758| [0m
[91mEpoch: 0|  Loss:  8.1442 |Global loss: 10.0491| Local H loss: 0.0247  | Global H loss: 0.029 [0m
[94mEpoch: 1|  NKD Loss: 2.2502 | CT Loss: 5.2734| [0m
[91mEpoch: 1|  Loss:  8.0855 |Global loss: 10.0395| Local H loss: 0.0267  | Global H loss: 0.0312 [0m
[94mEpoch: 2|  NKD Loss: 2.2498 | CT Loss: 5.2716| [0m
[91mEpoch: 2|  Loss:  8.0912 |Global loss: 10.0383| Local H loss: 0.0269  | Global H loss: 0.0313 [0m
[94mEpoch: 3|  NKD Loss: 2.2477 | CT Loss: 5.2695| [0m
[91mEpoch: 3|  Loss:  8.0705 |Global loss: 10.0342| Local H loss: 0.0275  | Global H loss: 0.0321 [0m
[94mEpoch: 0|  NKD Loss: 2.1937 | CT Loss: 5.2609| [0m
[91mEpoch: 0|  Loss:  7.7557 |Global loss: 9.9856| Local H loss: 0.0419  | Global H loss: 0.0465 [0m
[94mEpoch: 1|  NKD Loss: 2.1881 | CT Loss: 5.2566| [0m
[91mEpoch: 1|  Loss:  7.7259 |Global loss: 9.9795| Local H loss: 0.0441  | Global H loss: 0.0485 [0m
[94mEpoch: 2|  NKD Loss: 2.1887 | CT Loss: 5.2551| [0m
[91mEpoch: 2|  Loss:  7.7179 |Global loss: 9.9763| Local H loss: 0.0451  | Global H loss: 0.0493 [0m
[94mEpoch: 3|  NKD Loss: 2.183 | CT Loss: 5.2525| [0m
[91mEpoch: 3|  Loss:  7.7018 |Global loss: 9.9711| Local H loss: 0.0463  | Global H loss: 0.0502 [0m
------------------------- time cost ------------------------- 2.8536794185638428
Chosen Clients:  [13, 0, 7, 3, 12, 11]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.95, 0.967, 0.975, 0.975, 0.975, 0.975, 0.725, 0.983, 0.917, 0.858, 0.975]
AUC in each clients:  [118.989, 119.843, 119.633, 119.542, 119.829, 119.673, 119.46, 119.203, 119.517, 119.664, 117.309, 119.737, 119.579, 119.6, 119.227]
F1 Score:  [0.974, 0.973, 0.973, 0.981, 0.941, 0.967, 0.974, 0.973, 0.973, 0.973, 0.723, 0.981, 0.929, 0.851, 0.975]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.947, 0.971, 0.977, 0.977, 0.977, 0.977, 0.807, 0.984, 0.938, 0.899, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.9975
Averaged Test Accurancy: 0.9456
Averaged Test AUC: 0.9949
Averaged Test F1_score: 0.9441
Averaged Test Recal score: 0.9564
Std Test Accurancy: 0.0670
Std Test AUC: 0.0050
Std Test F1: 0.0006
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.2408 | CT Loss: 5.2659| [0m
[91mEpoch: 0|  Loss:  8.0333 |Global loss: 10.0247| Local H loss: 0.0296  | Global H loss: 0.0339 [0m
[94mEpoch: 1|  NKD Loss: 2.2353 | CT Loss: 5.2637| [0m
[91mEpoch: 1|  Loss:  8.009 |Global loss: 10.0184| Local H loss: 0.0304  | Global H loss: 0.0349 [0m
[94mEpoch: 2|  NKD Loss: 2.2299 | CT Loss: 5.2621| [0m
[91mEpoch: 2|  Loss:  7.9785 |Global loss: 10.0127| Local H loss: 0.0321  | Global H loss: 0.0364 [0m
[94mEpoch: 3|  NKD Loss: 2.2216 | CT Loss: 5.2582| [0m
[91mEpoch: 3|  Loss:  7.9427 |Global loss: 10.0028| Local H loss: 0.0339  | Global H loss: 0.0382 [0m
[94mEpoch: 0|  NKD Loss: 2.2583 | CT Loss: 5.2684| [0m
[91mEpoch: 0|  Loss:  8.1061 |Global loss: 10.0435| Local H loss: 0.0262  | Global H loss: 0.0305 [0m
[94mEpoch: 1|  NKD Loss: 2.257 | CT Loss: 5.2655| [0m
[91mEpoch: 1|  Loss:  8.0845 |Global loss: 10.0379| Local H loss: 0.0272  | Global H loss: 0.0313 [0m
[94mEpoch: 2|  NKD Loss: 2.2524 | CT Loss: 5.2622| [0m
[91mEpoch: 2|  Loss:  8.0451 |Global loss: 10.0305| Local H loss: 0.0288  | Global H loss: 0.0329 [0m
[94mEpoch: 3|  NKD Loss: 2.2484 | CT Loss: 5.2606| [0m
[91mEpoch: 3|  Loss:  8.0225 |Global loss: 10.0277| Local H loss: 0.0302  | Global H loss: 0.0342 [0m
[94mEpoch: 0|  NKD Loss: 2.2775 | CT Loss: 5.2891| [0m
[91mEpoch: 0|  Loss:  8.2966 |Global loss: 10.0733| Local H loss: 0.0176  | Global H loss: 0.0213 [0m
[94mEpoch: 1|  NKD Loss: 2.273 | CT Loss: 5.2831| [0m
[91mEpoch: 1|  Loss:  8.2428 |Global loss: 10.0652| Local H loss: 0.0192  | Global H loss: 0.0231 [0m
[94mEpoch: 2|  NKD Loss: 2.2635 | CT Loss: 5.2781| [0m
[91mEpoch: 2|  Loss:  8.1709 |Global loss: 10.0517| Local H loss: 0.0213  | Global H loss: 0.0254 [0m
[94mEpoch: 3|  NKD Loss: 2.2619 | CT Loss: 5.2733| [0m
[91mEpoch: 3|  Loss:  8.1419 |Global loss: 10.0477| Local H loss: 0.0226  | Global H loss: 0.0269 [0m
[94mEpoch: 0|  NKD Loss: 2.2893 | CT Loss: 5.3092| [0m
[91mEpoch: 0|  Loss:  8.3511 |Global loss: 10.1022| Local H loss: 0.0151  | Global H loss: 0.019 [0m
[94mEpoch: 1|  NKD Loss: 2.2836 | CT Loss: 5.3033| [0m
[91mEpoch: 1|  Loss:  8.2873 |Global loss: 10.0913| Local H loss: 0.0167  | Global H loss: 0.021 [0m
[94mEpoch: 2|  NKD Loss: 2.2724 | CT Loss: 5.2994| [0m
[91mEpoch: 2|  Loss:  8.2221 |Global loss: 10.079| Local H loss: 0.0184  | Global H loss: 0.023 [0m
[94mEpoch: 3|  NKD Loss: 2.2656 | CT Loss: 5.2953| [0m
[91mEpoch: 3|  Loss:  8.1624 |Global loss: 10.0704| Local H loss: 0.0204  | Global H loss: 0.0253 [0m
[94mEpoch: 0|  NKD Loss: 2.2613 | CT Loss: 5.2546| [0m
[91mEpoch: 0|  Loss:  8.0863 |Global loss: 10.0295| Local H loss: 0.0228  | Global H loss: 0.028 [0m
[94mEpoch: 1|  NKD Loss: 2.2525 | CT Loss: 5.2522| [0m
[91mEpoch: 1|  Loss:  8.0427 |Global loss: 10.0209| Local H loss: 0.0248  | Global H loss: 0.03 [0m
[94mEpoch: 2|  NKD Loss: 2.2519 | CT Loss: 5.248| [0m
[91mEpoch: 2|  Loss:  8.0485 |Global loss: 10.0142| Local H loss: 0.0247  | Global H loss: 0.0298 [0m
[94mEpoch: 3|  NKD Loss: 2.2445 | CT Loss: 5.2447| [0m
[91mEpoch: 3|  Loss:  7.9975 |Global loss: 10.0056| Local H loss: 0.0264  | Global H loss: 0.0319 [0m
[94mEpoch: 0|  NKD Loss: 2.2486 | CT Loss: 5.2747| [0m
[91mEpoch: 0|  Loss:  8.0284 |Global loss: 10.0387| Local H loss: 0.0257  | Global H loss: 0.0309 [0m
[94mEpoch: 1|  NKD Loss: 2.2403 | CT Loss: 5.2696| [0m
[91mEpoch: 1|  Loss:  7.9897 |Global loss: 10.0271| Local H loss: 0.0273  | Global H loss: 0.0326 [0m
[94mEpoch: 2|  NKD Loss: 2.2393 | CT Loss: 5.2672| [0m
[91mEpoch: 2|  Loss:  7.9662 |Global loss: 10.0254| Local H loss: 0.0288  | Global H loss: 0.034 [0m
[94mEpoch: 3|  NKD Loss: 2.2299 | CT Loss: 5.2651| [0m
[91mEpoch: 3|  Loss:  7.9279 |Global loss: 10.0159| Local H loss: 0.0304  | Global H loss: 0.0356 [0m
------------------------- time cost ------------------------- 2.976304531097412
Chosen Clients:  [4, 3, 13, 11, 1, 12]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.95, 0.967, 0.975, 0.975, 0.975, 0.975, 0.725, 0.983, 0.95, 0.85, 0.975]
AUC in each clients:  [118.935, 119.843, 119.633, 119.377, 119.829, 119.673, 119.46, 119.223, 119.517, 119.664, 117.309, 119.456, 119.712, 119.614, 119.227]
F1 Score:  [0.974, 0.973, 0.973, 0.982, 0.941, 0.967, 0.974, 0.973, 0.973, 0.973, 0.723, 0.981, 0.952, 0.839, 0.975]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.947, 0.971, 0.977, 0.977, 0.977, 0.977, 0.807, 0.984, 0.956, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.9384
Averaged Test Accurancy: 0.9472
Averaged Test AUC: 0.9947
Averaged Test F1_score: 0.9449
Averaged Test Recal score: 0.9573
Std Test Accurancy: 0.0673
Std Test AUC: 0.0050
Std Test F1: 0.0006
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.2062 | CT Loss: 5.2726| [0m
[91mEpoch: 0|  Loss:  7.8798 |Global loss: 10.0046| Local H loss: 0.0361  | Global H loss: 0.041 [0m
[94mEpoch: 1|  NKD Loss: 2.2046 | CT Loss: 5.2703| [0m
[91mEpoch: 1|  Loss:  7.8701 |Global loss: 10.0004| Local H loss: 0.0376  | Global H loss: 0.042 [0m
[94mEpoch: 2|  NKD Loss: 2.1978 | CT Loss: 5.2667| [0m
[91mEpoch: 2|  Loss:  7.8412 |Global loss: 9.9921| Local H loss: 0.039  | Global H loss: 0.0434 [0m
[94mEpoch: 3|  NKD Loss: 2.1985 | CT Loss: 5.2643| [0m
[91mEpoch: 3|  Loss:  7.835 |Global loss: 9.9938| Local H loss: 0.0403  | Global H loss: 0.0443 [0m
[94mEpoch: 0|  NKD Loss: 2.2597 | CT Loss: 5.2913| [0m
[91mEpoch: 0|  Loss:  8.1301 |Global loss: 10.0645| Local H loss: 0.0216  | Global H loss: 0.0266 [0m
[94mEpoch: 1|  NKD Loss: 2.2608 | CT Loss: 5.2882| [0m
[91mEpoch: 1|  Loss:  8.1045 |Global loss: 10.0611| Local H loss: 0.0229  | Global H loss: 0.028 [0m
[94mEpoch: 2|  NKD Loss: 2.242 | CT Loss: 5.2842| [0m
[91mEpoch: 2|  Loss:  8.0223 |Global loss: 10.0407| Local H loss: 0.0258  | Global H loss: 0.0311 [0m
[94mEpoch: 3|  NKD Loss: 2.2359 | CT Loss: 5.2813| [0m
[91mEpoch: 3|  Loss:  7.9819 |Global loss: 10.0356| Local H loss: 0.0277  | Global H loss: 0.0332 [0m
[94mEpoch: 0|  NKD Loss: 2.225 | CT Loss: 5.2572| [0m
[91mEpoch: 0|  Loss:  7.9583 |Global loss: 10.0042| Local H loss: 0.0338  | Global H loss: 0.038 [0m
[94mEpoch: 1|  NKD Loss: 2.2235 | CT Loss: 5.2545| [0m
[91mEpoch: 1|  Loss:  7.944 |Global loss: 10.0027| Local H loss: 0.0345  | Global H loss: 0.0386 [0m
[94mEpoch: 2|  NKD Loss: 2.2145 | CT Loss: 5.252| [0m
[91mEpoch: 2|  Loss:  7.8929 |Global loss: 9.9929| Local H loss: 0.0374  | Global H loss: 0.0412 [0m
[94mEpoch: 3|  NKD Loss: 2.2081 | CT Loss: 5.249| [0m
[91mEpoch: 3|  Loss:  7.8779 |Global loss: 9.9842| Local H loss: 0.0382  | Global H loss: 0.042 [0m
[94mEpoch: 0|  NKD Loss: 2.2233 | CT Loss: 5.261| [0m
[91mEpoch: 0|  Loss:  7.8904 |Global loss: 10.0069| Local H loss: 0.0322  | Global H loss: 0.0376 [0m
[94mEpoch: 1|  NKD Loss: 2.2164 | CT Loss: 5.2599| [0m
[91mEpoch: 1|  Loss:  7.8607 |Global loss: 9.9994| Local H loss: 0.0338  | Global H loss: 0.0393 [0m
[94mEpoch: 2|  NKD Loss: 2.209 | CT Loss: 5.2564| [0m
[91mEpoch: 2|  Loss:  7.8325 |Global loss: 9.9899| Local H loss: 0.0354  | Global H loss: 0.0406 [0m
[94mEpoch: 3|  NKD Loss: 2.2071 | CT Loss: 5.2545| [0m
[91mEpoch: 3|  Loss:  7.8118 |Global loss: 9.9884| Local H loss: 0.0367  | Global H loss: 0.042 [0m
[94mEpoch: 0|  NKD Loss: 2.2494 | CT Loss: 5.2751| [0m
[91mEpoch: 0|  Loss:  8.1267 |Global loss: 10.0373| Local H loss: 0.0214  | Global H loss: 0.0265 [0m
[94mEpoch: 1|  NKD Loss: 2.2447 | CT Loss: 5.2713| [0m
[91mEpoch: 1|  Loss:  8.0866 |Global loss: 10.0295| Local H loss: 0.0233  | Global H loss: 0.0286 [0m
[94mEpoch: 2|  NKD Loss: 2.2383 | CT Loss: 5.2693| [0m
[91mEpoch: 2|  Loss:  8.0496 |Global loss: 10.0229| Local H loss: 0.0252  | Global H loss: 0.0305 [0m
[94mEpoch: 3|  NKD Loss: 2.2314 | CT Loss: 5.2676| [0m
[91mEpoch: 3|  Loss:  8.0074 |Global loss: 10.0173| Local H loss: 0.0269  | Global H loss: 0.0324 [0m
[94mEpoch: 0|  NKD Loss: 2.2405 | CT Loss: 5.2425| [0m
[91mEpoch: 0|  Loss:  7.97 |Global loss: 10.0008| Local H loss: 0.028  | Global H loss: 0.0334 [0m
[94mEpoch: 1|  NKD Loss: 2.2402 | CT Loss: 5.24| [0m
[91mEpoch: 1|  Loss:  7.9604 |Global loss: 10.0005| Local H loss: 0.0292  | Global H loss: 0.0346 [0m
[94mEpoch: 2|  NKD Loss: 2.228 | CT Loss: 5.2337| [0m
[91mEpoch: 2|  Loss:  7.9169 |Global loss: 9.9835| Local H loss: 0.0306  | Global H loss: 0.0358 [0m
[94mEpoch: 3|  NKD Loss: 2.2248 | CT Loss: 5.2312| [0m
[91mEpoch: 3|  Loss:  7.8953 |Global loss: 9.9797| Local H loss: 0.0317  | Global H loss: 0.0372 [0m
------------------------- time cost ------------------------- 3.082259178161621
Chosen Clients:  [3, 11, 7, 2, 8, 1]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.983, 0.967, 0.975, 0.975, 0.975, 0.975, 0.725, 0.983, 0.95, 0.85, 0.975]
AUC in each clients:  [118.935, 119.835, 119.633, 119.129, 119.889, 119.673, 119.46, 119.223, 119.517, 119.664, 117.309, 119.47, 119.803, 119.632, 119.227]
F1 Score:  [0.974, 0.973, 0.973, 0.981, 0.982, 0.967, 0.974, 0.973, 0.973, 0.973, 0.723, 0.981, 0.952, 0.844, 0.975]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.984, 0.971, 0.977, 0.977, 0.977, 0.977, 0.807, 0.984, 0.956, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.8955
Averaged Test Accurancy: 0.9494
Averaged Test AUC: 0.9947
Averaged Test F1_score: 0.9479
Averaged Test Recal score: 0.9597
Std Test Accurancy: 0.0679
Std Test AUC: 0.0051
Std Test F1: 0.0006
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.252 | CT Loss: 5.2801| [0m
[91mEpoch: 0|  Loss:  8.0334 |Global loss: 10.0461| Local H loss: 0.0265  | Global H loss: 0.0317 [0m
[94mEpoch: 1|  NKD Loss: 2.2229 | CT Loss: 5.2751| [0m
[91mEpoch: 1|  Loss:  7.9179 |Global loss: 10.0198| Local H loss: 0.0305  | Global H loss: 0.0362 [0m
[94mEpoch: 2|  NKD Loss: 2.2198 | CT Loss: 5.2722| [0m
[91mEpoch: 2|  Loss:  7.8924 |Global loss: 10.013| Local H loss: 0.0323  | Global H loss: 0.0379 [0m
[94mEpoch: 3|  NKD Loss: 2.2254 | CT Loss: 5.2697| [0m
[91mEpoch: 3|  Loss:  7.9116 |Global loss: 10.0193| Local H loss: 0.0318  | Global H loss: 0.037 [0m
[94mEpoch: 0|  NKD Loss: 2.1996 | CT Loss: 5.2511| [0m
[91mEpoch: 0|  Loss:  7.7821 |Global loss: 9.9805| Local H loss: 0.0387  | Global H loss: 0.0438 [0m
[94mEpoch: 1|  NKD Loss: 2.1944 | CT Loss: 5.25| [0m
[91mEpoch: 1|  Loss:  7.7652 |Global loss: 9.9722| Local H loss: 0.04  | Global H loss: 0.0448 [0m
[94mEpoch: 2|  NKD Loss: 2.1888 | CT Loss: 5.247| [0m
[91mEpoch: 2|  Loss:  7.7396 |Global loss: 9.9671| Local H loss: 0.0412  | Global H loss: 0.0461 [0m
[94mEpoch: 3|  NKD Loss: 2.1867 | CT Loss: 5.2452| [0m
[91mEpoch: 3|  Loss:  7.7263 |Global loss: 9.9655| Local H loss: 0.0429  | Global H loss: 0.0473 [0m
[94mEpoch: 0|  NKD Loss: 2.2555 | CT Loss: 5.2678| [0m
[91mEpoch: 0|  Loss:  8.0908 |Global loss: 10.039| Local H loss: 0.024  | Global H loss: 0.0285 [0m
[94mEpoch: 1|  NKD Loss: 2.2573 | CT Loss: 5.265| [0m
[91mEpoch: 1|  Loss:  8.0854 |Global loss: 10.0367| Local H loss: 0.025  | Global H loss: 0.0293 [0m
[94mEpoch: 2|  NKD Loss: 2.2478 | CT Loss: 5.261| [0m
[91mEpoch: 2|  Loss:  8.0306 |Global loss: 10.0243| Local H loss: 0.0271  | Global H loss: 0.0315 [0m
[94mEpoch: 3|  NKD Loss: 2.2409 | CT Loss: 5.2579| [0m
[91mEpoch: 3|  Loss:  7.9843 |Global loss: 10.0176| Local H loss: 0.0287  | Global H loss: 0.0333 [0m
[94mEpoch: 0|  NKD Loss: 2.2495 | CT Loss: 5.2625| [0m
[91mEpoch: 0|  Loss:  8.0476 |Global loss: 10.0258| Local H loss: 0.0266  | Global H loss: 0.0305 [0m
[94mEpoch: 1|  NKD Loss: 2.2481 | CT Loss: 5.2596| [0m
[91mEpoch: 1|  Loss:  8.0397 |Global loss: 10.0241| Local H loss: 0.0264  | Global H loss: 0.0305 [0m
[94mEpoch: 2|  NKD Loss: 2.2362 | CT Loss: 5.2558| [0m
[91mEpoch: 2|  Loss:  7.977 |Global loss: 10.0097| Local H loss: 0.029  | Global H loss: 0.0329 [0m
[94mEpoch: 3|  NKD Loss: 2.2352 | CT Loss: 5.2533| [0m
[91mEpoch: 3|  Loss:  7.9683 |Global loss: 10.0071| Local H loss: 0.0297  | Global H loss: 0.0336 [0m
[94mEpoch: 0|  NKD Loss: 2.28 | CT Loss: 5.2969| [0m
[91mEpoch: 0|  Loss:  8.2761 |Global loss: 10.0838| Local H loss: 0.0179  | Global H loss: 0.0217 [0m
[94mEpoch: 1|  NKD Loss: 2.2759 | CT Loss: 5.2939| [0m
[91mEpoch: 1|  Loss:  8.2348 |Global loss: 10.0764| Local H loss: 0.0194  | Global H loss: 0.0233 [0m
[94mEpoch: 2|  NKD Loss: 2.2754 | CT Loss: 5.2907| [0m
[91mEpoch: 2|  Loss:  8.2127 |Global loss: 10.0752| Local H loss: 0.0201  | Global H loss: 0.0242 [0m
[94mEpoch: 3|  NKD Loss: 2.2708 | CT Loss: 5.2886| [0m
[91mEpoch: 3|  Loss:  8.1714 |Global loss: 10.07| Local H loss: 0.0216  | Global H loss: 0.0259 [0m
[94mEpoch: 0|  NKD Loss: 2.2253 | CT Loss: 5.2629| [0m
[91mEpoch: 0|  Loss:  7.9626 |Global loss: 10.0077| Local H loss: 0.0298  | Global H loss: 0.0352 [0m
[94mEpoch: 1|  NKD Loss: 2.2164 | CT Loss: 5.2604| [0m
[91mEpoch: 1|  Loss:  7.9216 |Global loss: 10.0002| Local H loss: 0.032  | Global H loss: 0.0372 [0m
[94mEpoch: 2|  NKD Loss: 2.2138 | CT Loss: 5.2579| [0m
[91mEpoch: 2|  Loss:  7.8987 |Global loss: 9.9943| Local H loss: 0.0337  | Global H loss: 0.0386 [0m
[94mEpoch: 3|  NKD Loss: 2.2114 | CT Loss: 5.2555| [0m
[91mEpoch: 3|  Loss:  7.8904 |Global loss: 9.9904| Local H loss: 0.0346  | Global H loss: 0.0393 [0m
------------------------- time cost ------------------------- 2.9945425987243652
Chosen Clients:  [12, 3, 5, 1, 0, 13]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.908, 0.975, 0.942, 0.983, 0.967, 0.975, 0.975, 0.975, 0.975, 0.725, 0.983, 0.95, 0.85, 0.975]
AUC in each clients:  [118.935, 119.835, 119.66, 118.93, 119.889, 119.673, 119.46, 119.117, 119.46, 119.664, 117.309, 119.51, 119.803, 119.632, 119.227]
F1 Score:  [0.974, 0.87, 0.973, 0.94, 0.982, 0.967, 0.974, 0.973, 0.973, 0.973, 0.723, 0.981, 0.952, 0.844, 0.975]
Recall Score:  [0.977, 0.903, 0.977, 0.949, 0.984, 0.971, 0.977, 0.977, 0.977, 0.977, 0.807, 0.984, 0.956, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.8537
Averaged Test Accurancy: 0.9422
Averaged Test AUC: 0.9945
Averaged Test F1_score: 0.9383
Averaged Test Recal score: 0.9525
Std Test Accurancy: 0.0675
Std Test AUC: 0.0052
Std Test F1: 0.0006
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.2259 | CT Loss: 5.2293| [0m
[91mEpoch: 0|  Loss:  7.8816 |Global loss: 9.9793| Local H loss: 0.0323  | Global H loss: 0.0377 [0m
[94mEpoch: 1|  NKD Loss: 2.2194 | CT Loss: 5.2271| [0m
[91mEpoch: 1|  Loss:  7.8654 |Global loss: 9.9719| Local H loss: 0.0336  | Global H loss: 0.0389 [0m
[94mEpoch: 2|  NKD Loss: 2.2089 | CT Loss: 5.2262| [0m
[91mEpoch: 2|  Loss:  7.8227 |Global loss: 9.9614| Local H loss: 0.0361  | Global H loss: 0.0409 [0m
[94mEpoch: 3|  NKD Loss: 2.2155 | CT Loss: 5.2202| [0m
[91mEpoch: 3|  Loss:  7.8374 |Global loss: 9.959| Local H loss: 0.0359  | Global H loss: 0.0408 [0m
[94mEpoch: 0|  NKD Loss: 2.2131 | CT Loss: 5.2669| [0m
[91mEpoch: 0|  Loss:  7.8484 |Global loss: 10.0057| Local H loss: 0.0352  | Global H loss: 0.0404 [0m
[94mEpoch: 1|  NKD Loss: 2.21 | CT Loss: 5.2638| [0m
[91mEpoch: 1|  Loss:  7.8355 |Global loss: 10.0019| Local H loss: 0.0359  | Global H loss: 0.041 [0m
[94mEpoch: 2|  NKD Loss: 2.2015 | CT Loss: 5.2606| [0m
[91mEpoch: 2|  Loss:  7.7953 |Global loss: 9.9897| Local H loss: 0.0382  | Global H loss: 0.0433 [0m
[94mEpoch: 3|  NKD Loss: 2.1938 | CT Loss: 5.2583| [0m
[91mEpoch: 3|  Loss:  7.7592 |Global loss: 9.9823| Local H loss: 0.0405  | Global H loss: 0.0455 [0m
[94mEpoch: 0|  NKD Loss: 2.2586 | CT Loss: 5.2764| [0m
[91mEpoch: 0|  Loss:  8.1175 |Global loss: 10.0469| Local H loss: 0.0231  | Global H loss: 0.028 [0m
[94mEpoch: 1|  NKD Loss: 2.2517 | CT Loss: 5.2735| [0m
[91mEpoch: 1|  Loss:  8.066 |Global loss: 10.0391| Local H loss: 0.025  | Global H loss: 0.03 [0m
[94mEpoch: 2|  NKD Loss: 2.2471 | CT Loss: 5.2702| [0m
[91mEpoch: 2|  Loss:  8.0336 |Global loss: 10.0361| Local H loss: 0.0268  | Global H loss: 0.0317 [0m
[94mEpoch: 3|  NKD Loss: 2.2415 | CT Loss: 5.2678| [0m
[91mEpoch: 3|  Loss:  8.0149 |Global loss: 10.0256| Local H loss: 0.0274  | Global H loss: 0.0324 [0m
[94mEpoch: 0|  NKD Loss: 2.2119 | CT Loss: 5.2528| [0m
[91mEpoch: 0|  Loss:  7.8786 |Global loss: 9.991| Local H loss: 0.0353  | Global H loss: 0.0401 [0m
[94mEpoch: 1|  NKD Loss: 2.203 | CT Loss: 5.2485| [0m
[91mEpoch: 1|  Loss:  7.8415 |Global loss: 9.979| Local H loss: 0.0375  | Global H loss: 0.0418 [0m
[94mEpoch: 2|  NKD Loss: 2.2015 | CT Loss: 5.2487| [0m
[91mEpoch: 2|  Loss:  7.8304 |Global loss: 9.9786| Local H loss: 0.0388  | Global H loss: 0.0427 [0m
[94mEpoch: 3|  NKD Loss: 2.1978 | CT Loss: 5.2435| [0m
[91mEpoch: 3|  Loss:  7.8044 |Global loss: 9.9709| Local H loss: 0.0408  | Global H loss: 0.0443 [0m
[94mEpoch: 0|  NKD Loss: 2.2453 | CT Loss: 5.256| [0m
[91mEpoch: 0|  Loss:  8.0033 |Global loss: 10.0206| Local H loss: 0.0311  | Global H loss: 0.035 [0m
[94mEpoch: 1|  NKD Loss: 2.2415 | CT Loss: 5.2532| [0m
[91mEpoch: 1|  Loss:  7.9782 |Global loss: 10.0162| Local H loss: 0.0317  | Global H loss: 0.0357 [0m
[94mEpoch: 2|  NKD Loss: 2.2366 | CT Loss: 5.2497| [0m
[91mEpoch: 2|  Loss:  7.9561 |Global loss: 10.0087| Local H loss: 0.0333  | Global H loss: 0.0369 [0m
[94mEpoch: 3|  NKD Loss: 2.2341 | CT Loss: 5.2472| [0m
[91mEpoch: 3|  Loss:  7.9324 |Global loss: 10.0033| Local H loss: 0.0343  | Global H loss: 0.0379 [0m
[94mEpoch: 0|  NKD Loss: 2.2003 | CT Loss: 5.2469| [0m
[91mEpoch: 0|  Loss:  7.8507 |Global loss: 9.9759| Local H loss: 0.0404  | Global H loss: 0.0437 [0m
[94mEpoch: 1|  NKD Loss: 2.2041 | CT Loss: 5.2446| [0m
[91mEpoch: 1|  Loss:  7.861 |Global loss: 9.9778| Local H loss: 0.0399  | Global H loss: 0.0431 [0m
[94mEpoch: 2|  NKD Loss: 2.1972 | CT Loss: 5.2415| [0m
[91mEpoch: 2|  Loss:  7.8321 |Global loss: 9.9707| Local H loss: 0.0418  | Global H loss: 0.0447 [0m
[94mEpoch: 3|  NKD Loss: 2.2002 | CT Loss: 5.2409| [0m
[91mEpoch: 3|  Loss:  7.8224 |Global loss: 9.9681| Local H loss: 0.0422  | Global H loss: 0.0451 [0m
------------------------- time cost ------------------------- 2.922013998031616
Chosen Clients:  [4, 6, 10, 9, 12, 2]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.725, 0.983, 0.933, 0.85, 0.975]
AUC in each clients:  [118.984, 119.869, 119.66, 119.027, 119.889, 119.689, 119.46, 119.117, 119.46, 119.664, 117.309, 119.51, 119.81, 119.616, 119.227]
F1 Score:  [0.974, 0.973, 0.973, 0.981, 0.982, 0.974, 0.974, 0.973, 0.973, 0.973, 0.723, 0.981, 0.942, 0.839, 0.975]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.984, 0.977, 0.977, 0.977, 0.977, 0.977, 0.807, 0.984, 0.949, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.8074
Averaged Test Accurancy: 0.9489
Averaged Test AUC: 0.9946
Averaged Test F1_score: 0.9473
Averaged Test Recal score: 0.9597
Std Test Accurancy: 0.0682
Std Test AUC: 0.0051
Std Test F1: 0.0006
Std Test Recall: 0.0004
[94mEpoch: 0|  NKD Loss: 2.1907 | CT Loss: 5.2629| [0m
[91mEpoch: 0|  Loss:  7.8046 |Global loss: 9.9849| Local H loss: 0.0424  | Global H loss: 0.0459 [0m
[94mEpoch: 1|  NKD Loss: 2.1937 | CT Loss: 5.2597| [0m
[91mEpoch: 1|  Loss:  7.8142 |Global loss: 9.985| Local H loss: 0.0423  | Global H loss: 0.0457 [0m
[94mEpoch: 2|  NKD Loss: 2.1864 | CT Loss: 5.2567| [0m
[91mEpoch: 2|  Loss:  7.7879 |Global loss: 9.9735| Local H loss: 0.0437  | Global H loss: 0.0468 [0m
[94mEpoch: 3|  NKD Loss: 2.1816 | CT Loss: 5.2538| [0m
[91mEpoch: 3|  Loss:  7.7634 |Global loss: 9.9687| Local H loss: 0.0462  | Global H loss: 0.0486 [0m
[94mEpoch: 0|  NKD Loss: 2.218 | CT Loss: 5.2397| [0m
[91mEpoch: 0|  Loss:  7.8334 |Global loss: 9.9812| Local H loss: 0.0351  | Global H loss: 0.0399 [0m
[94mEpoch: 1|  NKD Loss: 2.2132 | CT Loss: 5.2379| [0m
[91mEpoch: 1|  Loss:  7.7992 |Global loss: 9.9778| Local H loss: 0.0377  | Global H loss: 0.0421 [0m
[94mEpoch: 2|  NKD Loss: 2.2024 | CT Loss: 5.2334| [0m
[91mEpoch: 2|  Loss:  7.7598 |Global loss: 9.9637| Local H loss: 0.0391  | Global H loss: 0.0438 [0m
[94mEpoch: 3|  NKD Loss: 2.2041 | CT Loss: 5.2324| [0m
[91mEpoch: 3|  Loss:  7.7605 |Global loss: 9.967| Local H loss: 0.0398  | Global H loss: 0.0442 [0m
[94mEpoch: 0|  NKD Loss: 2.2932 | CT Loss: 5.3275| [0m
[91mEpoch: 0|  Loss:  9.0797 |Global loss: 10.1117| Local H loss: 0.0038  | Global H loss: 0.0046 [0m
[94mEpoch: 1|  NKD Loss: 2.2919 | CT Loss: 5.3211| [0m
[91mEpoch: 1|  Loss:  8.929 |Global loss: 10.1062| Local H loss: 0.0053  | Global H loss: 0.0065 [0m
[94mEpoch: 2|  NKD Loss: 2.2958 | CT Loss: 5.3147| [0m
[91mEpoch: 2|  Loss:  8.8387 |Global loss: 10.1038| Local H loss: 0.0065  | Global H loss: 0.008 [0m
[94mEpoch: 3|  NKD Loss: 2.2933 | CT Loss: 5.306| [0m
[91mEpoch: 3|  Loss:  8.7173 |Global loss: 10.0954| Local H loss: 0.0085  | Global H loss: 0.0104 [0m
[94mEpoch: 0|  NKD Loss: 2.1812 | CT Loss: 5.249| [0m
[91mEpoch: 0|  Loss:  7.69 |Global loss: 9.9669| Local H loss: 0.0474  | Global H loss: 0.0511 [0m
[94mEpoch: 1|  NKD Loss: 2.1719 | CT Loss: 5.2466| [0m
[91mEpoch: 1|  Loss:  7.6572 |Global loss: 9.9556| Local H loss: 0.05  | Global H loss: 0.0532 [0m
[94mEpoch: 2|  NKD Loss: 2.1654 | CT Loss: 5.2443| [0m
[91mEpoch: 2|  Loss:  7.6355 |Global loss: 9.9509| Local H loss: 0.052  | Global H loss: 0.0548 [0m
[94mEpoch: 3|  NKD Loss: 2.1646 | CT Loss: 5.2412| [0m
[91mEpoch: 3|  Loss:  7.627 |Global loss: 9.9472| Local H loss: 0.0532  | Global H loss: 0.0555 [0m
[94mEpoch: 0|  NKD Loss: 2.2105 | CT Loss: 5.2164| [0m
[91mEpoch: 0|  Loss:  7.8269 |Global loss: 9.9529| Local H loss: 0.0375  | Global H loss: 0.0423 [0m
[94mEpoch: 1|  NKD Loss: 2.196 | CT Loss: 5.2124| [0m
[91mEpoch: 1|  Loss:  7.7614 |Global loss: 9.9382| Local H loss: 0.0397  | Global H loss: 0.0441 [0m
[94mEpoch: 2|  NKD Loss: 2.2018 | CT Loss: 5.2121| [0m
[91mEpoch: 2|  Loss:  7.773 |Global loss: 9.9418| Local H loss: 0.039  | Global H loss: 0.0435 [0m
[94mEpoch: 3|  NKD Loss: 2.1917 | CT Loss: 5.2071| [0m
[91mEpoch: 3|  Loss:  7.731 |Global loss: 9.9287| Local H loss: 0.0423  | Global H loss: 0.0462 [0m
[94mEpoch: 0|  NKD Loss: 2.231 | CT Loss: 5.2518| [0m
[91mEpoch: 0|  Loss:  7.9346 |Global loss: 10.0034| Local H loss: 0.0308  | Global H loss: 0.035 [0m
[94mEpoch: 1|  NKD Loss: 2.2165 | CT Loss: 5.2483| [0m
[91mEpoch: 1|  Loss:  7.8717 |Global loss: 9.9877| Local H loss: 0.0335  | Global H loss: 0.0378 [0m
[94mEpoch: 2|  NKD Loss: 2.236 | CT Loss: 5.2478| [0m
[91mEpoch: 2|  Loss:  7.9386 |Global loss: 10.0062| Local H loss: 0.032  | Global H loss: 0.0363 [0m
[94mEpoch: 3|  NKD Loss: 2.2263 | CT Loss: 5.2445| [0m
[91mEpoch: 3|  Loss:  7.9034 |Global loss: 9.9958| Local H loss: 0.0329  | Global H loss: 0.0372 [0m
------------------------- time cost ------------------------- 2.9630496501922607
Chosen Clients:  [3, 4, 5, 10, 8, 1]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.95, 0.975, 0.975, 0.975, 0.975, 0.975, 0.85, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.984, 119.869, 119.707, 119.027, 119.925, 119.689, 119.532, 119.117, 119.46, 119.482, 118.372, 119.51, 119.91, 119.616, 119.227]
F1 Score:  [0.974, 0.973, 0.973, 0.981, 0.944, 0.974, 0.974, 0.973, 0.973, 0.973, 0.845, 0.981, 0.973, 0.839, 0.975]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.949, 0.977, 0.977, 0.977, 0.977, 0.977, 0.89, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.7554
Averaged Test Accurancy: 0.9578
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9550
Averaged Test Recal score: 0.9647
Std Test Accurancy: 0.0429
Std Test AUC: 0.0034
Std Test F1: 0.0004
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1946 | CT Loss: 5.2569| [0m
[91mEpoch: 0|  Loss:  7.7574 |Global loss: 9.9805| Local H loss: 0.0406  | Global H loss: 0.0456 [0m
[94mEpoch: 1|  NKD Loss: 2.1988 | CT Loss: 5.2559| [0m
[91mEpoch: 1|  Loss:  7.7542 |Global loss: 9.987| Local H loss: 0.0416  | Global H loss: 0.0463 [0m
[94mEpoch: 2|  NKD Loss: 2.2014 | CT Loss: 5.2515| [0m
[91mEpoch: 2|  Loss:  7.7704 |Global loss: 9.9867| Local H loss: 0.0414  | Global H loss: 0.0459 [0m
[94mEpoch: 3|  NKD Loss: 2.1818 | CT Loss: 5.2511| [0m
[91mEpoch: 3|  Loss:  7.7045 |Global loss: 9.9669| Local H loss: 0.0447  | Global H loss: 0.0489 [0m
[94mEpoch: 0|  NKD Loss: 2.1758 | CT Loss: 5.2502| [0m
[91mEpoch: 0|  Loss:  7.7395 |Global loss: 9.9612| Local H loss: 0.0479  | Global H loss: 0.05 [0m
[94mEpoch: 1|  NKD Loss: 2.1788 | CT Loss: 5.2471| [0m
[91mEpoch: 1|  Loss:  7.7455 |Global loss: 9.9628| Local H loss: 0.0484  | Global H loss: 0.0501 [0m
[94mEpoch: 2|  NKD Loss: 2.19 | CT Loss: 5.2458| [0m
[91mEpoch: 2|  Loss:  7.7785 |Global loss: 9.9692| Local H loss: 0.0466  | Global H loss: 0.0485 [0m
[94mEpoch: 3|  NKD Loss: 2.1739 | CT Loss: 5.2432| [0m
[91mEpoch: 3|  Loss:  7.7245 |Global loss: 9.9528| Local H loss: 0.0497  | Global H loss: 0.051 [0m
[94mEpoch: 0|  NKD Loss: 2.2382 | CT Loss: 5.2641| [0m
[91mEpoch: 0|  Loss:  7.9813 |Global loss: 10.0226| Local H loss: 0.0292  | Global H loss: 0.0341 [0m
[94mEpoch: 1|  NKD Loss: 2.2322 | CT Loss: 5.2625| [0m
[91mEpoch: 1|  Loss:  7.9526 |Global loss: 10.0163| Local H loss: 0.0306  | Global H loss: 0.0355 [0m
[94mEpoch: 2|  NKD Loss: 2.2301 | CT Loss: 5.2617| [0m
[91mEpoch: 2|  Loss:  7.9373 |Global loss: 10.0131| Local H loss: 0.0314  | Global H loss: 0.0363 [0m
[94mEpoch: 3|  NKD Loss: 2.2239 | CT Loss: 5.2594| [0m
[91mEpoch: 3|  Loss:  7.908 |Global loss: 10.0049| Local H loss: 0.0328  | Global H loss: 0.0375 [0m
[94mEpoch: 0|  NKD Loss: 2.291 | CT Loss: 5.2999| [0m
[91mEpoch: 0|  Loss:  8.6271 |Global loss: 10.0884| Local H loss: 0.01  | Global H loss: 0.0123 [0m
[94mEpoch: 1|  NKD Loss: 2.2894 | CT Loss: 5.2957| [0m
[91mEpoch: 1|  Loss:  8.5488 |Global loss: 10.084| Local H loss: 0.0116  | Global H loss: 0.0142 [0m
[94mEpoch: 2|  NKD Loss: 2.2875 | CT Loss: 5.2942| [0m
[91mEpoch: 2|  Loss:  8.4827 |Global loss: 10.0802| Local H loss: 0.0131  | Global H loss: 0.016 [0m
[94mEpoch: 3|  NKD Loss: 2.2813 | CT Loss: 5.289| [0m
[91mEpoch: 3|  Loss:  8.4016 |Global loss: 10.0716| Local H loss: 0.0151  | Global H loss: 0.0183 [0m
[94mEpoch: 0|  NKD Loss: 2.2605 | CT Loss: 5.2844| [0m
[91mEpoch: 0|  Loss:  8.106 |Global loss: 10.059| Local H loss: 0.0239  | Global H loss: 0.0284 [0m
[94mEpoch: 1|  NKD Loss: 2.268 | CT Loss: 5.2835| [0m
[91mEpoch: 1|  Loss:  8.111 |Global loss: 10.0642| Local H loss: 0.0239  | Global H loss: 0.0284 [0m
[94mEpoch: 2|  NKD Loss: 2.2555 | CT Loss: 5.2791| [0m
[91mEpoch: 2|  Loss:  8.0566 |Global loss: 10.0492| Local H loss: 0.0258  | Global H loss: 0.0303 [0m
[94mEpoch: 3|  NKD Loss: 2.249 | CT Loss: 5.2775| [0m
[91mEpoch: 3|  Loss:  8.0177 |Global loss: 10.042| Local H loss: 0.0275  | Global H loss: 0.0321 [0m
[94mEpoch: 0|  NKD Loss: 2.1901 | CT Loss: 5.2412| [0m
[91mEpoch: 0|  Loss:  7.7761 |Global loss: 9.9609| Local H loss: 0.0425  | Global H loss: 0.0458 [0m
[94mEpoch: 1|  NKD Loss: 2.1904 | CT Loss: 5.2395| [0m
[91mEpoch: 1|  Loss:  7.7689 |Global loss: 9.9631| Local H loss: 0.0441  | Global H loss: 0.0468 [0m
[94mEpoch: 2|  NKD Loss: 2.187 | CT Loss: 5.2385| [0m
[91mEpoch: 2|  Loss:  7.7551 |Global loss: 9.9568| Local H loss: 0.0449  | Global H loss: 0.0474 [0m
[94mEpoch: 3|  NKD Loss: 2.1962 | CT Loss: 5.235| [0m
[91mEpoch: 3|  Loss:  7.7893 |Global loss: 9.9635| Local H loss: 0.0438  | Global H loss: 0.0466 [0m
------------------------- time cost ------------------------- 2.839367151260376
Chosen Clients:  [2, 9, 0, 13, 3, 12]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.908, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.984, 119.855, 119.707, 119.009, 119.939, 119.448, 119.532, 119.117, 119.338, 119.482, 118.831, 119.51, 119.91, 119.616, 119.227]
F1 Score:  [0.974, 0.87, 0.973, 0.981, 0.974, 0.975, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.973, 0.839, 0.975]
Recall Score:  [0.977, 0.903, 0.977, 0.984, 0.977, 0.978, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.7090
Averaged Test Accurancy: 0.9556
Averaged Test AUC: 0.9953
Averaged Test F1_score: 0.9511
Averaged Test Recal score: 0.9624
Std Test Accurancy: 0.0433
Std Test AUC: 0.0028
Std Test F1: 0.0004
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.2036 | CT Loss: 5.2425| [0m
[91mEpoch: 0|  Loss:  7.8191 |Global loss: 9.9709| Local H loss: 0.0362  | Global H loss: 0.0403 [0m
[94mEpoch: 1|  NKD Loss: 2.1986 | CT Loss: 5.2383| [0m
[91mEpoch: 1|  Loss:  7.7847 |Global loss: 9.9648| Local H loss: 0.0377  | Global H loss: 0.042 [0m
[94mEpoch: 2|  NKD Loss: 2.2267 | CT Loss: 5.2387| [0m
[91mEpoch: 2|  Loss:  7.8926 |Global loss: 9.9898| Local H loss: 0.0358  | Global H loss: 0.04 [0m
[94mEpoch: 3|  NKD Loss: 2.1927 | CT Loss: 5.2327| [0m
[91mEpoch: 3|  Loss:  7.7585 |Global loss: 9.9539| Local H loss: 0.0396  | Global H loss: 0.0436 [0m
[94mEpoch: 0|  NKD Loss: 2.1629 | CT Loss: 5.2405| [0m
[91mEpoch: 0|  Loss:  7.6224 |Global loss: 9.9444| Local H loss: 0.0537  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.163 | CT Loss: 5.2389| [0m
[91mEpoch: 1|  Loss:  7.6195 |Global loss: 9.9445| Local H loss: 0.0538  | Global H loss: 0.056 [0m
[94mEpoch: 2|  NKD Loss: 2.1579 | CT Loss: 5.2346| [0m
[91mEpoch: 2|  Loss:  7.5998 |Global loss: 9.9361| Local H loss: 0.0559  | Global H loss: 0.0574 [0m
[94mEpoch: 3|  NKD Loss: 2.1588 | CT Loss: 5.232| [0m
[91mEpoch: 3|  Loss:  7.5926 |Global loss: 9.936| Local H loss: 0.0568  | Global H loss: 0.0581 [0m
[94mEpoch: 0|  NKD Loss: 2.232 | CT Loss: 5.2451| [0m
[91mEpoch: 0|  Loss:  7.9251 |Global loss: 10.001| Local H loss: 0.0345  | Global H loss: 0.0381 [0m
[94mEpoch: 1|  NKD Loss: 2.2287 | CT Loss: 5.2414| [0m
[91mEpoch: 1|  Loss:  7.9033 |Global loss: 9.9967| Local H loss: 0.0357  | Global H loss: 0.0392 [0m
[94mEpoch: 2|  NKD Loss: 2.2266 | CT Loss: 5.2395| [0m
[91mEpoch: 2|  Loss:  7.8902 |Global loss: 9.9923| Local H loss: 0.0365  | Global H loss: 0.0399 [0m
[94mEpoch: 3|  NKD Loss: 2.2191 | CT Loss: 5.2354| [0m
[91mEpoch: 3|  Loss:  7.8585 |Global loss: 9.9818| Local H loss: 0.0381  | Global H loss: 0.0413 [0m
[94mEpoch: 0|  NKD Loss: 2.193 | CT Loss: 5.2385| [0m
[91mEpoch: 0|  Loss:  7.8078 |Global loss: 9.9617| Local H loss: 0.0438  | Global H loss: 0.0462 [0m
[94mEpoch: 1|  NKD Loss: 2.1942 | CT Loss: 5.2359| [0m
[91mEpoch: 1|  Loss:  7.8085 |Global loss: 9.9614| Local H loss: 0.0436  | Global H loss: 0.0458 [0m
[94mEpoch: 2|  NKD Loss: 2.1891 | CT Loss: 5.2336| [0m
[91mEpoch: 2|  Loss:  7.7846 |Global loss: 9.9556| Local H loss: 0.0456  | Global H loss: 0.0476 [0m
[94mEpoch: 3|  NKD Loss: 2.1859 | CT Loss: 5.2317| [0m
[91mEpoch: 3|  Loss:  7.7682 |Global loss: 9.9503| Local H loss: 0.0474  | Global H loss: 0.0485 [0m
[94mEpoch: 0|  NKD Loss: 2.1751 | CT Loss: 5.2457| [0m
[91mEpoch: 0|  Loss:  7.6735 |Global loss: 9.9549| Local H loss: 0.0471  | Global H loss: 0.0511 [0m
[94mEpoch: 1|  NKD Loss: 2.1798 | CT Loss: 5.2456| [0m
[91mEpoch: 1|  Loss:  7.685 |Global loss: 9.9605| Local H loss: 0.0463  | Global H loss: 0.0503 [0m
[94mEpoch: 2|  NKD Loss: 2.1709 | CT Loss: 5.2422| [0m
[91mEpoch: 2|  Loss:  7.6534 |Global loss: 9.9514| Local H loss: 0.0487  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.168 | CT Loss: 5.2404| [0m
[91mEpoch: 3|  Loss:  7.6382 |Global loss: 9.9484| Local H loss: 0.0507  | Global H loss: 0.0539 [0m
[94mEpoch: 0|  NKD Loss: 2.1912 | CT Loss: 5.207| [0m
[91mEpoch: 0|  Loss:  7.7264 |Global loss: 9.9311| Local H loss: 0.0423  | Global H loss: 0.0463 [0m
[94mEpoch: 1|  NKD Loss: 2.1916 | CT Loss: 5.2034| [0m
[91mEpoch: 1|  Loss:  7.7258 |Global loss: 9.927| Local H loss: 0.0428  | Global H loss: 0.0467 [0m
[94mEpoch: 2|  NKD Loss: 2.1994 | CT Loss: 5.2018| [0m
[91mEpoch: 2|  Loss:  7.7537 |Global loss: 9.9309| Local H loss: 0.0423  | Global H loss: 0.0461 [0m
[94mEpoch: 3|  NKD Loss: 2.187 | CT Loss: 5.1986| [0m
[91mEpoch: 3|  Loss:  7.7134 |Global loss: 9.9184| Local H loss: 0.0437  | Global H loss: 0.0473 [0m
------------------------- time cost ------------------------- 2.892404556274414
Chosen Clients:  [2, 7, 9, 3, 1, 6]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.908, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.967, 0.85, 0.975]
AUC in each clients:  [118.984, 119.855, 119.846, 118.999, 119.939, 119.448, 119.532, 119.117, 119.338, 119.455, 118.831, 119.51, 119.927, 119.67, 119.227]
F1 Score:  [0.974, 0.87, 0.973, 0.981, 0.974, 0.975, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.967, 0.844, 0.975]
Recall Score:  [0.977, 0.903, 0.977, 0.984, 0.977, 0.978, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.971, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6881
Averaged Test Accurancy: 0.9550
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9510
Averaged Test Recal score: 0.9620
Std Test Accurancy: 0.0431
Std Test AUC: 0.0029
Std Test F1: 0.0004
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.1994 | CT Loss: 5.2312| [0m
[91mEpoch: 0|  Loss:  7.7795 |Global loss: 9.9609| Local H loss: 0.0405  | Global H loss: 0.0443 [0m
[94mEpoch: 1|  NKD Loss: 2.1833 | CT Loss: 5.2282| [0m
[91mEpoch: 1|  Loss:  7.7169 |Global loss: 9.9423| Local H loss: 0.0429  | Global H loss: 0.0463 [0m
[94mEpoch: 2|  NKD Loss: 2.1841 | CT Loss: 5.2244| [0m
[91mEpoch: 2|  Loss:  7.7149 |Global loss: 9.945| Local H loss: 0.0438  | Global H loss: 0.0469 [0m
[94mEpoch: 3|  NKD Loss: 2.2025 | CT Loss: 5.2236| [0m
[91mEpoch: 3|  Loss:  7.7706 |Global loss: 9.9598| Local H loss: 0.0419  | Global H loss: 0.0452 [0m
[94mEpoch: 0|  NKD Loss: 2.2282 | CT Loss: 5.2555| [0m
[91mEpoch: 0|  Loss:  7.9337 |Global loss: 10.0036| Local H loss: 0.0309  | Global H loss: 0.0354 [0m
[94mEpoch: 1|  NKD Loss: 2.2293 | CT Loss: 5.2521| [0m
[91mEpoch: 1|  Loss:  7.9284 |Global loss: 10.002| Local H loss: 0.0316  | Global H loss: 0.0361 [0m
[94mEpoch: 2|  NKD Loss: 2.2242 | CT Loss: 5.2497| [0m
[91mEpoch: 2|  Loss:  7.901 |Global loss: 9.9948| Local H loss: 0.0332  | Global H loss: 0.0375 [0m
[94mEpoch: 3|  NKD Loss: 2.2191 | CT Loss: 5.2468| [0m
[91mEpoch: 3|  Loss:  7.8674 |Global loss: 9.991| Local H loss: 0.0353  | Global H loss: 0.0393 [0m
[94mEpoch: 0|  NKD Loss: 2.1514 | CT Loss: 5.2297| [0m
[91mEpoch: 0|  Loss:  7.5781 |Global loss: 9.9257| Local H loss: 0.0579  | Global H loss: 0.0588 [0m
[94mEpoch: 1|  NKD Loss: 2.1491 | CT Loss: 5.2275| [0m
[91mEpoch: 1|  Loss:  7.5675 |Global loss: 9.9231| Local H loss: 0.0592  | Global H loss: 0.0597 [0m
[94mEpoch: 2|  NKD Loss: 2.15 | CT Loss: 5.2259| [0m
[91mEpoch: 2|  Loss:  7.565 |Global loss: 9.9212| Local H loss: 0.0598  | Global H loss: 0.06 [0m
[94mEpoch: 3|  NKD Loss: 2.1467 | CT Loss: 5.2236| [0m
[91mEpoch: 3|  Loss:  7.5542 |Global loss: 9.9164| Local H loss: 0.0609  | Global H loss: 0.0608 [0m
[94mEpoch: 0|  NKD Loss: 2.1692 | CT Loss: 5.2378| [0m
[91mEpoch: 0|  Loss:  7.6371 |Global loss: 9.9448| Local H loss: 0.0504  | Global H loss: 0.0536 [0m
[94mEpoch: 1|  NKD Loss: 2.1671 | CT Loss: 5.2352| [0m
[91mEpoch: 1|  Loss:  7.6295 |Global loss: 9.9421| Local H loss: 0.0516  | Global H loss: 0.0544 [0m
[94mEpoch: 2|  NKD Loss: 2.1612 | CT Loss: 5.2331| [0m
[91mEpoch: 2|  Loss:  7.6107 |Global loss: 9.9345| Local H loss: 0.0531  | Global H loss: 0.0556 [0m
[94mEpoch: 3|  NKD Loss: 2.1607 | CT Loss: 5.2318| [0m
[91mEpoch: 3|  Loss:  7.6043 |Global loss: 9.9357| Local H loss: 0.054  | Global H loss: 0.0563 [0m
[94mEpoch: 0|  NKD Loss: 2.1842 | CT Loss: 5.2313| [0m
[91mEpoch: 0|  Loss:  7.7535 |Global loss: 9.9509| Local H loss: 0.0462  | Global H loss: 0.0482 [0m
[94mEpoch: 1|  NKD Loss: 2.1806 | CT Loss: 5.2286| [0m
[91mEpoch: 1|  Loss:  7.7356 |Global loss: 9.9422| Local H loss: 0.0464  | Global H loss: 0.0483 [0m
[94mEpoch: 2|  NKD Loss: 2.181 | CT Loss: 5.2276| [0m
[91mEpoch: 2|  Loss:  7.7131 |Global loss: 9.943| Local H loss: 0.0487  | Global H loss: 0.0501 [0m
[94mEpoch: 3|  NKD Loss: 2.1796 | CT Loss: 5.2227| [0m
[91mEpoch: 3|  Loss:  7.7096 |Global loss: 9.9402| Local H loss: 0.0495  | Global H loss: 0.0506 [0m
[94mEpoch: 0|  NKD Loss: 2.1969 | CT Loss: 5.2279| [0m
[91mEpoch: 0|  Loss:  7.729 |Global loss: 9.9555| Local H loss: 0.0421  | Global H loss: 0.0463 [0m
[94mEpoch: 1|  NKD Loss: 2.192 | CT Loss: 5.2264| [0m
[91mEpoch: 1|  Loss:  7.7084 |Global loss: 9.9528| Local H loss: 0.0426  | Global H loss: 0.0471 [0m
[94mEpoch: 2|  NKD Loss: 2.187 | CT Loss: 5.2234| [0m
[91mEpoch: 2|  Loss:  7.6889 |Global loss: 9.9447| Local H loss: 0.0444  | Global H loss: 0.0483 [0m
[94mEpoch: 3|  NKD Loss: 2.183 | CT Loss: 5.2215| [0m
[91mEpoch: 3|  Loss:  7.6738 |Global loss: 9.9378| Local H loss: 0.0455  | Global H loss: 0.0494 [0m
------------------------- time cost ------------------------- 2.8719170093536377
Chosen Clients:  [5, 2, 1, 8, 12, 14]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.942, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.967, 0.85, 0.975]
AUC in each clients:  [118.984, 119.889, 119.861, 118.971, 119.939, 119.448, 119.503, 119.055, 119.338, 119.471, 118.831, 119.51, 119.927, 119.67, 119.227]
F1 Score:  [0.974, 0.931, 0.974, 0.973, 0.974, 0.975, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.967, 0.844, 0.975]
Recall Score:  [0.977, 0.94, 0.977, 0.977, 0.977, 0.978, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.971, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6693
Averaged Test Accurancy: 0.9567
Averaged Test AUC: 0.9953
Averaged Test F1_score: 0.9546
Averaged Test Recal score: 0.9640
Std Test Accurancy: 0.0412
Std Test AUC: 0.0030
Std Test F1: 0.0004
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.2189 | CT Loss: 5.2554| [0m
[91mEpoch: 0|  Loss:  7.8829 |Global loss: 10.0002| Local H loss: 0.0343  | Global H loss: 0.039 [0m
[94mEpoch: 1|  NKD Loss: 2.2157 | CT Loss: 5.2547| [0m
[91mEpoch: 1|  Loss:  7.8619 |Global loss: 9.9954| Local H loss: 0.0357  | Global H loss: 0.0402 [0m
[94mEpoch: 2|  NKD Loss: 2.216 | CT Loss: 5.2511| [0m
[91mEpoch: 2|  Loss:  7.8641 |Global loss: 9.992| Local H loss: 0.0357  | Global H loss: 0.0401 [0m
[94mEpoch: 3|  NKD Loss: 2.2192 | CT Loss: 5.2487| [0m
[91mEpoch: 3|  Loss:  7.8641 |Global loss: 9.9952| Local H loss: 0.0363  | Global H loss: 0.0406 [0m
[94mEpoch: 0|  NKD Loss: 2.1743 | CT Loss: 5.2209| [0m
[91mEpoch: 0|  Loss:  7.675 |Global loss: 9.9294| Local H loss: 0.0459  | Global H loss: 0.049 [0m
[94mEpoch: 1|  NKD Loss: 2.1793 | CT Loss: 5.2188| [0m
[91mEpoch: 1|  Loss:  7.6858 |Global loss: 9.9319| Local H loss: 0.0457  | Global H loss: 0.0488 [0m
[94mEpoch: 2|  NKD Loss: 2.1716 | CT Loss: 5.2165| [0m
[91mEpoch: 2|  Loss:  7.6596 |Global loss: 9.9249| Local H loss: 0.0478  | Global H loss: 0.0504 [0m
[94mEpoch: 3|  NKD Loss: 2.1759 | CT Loss: 5.2145| [0m
[91mEpoch: 3|  Loss:  7.6599 |Global loss: 9.9261| Local H loss: 0.0486  | Global H loss: 0.0509 [0m
[94mEpoch: 0|  NKD Loss: 2.1724 | CT Loss: 5.2221| [0m
[91mEpoch: 0|  Loss:  7.6877 |Global loss: 9.9313| Local H loss: 0.05  | Global H loss: 0.051 [0m
[94mEpoch: 1|  NKD Loss: 2.1756 | CT Loss: 5.2192| [0m
[91mEpoch: 1|  Loss:  7.6806 |Global loss: 9.9327| Local H loss: 0.0511  | Global H loss: 0.0517 [0m
[94mEpoch: 2|  NKD Loss: 2.1704 | CT Loss: 5.2169| [0m
[91mEpoch: 2|  Loss:  7.6601 |Global loss: 9.923| Local H loss: 0.0517  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.1734 | CT Loss: 5.2144| [0m
[91mEpoch: 3|  Loss:  7.6657 |Global loss: 9.9247| Local H loss: 0.0513  | Global H loss: 0.0523 [0m
[94mEpoch: 0|  NKD Loss: 2.2426 | CT Loss: 5.2739| [0m
[91mEpoch: 0|  Loss:  7.969 |Global loss: 10.035| Local H loss: 0.0294  | Global H loss: 0.0342 [0m
[94mEpoch: 1|  NKD Loss: 2.2415 | CT Loss: 5.2696| [0m
[91mEpoch: 1|  Loss:  7.9629 |Global loss: 10.0328| Local H loss: 0.0304  | Global H loss: 0.0351 [0m
[94mEpoch: 2|  NKD Loss: 2.2355 | CT Loss: 5.2672| [0m
[91mEpoch: 2|  Loss:  7.933 |Global loss: 10.0265| Local H loss: 0.0315  | Global H loss: 0.0362 [0m
[94mEpoch: 3|  NKD Loss: 2.2378 | CT Loss: 5.2662| [0m
[91mEpoch: 3|  Loss:  7.9245 |Global loss: 10.0277| Local H loss: 0.0324  | Global H loss: 0.0371 [0m
[94mEpoch: 0|  NKD Loss: 2.1798 | CT Loss: 5.1981| [0m
[91mEpoch: 0|  Loss:  7.6859 |Global loss: 9.912| Local H loss: 0.0452  | Global H loss: 0.0485 [0m
[94mEpoch: 1|  NKD Loss: 2.1847 | CT Loss: 5.1952| [0m
[91mEpoch: 1|  Loss:  7.6931 |Global loss: 9.9149| Local H loss: 0.0476  | Global H loss: 0.0498 [0m
[94mEpoch: 2|  NKD Loss: 2.1722 | CT Loss: 5.1915| [0m
[91mEpoch: 2|  Loss:  7.647 |Global loss: 9.8998| Local H loss: 0.0489  | Global H loss: 0.051 [0m
[94mEpoch: 3|  NKD Loss: 2.1789 | CT Loss: 5.1889| [0m
[91mEpoch: 3|  Loss:  7.6547 |Global loss: 9.9051| Local H loss: 0.0475  | Global H loss: 0.0503 [0m
[94mEpoch: 0|  NKD Loss: 2.1572 | CT Loss: 5.2436| [0m
[91mEpoch: 0|  Loss:  7.6171 |Global loss: 9.9451| Local H loss: 0.0533  | Global H loss: 0.0558 [0m
[94mEpoch: 1|  NKD Loss: 2.1536 | CT Loss: 5.2399| [0m
[91mEpoch: 1|  Loss:  7.6046 |Global loss: 9.9356| Local H loss: 0.055  | Global H loss: 0.0568 [0m
[94mEpoch: 2|  NKD Loss: 2.1565 | CT Loss: 5.2377| [0m
[91mEpoch: 2|  Loss:  7.6062 |Global loss: 9.9365| Local H loss: 0.0554  | Global H loss: 0.0569 [0m
[94mEpoch: 3|  NKD Loss: 2.1529 | CT Loss: 5.2356| [0m
[91mEpoch: 3|  Loss:  7.5931 |Global loss: 9.931| Local H loss: 0.0568  | Global H loss: 0.0578 [0m
------------------------- time cost ------------------------- 3.213003396987915
Chosen Clients:  [1, 10, 13, 2, 5, 11]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.984, 119.933, 119.941, 118.971, 119.939, 119.47, 119.503, 119.055, 119.114, 119.471, 118.831, 119.51, 119.936, 119.67, 119.155]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6427
Averaged Test Accurancy: 0.9600
Averaged Test AUC: 0.9953
Averaged Test F1_score: 0.9582
Averaged Test Recal score: 0.9673
Std Test Accurancy: 0.0416
Std Test AUC: 0.0032
Std Test F1: 0.0004
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.171 | CT Loss: 5.2108| [0m
[91mEpoch: 0|  Loss:  7.6634 |Global loss: 9.9223| Local H loss: 0.0528  | Global H loss: 0.053 [0m
[94mEpoch: 1|  NKD Loss: 2.1672 | CT Loss: 5.2093| [0m
[91mEpoch: 1|  Loss:  7.6421 |Global loss: 9.9147| Local H loss: 0.0543  | Global H loss: 0.054 [0m
[94mEpoch: 2|  NKD Loss: 2.1774 | CT Loss: 5.2046| [0m
[91mEpoch: 2|  Loss:  7.6663 |Global loss: 9.9205| Local H loss: 0.0542  | Global H loss: 0.0541 [0m
[94mEpoch: 3|  NKD Loss: 2.1643 | CT Loss: 5.2035| [0m
[91mEpoch: 3|  Loss:  7.6312 |Global loss: 9.9061| Local H loss: 0.0541  | Global H loss: 0.0541 [0m
[94mEpoch: 0|  NKD Loss: 2.2755 | CT Loss: 5.2844| [0m
[91mEpoch: 0|  Loss:  8.3394 |Global loss: 10.0666| Local H loss: 0.0171  | Global H loss: 0.0205 [0m
[94mEpoch: 1|  NKD Loss: 2.268 | CT Loss: 5.281| [0m
[91mEpoch: 1|  Loss:  8.2734 |Global loss: 10.0574| Local H loss: 0.0186  | Global H loss: 0.0224 [0m
[94mEpoch: 2|  NKD Loss: 2.2634 | CT Loss: 5.2765| [0m
[91mEpoch: 2|  Loss:  8.23 |Global loss: 10.0498| Local H loss: 0.0201  | Global H loss: 0.0241 [0m
[94mEpoch: 3|  NKD Loss: 2.2602 | CT Loss: 5.2739| [0m
[91mEpoch: 3|  Loss:  8.1928 |Global loss: 10.0451| Local H loss: 0.0218  | Global H loss: 0.0258 [0m
[94mEpoch: 0|  NKD Loss: 2.1805 | CT Loss: 5.2297| [0m
[91mEpoch: 0|  Loss:  7.7536 |Global loss: 9.9451| Local H loss: 0.0487  | Global H loss: 0.0497 [0m
[94mEpoch: 1|  NKD Loss: 2.1812 | CT Loss: 5.2276| [0m
[91mEpoch: 1|  Loss:  7.7457 |Global loss: 9.9436| Local H loss: 0.0491  | Global H loss: 0.05 [0m
[94mEpoch: 2|  NKD Loss: 2.185 | CT Loss: 5.2258| [0m
[91mEpoch: 2|  Loss:  7.7623 |Global loss: 9.9471| Local H loss: 0.0488  | Global H loss: 0.0493 [0m
[94mEpoch: 3|  NKD Loss: 2.1774 | CT Loss: 5.2223| [0m
[91mEpoch: 3|  Loss:  7.7332 |Global loss: 9.9347| Local H loss: 0.0508  | Global H loss: 0.0507 [0m
[94mEpoch: 0|  NKD Loss: 2.1617 | CT Loss: 5.2105| [0m
[91mEpoch: 0|  Loss:  7.6134 |Global loss: 9.9117| Local H loss: 0.0518  | Global H loss: 0.0536 [0m
[94mEpoch: 1|  NKD Loss: 2.1585 | CT Loss: 5.2079| [0m
[91mEpoch: 1|  Loss:  7.5971 |Global loss: 9.9074| Local H loss: 0.0523  | Global H loss: 0.0542 [0m
[94mEpoch: 2|  NKD Loss: 2.1806 | CT Loss: 5.2074| [0m
[91mEpoch: 2|  Loss:  7.6656 |Global loss: 9.9269| Local H loss: 0.0518  | Global H loss: 0.0526 [0m
[94mEpoch: 3|  NKD Loss: 2.1535 | CT Loss: 5.2047| [0m
[91mEpoch: 3|  Loss:  7.5791 |Global loss: 9.9022| Local H loss: 0.0547  | Global H loss: 0.0557 [0m
[94mEpoch: 0|  NKD Loss: 2.2097 | CT Loss: 5.2464| [0m
[91mEpoch: 0|  Loss:  7.8285 |Global loss: 9.9846| Local H loss: 0.0376  | Global H loss: 0.0418 [0m
[94mEpoch: 1|  NKD Loss: 2.2039 | CT Loss: 5.2436| [0m
[91mEpoch: 1|  Loss:  7.7998 |Global loss: 9.9786| Local H loss: 0.0396  | Global H loss: 0.0436 [0m
[94mEpoch: 2|  NKD Loss: 2.1935 | CT Loss: 5.2414| [0m
[91mEpoch: 2|  Loss:  7.764 |Global loss: 9.9665| Local H loss: 0.0412  | Global H loss: 0.0452 [0m
[94mEpoch: 3|  NKD Loss: 2.1916 | CT Loss: 5.2389| [0m
[91mEpoch: 3|  Loss:  7.7423 |Global loss: 9.9649| Local H loss: 0.0428  | Global H loss: 0.0466 [0m
[94mEpoch: 0|  NKD Loss: 2.1815 | CT Loss: 5.2456| [0m
[91mEpoch: 0|  Loss:  7.7146 |Global loss: 9.9615| Local H loss: 0.0431  | Global H loss: 0.0477 [0m
[94mEpoch: 1|  NKD Loss: 2.1763 | CT Loss: 5.2414| [0m
[91mEpoch: 1|  Loss:  7.6852 |Global loss: 9.9538| Local H loss: 0.0462  | Global H loss: 0.0501 [0m
[94mEpoch: 2|  NKD Loss: 2.1721 | CT Loss: 5.2387| [0m
[91mEpoch: 2|  Loss:  7.6715 |Global loss: 9.9493| Local H loss: 0.0478  | Global H loss: 0.0513 [0m
[94mEpoch: 3|  NKD Loss: 2.1677 | CT Loss: 5.2374| [0m
[91mEpoch: 3|  Loss:  7.6524 |Global loss: 9.9437| Local H loss: 0.0491  | Global H loss: 0.0524 [0m
------------------------- time cost ------------------------- 2.971717357635498
Chosen Clients:  [6, 12, 8, 7, 13, 0]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.984, 119.929, 119.953, 118.971, 119.939, 119.539, 119.503, 119.055, 119.114, 119.471, 119.286, 119.204, 119.936, 119.732, 119.155]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6173
Averaged Test Accurancy: 0.9600
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9582
Averaged Test Recal score: 0.9673
Std Test Accurancy: 0.0416
Std Test AUC: 0.0030
Std Test F1: 0.0004
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1755 | CT Loss: 5.2197| [0m
[91mEpoch: 0|  Loss:  7.6417 |Global loss: 9.9325| Local H loss: 0.0484  | Global H loss: 0.0518 [0m
[94mEpoch: 1|  NKD Loss: 2.1798 | CT Loss: 5.2168| [0m
[91mEpoch: 1|  Loss:  7.6497 |Global loss: 9.9322| Local H loss: 0.0476  | Global H loss: 0.0512 [0m
[94mEpoch: 2|  NKD Loss: 2.1728 | CT Loss: 5.2149| [0m
[91mEpoch: 2|  Loss:  7.6281 |Global loss: 9.9264| Local H loss: 0.0491  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.1695 | CT Loss: 5.2117| [0m
[91mEpoch: 3|  Loss:  7.615 |Global loss: 9.9223| Local H loss: 0.0501  | Global H loss: 0.0532 [0m
[94mEpoch: 0|  NKD Loss: 2.1857 | CT Loss: 5.1859| [0m
[91mEpoch: 0|  Loss:  7.689 |Global loss: 9.9086| Local H loss: 0.0479  | Global H loss: 0.0501 [0m
[94mEpoch: 1|  NKD Loss: 2.1702 | CT Loss: 5.1823| [0m
[91mEpoch: 1|  Loss:  7.6297 |Global loss: 9.8913| Local H loss: 0.05  | Global H loss: 0.052 [0m
[94mEpoch: 2|  NKD Loss: 2.1714 | CT Loss: 5.1805| [0m
[91mEpoch: 2|  Loss:  7.6409 |Global loss: 9.8923| Local H loss: 0.0515  | Global H loss: 0.0523 [0m
[94mEpoch: 3|  NKD Loss: 2.1699 | CT Loss: 5.1791| [0m
[91mEpoch: 3|  Loss:  7.6166 |Global loss: 9.8881| Local H loss: 0.0513  | Global H loss: 0.0529 [0m
[94mEpoch: 0|  NKD Loss: 2.2296 | CT Loss: 5.2623| [0m
[91mEpoch: 0|  Loss:  7.8822 |Global loss: 10.0154| Local H loss: 0.0338  | Global H loss: 0.0386 [0m
[94mEpoch: 1|  NKD Loss: 2.2187 | CT Loss: 5.2603| [0m
[91mEpoch: 1|  Loss:  7.8321 |Global loss: 10.0066| Local H loss: 0.036  | Global H loss: 0.0411 [0m
[94mEpoch: 2|  NKD Loss: 2.2088 | CT Loss: 5.2555| [0m
[91mEpoch: 2|  Loss:  7.7971 |Global loss: 9.9937| Local H loss: 0.0383  | Global H loss: 0.0432 [0m
[94mEpoch: 3|  NKD Loss: 2.208 | CT Loss: 5.2545| [0m
[91mEpoch: 3|  Loss:  7.7901 |Global loss: 9.9924| Local H loss: 0.0391  | Global H loss: 0.0438 [0m
[94mEpoch: 0|  NKD Loss: 2.2117 | CT Loss: 5.2429| [0m
[91mEpoch: 0|  Loss:  7.8438 |Global loss: 9.9798| Local H loss: 0.0359  | Global H loss: 0.0398 [0m
[94mEpoch: 1|  NKD Loss: 2.2056 | CT Loss: 5.2396| [0m
[91mEpoch: 1|  Loss:  7.8088 |Global loss: 9.9766| Local H loss: 0.0381  | Global H loss: 0.0421 [0m
[94mEpoch: 2|  NKD Loss: 2.2179 | CT Loss: 5.2381| [0m
[91mEpoch: 2|  Loss:  7.851 |Global loss: 9.9825| Local H loss: 0.0367  | Global H loss: 0.0404 [0m
[94mEpoch: 3|  NKD Loss: 2.2023 | CT Loss: 5.2348| [0m
[91mEpoch: 3|  Loss:  7.7834 |Global loss: 9.9665| Local H loss: 0.0401  | Global H loss: 0.0436 [0m
[94mEpoch: 0|  NKD Loss: 2.1802 | CT Loss: 5.2213| [0m
[91mEpoch: 0|  Loss:  7.7257 |Global loss: 9.9383| Local H loss: 0.0505  | Global H loss: 0.0508 [0m
[94mEpoch: 1|  NKD Loss: 2.1783 | CT Loss: 5.2175| [0m
[91mEpoch: 1|  Loss:  7.7264 |Global loss: 9.9314| Local H loss: 0.0519  | Global H loss: 0.0512 [0m
[94mEpoch: 2|  NKD Loss: 2.1879 | CT Loss: 5.2181| [0m
[91mEpoch: 2|  Loss:  7.7624 |Global loss: 9.943| Local H loss: 0.0498  | Global H loss: 0.0495 [0m
[94mEpoch: 3|  NKD Loss: 2.1781 | CT Loss: 5.2132| [0m
[91mEpoch: 3|  Loss:  7.724 |Global loss: 9.9285| Local H loss: 0.0524  | Global H loss: 0.0515 [0m
[94mEpoch: 0|  NKD Loss: 2.2174 | CT Loss: 5.2321| [0m
[91mEpoch: 0|  Loss:  7.8486 |Global loss: 9.9771| Local H loss: 0.0389  | Global H loss: 0.0418 [0m
[94mEpoch: 1|  NKD Loss: 2.2135 | CT Loss: 5.231| [0m
[91mEpoch: 1|  Loss:  7.8287 |Global loss: 9.9737| Local H loss: 0.0395  | Global H loss: 0.0426 [0m
[94mEpoch: 2|  NKD Loss: 2.2151 | CT Loss: 5.2294| [0m
[91mEpoch: 2|  Loss:  7.8321 |Global loss: 9.9729| Local H loss: 0.0393  | Global H loss: 0.0423 [0m
[94mEpoch: 3|  NKD Loss: 2.2121 | CT Loss: 5.2269| [0m
[91mEpoch: 3|  Loss:  7.8164 |Global loss: 9.9695| Local H loss: 0.0404  | Global H loss: 0.0432 [0m
------------------------- time cost ------------------------- 2.955730676651001
Chosen Clients:  [3, 12, 7, 2, 0, 4]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.9, 0.908, 0.975]
AUC in each clients:  [118.99, 119.929, 119.953, 118.971, 119.939, 119.539, 119.624, 119.023, 119.136, 119.471, 119.286, 119.204, 119.711, 119.728, 119.155]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.898, 0.91, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.914, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5943
Averaged Test Accurancy: 0.9589
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9576
Averaged Test Recal score: 0.9656
Std Test Accurancy: 0.0364
Std Test AUC: 0.0029
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1546 | CT Loss: 5.2306| [0m
[91mEpoch: 0|  Loss:  7.5854 |Global loss: 9.9266| Local H loss: 0.0572  | Global H loss: 0.0581 [0m
[94mEpoch: 1|  NKD Loss: 2.1605 | CT Loss: 5.2275| [0m
[91mEpoch: 1|  Loss:  7.5985 |Global loss: 9.9323| Local H loss: 0.0552  | Global H loss: 0.0567 [0m
[94mEpoch: 2|  NKD Loss: 2.1531 | CT Loss: 5.2253| [0m
[91mEpoch: 2|  Loss:  7.5795 |Global loss: 9.9227| Local H loss: 0.056  | Global H loss: 0.0577 [0m
[94mEpoch: 3|  NKD Loss: 2.1507 | CT Loss: 5.223| [0m
[91mEpoch: 3|  Loss:  7.5669 |Global loss: 9.9193| Local H loss: 0.0581  | Global H loss: 0.059 [0m
[94mEpoch: 0|  NKD Loss: 2.1652 | CT Loss: 5.1777| [0m
[91mEpoch: 0|  Loss:  7.6142 |Global loss: 9.8843| Local H loss: 0.0534  | Global H loss: 0.0537 [0m
[94mEpoch: 1|  NKD Loss: 2.1696 | CT Loss: 5.1734| [0m
[91mEpoch: 1|  Loss:  7.6109 |Global loss: 9.8831| Local H loss: 0.0525  | Global H loss: 0.0534 [0m
[94mEpoch: 2|  NKD Loss: 2.1726 | CT Loss: 5.1708| [0m
[91mEpoch: 2|  Loss:  7.6161 |Global loss: 9.8849| Local H loss: 0.0542  | Global H loss: 0.0545 [0m
[94mEpoch: 3|  NKD Loss: 2.1588 | CT Loss: 5.1681| [0m
[91mEpoch: 3|  Loss:  7.5772 |Global loss: 9.8667| Local H loss: 0.0546  | Global H loss: 0.0548 [0m
[94mEpoch: 0|  NKD Loss: 2.1933 | CT Loss: 5.2329| [0m
[91mEpoch: 0|  Loss:  7.7473 |Global loss: 9.9572| Local H loss: 0.0412  | Global H loss: 0.0449 [0m
[94mEpoch: 1|  NKD Loss: 2.2007 | CT Loss: 5.2306| [0m
[91mEpoch: 1|  Loss:  7.7728 |Global loss: 9.9628| Local H loss: 0.0412  | Global H loss: 0.0443 [0m
[94mEpoch: 2|  NKD Loss: 2.1893 | CT Loss: 5.2275| [0m
[91mEpoch: 2|  Loss:  7.7309 |Global loss: 9.9499| Local H loss: 0.0433  | Global H loss: 0.0463 [0m
[94mEpoch: 3|  NKD Loss: 2.1863 | CT Loss: 5.224| [0m
[91mEpoch: 3|  Loss:  7.7089 |Global loss: 9.9419| Local H loss: 0.0454  | Global H loss: 0.0481 [0m
[94mEpoch: 0|  NKD Loss: 2.1657 | CT Loss: 5.2026| [0m
[91mEpoch: 0|  Loss:  7.6163 |Global loss: 9.9109| Local H loss: 0.0528  | Global H loss: 0.0541 [0m
[94mEpoch: 1|  NKD Loss: 2.214 | CT Loss: 5.2023| [0m
[91mEpoch: 1|  Loss:  7.7811 |Global loss: 9.9543| Local H loss: 0.0487  | Global H loss: 0.05 [0m
[94mEpoch: 2|  NKD Loss: 2.1575 | CT Loss: 5.1976| [0m
[91mEpoch: 2|  Loss:  7.5887 |Global loss: 9.8979| Local H loss: 0.0538  | Global H loss: 0.055 [0m
[94mEpoch: 3|  NKD Loss: 2.1493 | CT Loss: 5.197| [0m
[91mEpoch: 3|  Loss:  7.5571 |Global loss: 9.8905| Local H loss: 0.0578  | Global H loss: 0.0576 [0m
[94mEpoch: 0|  NKD Loss: 2.2017 | CT Loss: 5.2243| [0m
[91mEpoch: 0|  Loss:  7.7708 |Global loss: 9.9526| Local H loss: 0.0432  | Global H loss: 0.0455 [0m
[94mEpoch: 1|  NKD Loss: 2.1987 | CT Loss: 5.2226| [0m
[91mEpoch: 1|  Loss:  7.7632 |Global loss: 9.9521| Local H loss: 0.0433  | Global H loss: 0.0458 [0m
[94mEpoch: 2|  NKD Loss: 2.2077 | CT Loss: 5.2188| [0m
[91mEpoch: 2|  Loss:  7.7938 |Global loss: 9.9587| Local H loss: 0.0424  | Global H loss: 0.0449 [0m
[94mEpoch: 3|  NKD Loss: 2.2034 | CT Loss: 5.2181| [0m
[91mEpoch: 3|  Loss:  7.7738 |Global loss: 9.9545| Local H loss: 0.0445  | Global H loss: 0.0463 [0m
[94mEpoch: 0|  NKD Loss: 2.1698 | CT Loss: 5.2408| [0m
[91mEpoch: 0|  Loss:  7.7127 |Global loss: 9.9488| Local H loss: 0.0518  | Global H loss: 0.0521 [0m
[94mEpoch: 1|  NKD Loss: 2.1735 | CT Loss: 5.2381| [0m
[91mEpoch: 1|  Loss:  7.7112 |Global loss: 9.9483| Local H loss: 0.0506  | Global H loss: 0.0516 [0m
[94mEpoch: 2|  NKD Loss: 2.1693 | CT Loss: 5.2346| [0m
[91mEpoch: 2|  Loss:  7.7031 |Global loss: 9.942| Local H loss: 0.0521  | Global H loss: 0.0523 [0m
[94mEpoch: 3|  NKD Loss: 2.1631 | CT Loss: 5.2328| [0m
[91mEpoch: 3|  Loss:  7.6716 |Global loss: 9.9353| Local H loss: 0.0552  | Global H loss: 0.0545 [0m
------------------------- time cost ------------------------- 2.9207193851470947
Chosen Clients:  [10, 9, 8, 6, 0, 11]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.908, 0.975]
AUC in each clients:  [118.945, 119.929, 119.967, 118.996, 119.939, 119.539, 119.624, 119.014, 119.136, 119.471, 119.286, 119.204, 119.954, 119.728, 119.155]
F1 Score:  [0.974, 0.973, 0.974, 0.981, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.973, 0.91, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5684
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9955
Averaged Test F1_score: 0.9631
Averaged Test Recal score: 0.9703
Std Test Accurancy: 0.0333
Std Test AUC: 0.0031
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.2525 | CT Loss: 5.2705| [0m
[91mEpoch: 0|  Loss:  8.134 |Global loss: 10.0371| Local H loss: 0.0237  | Global H loss: 0.028 [0m
[94mEpoch: 1|  NKD Loss: 2.2547 | CT Loss: 5.2687| [0m
[91mEpoch: 1|  Loss:  8.1277 |Global loss: 10.0394| Local H loss: 0.0244  | Global H loss: 0.0288 [0m
[94mEpoch: 2|  NKD Loss: 2.2446 | CT Loss: 5.2649| [0m
[91mEpoch: 2|  Loss:  8.0716 |Global loss: 10.0254| Local H loss: 0.0267  | Global H loss: 0.0309 [0m
[94mEpoch: 3|  NKD Loss: 2.2369 | CT Loss: 5.2615| [0m
[91mEpoch: 3|  Loss:  8.0251 |Global loss: 10.018| Local H loss: 0.0289  | Global H loss: 0.0332 [0m
[94mEpoch: 0|  NKD Loss: 2.1417 | CT Loss: 5.2207| [0m
[91mEpoch: 0|  Loss:  7.5373 |Global loss: 9.908| Local H loss: 0.0628  | Global H loss: 0.062 [0m
[94mEpoch: 1|  NKD Loss: 2.1391 | CT Loss: 5.2175| [0m
[91mEpoch: 1|  Loss:  7.53 |Global loss: 9.9053| Local H loss: 0.064  | Global H loss: 0.0627 [0m
[94mEpoch: 2|  NKD Loss: 2.1454 | CT Loss: 5.2157| [0m
[91mEpoch: 2|  Loss:  7.5441 |Global loss: 9.9083| Local H loss: 0.0621  | Global H loss: 0.0614 [0m
[94mEpoch: 3|  NKD Loss: 2.137 | CT Loss: 5.2148| [0m
[91mEpoch: 3|  Loss:  7.5206 |Global loss: 9.9053| Local H loss: 0.0656  | Global H loss: 0.0636 [0m
[94mEpoch: 0|  NKD Loss: 2.2082 | CT Loss: 5.2537| [0m
[91mEpoch: 0|  Loss:  7.7853 |Global loss: 9.9955| Local H loss: 0.0398  | Global H loss: 0.0445 [0m
[94mEpoch: 1|  NKD Loss: 2.2081 | CT Loss: 5.2502| [0m
[91mEpoch: 1|  Loss:  7.7775 |Global loss: 9.9896| Local H loss: 0.04  | Global H loss: 0.0447 [0m
[94mEpoch: 2|  NKD Loss: 2.1961 | CT Loss: 5.246| [0m
[91mEpoch: 2|  Loss:  7.7329 |Global loss: 9.9758| Local H loss: 0.0427  | Global H loss: 0.0472 [0m
[94mEpoch: 3|  NKD Loss: 2.2092 | CT Loss: 5.2447| [0m
[91mEpoch: 3|  Loss:  7.7727 |Global loss: 9.9875| Local H loss: 0.042  | Global H loss: 0.0462 [0m
[94mEpoch: 0|  NKD Loss: 2.1665 | CT Loss: 5.2078| [0m
[91mEpoch: 0|  Loss:  7.6036 |Global loss: 9.9146| Local H loss: 0.0508  | Global H loss: 0.0537 [0m
[94mEpoch: 1|  NKD Loss: 2.1673 | CT Loss: 5.206| [0m
[91mEpoch: 1|  Loss:  7.598 |Global loss: 9.9167| Local H loss: 0.052  | Global H loss: 0.0545 [0m
[94mEpoch: 2|  NKD Loss: 2.162 | CT Loss: 5.2036| [0m
[91mEpoch: 2|  Loss:  7.5824 |Global loss: 9.9084| Local H loss: 0.0527  | Global H loss: 0.0554 [0m
[94mEpoch: 3|  NKD Loss: 2.1618 | CT Loss: 5.2006| [0m
[91mEpoch: 3|  Loss:  7.5797 |Global loss: 9.9043| Local H loss: 0.0535  | Global H loss: 0.0556 [0m
[94mEpoch: 0|  NKD Loss: 2.191 | CT Loss: 5.2147| [0m
[91mEpoch: 0|  Loss:  7.7296 |Global loss: 9.9396| Local H loss: 0.0453  | Global H loss: 0.0473 [0m
[94mEpoch: 1|  NKD Loss: 2.1929 | CT Loss: 5.2121| [0m
[91mEpoch: 1|  Loss:  7.7317 |Global loss: 9.9406| Local H loss: 0.0458  | Global H loss: 0.0474 [0m
[94mEpoch: 2|  NKD Loss: 2.1904 | CT Loss: 5.2112| [0m
[91mEpoch: 2|  Loss:  7.7199 |Global loss: 9.9346| Local H loss: 0.0464  | Global H loss: 0.0481 [0m
[94mEpoch: 3|  NKD Loss: 2.1836 | CT Loss: 5.2068| [0m
[91mEpoch: 3|  Loss:  7.6928 |Global loss: 9.9271| Local H loss: 0.0474  | Global H loss: 0.049 [0m
[94mEpoch: 0|  NKD Loss: 2.1638 | CT Loss: 5.2339| [0m
[91mEpoch: 0|  Loss:  7.6391 |Global loss: 9.939| Local H loss: 0.0497  | Global H loss: 0.053 [0m
[94mEpoch: 1|  NKD Loss: 2.1633 | CT Loss: 5.2306| [0m
[91mEpoch: 1|  Loss:  7.6332 |Global loss: 9.9356| Local H loss: 0.0513  | Global H loss: 0.0538 [0m
[94mEpoch: 2|  NKD Loss: 2.1561 | CT Loss: 5.2284| [0m
[91mEpoch: 2|  Loss:  7.6086 |Global loss: 9.9281| Local H loss: 0.0531  | Global H loss: 0.0555 [0m
[94mEpoch: 3|  NKD Loss: 2.1556 | CT Loss: 5.227| [0m
[91mEpoch: 3|  Loss:  7.6011 |Global loss: 9.9239| Local H loss: 0.0536  | Global H loss: 0.0558 [0m
------------------------- time cost ------------------------- 2.9499597549438477
Chosen Clients:  [4, 7, 3, 2, 10, 14]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.908, 0.975]
AUC in each clients:  [118.984, 119.929, 119.967, 118.996, 119.939, 119.539, 119.798, 119.014, 119.379, 119.562, 119.553, 119.384, 119.954, 119.728, 119.155]
F1 Score:  [0.974, 0.973, 0.974, 0.981, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.857, 0.981, 0.973, 0.91, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5360
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9631
Averaged Test Recal score: 0.9703
Std Test Accurancy: 0.0333
Std Test AUC: 0.0029
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1651 | CT Loss: 5.23| [0m
[91mEpoch: 0|  Loss:  7.6805 |Global loss: 9.9319| Local H loss: 0.0544  | Global H loss: 0.0538 [0m
[94mEpoch: 1|  NKD Loss: 2.1602 | CT Loss: 5.2281| [0m
[91mEpoch: 1|  Loss:  7.6596 |Global loss: 9.9303| Local H loss: 0.0559  | Global H loss: 0.0548 [0m
[94mEpoch: 2|  NKD Loss: 2.1613 | CT Loss: 5.2254| [0m
[91mEpoch: 2|  Loss:  7.6554 |Global loss: 9.9264| Local H loss: 0.0551  | Global H loss: 0.0545 [0m
[94mEpoch: 3|  NKD Loss: 2.1687 | CT Loss: 5.2235| [0m
[91mEpoch: 3|  Loss:  7.6719 |Global loss: 9.9329| Local H loss: 0.0554  | Global H loss: 0.0545 [0m
[94mEpoch: 0|  NKD Loss: 2.2193 | CT Loss: 5.2242| [0m
[91mEpoch: 0|  Loss:  7.8192 |Global loss: 9.9743| Local H loss: 0.0426  | Global H loss: 0.045 [0m
[94mEpoch: 1|  NKD Loss: 2.176 | CT Loss: 5.2189| [0m
[91mEpoch: 1|  Loss:  7.6829 |Global loss: 9.9304| Local H loss: 0.0461  | Global H loss: 0.0487 [0m
[94mEpoch: 2|  NKD Loss: 2.1725 | CT Loss: 5.2166| [0m
[91mEpoch: 2|  Loss:  7.6581 |Global loss: 9.9258| Local H loss: 0.0489  | Global H loss: 0.0507 [0m
[94mEpoch: 3|  NKD Loss: 2.1833 | CT Loss: 5.2169| [0m
[91mEpoch: 3|  Loss:  7.6909 |Global loss: 9.9384| Local H loss: 0.0479  | Global H loss: 0.0494 [0m
[94mEpoch: 0|  NKD Loss: 2.1475 | CT Loss: 5.2201| [0m
[91mEpoch: 0|  Loss:  7.554 |Global loss: 9.9144| Local H loss: 0.0602  | Global H loss: 0.0602 [0m
[94mEpoch: 1|  NKD Loss: 2.1428 | CT Loss: 5.2173| [0m
[91mEpoch: 1|  Loss:  7.5398 |Global loss: 9.908| Local H loss: 0.0613  | Global H loss: 0.0611 [0m
[94mEpoch: 2|  NKD Loss: 2.144 | CT Loss: 5.2175| [0m
[91mEpoch: 2|  Loss:  7.5393 |Global loss: 9.9114| Local H loss: 0.0612  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1409 | CT Loss: 5.2149| [0m
[91mEpoch: 3|  Loss:  7.5348 |Global loss: 9.9036| Local H loss: 0.0625  | Global H loss: 0.0616 [0m
[94mEpoch: 0|  NKD Loss: 2.1412 | CT Loss: 5.1927| [0m
[91mEpoch: 0|  Loss:  7.5259 |Global loss: 9.8814| Local H loss: 0.06  | Global H loss: 0.0594 [0m
[94mEpoch: 1|  NKD Loss: 2.1543 | CT Loss: 5.1916| [0m
[91mEpoch: 1|  Loss:  7.5623 |Global loss: 9.8899| Local H loss: 0.0591  | Global H loss: 0.0579 [0m
[94mEpoch: 2|  NKD Loss: 2.1445 | CT Loss: 5.1895| [0m
[91mEpoch: 2|  Loss:  7.5323 |Global loss: 9.8785| Local H loss: 0.0599  | Global H loss: 0.0591 [0m
[94mEpoch: 3|  NKD Loss: 2.1415 | CT Loss: 5.1874| [0m
[91mEpoch: 3|  Loss:  7.5124 |Global loss: 9.8758| Local H loss: 0.0624  | Global H loss: 0.061 [0m
[94mEpoch: 0|  NKD Loss: 2.2387 | CT Loss: 5.26| [0m
[91mEpoch: 0|  Loss:  8.0251 |Global loss: 10.0193| Local H loss: 0.0289  | Global H loss: 0.0331 [0m
[94mEpoch: 1|  NKD Loss: 2.2336 | CT Loss: 5.2563| [0m
[91mEpoch: 1|  Loss:  7.987 |Global loss: 10.0135| Local H loss: 0.0306  | Global H loss: 0.0348 [0m
[94mEpoch: 2|  NKD Loss: 2.232 | CT Loss: 5.2522| [0m
[91mEpoch: 2|  Loss:  7.9652 |Global loss: 10.0081| Local H loss: 0.0319  | Global H loss: 0.0359 [0m
[94mEpoch: 3|  NKD Loss: 2.2301 | CT Loss: 5.2525| [0m
[91mEpoch: 3|  Loss:  7.9623 |Global loss: 10.005| Local H loss: 0.0325  | Global H loss: 0.0365 [0m
[94mEpoch: 0|  NKD Loss: 2.1635 | CT Loss: 5.2331| [0m
[91mEpoch: 0|  Loss:  7.6195 |Global loss: 9.9378| Local H loss: 0.055  | Global H loss: 0.0561 [0m
[94mEpoch: 1|  NKD Loss: 2.1474 | CT Loss: 5.2303| [0m
[91mEpoch: 1|  Loss:  7.5738 |Global loss: 9.9209| Local H loss: 0.0585  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1434 | CT Loss: 5.2277| [0m
[91mEpoch: 2|  Loss:  7.5592 |Global loss: 9.9174| Local H loss: 0.0603  | Global H loss: 0.0602 [0m
[94mEpoch: 3|  NKD Loss: 2.1443 | CT Loss: 5.2258| [0m
[91mEpoch: 3|  Loss:  7.5592 |Global loss: 9.9173| Local H loss: 0.0615  | Global H loss: 0.0607 [0m
------------------------- time cost ------------------------- 2.9951682090759277
Chosen Clients:  [2, 4, 14, 8, 13, 12]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.883, 0.983, 0.975, 0.908, 0.975]
AUC in each clients:  [118.984, 119.929, 119.966, 118.995, 119.914, 119.539, 119.798, 118.996, 119.379, 119.562, 119.673, 119.384, 119.954, 119.728, 119.038]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.953, 0.982, 0.974, 0.973, 0.974, 0.973, 0.89, 0.981, 0.973, 0.91, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.917, 0.984, 0.977, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5219
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9634
Averaged Test Recal score: 0.9695
Std Test Accurancy: 0.0278
Std Test AUC: 0.0030
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1531 | CT Loss: 5.1865| [0m
[91mEpoch: 0|  Loss:  7.5449 |Global loss: 9.884| Local H loss: 0.0605  | Global H loss: 0.0591 [0m
[94mEpoch: 1|  NKD Loss: 2.1413 | CT Loss: 5.1828| [0m
[91mEpoch: 1|  Loss:  7.5112 |Global loss: 9.8703| Local H loss: 0.0638  | Global H loss: 0.0613 [0m
[94mEpoch: 2|  NKD Loss: 2.1388 | CT Loss: 5.181| [0m
[91mEpoch: 2|  Loss:  7.4997 |Global loss: 9.869| Local H loss: 0.0642  | Global H loss: 0.0618 [0m
[94mEpoch: 3|  NKD Loss: 2.1365 | CT Loss: 5.1788| [0m
[91mEpoch: 3|  Loss:  7.4928 |Global loss: 9.8664| Local H loss: 0.0647  | Global H loss: 0.0622 [0m
[94mEpoch: 0|  NKD Loss: 2.1622 | CT Loss: 5.221| [0m
[91mEpoch: 0|  Loss:  7.6532 |Global loss: 9.9247| Local H loss: 0.0568  | Global H loss: 0.0554 [0m
[94mEpoch: 1|  NKD Loss: 2.157 | CT Loss: 5.2178| [0m
[91mEpoch: 1|  Loss:  7.6286 |Global loss: 9.9187| Local H loss: 0.0577  | Global H loss: 0.0562 [0m
[94mEpoch: 2|  NKD Loss: 2.1599 | CT Loss: 5.2157| [0m
[91mEpoch: 2|  Loss:  7.6417 |Global loss: 9.9185| Local H loss: 0.0592  | Global H loss: 0.0569 [0m
[94mEpoch: 3|  NKD Loss: 2.1551 | CT Loss: 5.2128| [0m
[91mEpoch: 3|  Loss:  7.6235 |Global loss: 9.9098| Local H loss: 0.0584  | Global H loss: 0.0563 [0m
[94mEpoch: 0|  NKD Loss: 2.1413 | CT Loss: 5.2229| [0m
[91mEpoch: 0|  Loss:  7.5473 |Global loss: 9.9143| Local H loss: 0.062  | Global H loss: 0.0611 [0m
[94mEpoch: 1|  NKD Loss: 2.1385 | CT Loss: 5.2219| [0m
[91mEpoch: 1|  Loss:  7.5338 |Global loss: 9.9094| Local H loss: 0.0644  | Global H loss: 0.0627 [0m
[94mEpoch: 2|  NKD Loss: 2.1383 | CT Loss: 5.2192| [0m
[91mEpoch: 2|  Loss:  7.5332 |Global loss: 9.9071| Local H loss: 0.0641  | Global H loss: 0.0625 [0m
[94mEpoch: 3|  NKD Loss: 2.1415 | CT Loss: 5.2162| [0m
[91mEpoch: 3|  Loss:  7.5361 |Global loss: 9.906| Local H loss: 0.0641  | Global H loss: 0.0621 [0m
[94mEpoch: 0|  NKD Loss: 2.1999 | CT Loss: 5.2416| [0m
[91mEpoch: 0|  Loss:  7.7455 |Global loss: 9.9753| Local H loss: 0.0416  | Global H loss: 0.0459 [0m
[94mEpoch: 1|  NKD Loss: 2.1893 | CT Loss: 5.2403| [0m
[91mEpoch: 1|  Loss:  7.7119 |Global loss: 9.9651| Local H loss: 0.0446  | Global H loss: 0.0487 [0m
[94mEpoch: 2|  NKD Loss: 2.1918 | CT Loss: 5.2373| [0m
[91mEpoch: 2|  Loss:  7.7099 |Global loss: 9.9643| Local H loss: 0.0447  | Global H loss: 0.0488 [0m
[94mEpoch: 3|  NKD Loss: 2.1716 | CT Loss: 5.2337| [0m
[91mEpoch: 3|  Loss:  7.6442 |Global loss: 9.9414| Local H loss: 0.0489  | Global H loss: 0.0526 [0m
[94mEpoch: 0|  NKD Loss: 2.1732 | CT Loss: 5.2114| [0m
[91mEpoch: 0|  Loss:  7.7044 |Global loss: 9.9248| Local H loss: 0.0541  | Global H loss: 0.0526 [0m
[94mEpoch: 1|  NKD Loss: 2.1778 | CT Loss: 5.2106| [0m
[91mEpoch: 1|  Loss:  7.713 |Global loss: 9.9256| Local H loss: 0.0531  | Global H loss: 0.0517 [0m
[94mEpoch: 2|  NKD Loss: 2.171 | CT Loss: 5.2084| [0m
[91mEpoch: 2|  Loss:  7.6908 |Global loss: 9.9231| Local H loss: 0.0557  | Global H loss: 0.0535 [0m
[94mEpoch: 3|  NKD Loss: 2.1714 | CT Loss: 5.2066| [0m
[91mEpoch: 3|  Loss:  7.6883 |Global loss: 9.9182| Local H loss: 0.0564  | Global H loss: 0.0536 [0m
[94mEpoch: 0|  NKD Loss: 2.1635 | CT Loss: 5.1645| [0m
[91mEpoch: 0|  Loss:  7.5821 |Global loss: 9.8678| Local H loss: 0.0548  | Global H loss: 0.0551 [0m
[94mEpoch: 1|  NKD Loss: 2.1528 | CT Loss: 5.1613| [0m
[91mEpoch: 1|  Loss:  7.5451 |Global loss: 9.8589| Local H loss: 0.0579  | Global H loss: 0.0571 [0m
[94mEpoch: 2|  NKD Loss: 2.1579 | CT Loss: 5.1624| [0m
[91mEpoch: 2|  Loss:  7.5647 |Global loss: 9.8634| Local H loss: 0.0565  | Global H loss: 0.0561 [0m
[94mEpoch: 3|  NKD Loss: 2.1585 | CT Loss: 5.1596| [0m
[91mEpoch: 3|  Loss:  7.5527 |Global loss: 9.8622| Local H loss: 0.0569  | Global H loss: 0.0564 [0m
------------------------- time cost ------------------------- 3.287405014038086
Chosen Clients:  [8, 0, 7, 14, 9, 1]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.883, 0.983, 0.975, 0.917, 0.975]
AUC in each clients:  [118.984, 119.929, 119.971, 118.995, 119.955, 119.539, 119.798, 118.996, 119.083, 119.562, 119.673, 119.384, 119.957, 119.81, 119.03]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.89, 0.981, 0.973, 0.918, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.917, 0.984, 0.977, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5094
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9653
Averaged Test Recal score: 0.9713
Std Test Accurancy: 0.0268
Std Test AUC: 0.0032
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1748 | CT Loss: 5.2324| [0m
[91mEpoch: 0|  Loss:  7.6494 |Global loss: 9.9476| Local H loss: 0.0491  | Global H loss: 0.0526 [0m
[94mEpoch: 1|  NKD Loss: 2.1735 | CT Loss: 5.2291| [0m
[91mEpoch: 1|  Loss:  7.6377 |Global loss: 9.9419| Local H loss: 0.0498  | Global H loss: 0.0531 [0m
[94mEpoch: 2|  NKD Loss: 2.1675 | CT Loss: 5.2253| [0m
[91mEpoch: 2|  Loss:  7.6219 |Global loss: 9.9327| Local H loss: 0.0512  | Global H loss: 0.0544 [0m
[94mEpoch: 3|  NKD Loss: 2.1674 | CT Loss: 5.2243| [0m
[91mEpoch: 3|  Loss:  7.6173 |Global loss: 9.9372| Local H loss: 0.0516  | Global H loss: 0.0545 [0m
[94mEpoch: 0|  NKD Loss: 2.1785 | CT Loss: 5.2049| [0m
[91mEpoch: 0|  Loss:  7.6737 |Global loss: 9.9221| Local H loss: 0.0492  | Global H loss: 0.0503 [0m
[94mEpoch: 1|  NKD Loss: 2.1793 | CT Loss: 5.2048| [0m
[91mEpoch: 1|  Loss:  7.6727 |Global loss: 9.922| Local H loss: 0.0499  | Global H loss: 0.0507 [0m
[94mEpoch: 2|  NKD Loss: 2.1807 | CT Loss: 5.2018| [0m
[91mEpoch: 2|  Loss:  7.6712 |Global loss: 9.9198| Local H loss: 0.0501  | Global H loss: 0.051 [0m
[94mEpoch: 3|  NKD Loss: 2.1738 | CT Loss: 5.1995| [0m
[91mEpoch: 3|  Loss:  7.6517 |Global loss: 9.9133| Local H loss: 0.0509  | Global H loss: 0.0515 [0m
[94mEpoch: 0|  NKD Loss: 2.1648 | CT Loss: 5.2122| [0m
[91mEpoch: 0|  Loss:  7.624 |Global loss: 9.9155| Local H loss: 0.0514  | Global H loss: 0.0528 [0m
[94mEpoch: 1|  NKD Loss: 2.1769 | CT Loss: 5.2102| [0m
[91mEpoch: 1|  Loss:  7.6556 |Global loss: 9.9251| Local H loss: 0.0499  | Global H loss: 0.0513 [0m
[94mEpoch: 2|  NKD Loss: 2.1641 | CT Loss: 5.2084| [0m
[91mEpoch: 2|  Loss:  7.6139 |Global loss: 9.9122| Local H loss: 0.0524  | Global H loss: 0.0535 [0m
[94mEpoch: 3|  NKD Loss: 2.2006 | CT Loss: 5.2065| [0m
[91mEpoch: 3|  Loss:  7.7215 |Global loss: 9.9407| Local H loss: 0.0485  | Global H loss: 0.0493 [0m
[94mEpoch: 0|  NKD Loss: 2.1402 | CT Loss: 5.2152| [0m
[91mEpoch: 0|  Loss:  7.5328 |Global loss: 9.9037| Local H loss: 0.0647  | Global H loss: 0.0625 [0m
[94mEpoch: 1|  NKD Loss: 2.1353 | CT Loss: 5.2129| [0m
[91mEpoch: 1|  Loss:  7.5175 |Global loss: 9.896| Local H loss: 0.0662  | Global H loss: 0.0635 [0m
[94mEpoch: 2|  NKD Loss: 2.1351 | CT Loss: 5.2104| [0m
[91mEpoch: 2|  Loss:  7.5153 |Global loss: 9.8971| Local H loss: 0.0666  | Global H loss: 0.0635 [0m
[94mEpoch: 3|  NKD Loss: 2.1331 | CT Loss: 5.2084| [0m
[91mEpoch: 3|  Loss:  7.5048 |Global loss: 9.8926| Local H loss: 0.0681  | Global H loss: 0.0646 [0m
[94mEpoch: 0|  NKD Loss: 2.1395 | CT Loss: 5.2116| [0m
[91mEpoch: 0|  Loss:  7.5244 |Global loss: 9.8989| Local H loss: 0.0653  | Global H loss: 0.0631 [0m
[94mEpoch: 1|  NKD Loss: 2.1353 | CT Loss: 5.2094| [0m
[91mEpoch: 1|  Loss:  7.5127 |Global loss: 9.8952| Local H loss: 0.066  | Global H loss: 0.0638 [0m
[94mEpoch: 2|  NKD Loss: 2.1354 | CT Loss: 5.2079| [0m
[91mEpoch: 2|  Loss:  7.5099 |Global loss: 9.8962| Local H loss: 0.0666  | Global H loss: 0.064 [0m
[94mEpoch: 3|  NKD Loss: 2.1342 | CT Loss: 5.2061| [0m
[91mEpoch: 3|  Loss:  7.5047 |Global loss: 9.8917| Local H loss: 0.0667  | Global H loss: 0.0642 [0m
[94mEpoch: 0|  NKD Loss: 2.1528 | CT Loss: 5.2004| [0m
[91mEpoch: 0|  Loss:  7.5852 |Global loss: 9.8938| Local H loss: 0.0568  | Global H loss: 0.0561 [0m
[94mEpoch: 1|  NKD Loss: 2.1697 | CT Loss: 5.1985| [0m
[91mEpoch: 1|  Loss:  7.6372 |Global loss: 9.91| Local H loss: 0.056  | Global H loss: 0.0552 [0m
[94mEpoch: 2|  NKD Loss: 2.1568 | CT Loss: 5.1965| [0m
[91mEpoch: 2|  Loss:  7.5906 |Global loss: 9.8962| Local H loss: 0.0567  | Global H loss: 0.0562 [0m
[94mEpoch: 3|  NKD Loss: 2.17 | CT Loss: 5.1934| [0m
[91mEpoch: 3|  Loss:  7.6386 |Global loss: 9.9067| Local H loss: 0.0565  | Global H loss: 0.0554 [0m
------------------------- time cost ------------------------- 3.026592254638672
Chosen Clients:  [4, 0, 12, 5, 9, 2]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.883, 0.983, 0.975, 0.917, 0.975]
AUC in each clients:  [118.982, 119.908, 119.971, 118.995, 119.955, 119.539, 119.798, 119.0, 119.036, 119.679, 119.673, 119.384, 119.957, 119.81, 118.998]
F1 Score:  [0.974, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.89, 0.981, 0.973, 0.918, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.917, 0.984, 0.977, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4952
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9653
Averaged Test Recal score: 0.9713
Std Test Accurancy: 0.0268
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.152 | CT Loss: 5.2099| [0m
[91mEpoch: 0|  Loss:  7.6037 |Global loss: 9.9077| Local H loss: 0.0605  | Global H loss: 0.0578 [0m
[94mEpoch: 1|  NKD Loss: 2.155 | CT Loss: 5.2088| [0m
[91mEpoch: 1|  Loss:  7.6075 |Global loss: 9.9108| Local H loss: 0.0605  | Global H loss: 0.058 [0m
[94mEpoch: 2|  NKD Loss: 2.1485 | CT Loss: 5.2063| [0m
[91mEpoch: 2|  Loss:  7.5862 |Global loss: 9.9027| Local H loss: 0.0608  | Global H loss: 0.0582 [0m
[94mEpoch: 3|  NKD Loss: 2.1538 | CT Loss: 5.206| [0m
[91mEpoch: 3|  Loss:  7.5939 |Global loss: 9.9059| Local H loss: 0.0616  | Global H loss: 0.0583 [0m
[94mEpoch: 0|  NKD Loss: 2.1749 | CT Loss: 5.1983| [0m
[91mEpoch: 0|  Loss:  7.6469 |Global loss: 9.9106| Local H loss: 0.0519  | Global H loss: 0.0522 [0m
[94mEpoch: 1|  NKD Loss: 2.1683 | CT Loss: 5.1941| [0m
[91mEpoch: 1|  Loss:  7.6276 |Global loss: 9.9044| Local H loss: 0.0533  | Global H loss: 0.0531 [0m
[94mEpoch: 2|  NKD Loss: 2.167 | CT Loss: 5.1918| [0m
[91mEpoch: 2|  Loss:  7.6172 |Global loss: 9.9004| Local H loss: 0.0536  | Global H loss: 0.0535 [0m
[94mEpoch: 3|  NKD Loss: 2.1678 | CT Loss: 5.1913| [0m
[91mEpoch: 3|  Loss:  7.6188 |Global loss: 9.8983| Local H loss: 0.0542  | Global H loss: 0.0537 [0m
[94mEpoch: 0|  NKD Loss: 2.1506 | CT Loss: 5.1561| [0m
[91mEpoch: 0|  Loss:  7.5295 |Global loss: 9.8519| Local H loss: 0.0584  | Global H loss: 0.0577 [0m
[94mEpoch: 1|  NKD Loss: 2.169 | CT Loss: 5.1526| [0m
[91mEpoch: 1|  Loss:  7.5813 |Global loss: 9.8625| Local H loss: 0.0575  | Global H loss: 0.0563 [0m
[94mEpoch: 2|  NKD Loss: 2.1542 | CT Loss: 5.1528| [0m
[91mEpoch: 2|  Loss:  7.5427 |Global loss: 9.8523| Local H loss: 0.0561  | Global H loss: 0.0561 [0m
[94mEpoch: 3|  NKD Loss: 2.1541 | CT Loss: 5.15| [0m
[91mEpoch: 3|  Loss:  7.5405 |Global loss: 9.8493| Local H loss: 0.0587  | Global H loss: 0.0573 [0m
[94mEpoch: 0|  NKD Loss: 2.1979 | CT Loss: 5.2391| [0m
[91mEpoch: 0|  Loss:  7.7686 |Global loss: 9.9701| Local H loss: 0.042  | Global H loss: 0.0455 [0m
[94mEpoch: 1|  NKD Loss: 2.1867 | CT Loss: 5.2349| [0m
[91mEpoch: 1|  Loss:  7.7346 |Global loss: 9.9549| Local H loss: 0.0444  | Global H loss: 0.0476 [0m
[94mEpoch: 2|  NKD Loss: 2.1809 | CT Loss: 5.2325| [0m
[91mEpoch: 2|  Loss:  7.7019 |Global loss: 9.9496| Local H loss: 0.0458  | Global H loss: 0.049 [0m
[94mEpoch: 3|  NKD Loss: 2.1811 | CT Loss: 5.2302| [0m
[91mEpoch: 3|  Loss:  7.6982 |Global loss: 9.9464| Local H loss: 0.0462  | Global H loss: 0.0492 [0m
[94mEpoch: 0|  NKD Loss: 2.1346 | CT Loss: 5.2036| [0m
[91mEpoch: 0|  Loss:  7.5014 |Global loss: 9.8867| Local H loss: 0.0677  | Global H loss: 0.0645 [0m
[94mEpoch: 1|  NKD Loss: 2.1334 | CT Loss: 5.2012| [0m
[91mEpoch: 1|  Loss:  7.4958 |Global loss: 9.8848| Local H loss: 0.0682  | Global H loss: 0.065 [0m
[94mEpoch: 2|  NKD Loss: 2.1306 | CT Loss: 5.2009| [0m
[91mEpoch: 2|  Loss:  7.4889 |Global loss: 9.8873| Local H loss: 0.0689  | Global H loss: 0.0653 [0m
[94mEpoch: 3|  NKD Loss: 2.1306 | CT Loss: 5.1985| [0m
[91mEpoch: 3|  Loss:  7.4866 |Global loss: 9.8805| Local H loss: 0.0702  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 2.1414 | CT Loss: 5.1775| [0m
[91mEpoch: 0|  Loss:  7.4984 |Global loss: 9.8659| Local H loss: 0.0653  | Global H loss: 0.0624 [0m
[94mEpoch: 1|  NKD Loss: 2.1956 | CT Loss: 5.1773| [0m
[91mEpoch: 1|  Loss:  7.6839 |Global loss: 9.9166| Local H loss: 0.0564  | Global H loss: 0.0555 [0m
[94mEpoch: 2|  NKD Loss: 2.1424 | CT Loss: 5.1737| [0m
[91mEpoch: 2|  Loss:  7.509 |Global loss: 9.8629| Local H loss: 0.063  | Global H loss: 0.0605 [0m
[94mEpoch: 3|  NKD Loss: 2.1463 | CT Loss: 5.1733| [0m
[91mEpoch: 3|  Loss:  7.5144 |Global loss: 9.8679| Local H loss: 0.0646  | Global H loss: 0.0612 [0m
------------------------- time cost ------------------------- 2.9174585342407227
Chosen Clients:  [10, 9, 7, 12, 11, 2]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.883, 0.983, 0.975, 0.917, 0.975]
AUC in each clients:  [118.984, 119.908, 119.984, 118.995, 119.958, 119.446, 119.798, 119.0, 119.036, 119.417, 119.673, 119.384, 119.973, 119.81, 118.998]
F1 Score:  [0.984, 0.973, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.89, 0.981, 0.973, 0.918, 0.974]
Recall Score:  [0.986, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.917, 0.984, 0.977, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4804
Averaged Test Accurancy: 0.9667
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9659
Averaged Test Recal score: 0.9719
Std Test Accurancy: 0.0270
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.2228 | CT Loss: 5.2473| [0m
[91mEpoch: 0|  Loss:  7.9247 |Global loss: 9.9951| Local H loss: 0.0345  | Global H loss: 0.0382 [0m
[94mEpoch: 1|  NKD Loss: 2.2168 | CT Loss: 5.2432| [0m
[91mEpoch: 1|  Loss:  7.8897 |Global loss: 9.9883| Local H loss: 0.0364  | Global H loss: 0.04 [0m
[94mEpoch: 2|  NKD Loss: 2.2114 | CT Loss: 5.2405| [0m
[91mEpoch: 2|  Loss:  7.8617 |Global loss: 9.9768| Local H loss: 0.0371  | Global H loss: 0.0404 [0m
[94mEpoch: 3|  NKD Loss: 2.208 | CT Loss: 5.2375| [0m
[91mEpoch: 3|  Loss:  7.8481 |Global loss: 9.9742| Local H loss: 0.0384  | Global H loss: 0.0416 [0m
[94mEpoch: 0|  NKD Loss: 2.1275 | CT Loss: 5.1956| [0m
[91mEpoch: 0|  Loss:  7.4774 |Global loss: 9.8773| Local H loss: 0.071  | Global H loss: 0.0664 [0m
[94mEpoch: 1|  NKD Loss: 2.1354 | CT Loss: 5.1942| [0m
[91mEpoch: 1|  Loss:  7.492 |Global loss: 9.8818| Local H loss: 0.0681  | Global H loss: 0.0647 [0m
[94mEpoch: 2|  NKD Loss: 2.1289 | CT Loss: 5.1917| [0m
[91mEpoch: 2|  Loss:  7.4766 |Global loss: 9.8727| Local H loss: 0.0702  | Global H loss: 0.066 [0m
[94mEpoch: 3|  NKD Loss: 2.1273 | CT Loss: 5.1885| [0m
[91mEpoch: 3|  Loss:  7.4681 |Global loss: 9.8711| Local H loss: 0.0711  | Global H loss: 0.0665 [0m
[94mEpoch: 0|  NKD Loss: 2.1548 | CT Loss: 5.2032| [0m
[91mEpoch: 0|  Loss:  7.5883 |Global loss: 9.9004| Local H loss: 0.0542  | Global H loss: 0.0549 [0m
[94mEpoch: 1|  NKD Loss: 2.1617 | CT Loss: 5.2016| [0m
[91mEpoch: 1|  Loss:  7.6001 |Global loss: 9.9034| Local H loss: 0.0541  | Global H loss: 0.0545 [0m
[94mEpoch: 2|  NKD Loss: 2.1567 | CT Loss: 5.2005| [0m
[91mEpoch: 2|  Loss:  7.5785 |Global loss: 9.8995| Local H loss: 0.0558  | Global H loss: 0.056 [0m
[94mEpoch: 3|  NKD Loss: 2.1638 | CT Loss: 5.1991| [0m
[91mEpoch: 3|  Loss:  7.5972 |Global loss: 9.9034| Local H loss: 0.0545  | Global H loss: 0.0548 [0m
[94mEpoch: 0|  NKD Loss: 2.146 | CT Loss: 5.1474| [0m
[91mEpoch: 0|  Loss:  7.5022 |Global loss: 9.8409| Local H loss: 0.0616  | Global H loss: 0.0596 [0m
[94mEpoch: 1|  NKD Loss: 2.1754 | CT Loss: 5.1493| [0m
[91mEpoch: 1|  Loss:  7.6099 |Global loss: 9.8644| Local H loss: 0.0551  | Global H loss: 0.0546 [0m
[94mEpoch: 2|  NKD Loss: 2.1606 | CT Loss: 5.1454| [0m
[91mEpoch: 2|  Loss:  7.5535 |Global loss: 9.8495| Local H loss: 0.0576  | Global H loss: 0.0566 [0m
[94mEpoch: 3|  NKD Loss: 2.1611 | CT Loss: 5.1436| [0m
[91mEpoch: 3|  Loss:  7.557 |Global loss: 9.8489| Local H loss: 0.0562  | Global H loss: 0.056 [0m
[94mEpoch: 0|  NKD Loss: 2.1532 | CT Loss: 5.2233| [0m
[91mEpoch: 0|  Loss:  7.5895 |Global loss: 9.9219| Local H loss: 0.055  | Global H loss: 0.0567 [0m
[94mEpoch: 1|  NKD Loss: 2.1534 | CT Loss: 5.2226| [0m
[91mEpoch: 1|  Loss:  7.5951 |Global loss: 9.9215| Local H loss: 0.0553  | Global H loss: 0.0566 [0m
[94mEpoch: 2|  NKD Loss: 2.1458 | CT Loss: 5.2195| [0m
[91mEpoch: 2|  Loss:  7.5639 |Global loss: 9.9144| Local H loss: 0.0576  | Global H loss: 0.0586 [0m
[94mEpoch: 3|  NKD Loss: 2.1458 | CT Loss: 5.2177| [0m
[91mEpoch: 3|  Loss:  7.5615 |Global loss: 9.9109| Local H loss: 0.0588  | Global H loss: 0.059 [0m
[94mEpoch: 0|  NKD Loss: 2.1647 | CT Loss: 5.1709| [0m
[91mEpoch: 0|  Loss:  7.571 |Global loss: 9.8832| Local H loss: 0.0599  | Global H loss: 0.0583 [0m
[94mEpoch: 1|  NKD Loss: 2.1313 | CT Loss: 5.1671| [0m
[91mEpoch: 1|  Loss:  7.4669 |Global loss: 9.8497| Local H loss: 0.0667  | Global H loss: 0.0635 [0m
[94mEpoch: 2|  NKD Loss: 2.1429 | CT Loss: 5.1659| [0m
[91mEpoch: 2|  Loss:  7.495 |Global loss: 9.8572| Local H loss: 0.0656  | Global H loss: 0.0618 [0m
[94mEpoch: 3|  NKD Loss: 2.137 | CT Loss: 5.1655| [0m
[91mEpoch: 3|  Loss:  7.4744 |Global loss: 9.8521| Local H loss: 0.0679  | Global H loss: 0.0636 [0m
------------------------- time cost ------------------------- 3.0365211963653564
Chosen Clients:  [7, 8, 5, 0, 3, 1]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.917, 0.975]
AUC in each clients:  [118.984, 119.908, 119.989, 118.995, 119.958, 119.446, 119.798, 118.995, 119.036, 119.536, 119.839, 119.406, 119.969, 119.81, 118.998]
F1 Score:  [0.984, 0.973, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.973, 0.918, 0.974]
Recall Score:  [0.986, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.977, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4677
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9715
Averaged Test Recal score: 0.9760
Std Test Accurancy: 0.0154
Std Test AUC: 0.0033
Std Test F1: 0.0001
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1482 | CT Loss: 5.195| [0m
[91mEpoch: 0|  Loss:  7.5506 |Global loss: 9.8919| Local H loss: 0.0577  | Global H loss: 0.0575 [0m
[94mEpoch: 1|  NKD Loss: 2.1524 | CT Loss: 5.1941| [0m
[91mEpoch: 1|  Loss:  7.551 |Global loss: 9.8933| Local H loss: 0.058  | Global H loss: 0.0578 [0m
[94mEpoch: 2|  NKD Loss: 2.1491 | CT Loss: 5.1914| [0m
[91mEpoch: 2|  Loss:  7.5432 |Global loss: 9.886| Local H loss: 0.0594  | Global H loss: 0.0583 [0m
[94mEpoch: 3|  NKD Loss: 2.1625 | CT Loss: 5.1906| [0m
[91mEpoch: 3|  Loss:  7.5815 |Global loss: 9.8967| Local H loss: 0.0567  | Global H loss: 0.0562 [0m
[94mEpoch: 0|  NKD Loss: 2.1565 | CT Loss: 5.2208| [0m
[91mEpoch: 0|  Loss:  7.5893 |Global loss: 9.9234| Local H loss: 0.0539  | Global H loss: 0.0564 [0m
[94mEpoch: 1|  NKD Loss: 2.1601 | CT Loss: 5.2181| [0m
[91mEpoch: 1|  Loss:  7.5942 |Global loss: 9.9216| Local H loss: 0.0537  | Global H loss: 0.0561 [0m
[94mEpoch: 2|  NKD Loss: 2.1603 | CT Loss: 5.2163| [0m
[91mEpoch: 2|  Loss:  7.5969 |Global loss: 9.9206| Local H loss: 0.0538  | Global H loss: 0.0558 [0m
[94mEpoch: 3|  NKD Loss: 2.1572 | CT Loss: 5.2125| [0m
[91mEpoch: 3|  Loss:  7.5799 |Global loss: 9.9149| Local H loss: 0.0544  | Global H loss: 0.0566 [0m
[94mEpoch: 0|  NKD Loss: 2.1884 | CT Loss: 5.2278| [0m
[91mEpoch: 0|  Loss:  7.7211 |Global loss: 9.9525| Local H loss: 0.046  | Global H loss: 0.0486 [0m
[94mEpoch: 1|  NKD Loss: 2.1915 | CT Loss: 5.2277| [0m
[91mEpoch: 1|  Loss:  7.736 |Global loss: 9.9561| Local H loss: 0.0458  | Global H loss: 0.0483 [0m
[94mEpoch: 2|  NKD Loss: 2.1782 | CT Loss: 5.2226| [0m
[91mEpoch: 2|  Loss:  7.6881 |Global loss: 9.9373| Local H loss: 0.0475  | Global H loss: 0.05 [0m
[94mEpoch: 3|  NKD Loss: 2.1667 | CT Loss: 5.2211| [0m
[91mEpoch: 3|  Loss:  7.6478 |Global loss: 9.9296| Local H loss: 0.0502  | Global H loss: 0.0522 [0m
[94mEpoch: 0|  NKD Loss: 2.1698 | CT Loss: 5.1888| [0m
[91mEpoch: 0|  Loss:  7.6231 |Global loss: 9.9004| Local H loss: 0.0546  | Global H loss: 0.0538 [0m
[94mEpoch: 1|  NKD Loss: 2.1603 | CT Loss: 5.1861| [0m
[91mEpoch: 1|  Loss:  7.5906 |Global loss: 9.8877| Local H loss: 0.0558  | Global H loss: 0.055 [0m
[94mEpoch: 2|  NKD Loss: 2.1642 | CT Loss: 5.1858| [0m
[91mEpoch: 2|  Loss:  7.5992 |Global loss: 9.8927| Local H loss: 0.0557  | Global H loss: 0.0547 [0m
[94mEpoch: 3|  NKD Loss: 2.171 | CT Loss: 5.1831| [0m
[91mEpoch: 3|  Loss:  7.6122 |Global loss: 9.8967| Local H loss: 0.0548  | Global H loss: 0.0542 [0m
[94mEpoch: 0|  NKD Loss: 2.1389 | CT Loss: 5.2129| [0m
[91mEpoch: 0|  Loss:  7.5273 |Global loss: 9.9006| Local H loss: 0.0628  | Global H loss: 0.0619 [0m
[94mEpoch: 1|  NKD Loss: 2.1411 | CT Loss: 5.2107| [0m
[91mEpoch: 1|  Loss:  7.5314 |Global loss: 9.8993| Local H loss: 0.0616  | Global H loss: 0.0612 [0m
[94mEpoch: 2|  NKD Loss: 2.1348 | CT Loss: 5.2081| [0m
[91mEpoch: 2|  Loss:  7.5151 |Global loss: 9.8941| Local H loss: 0.0647  | Global H loss: 0.0628 [0m
[94mEpoch: 3|  NKD Loss: 2.1391 | CT Loss: 5.2074| [0m
[91mEpoch: 3|  Loss:  7.5214 |Global loss: 9.898| Local H loss: 0.0633  | Global H loss: 0.0621 [0m
[94mEpoch: 0|  NKD Loss: 2.1604 | CT Loss: 5.1923| [0m
[91mEpoch: 0|  Loss:  7.5975 |Global loss: 9.8929| Local H loss: 0.0563  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.1628 | CT Loss: 5.1893| [0m
[91mEpoch: 1|  Loss:  7.6181 |Global loss: 9.8972| Local H loss: 0.0569  | Global H loss: 0.0556 [0m
[94mEpoch: 2|  NKD Loss: 2.1606 | CT Loss: 5.1856| [0m
[91mEpoch: 2|  Loss:  7.5952 |Global loss: 9.8903| Local H loss: 0.0574  | Global H loss: 0.0566 [0m
[94mEpoch: 3|  NKD Loss: 2.1495 | CT Loss: 5.1861| [0m
[91mEpoch: 3|  Loss:  7.5626 |Global loss: 9.8781| Local H loss: 0.0589  | Global H loss: 0.0574 [0m
------------------------- time cost ------------------------- 2.9155757427215576
Chosen Clients:  [8, 13, 7, 12, 9, 2]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.942, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.917, 0.975]
AUC in each clients:  [119.005, 119.009, 119.989, 118.989, 119.958, 119.397, 119.798, 118.995, 119.049, 119.536, 119.839, 119.406, 119.969, 119.81, 118.998]
F1 Score:  [0.984, 0.921, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.973, 0.918, 0.974]
Recall Score:  [0.986, 0.927, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.977, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4627
Averaged Test Accurancy: 0.9706
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9681
Averaged Test Recal score: 0.9727
Std Test Accurancy: 0.0172
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.157 | CT Loss: 5.2106| [0m
[91mEpoch: 0|  Loss:  7.579 |Global loss: 9.9126| Local H loss: 0.0554  | Global H loss: 0.0572 [0m
[94mEpoch: 1|  NKD Loss: 2.1674 | CT Loss: 5.2097| [0m
[91mEpoch: 1|  Loss:  7.6122 |Global loss: 9.917| Local H loss: 0.0534  | Global H loss: 0.0554 [0m
[94mEpoch: 2|  NKD Loss: 2.1525 | CT Loss: 5.2075| [0m
[91mEpoch: 2|  Loss:  7.5699 |Global loss: 9.8992| Local H loss: 0.0549  | Global H loss: 0.0568 [0m
[94mEpoch: 3|  NKD Loss: 2.1436 | CT Loss: 5.205| [0m
[91mEpoch: 3|  Loss:  7.5346 |Global loss: 9.8954| Local H loss: 0.0596  | Global H loss: 0.0602 [0m
[94mEpoch: 0|  NKD Loss: 2.1702 | CT Loss: 5.2039| [0m
[91mEpoch: 0|  Loss:  7.6813 |Global loss: 9.9166| Local H loss: 0.0563  | Global H loss: 0.0536 [0m
[94mEpoch: 1|  NKD Loss: 2.1691 | CT Loss: 5.2034| [0m
[91mEpoch: 1|  Loss:  7.6623 |Global loss: 9.9114| Local H loss: 0.0569  | Global H loss: 0.0545 [0m
[94mEpoch: 2|  NKD Loss: 2.1665 | CT Loss: 5.1995| [0m
[91mEpoch: 2|  Loss:  7.6676 |Global loss: 9.9107| Local H loss: 0.0576  | Global H loss: 0.0546 [0m
[94mEpoch: 3|  NKD Loss: 2.1729 | CT Loss: 5.1974| [0m
[91mEpoch: 3|  Loss:  7.6913 |Global loss: 9.9108| Local H loss: 0.0571  | Global H loss: 0.0537 [0m
[94mEpoch: 0|  NKD Loss: 2.1643 | CT Loss: 5.187| [0m
[91mEpoch: 0|  Loss:  7.5834 |Global loss: 9.8947| Local H loss: 0.0572  | Global H loss: 0.0563 [0m
[94mEpoch: 1|  NKD Loss: 2.1472 | CT Loss: 5.1847| [0m
[91mEpoch: 1|  Loss:  7.5351 |Global loss: 9.8771| Local H loss: 0.0595  | Global H loss: 0.0585 [0m
[94mEpoch: 2|  NKD Loss: 2.1515 | CT Loss: 5.1827| [0m
[91mEpoch: 2|  Loss:  7.5474 |Global loss: 9.8786| Local H loss: 0.0603  | Global H loss: 0.0585 [0m
[94mEpoch: 3|  NKD Loss: 2.1481 | CT Loss: 5.1799| [0m
[91mEpoch: 3|  Loss:  7.5367 |Global loss: 9.8739| Local H loss: 0.0603  | Global H loss: 0.0589 [0m
[94mEpoch: 0|  NKD Loss: 2.1486 | CT Loss: 5.1402| [0m
[91mEpoch: 0|  Loss:  7.5111 |Global loss: 9.8384| Local H loss: 0.0602  | Global H loss: 0.0587 [0m
[94mEpoch: 1|  NKD Loss: 2.144 | CT Loss: 5.1382| [0m
[91mEpoch: 1|  Loss:  7.5036 |Global loss: 9.8266| Local H loss: 0.0615  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1508 | CT Loss: 5.138| [0m
[91mEpoch: 2|  Loss:  7.5111 |Global loss: 9.836| Local H loss: 0.0619  | Global H loss: 0.0593 [0m
[94mEpoch: 3|  NKD Loss: 2.1414 | CT Loss: 5.1358| [0m
[91mEpoch: 3|  Loss:  7.481 |Global loss: 9.8264| Local H loss: 0.0623  | Global H loss: 0.0601 [0m
[94mEpoch: 0|  NKD Loss: 2.1281 | CT Loss: 5.1876| [0m
[91mEpoch: 0|  Loss:  7.4704 |Global loss: 9.8696| Local H loss: 0.0713  | Global H loss: 0.0664 [0m
[94mEpoch: 1|  NKD Loss: 2.131 | CT Loss: 5.1861| [0m
[91mEpoch: 1|  Loss:  7.4758 |Global loss: 9.8711| Local H loss: 0.0708  | Global H loss: 0.066 [0m
[94mEpoch: 2|  NKD Loss: 2.1279 | CT Loss: 5.1845| [0m
[91mEpoch: 2|  Loss:  7.4648 |Global loss: 9.8654| Local H loss: 0.0713  | Global H loss: 0.0665 [0m
[94mEpoch: 3|  NKD Loss: 2.1249 | CT Loss: 5.1837| [0m
[91mEpoch: 3|  Loss:  7.4561 |Global loss: 9.8621| Local H loss: 0.074  | Global H loss: 0.0677 [0m
[94mEpoch: 0|  NKD Loss: 2.1349 | CT Loss: 5.1614| [0m
[91mEpoch: 0|  Loss:  7.4696 |Global loss: 9.8472| Local H loss: 0.0672  | Global H loss: 0.0634 [0m
[94mEpoch: 1|  NKD Loss: 2.1491 | CT Loss: 5.1618| [0m
[91mEpoch: 1|  Loss:  7.5138 |Global loss: 9.8588| Local H loss: 0.0657  | Global H loss: 0.0616 [0m
[94mEpoch: 2|  NKD Loss: 2.1459 | CT Loss: 5.1591| [0m
[91mEpoch: 2|  Loss:  7.5012 |Global loss: 9.8545| Local H loss: 0.0647  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1473 | CT Loss: 5.1574| [0m
[91mEpoch: 3|  Loss:  7.5017 |Global loss: 9.8537| Local H loss: 0.0641  | Global H loss: 0.0608 [0m
------------------------- time cost ------------------------- 2.961500644683838
Chosen Clients:  [0, 1, 12, 8, 3, 5]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.942, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.883, 0.975]
AUC in each clients:  [119.005, 119.009, 119.967, 118.989, 119.958, 119.397, 119.798, 118.994, 119.036, 119.502, 119.839, 119.406, 119.976, 119.542, 118.998]
F1 Score:  [0.984, 0.921, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.975, 0.886, 0.974]
Recall Score:  [0.986, 0.927, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.978, 0.916, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4499
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9661
Averaged Test Recal score: 0.9713
Std Test Accurancy: 0.0246
Std Test AUC: 0.0032
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1611 | CT Loss: 5.1804| [0m
[91mEpoch: 0|  Loss:  7.5858 |Global loss: 9.8889| Local H loss: 0.0569  | Global H loss: 0.0556 [0m
[94mEpoch: 1|  NKD Loss: 2.1587 | CT Loss: 5.1798| [0m
[91mEpoch: 1|  Loss:  7.5714 |Global loss: 9.8816| Local H loss: 0.057  | Global H loss: 0.056 [0m
[94mEpoch: 2|  NKD Loss: 2.166 | CT Loss: 5.1769| [0m
[91mEpoch: 2|  Loss:  7.5944 |Global loss: 9.8867| Local H loss: 0.0562  | Global H loss: 0.0551 [0m
[94mEpoch: 3|  NKD Loss: 2.1658 | CT Loss: 5.1773| [0m
[91mEpoch: 3|  Loss:  7.5914 |Global loss: 9.889| Local H loss: 0.057  | Global H loss: 0.0555 [0m
[94mEpoch: 0|  NKD Loss: 2.1518 | CT Loss: 5.1815| [0m
[91mEpoch: 0|  Loss:  7.5545 |Global loss: 9.8792| Local H loss: 0.0597  | Global H loss: 0.058 [0m
[94mEpoch: 1|  NKD Loss: 2.1511 | CT Loss: 5.1786| [0m
[91mEpoch: 1|  Loss:  7.5494 |Global loss: 9.8779| Local H loss: 0.0605  | Global H loss: 0.0587 [0m
[94mEpoch: 2|  NKD Loss: 2.1459 | CT Loss: 5.1785| [0m
[91mEpoch: 2|  Loss:  7.54 |Global loss: 9.8704| Local H loss: 0.0613  | Global H loss: 0.059 [0m
[94mEpoch: 3|  NKD Loss: 2.1442 | CT Loss: 5.1728| [0m
[91mEpoch: 3|  Loss:  7.5206 |Global loss: 9.8652| Local H loss: 0.0611  | Global H loss: 0.0595 [0m
[94mEpoch: 0|  NKD Loss: 2.1434 | CT Loss: 5.1331| [0m
[91mEpoch: 0|  Loss:  7.4829 |Global loss: 9.824| Local H loss: 0.063  | Global H loss: 0.0604 [0m
[94mEpoch: 1|  NKD Loss: 2.1727 | CT Loss: 5.131| [0m
[91mEpoch: 1|  Loss:  7.5933 |Global loss: 9.8491| Local H loss: 0.0568  | Global H loss: 0.056 [0m
[94mEpoch: 2|  NKD Loss: 2.1462 | CT Loss: 5.1283| [0m
[91mEpoch: 2|  Loss:  7.497 |Global loss: 9.8231| Local H loss: 0.0613  | Global H loss: 0.059 [0m
[94mEpoch: 3|  NKD Loss: 2.144 | CT Loss: 5.1278| [0m
[91mEpoch: 3|  Loss:  7.4784 |Global loss: 9.8187| Local H loss: 0.0609  | Global H loss: 0.0596 [0m
[94mEpoch: 0|  NKD Loss: 2.1471 | CT Loss: 5.2025| [0m
[91mEpoch: 0|  Loss:  7.5436 |Global loss: 9.8984| Local H loss: 0.0586  | Global H loss: 0.0593 [0m
[94mEpoch: 1|  NKD Loss: 2.14 | CT Loss: 5.1995| [0m
[91mEpoch: 1|  Loss:  7.5204 |Global loss: 9.887| Local H loss: 0.0609  | Global H loss: 0.061 [0m
[94mEpoch: 2|  NKD Loss: 2.141 | CT Loss: 5.1983| [0m
[91mEpoch: 2|  Loss:  7.5206 |Global loss: 9.8889| Local H loss: 0.061  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1391 | CT Loss: 5.1959| [0m
[91mEpoch: 3|  Loss:  7.5162 |Global loss: 9.8863| Local H loss: 0.0618  | Global H loss: 0.0613 [0m
[94mEpoch: 0|  NKD Loss: 2.1418 | CT Loss: 5.2061| [0m
[91mEpoch: 0|  Loss:  7.5276 |Global loss: 9.8962| Local H loss: 0.0629  | Global H loss: 0.0615 [0m
[94mEpoch: 1|  NKD Loss: 2.1449 | CT Loss: 5.2059| [0m
[91mEpoch: 1|  Loss:  7.5376 |Global loss: 9.9026| Local H loss: 0.0621  | Global H loss: 0.061 [0m
[94mEpoch: 2|  NKD Loss: 2.1319 | CT Loss: 5.2007| [0m
[91mEpoch: 2|  Loss:  7.5 |Global loss: 9.8829| Local H loss: 0.0661  | Global H loss: 0.0636 [0m
[94mEpoch: 3|  NKD Loss: 2.1276 | CT Loss: 5.199| [0m
[91mEpoch: 3|  Loss:  7.4845 |Global loss: 9.8787| Local H loss: 0.0688  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.166 | CT Loss: 5.2193| [0m
[91mEpoch: 0|  Loss:  7.6394 |Global loss: 9.93| Local H loss: 0.0511  | Global H loss: 0.053 [0m
[94mEpoch: 1|  NKD Loss: 2.1651 | CT Loss: 5.2185| [0m
[91mEpoch: 1|  Loss:  7.6357 |Global loss: 9.9246| Local H loss: 0.0519  | Global H loss: 0.0534 [0m
[94mEpoch: 2|  NKD Loss: 2.166 | CT Loss: 5.2154| [0m
[91mEpoch: 2|  Loss:  7.6297 |Global loss: 9.9227| Local H loss: 0.0515  | Global H loss: 0.0532 [0m
[94mEpoch: 3|  NKD Loss: 2.1627 | CT Loss: 5.2145| [0m
[91mEpoch: 3|  Loss:  7.6226 |Global loss: 9.9194| Local H loss: 0.0534  | Global H loss: 0.0545 [0m
------------------------- time cost ------------------------- 2.9411628246307373
Chosen Clients:  [3, 6, 11, 8, 2, 13]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.917, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.9, 0.883, 0.975]
AUC in each clients:  [118.998, 119.864, 119.967, 118.995, 119.958, 119.474, 119.798, 118.994, 119.043, 119.502, 119.839, 119.406, 119.742, 119.542, 118.998]
F1 Score:  [0.984, 0.878, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.898, 0.886, 0.974]
Recall Score:  [0.986, 0.91, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.914, 0.916, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4555
Averaged Test Accurancy: 0.9617
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9580
Averaged Test Recal score: 0.9659
Std Test Accurancy: 0.0316
Std Test AUC: 0.0031
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1295 | CT Loss: 5.1972| [0m
[91mEpoch: 0|  Loss:  7.4895 |Global loss: 9.8804| Local H loss: 0.0683  | Global H loss: 0.0646 [0m
[94mEpoch: 1|  NKD Loss: 2.1294 | CT Loss: 5.1955| [0m
[91mEpoch: 1|  Loss:  7.484 |Global loss: 9.8785| Local H loss: 0.068  | Global H loss: 0.0648 [0m
[94mEpoch: 2|  NKD Loss: 2.1286 | CT Loss: 5.1951| [0m
[91mEpoch: 2|  Loss:  7.4833 |Global loss: 9.876| Local H loss: 0.0685  | Global H loss: 0.0649 [0m
[94mEpoch: 3|  NKD Loss: 2.1255 | CT Loss: 5.192| [0m
[91mEpoch: 3|  Loss:  7.473 |Global loss: 9.8696| Local H loss: 0.0708  | Global H loss: 0.066 [0m
[94mEpoch: 0|  NKD Loss: 2.152 | CT Loss: 5.1984| [0m
[91mEpoch: 0|  Loss:  7.5524 |Global loss: 9.8961| Local H loss: 0.0556  | Global H loss: 0.0574 [0m
[94mEpoch: 1|  NKD Loss: 2.1475 | CT Loss: 5.1949| [0m
[91mEpoch: 1|  Loss:  7.5376 |Global loss: 9.8906| Local H loss: 0.0567  | Global H loss: 0.0583 [0m
[94mEpoch: 2|  NKD Loss: 2.1517 | CT Loss: 5.1937| [0m
[91mEpoch: 2|  Loss:  7.5473 |Global loss: 9.893| Local H loss: 0.0558  | Global H loss: 0.0575 [0m
[94mEpoch: 3|  NKD Loss: 2.1498 | CT Loss: 5.1908| [0m
[91mEpoch: 3|  Loss:  7.54 |Global loss: 9.8856| Local H loss: 0.057  | Global H loss: 0.058 [0m
[94mEpoch: 0|  NKD Loss: 2.1399 | CT Loss: 5.215| [0m
[91mEpoch: 0|  Loss:  7.5423 |Global loss: 9.9004| Local H loss: 0.0601  | Global H loss: 0.0601 [0m
[94mEpoch: 1|  NKD Loss: 2.1437 | CT Loss: 5.2137| [0m
[91mEpoch: 1|  Loss:  7.5528 |Global loss: 9.9099| Local H loss: 0.0595  | Global H loss: 0.0595 [0m
[94mEpoch: 2|  NKD Loss: 2.1381 | CT Loss: 5.2113| [0m
[91mEpoch: 2|  Loss:  7.5324 |Global loss: 9.9016| Local H loss: 0.0617  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1371 | CT Loss: 5.2092| [0m
[91mEpoch: 3|  Loss:  7.5276 |Global loss: 9.8943| Local H loss: 0.0623  | Global H loss: 0.0614 [0m
[94mEpoch: 0|  NKD Loss: 2.1359 | CT Loss: 5.1917| [0m
[91mEpoch: 0|  Loss:  7.5005 |Global loss: 9.8767| Local H loss: 0.0631  | Global H loss: 0.0624 [0m
[94mEpoch: 1|  NKD Loss: 2.1682 | CT Loss: 5.1918| [0m
[91mEpoch: 1|  Loss:  7.5955 |Global loss: 9.9064| Local H loss: 0.0586  | Global H loss: 0.0585 [0m
[94mEpoch: 2|  NKD Loss: 2.1374 | CT Loss: 5.1893| [0m
[91mEpoch: 2|  Loss:  7.5113 |Global loss: 9.875| Local H loss: 0.0614  | Global H loss: 0.0608 [0m
[94mEpoch: 3|  NKD Loss: 2.1338 | CT Loss: 5.1868| [0m
[91mEpoch: 3|  Loss:  7.4935 |Global loss: 9.8729| Local H loss: 0.0636  | Global H loss: 0.0625 [0m
[94mEpoch: 0|  NKD Loss: 2.1435 | CT Loss: 5.1561| [0m
[91mEpoch: 0|  Loss:  7.4875 |Global loss: 9.8496| Local H loss: 0.0674  | Global H loss: 0.0624 [0m
[94mEpoch: 1|  NKD Loss: 2.1374 | CT Loss: 5.1526| [0m
[91mEpoch: 1|  Loss:  7.4647 |Global loss: 9.8413| Local H loss: 0.0673  | Global H loss: 0.0631 [0m
[94mEpoch: 2|  NKD Loss: 2.132 | CT Loss: 5.1516| [0m
[91mEpoch: 2|  Loss:  7.4538 |Global loss: 9.835| Local H loss: 0.069  | Global H loss: 0.0641 [0m
[94mEpoch: 3|  NKD Loss: 2.1411 | CT Loss: 5.1499| [0m
[91mEpoch: 3|  Loss:  7.4741 |Global loss: 9.8442| Local H loss: 0.0681  | Global H loss: 0.063 [0m
[94mEpoch: 0|  NKD Loss: 2.1674 | CT Loss: 5.1957| [0m
[91mEpoch: 0|  Loss:  7.6614 |Global loss: 9.9028| Local H loss: 0.057  | Global H loss: 0.0541 [0m
[94mEpoch: 1|  NKD Loss: 2.1627 | CT Loss: 5.1941| [0m
[91mEpoch: 1|  Loss:  7.6454 |Global loss: 9.8989| Local H loss: 0.0593  | Global H loss: 0.0555 [0m
[94mEpoch: 2|  NKD Loss: 2.1604 | CT Loss: 5.1918| [0m
[91mEpoch: 2|  Loss:  7.6336 |Global loss: 9.8982| Local H loss: 0.0613  | Global H loss: 0.0566 [0m
[94mEpoch: 3|  NKD Loss: 2.1627 | CT Loss: 5.1886| [0m
[91mEpoch: 3|  Loss:  7.6366 |Global loss: 9.893| Local H loss: 0.0612  | Global H loss: 0.0563 [0m
------------------------- time cost ------------------------- 2.9917635917663574
Chosen Clients:  [8, 6, 13, 1, 4, 10]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.917, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.9, 0.875, 0.975]
AUC in each clients:  [118.998, 119.864, 119.988, 118.995, 119.958, 119.474, 119.79, 118.994, 119.11, 119.502, 119.839, 119.414, 119.742, 119.733, 118.998]
F1 Score:  [0.984, 0.878, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.898, 0.891, 0.974]
Recall Score:  [0.986, 0.91, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.914, 0.91, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4470
Averaged Test Accurancy: 0.9611
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9583
Averaged Test Recal score: 0.9655
Std Test Accurancy: 0.0330
Std Test AUC: 0.0031
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1378 | CT Loss: 5.1829| [0m
[91mEpoch: 0|  Loss:  7.5009 |Global loss: 9.8731| Local H loss: 0.0634  | Global H loss: 0.0621 [0m
[94mEpoch: 1|  NKD Loss: 2.1324 | CT Loss: 5.1831| [0m
[91mEpoch: 1|  Loss:  7.4869 |Global loss: 9.8666| Local H loss: 0.0643  | Global H loss: 0.0628 [0m
[94mEpoch: 2|  NKD Loss: 2.1309 | CT Loss: 5.1801| [0m
[91mEpoch: 2|  Loss:  7.4775 |Global loss: 9.8622| Local H loss: 0.0659  | Global H loss: 0.0637 [0m
[94mEpoch: 3|  NKD Loss: 2.1354 | CT Loss: 5.1769| [0m
[91mEpoch: 3|  Loss:  7.4868 |Global loss: 9.8669| Local H loss: 0.0648  | Global H loss: 0.0627 [0m
[94mEpoch: 0|  NKD Loss: 2.146 | CT Loss: 5.1896| [0m
[91mEpoch: 0|  Loss:  7.5221 |Global loss: 9.8812| Local H loss: 0.0595  | Global H loss: 0.0598 [0m
[94mEpoch: 1|  NKD Loss: 2.1494 | CT Loss: 5.1869| [0m
[91mEpoch: 1|  Loss:  7.5345 |Global loss: 9.8849| Local H loss: 0.0571  | Global H loss: 0.0582 [0m
[94mEpoch: 2|  NKD Loss: 2.1468 | CT Loss: 5.1836| [0m
[91mEpoch: 2|  Loss:  7.5235 |Global loss: 9.8775| Local H loss: 0.0577  | Global H loss: 0.0588 [0m
[94mEpoch: 3|  NKD Loss: 2.1365 | CT Loss: 5.1805| [0m
[91mEpoch: 3|  Loss:  7.4915 |Global loss: 9.8688| Local H loss: 0.0628  | Global H loss: 0.0619 [0m
[94mEpoch: 0|  NKD Loss: 2.1691 | CT Loss: 5.1881| [0m
[91mEpoch: 0|  Loss:  7.6593 |Global loss: 9.9023| Local H loss: 0.059  | Global H loss: 0.0551 [0m
[94mEpoch: 1|  NKD Loss: 2.165 | CT Loss: 5.1856| [0m
[91mEpoch: 1|  Loss:  7.6391 |Global loss: 9.8917| Local H loss: 0.0594  | Global H loss: 0.0552 [0m
[94mEpoch: 2|  NKD Loss: 2.1631 | CT Loss: 5.1836| [0m
[91mEpoch: 2|  Loss:  7.6329 |Global loss: 9.8913| Local H loss: 0.0599  | Global H loss: 0.0557 [0m
[94mEpoch: 3|  NKD Loss: 2.1636 | CT Loss: 5.1821| [0m
[91mEpoch: 3|  Loss:  7.6356 |Global loss: 9.8906| Local H loss: 0.0608  | Global H loss: 0.056 [0m
[94mEpoch: 0|  NKD Loss: 2.1356 | CT Loss: 5.1709| [0m
[91mEpoch: 0|  Loss:  7.4971 |Global loss: 9.8574| Local H loss: 0.0625  | Global H loss: 0.0606 [0m
[94mEpoch: 1|  NKD Loss: 2.1575 | CT Loss: 5.1683| [0m
[91mEpoch: 1|  Loss:  7.555 |Global loss: 9.8751| Local H loss: 0.0614  | Global H loss: 0.0595 [0m
[94mEpoch: 2|  NKD Loss: 2.1422 | CT Loss: 5.1659| [0m
[91mEpoch: 2|  Loss:  7.5177 |Global loss: 9.8545| Local H loss: 0.0619  | Global H loss: 0.0596 [0m
[94mEpoch: 3|  NKD Loss: 2.1572 | CT Loss: 5.1622| [0m
[91mEpoch: 3|  Loss:  7.559 |Global loss: 9.8688| Local H loss: 0.0613  | Global H loss: 0.059 [0m
[94mEpoch: 0|  NKD Loss: 2.1519 | CT Loss: 5.2024| [0m
[91mEpoch: 0|  Loss:  7.5892 |Global loss: 9.9002| Local H loss: 0.0621  | Global H loss: 0.0588 [0m
[94mEpoch: 1|  NKD Loss: 2.1536 | CT Loss: 5.2012| [0m
[91mEpoch: 1|  Loss:  7.6057 |Global loss: 9.9022| Local H loss: 0.0627  | Global H loss: 0.0586 [0m
[94mEpoch: 2|  NKD Loss: 2.1489 | CT Loss: 5.1984| [0m
[91mEpoch: 2|  Loss:  7.5826 |Global loss: 9.8916| Local H loss: 0.0617  | Global H loss: 0.0586 [0m
[94mEpoch: 3|  NKD Loss: 2.1407 | CT Loss: 5.1963| [0m
[91mEpoch: 3|  Loss:  7.553 |Global loss: 9.8863| Local H loss: 0.0635  | Global H loss: 0.06 [0m
[94mEpoch: 0|  NKD Loss: 2.2071 | CT Loss: 5.235| [0m
[91mEpoch: 0|  Loss:  7.8395 |Global loss: 9.9721| Local H loss: 0.0397  | Global H loss: 0.0424 [0m
[94mEpoch: 1|  NKD Loss: 2.2017 | CT Loss: 5.2318| [0m
[91mEpoch: 1|  Loss:  7.8166 |Global loss: 9.9674| Local H loss: 0.0402  | Global H loss: 0.0432 [0m
[94mEpoch: 2|  NKD Loss: 2.2066 | CT Loss: 5.2302| [0m
[91mEpoch: 2|  Loss:  7.8226 |Global loss: 9.9715| Local H loss: 0.0409  | Global H loss: 0.0435 [0m
[94mEpoch: 3|  NKD Loss: 2.2008 | CT Loss: 5.2251| [0m
[91mEpoch: 3|  Loss:  7.8001 |Global loss: 9.9626| Local H loss: 0.0418  | Global H loss: 0.0444 [0m
------------------------- time cost ------------------------- 3.1093485355377197
Chosen Clients:  [7, 0, 8, 6, 14, 3]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.9, 0.9, 0.975]
AUC in each clients:  [118.998, 119.719, 119.988, 118.995, 119.937, 119.474, 119.949, 118.994, 119.023, 119.502, 119.895, 119.414, 119.742, 119.454, 118.998]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.898, 0.903, 0.974]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.914, 0.927, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4345
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9604
Averaged Test Recal score: 0.9672
Std Test Accurancy: 0.0282
Std Test AUC: 0.0031
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1492 | CT Loss: 5.1795| [0m
[91mEpoch: 0|  Loss:  7.538 |Global loss: 9.8737| Local H loss: 0.0592  | Global H loss: 0.058 [0m
[94mEpoch: 1|  NKD Loss: 2.1355 | CT Loss: 5.1767| [0m
[91mEpoch: 1|  Loss:  7.4948 |Global loss: 9.8639| Local H loss: 0.0633  | Global H loss: 0.0613 [0m
[94mEpoch: 2|  NKD Loss: 2.1355 | CT Loss: 5.1746| [0m
[91mEpoch: 2|  Loss:  7.4921 |Global loss: 9.8637| Local H loss: 0.0639  | Global H loss: 0.0616 [0m
[94mEpoch: 3|  NKD Loss: 2.1335 | CT Loss: 5.1717| [0m
[91mEpoch: 3|  Loss:  7.4835 |Global loss: 9.856| Local H loss: 0.0649  | Global H loss: 0.0622 [0m
[94mEpoch: 0|  NKD Loss: 2.1525 | CT Loss: 5.1742| [0m
[91mEpoch: 0|  Loss:  7.5531 |Global loss: 9.8735| Local H loss: 0.0594  | Global H loss: 0.0574 [0m
[94mEpoch: 1|  NKD Loss: 2.1491 | CT Loss: 5.1706| [0m
[91mEpoch: 1|  Loss:  7.54 |Global loss: 9.8691| Local H loss: 0.0594  | Global H loss: 0.0576 [0m
[94mEpoch: 2|  NKD Loss: 2.1484 | CT Loss: 5.17| [0m
[91mEpoch: 2|  Loss:  7.5329 |Global loss: 9.8662| Local H loss: 0.0613  | Global H loss: 0.0586 [0m
[94mEpoch: 3|  NKD Loss: 2.1446 | CT Loss: 5.1671| [0m
[91mEpoch: 3|  Loss:  7.5163 |Global loss: 9.8586| Local H loss: 0.0618  | Global H loss: 0.0593 [0m
[94mEpoch: 0|  NKD Loss: 2.1283 | CT Loss: 5.1757| [0m
[91mEpoch: 0|  Loss:  7.4662 |Global loss: 9.8555| Local H loss: 0.0672  | Global H loss: 0.0645 [0m
[94mEpoch: 1|  NKD Loss: 2.1277 | CT Loss: 5.1732| [0m
[91mEpoch: 1|  Loss:  7.4599 |Global loss: 9.852| Local H loss: 0.0679  | Global H loss: 0.0649 [0m
[94mEpoch: 2|  NKD Loss: 2.1253 | CT Loss: 5.1691| [0m
[91mEpoch: 2|  Loss:  7.4522 |Global loss: 9.8516| Local H loss: 0.0693  | Global H loss: 0.0656 [0m
[94mEpoch: 3|  NKD Loss: 2.1309 | CT Loss: 5.1678| [0m
[91mEpoch: 3|  Loss:  7.4687 |Global loss: 9.8517| Local H loss: 0.0677  | Global H loss: 0.0642 [0m
[94mEpoch: 0|  NKD Loss: 2.1392 | CT Loss: 5.1804| [0m
[91mEpoch: 0|  Loss:  7.4985 |Global loss: 9.8678| Local H loss: 0.0616  | Global H loss: 0.0611 [0m
[94mEpoch: 1|  NKD Loss: 2.1389 | CT Loss: 5.1746| [0m
[91mEpoch: 1|  Loss:  7.4946 |Global loss: 9.8653| Local H loss: 0.061  | Global H loss: 0.0608 [0m
[94mEpoch: 2|  NKD Loss: 2.1351 | CT Loss: 5.1725| [0m
[91mEpoch: 2|  Loss:  7.4801 |Global loss: 9.8593| Local H loss: 0.0633  | Global H loss: 0.0622 [0m
[94mEpoch: 3|  NKD Loss: 2.1506 | CT Loss: 5.1716| [0m
[91mEpoch: 3|  Loss:  7.5169 |Global loss: 9.8696| Local H loss: 0.0595  | Global H loss: 0.0594 [0m
[94mEpoch: 0|  NKD Loss: 2.1303 | CT Loss: 5.2058| [0m
[91mEpoch: 0|  Loss:  7.5022 |Global loss: 9.8921| Local H loss: 0.0687  | Global H loss: 0.0646 [0m
[94mEpoch: 1|  NKD Loss: 2.1306 | CT Loss: 5.2043| [0m
[91mEpoch: 1|  Loss:  7.5016 |Global loss: 9.8905| Local H loss: 0.0684  | Global H loss: 0.0645 [0m
[94mEpoch: 2|  NKD Loss: 2.125 | CT Loss: 5.2018| [0m
[91mEpoch: 2|  Loss:  7.4836 |Global loss: 9.8809| Local H loss: 0.0706  | Global H loss: 0.0659 [0m
[94mEpoch: 3|  NKD Loss: 2.1299 | CT Loss: 5.1996| [0m
[91mEpoch: 3|  Loss:  7.4939 |Global loss: 9.8819| Local H loss: 0.0691  | Global H loss: 0.0648 [0m
[94mEpoch: 0|  NKD Loss: 2.1257 | CT Loss: 5.1901| [0m
[91mEpoch: 0|  Loss:  7.4709 |Global loss: 9.8699| Local H loss: 0.0703  | Global H loss: 0.0659 [0m
[94mEpoch: 1|  NKD Loss: 2.1205 | CT Loss: 5.1877| [0m
[91mEpoch: 1|  Loss:  7.4567 |Global loss: 9.865| Local H loss: 0.0734  | Global H loss: 0.0674 [0m
[94mEpoch: 2|  NKD Loss: 2.1218 | CT Loss: 5.1861| [0m
[91mEpoch: 2|  Loss:  7.4598 |Global loss: 9.864| Local H loss: 0.0721  | Global H loss: 0.0667 [0m
[94mEpoch: 3|  NKD Loss: 2.1205 | CT Loss: 5.1839| [0m
[91mEpoch: 3|  Loss:  7.4521 |Global loss: 9.8587| Local H loss: 0.0741  | Global H loss: 0.0677 [0m
------------------------- time cost ------------------------- 2.7547659873962402
Chosen Clients:  [4, 6, 5, 3, 0, 12]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.9, 0.9, 0.983]
AUC in each clients:  [119.017, 119.719, 119.988, 118.995, 119.937, 119.474, 119.966, 118.994, 119.07, 119.502, 119.895, 119.414, 119.742, 119.454, 118.984]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.898, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.914, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4251
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9609
Averaged Test Recal score: 0.9677
Std Test Accurancy: 0.0285
Std Test AUC: 0.0031
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1452 | CT Loss: 5.1943| [0m
[91mEpoch: 0|  Loss:  7.5608 |Global loss: 9.8887| Local H loss: 0.0643  | Global H loss: 0.0602 [0m
[94mEpoch: 1|  NKD Loss: 2.1409 | CT Loss: 5.1909| [0m
[91mEpoch: 1|  Loss:  7.5493 |Global loss: 9.8839| Local H loss: 0.0646  | Global H loss: 0.0604 [0m
[94mEpoch: 2|  NKD Loss: 2.1375 | CT Loss: 5.19| [0m
[91mEpoch: 2|  Loss:  7.5328 |Global loss: 9.8745| Local H loss: 0.0656  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1467 | CT Loss: 5.188| [0m
[91mEpoch: 3|  Loss:  7.558 |Global loss: 9.8822| Local H loss: 0.0648  | Global H loss: 0.0605 [0m
[94mEpoch: 0|  NKD Loss: 2.1345 | CT Loss: 5.1705| [0m
[91mEpoch: 0|  Loss:  7.478 |Global loss: 9.857| Local H loss: 0.0634  | Global H loss: 0.0622 [0m
[94mEpoch: 1|  NKD Loss: 2.1323 | CT Loss: 5.1661| [0m
[91mEpoch: 1|  Loss:  7.4685 |Global loss: 9.8476| Local H loss: 0.0641  | Global H loss: 0.0626 [0m
[94mEpoch: 2|  NKD Loss: 2.1323 | CT Loss: 5.166| [0m
[91mEpoch: 2|  Loss:  7.4634 |Global loss: 9.854| Local H loss: 0.066  | Global H loss: 0.0637 [0m
[94mEpoch: 3|  NKD Loss: 2.1305 | CT Loss: 5.1611| [0m
[91mEpoch: 3|  Loss:  7.4587 |Global loss: 9.8436| Local H loss: 0.0651  | Global H loss: 0.0632 [0m
[94mEpoch: 0|  NKD Loss: 2.1694 | CT Loss: 5.2115| [0m
[91mEpoch: 0|  Loss:  7.6397 |Global loss: 9.9207| Local H loss: 0.0519  | Global H loss: 0.0532 [0m
[94mEpoch: 1|  NKD Loss: 2.1584 | CT Loss: 5.2101| [0m
[91mEpoch: 1|  Loss:  7.6082 |Global loss: 9.9139| Local H loss: 0.0556  | Global H loss: 0.0559 [0m
[94mEpoch: 2|  NKD Loss: 2.1509 | CT Loss: 5.2062| [0m
[91mEpoch: 2|  Loss:  7.5849 |Global loss: 9.8992| Local H loss: 0.0549  | Global H loss: 0.0557 [0m
[94mEpoch: 3|  NKD Loss: 2.1507 | CT Loss: 5.2044| [0m
[91mEpoch: 3|  Loss:  7.5765 |Global loss: 9.902| Local H loss: 0.0564  | Global H loss: 0.0566 [0m
[94mEpoch: 0|  NKD Loss: 2.1229 | CT Loss: 5.1817| [0m
[91mEpoch: 0|  Loss:  7.4567 |Global loss: 9.8624| Local H loss: 0.0717  | Global H loss: 0.0666 [0m
[94mEpoch: 1|  NKD Loss: 2.1222 | CT Loss: 5.1811| [0m
[91mEpoch: 1|  Loss:  7.4552 |Global loss: 9.8581| Local H loss: 0.072  | Global H loss: 0.0666 [0m
[94mEpoch: 2|  NKD Loss: 2.1215 | CT Loss: 5.1792| [0m
[91mEpoch: 2|  Loss:  7.4513 |Global loss: 9.8582| Local H loss: 0.0723  | Global H loss: 0.067 [0m
[94mEpoch: 3|  NKD Loss: 2.1235 | CT Loss: 5.1769| [0m
[91mEpoch: 3|  Loss:  7.4535 |Global loss: 9.8559| Local H loss: 0.0723  | Global H loss: 0.0666 [0m
[94mEpoch: 0|  NKD Loss: 2.1517 | CT Loss: 5.1658| [0m
[91mEpoch: 0|  Loss:  7.5379 |Global loss: 9.8641| Local H loss: 0.0612  | Global H loss: 0.0584 [0m
[94mEpoch: 1|  NKD Loss: 2.1459 | CT Loss: 5.1646| [0m
[91mEpoch: 1|  Loss:  7.5191 |Global loss: 9.8594| Local H loss: 0.0616  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1509 | CT Loss: 5.1614| [0m
[91mEpoch: 2|  Loss:  7.5319 |Global loss: 9.8559| Local H loss: 0.0616  | Global H loss: 0.0584 [0m
[94mEpoch: 3|  NKD Loss: 2.1534 | CT Loss: 5.1606| [0m
[91mEpoch: 3|  Loss:  7.5394 |Global loss: 9.8628| Local H loss: 0.0603  | Global H loss: 0.0579 [0m
[94mEpoch: 0|  NKD Loss: 2.1521 | CT Loss: 5.1255| [0m
[91mEpoch: 0|  Loss:  7.5212 |Global loss: 9.823| Local H loss: 0.0615  | Global H loss: 0.0584 [0m
[94mEpoch: 1|  NKD Loss: 2.137 | CT Loss: 5.1232| [0m
[91mEpoch: 1|  Loss:  7.4621 |Global loss: 9.8104| Local H loss: 0.0631  | Global H loss: 0.0607 [0m
[94mEpoch: 2|  NKD Loss: 2.1699 | CT Loss: 5.1212| [0m
[91mEpoch: 2|  Loss:  7.5687 |Global loss: 9.8396| Local H loss: 0.0596  | Global H loss: 0.0573 [0m
[94mEpoch: 3|  NKD Loss: 2.1416 | CT Loss: 5.1193| [0m
[91mEpoch: 3|  Loss:  7.4742 |Global loss: 9.8119| Local H loss: 0.0621  | Global H loss: 0.0597 [0m
------------------------- time cost ------------------------- 3.0579020977020264
Chosen Clients:  [6, 5, 10, 14, 9, 8]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.967, 0.9, 0.983]
AUC in each clients:  [119.012, 119.719, 119.988, 118.994, 119.958, 119.524, 119.98, 118.994, 119.07, 119.502, 119.895, 119.414, 119.953, 119.454, 118.984]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.969, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.97, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4043
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9657
Averaged Test Recal score: 0.9714
Std Test Accurancy: 0.0228
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1393 | CT Loss: 5.1586| [0m
[91mEpoch: 0|  Loss:  7.4786 |Global loss: 9.8488| Local H loss: 0.0625  | Global H loss: 0.0614 [0m
[94mEpoch: 1|  NKD Loss: 2.1343 | CT Loss: 5.1591| [0m
[91mEpoch: 1|  Loss:  7.4628 |Global loss: 9.8468| Local H loss: 0.0642  | Global H loss: 0.0627 [0m
[94mEpoch: 2|  NKD Loss: 2.1318 | CT Loss: 5.1552| [0m
[91mEpoch: 2|  Loss:  7.4548 |Global loss: 9.8395| Local H loss: 0.0655  | Global H loss: 0.0632 [0m
[94mEpoch: 3|  NKD Loss: 2.1278 | CT Loss: 5.1507| [0m
[91mEpoch: 3|  Loss:  7.4437 |Global loss: 9.8326| Local H loss: 0.0659  | Global H loss: 0.0636 [0m
[94mEpoch: 0|  NKD Loss: 2.1603 | CT Loss: 5.2032| [0m
[91mEpoch: 0|  Loss:  7.5997 |Global loss: 9.9062| Local H loss: 0.0552  | Global H loss: 0.0555 [0m
[94mEpoch: 1|  NKD Loss: 2.1534 | CT Loss: 5.2004| [0m
[91mEpoch: 1|  Loss:  7.5781 |Global loss: 9.9035| Local H loss: 0.0569  | Global H loss: 0.0568 [0m
[94mEpoch: 2|  NKD Loss: 2.1673 | CT Loss: 5.1994| [0m
[91mEpoch: 2|  Loss:  7.6202 |Global loss: 9.9124| Local H loss: 0.0549  | Global H loss: 0.0551 [0m
[94mEpoch: 3|  NKD Loss: 2.1648 | CT Loss: 5.1977| [0m
[91mEpoch: 3|  Loss:  7.6097 |Global loss: 9.9096| Local H loss: 0.0547  | Global H loss: 0.0551 [0m
[94mEpoch: 0|  NKD Loss: 2.1931 | CT Loss: 5.2241| [0m
[91mEpoch: 0|  Loss:  7.7761 |Global loss: 9.9535| Local H loss: 0.0433  | Global H loss: 0.0454 [0m
[94mEpoch: 1|  NKD Loss: 2.1952 | CT Loss: 5.2199| [0m
[91mEpoch: 1|  Loss:  7.773 |Global loss: 9.9511| Local H loss: 0.0433  | Global H loss: 0.0457 [0m
[94mEpoch: 2|  NKD Loss: 2.1876 | CT Loss: 5.2176| [0m
[91mEpoch: 2|  Loss:  7.7494 |Global loss: 9.9427| Local H loss: 0.0455  | Global H loss: 0.0472 [0m
[94mEpoch: 3|  NKD Loss: 2.1976 | CT Loss: 5.2167| [0m
[91mEpoch: 3|  Loss:  7.7827 |Global loss: 9.9489| Local H loss: 0.0421  | Global H loss: 0.0445 [0m
[94mEpoch: 0|  NKD Loss: 2.1262 | CT Loss: 5.1977| [0m
[91mEpoch: 0|  Loss:  7.4812 |Global loss: 9.8776| Local H loss: 0.0709  | Global H loss: 0.0659 [0m
[94mEpoch: 1|  NKD Loss: 2.1262 | CT Loss: 5.1967| [0m
[91mEpoch: 1|  Loss:  7.4784 |Global loss: 9.8789| Local H loss: 0.0711  | Global H loss: 0.0662 [0m
[94mEpoch: 2|  NKD Loss: 2.1248 | CT Loss: 5.1929| [0m
[91mEpoch: 2|  Loss:  7.475 |Global loss: 9.8735| Local H loss: 0.0708  | Global H loss: 0.0659 [0m
[94mEpoch: 3|  NKD Loss: 2.1217 | CT Loss: 5.1904| [0m
[91mEpoch: 3|  Loss:  7.4671 |Global loss: 9.8666| Local H loss: 0.0727  | Global H loss: 0.0667 [0m
[94mEpoch: 0|  NKD Loss: 2.1203 | CT Loss: 5.179| [0m
[91mEpoch: 0|  Loss:  7.4475 |Global loss: 9.8564| Local H loss: 0.0734  | Global H loss: 0.0676 [0m
[94mEpoch: 1|  NKD Loss: 2.1206 | CT Loss: 5.1768| [0m
[91mEpoch: 1|  Loss:  7.4446 |Global loss: 9.8566| Local H loss: 0.0737  | Global H loss: 0.0678 [0m
[94mEpoch: 2|  NKD Loss: 2.1217 | CT Loss: 5.1756| [0m
[91mEpoch: 2|  Loss:  7.4458 |Global loss: 9.8574| Local H loss: 0.073  | Global H loss: 0.0674 [0m
[94mEpoch: 3|  NKD Loss: 2.1208 | CT Loss: 5.1753| [0m
[91mEpoch: 3|  Loss:  7.4424 |Global loss: 9.8558| Local H loss: 0.0742  | Global H loss: 0.0678 [0m
[94mEpoch: 0|  NKD Loss: 2.1283 | CT Loss: 5.1671| [0m
[91mEpoch: 0|  Loss:  7.4578 |Global loss: 9.8501| Local H loss: 0.0677  | Global H loss: 0.0646 [0m
[94mEpoch: 1|  NKD Loss: 2.1284 | CT Loss: 5.1658| [0m
[91mEpoch: 1|  Loss:  7.4569 |Global loss: 9.8488| Local H loss: 0.0676  | Global H loss: 0.0645 [0m
[94mEpoch: 2|  NKD Loss: 2.1483 | CT Loss: 5.1652| [0m
[91mEpoch: 2|  Loss:  7.5138 |Global loss: 9.8656| Local H loss: 0.0622  | Global H loss: 0.0606 [0m
[94mEpoch: 3|  NKD Loss: 2.1261 | CT Loss: 5.1613| [0m
[91mEpoch: 3|  Loss:  7.4503 |Global loss: 9.8397| Local H loss: 0.0687  | Global H loss: 0.0648 [0m
------------------------- time cost ------------------------- 3.092555522918701
Chosen Clients:  [6, 10, 11, 7, 4, 0]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.967, 0.9, 0.983]
AUC in each clients:  [119.012, 119.719, 119.988, 118.994, 119.958, 119.61, 119.967, 118.994, 119.052, 119.573, 119.892, 119.414, 119.953, 119.454, 118.992]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.973, 0.981, 0.969, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.984, 0.97, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3921
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9657
Averaged Test Recal score: 0.9714
Std Test Accurancy: 0.0228
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1357 | CT Loss: 5.1488| [0m
[91mEpoch: 0|  Loss:  7.459 |Global loss: 9.8388| Local H loss: 0.0637  | Global H loss: 0.0621 [0m
[94mEpoch: 1|  NKD Loss: 2.1296 | CT Loss: 5.148| [0m
[91mEpoch: 1|  Loss:  7.4466 |Global loss: 9.8325| Local H loss: 0.0655  | Global H loss: 0.0632 [0m
[94mEpoch: 2|  NKD Loss: 2.1221 | CT Loss: 5.1444| [0m
[91mEpoch: 2|  Loss:  7.422 |Global loss: 9.8247| Local H loss: 0.0697  | Global H loss: 0.0657 [0m
[94mEpoch: 3|  NKD Loss: 2.1396 | CT Loss: 5.1444| [0m
[91mEpoch: 3|  Loss:  7.4606 |Global loss: 9.834| Local H loss: 0.0627  | Global H loss: 0.0616 [0m
[94mEpoch: 0|  NKD Loss: 2.1831 | CT Loss: 5.2124| [0m
[91mEpoch: 0|  Loss:  7.7221 |Global loss: 9.9358| Local H loss: 0.0476  | Global H loss: 0.0488 [0m
[94mEpoch: 1|  NKD Loss: 2.1855 | CT Loss: 5.2094| [0m
[91mEpoch: 1|  Loss:  7.7286 |Global loss: 9.9336| Local H loss: 0.0465  | Global H loss: 0.0478 [0m
[94mEpoch: 2|  NKD Loss: 2.1766 | CT Loss: 5.2069| [0m
[91mEpoch: 2|  Loss:  7.6896 |Global loss: 9.9223| Local H loss: 0.0494  | Global H loss: 0.0501 [0m
[94mEpoch: 3|  NKD Loss: 2.1761 | CT Loss: 5.2055| [0m
[91mEpoch: 3|  Loss:  7.682 |Global loss: 9.9243| Local H loss: 0.0494  | Global H loss: 0.0505 [0m
[94mEpoch: 0|  NKD Loss: 2.133 | CT Loss: 5.2072| [0m
[91mEpoch: 0|  Loss:  7.5162 |Global loss: 9.8927| Local H loss: 0.0637  | Global H loss: 0.0622 [0m
[94mEpoch: 1|  NKD Loss: 2.1448 | CT Loss: 5.2041| [0m
[91mEpoch: 1|  Loss:  7.544 |Global loss: 9.8989| Local H loss: 0.0618  | Global H loss: 0.0605 [0m
[94mEpoch: 2|  NKD Loss: 2.1328 | CT Loss: 5.2035| [0m
[91mEpoch: 2|  Loss:  7.5167 |Global loss: 9.8887| Local H loss: 0.0631  | Global H loss: 0.0617 [0m
[94mEpoch: 3|  NKD Loss: 2.1286 | CT Loss: 5.1992| [0m
[91mEpoch: 3|  Loss:  7.497 |Global loss: 9.8812| Local H loss: 0.0657  | Global H loss: 0.0635 [0m
[94mEpoch: 0|  NKD Loss: 2.1315 | CT Loss: 5.1695| [0m
[91mEpoch: 0|  Loss:  7.4812 |Global loss: 9.8542| Local H loss: 0.0649  | Global H loss: 0.062 [0m
[94mEpoch: 1|  NKD Loss: 2.1287 | CT Loss: 5.1688| [0m
[91mEpoch: 1|  Loss:  7.4694 |Global loss: 9.8477| Local H loss: 0.0666  | Global H loss: 0.0632 [0m
[94mEpoch: 2|  NKD Loss: 2.1468 | CT Loss: 5.1684| [0m
[91mEpoch: 2|  Loss:  7.5098 |Global loss: 9.8662| Local H loss: 0.0629  | Global H loss: 0.0604 [0m
[94mEpoch: 3|  NKD Loss: 2.1562 | CT Loss: 5.1667| [0m
[91mEpoch: 3|  Loss:  7.5476 |Global loss: 9.8709| Local H loss: 0.0594  | Global H loss: 0.0576 [0m
[94mEpoch: 0|  NKD Loss: 2.1515 | CT Loss: 5.1866| [0m
[91mEpoch: 0|  Loss:  7.5741 |Global loss: 9.8885| Local H loss: 0.0642  | Global H loss: 0.0601 [0m
[94mEpoch: 1|  NKD Loss: 2.1382 | CT Loss: 5.1843| [0m
[91mEpoch: 1|  Loss:  7.531 |Global loss: 9.8719| Local H loss: 0.0661  | Global H loss: 0.0612 [0m
[94mEpoch: 2|  NKD Loss: 2.1396 | CT Loss: 5.1831| [0m
[91mEpoch: 2|  Loss:  7.5314 |Global loss: 9.8756| Local H loss: 0.0666  | Global H loss: 0.0617 [0m
[94mEpoch: 3|  NKD Loss: 2.1339 | CT Loss: 5.1806| [0m
[91mEpoch: 3|  Loss:  7.5109 |Global loss: 9.8678| Local H loss: 0.0681  | Global H loss: 0.0626 [0m
[94mEpoch: 0|  NKD Loss: 2.1442 | CT Loss: 5.1576| [0m
[91mEpoch: 0|  Loss:  7.5077 |Global loss: 9.8527| Local H loss: 0.0628  | Global H loss: 0.0595 [0m
[94mEpoch: 1|  NKD Loss: 2.146 | CT Loss: 5.157| [0m
[91mEpoch: 1|  Loss:  7.5127 |Global loss: 9.8548| Local H loss: 0.0625  | Global H loss: 0.0594 [0m
[94mEpoch: 2|  NKD Loss: 2.141 | CT Loss: 5.1544| [0m
[91mEpoch: 2|  Loss:  7.4933 |Global loss: 9.8455| Local H loss: 0.0637  | Global H loss: 0.0605 [0m
[94mEpoch: 3|  NKD Loss: 2.1459 | CT Loss: 5.1527| [0m
[91mEpoch: 3|  Loss:  7.5063 |Global loss: 9.8497| Local H loss: 0.0638  | Global H loss: 0.0601 [0m
------------------------- time cost ------------------------- 2.832099437713623
Chosen Clients:  [2, 9, 7, 6, 11, 12]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.967, 0.9, 0.983]
AUC in each clients:  [119.023, 119.719, 119.988, 118.994, 119.964, 119.61, 119.974, 118.993, 119.052, 119.573, 119.935, 119.426, 119.953, 119.454, 118.992]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.969, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.97, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3843
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9662
Averaged Test Recal score: 0.9718
Std Test Accurancy: 0.0231
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1266 | CT Loss: 5.1464| [0m
[91mEpoch: 0|  Loss:  7.4385 |Global loss: 9.8271| Local H loss: 0.0692  | Global H loss: 0.0644 [0m
[94mEpoch: 1|  NKD Loss: 2.1227 | CT Loss: 5.1458| [0m
[91mEpoch: 1|  Loss:  7.4251 |Global loss: 9.8237| Local H loss: 0.0713  | Global H loss: 0.0659 [0m
[94mEpoch: 2|  NKD Loss: 2.1341 | CT Loss: 5.1445| [0m
[91mEpoch: 2|  Loss:  7.4497 |Global loss: 9.8314| Local H loss: 0.0702  | Global H loss: 0.0644 [0m
[94mEpoch: 3|  NKD Loss: 2.1303 | CT Loss: 5.1422| [0m
[91mEpoch: 3|  Loss:  7.4373 |Global loss: 9.8319| Local H loss: 0.0701  | Global H loss: 0.0649 [0m
[94mEpoch: 0|  NKD Loss: 2.1218 | CT Loss: 5.1727| [0m
[91mEpoch: 0|  Loss:  7.4426 |Global loss: 9.8498| Local H loss: 0.074  | Global H loss: 0.0677 [0m
[94mEpoch: 1|  NKD Loss: 2.1212 | CT Loss: 5.1695| [0m
[91mEpoch: 1|  Loss:  7.439 |Global loss: 9.8483| Local H loss: 0.073  | Global H loss: 0.0673 [0m
[94mEpoch: 2|  NKD Loss: 2.1187 | CT Loss: 5.1692| [0m
[91mEpoch: 2|  Loss:  7.4354 |Global loss: 9.8437| Local H loss: 0.0743  | Global H loss: 0.0678 [0m
[94mEpoch: 3|  NKD Loss: 2.1163 | CT Loss: 5.1664| [0m
[91mEpoch: 3|  Loss:  7.4247 |Global loss: 9.8426| Local H loss: 0.0765  | Global H loss: 0.0689 [0m
[94mEpoch: 0|  NKD Loss: 2.1298 | CT Loss: 5.1629| [0m
[91mEpoch: 0|  Loss:  7.4657 |Global loss: 9.8444| Local H loss: 0.0662  | Global H loss: 0.063 [0m
[94mEpoch: 1|  NKD Loss: 2.1289 | CT Loss: 5.1636| [0m
[91mEpoch: 1|  Loss:  7.4598 |Global loss: 9.8472| Local H loss: 0.0682  | Global H loss: 0.064 [0m
[94mEpoch: 2|  NKD Loss: 2.1242 | CT Loss: 5.1594| [0m
[91mEpoch: 2|  Loss:  7.445 |Global loss: 9.8365| Local H loss: 0.0691  | Global H loss: 0.065 [0m
[94mEpoch: 3|  NKD Loss: 2.1254 | CT Loss: 5.1573| [0m
[91mEpoch: 3|  Loss:  7.4479 |Global loss: 9.8405| Local H loss: 0.0684  | Global H loss: 0.0643 [0m
[94mEpoch: 0|  NKD Loss: 2.1235 | CT Loss: 5.1406| [0m
[91mEpoch: 0|  Loss:  7.4236 |Global loss: 9.8172| Local H loss: 0.0682  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1249 | CT Loss: 5.1367| [0m
[91mEpoch: 1|  Loss:  7.4228 |Global loss: 9.82| Local H loss: 0.0672  | Global H loss: 0.0644 [0m
[94mEpoch: 2|  NKD Loss: 2.1259 | CT Loss: 5.1353| [0m
[91mEpoch: 2|  Loss:  7.4239 |Global loss: 9.8154| Local H loss: 0.0679  | Global H loss: 0.0644 [0m
[94mEpoch: 3|  NKD Loss: 2.1271 | CT Loss: 5.1339| [0m
[91mEpoch: 3|  Loss:  7.4258 |Global loss: 9.8156| Local H loss: 0.0672  | Global H loss: 0.0639 [0m
[94mEpoch: 0|  NKD Loss: 2.1284 | CT Loss: 5.1974| [0m
[91mEpoch: 0|  Loss:  7.4964 |Global loss: 9.8771| Local H loss: 0.0662  | Global H loss: 0.0636 [0m
[94mEpoch: 1|  NKD Loss: 2.1276 | CT Loss: 5.1953| [0m
[91mEpoch: 1|  Loss:  7.4904 |Global loss: 9.8764| Local H loss: 0.0659  | Global H loss: 0.0636 [0m
[94mEpoch: 2|  NKD Loss: 2.1249 | CT Loss: 5.1924| [0m
[91mEpoch: 2|  Loss:  7.4805 |Global loss: 9.8704| Local H loss: 0.068  | Global H loss: 0.0647 [0m
[94mEpoch: 3|  NKD Loss: 2.1241 | CT Loss: 5.1919| [0m
[91mEpoch: 3|  Loss:  7.4794 |Global loss: 9.8723| Local H loss: 0.0683  | Global H loss: 0.0647 [0m
[94mEpoch: 0|  NKD Loss: 2.1551 | CT Loss: 5.1176| [0m
[91mEpoch: 0|  Loss:  7.5245 |Global loss: 9.8239| Local H loss: 0.0593  | Global H loss: 0.0578 [0m
[94mEpoch: 1|  NKD Loss: 2.1394 | CT Loss: 5.118| [0m
[91mEpoch: 1|  Loss:  7.4744 |Global loss: 9.8097| Local H loss: 0.0629  | Global H loss: 0.0602 [0m
[94mEpoch: 2|  NKD Loss: 2.1539 | CT Loss: 5.1155| [0m
[91mEpoch: 2|  Loss:  7.5191 |Global loss: 9.8169| Local H loss: 0.0605  | Global H loss: 0.0585 [0m
[94mEpoch: 3|  NKD Loss: 2.1362 | CT Loss: 5.114| [0m
[91mEpoch: 3|  Loss:  7.4606 |Global loss: 9.8003| Local H loss: 0.0632  | Global H loss: 0.0601 [0m
------------------------- time cost ------------------------- 3.0558977127075195
Chosen Clients:  [6, 2, 7, 14, 12, 10]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.9, 0.983]
AUC in each clients:  [119.023, 119.719, 119.984, 118.994, 119.964, 119.61, 119.979, 118.995, 119.052, 119.548, 119.935, 119.434, 119.977, 119.454, 118.992]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.982, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3688
Averaged Test Accurancy: 0.9700
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9671
Averaged Test Recal score: 0.9727
Std Test Accurancy: 0.0233
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1248 | CT Loss: 5.1303| [0m
[91mEpoch: 0|  Loss:  7.4159 |Global loss: 9.8086| Local H loss: 0.0683  | Global H loss: 0.0646 [0m
[94mEpoch: 1|  NKD Loss: 2.1217 | CT Loss: 5.1272| [0m
[91mEpoch: 1|  Loss:  7.4058 |Global loss: 9.8086| Local H loss: 0.0693  | Global H loss: 0.0654 [0m
[94mEpoch: 2|  NKD Loss: 2.1221 | CT Loss: 5.1246| [0m
[91mEpoch: 2|  Loss:  7.4037 |Global loss: 9.8017| Local H loss: 0.0695  | Global H loss: 0.0654 [0m
[94mEpoch: 3|  NKD Loss: 2.1196 | CT Loss: 5.1198| [0m
[91mEpoch: 3|  Loss:  7.3956 |Global loss: 9.7965| Local H loss: 0.0693  | Global H loss: 0.0654 [0m
[94mEpoch: 0|  NKD Loss: 2.1285 | CT Loss: 5.1399| [0m
[91mEpoch: 0|  Loss:  7.4317 |Global loss: 9.8283| Local H loss: 0.0711  | Global H loss: 0.0654 [0m
[94mEpoch: 1|  NKD Loss: 2.1231 | CT Loss: 5.1386| [0m
[91mEpoch: 1|  Loss:  7.4193 |Global loss: 9.8181| Local H loss: 0.0732  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1386 | CT Loss: 5.1371| [0m
[91mEpoch: 2|  Loss:  7.4632 |Global loss: 9.8314| Local H loss: 0.0702  | Global H loss: 0.0641 [0m
[94mEpoch: 3|  NKD Loss: 2.124 | CT Loss: 5.1348| [0m
[91mEpoch: 3|  Loss:  7.4202 |Global loss: 9.8173| Local H loss: 0.0716  | Global H loss: 0.0656 [0m
[94mEpoch: 0|  NKD Loss: 2.1247 | CT Loss: 5.1555| [0m
[91mEpoch: 0|  Loss:  7.4433 |Global loss: 9.8358| Local H loss: 0.069  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1293 | CT Loss: 5.1533| [0m
[91mEpoch: 1|  Loss:  7.4523 |Global loss: 9.8375| Local H loss: 0.0676  | Global H loss: 0.0636 [0m
[94mEpoch: 2|  NKD Loss: 2.1264 | CT Loss: 5.152| [0m
[91mEpoch: 2|  Loss:  7.4417 |Global loss: 9.8303| Local H loss: 0.069  | Global H loss: 0.0646 [0m
[94mEpoch: 3|  NKD Loss: 2.1209 | CT Loss: 5.1495| [0m
[91mEpoch: 3|  Loss:  7.4265 |Global loss: 9.8275| Local H loss: 0.0712  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 2.1214 | CT Loss: 5.189| [0m
[91mEpoch: 0|  Loss:  7.4637 |Global loss: 9.8709| Local H loss: 0.0719  | Global H loss: 0.0666 [0m
[94mEpoch: 1|  NKD Loss: 2.1212 | CT Loss: 5.1873| [0m
[91mEpoch: 1|  Loss:  7.4612 |Global loss: 9.8656| Local H loss: 0.073  | Global H loss: 0.067 [0m
[94mEpoch: 2|  NKD Loss: 2.121 | CT Loss: 5.1857| [0m
[91mEpoch: 2|  Loss:  7.4588 |Global loss: 9.8621| Local H loss: 0.0735  | Global H loss: 0.0672 [0m
[94mEpoch: 3|  NKD Loss: 2.1293 | CT Loss: 5.1843| [0m
[91mEpoch: 3|  Loss:  7.4781 |Global loss: 9.8668| Local H loss: 0.07  | Global H loss: 0.065 [0m
[94mEpoch: 0|  NKD Loss: 2.1578 | CT Loss: 5.1108| [0m
[91mEpoch: 0|  Loss:  7.516 |Global loss: 9.8212| Local H loss: 0.0603  | Global H loss: 0.0583 [0m
[94mEpoch: 1|  NKD Loss: 2.1347 | CT Loss: 5.1091| [0m
[91mEpoch: 1|  Loss:  7.4456 |Global loss: 9.7961| Local H loss: 0.063  | Global H loss: 0.0607 [0m
[94mEpoch: 2|  NKD Loss: 2.133 | CT Loss: 5.1079| [0m
[91mEpoch: 2|  Loss:  7.4386 |Global loss: 9.7974| Local H loss: 0.0651  | Global H loss: 0.0617 [0m
[94mEpoch: 3|  NKD Loss: 2.1406 | CT Loss: 5.1052| [0m
[91mEpoch: 3|  Loss:  7.4614 |Global loss: 9.7958| Local H loss: 0.0644  | Global H loss: 0.0609 [0m
[94mEpoch: 0|  NKD Loss: 2.1772 | CT Loss: 5.2023| [0m
[91mEpoch: 0|  Loss:  7.6841 |Global loss: 9.9191| Local H loss: 0.0495  | Global H loss: 0.0503 [0m
[94mEpoch: 1|  NKD Loss: 2.1689 | CT Loss: 5.2006| [0m
[91mEpoch: 1|  Loss:  7.6515 |Global loss: 9.9159| Local H loss: 0.0522  | Global H loss: 0.0521 [0m
[94mEpoch: 2|  NKD Loss: 2.1678 | CT Loss: 5.1967| [0m
[91mEpoch: 2|  Loss:  7.649 |Global loss: 9.9106| Local H loss: 0.0528  | Global H loss: 0.0526 [0m
[94mEpoch: 3|  NKD Loss: 2.1699 | CT Loss: 5.1956| [0m
[91mEpoch: 3|  Loss:  7.6498 |Global loss: 9.9067| Local H loss: 0.0516  | Global H loss: 0.0519 [0m
------------------------- time cost ------------------------- 2.9923810958862305
Chosen Clients:  [5, 3, 6, 14, 1, 8]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.9, 0.983]
AUC in each clients:  [119.023, 119.719, 119.991, 118.994, 119.964, 119.61, 119.984, 118.995, 119.052, 119.548, 119.934, 119.434, 119.97, 119.454, 118.99]
F1 Score:  [0.984, 0.897, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.975, 0.903, 0.982]
Recall Score:  [0.986, 0.919, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.978, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3670
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9666
Averaged Test Recal score: 0.9723
Std Test Accurancy: 0.0231
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1453 | CT Loss: 5.1946| [0m
[91mEpoch: 0|  Loss:  7.5581 |Global loss: 9.8928| Local H loss: 0.0578  | Global H loss: 0.0575 [0m
[94mEpoch: 1|  NKD Loss: 2.1404 | CT Loss: 5.1921| [0m
[91mEpoch: 1|  Loss:  7.5379 |Global loss: 9.8836| Local H loss: 0.06  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1415 | CT Loss: 5.1893| [0m
[91mEpoch: 2|  Loss:  7.537 |Global loss: 9.8799| Local H loss: 0.0604  | Global H loss: 0.0593 [0m
[94mEpoch: 3|  NKD Loss: 2.1379 | CT Loss: 5.1891| [0m
[91mEpoch: 3|  Loss:  7.5209 |Global loss: 9.88| Local H loss: 0.0619  | Global H loss: 0.0603 [0m
[94mEpoch: 0|  NKD Loss: 2.1195 | CT Loss: 5.1756| [0m
[91mEpoch: 0|  Loss:  7.446 |Global loss: 9.8555| Local H loss: 0.0728  | Global H loss: 0.067 [0m
[94mEpoch: 1|  NKD Loss: 2.1198 | CT Loss: 5.1738| [0m
[91mEpoch: 1|  Loss:  7.4449 |Global loss: 9.8506| Local H loss: 0.0734  | Global H loss: 0.0672 [0m
[94mEpoch: 2|  NKD Loss: 2.1184 | CT Loss: 5.1731| [0m
[91mEpoch: 2|  Loss:  7.4408 |Global loss: 9.8519| Local H loss: 0.0728  | Global H loss: 0.0671 [0m
[94mEpoch: 3|  NKD Loss: 2.124 | CT Loss: 5.1731| [0m
[91mEpoch: 3|  Loss:  7.4535 |Global loss: 9.8527| Local H loss: 0.0721  | Global H loss: 0.0662 [0m
[94mEpoch: 0|  NKD Loss: 2.1196 | CT Loss: 5.1188| [0m
[91mEpoch: 0|  Loss:  7.3934 |Global loss: 9.7958| Local H loss: 0.0701  | Global H loss: 0.0657 [0m
[94mEpoch: 1|  NKD Loss: 2.12 | CT Loss: 5.1161| [0m
[91mEpoch: 1|  Loss:  7.392 |Global loss: 9.7938| Local H loss: 0.0698  | Global H loss: 0.0656 [0m
[94mEpoch: 2|  NKD Loss: 2.1317 | CT Loss: 5.1206| [0m
[91mEpoch: 2|  Loss:  7.423 |Global loss: 9.808| Local H loss: 0.0685  | Global H loss: 0.0638 [0m
[94mEpoch: 3|  NKD Loss: 2.1231 | CT Loss: 5.1131| [0m
[91mEpoch: 3|  Loss:  7.3955 |Global loss: 9.7948| Local H loss: 0.0694  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.1315 | CT Loss: 5.1812| [0m
[91mEpoch: 0|  Loss:  7.4806 |Global loss: 9.8666| Local H loss: 0.0696  | Global H loss: 0.0647 [0m
[94mEpoch: 1|  NKD Loss: 2.1159 | CT Loss: 5.1815| [0m
[91mEpoch: 1|  Loss:  7.4435 |Global loss: 9.8575| Local H loss: 0.0753  | Global H loss: 0.0682 [0m
[94mEpoch: 2|  NKD Loss: 2.1209 | CT Loss: 5.1783| [0m
[91mEpoch: 2|  Loss:  7.4511 |Global loss: 9.862| Local H loss: 0.0726  | Global H loss: 0.0669 [0m
[94mEpoch: 3|  NKD Loss: 2.1211 | CT Loss: 5.1767| [0m
[91mEpoch: 3|  Loss:  7.4503 |Global loss: 9.8577| Local H loss: 0.0723  | Global H loss: 0.0667 [0m
[94mEpoch: 0|  NKD Loss: 2.1318 | CT Loss: 5.1632| [0m
[91mEpoch: 0|  Loss:  7.4937 |Global loss: 9.8494| Local H loss: 0.0625  | Global H loss: 0.0603 [0m
[94mEpoch: 1|  NKD Loss: 2.1393 | CT Loss: 5.1596| [0m
[91mEpoch: 1|  Loss:  7.5036 |Global loss: 9.8504| Local H loss: 0.0622  | Global H loss: 0.06 [0m
[94mEpoch: 2|  NKD Loss: 2.134 | CT Loss: 5.1582| [0m
[91mEpoch: 2|  Loss:  7.4881 |Global loss: 9.8437| Local H loss: 0.0622  | Global H loss: 0.0605 [0m
[94mEpoch: 3|  NKD Loss: 2.1402 | CT Loss: 5.1546| [0m
[91mEpoch: 3|  Loss:  7.4948 |Global loss: 9.8504| Local H loss: 0.0631  | Global H loss: 0.0608 [0m
[94mEpoch: 0|  NKD Loss: 2.1205 | CT Loss: 5.1581| [0m
[91mEpoch: 0|  Loss:  7.4324 |Global loss: 9.8404| Local H loss: 0.0702  | Global H loss: 0.0661 [0m
[94mEpoch: 1|  NKD Loss: 2.1253 | CT Loss: 5.1566| [0m
[91mEpoch: 1|  Loss:  7.4412 |Global loss: 9.8347| Local H loss: 0.0697  | Global H loss: 0.0654 [0m
[94mEpoch: 2|  NKD Loss: 2.1231 | CT Loss: 5.1534| [0m
[91mEpoch: 2|  Loss:  7.4358 |Global loss: 9.8384| Local H loss: 0.0693  | Global H loss: 0.0653 [0m
[94mEpoch: 3|  NKD Loss: 2.1178 | CT Loss: 5.1504| [0m
[91mEpoch: 3|  Loss:  7.421 |Global loss: 9.8342| Local H loss: 0.0714  | Global H loss: 0.0666 [0m
------------------------- time cost ------------------------- 3.866920232772827
Chosen Clients:  [4, 0, 14, 9, 3, 5]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.9, 0.983]
AUC in each clients:  [119.023, 119.412, 119.991, 118.994, 119.964, 119.842, 119.975, 118.995, 119.017, 119.548, 119.934, 119.434, 119.97, 119.454, 118.976]
F1 Score:  [0.984, 0.984, 0.974, 0.973, 0.974, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.975, 0.903, 0.982]
Recall Score:  [0.986, 0.986, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.978, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3553
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9724
Averaged Test Recal score: 0.9768
Std Test Accurancy: 0.0200
Std Test AUC: 0.0034
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1407 | CT Loss: 5.1787| [0m
[91mEpoch: 0|  Loss:  7.535 |Global loss: 9.8759| Local H loss: 0.0664  | Global H loss: 0.0616 [0m
[94mEpoch: 1|  NKD Loss: 2.1319 | CT Loss: 5.1756| [0m
[91mEpoch: 1|  Loss:  7.5007 |Global loss: 9.8625| Local H loss: 0.0667  | Global H loss: 0.0622 [0m
[94mEpoch: 2|  NKD Loss: 2.1378 | CT Loss: 5.1747| [0m
[91mEpoch: 2|  Loss:  7.5244 |Global loss: 9.8634| Local H loss: 0.0662  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1354 | CT Loss: 5.1712| [0m
[91mEpoch: 3|  Loss:  7.5068 |Global loss: 9.8602| Local H loss: 0.0668  | Global H loss: 0.062 [0m
[94mEpoch: 0|  NKD Loss: 2.1526 | CT Loss: 5.1504| [0m
[91mEpoch: 0|  Loss:  7.54 |Global loss: 9.8545| Local H loss: 0.0625  | Global H loss: 0.0584 [0m
[94mEpoch: 1|  NKD Loss: 2.1327 | CT Loss: 5.1486| [0m
[91mEpoch: 1|  Loss:  7.4725 |Global loss: 9.8355| Local H loss: 0.0654  | Global H loss: 0.0614 [0m
[94mEpoch: 2|  NKD Loss: 2.1374 | CT Loss: 5.1485| [0m
[91mEpoch: 2|  Loss:  7.4828 |Global loss: 9.836| Local H loss: 0.0654  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1374 | CT Loss: 5.1464| [0m
[91mEpoch: 3|  Loss:  7.4769 |Global loss: 9.8368| Local H loss: 0.0651  | Global H loss: 0.0613 [0m
[94mEpoch: 0|  NKD Loss: 2.1172 | CT Loss: 5.1742| [0m
[91mEpoch: 0|  Loss:  7.4394 |Global loss: 9.849| Local H loss: 0.0751  | Global H loss: 0.068 [0m
[94mEpoch: 1|  NKD Loss: 2.1158 | CT Loss: 5.1716| [0m
[91mEpoch: 1|  Loss:  7.4322 |Global loss: 9.847| Local H loss: 0.0758  | Global H loss: 0.0685 [0m
[94mEpoch: 2|  NKD Loss: 2.1152 | CT Loss: 5.1707| [0m
[91mEpoch: 2|  Loss:  7.4302 |Global loss: 9.8456| Local H loss: 0.0761  | Global H loss: 0.0686 [0m
[94mEpoch: 3|  NKD Loss: 2.1185 | CT Loss: 5.1683| [0m
[91mEpoch: 3|  Loss:  7.4378 |Global loss: 9.8487| Local H loss: 0.0739  | Global H loss: 0.0673 [0m
[94mEpoch: 0|  NKD Loss: 2.1167 | CT Loss: 5.164| [0m
[91mEpoch: 0|  Loss:  7.4245 |Global loss: 9.8425| Local H loss: 0.075  | Global H loss: 0.0684 [0m
[94mEpoch: 1|  NKD Loss: 2.1175 | CT Loss: 5.1619| [0m
[91mEpoch: 1|  Loss:  7.4256 |Global loss: 9.8375| Local H loss: 0.0745  | Global H loss: 0.068 [0m
[94mEpoch: 2|  NKD Loss: 2.1154 | CT Loss: 5.1604| [0m
[91mEpoch: 2|  Loss:  7.4196 |Global loss: 9.837| Local H loss: 0.0759  | Global H loss: 0.0686 [0m
[94mEpoch: 3|  NKD Loss: 2.1146 | CT Loss: 5.158| [0m
[91mEpoch: 3|  Loss:  7.4166 |Global loss: 9.8308| Local H loss: 0.0756  | Global H loss: 0.0685 [0m
[94mEpoch: 0|  NKD Loss: 2.1162 | CT Loss: 5.169| [0m
[91mEpoch: 0|  Loss:  7.4323 |Global loss: 9.8477| Local H loss: 0.0741  | Global H loss: 0.0677 [0m
[94mEpoch: 1|  NKD Loss: 2.1164 | CT Loss: 5.1675| [0m
[91mEpoch: 1|  Loss:  7.4303 |Global loss: 9.846| Local H loss: 0.0743  | Global H loss: 0.0679 [0m
[94mEpoch: 2|  NKD Loss: 2.1137 | CT Loss: 5.166| [0m
[91mEpoch: 2|  Loss:  7.4243 |Global loss: 9.8398| Local H loss: 0.0757  | Global H loss: 0.0684 [0m
[94mEpoch: 3|  NKD Loss: 2.1168 | CT Loss: 5.1646| [0m
[91mEpoch: 3|  Loss:  7.4285 |Global loss: 9.8412| Local H loss: 0.0747  | Global H loss: 0.0679 [0m
[94mEpoch: 0|  NKD Loss: 2.1413 | CT Loss: 5.188| [0m
[91mEpoch: 0|  Loss:  7.5291 |Global loss: 9.8837| Local H loss: 0.0614  | Global H loss: 0.0598 [0m
[94mEpoch: 1|  NKD Loss: 2.1366 | CT Loss: 5.1848| [0m
[91mEpoch: 1|  Loss:  7.5161 |Global loss: 9.8743| Local H loss: 0.0629  | Global H loss: 0.0607 [0m
[94mEpoch: 2|  NKD Loss: 2.1363 | CT Loss: 5.1823| [0m
[91mEpoch: 2|  Loss:  7.5103 |Global loss: 9.8684| Local H loss: 0.0626  | Global H loss: 0.0607 [0m
[94mEpoch: 3|  NKD Loss: 2.1425 | CT Loss: 5.1799| [0m
[91mEpoch: 3|  Loss:  7.5286 |Global loss: 9.8779| Local H loss: 0.0623  | Global H loss: 0.0602 [0m
------------------------- time cost ------------------------- 3.15775465965271
Chosen Clients:  [13, 2, 9, 10, 8, 3]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.967, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.9, 0.983]
AUC in each clients:  [119.015, 119.412, 119.991, 118.994, 119.762, 119.904, 119.975, 118.995, 119.017, 119.677, 119.934, 119.434, 119.97, 119.454, 118.97]
F1 Score:  [0.984, 0.984, 0.974, 0.973, 0.964, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.975, 0.903, 0.982]
Recall Score:  [0.986, 0.986, 0.977, 0.977, 0.968, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.978, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3469
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9717
Averaged Test Recal score: 0.9762
Std Test Accurancy: 0.0201
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1632 | CT Loss: 5.1819| [0m
[91mEpoch: 0|  Loss:  7.633 |Global loss: 9.8922| Local H loss: 0.0574  | Global H loss: 0.0544 [0m
[94mEpoch: 1|  NKD Loss: 2.161 | CT Loss: 5.1773| [0m
[91mEpoch: 1|  Loss:  7.625 |Global loss: 9.8878| Local H loss: 0.0604  | Global H loss: 0.0562 [0m
[94mEpoch: 2|  NKD Loss: 2.1525 | CT Loss: 5.1743| [0m
[91mEpoch: 2|  Loss:  7.6057 |Global loss: 9.8772| Local H loss: 0.0634  | Global H loss: 0.0575 [0m
[94mEpoch: 3|  NKD Loss: 2.1645 | CT Loss: 5.1735| [0m
[91mEpoch: 3|  Loss:  7.6433 |Global loss: 9.8882| Local H loss: 0.0609  | Global H loss: 0.0557 [0m
[94mEpoch: 0|  NKD Loss: 2.1351 | CT Loss: 5.134| [0m
[91mEpoch: 0|  Loss:  7.4501 |Global loss: 9.824| Local H loss: 0.0688  | Global H loss: 0.0635 [0m
[94mEpoch: 1|  NKD Loss: 2.1277 | CT Loss: 5.1322| [0m
[91mEpoch: 1|  Loss:  7.4294 |Global loss: 9.8142| Local H loss: 0.0704  | Global H loss: 0.0647 [0m
[94mEpoch: 2|  NKD Loss: 2.1194 | CT Loss: 5.1306| [0m
[91mEpoch: 2|  Loss:  7.4036 |Global loss: 9.8106| Local H loss: 0.0736  | Global H loss: 0.0668 [0m
[94mEpoch: 3|  NKD Loss: 2.1293 | CT Loss: 5.13| [0m
[91mEpoch: 3|  Loss:  7.4306 |Global loss: 9.8156| Local H loss: 0.0711  | Global H loss: 0.0649 [0m
[94mEpoch: 0|  NKD Loss: 2.1158 | CT Loss: 5.1565| [0m
[91mEpoch: 0|  Loss:  7.4188 |Global loss: 9.8324| Local H loss: 0.0751  | Global H loss: 0.0682 [0m
[94mEpoch: 1|  NKD Loss: 2.1151 | CT Loss: 5.1546| [0m
[91mEpoch: 1|  Loss:  7.4155 |Global loss: 9.8262| Local H loss: 0.0759  | Global H loss: 0.0683 [0m
[94mEpoch: 2|  NKD Loss: 2.1138 | CT Loss: 5.1536| [0m
[91mEpoch: 2|  Loss:  7.4103 |Global loss: 9.8263| Local H loss: 0.0763  | Global H loss: 0.0688 [0m
[94mEpoch: 3|  NKD Loss: 2.1133 | CT Loss: 5.1508| [0m
[91mEpoch: 3|  Loss:  7.4066 |Global loss: 9.8267| Local H loss: 0.0768  | Global H loss: 0.069 [0m
[94mEpoch: 0|  NKD Loss: 2.1698 | CT Loss: 5.1934| [0m
[91mEpoch: 0|  Loss:  7.6435 |Global loss: 9.9069| Local H loss: 0.0523  | Global H loss: 0.0523 [0m
[94mEpoch: 1|  NKD Loss: 2.1639 | CT Loss: 5.1896| [0m
[91mEpoch: 1|  Loss:  7.6298 |Global loss: 9.8957| Local H loss: 0.0532  | Global H loss: 0.0529 [0m
[94mEpoch: 2|  NKD Loss: 2.1647 | CT Loss: 5.1885| [0m
[91mEpoch: 2|  Loss:  7.6284 |Global loss: 9.8979| Local H loss: 0.0527  | Global H loss: 0.0526 [0m
[94mEpoch: 3|  NKD Loss: 2.1601 | CT Loss: 5.1871| [0m
[91mEpoch: 3|  Loss:  7.6067 |Global loss: 9.8918| Local H loss: 0.0564  | Global H loss: 0.0549 [0m
[94mEpoch: 0|  NKD Loss: 2.1174 | CT Loss: 5.1496| [0m
[91mEpoch: 0|  Loss:  7.4203 |Global loss: 9.8242| Local H loss: 0.0715  | Global H loss: 0.0665 [0m
[94mEpoch: 1|  NKD Loss: 2.1197 | CT Loss: 5.1474| [0m
[91mEpoch: 1|  Loss:  7.421 |Global loss: 9.8257| Local H loss: 0.071  | Global H loss: 0.0662 [0m
[94mEpoch: 2|  NKD Loss: 2.1281 | CT Loss: 5.1458| [0m
[91mEpoch: 2|  Loss:  7.4413 |Global loss: 9.8326| Local H loss: 0.0681  | Global H loss: 0.0642 [0m
[94mEpoch: 3|  NKD Loss: 2.1182 | CT Loss: 5.1426| [0m
[91mEpoch: 3|  Loss:  7.4143 |Global loss: 9.8195| Local H loss: 0.071  | Global H loss: 0.0663 [0m
[94mEpoch: 0|  NKD Loss: 2.1159 | CT Loss: 5.1618| [0m
[91mEpoch: 0|  Loss:  7.4227 |Global loss: 9.8389| Local H loss: 0.0755  | Global H loss: 0.0683 [0m
[94mEpoch: 1|  NKD Loss: 2.1179 | CT Loss: 5.1618| [0m
[91mEpoch: 1|  Loss:  7.4265 |Global loss: 9.8389| Local H loss: 0.0745  | Global H loss: 0.0678 [0m
[94mEpoch: 2|  NKD Loss: 2.1128 | CT Loss: 5.1593| [0m
[91mEpoch: 2|  Loss:  7.4167 |Global loss: 9.8306| Local H loss: 0.0765  | Global H loss: 0.0686 [0m
[94mEpoch: 3|  NKD Loss: 2.1107 | CT Loss: 5.1558| [0m
[91mEpoch: 3|  Loss:  7.4082 |Global loss: 9.8301| Local H loss: 0.0779  | Global H loss: 0.0693 [0m
------------------------- time cost ------------------------- 3.055079698562622
Chosen Clients:  [5, 2, 9, 12, 8, 3]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.967, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.967, 0.983]
AUC in each clients:  [119.015, 119.412, 119.991, 118.994, 119.762, 119.904, 119.975, 118.995, 119.035, 119.633, 119.93, 119.434, 119.97, 119.766, 118.97]
F1 Score:  [0.984, 0.984, 0.974, 0.973, 0.964, 0.981, 0.974, 0.973, 0.974, 0.973, 0.981, 0.981, 0.975, 0.968, 0.982]
Recall Score:  [0.986, 0.986, 0.977, 0.977, 0.968, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.978, 0.971, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3368
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9761
Averaged Test Recal score: 0.9791
Std Test Accurancy: 0.0057
Std Test AUC: 0.0034
Std Test F1: 0.0000
Std Test Recall: 0.0000
[94mEpoch: 0|  NKD Loss: 2.1312 | CT Loss: 5.1778| [0m
[91mEpoch: 0|  Loss:  7.4986 |Global loss: 9.8643| Local H loss: 0.064  | Global H loss: 0.0614 [0m
[94mEpoch: 1|  NKD Loss: 2.1321 | CT Loss: 5.1756| [0m
[91mEpoch: 1|  Loss:  7.4931 |Global loss: 9.8631| Local H loss: 0.0645  | Global H loss: 0.062 [0m
[94mEpoch: 2|  NKD Loss: 2.1291 | CT Loss: 5.1733| [0m
[91mEpoch: 2|  Loss:  7.4812 |Global loss: 9.8587| Local H loss: 0.0657  | Global H loss: 0.0627 [0m
[94mEpoch: 3|  NKD Loss: 2.1362 | CT Loss: 5.172| [0m
[91mEpoch: 3|  Loss:  7.4973 |Global loss: 9.8605| Local H loss: 0.0641  | Global H loss: 0.0614 [0m
[94mEpoch: 0|  NKD Loss: 2.1173 | CT Loss: 5.128| [0m
[91mEpoch: 0|  Loss:  7.3945 |Global loss: 9.8009| Local H loss: 0.075  | Global H loss: 0.0676 [0m
[94mEpoch: 1|  NKD Loss: 2.1196 | CT Loss: 5.1235| [0m
[91mEpoch: 1|  Loss:  7.3982 |Global loss: 9.8| Local H loss: 0.0731  | Global H loss: 0.0665 [0m
[94mEpoch: 2|  NKD Loss: 2.1309 | CT Loss: 5.1232| [0m
[91mEpoch: 2|  Loss:  7.4283 |Global loss: 9.8155| Local H loss: 0.0704  | Global H loss: 0.0643 [0m
[94mEpoch: 3|  NKD Loss: 2.1151 | CT Loss: 5.1216| [0m
[91mEpoch: 3|  Loss:  7.3845 |Global loss: 9.7948| Local H loss: 0.0745  | Global H loss: 0.0676 [0m
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkdx.py", line 44, in train
    client.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 142, in train
    loss_g.backward()
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
