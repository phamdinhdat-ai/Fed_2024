
Join ratio / total clients: 0.4 / 9
Finished creating server and clients.
Chosen Clients:  [4, 5, 1]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.094, 0.122, 0.116, 0.093, 0.095, 0.131, 0.114, 0.0]
AUC in each clients:  [242.113, 240.111, 164.162, 223.412, 259.558, 234.449, 230.275, 250.856, 0.0]
F1 Score:  [0.013, 0.014, 0.027, 0.021, 0.014, 0.016, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.083, 0.125, 0.1, 0.083, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.2930
Averaged Test Accurancy: 0.1047
Averaged Test AUC: 0.4915
Averaged Test F1_score: 0.0159
Averaged Test Recal score: 0.0821
Std Test Accurancy: 0.0365
Std Test AUC: 0.1553
Std Test F1: 0.0000
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 3.7966
Epoch: 0|  Loss:  6.284 |Global loss: 6.2909| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 3.7959
Epoch: 1|  Loss:  6.2605 |Global loss: 6.2765| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 2|  NKD Loss: 3.792
Epoch: 2|  Loss:  6.23 |Global loss: 6.2562| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 3|  NKD Loss: 3.7751
Epoch: 3|  Loss:  6.1719 |Global loss: 6.2133| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7969
Epoch: 0|  Loss:  6.2782 |Global loss: 6.2842| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2547 |Global loss: 6.2677| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 3.7919
Epoch: 2|  Loss:  6.228 |Global loss: 6.2459| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 3.7787
Epoch: 3|  Loss:  6.1824 |Global loss: 6.2118| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 0|  NKD Loss: 3.7966
Epoch: 0|  Loss:  6.2867 |Global loss: 6.2945| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 3.7969
Epoch: 1|  Loss:  6.2624 |Global loss: 6.2821| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 2|  NKD Loss: 3.7962
Epoch: 2|  Loss:  6.2328 |Global loss: 6.2664| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 3.7918
Epoch: 3|  Loss:  6.1851 |Global loss: 6.2422| Local H loss: 0.0093  | Global H loss: 0.0093
------------------------- time cost ------------------------- 11.488439559936523
Chosen Clients:  [6, 8, 4]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.258, 0.122, 0.116, 0.25, 0.178, 0.131, 0.114, 0.0]
AUC in each clients:  [242.113, 350.678, 164.162, 223.412, 350.42, 331.503, 230.275, 250.856, 0.0]
F1 Score:  [0.013, 0.125, 0.027, 0.021, 0.145, 0.051, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.231, 0.125, 0.1, 0.223, 0.103, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.2386
Averaged Test Accurancy: 0.1596
Averaged Test AUC: 0.5710
Averaged Test F1_score: 0.0467
Averaged Test Recal score: 0.1154
Std Test Accurancy: 0.0760
Std Test AUC: 0.1967
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 3.8021
Epoch: 0|  Loss:  6.2805 |Global loss: 6.241| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 3.7773
Epoch: 1|  Loss:  6.2084 |Global loss: 6.1762| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 2.6855
Epoch: 2|  Loss:  5.2527 |Global loss: 5.6686| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 3|  NKD Loss: 1.3092
Epoch: 3|  Loss:  4.2358 |Global loss: 5.1918| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 0|  NKD Loss: 3.7511
Epoch: 0|  Loss:  6.3559 |Global loss: 6.5549| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 1|  NKD Loss: 3.7565
Epoch: 1|  Loss:  6.3416 |Global loss: 6.516| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 3.7577
Epoch: 2|  Loss:  6.3231 |Global loss: 6.5011| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 3.7586
Epoch: 3|  Loss:  6.3049 |Global loss: 6.4884| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 3.1472
Epoch: 0|  Loss:  5.6297 |Global loss: 5.9696| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 1.4057
Epoch: 1|  Loss:  4.4217 |Global loss: 5.4593| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 1.3446
Epoch: 2|  Loss:  4.3144 |Global loss: 5.4173| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 1.3131
Epoch: 3|  Loss:  4.2159 |Global loss: 5.3992| Local H loss: 0.0098  | Global H loss: 0.0098
------------------------- time cost ------------------------- 8.337807416915894
Chosen Clients:  [5, 2, 1]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.258, 0.122, 0.116, 0.112, 0.178, 0.133, 0.114, 0.0]
AUC in each clients:  [242.113, 350.678, 164.162, 223.412, 359.09, 331.503, 308.038, 250.856, 4.371]
F1 Score:  [0.013, 0.125, 0.027, 0.021, 0.017, 0.051, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.231, 0.125, 0.1, 0.083, 0.103, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.5512
Averaged Test Accurancy: 0.1404
Averaged Test AUC: 0.5952
Averaged Test F1_score: 0.0324
Averaged Test Recal score: 0.0999
Std Test Accurancy: 0.0652
Std Test AUC: 0.1144
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 2.0016
Epoch: 0|  Loss:  4.7985 |Global loss: 5.5738| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 1|  NKD Loss: 1.333
Epoch: 1|  Loss:  4.3148 |Global loss: 5.3185| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.2914
Epoch: 2|  Loss:  4.2296 |Global loss: 5.2876| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 1.2951
Epoch: 3|  Loss:  4.1291 |Global loss: 5.2602| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 3.7993
Epoch: 0|  Loss:  6.2371 |Global loss: 6.161| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 2.0458
Epoch: 1|  Loss:  4.6477 |Global loss: 5.2205| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 2|  NKD Loss: 1.2465
Epoch: 2|  Loss:  3.9551 |Global loss: 4.7825| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 3|  NKD Loss: 1.2413
Epoch: 3|  Loss:  3.8652 |Global loss: 4.6982| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 1.8585
Epoch: 0|  Loss:  4.7457 |Global loss: 5.6194| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 1.308
Epoch: 1|  Loss:  4.3288 |Global loss: 5.4381| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 1.2408
Epoch: 2|  Loss:  4.1905 |Global loss: 5.4221| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2112
Epoch: 3|  Loss:  4.027 |Global loss: 5.3931| Local H loss: 0.0099  | Global H loss: 0.0099
------------------------- time cost ------------------------- 9.946430206298828
Chosen Clients:  [7, 3, 2]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.173, 0.172, 0.116, 0.112, 0.168, 0.133, 0.114, 0.0]
AUC in each clients:  [242.113, 356.953, 247.728, 223.412, 359.09, 358.796, 308.038, 250.856, 4.371]
F1 Score:  [0.013, 0.095, 0.037, 0.021, 0.017, 0.026, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.156, 0.125, 0.1, 0.083, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.2865
Averaged Test Accurancy: 0.1321
Averaged Test AUC: 0.6264
Averaged Test F1_score: 0.0274
Averaged Test Recal score: 0.0902
Std Test Accurancy: 0.0515
Std Test AUC: 0.1288
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 3.4737
Epoch: 0|  Loss:  5.9873 |Global loss: 6.2014| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.3818
Epoch: 1|  Loss:  4.4614 |Global loss: 5.4417| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.2905
Epoch: 2|  Loss:  4.3275 |Global loss: 5.3433| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2432
Epoch: 3|  Loss:  4.2363 |Global loss: 5.3014| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 3.7041
Epoch: 0|  Loss:  6.1793 |Global loss: 6.2486| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 1.5701
Epoch: 1|  Loss:  4.5295 |Global loss: 5.4145| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 1.2622
Epoch: 2|  Loss:  4.277 |Global loss: 5.2696| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2407
Epoch: 3|  Loss:  4.2035 |Global loss: 5.204| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.3398
Epoch: 0|  Loss:  3.9108 |Global loss: 4.9071| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 1|  NKD Loss: 1.2349
Epoch: 1|  Loss:  3.7686 |Global loss: 4.6884| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 1.2227
Epoch: 2|  Loss:  3.6906 |Global loss: 4.6242| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 3|  NKD Loss: 1.1882
Epoch: 3|  Loss:  3.5752 |Global loss: 4.5825| Local H loss: 0.0129  | Global H loss: 0.0129
------------------------- time cost ------------------------- 9.797003030776978
Chosen Clients:  [6, 5, 1]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.173, 0.172, 0.081, 0.112, 0.168, 0.133, 0.152, 0.0]
AUC in each clients:  [242.113, 356.953, 255.039, 294.17, 359.09, 358.796, 308.038, 333.294, 4.371]
F1 Score:  [0.013, 0.095, 0.037, 0.015, 0.017, 0.026, 0.021, 0.022, 0.0]
Recall Score:  [0.083, 0.156, 0.125, 0.1, 0.083, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 5.3995
Averaged Test Accurancy: 0.1329
Averaged Test AUC: 0.6691
Averaged Test F1_score: 0.0273
Averaged Test Recal score: 0.0902
Std Test Accurancy: 0.0542
Std Test AUC: 0.1191
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.3039
Epoch: 0|  Loss:  4.1541 |Global loss: 5.3132| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2307
Epoch: 1|  Loss:  3.9977 |Global loss: 5.1108| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.1822
Epoch: 2|  Loss:  3.8264 |Global loss: 5.0584| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 3|  NKD Loss: 1.1289
Epoch: 3|  Loss:  3.6581 |Global loss: 5.026| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 1.301
Epoch: 0|  Loss:  4.0358 |Global loss: 5.4129| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.236
Epoch: 1|  Loss:  3.8901 |Global loss: 5.2671| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.1867
Epoch: 2|  Loss:  3.759 |Global loss: 5.2073| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.1311
Epoch: 3|  Loss:  3.6357 |Global loss: 4.9992| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.2487
Epoch: 0|  Loss:  3.9668 |Global loss: 5.568| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.1625
Epoch: 1|  Loss:  3.8015 |Global loss: 5.3997| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 1.1316
Epoch: 2|  Loss:  3.6766 |Global loss: 5.3648| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 1.094
Epoch: 3|  Loss:  3.5149 |Global loss: 5.3231| Local H loss: 0.0117  | Global H loss: 0.0117
------------------------- time cost ------------------------- 10.910583734512329
Chosen Clients:  [4, 2, 1]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.175, 0.172, 0.081, 0.112, 0.257, 0.238, 0.152, 0.0]
AUC in each clients:  [242.113, 401.287, 255.039, 294.17, 359.09, 393.157, 347.193, 333.294, 4.371]
F1 Score:  [0.013, 0.096, 0.037, 0.015, 0.017, 0.118, 0.114, 0.022, 0.0]
Recall Score:  [0.083, 0.158, 0.125, 0.1, 0.083, 0.18, 0.18, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 5.6097
Averaged Test Accurancy: 0.1572
Averaged Test AUC: 0.7005
Averaged Test F1_score: 0.0480
Averaged Test Recal score: 0.1102
Std Test Accurancy: 0.0766
Std Test AUC: 0.1395
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.2961
Epoch: 0|  Loss:  4.1411 |Global loss: 5.3392| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.1243
Epoch: 1|  Loss:  3.8995 |Global loss: 4.988| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 1.0681
Epoch: 2|  Loss:  3.7726 |Global loss: 4.8372| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 3|  NKD Loss: 1.0484
Epoch: 3|  Loss:  3.6489 |Global loss: 4.7372| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 0|  NKD Loss: 1.2204
Epoch: 0|  Loss:  3.5098 |Global loss: 4.8008| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 1.0634
Epoch: 1|  Loss:  3.2351 |Global loss: 4.3775| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.0198
Epoch: 2|  Loss:  3.0436 |Global loss: 4.116| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 3|  NKD Loss: 1.0062
Epoch: 3|  Loss:  2.8937 |Global loss: 3.9478| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 0|  NKD Loss: 1.2422
Epoch: 0|  Loss:  3.5365 |Global loss: 5.4473| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 1.005
Epoch: 1|  Loss:  3.2499 |Global loss: 5.0198| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 2|  NKD Loss: 0.9529
Epoch: 2|  Loss:  3.0912 |Global loss: 4.811| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 3|  NKD Loss: 0.9143
Epoch: 3|  Loss:  2.9599 |Global loss: 4.7437| Local H loss: 0.0162  | Global H loss: 0.0162
------------------------- time cost ------------------------- 10.723865509033203
Chosen Clients:  [7, 6, 2]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.309, 0.267, 0.081, 0.163, 0.257, 0.238, 0.152, 0.0]
AUC in each clients:  [242.113, 424.895, 282.185, 294.17, 409.73, 393.157, 347.193, 333.294, 4.371]
F1 Score:  [0.013, 0.24, 0.156, 0.015, 0.077, 0.118, 0.114, 0.022, 0.0]
Recall Score:  [0.083, 0.283, 0.233, 0.1, 0.145, 0.18, 0.18, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 5.4427
Averaged Test Accurancy: 0.1910
Averaged Test AUC: 0.7275
Averaged Test F1_score: 0.0839
Averaged Test Recal score: 0.1430
Std Test Accurancy: 0.0976
Std Test AUC: 0.1551
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.1667
Epoch: 0|  Loss:  4.0923 |Global loss: 5.108| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.0086
Epoch: 1|  Loss:  3.8238 |Global loss: 4.8186| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 0.9773
Epoch: 2|  Loss:  3.7332 |Global loss: 4.7173| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 3|  NKD Loss: 0.9861
Epoch: 3|  Loss:  3.6912 |Global loss: 4.6958| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 0|  NKD Loss: 1.1598
Epoch: 0|  Loss:  3.5866 |Global loss: 4.8073| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 0.9648
Epoch: 1|  Loss:  3.2926 |Global loss: 4.4486| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 0.9341
Epoch: 2|  Loss:  3.1192 |Global loss: 4.3452| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 3|  NKD Loss: 0.9176
Epoch: 3|  Loss:  2.9438 |Global loss: 4.2994| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 0|  NKD Loss: 1.1059
Epoch: 0|  Loss:  2.8833 |Global loss: 4.3278| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 0.9538
Epoch: 1|  Loss:  2.6162 |Global loss: 3.9222| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 2|  NKD Loss: 0.963
Epoch: 2|  Loss:  2.5298 |Global loss: 3.8943| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 0.9271
Epoch: 3|  Loss:  2.4272 |Global loss: 3.7479| Local H loss: 0.0236  | Global H loss: 0.0236
------------------------- time cost ------------------------- 10.344713926315308
Chosen Clients:  [3, 8, 7]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.309, 0.591, 0.081, 0.163, 0.257, 0.24, 0.241, 0.0]
AUC in each clients:  [242.113, 424.895, 297.674, 294.17, 409.73, 393.157, 385.757, 373.283, 4.371]
F1 Score:  [0.013, 0.24, 0.401, 0.015, 0.077, 0.118, 0.115, 0.104, 0.0]
Recall Score:  [0.083, 0.283, 0.472, 0.1, 0.145, 0.18, 0.182, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.8258
Averaged Test Accurancy: 0.2323
Averaged Test AUC: 0.7526
Averaged Test F1_score: 0.1203
Averaged Test Recal score: 0.1787
Std Test Accurancy: 0.1624
Std Test AUC: 0.1665
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.1723
Epoch: 0|  Loss:  4.0869 |Global loss: 4.8904| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 1|  NKD Loss: 1.0325
Epoch: 1|  Loss:  3.78 |Global loss: 4.4278| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 2|  NKD Loss: 1.0645
Epoch: 2|  Loss:  3.6218 |Global loss: 4.3144| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 0.9889
Epoch: 3|  Loss:  3.4314 |Global loss: 4.1581| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 0|  NKD Loss: 3.6979
Epoch: 0|  Loss:  6.2395 |Global loss: 9.4551| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.6483
Epoch: 1|  Loss:  6.1714 |Global loss: 8.8053| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 2|  NKD Loss: 3.6345
Epoch: 2|  Loss:  6.1396 |Global loss: 7.8598| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 3|  NKD Loss: 3.6444
Epoch: 3|  Loss:  6.1329 |Global loss: 7.384| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.0882
Epoch: 0|  Loss:  3.7471 |Global loss: 4.9658| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 1|  NKD Loss: 0.988
Epoch: 1|  Loss:  3.6181 |Global loss: 4.6802| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 0.9722
Epoch: 2|  Loss:  3.5539 |Global loss: 4.6181| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 3|  NKD Loss: 0.9526
Epoch: 3|  Loss:  3.4829 |Global loss: 4.5622| Local H loss: 0.0135  | Global H loss: 0.0135
------------------------- time cost ------------------------- 8.355902194976807
Chosen Clients:  [6, 5, 7]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.309, 0.591, 0.188, 0.163, 0.257, 0.24, 0.241, 0.0]
AUC in each clients:  [242.113, 424.895, 297.674, 358.565, 409.73, 393.157, 385.757, 394.059, 5.455]
F1 Score:  [0.013, 0.24, 0.401, 0.113, 0.077, 0.118, 0.115, 0.105, 0.0]
Recall Score:  [0.083, 0.283, 0.472, 0.192, 0.145, 0.18, 0.182, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 5.0161
Averaged Test Accurancy: 0.2451
Averaged Test AUC: 0.7755
Averaged Test F1_score: 0.1313
Averaged Test Recal score: 0.1889
Std Test Accurancy: 0.1556
Std Test AUC: 0.1468
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.1761
Epoch: 0|  Loss:  3.07 |Global loss: 4.7702| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 1|  NKD Loss: 0.9658
Epoch: 1|  Loss:  2.752 |Global loss: 4.4375| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 0.8779
Epoch: 2|  Loss:  2.5551 |Global loss: 4.2953| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 3|  NKD Loss: 0.8575
Epoch: 3|  Loss:  2.4228 |Global loss: 4.2474| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 0|  NKD Loss: 1.42
Epoch: 0|  Loss:  3.7665 |Global loss: 4.9367| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.2643
Epoch: 1|  Loss:  3.4883 |Global loss: 4.7146| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 1.1348
Epoch: 2|  Loss:  3.2268 |Global loss: 4.5712| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 1.1068
Epoch: 3|  Loss:  3.0611 |Global loss: 4.4626| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 0|  NKD Loss: 1.3173
Epoch: 0|  Loss:  3.7788 |Global loss: 4.9335| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 1|  NKD Loss: 1.2059
Epoch: 1|  Loss:  3.5865 |Global loss: 4.7117| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 1.1526
Epoch: 2|  Loss:  3.482 |Global loss: 4.6461| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 3|  NKD Loss: 1.0686
Epoch: 3|  Loss:  3.2852 |Global loss: 4.5165| Local H loss: 0.0147  | Global H loss: 0.0147
------------------------- time cost ------------------------- 10.646754264831543
Chosen Clients:  [5, 1, 4]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.309, 0.591, 0.188, 0.163, 0.335, 0.516, 0.241, 0.0]
AUC in each clients:  [242.113, 424.895, 297.674, 358.565, 409.73, 415.03, 405.275, 412.854, 5.455]
F1 Score:  [0.013, 0.24, 0.401, 0.113, 0.077, 0.209, 0.325, 0.104, 0.0]
Recall Score:  [0.083, 0.283, 0.472, 0.192, 0.145, 0.268, 0.361, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.9283
Averaged Test Accurancy: 0.2882
Averaged Test AUC: 0.7916
Averaged Test F1_score: 0.1647
Averaged Test Recal score: 0.2186
Std Test Accurancy: 0.1813
Std Test AUC: 0.1549
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.3753
Epoch: 0|  Loss:  3.2121 |Global loss: 4.9562| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 1.1043
Epoch: 1|  Loss:  2.7897 |Global loss: 4.4039| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 0.9963
Epoch: 2|  Loss:  2.5673 |Global loss: 4.336| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9566
Epoch: 3|  Loss:  2.4604 |Global loss: 4.2365| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 1.0911
Epoch: 0|  Loss:  3.032 |Global loss: 5.0494| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 0.9661
Epoch: 1|  Loss:  2.8492 |Global loss: 4.7946| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 0.9353
Epoch: 2|  Loss:  2.7305 |Global loss: 4.7497| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 0.8944
Epoch: 3|  Loss:  2.6084 |Global loss: 4.6616| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 0|  NKD Loss: 1.219
Epoch: 0|  Loss:  3.7006 |Global loss: 5.0716| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 1|  NKD Loss: 1.1166
Epoch: 1|  Loss:  3.4615 |Global loss: 4.7572| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 2|  NKD Loss: 1.0318
Epoch: 2|  Loss:  3.278 |Global loss: 4.5516| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 3|  NKD Loss: 1.0357
Epoch: 3|  Loss:  3.1512 |Global loss: 4.5282| Local H loss: 0.0165  | Global H loss: 0.0165
------------------------- time cost ------------------------- 11.205795526504517
Chosen Clients:  [8, 5, 4]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.319, 0.591, 0.188, 0.19, 0.447, 0.516, 0.241, 0.0]
AUC in each clients:  [242.113, 439.491, 297.674, 358.565, 438.368, 437.568, 405.275, 412.854, 5.455]
F1 Score:  [0.013, 0.246, 0.401, 0.113, 0.092, 0.324, 0.325, 0.104, 0.0]
Recall Score:  [0.083, 0.293, 0.472, 0.192, 0.165, 0.369, 0.361, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.0643
Averaged Test Accurancy: 0.3077
Averaged Test AUC: 0.8091
Averaged Test F1_score: 0.1798
Averaged Test Recal score: 0.2331
Std Test Accurancy: 0.1875
Std Test AUC: 0.1619
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.5236
Epoch: 0|  Loss:  6.0044 |Global loss: 10.5002| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.4751
Epoch: 1|  Loss:  5.9439 |Global loss: 9.8822| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 2|  NKD Loss: 3.4658
Epoch: 2|  Loss:  5.9204 |Global loss: 8.3938| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 3.4884
Epoch: 3|  Loss:  5.925 |Global loss: 7.4379| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 1.2961
Epoch: 0|  Loss:  2.7644 |Global loss: 4.9902| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.0013
Epoch: 1|  Loss:  2.4211 |Global loss: 4.4395| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.9229
Epoch: 2|  Loss:  2.2686 |Global loss: 4.2507| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.889
Epoch: 3|  Loss:  2.205 |Global loss: 4.1687| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.2287
Epoch: 0|  Loss:  3.2493 |Global loss: 5.173| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 1|  NKD Loss: 1.1949
Epoch: 1|  Loss:  3.0957 |Global loss: 4.9509| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 2|  NKD Loss: 1.0843
Epoch: 2|  Loss:  2.8849 |Global loss: 4.7215| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 3|  NKD Loss: 1.0165
Epoch: 3|  Loss:  2.7483 |Global loss: 4.6287| Local H loss: 0.0192  | Global H loss: 0.0192
------------------------- time cost ------------------------- 8.896855592727661
Chosen Clients:  [6, 0, 2]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.319, 0.591, 0.188, 0.433, 0.542, 0.516, 0.241, 0.0]
AUC in each clients:  [242.113, 439.491, 297.674, 358.565, 461.899, 443.264, 405.275, 412.854, 9.818]
F1 Score:  [0.013, 0.246, 0.401, 0.113, 0.343, 0.432, 0.325, 0.104, 0.0]
Recall Score:  [0.083, 0.293, 0.472, 0.192, 0.368, 0.455, 0.361, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.2749
Averaged Test Accurancy: 0.3540
Averaged Test AUC: 0.8180
Averaged Test F1_score: 0.2197
Averaged Test Recal score: 0.2652
Std Test Accurancy: 0.1989
Std Test AUC: 0.1189
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.0215
Epoch: 0|  Loss:  2.4808 |Global loss: 4.9759| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 1|  NKD Loss: 0.9394
Epoch: 1|  Loss:  2.313 |Global loss: 4.3368| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 0.8733
Epoch: 2|  Loss:  2.1357 |Global loss: 4.1629| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.8449
Epoch: 3|  Loss:  2.0456 |Global loss: 4.0233| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 2.6779
Epoch: 0|  Loss:  5.4558 |Global loss: 5.8424| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2638
Epoch: 1|  Loss:  4.4883 |Global loss: 4.9129| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 1.2435
Epoch: 2|  Loss:  4.4545 |Global loss: 4.8189| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 1.2352
Epoch: 3|  Loss:  4.4296 |Global loss: 4.8067| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 0|  NKD Loss: 1.1624
Epoch: 0|  Loss:  2.6092 |Global loss: 4.2444| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 0.9942
Epoch: 1|  Loss:  2.3815 |Global loss: 3.6366| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.0122
Epoch: 2|  Loss:  2.3777 |Global loss: 3.4877| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9584
Epoch: 3|  Loss:  2.2511 |Global loss: 3.2957| Local H loss: 0.0267  | Global H loss: 0.0267
------------------------- time cost ------------------------- 9.528217315673828
Chosen Clients:  [1, 0, 5]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.104, 0.319, 0.582, 0.188, 0.433, 0.542, 0.689, 0.241, 0.0]
AUC in each clients:  [297.184, 439.491, 306.336, 358.565, 461.899, 443.264, 418.106, 412.854, 9.818]
F1 Score:  [0.016, 0.246, 0.398, 0.113, 0.343, 0.432, 0.459, 0.104, 0.0]
Recall Score:  [0.083, 0.293, 0.466, 0.192, 0.368, 0.455, 0.501, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 3.9872
Averaged Test Accurancy: 0.3767
Averaged Test AUC: 0.8384
Averaged Test F1_score: 0.2346
Averaged Test Recal score: 0.2801
Std Test Accurancy: 0.2197
Std Test AUC: 0.0905
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9937
Epoch: 0|  Loss:  2.6214 |Global loss: 5.1174| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 1|  NKD Loss: 0.9372
Epoch: 1|  Loss:  2.4785 |Global loss: 4.8313| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 2|  NKD Loss: 0.9164
Epoch: 2|  Loss:  2.3851 |Global loss: 4.7266| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 3|  NKD Loss: 0.9272
Epoch: 3|  Loss:  2.2972 |Global loss: 4.7567| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 0|  NKD Loss: 1.2842
Epoch: 0|  Loss:  4.409 |Global loss: 5.3456| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 1|  NKD Loss: 1.2297
Epoch: 1|  Loss:  4.3157 |Global loss: 4.8073| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 1.1999
Epoch: 2|  Loss:  4.13 |Global loss: 4.6921| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 1.156
Epoch: 3|  Loss:  3.8764 |Global loss: 4.6241| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.1822
Epoch: 0|  Loss:  2.4716 |Global loss: 5.3098| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 1|  NKD Loss: 0.9315
Epoch: 1|  Loss:  2.1672 |Global loss: 4.2924| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8293
Epoch: 2|  Loss:  1.998 |Global loss: 4.0133| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8334
Epoch: 3|  Loss:  1.964 |Global loss: 3.9625| Local H loss: 0.0289  | Global H loss: 0.0289
------------------------- time cost ------------------------- 10.94224214553833
Chosen Clients:  [0, 3, 7]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.201, 0.439, 0.582, 0.188, 0.433, 0.696, 0.689, 0.241, 0.0]
AUC in each clients:  [365.641, 452.832, 306.336, 358.565, 461.899, 447.425, 418.106, 412.854, 9.818]
F1 Score:  [0.098, 0.353, 0.398, 0.113, 0.343, 0.548, 0.459, 0.104, 0.0]
Recall Score:  [0.162, 0.382, 0.466, 0.192, 0.368, 0.573, 0.501, 0.163, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.3120
Averaged Test Accurancy: 0.4251
Averaged Test AUC: 0.8613
Averaged Test F1_score: 0.2684
Averaged Test Recal score: 0.3119
Std Test Accurancy: 0.2296
Std Test AUC: 0.0583
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.2137
Epoch: 0|  Loss:  3.7729 |Global loss: 5.1376| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 1|  NKD Loss: 1.1412
Epoch: 1|  Loss:  3.5457 |Global loss: 4.605| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 1.1096
Epoch: 2|  Loss:  3.3977 |Global loss: 4.4567| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.0981
Epoch: 3|  Loss:  3.2941 |Global loss: 4.3543| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2605
Epoch: 0|  Loss:  3.6265 |Global loss: 4.8638| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.1134
Epoch: 1|  Loss:  3.3226 |Global loss: 4.2675| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 2|  NKD Loss: 1.0976
Epoch: 2|  Loss:  3.2097 |Global loss: 4.1442| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 3|  NKD Loss: 1.0879
Epoch: 3|  Loss:  3.0431 |Global loss: 4.0935| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 0|  NKD Loss: 1.261
Epoch: 0|  Loss:  3.3858 |Global loss: 4.949| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 1|  NKD Loss: 1.145
Epoch: 1|  Loss:  3.1792 |Global loss: 4.5203| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 2|  NKD Loss: 1.0574
Epoch: 2|  Loss:  2.9705 |Global loss: 4.4052| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 3|  NKD Loss: 1.0317
Epoch: 3|  Loss:  2.8383 |Global loss: 4.3543| Local H loss: 0.0179  | Global H loss: 0.0179
------------------------- time cost ------------------------- 10.92550539970398
Chosen Clients:  [4, 5, 7]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.201, 0.439, 0.582, 0.286, 0.433, 0.696, 0.689, 0.314, 0.0]
AUC in each clients:  [398.454, 452.832, 306.336, 374.636, 461.899, 447.425, 418.106, 436.049, 9.818]
F1 Score:  [0.098, 0.353, 0.398, 0.209, 0.343, 0.548, 0.459, 0.188, 0.0]
Recall Score:  [0.162, 0.382, 0.466, 0.286, 0.368, 0.573, 0.501, 0.244, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 8.0395
Averaged Test Accurancy: 0.4467
Averaged Test AUC: 0.8805
Averaged Test F1_score: 0.2884
Averaged Test Recal score: 0.3313
Std Test Accurancy: 0.2176
Std Test AUC: 0.0399
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.3539
Epoch: 0|  Loss:  3.1091 |Global loss: 5.6444| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 1.1242
Epoch: 1|  Loss:  2.8133 |Global loss: 5.0332| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 1.1183
Epoch: 2|  Loss:  2.7117 |Global loss: 4.8563| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.1434
Epoch: 3|  Loss:  2.6458 |Global loss: 4.7434| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 0|  NKD Loss: 1.3162
Epoch: 0|  Loss:  2.4541 |Global loss: 5.6878| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 0.929
Epoch: 1|  Loss:  2.0377 |Global loss: 4.2999| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8185
Epoch: 2|  Loss:  1.8705 |Global loss: 3.9802| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.8065
Epoch: 3|  Loss:  1.7952 |Global loss: 3.9055| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 1.3517
Epoch: 0|  Loss:  3.1117 |Global loss: 5.2479| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 1|  NKD Loss: 1.1461
Epoch: 1|  Loss:  2.8296 |Global loss: 4.5861| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.0216
Epoch: 2|  Loss:  2.6524 |Global loss: 4.4947| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 0.9789
Epoch: 3|  Loss:  2.5355 |Global loss: 4.4024| Local H loss: 0.0193  | Global H loss: 0.0193
------------------------- time cost ------------------------- 11.002012014389038
Chosen Clients:  [3, 4, 8]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.201, 0.439, 0.582, 0.286, 0.402, 0.677, 0.689, 0.493, 0.0]
AUC in each clients:  [398.454, 452.832, 306.336, 374.636, 471.018, 449.761, 418.106, 454.32, 9.818]
F1 Score:  [0.098, 0.353, 0.398, 0.209, 0.33, 0.552, 0.459, 0.388, 0.0]
Recall Score:  [0.162, 0.382, 0.466, 0.286, 0.349, 0.561, 0.501, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 7.6345
Averaged Test Accurancy: 0.4643
Averaged Test AUC: 0.8885
Averaged Test F1_score: 0.3097
Averaged Test Recal score: 0.3457
Std Test Accurancy: 0.2142
Std Test AUC: 0.0409
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.295
Epoch: 0|  Loss:  3.1672 |Global loss: 5.1115| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 1|  NKD Loss: 1.0584
Epoch: 1|  Loss:  2.8347 |Global loss: 4.2376| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 1.0695
Epoch: 2|  Loss:  2.7356 |Global loss: 4.1929| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 1.0743
Epoch: 3|  Loss:  2.6551 |Global loss: 4.1708| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 0|  NKD Loss: 1.2073
Epoch: 0|  Loss:  2.7042 |Global loss: 5.6931| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 1|  NKD Loss: 1.0091
Epoch: 1|  Loss:  2.4247 |Global loss: 5.0442| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 2|  NKD Loss: 1.01
Epoch: 2|  Loss:  2.4202 |Global loss: 4.9612| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 0.9549
Epoch: 3|  Loss:  2.2849 |Global loss: 4.7843| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 3.4102
Epoch: 0|  Loss:  5.822 |Global loss: 16.8373| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.2386
Epoch: 1|  Loss:  5.6349 |Global loss: 11.3393| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 2|  NKD Loss: 3.2104
Epoch: 2|  Loss:  5.5856 |Global loss: 9.1867| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 3.21
Epoch: 3|  Loss:  5.5592 |Global loss: 7.49| Local H loss: 0.0095  | Global H loss: 0.0095
------------------------- time cost ------------------------- 8.675122022628784
Chosen Clients:  [8, 6, 2]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.201, 0.439, 0.582, 0.349, 0.537, 0.677, 0.689, 0.493, 0.0]
AUC in each clients:  [398.454, 452.832, 306.336, 387.786, 481.944, 449.761, 418.106, 454.32, 10.909]
F1 Score:  [0.098, 0.353, 0.398, 0.278, 0.409, 0.552, 0.459, 0.388, 0.0]
Recall Score:  [0.162, 0.382, 0.466, 0.34, 0.45, 0.561, 0.501, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.9796
Averaged Test Accurancy: 0.4907
Averaged Test AUC: 0.8952
Averaged Test F1_score: 0.3261
Averaged Test Recal score: 0.3629
Std Test Accurancy: 0.2133
Std Test AUC: 0.0314
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.1812
Epoch: 0|  Loss:  5.4845 |Global loss: 15.6743| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 2.8375
Epoch: 1|  Loss:  5.1067 |Global loss: 8.8083| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 2.8292
Epoch: 2|  Loss:  5.0451 |Global loss: 7.3333| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 2.7573
Epoch: 3|  Loss:  4.9049 |Global loss: 6.3111| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.2197
Epoch: 0|  Loss:  2.4493 |Global loss: 5.1318| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 0.9177
Epoch: 1|  Loss:  2.1115 |Global loss: 4.4855| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 0.885
Epoch: 2|  Loss:  1.9976 |Global loss: 4.4289| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 0.8524
Epoch: 3|  Loss:  1.8939 |Global loss: 4.2709| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 1.4381
Epoch: 0|  Loss:  2.7242 |Global loss: 4.7603| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 1|  NKD Loss: 1.1679
Epoch: 1|  Loss:  2.4453 |Global loss: 3.8249| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.0884
Epoch: 2|  Loss:  2.3062 |Global loss: 3.6339| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.9977
Epoch: 3|  Loss:  2.1779 |Global loss: 3.4362| Local H loss: 0.0246  | Global H loss: 0.0246
------------------------- time cost ------------------------- 7.656735181808472
Chosen Clients:  [1, 0, 3]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.201, 0.439, 0.635, 0.349, 0.537, 0.677, 0.724, 0.493, 0.0]
AUC in each clients:  [398.454, 452.832, 309.144, 387.786, 481.944, 449.761, 424.327, 454.32, 10.909]
F1 Score:  [0.098, 0.353, 0.47, 0.278, 0.409, 0.552, 0.539, 0.388, 0.0]
Recall Score:  [0.162, 0.382, 0.515, 0.34, 0.45, 0.561, 0.561, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.0138
Averaged Test Accurancy: 0.4997
Averaged Test AUC: 0.8976
Averaged Test F1_score: 0.3430
Averaged Test Recal score: 0.3750
Std Test Accurancy: 0.2225
Std Test AUC: 0.0336
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.0798
Epoch: 0|  Loss:  2.4247 |Global loss: 5.5288| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 0.9016
Epoch: 1|  Loss:  2.1835 |Global loss: 4.9044| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 0.8646
Epoch: 2|  Loss:  2.1146 |Global loss: 4.8345| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.8613
Epoch: 3|  Loss:  2.0723 |Global loss: 4.7635| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.2567
Epoch: 0|  Loss:  3.4326 |Global loss: 5.545| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 1|  NKD Loss: 1.1365
Epoch: 1|  Loss:  3.217 |Global loss: 4.5304| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 2|  NKD Loss: 1.1217
Epoch: 2|  Loss:  3.1074 |Global loss: 4.4321| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 3|  NKD Loss: 1.0939
Epoch: 3|  Loss:  3.0258 |Global loss: 4.3244| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.1586
Epoch: 0|  Loss:  2.6889 |Global loss: 5.0472| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 1.0063
Epoch: 1|  Loss:  2.5094 |Global loss: 4.3036| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 1.0132
Epoch: 2|  Loss:  2.44 |Global loss: 4.2434| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.9755
Epoch: 3|  Loss:  2.3367 |Global loss: 4.1074| Local H loss: 0.0255  | Global H loss: 0.0255
------------------------- time cost ------------------------- 10.594287395477295
Chosen Clients:  [1, 5, 3]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.369, 0.52, 0.635, 0.494, 0.537, 0.677, 0.724, 0.493, 0.0]
AUC in each clients:  [410.844, 462.348, 309.144, 398.023, 481.944, 449.761, 424.327, 454.32, 10.909]
F1 Score:  [0.288, 0.405, 0.47, 0.403, 0.409, 0.552, 0.539, 0.388, 0.0]
Recall Score:  [0.32, 0.428, 0.515, 0.468, 0.45, 0.561, 0.561, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 3.0554
Averaged Test Accurancy: 0.5495
Averaged Test AUC: 0.9061
Averaged Test F1_score: 0.3838
Averaged Test Recal score: 0.4119
Std Test Accurancy: 0.2024
Std Test AUC: 0.0250
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9726
Epoch: 0|  Loss:  2.1436 |Global loss: 5.3068| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.8397
Epoch: 1|  Loss:  1.9909 |Global loss: 4.8148| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.8604
Epoch: 2|  Loss:  1.9623 |Global loss: 4.8059| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.8098
Epoch: 3|  Loss:  1.8556 |Global loss: 4.7386| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.3323
Epoch: 0|  Loss:  2.4123 |Global loss: 5.2341| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 1.039
Epoch: 1|  Loss:  2.0629 |Global loss: 4.3474| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8801
Epoch: 2|  Loss:  1.8956 |Global loss: 4.1662| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.8439
Epoch: 3|  Loss:  1.8233 |Global loss: 4.0737| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 1.0432
Epoch: 0|  Loss:  2.3937 |Global loss: 4.7467| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.9517
Epoch: 1|  Loss:  2.2611 |Global loss: 4.2879| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 0.9873
Epoch: 2|  Loss:  2.2461 |Global loss: 4.2644| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9743
Epoch: 3|  Loss:  2.2291 |Global loss: 4.1528| Local H loss: 0.0257  | Global H loss: 0.0257
------------------------- time cost ------------------------- 11.031518936157227
Chosen Clients:  [0, 5, 1]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.369, 0.616, 0.635, 0.461, 0.537, 0.731, 0.724, 0.493, 0.0]
AUC in each clients:  [410.844, 467.742, 309.144, 401.57, 481.944, 453.39, 424.327, 454.32, 10.909]
F1 Score:  [0.288, 0.544, 0.47, 0.384, 0.409, 0.59, 0.539, 0.388, 0.0]
Recall Score:  [0.32, 0.535, 0.515, 0.438, 0.45, 0.608, 0.561, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.9181
Averaged Test Accurancy: 0.5655
Averaged Test AUC: 0.9095
Averaged Test F1_score: 0.4013
Averaged Test Recal score: 0.4257
Std Test Accurancy: 0.2122
Std Test AUC: 0.0257
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.1565
Epoch: 0|  Loss:  3.0671 |Global loss: 5.1994| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 1|  NKD Loss: 1.1378
Epoch: 1|  Loss:  2.9707 |Global loss: 4.548| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 1.1066
Epoch: 2|  Loss:  2.8441 |Global loss: 4.4337| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 3|  NKD Loss: 1.0424
Epoch: 3|  Loss:  2.6909 |Global loss: 4.344| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 0|  NKD Loss: 1.2248
Epoch: 0|  Loss:  2.2259 |Global loss: 5.1231| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.9507
Epoch: 1|  Loss:  1.8878 |Global loss: 4.2159| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.8138
Epoch: 2|  Loss:  1.726 |Global loss: 3.999| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.8052
Epoch: 3|  Loss:  1.6665 |Global loss: 3.9404| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9385
Epoch: 0|  Loss:  1.9857 |Global loss: 5.298| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.8663
Epoch: 1|  Loss:  1.8651 |Global loss: 4.8209| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.8778
Epoch: 2|  Loss:  1.8446 |Global loss: 4.7464| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.8307
Epoch: 3|  Loss:  1.783 |Global loss: 4.6921| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 10.768333196640015
Chosen Clients:  [6, 8, 0]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.346, 0.742, 0.635, 0.461, 0.537, 0.718, 0.724, 0.493, 0.0]
AUC in each clients:  [424.365, 474.33, 309.144, 401.57, 481.944, 454.201, 424.327, 454.32, 10.909]
F1 Score:  [0.259, 0.647, 0.47, 0.384, 0.409, 0.576, 0.539, 0.388, 0.0]
Recall Score:  [0.304, 0.66, 0.515, 0.438, 0.45, 0.595, 0.561, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.9252
Averaged Test Accurancy: 0.5781
Averaged Test AUC: 0.9151
Averaged Test F1_score: 0.4080
Averaged Test Recal score: 0.4363
Std Test Accurancy: 0.2233
Std Test AUC: 0.0205
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9851
Epoch: 0|  Loss:  2.024 |Global loss: 4.8615| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.8524
Epoch: 1|  Loss:  1.8347 |Global loss: 4.2301| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.8185
Epoch: 2|  Loss:  1.7494 |Global loss: 4.0724| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.8346
Epoch: 3|  Loss:  1.7138 |Global loss: 4.0847| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 2.0509
Epoch: 0|  Loss:  4.1028 |Global loss: 10.7074| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 1|  NKD Loss: 1.8347
Epoch: 1|  Loss:  3.8007 |Global loss: 9.2051| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 1.3862
Epoch: 2|  Loss:  3.2678 |Global loss: 7.3028| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 3|  NKD Loss: 1.0918
Epoch: 3|  Loss:  2.8789 |Global loss: 5.6776| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.1193
Epoch: 0|  Loss:  2.759 |Global loss: 4.8247| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.0484
Epoch: 1|  Loss:  2.5871 |Global loss: 4.4197| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 2|  NKD Loss: 1.0383
Epoch: 2|  Loss:  2.4959 |Global loss: 4.3566| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 0.9937
Epoch: 3|  Loss:  2.386 |Global loss: 4.3315| Local H loss: 0.0245  | Global H loss: 0.0245
------------------------- time cost ------------------------- 8.299965620040894
Chosen Clients:  [1, 5, 6]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.513, 0.742, 0.635, 0.461, 0.537, 0.718, 0.771, 0.493, 0.0]
AUC in each clients:  [436.139, 474.33, 309.144, 401.57, 481.944, 454.201, 430.393, 454.32, 10.909]
F1 Score:  [0.446, 0.647, 0.47, 0.384, 0.409, 0.576, 0.579, 0.388, 0.0]
Recall Score:  [0.461, 0.66, 0.515, 0.438, 0.45, 0.595, 0.611, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.9690
Averaged Test Accurancy: 0.6052
Averaged Test AUC: 0.9198
Averaged Test F1_score: 0.4332
Averaged Test Recal score: 0.4593
Std Test Accurancy: 0.2201
Std Test AUC: 0.0194
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9076
Epoch: 0|  Loss:  1.842 |Global loss: 5.2812| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8479
Epoch: 1|  Loss:  1.7636 |Global loss: 4.8441| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.8412
Epoch: 2|  Loss:  1.7416 |Global loss: 4.7231| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.8083
Epoch: 3|  Loss:  1.6612 |Global loss: 4.6167| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 1.2117
Epoch: 0|  Loss:  2.1076 |Global loss: 4.9871| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.8561
Epoch: 1|  Loss:  1.7084 |Global loss: 4.0887| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.7993
Epoch: 2|  Loss:  1.6389 |Global loss: 3.8984| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.7742
Epoch: 3|  Loss:  1.5744 |Global loss: 3.8513| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.1111
Epoch: 0|  Loss:  2.0176 |Global loss: 4.8527| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.9434
Epoch: 1|  Loss:  1.7808 |Global loss: 3.8812| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.8743
Epoch: 2|  Loss:  1.6899 |Global loss: 3.8184| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.8211
Epoch: 3|  Loss:  1.574 |Global loss: 3.693| Local H loss: 0.0331  | Global H loss: 0.0331
------------------------- time cost ------------------------- 10.7489013671875
Chosen Clients:  [3, 7, 6]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.513, 0.707, 0.635, 0.461, 0.537, 0.781, 0.831, 0.493, 0.0]
AUC in each clients:  [436.139, 474.108, 309.144, 401.57, 481.944, 457.038, 433.217, 454.32, 10.909]
F1 Score:  [0.446, 0.64, 0.47, 0.384, 0.409, 0.652, 0.681, 0.388, 0.0]
Recall Score:  [0.461, 0.634, 0.515, 0.438, 0.45, 0.671, 0.698, 0.404, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.6032
Averaged Test Accurancy: 0.6156
Averaged Test AUC: 0.9213
Averaged Test F1_score: 0.4522
Averaged Test Recal score: 0.4746
Std Test Accurancy: 0.2307
Std Test AUC: 0.0215
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.1563
Epoch: 0|  Loss:  2.4138 |Global loss: 5.0503| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 0.9817
Epoch: 1|  Loss:  2.2405 |Global loss: 4.6734| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 0.9499
Epoch: 2|  Loss:  2.1478 |Global loss: 4.3053| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 0.9665
Epoch: 3|  Loss:  2.137 |Global loss: 4.3423| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 1.1739
Epoch: 0|  Loss:  2.693 |Global loss: 5.0711| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 1|  NKD Loss: 1.1723
Epoch: 1|  Loss:  2.597 |Global loss: 4.7519| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.1273
Epoch: 2|  Loss:  2.4736 |Global loss: 4.5368| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 3|  NKD Loss: 1.1386
Epoch: 3|  Loss:  2.4336 |Global loss: 4.443| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 1.0338
Epoch: 0|  Loss:  1.769 |Global loss: 5.0488| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.8178
Epoch: 1|  Loss:  1.5432 |Global loss: 4.4481| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.8003
Epoch: 2|  Loss:  1.4798 |Global loss: 4.4107| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.7754
Epoch: 3|  Loss:  1.4254 |Global loss: 4.3762| Local H loss: 0.0284  | Global H loss: 0.0284
------------------------- time cost ------------------------- 10.765788316726685
Chosen Clients:  [6, 5, 0]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.513, 0.707, 0.635, 0.544, 0.537, 0.781, 0.849, 0.562, 0.0]
AUC in each clients:  [436.139, 474.108, 309.144, 407.31, 481.944, 457.038, 436.384, 461.923, 10.909]
F1 Score:  [0.446, 0.64, 0.47, 0.453, 0.409, 0.652, 0.726, 0.441, 0.0]
Recall Score:  [0.461, 0.634, 0.515, 0.503, 0.45, 0.671, 0.72, 0.466, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.6902
Averaged Test Accurancy: 0.6369
Averaged Test AUC: 0.9257
Averaged Test F1_score: 0.4708
Averaged Test Recal score: 0.4911
Std Test Accurancy: 0.2297
Std Test AUC: 0.0206
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9994
Epoch: 0|  Loss:  1.6445 |Global loss: 4.8899| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.7489
Epoch: 1|  Loss:  1.3495 |Global loss: 4.3001| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.7534
Epoch: 2|  Loss:  1.3458 |Global loss: 4.2833| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.7321
Epoch: 3|  Loss:  1.2809 |Global loss: 4.1947| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 1.2905
Epoch: 0|  Loss:  2.1582 |Global loss: 5.5562| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 1.1287
Epoch: 1|  Loss:  1.955 |Global loss: 4.8658| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 1.0902
Epoch: 2|  Loss:  1.9425 |Global loss: 4.7454| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 1.035
Epoch: 3|  Loss:  1.8423 |Global loss: 4.5539| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.1316
Epoch: 0|  Loss:  2.5283 |Global loss: 5.3638| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.0571
Epoch: 1|  Loss:  2.3691 |Global loss: 4.6632| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 1.0054
Epoch: 2|  Loss:  2.2953 |Global loss: 4.5358| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 1.0131
Epoch: 3|  Loss:  2.2285 |Global loss: 4.5172| Local H loss: 0.0256  | Global H loss: 0.0256
------------------------- time cost ------------------------- 10.632625341415405
Chosen Clients:  [5, 2, 7]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.635, 0.544, 0.537, 0.758, 0.884, 0.562, 0.0]
AUC in each clients:  [440.987, 474.108, 309.144, 407.31, 481.944, 457.507, 437.919, 461.923, 10.909]
F1 Score:  [0.47, 0.64, 0.47, 0.453, 0.409, 0.636, 0.792, 0.441, 0.0]
Recall Score:  [0.477, 0.634, 0.515, 0.503, 0.45, 0.65, 0.775, 0.466, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 8.9838
Averaged Test Accurancy: 0.6409
Averaged Test AUC: 0.9275
Averaged Test F1_score: 0.4790
Averaged Test Recal score: 0.4967
Std Test Accurancy: 0.2321
Std Test AUC: 0.0206
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 2.2041
Epoch: 0|  Loss:  3.0739 |Global loss: 5.5263| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 1.2923
Epoch: 1|  Loss:  2.1177 |Global loss: 4.4064| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 1.1729
Epoch: 2|  Loss:  1.9786 |Global loss: 4.285| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.1
Epoch: 3|  Loss:  1.8614 |Global loss: 4.1455| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 2.0127
Epoch: 0|  Loss:  3.3349 |Global loss: 5.2259| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 1|  NKD Loss: 1.298
Epoch: 1|  Loss:  2.4568 |Global loss: 3.8252| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1003
Epoch: 2|  Loss:  2.2179 |Global loss: 3.5999| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 1.0003
Epoch: 3|  Loss:  2.0712 |Global loss: 3.5488| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 2.8558
Epoch: 0|  Loss:  4.1329 |Global loss: 6.0692| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.5481
Epoch: 1|  Loss:  2.9325 |Global loss: 4.9922| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 2|  NKD Loss: 1.2508
Epoch: 2|  Loss:  2.4672 |Global loss: 4.6283| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 3|  NKD Loss: 1.2126
Epoch: 3|  Loss:  2.355 |Global loss: 4.4643| Local H loss: 0.0209  | Global H loss: 0.0209
------------------------- time cost ------------------------- 10.342923641204834
Chosen Clients:  [5, 7, 6]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.703, 0.544, 0.537, 0.803, 0.884, 0.698, 0.0]
AUC in each clients:  [440.987, 474.108, 310.329, 407.31, 481.944, 456.701, 437.919, 473.989, 10.909]
F1 Score:  [0.47, 0.64, 0.529, 0.453, 0.409, 0.707, 0.792, 0.545, 0.0]
Recall Score:  [0.477, 0.634, 0.59, 0.503, 0.45, 0.718, 0.775, 0.573, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 7.5004
Averaged Test Accurancy: 0.6713
Averaged Test AUC: 0.9308
Averaged Test F1_score: 0.5050
Averaged Test Recal score: 0.5244
Std Test Accurancy: 0.2416
Std Test AUC: 0.0198
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.4105
Epoch: 0|  Loss:  2.202 |Global loss: 5.7493| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 1|  NKD Loss: 1.0182
Epoch: 1|  Loss:  1.7657 |Global loss: 4.7512| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 2|  NKD Loss: 0.9601
Epoch: 2|  Loss:  1.7097 |Global loss: 4.5598| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 0.8923
Epoch: 3|  Loss:  1.6115 |Global loss: 4.4394| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 1.4833
Epoch: 0|  Loss:  2.5891 |Global loss: 5.376| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 1|  NKD Loss: 1.1855
Epoch: 1|  Loss:  2.2667 |Global loss: 4.7418| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.1325
Epoch: 2|  Loss:  2.1599 |Global loss: 4.6376| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 3|  NKD Loss: 1.1576
Epoch: 3|  Loss:  2.1666 |Global loss: 4.5957| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 0|  NKD Loss: 2.1396
Epoch: 0|  Loss:  2.9962 |Global loss: 6.1152| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.9629
Epoch: 1|  Loss:  1.6108 |Global loss: 4.7157| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.7997
Epoch: 2|  Loss:  1.369 |Global loss: 4.5733| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.7541
Epoch: 3|  Loss:  1.2882 |Global loss: 4.4535| Local H loss: 0.0303  | Global H loss: 0.0303
------------------------- time cost ------------------------- 11.24650526046753
Chosen Clients:  [3, 4, 8]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.703, 0.544, 0.537, 0.785, 0.884, 0.75, 0.0]
AUC in each clients:  [440.987, 474.108, 310.329, 407.31, 481.944, 463.428, 433.88, 478.322, 10.909]
F1 Score:  [0.47, 0.64, 0.529, 0.453, 0.409, 0.657, 0.801, 0.612, 0.0]
Recall Score:  [0.477, 0.634, 0.59, 0.503, 0.45, 0.684, 0.782, 0.625, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 6.2260
Averaged Test Accurancy: 0.6758
Averaged Test AUC: 0.9327
Averaged Test F1_score: 0.5079
Averaged Test Recal score: 0.5272
Std Test Accurancy: 0.2428
Std Test AUC: 0.0201
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.6443
Epoch: 0|  Loss:  3.194 |Global loss: 5.473| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 1|  NKD Loss: 1.0277
Epoch: 1|  Loss:  2.3072 |Global loss: 4.4382| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 0.8754
Epoch: 2|  Loss:  2.0325 |Global loss: 4.276| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.8176
Epoch: 3|  Loss:  1.9351 |Global loss: 4.1394| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 2.0265
Epoch: 0|  Loss:  3.7325 |Global loss: 5.955| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 1.1763
Epoch: 1|  Loss:  2.6403 |Global loss: 4.9214| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 2|  NKD Loss: 1.0431
Epoch: 2|  Loss:  2.3361 |Global loss: 4.742| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.0106
Epoch: 3|  Loss:  2.2326 |Global loss: 4.6338| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 5.0091
Epoch: 0|  Loss:  6.6489 |Global loss: 11.2964| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 1|  NKD Loss: 4.5875
Epoch: 1|  Loss:  5.9989 |Global loss: 8.3801| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 2|  NKD Loss: 3.6435
Epoch: 2|  Loss:  4.9206 |Global loss: 6.6431| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 3|  NKD Loss: 3.6601
Epoch: 3|  Loss:  4.8204 |Global loss: 4.9372| Local H loss: 0.0438  | Global H loss: 0.0438
------------------------- time cost ------------------------- 8.749675273895264
Chosen Clients:  [4, 3, 2]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.703, 0.64, 0.626, 0.785, 0.884, 0.75, 1.0]
AUC in each clients:  [440.987, 474.108, 310.329, 407.687, 490.222, 463.428, 433.88, 478.322, 12.0]
F1 Score:  [0.47, 0.64, 0.529, 0.526, 0.505, 0.657, 0.801, 0.612, 1.0]
Recall Score:  [0.477, 0.634, 0.59, 0.565, 0.536, 0.684, 0.782, 0.625, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.7502
Averaged Test Accurancy: 0.7030
Averaged Test AUC: 0.9353
Averaged Test F1_score: 0.6378
Averaged Test Recal score: 0.6548
Std Test Accurancy: 0.1326
Std Test AUC: 0.0270
Std Test F1: 0.0258
Std Test Recall: 0.0258
Epoch: 0|  NKD Loss: 1.1405
Epoch: 0|  Loss:  2.3188 |Global loss: 5.8867| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.0421
Epoch: 1|  Loss:  2.1253 |Global loss: 5.0385| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9895
Epoch: 2|  Loss:  2.0227 |Global loss: 4.7445| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9371
Epoch: 3|  Loss:  1.9249 |Global loss: 4.5696| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 1.0267
Epoch: 0|  Loss:  2.1043 |Global loss: 4.9471| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.816
Epoch: 1|  Loss:  1.8525 |Global loss: 4.2468| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.7623
Epoch: 2|  Loss:  1.7557 |Global loss: 4.0708| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.7643
Epoch: 3|  Loss:  1.7678 |Global loss: 4.0391| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.4165
Epoch: 0|  Loss:  2.5233 |Global loss: 5.1298| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2305
Epoch: 1|  Loss:  2.269 |Global loss: 4.3213| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 2|  NKD Loss: 1.1072
Epoch: 2|  Loss:  2.1752 |Global loss: 4.0532| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 0.9633
Epoch: 3|  Loss:  1.9494 |Global loss: 3.716| Local H loss: 0.0242  | Global H loss: 0.0242
------------------------- time cost ------------------------- 10.404023885726929
Chosen Clients:  [2, 3, 4]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.685, 0.653, 0.755, 0.785, 0.884, 0.75, 1.0]
AUC in each clients:  [440.987, 474.108, 312.834, 411.485, 497.638, 463.428, 433.88, 478.322, 12.0]
F1 Score:  [0.47, 0.64, 0.532, 0.539, 0.602, 0.657, 0.801, 0.612, 1.0]
Recall Score:  [0.477, 0.634, 0.575, 0.578, 0.636, 0.684, 0.782, 0.625, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.9167
Averaged Test Accurancy: 0.7211
Averaged Test AUC: 0.9389
Averaged Test F1_score: 0.6503
Averaged Test Recal score: 0.6657
Std Test Accurancy: 0.1264
Std Test AUC: 0.0250
Std Test F1: 0.0258
Std Test Recall: 0.0258
Epoch: 0|  NKD Loss: 1.2827
Epoch: 0|  Loss:  2.2368 |Global loss: 4.8884| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 0.9988
Epoch: 1|  Loss:  1.9831 |Global loss: 3.9041| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.9732
Epoch: 2|  Loss:  1.8756 |Global loss: 3.8213| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 0.8948
Epoch: 3|  Loss:  1.7642 |Global loss: 3.5691| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.0338
Epoch: 0|  Loss:  2.0204 |Global loss: 4.9347| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.8053
Epoch: 1|  Loss:  1.7367 |Global loss: 4.1612| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.7596
Epoch: 2|  Loss:  1.6682 |Global loss: 4.0726| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.7967
Epoch: 3|  Loss:  1.7204 |Global loss: 4.0582| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.1059
Epoch: 0|  Loss:  2.09 |Global loss: 6.0074| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.9572
Epoch: 1|  Loss:  1.852 |Global loss: 5.068| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9101
Epoch: 2|  Loss:  1.7671 |Global loss: 4.6341| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.9023
Epoch: 3|  Loss:  1.7371 |Global loss: 4.5687| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 10.004745244979858
Chosen Clients:  [7, 0, 3]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.534, 0.707, 0.754, 0.66, 0.784, 0.785, 0.884, 0.75, 1.0]
AUC in each clients:  [440.987, 474.108, 316.197, 415.197, 501.415, 463.428, 433.88, 478.322, 12.0]
F1 Score:  [0.47, 0.64, 0.608, 0.558, 0.716, 0.657, 0.801, 0.612, 1.0]
Recall Score:  [0.477, 0.634, 0.651, 0.581, 0.717, 0.684, 0.782, 0.625, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 4.9809
Averaged Test Accurancy: 0.7320
Averaged Test AUC: 0.9418
Averaged Test F1_score: 0.6736
Averaged Test Recal score: 0.6834
Std Test Accurancy: 0.1239
Std Test AUC: 0.0236
Std Test F1: 0.0258
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.1283
Epoch: 0|  Loss:  2.0966 |Global loss: 5.1386| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 1|  NKD Loss: 1.0106
Epoch: 1|  Loss:  1.9651 |Global loss: 4.659| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 2|  NKD Loss: 1.0051
Epoch: 2|  Loss:  1.9361 |Global loss: 4.4237| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 1.0156
Epoch: 3|  Loss:  1.9182 |Global loss: 4.3468| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 0|  NKD Loss: 1.8633
Epoch: 0|  Loss:  3.3815 |Global loss: 5.5923| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 1.1158
Epoch: 1|  Loss:  2.4559 |Global loss: 4.6402| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.0938
Epoch: 2|  Loss:  2.3587 |Global loss: 4.5035| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 1.0867
Epoch: 3|  Loss:  2.301 |Global loss: 4.4876| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.0288
Epoch: 0|  Loss:  1.9113 |Global loss: 5.0195| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.7698
Epoch: 1|  Loss:  1.6108 |Global loss: 4.1781| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8386
Epoch: 2|  Loss:  1.636 |Global loss: 4.1444| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.7545
Epoch: 3|  Loss:  1.5198 |Global loss: 4.0308| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 10.765202522277832
Chosen Clients:  [0, 1, 8]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.538, 0.707, 0.754, 0.745, 0.784, 0.785, 0.884, 0.757, 1.0]
AUC in each clients:  [441.888, 474.108, 316.197, 419.14, 501.415, 463.428, 433.88, 479.313, 12.0]
F1 Score:  [0.473, 0.64, 0.608, 0.615, 0.716, 0.657, 0.801, 0.618, 1.0]
Recall Score:  [0.491, 0.634, 0.651, 0.656, 0.717, 0.684, 0.782, 0.631, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 5.6655
Averaged Test Accurancy: 0.7437
Averaged Test AUC: 0.9434
Averaged Test F1_score: 0.6809
Averaged Test Recal score: 0.6940
Std Test Accurancy: 0.1179
Std Test AUC: 0.0226
Std Test F1: 0.0258
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.301
Epoch: 0|  Loss:  2.486 |Global loss: 5.3121| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 1.0736
Epoch: 1|  Loss:  2.2165 |Global loss: 4.5933| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.0477
Epoch: 2|  Loss:  2.1667 |Global loss: 4.4981| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.0052
Epoch: 3|  Loss:  2.0842 |Global loss: 4.4291| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 1.7962
Epoch: 0|  Loss:  2.9009 |Global loss: 5.9015| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.0518
Epoch: 1|  Loss:  1.959 |Global loss: 4.5962| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9768
Epoch: 2|  Loss:  1.8324 |Global loss: 4.4095| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9568
Epoch: 3|  Loss:  1.7843 |Global loss: 4.3905| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 3.378
Epoch: 0|  Loss:  4.2753 |Global loss: 13.3938| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 2.1947
Epoch: 1|  Loss:  2.973 |Global loss: 8.3872| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 2|  NKD Loss: 1.8754
Epoch: 2|  Loss:  2.5226 |Global loss: 5.6704| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1204
Epoch: 3|  Loss:  1.6649 |Global loss: 3.7856| Local H loss: 0.0382  | Global H loss: 0.0382
------------------------- time cost ------------------------- 8.782772302627563
Chosen Clients:  [7, 6, 0]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.634, 0.746, 0.754, 0.745, 0.784, 0.785, 0.884, 0.757, 1.0]
AUC in each clients:  [447.658, 472.557, 316.197, 419.14, 501.415, 463.428, 433.88, 479.313, 12.0]
F1 Score:  [0.553, 0.666, 0.608, 0.615, 0.716, 0.657, 0.801, 0.618, 1.0]
Recall Score:  [0.573, 0.668, 0.651, 0.656, 0.717, 0.684, 0.782, 0.631, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 3.0385
Averaged Test Accurancy: 0.7613
Averaged Test AUC: 0.9445
Averaged Test F1_score: 0.6927
Averaged Test Recal score: 0.7069
Std Test Accurancy: 0.0965
Std Test AUC: 0.0212
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.0274
Epoch: 0|  Loss:  1.8822 |Global loss: 5.0613| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 0.9385
Epoch: 1|  Loss:  1.7839 |Global loss: 4.5119| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 0.9452
Epoch: 2|  Loss:  1.7823 |Global loss: 4.376| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9249
Epoch: 3|  Loss:  1.7469 |Global loss: 4.2859| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 0.9354
Epoch: 0|  Loss:  1.4689 |Global loss: 5.3854| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.7233
Epoch: 1|  Loss:  1.234 |Global loss: 4.3599| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.732
Epoch: 2|  Loss:  1.2302 |Global loss: 4.2252| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.6986
Epoch: 3|  Loss:  1.1877 |Global loss: 4.0748| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 1.1828
Epoch: 0|  Loss:  2.2308 |Global loss: 5.3358| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.0483
Epoch: 1|  Loss:  2.0579 |Global loss: 4.6998| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 1.0308
Epoch: 2|  Loss:  1.995 |Global loss: 4.6404| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.0293
Epoch: 3|  Loss:  1.9818 |Global loss: 4.6095| Local H loss: 0.0268  | Global H loss: 0.0268
------------------------- time cost ------------------------- 10.673888921737671
Chosen Clients:  [1, 0, 4]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.667, 0.746, 0.754, 0.745, 0.784, 0.785, 0.918, 0.797, 1.0]
AUC in each clients:  [445.754, 472.557, 316.197, 419.14, 501.415, 463.428, 439.262, 480.416, 12.0]
F1 Score:  [0.609, 0.666, 0.608, 0.615, 0.716, 0.657, 0.836, 0.699, 1.0]
Recall Score:  [0.621, 0.668, 0.651, 0.656, 0.717, 0.684, 0.826, 0.699, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 3.3668
Averaged Test Accurancy: 0.7749
Averaged Test AUC: 0.9457
Averaged Test F1_score: 0.7118
Averaged Test Recal score: 0.7247
Std Test Accurancy: 0.0944
Std Test AUC: 0.0228
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.2595
Epoch: 0|  Loss:  2.077 |Global loss: 5.7206| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9618
Epoch: 1|  Loss:  1.7425 |Global loss: 4.5084| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.872
Epoch: 2|  Loss:  1.6336 |Global loss: 4.2661| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.8841
Epoch: 3|  Loss:  1.6131 |Global loss: 4.2382| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 1.1813
Epoch: 0|  Loss:  2.1072 |Global loss: 5.1969| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.9962
Epoch: 1|  Loss:  1.8859 |Global loss: 4.4519| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.9371
Epoch: 2|  Loss:  1.7903 |Global loss: 4.3889| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9519
Epoch: 3|  Loss:  1.7527 |Global loss: 4.3265| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 1.1464
Epoch: 0|  Loss:  1.9624 |Global loss: 6.0201| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.0014
Epoch: 1|  Loss:  1.8338 |Global loss: 4.8167| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9274
Epoch: 2|  Loss:  1.7292 |Global loss: 4.5225| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.8859
Epoch: 3|  Loss:  1.6638 |Global loss: 4.4455| Local H loss: 0.0337  | Global H loss: 0.0337
------------------------- time cost ------------------------- 11.032606363296509
Chosen Clients:  [2, 4, 8]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.758, 0.805, 0.754, 0.745, 0.831, 0.785, 0.918, 0.797, 1.0]
AUC in each clients:  [453.228, 477.203, 316.197, 419.14, 503.441, 463.428, 439.262, 480.416, 12.0]
F1 Score:  [0.704, 0.72, 0.608, 0.615, 0.762, 0.657, 0.836, 0.699, 1.0]
Recall Score:  [0.71, 0.732, 0.651, 0.656, 0.767, 0.684, 0.826, 0.699, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.3972
Averaged Test Accurancy: 0.8013
Averaged Test AUC: 0.9495
Averaged Test F1_score: 0.7334
Averaged Test Recal score: 0.7472
Std Test Accurancy: 0.0803
Std Test AUC: 0.0201
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.0448
Epoch: 0|  Loss:  1.8881 |Global loss: 4.2736| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.895
Epoch: 1|  Loss:  1.715 |Global loss: 3.3715| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.8363
Epoch: 2|  Loss:  1.6365 |Global loss: 3.1273| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.883
Epoch: 3|  Loss:  1.6509 |Global loss: 3.3281| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0908
Epoch: 0|  Loss:  1.8423 |Global loss: 5.7676| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.9474
Epoch: 1|  Loss:  1.6864 |Global loss: 4.596| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.9
Epoch: 2|  Loss:  1.6217 |Global loss: 4.438| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.8431
Epoch: 3|  Loss:  1.5599 |Global loss: 4.3247| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 1.0466
Epoch: 0|  Loss:  1.4667 |Global loss: 9.8829| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 0.7729
Epoch: 1|  Loss:  1.1322 |Global loss: 8.0633| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 2|  NKD Loss: 0.4659
Epoch: 2|  Loss:  0.7849 |Global loss: 6.1999| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 0.7086
Epoch: 3|  Loss:  1.0184 |Global loss: 4.0402| Local H loss: 0.0388  | Global H loss: 0.0388
------------------------- time cost ------------------------- 8.10407304763794
Chosen Clients:  [6, 4, 0]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.758, 0.805, 0.757, 0.745, 0.827, 0.785, 0.918, 0.797, 1.0]
AUC in each clients:  [453.228, 477.203, 318.26, 419.14, 503.625, 463.428, 439.262, 480.416, 12.0]
F1 Score:  [0.704, 0.72, 0.617, 0.615, 0.773, 0.657, 0.836, 0.699, 1.0]
Recall Score:  [0.71, 0.732, 0.655, 0.656, 0.771, 0.684, 0.826, 0.699, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.2635
Averaged Test Accurancy: 0.8010
Averaged Test AUC: 0.9501
Averaged Test F1_score: 0.7357
Averaged Test Recal score: 0.7481
Std Test Accurancy: 0.0799
Std Test AUC: 0.0197
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.8807
Epoch: 0|  Loss:  1.3542 |Global loss: 5.0605| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.7708
Epoch: 1|  Loss:  1.2454 |Global loss: 4.2533| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.7307
Epoch: 2|  Loss:  1.2046 |Global loss: 4.0631| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.7865
Epoch: 3|  Loss:  1.2354 |Global loss: 4.054| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9904
Epoch: 0|  Loss:  1.7102 |Global loss: 5.9105| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.9437
Epoch: 1|  Loss:  1.6291 |Global loss: 4.7823| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.8741
Epoch: 2|  Loss:  1.5299 |Global loss: 4.4544| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.8557
Epoch: 3|  Loss:  1.5046 |Global loss: 4.3443| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 1.0517
Epoch: 0|  Loss:  1.8406 |Global loss: 5.1672| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9325
Epoch: 1|  Loss:  1.6816 |Global loss: 4.3738| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.8594
Epoch: 2|  Loss:  1.5973 |Global loss: 4.3251| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.8712
Epoch: 3|  Loss:  1.5724 |Global loss: 4.369| Local H loss: 0.0321  | Global H loss: 0.0321
------------------------- time cost ------------------------- 10.696412801742554
Chosen Clients:  [3, 1, 4]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.772, 0.805, 0.757, 0.745, 0.86, 0.785, 0.918, 0.797, 1.0]
AUC in each clients:  [454.547, 477.203, 318.26, 419.14, 506.583, 463.428, 438.818, 480.416, 12.0]
F1 Score:  [0.745, 0.72, 0.617, 0.615, 0.813, 0.657, 0.835, 0.699, 1.0]
Recall Score:  [0.731, 0.732, 0.655, 0.656, 0.806, 0.684, 0.825, 0.699, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.9635
Averaged Test Accurancy: 0.8074
Averaged Test AUC: 0.9511
Averaged Test F1_score: 0.7446
Averaged Test Recal score: 0.7542
Std Test Accurancy: 0.0796
Std Test AUC: 0.0194
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.007
Epoch: 0|  Loss:  1.7272 |Global loss: 4.8458| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.7759
Epoch: 1|  Loss:  1.4992 |Global loss: 4.0457| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.748
Epoch: 2|  Loss:  1.4507 |Global loss: 3.8594| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.7631
Epoch: 3|  Loss:  1.4402 |Global loss: 3.833| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 1.09
Epoch: 0|  Loss:  1.8244 |Global loss: 5.6456| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.9186
Epoch: 1|  Loss:  1.6403 |Global loss: 4.5816| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.9119
Epoch: 2|  Loss:  1.623 |Global loss: 4.4566| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.8442
Epoch: 3|  Loss:  1.5384 |Global loss: 4.2947| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0408
Epoch: 0|  Loss:  1.6751 |Global loss: 5.46| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.8884
Epoch: 1|  Loss:  1.5125 |Global loss: 4.4946| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.8332
Epoch: 2|  Loss:  1.4437 |Global loss: 4.3715| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.8301
Epoch: 3|  Loss:  1.4371 |Global loss: 4.3304| Local H loss: 0.0352  | Global H loss: 0.0352
------------------------- time cost ------------------------- 10.985289573669434
Chosen Clients:  [2, 1, 7]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.772, 0.781, 0.757, 0.767, 0.871, 0.785, 0.918, 0.797, 1.0]
AUC in each clients:  [454.547, 480.306, 318.26, 420.835, 509.104, 463.428, 438.818, 480.416, 12.0]
F1 Score:  [0.745, 0.706, 0.617, 0.655, 0.85, 0.657, 0.835, 0.699, 1.0]
Recall Score:  [0.731, 0.708, 0.655, 0.681, 0.839, 0.684, 0.825, 0.699, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.8564
Averaged Test Accurancy: 0.8085
Averaged Test AUC: 0.9530
Averaged Test F1_score: 0.7516
Averaged Test Recal score: 0.7580
Std Test Accurancy: 0.0791
Std Test AUC: 0.0187
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 1.0598
Epoch: 0|  Loss:  1.7991 |Global loss: 4.4044| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.896
Epoch: 1|  Loss:  1.6274 |Global loss: 3.3302| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.8708
Epoch: 2|  Loss:  1.57 |Global loss: 3.2299| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.8363
Epoch: 3|  Loss:  1.5048 |Global loss: 3.1076| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 1.0986
Epoch: 0|  Loss:  1.8061 |Global loss: 5.7415| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.8519
Epoch: 1|  Loss:  1.5093 |Global loss: 4.553| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.7743
Epoch: 2|  Loss:  1.4022 |Global loss: 4.3196| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.7539
Epoch: 3|  Loss:  1.3504 |Global loss: 4.221| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 1.0015
Epoch: 0|  Loss:  1.8223 |Global loss: 4.935| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 0.8973
Epoch: 1|  Loss:  1.69 |Global loss: 4.2911| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 0.9305
Epoch: 2|  Loss:  1.7362 |Global loss: 4.2443| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.8967
Epoch: 3|  Loss:  1.6888 |Global loss: 4.2221| Local H loss: 0.025  | Global H loss: 0.025
------------------------- time cost ------------------------- 10.454598665237427
Chosen Clients:  [1, 4, 6]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.772, 0.815, 0.792, 0.767, 0.871, 0.785, 0.918, 0.815, 1.0]
AUC in each clients:  [454.547, 483.098, 318.294, 420.835, 509.104, 463.428, 438.818, 482.301, 12.0]
F1 Score:  [0.745, 0.745, 0.686, 0.655, 0.85, 0.657, 0.835, 0.716, 1.0]
Recall Score:  [0.731, 0.749, 0.707, 0.681, 0.839, 0.684, 0.825, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.9026
Averaged Test Accurancy: 0.8186
Averaged Test AUC: 0.9543
Averaged Test F1_score: 0.7654
Averaged Test Recal score: 0.7703
Std Test Accurancy: 0.0738
Std Test AUC: 0.0181
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.9481
Epoch: 0|  Loss:  1.5355 |Global loss: 5.3338| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.7678
Epoch: 1|  Loss:  1.3463 |Global loss: 4.3963| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.7545
Epoch: 2|  Loss:  1.3189 |Global loss: 4.2209| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.7355
Epoch: 3|  Loss:  1.2822 |Global loss: 4.2196| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.9062
Epoch: 0|  Loss:  1.4882 |Global loss: 5.1752| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.8712
Epoch: 1|  Loss:  1.4407 |Global loss: 4.3855| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.8272
Epoch: 2|  Loss:  1.3955 |Global loss: 4.2511| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.8179
Epoch: 3|  Loss:  1.3762 |Global loss: 4.2331| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.8093
Epoch: 0|  Loss:  1.2633 |Global loss: 4.632| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.7474
Epoch: 1|  Loss:  1.1867 |Global loss: 4.091| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.754
Epoch: 2|  Loss:  1.1854 |Global loss: 3.979| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.7086
Epoch: 3|  Loss:  1.1341 |Global loss: 3.8033| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 10.89548397064209
Chosen Clients:  [6, 4, 5]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.772, 0.829, 0.792, 0.767, 0.88, 0.785, 0.938, 0.815, 1.0]
AUC in each clients:  [454.547, 483.989, 318.294, 420.835, 508.607, 463.428, 438.785, 482.301, 12.0]
F1 Score:  [0.745, 0.8, 0.686, 0.655, 0.862, 0.657, 0.853, 0.716, 1.0]
Recall Score:  [0.731, 0.795, 0.707, 0.681, 0.848, 0.684, 0.85, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.8232
Averaged Test Accurancy: 0.8242
Averaged Test AUC: 0.9544
Averaged Test F1_score: 0.7749
Averaged Test Recal score: 0.7792
Std Test Accurancy: 0.0765
Std Test AUC: 0.0180
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.8598
Epoch: 0|  Loss:  1.2877 |Global loss: 4.7783| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.7245
Epoch: 1|  Loss:  1.1279 |Global loss: 3.9861| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.677
Epoch: 2|  Loss:  1.0804 |Global loss: 3.9057| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 0.686
Epoch: 3|  Loss:  1.0797 |Global loss: 3.8173| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9259
Epoch: 0|  Loss:  1.4705 |Global loss: 5.5283| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.8472
Epoch: 1|  Loss:  1.4038 |Global loss: 4.4311| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.81
Epoch: 2|  Loss:  1.3567 |Global loss: 4.2933| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.7801
Epoch: 3|  Loss:  1.3115 |Global loss: 4.1786| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9526
Epoch: 0|  Loss:  1.6707 |Global loss: 4.8543| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.8633
Epoch: 1|  Loss:  1.5506 |Global loss: 4.11| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.7836
Epoch: 2|  Loss:  1.4439 |Global loss: 3.9082| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.7529
Epoch: 3|  Loss:  1.3961 |Global loss: 3.8921| Local H loss: 0.0295  | Global H loss: 0.0295
------------------------- time cost ------------------------- 10.568807125091553
Chosen Clients:  [6, 0, 8]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.772, 0.829, 0.792, 0.767, 0.892, 0.807, 0.924, 0.815, 1.0]
AUC in each clients:  [454.547, 483.989, 318.294, 420.835, 509.394, 462.23, 439.494, 482.301, 12.0]
F1 Score:  [0.745, 0.8, 0.686, 0.655, 0.875, 0.726, 0.841, 0.716, 1.0]
Recall Score:  [0.731, 0.795, 0.707, 0.681, 0.863, 0.727, 0.835, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.7261
Averaged Test Accurancy: 0.8271
Averaged Test AUC: 0.9545
Averaged Test F1_score: 0.7827
Averaged Test Recal score: 0.7840
Std Test Accurancy: 0.0740
Std Test AUC: 0.0182
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.781
Epoch: 0|  Loss:  1.1576 |Global loss: 4.7242| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.702
Epoch: 1|  Loss:  1.0859 |Global loss: 3.9454| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6835
Epoch: 2|  Loss:  1.0619 |Global loss: 3.8766| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.671
Epoch: 3|  Loss:  1.0197 |Global loss: 3.7832| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9283
Epoch: 0|  Loss:  1.6126 |Global loss: 5.0775| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.8033
Epoch: 1|  Loss:  1.4577 |Global loss: 4.3342| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.7859
Epoch: 2|  Loss:  1.4238 |Global loss: 4.3101| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8173
Epoch: 3|  Loss:  1.4397 |Global loss: 4.3834| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.5549
Epoch: 0|  Loss:  0.7762 |Global loss: 10.3313| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 0.9144
Epoch: 1|  Loss:  1.1121 |Global loss: 10.0237| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 2|  NKD Loss: 0.3068
Epoch: 2|  Loss:  0.4796 |Global loss: 8.3671| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 3|  NKD Loss: 0.5668
Epoch: 3|  Loss:  0.751 |Global loss: 5.9547| Local H loss: 0.0278  | Global H loss: 0.0278
------------------------- time cost ------------------------- 8.577732801437378
Chosen Clients:  [3, 0, 1]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.865, 0.829, 0.792, 0.767, 0.892, 0.807, 0.936, 0.815, 1.0]
AUC in each clients:  [455.711, 483.989, 318.294, 420.835, 509.394, 462.23, 441.124, 482.301, 12.0]
F1 Score:  [0.868, 0.8, 0.686, 0.655, 0.875, 0.726, 0.851, 0.716, 1.0]
Recall Score:  [0.847, 0.795, 0.707, 0.681, 0.863, 0.727, 0.847, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.1525
Averaged Test Accurancy: 0.8404
Averaged Test AUC: 0.9552
Averaged Test F1_score: 0.7974
Averaged Test Recal score: 0.7982
Std Test Accurancy: 0.0708
Std Test AUC: 0.0184
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.9287
Epoch: 0|  Loss:  1.5842 |Global loss: 4.8338| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.7826
Epoch: 1|  Loss:  1.4189 |Global loss: 3.9592| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.7
Epoch: 2|  Loss:  1.2887 |Global loss: 3.7465| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.7066
Epoch: 3|  Loss:  1.286 |Global loss: 3.7278| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9731
Epoch: 0|  Loss:  1.5796 |Global loss: 5.2129| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.7879
Epoch: 1|  Loss:  1.3755 |Global loss: 4.3448| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.7771
Epoch: 2|  Loss:  1.3455 |Global loss: 4.3001| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.7488
Epoch: 3|  Loss:  1.3085 |Global loss: 4.2279| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.9638
Epoch: 0|  Loss:  1.5001 |Global loss: 5.5417| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.7803
Epoch: 1|  Loss:  1.2826 |Global loss: 4.2647| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.7619
Epoch: 2|  Loss:  1.301 |Global loss: 4.2455| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.716
Epoch: 3|  Loss:  1.213 |Global loss: 4.1437| Local H loss: 0.0338  | Global H loss: 0.0338
------------------------- time cost ------------------------- 10.778730392456055
Chosen Clients:  [0, 8, 6]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.87, 0.872, 0.792, 0.678, 0.892, 0.807, 0.936, 0.815, 1.0]
AUC in each clients:  [459.482, 488.099, 318.294, 415.611, 509.394, 462.23, 441.124, 482.301, 12.0]
F1 Score:  [0.875, 0.862, 0.686, 0.67, 0.875, 0.726, 0.851, 0.716, 1.0]
Recall Score:  [0.85, 0.86, 0.707, 0.657, 0.863, 0.727, 0.847, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.8226
Averaged Test Accurancy: 0.8362
Averaged Test AUC: 0.9559
Averaged Test F1_score: 0.8068
Averaged Test Recal score: 0.8031
Std Test Accurancy: 0.0872
Std Test AUC: 0.0193
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.8497
Epoch: 0|  Loss:  1.3821 |Global loss: 5.2019| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.7595
Epoch: 1|  Loss:  1.2937 |Global loss: 4.2893| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.7552
Epoch: 2|  Loss:  1.282 |Global loss: 4.2413| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.7508
Epoch: 3|  Loss:  1.2518 |Global loss: 4.2832| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.7515
Epoch: 0|  Loss:  0.893 |Global loss: 10.7708| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 0.4384
Epoch: 1|  Loss:  0.5685 |Global loss: 9.9111| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 2|  NKD Loss: 0.4579
Epoch: 2|  Loss:  0.5962 |Global loss: 7.3729| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 0.3869
Epoch: 3|  Loss:  0.5391 |Global loss: 5.4106| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 0.7507
Epoch: 0|  Loss:  1.1164 |Global loss: 4.676| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.6887
Epoch: 1|  Loss:  1.0535 |Global loss: 3.8993| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6726
Epoch: 2|  Loss:  1.0391 |Global loss: 3.8477| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.6373
Epoch: 3|  Loss:  0.9854 |Global loss: 3.7142| Local H loss: 0.0344  | Global H loss: 0.0344
------------------------- time cost ------------------------- 8.40210223197937
Chosen Clients:  [4, 8, 3]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.907, 0.872, 0.792, 0.678, 0.892, 0.807, 0.931, 0.815, 1.0]
AUC in each clients:  [459.993, 488.099, 318.294, 415.611, 509.394, 462.23, 440.611, 482.301, 12.0]
F1 Score:  [0.907, 0.862, 0.686, 0.67, 0.875, 0.726, 0.896, 0.716, 1.0]
Recall Score:  [0.892, 0.86, 0.707, 0.657, 0.863, 0.727, 0.874, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.2801
Averaged Test Accurancy: 0.8404
Averaged Test AUC: 0.9559
Averaged Test F1_score: 0.8153
Averaged Test Recal score: 0.8108
Std Test Accurancy: 0.0884
Std Test AUC: 0.0192
Std Test F1: 0.0257
Std Test Recall: 0.0257
Epoch: 0|  NKD Loss: 0.9427
Epoch: 0|  Loss:  1.4561 |Global loss: 6.1427| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 0.8268
Epoch: 1|  Loss:  1.3414 |Global loss: 4.8754| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.7765
Epoch: 2|  Loss:  1.272 |Global loss: 4.3652| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.7484
Epoch: 3|  Loss:  1.2349 |Global loss: 4.2682| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 1.1785
Epoch: 0|  Loss:  1.2913 |Global loss: 10.9891| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 0.7064
Epoch: 1|  Loss:  0.8173 |Global loss: 8.6844| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 2|  NKD Loss: 0.3104
Epoch: 2|  Loss:  0.4269 |Global loss: 7.0329| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 0.5909
Epoch: 3|  Loss:  0.741 |Global loss: 4.8472| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.8837
Epoch: 0|  Loss:  1.4328 |Global loss: 4.8733| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.7321
Epoch: 1|  Loss:  1.2845 |Global loss: 3.8331| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.7236
Epoch: 2|  Loss:  1.2643 |Global loss: 3.7263| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.6798
Epoch: 3|  Loss:  1.207 |Global loss: 3.6368| Local H loss: 0.0339  | Global H loss: 0.0339
------------------------- time cost ------------------------- 9.348978519439697
Chosen Clients:  [1, 0, 3]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.907, 0.872, 0.792, 0.859, 0.894, 0.807, 0.931, 0.815, 1.0]
AUC in each clients:  [459.993, 488.099, 318.294, 423.848, 511.7, 462.23, 440.611, 482.301, 12.0]
F1 Score:  [0.907, 0.862, 0.686, 0.851, 0.879, 0.726, 0.896, 0.716, 1.0]
Recall Score:  [0.892, 0.86, 0.707, 0.83, 0.86, 0.727, 0.874, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.8277
Averaged Test Accurancy: 0.8623
Averaged Test AUC: 0.9587
Averaged Test F1_score: 0.8359
Averaged Test Recal score: 0.8297
Std Test Accurancy: 0.0628
Std Test AUC: 0.0168
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9847
Epoch: 0|  Loss:  1.4785 |Global loss: 5.6443| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.7847
Epoch: 1|  Loss:  1.297 |Global loss: 4.3536| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.7404
Epoch: 2|  Loss:  1.226 |Global loss: 4.215| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.7433
Epoch: 3|  Loss:  1.2082 |Global loss: 4.1825| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9173
Epoch: 0|  Loss:  1.4386 |Global loss: 5.2158| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 0.7571
Epoch: 1|  Loss:  1.2632 |Global loss: 4.3373| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.7182
Epoch: 2|  Loss:  1.2087 |Global loss: 4.2654| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.7221
Epoch: 3|  Loss:  1.1842 |Global loss: 4.1628| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.8208
Epoch: 0|  Loss:  1.3061 |Global loss: 4.505| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.7156
Epoch: 1|  Loss:  1.1956 |Global loss: 3.8194| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6846
Epoch: 2|  Loss:  1.1781 |Global loss: 3.7375| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.6625
Epoch: 3|  Loss:  1.1297 |Global loss: 3.5923| Local H loss: 0.0339  | Global H loss: 0.0339
------------------------- time cost ------------------------- 10.556134462356567
Chosen Clients:  [3, 2, 4]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.864, 0.792, 0.886, 0.894, 0.807, 0.931, 0.815, 1.0]
AUC in each clients:  [457.925, 488.04, 318.294, 427.906, 511.7, 462.23, 440.611, 482.301, 12.0]
F1 Score:  [0.894, 0.854, 0.686, 0.881, 0.879, 0.726, 0.896, 0.716, 1.0]
Recall Score:  [0.875, 0.851, 0.707, 0.861, 0.86, 0.727, 0.874, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.2629
Averaged Test Accurancy: 0.8615
Averaged Test AUC: 0.9592
Averaged Test F1_score: 0.8369
Averaged Test Recal score: 0.8302
Std Test Accurancy: 0.0619
Std Test AUC: 0.0166
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.8486
Epoch: 0|  Loss:  1.313 |Global loss: 4.6888| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.7125
Epoch: 1|  Loss:  1.1768 |Global loss: 3.8237| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.679
Epoch: 2|  Loss:  1.1393 |Global loss: 3.6858| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.6882
Epoch: 3|  Loss:  1.1225 |Global loss: 3.6399| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 1.0269
Epoch: 0|  Loss:  1.7331 |Global loss: 3.9928| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.8207
Epoch: 1|  Loss:  1.5187 |Global loss: 3.144| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.7124
Epoch: 2|  Loss:  1.3282 |Global loss: 2.805| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.7207
Epoch: 3|  Loss:  1.346 |Global loss: 2.806| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9
Epoch: 0|  Loss:  1.3684 |Global loss: 5.8936| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.804
Epoch: 1|  Loss:  1.3175 |Global loss: 4.3561| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.7139
Epoch: 2|  Loss:  1.1907 |Global loss: 4.145| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.7232
Epoch: 3|  Loss:  1.183 |Global loss: 4.0597| Local H loss: 0.0368  | Global H loss: 0.0368
------------------------- time cost ------------------------- 10.00267767906189
Chosen Clients:  [1, 6, 3]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.864, 0.792, 0.884, 0.871, 0.807, 0.931, 0.815, 1.0]
AUC in each clients:  [457.925, 488.04, 319.264, 427.346, 511.338, 462.23, 440.611, 482.301, 12.0]
F1 Score:  [0.894, 0.854, 0.689, 0.881, 0.865, 0.726, 0.896, 0.716, 1.0]
Recall Score:  [0.875, 0.851, 0.703, 0.861, 0.845, 0.727, 0.874, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.5722
Averaged Test Accurancy: 0.8580
Averaged Test AUC: 0.9593
Averaged Test F1_score: 0.8357
Averaged Test Recal score: 0.8281
Std Test Accurancy: 0.0615
Std Test AUC: 0.0162
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9726
Epoch: 0|  Loss:  1.4264 |Global loss: 5.6345| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.7486
Epoch: 1|  Loss:  1.185 |Global loss: 4.3471| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.735
Epoch: 2|  Loss:  1.1553 |Global loss: 4.207| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.7172
Epoch: 3|  Loss:  1.1346 |Global loss: 4.1605| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.7679
Epoch: 0|  Loss:  1.1254 |Global loss: 4.8149| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6742
Epoch: 1|  Loss:  1.0226 |Global loss: 3.8094| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.6325
Epoch: 2|  Loss:  0.9859 |Global loss: 3.7192| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.6505
Epoch: 3|  Loss:  0.9944 |Global loss: 3.8222| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.8457
Epoch: 0|  Loss:  1.2938 |Global loss: 4.7524| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.7192
Epoch: 1|  Loss:  1.146 |Global loss: 3.8382| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6646
Epoch: 2|  Loss:  1.0759 |Global loss: 3.5991| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.6755
Epoch: 3|  Loss:  1.1173 |Global loss: 3.6843| Local H loss: 0.0318  | Global H loss: 0.0318
------------------------- time cost ------------------------- 10.63954496383667
Chosen Clients:  [4, 8, 3]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.882, 0.792, 0.908, 0.871, 0.807, 0.942, 0.815, 1.0]
AUC in each clients:  [457.925, 489.202, 319.264, 429.611, 511.338, 462.23, 441.576, 482.301, 12.0]
F1 Score:  [0.894, 0.878, 0.689, 0.901, 0.865, 0.726, 0.933, 0.716, 1.0]
Recall Score:  [0.875, 0.873, 0.703, 0.886, 0.845, 0.727, 0.919, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.5249
Averaged Test Accurancy: 0.8647
Averaged Test AUC: 0.9604
Averaged Test F1_score: 0.8447
Averaged Test Recal score: 0.8383
Std Test Accurancy: 0.0636
Std Test AUC: 0.0163
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.8389
Epoch: 0|  Loss:  1.2884 |Global loss: 6.274| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.8051
Epoch: 1|  Loss:  1.2623 |Global loss: 5.1829| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.7624
Epoch: 2|  Loss:  1.2334 |Global loss: 4.3807| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.7193
Epoch: 3|  Loss:  1.1708 |Global loss: 4.1509| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.5855
Epoch: 0|  Loss:  0.6791 |Global loss: 10.4471| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 1|  NKD Loss: 1.1633
Epoch: 1|  Loss:  1.2595 |Global loss: 10.7289| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 2|  NKD Loss: 0.2768
Epoch: 2|  Loss:  0.368 |Global loss: 9.439| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 0.4584
Epoch: 3|  Loss:  0.5704 |Global loss: 6.8841| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.7796
Epoch: 0|  Loss:  1.1634 |Global loss: 4.6894| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.7042
Epoch: 1|  Loss:  1.1084 |Global loss: 3.8263| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6307
Epoch: 2|  Loss:  1.0287 |Global loss: 3.5972| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6557
Epoch: 3|  Loss:  1.0584 |Global loss: 3.5927| Local H loss: 0.0312  | Global H loss: 0.0312
------------------------- time cost ------------------------- 8.524821281433105
Chosen Clients:  [0, 4, 1]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.884, 0.882, 0.792, 0.908, 0.89, 0.807, 0.942, 0.815, 1.0]
AUC in each clients:  [457.925, 489.202, 319.264, 430.353, 511.071, 462.23, 441.576, 482.301, 12.0]
F1 Score:  [0.894, 0.878, 0.689, 0.902, 0.877, 0.726, 0.933, 0.716, 1.0]
Recall Score:  [0.875, 0.873, 0.703, 0.889, 0.869, 0.727, 0.919, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.3513
Averaged Test Accurancy: 0.8673
Averaged Test AUC: 0.9606
Averaged Test F1_score: 0.8461
Averaged Test Recal score: 0.8413
Std Test Accurancy: 0.0636
Std Test AUC: 0.0162
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.85
Epoch: 0|  Loss:  1.323 |Global loss: 5.0399| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.7443
Epoch: 1|  Loss:  1.211 |Global loss: 4.4002| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.7435
Epoch: 2|  Loss:  1.214 |Global loss: 4.2515| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.6866
Epoch: 3|  Loss:  1.1351 |Global loss: 4.0868| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.8913
Epoch: 0|  Loss:  1.3326 |Global loss: 5.8245| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.7559
Epoch: 1|  Loss:  1.2019 |Global loss: 4.2885| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.7355
Epoch: 2|  Loss:  1.1873 |Global loss: 4.2381| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.703
Epoch: 3|  Loss:  1.1237 |Global loss: 4.0057| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.7887
Epoch: 0|  Loss:  1.1951 |Global loss: 5.6075| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6971
Epoch: 1|  Loss:  1.1251 |Global loss: 4.6622| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6967
Epoch: 2|  Loss:  1.1031 |Global loss: 4.5197| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.6989
Epoch: 3|  Loss:  1.0961 |Global loss: 4.4759| Local H loss: 0.029  | Global H loss: 0.029
------------------------- time cost ------------------------- 10.919553279876709
Chosen Clients:  [7, 0, 1]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.911, 0.886, 0.792, 0.908, 0.896, 0.807, 0.942, 0.815, 1.0]
AUC in each clients:  [461.539, 493.123, 319.264, 430.353, 513.614, 462.23, 441.576, 482.301, 12.0]
F1 Score:  [0.913, 0.892, 0.689, 0.902, 0.887, 0.726, 0.933, 0.716, 1.0]
Recall Score:  [0.899, 0.881, 0.703, 0.889, 0.87, 0.727, 0.919, 0.717, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.4910
Averaged Test Accurancy: 0.8721
Averaged Test AUC: 0.9632
Averaged Test F1_score: 0.8509
Averaged Test Recal score: 0.8450
Std Test Accurancy: 0.0645
Std Test AUC: 0.0158
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9736
Epoch: 0|  Loss:  1.7475 |Global loss: 4.8743| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.863
Epoch: 1|  Loss:  1.6187 |Global loss: 4.2002| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8291
Epoch: 2|  Loss:  1.566 |Global loss: 4.0807| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.8379
Epoch: 3|  Loss:  1.5816 |Global loss: 4.0261| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.893
Epoch: 0|  Loss:  1.3399 |Global loss: 5.0088| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.7436
Epoch: 1|  Loss:  1.1915 |Global loss: 4.2316| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.714
Epoch: 2|  Loss:  1.1494 |Global loss: 4.1953| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.68
Epoch: 3|  Loss:  1.1126 |Global loss: 4.0591| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.7796
Epoch: 0|  Loss:  1.1493 |Global loss: 5.308| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.6896
Epoch: 1|  Loss:  1.0708 |Global loss: 4.5156| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.6911
Epoch: 2|  Loss:  1.0884 |Global loss: 4.4337| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.6786
Epoch: 3|  Loss:  1.0553 |Global loss: 4.3318| Local H loss: 0.0294  | Global H loss: 0.0294
------------------------- time cost ------------------------- 10.990986347198486
Chosen Clients:  [8, 7, 0]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.921, 0.884, 0.792, 0.908, 0.896, 0.807, 0.942, 0.819, 1.0]
AUC in each clients:  [463.599, 492.067, 319.264, 430.353, 513.614, 462.23, 441.576, 483.907, 12.0]
F1 Score:  [0.923, 0.886, 0.689, 0.902, 0.887, 0.726, 0.933, 0.725, 1.0]
Recall Score:  [0.911, 0.877, 0.703, 0.889, 0.87, 0.727, 0.919, 0.726, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.8341
Averaged Test Accurancy: 0.8737
Averaged Test AUC: 0.9639
Averaged Test F1_score: 0.8523
Averaged Test Recal score: 0.8469
Std Test Accurancy: 0.0645
Std Test AUC: 0.0151
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 1.8841
Epoch: 0|  Loss:  1.9724 |Global loss: 11.8831| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 3.6591
Epoch: 1|  Loss:  3.7395 |Global loss: 15.654| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 0.7979
Epoch: 2|  Loss:  0.872 |Global loss: 11.2989| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 3|  NKD Loss: 0.6894
Epoch: 3|  Loss:  0.7716 |Global loss: 9.2996| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 0|  NKD Loss: 0.9605
Epoch: 0|  Loss:  1.6609 |Global loss: 4.8111| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.8227
Epoch: 1|  Loss:  1.5306 |Global loss: 4.1462| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8168
Epoch: 2|  Loss:  1.5126 |Global loss: 4.067| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.7755
Epoch: 3|  Loss:  1.4259 |Global loss: 3.9527| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.358 |Global loss: 4.8261| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.7372
Epoch: 1|  Loss:  1.1636 |Global loss: 4.2706| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.7202
Epoch: 2|  Loss:  1.13 |Global loss: 4.2155| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6865
Epoch: 3|  Loss:  1.0823 |Global loss: 4.1573| Local H loss: 0.0341  | Global H loss: 0.0341
------------------------- time cost ------------------------- 8.644608974456787
Chosen Clients:  [8, 5, 6]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.93, 0.884, 0.792, 0.908, 0.896, 0.807, 0.942, 0.817, 1.0]
AUC in each clients:  [463.666, 492.067, 319.264, 430.353, 513.614, 462.23, 441.576, 484.494, 12.0]
F1 Score:  [0.928, 0.886, 0.689, 0.902, 0.887, 0.726, 0.933, 0.72, 1.0]
Recall Score:  [0.918, 0.877, 0.703, 0.889, 0.87, 0.727, 0.919, 0.72, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.0507
Averaged Test Accurancy: 0.8745
Averaged Test AUC: 0.9641
Averaged Test F1_score: 0.8523
Averaged Test Recal score: 0.8470
Std Test Accurancy: 0.0653
Std Test AUC: 0.0150
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9852
Epoch: 0|  Loss:  1.0654 |Global loss: 10.126| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 4.7417
Epoch: 1|  Loss:  4.8262 |Global loss: 16.4616| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 0.7193
Epoch: 2|  Loss:  0.7938 |Global loss: 10.2004| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 3|  NKD Loss: 1.0278
Epoch: 3|  Loss:  1.1161 |Global loss: 8.451| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 0|  NKD Loss: 0.9044
Epoch: 0|  Loss:  1.5414 |Global loss: 4.6458| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8545
Epoch: 1|  Loss:  1.4913 |Global loss: 4.1083| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.7847
Epoch: 2|  Loss:  1.3924 |Global loss: 3.9417| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.7685
Epoch: 3|  Loss:  1.3724 |Global loss: 3.7891| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.947
Epoch: 0|  Loss:  1.2832 |Global loss: 5.0982| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.7096
Epoch: 1|  Loss:  1.0338 |Global loss: 4.0458| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.6896
Epoch: 2|  Loss:  1.0241 |Global loss: 4.0082| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.6924
Epoch: 3|  Loss:  1.0212 |Global loss: 3.8652| Local H loss: 0.0314  | Global H loss: 0.0314
------------------------- time cost ------------------------- 8.268654823303223
Chosen Clients:  [4, 5, 3]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.93, 0.884, 0.792, 0.908, 0.896, 0.824, 0.942, 0.817, 1.0]
AUC in each clients:  [463.666, 492.067, 319.264, 430.353, 513.614, 462.849, 442.733, 484.494, 12.0]
F1 Score:  [0.928, 0.886, 0.689, 0.902, 0.887, 0.768, 0.934, 0.72, 1.0]
Recall Score:  [0.918, 0.877, 0.703, 0.889, 0.87, 0.772, 0.918, 0.72, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.5261
Averaged Test Accurancy: 0.8767
Averaged Test AUC: 0.9646
Averaged Test F1_score: 0.8571
Averaged Test Recal score: 0.8519
Std Test Accurancy: 0.0633
Std Test AUC: 0.0152
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.8554
Epoch: 0|  Loss:  1.2852 |Global loss: 4.9813| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.7826
Epoch: 1|  Loss:  1.2214 |Global loss: 4.2888| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.7387
Epoch: 2|  Loss:  1.1657 |Global loss: 4.0551| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.7133
Epoch: 3|  Loss:  1.1455 |Global loss: 4.0419| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9484
Epoch: 0|  Loss:  1.566 |Global loss: 4.6702| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.8011
Epoch: 1|  Loss:  1.4066 |Global loss: 3.9705| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.7809
Epoch: 2|  Loss:  1.3669 |Global loss: 3.9028| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.7491
Epoch: 3|  Loss:  1.3084 |Global loss: 3.8015| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.7618
Epoch: 0|  Loss:  1.1367 |Global loss: 4.6511| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.667
Epoch: 1|  Loss:  1.044 |Global loss: 3.7616| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.6565
Epoch: 2|  Loss:  1.0401 |Global loss: 3.6249| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.6034
Epoch: 3|  Loss:  0.9678 |Global loss: 3.4908| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 10.978495836257935
Chosen Clients:  [0, 1, 4]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.93, 0.884, 0.792, 0.915, 0.909, 0.812, 0.942, 0.817, 1.0]
AUC in each clients:  [463.666, 492.067, 319.264, 433.207, 514.249, 462.844, 442.733, 484.494, 12.0]
F1 Score:  [0.928, 0.886, 0.689, 0.907, 0.9, 0.764, 0.934, 0.72, 1.0]
Recall Score:  [0.918, 0.877, 0.703, 0.896, 0.886, 0.761, 0.918, 0.72, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.0443
Averaged Test Accurancy: 0.8777
Averaged Test AUC: 0.9655
Averaged Test F1_score: 0.8587
Averaged Test Recal score: 0.8532
Std Test Accurancy: 0.0654
Std Test AUC: 0.0152
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9088
Epoch: 0|  Loss:  1.3153 |Global loss: 5.06| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.7212
Epoch: 1|  Loss:  1.1217 |Global loss: 4.3005| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.6826
Epoch: 2|  Loss:  1.0682 |Global loss: 4.1337| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6965
Epoch: 3|  Loss:  1.0949 |Global loss: 4.1705| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.8612
Epoch: 0|  Loss:  1.2648 |Global loss: 5.773| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.7487
Epoch: 1|  Loss:  1.127 |Global loss: 4.3968| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.6634
Epoch: 2|  Loss:  1.0243 |Global loss: 4.1974| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.6561
Epoch: 3|  Loss:  1.0127 |Global loss: 4.0767| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.9117
Epoch: 0|  Loss:  1.3147 |Global loss: 5.3721| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.8004
Epoch: 1|  Loss:  1.217 |Global loss: 4.3683| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.7477
Epoch: 2|  Loss:  1.1679 |Global loss: 4.1354| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.7253
Epoch: 3|  Loss:  1.1191 |Global loss: 4.1029| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 11.08830213546753
Chosen Clients:  [5, 3, 7]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.882, 0.792, 0.915, 0.898, 0.812, 0.942, 0.817, 1.0]
AUC in each clients:  [464.091, 493.287, 319.264, 433.207, 513.279, 462.844, 442.733, 484.494, 12.0]
F1 Score:  [0.921, 0.886, 0.689, 0.907, 0.886, 0.764, 0.934, 0.72, 1.0]
Recall Score:  [0.909, 0.874, 0.703, 0.896, 0.873, 0.761, 0.918, 0.72, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.1655
Averaged Test Accurancy: 0.8743
Averaged Test AUC: 0.9657
Averaged Test F1_score: 0.8563
Averaged Test Recal score: 0.8504
Std Test Accurancy: 0.0643
Std Test AUC: 0.0151
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.963
Epoch: 0|  Loss:  1.5458 |Global loss: 5.2073| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.7575
Epoch: 1|  Loss:  1.3206 |Global loss: 3.9233| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.7341
Epoch: 2|  Loss:  1.2849 |Global loss: 3.8076| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.7513
Epoch: 3|  Loss:  1.2957 |Global loss: 3.7783| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.7854
Epoch: 0|  Loss:  1.1381 |Global loss: 4.5568| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.6468
Epoch: 1|  Loss:  0.995 |Global loss: 3.6579| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6407
Epoch: 2|  Loss:  0.9869 |Global loss: 3.5762| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.6493
Epoch: 3|  Loss:  1.0011 |Global loss: 3.6122| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.0157
Epoch: 0|  Loss:  1.6897 |Global loss: 4.9793| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.7987
Epoch: 1|  Loss:  1.4619 |Global loss: 4.0047| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.8149
Epoch: 2|  Loss:  1.4704 |Global loss: 3.9639| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.7708
Epoch: 3|  Loss:  1.4144 |Global loss: 3.894| Local H loss: 0.0276  | Global H loss: 0.0276
------------------------- time cost ------------------------- 10.68681287765503
Chosen Clients:  [4, 2, 1]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.882, 0.792, 0.915, 0.898, 0.83, 0.942, 0.822, 1.0]
AUC in each clients:  [464.091, 493.287, 319.264, 432.733, 513.279, 464.211, 442.733, 485.97, 12.0]
F1 Score:  [0.921, 0.886, 0.689, 0.909, 0.886, 0.769, 0.934, 0.723, 1.0]
Recall Score:  [0.909, 0.874, 0.703, 0.895, 0.873, 0.775, 0.918, 0.721, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.5547
Averaged Test Accurancy: 0.8775
Averaged Test AUC: 0.9663
Averaged Test F1_score: 0.8574
Averaged Test Recal score: 0.8520
Std Test Accurancy: 0.0614
Std Test AUC: 0.0146
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.8725
Epoch: 0|  Loss:  1.2637 |Global loss: 5.5107| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.7642
Epoch: 1|  Loss:  1.1562 |Global loss: 4.2936| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.7493
Epoch: 2|  Loss:  1.1503 |Global loss: 4.1489| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.7219
Epoch: 3|  Loss:  1.1265 |Global loss: 4.077| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 1.036
Epoch: 0|  Loss:  1.6703 |Global loss: 4.1682| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.8047
Epoch: 1|  Loss:  1.3913 |Global loss: 3.1468| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.7967
Epoch: 2|  Loss:  1.3833 |Global loss: 3.1124| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.7215
Epoch: 3|  Loss:  1.3116 |Global loss: 2.968| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8862
Epoch: 0|  Loss:  1.2328 |Global loss: 5.3023| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.7129
Epoch: 1|  Loss:  1.0524 |Global loss: 4.3715| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.6567
Epoch: 2|  Loss:  0.9907 |Global loss: 4.0118| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6779
Epoch: 3|  Loss:  1.0047 |Global loss: 3.9892| Local H loss: 0.033  | Global H loss: 0.033
------------------------- time cost ------------------------- 10.444820880889893
Chosen Clients:  [7, 4, 3]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.884, 0.843, 0.915, 0.907, 0.83, 0.942, 0.822, 1.0]
AUC in each clients:  [464.091, 493.152, 321.868, 432.733, 514.387, 464.211, 442.733, 485.97, 12.0]
F1 Score:  [0.921, 0.889, 0.756, 0.909, 0.902, 0.769, 0.934, 0.723, 1.0]
Recall Score:  [0.909, 0.878, 0.769, 0.895, 0.887, 0.775, 0.918, 0.721, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.7617
Averaged Test Accurancy: 0.8836
Averaged Test AUC: 0.9673
Averaged Test F1_score: 0.8670
Averaged Test Recal score: 0.8613
Std Test Accurancy: 0.0544
Std Test AUC: 0.0135
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9075
Epoch: 0|  Loss:  1.5344 |Global loss: 4.7324| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.7959
Epoch: 1|  Loss:  1.4208 |Global loss: 3.9755| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.7921
Epoch: 2|  Loss:  1.4348 |Global loss: 3.9166| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.7872
Epoch: 3|  Loss:  1.4126 |Global loss: 3.8013| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.8753
Epoch: 0|  Loss:  1.274 |Global loss: 5.427| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.7323
Epoch: 1|  Loss:  1.129 |Global loss: 4.0471| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.7127
Epoch: 2|  Loss:  1.096 |Global loss: 4.0213| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6809
Epoch: 3|  Loss:  1.0645 |Global loss: 3.9585| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.7685
Epoch: 0|  Loss:  1.1431 |Global loss: 4.8609| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.625
Epoch: 1|  Loss:  0.9591 |Global loss: 3.5807| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.5971
Epoch: 2|  Loss:  0.9481 |Global loss: 3.5285| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.6084
Epoch: 3|  Loss:  0.9311 |Global loss: 3.4681| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 10.784323930740356
Chosen Clients:  [5, 6, 7]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.884, 0.843, 0.915, 0.917, 0.83, 0.942, 0.83, 1.0]
AUC in each clients:  [464.091, 493.152, 321.868, 433.013, 515.127, 464.211, 442.733, 486.647, 12.0]
F1 Score:  [0.921, 0.889, 0.756, 0.912, 0.91, 0.769, 0.934, 0.741, 1.0]
Recall Score:  [0.909, 0.878, 0.769, 0.898, 0.897, 0.775, 0.918, 0.742, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 3.0568
Averaged Test Accurancy: 0.8860
Averaged Test AUC: 0.9677
Averaged Test F1_score: 0.8702
Averaged Test Recal score: 0.8651
Std Test Accurancy: 0.0535
Std Test AUC: 0.0135
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9636
Epoch: 0|  Loss:  1.5028 |Global loss: 5.0147| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 0.756
Epoch: 1|  Loss:  1.3014 |Global loss: 3.9013| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.7514
Epoch: 2|  Loss:  1.2955 |Global loss: 3.7944| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.7474
Epoch: 3|  Loss:  1.2696 |Global loss: 3.7295| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.8981
Epoch: 0|  Loss:  1.2233 |Global loss: 5.0043| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.7185
Epoch: 1|  Loss:  1.0322 |Global loss: 4.0184| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.6951
Epoch: 2|  Loss:  1.0219 |Global loss: 3.924| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.7054
Epoch: 3|  Loss:  1.043 |Global loss: 3.841| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 1.0831
Epoch: 0|  Loss:  1.7068 |Global loss: 5.1051| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.8131
Epoch: 1|  Loss:  1.4028 |Global loss: 3.9663| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.802
Epoch: 2|  Loss:  1.3884 |Global loss: 3.8268| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.7917
Epoch: 3|  Loss:  1.3806 |Global loss: 3.7923| Local H loss: 0.0289  | Global H loss: 0.0289
------------------------- time cost ------------------------- 10.604847431182861
Chosen Clients:  [8, 7, 3]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.884, 0.843, 0.915, 0.917, 0.843, 0.947, 0.83, 1.0]
AUC in each clients:  [464.091, 493.152, 321.868, 433.013, 515.127, 465.514, 443.167, 487.576, 12.0]
F1 Score:  [0.921, 0.889, 0.756, 0.912, 0.91, 0.804, 0.939, 0.751, 1.0]
Recall Score:  [0.909, 0.878, 0.769, 0.898, 0.897, 0.795, 0.924, 0.745, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 1.6019
Averaged Test Accurancy: 0.8881
Averaged Test AUC: 0.9684
Averaged Test F1_score: 0.8758
Averaged Test Recal score: 0.8683
Std Test Accurancy: 0.0523
Std Test AUC: 0.0132
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.723
Epoch: 0|  Loss:  0.7918 |Global loss: 11.4771| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 5.4649
Epoch: 1|  Loss:  5.5431 |Global loss: 19.679| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 0.8837
Epoch: 2|  Loss:  0.9523 |Global loss: 11.2697| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 3|  NKD Loss: 0.7211
Epoch: 3|  Loss:  0.7999 |Global loss: 9.3294| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.4739 |Global loss: 4.7549| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.7902
Epoch: 1|  Loss:  1.3361 |Global loss: 3.8345| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.7532
Epoch: 2|  Loss:  1.3242 |Global loss: 3.8085| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.7701
Epoch: 3|  Loss:  1.3201 |Global loss: 3.7448| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.8836
Epoch: 0|  Loss:  1.2447 |Global loss: 4.4792| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6434
Epoch: 1|  Loss:  0.9689 |Global loss: 3.6247| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.6226
Epoch: 2|  Loss:  0.9606 |Global loss: 3.504| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.6461
Epoch: 3|  Loss:  0.9796 |Global loss: 3.5772| Local H loss: 0.0297  | Global H loss: 0.0297
------------------------- time cost ------------------------- 8.549072265625
Chosen Clients:  [2, 3, 8]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.917, 0.884, 0.843, 0.906, 0.917, 0.843, 0.947, 0.83, 1.0]
AUC in each clients:  [464.091, 493.152, 321.868, 433.369, 515.127, 465.514, 443.167, 487.04, 12.0]
F1 Score:  [0.921, 0.889, 0.756, 0.899, 0.91, 0.804, 0.939, 0.744, 1.0]
Recall Score:  [0.909, 0.878, 0.769, 0.886, 0.897, 0.795, 0.924, 0.74, 1.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Averaged Train Loss: 2.4170
Averaged Test Accurancy: 0.8871
Averaged Test AUC: 0.9684
Averaged Test F1_score: 0.8736
Averaged Test Recal score: 0.8664
Std Test Accurancy: 0.0521
Std Test AUC: 0.0133
Std Test F1: 0.0256
Std Test Recall: 0.0256
Epoch: 0|  NKD Loss: 0.9281
Epoch: 0|  Loss:  1.4965 |Global loss: 4.1338| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.7223
Epoch: 1|  Loss:  1.2724 |Global loss: 3.0543| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.6657
Epoch: 2|  Loss:  1.2246 |Global loss: 2.7875| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.6506
Epoch: 3|  Loss:  1.1859 |Global loss: 2.7134| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: nan
Epoch: 0|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 1|  NKD Loss: nan
Epoch: 1|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 2|  NKD Loss: nan
Epoch: 2|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 3|  NKD Loss: nan
Epoch: 3|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkd.py", line 58, in train
    client.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkd.py", line 133, in train
    self.decomposition()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkd.py", line 228, in decomposition
    u, sigma, v = np.linalg.svd(param_cpu, full_matrices=False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 1681, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 121, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
