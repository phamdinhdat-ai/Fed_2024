
Join ratio / total clients: 0.4 / 9
Finished creating server and clients.
Chosen Clients:  [5, 4, 1]

-------------Round number: 0-------------

Evaluate personalized models
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([24, 32, 1, 49])
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [61.674, 62.267, 61.577, 60.87, 61.827, 61.234, 61.995, 61.47, 61.178]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120]
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
torch.Size([32, 32, 1, 49])
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkdx.py", line 41, in train
    self.evaluate()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 306, in evaluate
    stats_train = self.train_metrics()
                  ^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 295, in train_metrics
    cl, ns = c.train_metrics()
             ^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 227, in train_metrics
    logit_t = output_g[mask].reshape(N, -1) # set global as teacher
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
