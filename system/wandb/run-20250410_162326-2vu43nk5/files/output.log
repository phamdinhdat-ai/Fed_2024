False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False
False False False

Join ratio / total clients: 0.4 / 30
Finished creating server and clients.
Chosen Clients:  [13, 22, 5, 11, 1, 19, 15, 3, 24, 17, 8, 21]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
AUC in each clients:  [24.413, 23.836, 24.577, 26.681, 22.018, 28.126, 24.397, 25.945, 20.961, 24.84, 27.6, 27.745, 28.519, 27.634, 28.667, 34.273, 26.983, 33.711, 28.474, 30.093, 36.284, 26.459, 31.847, 31.578, 34.333, 34.657, 31.989, 31.502, 30.41, 34.285]
F1 Score:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Recall Score:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4824
Averaged Test Accurancy: 0.0000
Averaged Test AUC: 0.3339
Averaged Test F1_score: 0.0000
Averaged Test Recal score: 0.0000
Std Test Accurancy: 0.0000
Std Test AUC: 0.0248
Std Test F1: 0.0000
Std Test Recall: 0.0000
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4262 |Global loss: 2.4262| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2156 |Global loss: 2.2156| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9972 |Global loss: 1.9972| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7762 |Global loss: 1.7762| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4246 |Global loss: 2.4246| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.188 |Global loss: 2.188| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8991 |Global loss: 1.8991| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5892 |Global loss: 1.5891| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4328 |Global loss: 2.4328| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2206 |Global loss: 2.2206| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.0003 |Global loss: 2.0003| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7427 |Global loss: 1.7427| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4349 |Global loss: 2.4349| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2462 |Global loss: 2.2462| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.0422 |Global loss: 2.0422| Local H loss: 0.0  | Global H loss: -0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7769 |Global loss: 1.7769| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4259 |Global loss: 2.4259| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2217 |Global loss: 2.2217| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9967 |Global loss: 1.9967| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7265 |Global loss: 1.7265| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4262 |Global loss: 2.4262| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1878 |Global loss: 2.1878| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8863 |Global loss: 1.8863| Local H loss: 0.0  | Global H loss: -0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5191 |Global loss: 1.5191| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4109 |Global loss: 2.4109| Local H loss: 0.0  | Global H loss: -0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1823 |Global loss: 2.1823| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9017 |Global loss: 1.9017| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5695 |Global loss: 1.5695| Local H loss: 0.0  | Global H loss: -0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4402 |Global loss: 2.4402| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2347 |Global loss: 2.2347| Local H loss: 0.0  | Global H loss: -0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.0036 |Global loss: 2.0036| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7331 |Global loss: 1.7331| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4276 |Global loss: 2.4276| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1818 |Global loss: 2.1818| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8846 |Global loss: 1.8847| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5979 |Global loss: 1.5979| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4081 |Global loss: 2.4081| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1549 |Global loss: 2.1549| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8616 |Global loss: 1.8616| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5357 |Global loss: 1.5357| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4584 |Global loss: 2.4584| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2945 |Global loss: 2.2945| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.1249 |Global loss: 2.1249| Local H loss: -0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.9392 |Global loss: 1.9392| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.429 |Global loss: 2.429| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2086 |Global loss: 2.2086| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9508 |Global loss: 1.9508| Local H loss: 0.0  | Global H loss: 0.0 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6274 |Global loss: 1.6274| Local H loss: 0.0  | Global H loss: -0.0 [0m
------------------------- time cost ------------------------- 7.735105991363525
Chosen Clients:  [10, 14, 0, 22, 9, 20, 7, 17, 27, 25, 16, 15]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.0, 0.487, 0.0, 0.575, 0.0, 0.415, 0.0, 0.0, 0.181, 0.0, 0.0, 0.65, 0.0, 0.506, 0.0, 0.446, 0.0, 0.648, 0.0, 0.427, 0.0, 0.753, 0.71, 0.0, 0.68, 0.0, 0.0, 0.0, 0.0, 0.0]
AUC in each clients:  [24.413, 72.079, 24.577, 75.102, 22.018, 72.276, 24.397, 25.945, 61.663, 24.84, 27.6, 76.103, 28.519, 75.832, 28.667, 85.736, 26.983, 87.416, 28.474, 84.586, 36.284, 77.141, 89.303, 31.578, 98.341, 34.657, 31.989, 31.502, 30.41, 34.285]
F1 Score:  [0.0, 0.421, 0.0, 0.516, 0.0, 0.363, 0.0, 0.0, 0.146, 0.0, 0.0, 0.554, 0.0, 0.385, 0.0, 0.375, 0.0, 0.547, 0.0, 0.423, 0.0, 0.648, 0.636, 0.0, 0.562, 0.0, 0.0, 0.0, 0.0, 0.0]
Recall Score:  [0.0, 0.526, 0.0, 0.625, 0.0, 0.515, 0.0, 0.0, 0.253, 0.0, 0.0, 0.648, 0.0, 0.519, 0.0, 0.425, 0.0, 0.606, 0.0, 0.479, 0.0, 0.75, 0.671, 0.0, 0.632, 0.0, 0.0, 0.0, 0.0, 0.0]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5222
Averaged Test Accurancy: 0.2159
Averaged Test AUC: 0.5699
Averaged Test F1_score: 0.1859
Averaged Test Recal score: 0.2216
Std Test Accurancy: 0.2821
Std Test AUC: 0.2977
Std Test F1: 0.0028
Std Test Recall: 0.0033
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4164 |Global loss: 2.4352| Local H loss: 0.0005  | Global H loss: 0.0002 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.211 |Global loss: 1.7143| Local H loss: 0.0103  | Global H loss: 0.0049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9615 |Global loss: 1.4468| Local H loss: 0.0161  | Global H loss: 0.0077 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6644 |Global loss: 1.1949| Local H loss: 0.018  | Global H loss: 0.0091 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4344 |Global loss: 2.4228| Local H loss: 0.0006  | Global H loss: 0.0003 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2387 |Global loss: 1.7272| Local H loss: 0.0104  | Global H loss: 0.005 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9899 |Global loss: 1.3901| Local H loss: 0.0187  | Global H loss: 0.0085 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6751 |Global loss: 1.2202| Local H loss: 0.018  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4233 |Global loss: 2.3759| Local H loss: 0.0013  | Global H loss: 0.0007 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1781 |Global loss: 1.6956| Local H loss: 0.0104  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8984 |Global loss: 1.3811| Local H loss: 0.0154  | Global H loss: 0.007 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6544 |Global loss: 1.2389| Local H loss: 0.016  | Global H loss: 0.0076 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3234 |Global loss: 2.394| Local H loss: 0.0144  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1107 |Global loss: 1.6706| Local H loss: 0.0104  | Global H loss: 0.0056 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.9631 |Global loss: 1.3416| Local H loss: 0.012  | Global H loss: 0.0057 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8581 |Global loss: 1.1354| Local H loss: 0.0114  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4455 |Global loss: 2.4792| Local H loss: 0.0002  | Global H loss: 0.0001 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2921 |Global loss: 1.9329| Local H loss: 0.0076  | Global H loss: 0.0039 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.1345 |Global loss: 1.6451| Local H loss: 0.0112  | Global H loss: 0.0056 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.9466 |Global loss: 1.4298| Local H loss: 0.0153  | Global H loss: 0.007 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.382 |Global loss: 2.3159| Local H loss: 0.0019  | Global H loss: 0.001 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.05 |Global loss: 1.5491| Local H loss: 0.0124  | Global H loss: 0.006 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.5937 |Global loss: 1.2049| Local H loss: 0.0153  | Global H loss: 0.0081 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.1824 |Global loss: 1.0036| Local H loss: 0.0117  | Global H loss: 0.0063 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4509 |Global loss: 2.479| Local H loss: 0.0002  | Global H loss: 0.0001 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2818 |Global loss: 1.8763| Local H loss: 0.0073  | Global H loss: 0.0035 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.1005 |Global loss: 1.4788| Local H loss: 0.0164  | Global H loss: 0.0071 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.8732 |Global loss: 1.2976| Local H loss: 0.0216  | Global H loss: 0.0096 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.2946 |Global loss: 2.4013| Local H loss: 0.0174  | Global H loss: 0.0108 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1227 |Global loss: 1.6207| Local H loss: 0.0079  | Global H loss: 0.0044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0122 |Global loss: 1.3266| Local H loss: 0.0062  | Global H loss: 0.0031 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.921 |Global loss: 1.274| Local H loss: 0.0083  | Global H loss: 0.0044 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.441 |Global loss: 2.382| Local H loss: 0.0014  | Global H loss: 0.0007 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.235 |Global loss: 1.7555| Local H loss: 0.0105  | Global H loss: 0.0052 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9829 |Global loss: 1.4007| Local H loss: 0.0177  | Global H loss: 0.0082 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6699 |Global loss: 1.2569| Local H loss: 0.0173  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.3945 |Global loss: 2.3245| Local H loss: 0.0018  | Global H loss: 0.0009 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1144 |Global loss: 1.6042| Local H loss: 0.0126  | Global H loss: 0.0061 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.7192 |Global loss: 1.2844| Local H loss: 0.0163  | Global H loss: 0.0086 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.3417 |Global loss: 1.1198| Local H loss: 0.0111  | Global H loss: 0.0059 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4218 |Global loss: 2.3642| Local H loss: 0.0012  | Global H loss: 0.0006 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1828 |Global loss: 1.6728| Local H loss: 0.0119  | Global H loss: 0.0056 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8638 |Global loss: 1.3797| Local H loss: 0.0165  | Global H loss: 0.0084 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.4798 |Global loss: 1.2363| Local H loss: 0.012  | Global H loss: 0.0066 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.322 |Global loss: 2.3891| Local H loss: 0.0151  | Global H loss: 0.0093 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1065 |Global loss: 1.6775| Local H loss: 0.0081  | Global H loss: 0.0048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.9589 |Global loss: 1.3429| Local H loss: 0.009  | Global H loss: 0.0046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8761 |Global loss: 1.1856| Local H loss: 0.0119  | Global H loss: 0.0057 [0m
------------------------- time cost ------------------------- 6.634272813796997
Chosen Clients:  [10, 1, 20, 25, 29, 12, 11, 22, 9, 16, 4, 6]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.487, 0.0, 0.575, 0.0, 0.415, 0.0, 0.437, 0.181, 0.419, 0.481, 0.65, 0.0, 0.506, 0.476, 0.663, 0.576, 0.703, 0.0, 0.427, 0.745, 0.753, 0.677, 0.0, 0.68, 0.602, 0.0, 0.49, 0.0, 0.0]
AUC in each clients:  [81.364, 72.079, 24.577, 75.102, 22.018, 72.276, 24.397, 66.183, 61.663, 64.328, 73.061, 76.103, 28.519, 75.832, 76.398, 89.526, 86.958, 88.721, 28.474, 84.586, 98.424, 77.141, 90.795, 31.578, 98.341, 94.418, 31.989, 88.398, 30.41, 34.285]
F1 Score:  [0.605, 0.421, 0.0, 0.516, 0.0, 0.363, 0.0, 0.373, 0.146, 0.318, 0.379, 0.554, 0.0, 0.385, 0.366, 0.574, 0.518, 0.627, 0.0, 0.423, 0.59, 0.648, 0.547, 0.0, 0.562, 0.615, 0.0, 0.376, 0.0, 0.0]
Recall Score:  [0.638, 0.526, 0.0, 0.625, 0.0, 0.515, 0.0, 0.522, 0.253, 0.401, 0.514, 0.648, 0.0, 0.519, 0.436, 0.637, 0.549, 0.664, 0.0, 0.479, 0.664, 0.75, 0.616, 0.0, 0.632, 0.619, 0.0, 0.464, 0.0, 0.0]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.3521
Averaged Test Accurancy: 0.3924
Averaged Test AUC: 0.7538
Averaged Test F1_score: 0.3302
Averaged Test Recal score: 0.3890
Std Test Accurancy: 0.2789
Std Test AUC: 0.2816
Std Test F1: 0.0027
Std Test Recall: 0.0031
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3933 |Global loss: 2.4269| Local H loss: 0.0144  | Global H loss: 0.0086 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1814 |Global loss: 1.4166| Local H loss: 0.0052  | Global H loss: 0.0028 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0298 |Global loss: 1.1834| Local H loss: 0.0054  | Global H loss: 0.003 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8953 |Global loss: 1.0819| Local H loss: 0.0075  | Global H loss: 0.0041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.4895 |Global loss: 2.4044| Local H loss: 0.011  | Global H loss: 0.0063 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.2549 |Global loss: 1.4506| Local H loss: 0.0057  | Global H loss: 0.0029 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0895 |Global loss: 1.2551| Local H loss: 0.0082  | Global H loss: 0.0044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9756 |Global loss: 1.1385| Local H loss: 0.0095  | Global H loss: 0.005 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9829 |Global loss: 2.2411| Local H loss: 0.0277  | Global H loss: 0.0177 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8226 |Global loss: 1.221| Local H loss: 0.0109  | Global H loss: 0.0058 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7094 |Global loss: 1.0041| Local H loss: 0.0131  | Global H loss: 0.0065 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.631 |Global loss: 0.8864| Local H loss: 0.0159  | Global H loss: 0.0079 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1327 |Global loss: 2.2832| Local H loss: 0.0234  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.9526 |Global loss: 1.3055| Local H loss: 0.0075  | Global H loss: 0.004 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8402 |Global loss: 1.0601| Local H loss: 0.0094  | Global H loss: 0.0047 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7604 |Global loss: 0.9896| Local H loss: 0.012  | Global H loss: 0.0061 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4187 |Global loss: 2.3243| Local H loss: 0.0029  | Global H loss: 0.0016 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1944 |Global loss: 1.537| Local H loss: 0.0245  | Global H loss: 0.0121 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.896 |Global loss: 1.3205| Local H loss: 0.0278  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.5861 |Global loss: 1.1655| Local H loss: 0.0215  | Global H loss: 0.0117 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4453 |Global loss: 2.407| Local H loss: 0.0009  | Global H loss: 0.0005 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.273 |Global loss: 1.5259| Local H loss: 0.0254  | Global H loss: 0.0125 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.0429 |Global loss: 1.2867| Local H loss: 0.0306  | Global H loss: 0.0148 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7596 |Global loss: 1.1509| Local H loss: 0.0283  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5322 |Global loss: 2.4155| Local H loss: 0.0096  | Global H loss: 0.0055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3041 |Global loss: 1.5208| Local H loss: 0.0051  | Global H loss: 0.0027 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1495 |Global loss: 1.2401| Local H loss: 0.0072  | Global H loss: 0.0039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0287 |Global loss: 1.1534| Local H loss: 0.0095  | Global H loss: 0.005 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8676 |Global loss: 2.3782| Local H loss: 0.0498  | Global H loss: 0.0276 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7687 |Global loss: 1.3807| Local H loss: 0.0283  | Global H loss: 0.013 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7279 |Global loss: 1.1532| Local H loss: 0.0251  | Global H loss: 0.0104 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.681 |Global loss: 1.0475| Local H loss: 0.0189  | Global H loss: 0.0082 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.743 |Global loss: 2.4766| Local H loss: 0.0088  | Global H loss: 0.0047 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.5742 |Global loss: 1.7418| Local H loss: 0.0079  | Global H loss: 0.0042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.4266 |Global loss: 1.4331| Local H loss: 0.0106  | Global H loss: 0.0059 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.2697 |Global loss: 1.2437| Local H loss: 0.0098  | Global H loss: 0.0058 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.2285 |Global loss: 2.3245| Local H loss: 0.0182  | Global H loss: 0.0112 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0407 |Global loss: 1.4527| Local H loss: 0.0092  | Global H loss: 0.0049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.9116 |Global loss: 1.2153| Local H loss: 0.0132  | Global H loss: 0.0065 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8252 |Global loss: 1.1198| Local H loss: 0.0157  | Global H loss: 0.0076 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4433 |Global loss: 2.3934| Local H loss: 0.0012  | Global H loss: 0.0006 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2664 |Global loss: 1.5976| Local H loss: 0.0225  | Global H loss: 0.012 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.033 |Global loss: 1.3205| Local H loss: 0.0289  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.746 |Global loss: 1.2028| Local H loss: 0.0244  | Global H loss: 0.0125 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4462 |Global loss: 2.3996| Local H loss: 0.0013  | Global H loss: 0.0007 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2858 |Global loss: 1.5258| Local H loss: 0.0229  | Global H loss: 0.0113 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  2.0644 |Global loss: 1.3367| Local H loss: 0.03  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.7981 |Global loss: 1.161| Local H loss: 0.0279  | Global H loss: 0.0136 [0m
------------------------- time cost ------------------------- 6.146971940994263
Chosen Clients:  [27, 5, 13, 18, 1, 4, 3, 12, 28, 14, 9, 2]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.816, 0.0, 0.575, 0.487, 0.415, 0.455, 0.437, 0.181, 0.514, 0.924, 0.762, 0.695, 0.506, 0.476, 0.663, 0.783, 0.703, 0.0, 0.427, 0.804, 0.753, 0.882, 0.0, 0.68, 0.888, 0.0, 0.49, 0.0, 0.562]
AUC in each clients:  [81.364, 73.472, 24.577, 75.102, 71.51, 72.276, 71.671, 66.183, 61.663, 70.092, 76.814, 77.422, 78.002, 75.832, 76.398, 89.526, 89.657, 88.721, 28.474, 84.586, 100.095, 77.141, 91.575, 31.578, 98.341, 96.504, 31.989, 88.398, 30.41, 90.448]
F1 Score:  [0.605, 0.833, 0.0, 0.516, 0.396, 0.363, 0.364, 0.373, 0.146, 0.403, 0.925, 0.74, 0.619, 0.385, 0.366, 0.574, 0.73, 0.627, 0.0, 0.423, 0.689, 0.648, 0.869, 0.0, 0.562, 0.824, 0.0, 0.376, 0.0, 0.512]
Recall Score:  [0.638, 0.84, 0.0, 0.625, 0.52, 0.515, 0.45, 0.522, 0.253, 0.496, 0.923, 0.754, 0.658, 0.519, 0.436, 0.637, 0.741, 0.664, 0.0, 0.479, 0.741, 0.75, 0.873, 0.0, 0.632, 0.831, 0.0, 0.464, 0.0, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4326
Averaged Test Accurancy: 0.5205
Averaged Test AUC: 0.8397
Averaged Test F1_score: 0.4623
Averaged Test Recal score: 0.5171
Std Test Accurancy: 0.2844
Std Test AUC: 0.2337
Std Test F1: 0.0032
Std Test Recall: 0.0032
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3999 |Global loss: 2.2524| Local H loss: 0.0131  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1773 |Global loss: 1.284| Local H loss: 0.0112  | Global H loss: 0.0074 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0271 |Global loss: 1.106| Local H loss: 0.012  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9101 |Global loss: 1.0054| Local H loss: 0.0107  | Global H loss: 0.0064 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5207 |Global loss: 2.3495| Local H loss: 0.0112  | Global H loss: 0.0064 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3035 |Global loss: 1.3734| Local H loss: 0.0101  | Global H loss: 0.0059 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1388 |Global loss: 1.1414| Local H loss: 0.0093  | Global H loss: 0.0057 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0022 |Global loss: 1.0662| Local H loss: 0.0097  | Global H loss: 0.0057 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5756 |Global loss: 2.3423| Local H loss: 0.0105  | Global H loss: 0.0058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3545 |Global loss: 1.3764| Local H loss: 0.0143  | Global H loss: 0.0079 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1531 |Global loss: 1.1716| Local H loss: 0.0126  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9865 |Global loss: 1.0622| Local H loss: 0.0111  | Global H loss: 0.0061 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.439 |Global loss: 2.2324| Local H loss: 0.0062  | Global H loss: 0.0032 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2468 |Global loss: 1.2474| Local H loss: 0.0496  | Global H loss: 0.0229 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8908 |Global loss: 1.0404| Local H loss: 0.0481  | Global H loss: 0.0236 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.447 |Global loss: 0.9035| Local H loss: 0.0331  | Global H loss: 0.0179 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9293 |Global loss: 2.4182| Local H loss: 0.0447  | Global H loss: 0.0242 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8054 |Global loss: 1.3534| Local H loss: 0.0181  | Global H loss: 0.0088 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7237 |Global loss: 1.1291| Local H loss: 0.0187  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6792 |Global loss: 0.9862| Local H loss: 0.0174  | Global H loss: 0.008 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.4918 |Global loss: 2.3941| Local H loss: 0.0133  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.2884 |Global loss: 1.357| Local H loss: 0.0078  | Global H loss: 0.0043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1263 |Global loss: 1.1737| Local H loss: 0.009  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0161 |Global loss: 1.0454| Local H loss: 0.0083  | Global H loss: 0.0046 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5071 |Global loss: 2.3827| Local H loss: 0.0113  | Global H loss: 0.0066 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3142 |Global loss: 1.4658| Local H loss: 0.0071  | Global H loss: 0.0042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1436 |Global loss: 1.2789| Local H loss: 0.0077  | Global H loss: 0.0044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0228 |Global loss: 1.0837| Local H loss: 0.0092  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5086 |Global loss: 2.3581| Local H loss: 0.0119  | Global H loss: 0.0065 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.2978 |Global loss: 1.3273| Local H loss: 0.0086  | Global H loss: 0.0049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1357 |Global loss: 1.1417| Local H loss: 0.0098  | Global H loss: 0.0057 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0159 |Global loss: 1.0452| Local H loss: 0.0105  | Global H loss: 0.0056 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4118 |Global loss: 2.3163| Local H loss: 0.0045  | Global H loss: 0.0028 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1922 |Global loss: 1.3973| Local H loss: 0.0369  | Global H loss: 0.0204 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8449 |Global loss: 1.0929| Local H loss: 0.0407  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.4293 |Global loss: 0.9611| Local H loss: 0.0266  | Global H loss: 0.0159 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3739 |Global loss: 2.3943| Local H loss: 0.0134  | Global H loss: 0.0082 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1786 |Global loss: 1.278| Local H loss: 0.009  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.023 |Global loss: 1.0438| Local H loss: 0.0079  | Global H loss: 0.0046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8512 |Global loss: 0.9012| Local H loss: 0.0087  | Global H loss: 0.0051 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1674 |Global loss: 2.4966| Local H loss: 0.0323  | Global H loss: 0.0166 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0374 |Global loss: 1.6554| Local H loss: 0.0172  | Global H loss: 0.0093 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.9485 |Global loss: 1.3772| Local H loss: 0.0156  | Global H loss: 0.0078 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8815 |Global loss: 1.1424| Local H loss: 0.0138  | Global H loss: 0.0068 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4206 |Global loss: 2.3556| Local H loss: 0.002  | Global H loss: 0.0011 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.2486 |Global loss: 1.3588| Local H loss: 0.0388  | Global H loss: 0.02 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.9921 |Global loss: 1.2541| Local H loss: 0.0356  | Global H loss: 0.0187 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.6736 |Global loss: 1.0725| Local H loss: 0.0319  | Global H loss: 0.018 [0m
------------------------- time cost ------------------------- 6.323208570480347
Chosen Clients:  [19, 2, 9, 26, 12, 17, 10, 8, 11, 27, 18, 4]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.855, 0.407, 0.725, 0.645, 0.805, 0.455, 0.437, 0.181, 0.541, 0.924, 0.762, 0.61, 0.716, 0.683, 0.663, 0.783, 0.703, 0.711, 0.427, 0.804, 0.753, 0.882, 0.0, 0.68, 0.888, 0.0, 0.594, 0.709, 0.562]
AUC in each clients:  [81.364, 73.934, 78.518, 76.689, 73.121, 78.707, 71.671, 66.183, 61.663, 70.891, 76.814, 77.422, 78.982, 78.082, 79.517, 89.526, 89.657, 88.721, 86.275, 84.586, 100.095, 77.141, 91.575, 31.578, 98.341, 96.504, 31.989, 92.312, 82.169, 90.448]
F1 Score:  [0.605, 0.864, 0.295, 0.674, 0.585, 0.719, 0.364, 0.373, 0.146, 0.427, 0.925, 0.74, 0.487, 0.626, 0.631, 0.574, 0.73, 0.627, 0.538, 0.423, 0.689, 0.648, 0.869, 0.0, 0.562, 0.824, 0.0, 0.513, 0.619, 0.512]
Recall Score:  [0.638, 0.862, 0.476, 0.74, 0.601, 0.734, 0.45, 0.522, 0.253, 0.523, 0.923, 0.754, 0.577, 0.692, 0.693, 0.637, 0.741, 0.664, 0.627, 0.479, 0.741, 0.75, 0.873, 0.0, 0.632, 0.831, 0.0, 0.592, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5128
Averaged Test Accurancy: 0.6204
Averaged Test AUC: 0.9112
Averaged Test F1_score: 0.5530
Averaged Test Recal score: 0.6073
Std Test Accurancy: 0.2306
Std Test AUC: 0.1569
Std Test F1: 0.0027
Std Test Recall: 0.0025
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.2268 |Global loss: 2.1225| Local H loss: 0.0141  | Global H loss: 0.0092 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0096 |Global loss: 1.1124| Local H loss: 0.012  | Global H loss: 0.0066 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8512 |Global loss: 0.9853| Local H loss: 0.0132  | Global H loss: 0.0069 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7749 |Global loss: 0.8539| Local H loss: 0.0124  | Global H loss: 0.0061 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.4229 |Global loss: 2.2398| Local H loss: 0.0142  | Global H loss: 0.008 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.2211 |Global loss: 1.3828| Local H loss: 0.0087  | Global H loss: 0.0055 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0664 |Global loss: 1.1246| Local H loss: 0.0077  | Global H loss: 0.0049 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9816 |Global loss: 1.0348| Local H loss: 0.0093  | Global H loss: 0.0054 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9205 |Global loss: 2.4819| Local H loss: 0.0546  | Global H loss: 0.0272 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8302 |Global loss: 1.6376| Local H loss: 0.0315  | Global H loss: 0.0161 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7765 |Global loss: 1.2305| Local H loss: 0.0236  | Global H loss: 0.0105 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7188 |Global loss: 1.0384| Local H loss: 0.0211  | Global H loss: 0.0092 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4217 |Global loss: 2.144| Local H loss: 0.0105  | Global H loss: 0.0064 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1995 |Global loss: 1.1955| Local H loss: 0.0525  | Global H loss: 0.0269 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8105 |Global loss: 1.07| Local H loss: 0.0434  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.3738 |Global loss: 0.9624| Local H loss: 0.0254  | Global H loss: 0.0155 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9853 |Global loss: 2.3018| Local H loss: 0.0416  | Global H loss: 0.0218 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8752 |Global loss: 1.2068| Local H loss: 0.013  | Global H loss: 0.0061 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8103 |Global loss: 1.1046| Local H loss: 0.0167  | Global H loss: 0.0078 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7972 |Global loss: 1.0563| Local H loss: 0.0152  | Global H loss: 0.0073 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8881 |Global loss: 2.2052| Local H loss: 0.0437  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7712 |Global loss: 1.2242| Local H loss: 0.0172  | Global H loss: 0.0088 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7086 |Global loss: 1.1174| Local H loss: 0.0186  | Global H loss: 0.0092 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6741 |Global loss: 1.0361| Local H loss: 0.0183  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8678 |Global loss: 2.3367| Local H loss: 0.045  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7425 |Global loss: 1.2466| Local H loss: 0.0159  | Global H loss: 0.0082 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6748 |Global loss: 1.0137| Local H loss: 0.0132  | Global H loss: 0.0066 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6257 |Global loss: 0.9553| Local H loss: 0.013  | Global H loss: 0.007 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.7735 |Global loss: 2.3923| Local H loss: 0.0067  | Global H loss: 0.0036 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.5957 |Global loss: 1.5211| Local H loss: 0.011  | Global H loss: 0.0067 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.406 |Global loss: 1.2228| Local H loss: 0.0146  | Global H loss: 0.0091 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.2359 |Global loss: 1.1611| Local H loss: 0.0123  | Global H loss: 0.0077 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9806 |Global loss: 2.3215| Local H loss: 0.0393  | Global H loss: 0.0216 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8953 |Global loss: 1.3197| Local H loss: 0.0155  | Global H loss: 0.0079 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.864 |Global loss: 1.2627| Local H loss: 0.0154  | Global H loss: 0.0079 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7934 |Global loss: 1.0541| Local H loss: 0.0148  | Global H loss: 0.0069 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8719 |Global loss: 2.232| Local H loss: 0.0459  | Global H loss: 0.0247 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8016 |Global loss: 1.391| Local H loss: 0.0255  | Global H loss: 0.0132 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.742 |Global loss: 1.1464| Local H loss: 0.0231  | Global H loss: 0.011 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7297 |Global loss: 1.0537| Local H loss: 0.021  | Global H loss: 0.0097 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.123 |Global loss: 2.191| Local H loss: 0.0191  | Global H loss: 0.0121 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.9041 |Global loss: 1.0212| Local H loss: 0.0102  | Global H loss: 0.0054 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7546 |Global loss: 0.7886| Local H loss: 0.0108  | Global H loss: 0.0058 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6592 |Global loss: 0.7833| Local H loss: 0.0137  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9588 |Global loss: 2.3467| Local H loss: 0.0443  | Global H loss: 0.0227 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8619 |Global loss: 1.3623| Local H loss: 0.0195  | Global H loss: 0.01 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8539 |Global loss: 1.1902| Local H loss: 0.016  | Global H loss: 0.0075 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7792 |Global loss: 0.9964| Local H loss: 0.0156  | Global H loss: 0.0068 [0m
------------------------- time cost ------------------------- 6.337579250335693
Chosen Clients:  [6, 3, 10, 17, 15, 20, 13, 26, 27, 4, 12, 9]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.855, 0.698, 0.725, 0.75, 0.805, 0.455, 0.437, 0.569, 0.703, 0.848, 0.7, 0.732, 0.716, 0.683, 0.663, 0.783, 0.813, 0.767, 0.663, 0.804, 0.753, 0.882, 0.0, 0.68, 0.888, 0.745, 0.698, 0.709, 0.562]
AUC in each clients:  [81.364, 73.934, 83.122, 76.689, 73.48, 78.707, 71.671, 66.183, 67.985, 71.652, 77.226, 77.773, 79.718, 78.082, 79.517, 89.526, 89.657, 89.315, 88.218, 86.067, 100.095, 77.141, 91.575, 31.578, 98.341, 96.504, 91.09, 92.671, 82.169, 90.448]
F1 Score:  [0.605, 0.864, 0.676, 0.674, 0.699, 0.719, 0.364, 0.373, 0.521, 0.632, 0.835, 0.678, 0.653, 0.626, 0.631, 0.574, 0.73, 0.798, 0.607, 0.631, 0.689, 0.648, 0.869, 0.0, 0.562, 0.824, 0.626, 0.656, 0.619, 0.512]
Recall Score:  [0.638, 0.862, 0.714, 0.74, 0.719, 0.734, 0.45, 0.522, 0.605, 0.67, 0.84, 0.708, 0.697, 0.692, 0.693, 0.637, 0.741, 0.793, 0.683, 0.685, 0.741, 0.75, 0.873, 0.0, 0.632, 0.831, 0.654, 0.689, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.7153
Averaged Test Accurancy: 0.6931
Averaged Test AUC: 0.9410
Averaged Test F1_score: 0.6298
Averaged Test Recal score: 0.6736
Std Test Accurancy: 0.1660
Std Test AUC: 0.1150
Std Test F1: 0.0020
Std Test Recall: 0.0019
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.5472 |Global loss: 2.2805| Local H loss: 0.0117  | Global H loss: 0.0063 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3693 |Global loss: 1.2797| Local H loss: 0.0151  | Global H loss: 0.0093 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.2169 |Global loss: 1.1742| Local H loss: 0.0152  | Global H loss: 0.0097 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.0789 |Global loss: 0.978| Local H loss: 0.014  | Global H loss: 0.0081 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9984 |Global loss: 2.3296| Local H loss: 0.0434  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8893 |Global loss: 1.3365| Local H loss: 0.0148  | Global H loss: 0.0078 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8534 |Global loss: 1.2189| Local H loss: 0.0168  | Global H loss: 0.0085 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7867 |Global loss: 1.1297| Local H loss: 0.0161  | Global H loss: 0.0081 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6727 |Global loss: 2.4029| Local H loss: 0.0717  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.558 |Global loss: 1.183| Local H loss: 0.0314  | Global H loss: 0.016 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5211 |Global loss: 1.0406| Local H loss: 0.0259  | Global H loss: 0.0136 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4873 |Global loss: 0.9207| Local H loss: 0.0257  | Global H loss: 0.0128 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7145 |Global loss: 2.1969| Local H loss: 0.0659  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6313 |Global loss: 1.163| Local H loss: 0.0279  | Global H loss: 0.0132 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5861 |Global loss: 1.0649| Local H loss: 0.0259  | Global H loss: 0.0133 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5985 |Global loss: 1.0693| Local H loss: 0.0266  | Global H loss: 0.0131 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8569 |Global loss: 2.2114| Local H loss: 0.0438  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7534 |Global loss: 1.2324| Local H loss: 0.0239  | Global H loss: 0.0113 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6861 |Global loss: 1.0177| Local H loss: 0.0203  | Global H loss: 0.0092 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6657 |Global loss: 0.9966| Local H loss: 0.0239  | Global H loss: 0.0111 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.664 |Global loss: 2.0645| Local H loss: 0.0575  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5716 |Global loss: 1.1948| Local H loss: 0.0317  | Global H loss: 0.0169 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5251 |Global loss: 0.9642| Local H loss: 0.0302  | Global H loss: 0.0147 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5084 |Global loss: 0.9817| Local H loss: 0.0322  | Global H loss: 0.0164 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9342 |Global loss: 2.2845| Local H loss: 0.0402  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8234 |Global loss: 1.2203| Local H loss: 0.0178  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.778 |Global loss: 1.0853| Local H loss: 0.0179  | Global H loss: 0.0084 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7134 |Global loss: 0.9302| Local H loss: 0.0122  | Global H loss: 0.0055 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1237 |Global loss: 2.1788| Local H loss: 0.0206  | Global H loss: 0.0128 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.9306 |Global loss: 1.084| Local H loss: 0.0108  | Global H loss: 0.0062 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7996 |Global loss: 0.9436| Local H loss: 0.012  | Global H loss: 0.0068 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7027 |Global loss: 0.8524| Local H loss: 0.0139  | Global H loss: 0.0072 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7496 |Global loss: 2.3362| Local H loss: 0.0673  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7045 |Global loss: 1.5824| Local H loss: 0.0449  | Global H loss: 0.0231 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6741 |Global loss: 1.2911| Local H loss: 0.0366  | Global H loss: 0.0168 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6289 |Global loss: 1.1259| Local H loss: 0.0318  | Global H loss: 0.0144 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8152 |Global loss: 2.3439| Local H loss: 0.0641  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7432 |Global loss: 1.4027| Local H loss: 0.034  | Global H loss: 0.0149 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7019 |Global loss: 1.1058| Local H loss: 0.0236  | Global H loss: 0.0102 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6571 |Global loss: 0.9781| Local H loss: 0.0215  | Global H loss: 0.0092 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.812 |Global loss: 2.2534| Local H loss: 0.062  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7124 |Global loss: 1.2301| Local H loss: 0.0264  | Global H loss: 0.0131 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7038 |Global loss: 1.1363| Local H loss: 0.026  | Global H loss: 0.0118 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6686 |Global loss: 1.0542| Local H loss: 0.021  | Global H loss: 0.0098 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7718 |Global loss: 2.528| Local H loss: 0.0704  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7179 |Global loss: 1.6568| Local H loss: 0.0394  | Global H loss: 0.0203 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6989 |Global loss: 1.385| Local H loss: 0.0358  | Global H loss: 0.0166 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6447 |Global loss: 1.1118| Local H loss: 0.0304  | Global H loss: 0.0134 [0m
------------------------- time cost ------------------------- 6.043612718582153
Chosen Clients:  [22, 21, 26, 24, 25, 7, 2, 20, 12, 9, 18, 23]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.855, 0.698, 0.613, 0.737, 0.805, 0.506, 0.437, 0.569, 0.784, 0.924, 0.7, 0.768, 0.901, 0.683, 0.87, 0.783, 0.912, 0.767, 0.663, 0.843, 0.753, 0.882, 0.0, 0.68, 0.888, 0.872, 0.74, 0.709, 0.562]
AUC in each clients:  [81.364, 73.934, 83.122, 77.211, 73.755, 78.707, 73.417, 66.183, 67.985, 71.883, 77.8, 77.773, 80.173, 79.028, 79.517, 89.958, 89.657, 89.619, 88.218, 86.067, 100.6, 77.141, 91.575, 31.578, 98.341, 96.504, 92.636, 93.112, 82.169, 90.448]
F1 Score:  [0.605, 0.864, 0.676, 0.579, 0.706, 0.719, 0.419, 0.373, 0.521, 0.718, 0.923, 0.678, 0.74, 0.897, 0.631, 0.868, 0.73, 0.896, 0.607, 0.631, 0.769, 0.648, 0.869, 0.0, 0.562, 0.824, 0.816, 0.708, 0.619, 0.512]
Recall Score:  [0.638, 0.862, 0.714, 0.652, 0.71, 0.734, 0.517, 0.522, 0.605, 0.753, 0.922, 0.708, 0.747, 0.902, 0.693, 0.873, 0.741, 0.895, 0.683, 0.685, 0.788, 0.75, 0.873, 0.0, 0.632, 0.831, 0.828, 0.731, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.8754
Averaged Test Accurancy: 0.7210
Averaged Test AUC: 0.9441
Averaged Test F1_score: 0.6703
Averaged Test Recal score: 0.7068
Std Test Accurancy: 0.1805
Std Test AUC: 0.1156
Std Test F1: 0.0022
Std Test Recall: 0.0021
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7333 |Global loss: 2.1644| Local H loss: 0.0651  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6563 |Global loss: 1.2516| Local H loss: 0.0385  | Global H loss: 0.0165 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6109 |Global loss: 1.0368| Local H loss: 0.0343  | Global H loss: 0.0142 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5806 |Global loss: 1.0346| Local H loss: 0.0351  | Global H loss: 0.0156 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3159 |Global loss: 2.2119| Local H loss: 0.0126  | Global H loss: 0.0088 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0768 |Global loss: 1.0103| Local H loss: 0.0195  | Global H loss: 0.0134 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.86 |Global loss: 0.9235| Local H loss: 0.0196  | Global H loss: 0.0125 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7379 |Global loss: 0.8599| Local H loss: 0.0187  | Global H loss: 0.011 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7153 |Global loss: 2.1915| Local H loss: 0.0588  | Global H loss: 0.0313 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6219 |Global loss: 1.0974| Local H loss: 0.0262  | Global H loss: 0.0131 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5957 |Global loss: 0.9652| Local H loss: 0.023  | Global H loss: 0.0115 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5557 |Global loss: 0.8848| Local H loss: 0.0268  | Global H loss: 0.0125 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3767 |Global loss: 2.2413| Local H loss: 0.0164  | Global H loss: 0.0096 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.187 |Global loss: 1.3714| Local H loss: 0.0107  | Global H loss: 0.007 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0139 |Global loss: 1.1344| Local H loss: 0.0121  | Global H loss: 0.0073 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8793 |Global loss: 1.0919| Local H loss: 0.0152  | Global H loss: 0.0084 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7357 |Global loss: 2.0951| Local H loss: 0.0531  | Global H loss: 0.028 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6437 |Global loss: 1.1017| Local H loss: 0.0249  | Global H loss: 0.0127 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5974 |Global loss: 0.9335| Local H loss: 0.0247  | Global H loss: 0.0118 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5521 |Global loss: 0.8813| Local H loss: 0.0264  | Global H loss: 0.0129 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.587 |Global loss: 2.2717| Local H loss: 0.0102  | Global H loss: 0.0068 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.3467 |Global loss: 1.3673| Local H loss: 0.0227  | Global H loss: 0.0162 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.1374 |Global loss: 0.9531| Local H loss: 0.0219  | Global H loss: 0.0152 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9635 |Global loss: 0.9244| Local H loss: 0.0176  | Global H loss: 0.0117 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9496 |Global loss: 2.3419| Local H loss: 0.0489  | Global H loss: 0.0237 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8243 |Global loss: 1.1639| Local H loss: 0.0155  | Global H loss: 0.0083 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7496 |Global loss: 1.0048| Local H loss: 0.0145  | Global H loss: 0.008 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6952 |Global loss: 0.9434| Local H loss: 0.0158  | Global H loss: 0.0086 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5452 |Global loss: 2.11| Local H loss: 0.0748  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4726 |Global loss: 0.9887| Local H loss: 0.0364  | Global H loss: 0.0187 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4474 |Global loss: 1.0032| Local H loss: 0.0388  | Global H loss: 0.0212 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4202 |Global loss: 0.8752| Local H loss: 0.0349  | Global H loss: 0.018 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7078 |Global loss: 2.3329| Local H loss: 0.0742  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6592 |Global loss: 1.1809| Local H loss: 0.0294  | Global H loss: 0.0134 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6059 |Global loss: 1.0517| Local H loss: 0.0282  | Global H loss: 0.0132 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5762 |Global loss: 1.0718| Local H loss: 0.0285  | Global H loss: 0.0146 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6901 |Global loss: 2.4224| Local H loss: 0.0754  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6378 |Global loss: 1.5236| Local H loss: 0.0453  | Global H loss: 0.0223 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5979 |Global loss: 1.1868| Local H loss: 0.0379  | Global H loss: 0.017 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.567 |Global loss: 1.0327| Local H loss: 0.0286  | Global H loss: 0.0131 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6691 |Global loss: 2.1539| Local H loss: 0.0574  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5875 |Global loss: 1.0625| Local H loss: 0.0294  | Global H loss: 0.0146 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5448 |Global loss: 0.8142| Local H loss: 0.0254  | Global H loss: 0.0114 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5238 |Global loss: 0.827| Local H loss: 0.0286  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  2.4246 |Global loss: 2.1192| Local H loss: 0.0158  | Global H loss: 0.0099 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  2.1894 |Global loss: 1.2649| Local H loss: 0.0562  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.8194 |Global loss: 1.0326| Local H loss: 0.0481  | Global H loss: 0.0285 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  1.4224 |Global loss: 0.8721| Local H loss: 0.0352  | Global H loss: 0.022 [0m
------------------------- time cost ------------------------- 6.281707763671875
Chosen Clients:  [24, 8, 0, 19, 13, 20, 7, 2, 3, 11, 25, 9]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.69, 0.855, 0.674, 0.613, 0.737, 0.805, 0.506, 0.592, 0.569, 0.784, 0.924, 0.7, 0.793, 0.901, 0.683, 0.87, 0.783, 0.912, 0.778, 0.663, 0.873, 0.802, 0.817, 0.427, 0.845, 0.929, 0.819, 0.74, 0.709, 0.562]
AUC in each clients:  [81.364, 73.934, 83.516, 77.211, 73.755, 78.707, 73.417, 67.613, 67.985, 72.22, 77.8, 77.773, 80.465, 79.028, 79.517, 89.958, 89.657, 89.619, 88.636, 86.067, 100.923, 79.772, 91.799, 89.825, 100.611, 96.73, 92.978, 93.112, 82.169, 90.448]
F1 Score:  [0.605, 0.864, 0.655, 0.579, 0.706, 0.719, 0.419, 0.599, 0.521, 0.757, 0.923, 0.678, 0.774, 0.897, 0.631, 0.868, 0.73, 0.896, 0.635, 0.631, 0.825, 0.672, 0.791, 0.329, 0.806, 0.9, 0.739, 0.708, 0.619, 0.512]
Recall Score:  [0.638, 0.862, 0.715, 0.652, 0.71, 0.734, 0.517, 0.64, 0.605, 0.763, 0.922, 0.708, 0.775, 0.902, 0.693, 0.873, 0.741, 0.895, 0.7, 0.685, 0.829, 0.705, 0.803, 0.5, 0.806, 0.907, 0.763, 0.731, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.9781
Averaged Test Accurancy: 0.7481
Averaged Test AUC: 0.9700
Averaged Test F1_score: 0.6996
Averaged Test Recal score: 0.7330
Std Test Accurancy: 0.1266
Std Test AUC: 0.0156
Std Test F1: 0.0017
Std Test Recall: 0.0014
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8448 |Global loss: 2.1373| Local H loss: 0.0473  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7721 |Global loss: 1.3217| Local H loss: 0.0277  | Global H loss: 0.0142 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6773 |Global loss: 1.0653| Local H loss: 0.022  | Global H loss: 0.011 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6243 |Global loss: 0.9167| Local H loss: 0.0168  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1518 |Global loss: 2.3344| Local H loss: 0.032  | Global H loss: 0.0168 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0592 |Global loss: 1.6066| Local H loss: 0.0186  | Global H loss: 0.0106 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.9904 |Global loss: 1.1532| Local H loss: 0.0148  | Global H loss: 0.0086 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9215 |Global loss: 1.0769| Local H loss: 0.0156  | Global H loss: 0.0089 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.4358 |Global loss: 2.1774| Local H loss: 0.0174  | Global H loss: 0.0103 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.2375 |Global loss: 1.1279| Local H loss: 0.0181  | Global H loss: 0.0122 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0751 |Global loss: 0.9395| Local H loss: 0.0207  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9029 |Global loss: 0.951| Local H loss: 0.0181  | Global H loss: 0.0123 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7758 |Global loss: 2.1992| Local H loss: 0.0545  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6964 |Global loss: 1.0932| Local H loss: 0.0273  | Global H loss: 0.0138 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6459 |Global loss: 0.8987| Local H loss: 0.0206  | Global H loss: 0.0097 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6041 |Global loss: 0.825| Local H loss: 0.0177  | Global H loss: 0.0084 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7416 |Global loss: 2.227| Local H loss: 0.0638  | Global H loss: 0.0311 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6624 |Global loss: 1.1963| Local H loss: 0.0284  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6012 |Global loss: 0.9461| Local H loss: 0.0208  | Global H loss: 0.0098 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5638 |Global loss: 0.8702| Local H loss: 0.0169  | Global H loss: 0.0082 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4673 |Global loss: 2.0833| Local H loss: 0.0847  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4101 |Global loss: 1.0784| Local H loss: 0.0439  | Global H loss: 0.0245 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3873 |Global loss: 0.8693| Local H loss: 0.0396  | Global H loss: 0.0203 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.364 |Global loss: 0.7722| Local H loss: 0.0366  | Global H loss: 0.0182 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8896 |Global loss: 2.3424| Local H loss: 0.0417  | Global H loss: 0.0248 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7958 |Global loss: 1.2885| Local H loss: 0.0223  | Global H loss: 0.013 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7481 |Global loss: 1.0077| Local H loss: 0.0233  | Global H loss: 0.0122 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6734 |Global loss: 0.8302| Local H loss: 0.0181  | Global H loss: 0.0088 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7475 |Global loss: 2.3283| Local H loss: 0.0685  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6111 |Global loss: 1.2103| Local H loss: 0.0315  | Global H loss: 0.0172 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5708 |Global loss: 0.9082| Local H loss: 0.0227  | Global H loss: 0.0112 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5541 |Global loss: 0.8755| Local H loss: 0.0228  | Global H loss: 0.0115 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8334 |Global loss: 2.3141| Local H loss: 0.0642  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7395 |Global loss: 1.3604| Local H loss: 0.0284  | Global H loss: 0.0141 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7109 |Global loss: 1.1613| Local H loss: 0.0244  | Global H loss: 0.0115 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6848 |Global loss: 1.1344| Local H loss: 0.0245  | Global H loss: 0.012 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8161 |Global loss: 2.3843| Local H loss: 0.0614  | Global H loss: 0.0311 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7236 |Global loss: 1.3495| Local H loss: 0.0337  | Global H loss: 0.0171 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6742 |Global loss: 1.0743| Local H loss: 0.0271  | Global H loss: 0.0132 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6528 |Global loss: 0.9749| Local H loss: 0.0235  | Global H loss: 0.0119 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6232 |Global loss: 2.1763| Local H loss: 0.0761  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5335 |Global loss: 1.3464| Local H loss: 0.0422  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.503 |Global loss: 1.2536| Local H loss: 0.0451  | Global H loss: 0.0226 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4765 |Global loss: 1.0456| Local H loss: 0.0402  | Global H loss: 0.0196 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6428 |Global loss: 2.4368| Local H loss: 0.0823  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5872 |Global loss: 1.6859| Local H loss: 0.0562  | Global H loss: 0.0284 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5444 |Global loss: 1.1435| Local H loss: 0.0431  | Global H loss: 0.0196 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.562 |Global loss: 1.2748| Local H loss: 0.0372  | Global H loss: 0.0195 [0m
------------------------- time cost ------------------------- 5.899063348770142
Chosen Clients:  [2, 11, 4, 27, 10, 18, 23, 14, 26, 20, 13, 25]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.759, 0.855, 0.872, 0.775, 0.737, 0.805, 0.506, 0.69, 0.556, 0.797, 0.924, 0.812, 0.793, 0.889, 0.683, 0.87, 0.783, 0.912, 0.778, 0.764, 0.882, 0.802, 0.817, 0.427, 0.903, 0.898, 0.819, 0.74, 0.709, 0.562]
AUC in each clients:  [84.154, 73.934, 84.215, 77.766, 73.755, 78.707, 73.417, 68.611, 68.838, 72.334, 77.8, 78.157, 80.465, 79.684, 79.517, 89.958, 89.657, 89.619, 88.636, 86.599, 100.914, 79.772, 91.799, 89.825, 101.281, 97.298, 92.978, 93.112, 82.169, 90.448]
F1 Score:  [0.714, 0.864, 0.853, 0.728, 0.706, 0.719, 0.419, 0.674, 0.45, 0.767, 0.923, 0.763, 0.774, 0.869, 0.631, 0.868, 0.73, 0.896, 0.635, 0.725, 0.827, 0.672, 0.791, 0.329, 0.878, 0.878, 0.739, 0.708, 0.619, 0.512]
Recall Score:  [0.738, 0.862, 0.874, 0.784, 0.71, 0.734, 0.517, 0.724, 0.575, 0.775, 0.922, 0.791, 0.775, 0.868, 0.693, 0.873, 0.741, 0.895, 0.7, 0.748, 0.846, 0.705, 0.803, 0.5, 0.869, 0.87, 0.763, 0.731, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.1209
Averaged Test Accurancy: 0.7728
Averaged Test AUC: 0.9735
Averaged Test F1_score: 0.7220
Averaged Test Recal score: 0.7534
Std Test Accurancy: 0.1209
Std Test AUC: 0.0137
Std Test F1: 0.0018
Std Test Recall: 0.0014
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6161 |Global loss: 2.3626| Local H loss: 0.0799  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5458 |Global loss: 1.1687| Local H loss: 0.0321  | Global H loss: 0.0171 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5071 |Global loss: 1.0093| Local H loss: 0.0354  | Global H loss: 0.0178 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.478 |Global loss: 0.9178| Local H loss: 0.031  | Global H loss: 0.0156 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6595 |Global loss: 2.278| Local H loss: 0.0712  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6045 |Global loss: 1.3731| Local H loss: 0.0399  | Global H loss: 0.0213 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5419 |Global loss: 1.0104| Local H loss: 0.032  | Global H loss: 0.016 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5414 |Global loss: 1.0533| Local H loss: 0.0315  | Global H loss: 0.0179 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7214 |Global loss: 2.3165| Local H loss: 0.0746  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6564 |Global loss: 1.5608| Local H loss: 0.0424  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6091 |Global loss: 1.1489| Local H loss: 0.033  | Global H loss: 0.0158 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5919 |Global loss: 1.039| Local H loss: 0.0289  | Global H loss: 0.0136 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6847 |Global loss: 2.2803| Local H loss: 0.072  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.636 |Global loss: 1.3853| Local H loss: 0.0446  | Global H loss: 0.0205 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5967 |Global loss: 1.0939| Local H loss: 0.0371  | Global H loss: 0.0163 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5582 |Global loss: 0.9854| Local H loss: 0.0307  | Global H loss: 0.0138 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5336 |Global loss: 2.3691| Local H loss: 0.0815  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4632 |Global loss: 1.2382| Local H loss: 0.0429  | Global H loss: 0.0232 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.427 |Global loss: 1.0387| Local H loss: 0.0373  | Global H loss: 0.0195 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4065 |Global loss: 0.9476| Local H loss: 0.035  | Global H loss: 0.0186 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5533 |Global loss: 2.1398| Local H loss: 0.0779  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5143 |Global loss: 1.1107| Local H loss: 0.0465  | Global H loss: 0.023 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4637 |Global loss: 0.7915| Local H loss: 0.0353  | Global H loss: 0.0169 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4196 |Global loss: 0.6739| Local H loss: 0.0292  | Global H loss: 0.014 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1772 |Global loss: 2.0249| Local H loss: 0.0238  | Global H loss: 0.0145 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.0249 |Global loss: 1.1205| Local H loss: 0.0168  | Global H loss: 0.011 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8883 |Global loss: 0.9173| Local H loss: 0.0152  | Global H loss: 0.0101 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7726 |Global loss: 0.8443| Local H loss: 0.0156  | Global H loss: 0.0094 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8638 |Global loss: 2.3058| Local H loss: 0.0465  | Global H loss: 0.0266 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7775 |Global loss: 1.2041| Local H loss: 0.0224  | Global H loss: 0.0121 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6859 |Global loss: 0.9182| Local H loss: 0.0207  | Global H loss: 0.0106 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6595 |Global loss: 0.9195| Local H loss: 0.0211  | Global H loss: 0.0113 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5825 |Global loss: 2.1489| Local H loss: 0.0731  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5102 |Global loss: 1.0909| Local H loss: 0.0411  | Global H loss: 0.0205 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4791 |Global loss: 0.795| Local H loss: 0.0262  | Global H loss: 0.0121 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4642 |Global loss: 0.8304| Local H loss: 0.0303  | Global H loss: 0.0153 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4247 |Global loss: 2.0501| Local H loss: 0.0871  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3406 |Global loss: 0.8615| Local H loss: 0.0475  | Global H loss: 0.0245 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3326 |Global loss: 0.9046| Local H loss: 0.0478  | Global H loss: 0.0267 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3064 |Global loss: 0.7297| Local H loss: 0.0398  | Global H loss: 0.0214 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6377 |Global loss: 2.2513| Local H loss: 0.078  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5368 |Global loss: 1.1091| Local H loss: 0.0339  | Global H loss: 0.0165 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5226 |Global loss: 1.0661| Local H loss: 0.0316  | Global H loss: 0.0164 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5018 |Global loss: 0.8888| Local H loss: 0.021  | Global H loss: 0.0107 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5264 |Global loss: 2.1493| Local H loss: 0.0818  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4256 |Global loss: 1.158| Local H loss: 0.0475  | Global H loss: 0.0256 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3892 |Global loss: 0.8985| Local H loss: 0.038  | Global H loss: 0.0197 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3703 |Global loss: 0.8678| Local H loss: 0.0399  | Global H loss: 0.021 [0m
------------------------- time cost ------------------------- 6.339057445526123
Chosen Clients:  [29, 1, 22, 10, 26, 21, 12, 13, 4, 20, 18, 28]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.759, 0.855, 0.791, 0.775, 0.776, 0.805, 0.506, 0.69, 0.556, 0.797, 0.911, 0.875, 0.793, 0.914, 0.72, 0.87, 0.783, 0.912, 0.811, 0.764, 0.902, 0.802, 0.817, 0.688, 0.903, 0.939, 0.936, 0.75, 0.709, 0.562]
AUC in each clients:  [84.154, 73.934, 84.266, 77.766, 74.156, 78.707, 73.417, 68.611, 68.838, 72.334, 77.969, 78.647, 80.465, 79.936, 80.245, 89.958, 89.657, 89.619, 88.931, 86.599, 101.258, 79.772, 91.799, 93.232, 101.281, 97.45, 93.181, 93.366, 82.169, 90.448]
F1 Score:  [0.714, 0.864, 0.767, 0.728, 0.748, 0.719, 0.419, 0.674, 0.45, 0.767, 0.906, 0.857, 0.774, 0.913, 0.673, 0.868, 0.73, 0.896, 0.724, 0.725, 0.867, 0.672, 0.791, 0.582, 0.878, 0.929, 0.914, 0.716, 0.619, 0.512]
Recall Score:  [0.738, 0.862, 0.809, 0.784, 0.749, 0.734, 0.517, 0.724, 0.575, 0.775, 0.907, 0.866, 0.775, 0.905, 0.718, 0.873, 0.741, 0.895, 0.735, 0.748, 0.869, 0.705, 0.803, 0.667, 0.869, 0.928, 0.907, 0.729, 0.664, 0.551]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.1893
Averaged Test Accurancy: 0.7926
Averaged Test AUC: 0.9761
Averaged Test F1_score: 0.7465
Averaged Test Recal score: 0.7707
Std Test Accurancy: 0.1089
Std Test AUC: 0.0124
Std Test F1: 0.0016
Std Test Recall: 0.0013
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.3569 |Global loss: 2.0677| Local H loss: 0.0205  | Global H loss: 0.0136 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  1.1773 |Global loss: 1.299| Local H loss: 0.0189  | Global H loss: 0.0138 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  1.0219 |Global loss: 0.9953| Local H loss: 0.016  | Global H loss: 0.0113 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.9713 |Global loss: 0.954| Local H loss: 0.0144  | Global H loss: 0.0095 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.712 |Global loss: 2.1957| Local H loss: 0.0617  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6466 |Global loss: 1.3898| Local H loss: 0.0409  | Global H loss: 0.0211 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5952 |Global loss: 1.1174| Local H loss: 0.0316  | Global H loss: 0.0163 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5505 |Global loss: 1.0231| Local H loss: 0.0311  | Global H loss: 0.0157 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6395 |Global loss: 2.2365| Local H loss: 0.0747  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5787 |Global loss: 1.2772| Local H loss: 0.0523  | Global H loss: 0.0237 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5106 |Global loss: 1.0451| Local H loss: 0.0443  | Global H loss: 0.0204 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4962 |Global loss: 1.003| Local H loss: 0.0438  | Global H loss: 0.0204 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4562 |Global loss: 2.3103| Local H loss: 0.09  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3999 |Global loss: 1.2348| Local H loss: 0.0519  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.371 |Global loss: 1.0189| Local H loss: 0.0454  | Global H loss: 0.0248 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3269 |Global loss: 0.8427| Local H loss: 0.0418  | Global H loss: 0.0229 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5307 |Global loss: 2.145| Local H loss: 0.0852  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4334 |Global loss: 0.9994| Local H loss: 0.0456  | Global H loss: 0.0215 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.425 |Global loss: 0.8966| Local H loss: 0.0382  | Global H loss: 0.0198 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3942 |Global loss: 0.8175| Local H loss: 0.0347  | Global H loss: 0.0174 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7211 |Global loss: 2.3079| Local H loss: 0.053  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6444 |Global loss: 1.2439| Local H loss: 0.0327  | Global H loss: 0.0207 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5881 |Global loss: 0.8859| Local H loss: 0.0285  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5675 |Global loss: 0.7674| Local H loss: 0.023  | Global H loss: 0.0117 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6313 |Global loss: 2.2542| Local H loss: 0.0759  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5653 |Global loss: 1.3804| Local H loss: 0.0456  | Global H loss: 0.0245 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5261 |Global loss: 1.0954| Local H loss: 0.039  | Global H loss: 0.0193 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4999 |Global loss: 1.0726| Local H loss: 0.0415  | Global H loss: 0.0206 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5568 |Global loss: 2.1865| Local H loss: 0.0855  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5142 |Global loss: 1.1795| Local H loss: 0.0399  | Global H loss: 0.0203 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4302 |Global loss: 0.9104| Local H loss: 0.0306  | Global H loss: 0.0159 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4158 |Global loss: 0.8246| Local H loss: 0.0265  | Global H loss: 0.0141 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6193 |Global loss: 2.2502| Local H loss: 0.0795  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5765 |Global loss: 1.3955| Local H loss: 0.0457  | Global H loss: 0.0223 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5233 |Global loss: 1.1204| Local H loss: 0.0375  | Global H loss: 0.0189 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4977 |Global loss: 0.9838| Local H loss: 0.0341  | Global H loss: 0.0168 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3858 |Global loss: 2.1115| Local H loss: 0.0923  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3245 |Global loss: 1.1387| Local H loss: 0.0592  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3113 |Global loss: 0.893| Local H loss: 0.0475  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.297 |Global loss: 0.7873| Local H loss: 0.0442  | Global H loss: 0.0249 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4891 |Global loss: 2.0007| Local H loss: 0.0787  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4114 |Global loss: 0.8865| Local H loss: 0.043  | Global H loss: 0.0223 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3881 |Global loss: 0.6705| Local H loss: 0.03  | Global H loss: 0.0144 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.382 |Global loss: 0.7129| Local H loss: 0.0329  | Global H loss: 0.0176 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.1479 |Global loss: 2.1119| Local H loss: 0.0223  | Global H loss: 0.0145 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.9832 |Global loss: 1.1151| Local H loss: 0.0218  | Global H loss: 0.0153 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8286 |Global loss: 0.9233| Local H loss: 0.0198  | Global H loss: 0.0136 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7328 |Global loss: 0.8519| Local H loss: 0.0158  | Global H loss: 0.0104 [0m
------------------------- time cost ------------------------- 6.371791839599609
Chosen Clients:  [8, 9, 10, 26, 22, 27, 1, 6, 7, 23, 0, 4]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.759, 0.868, 0.791, 0.775, 0.829, 0.805, 0.506, 0.69, 0.556, 0.797, 0.911, 0.875, 0.829, 0.901, 0.72, 0.87, 0.783, 0.912, 0.933, 0.764, 0.882, 0.765, 0.828, 0.688, 0.903, 0.939, 0.947, 0.75, 0.884, 0.51]
AUC in each clients:  [84.154, 74.371, 84.266, 77.766, 74.498, 78.707, 73.417, 68.611, 68.838, 72.334, 78.193, 78.647, 80.815, 80.167, 80.245, 89.958, 89.657, 89.619, 89.127, 86.599, 101.41, 79.69, 92.184, 93.232, 101.281, 97.45, 93.426, 93.366, 83.868, 91.047]
F1 Score:  [0.714, 0.875, 0.767, 0.728, 0.802, 0.719, 0.419, 0.674, 0.45, 0.767, 0.911, 0.857, 0.811, 0.89, 0.673, 0.868, 0.73, 0.896, 0.897, 0.725, 0.836, 0.68, 0.774, 0.582, 0.878, 0.929, 0.929, 0.716, 0.761, 0.411]
Recall Score:  [0.738, 0.885, 0.809, 0.784, 0.795, 0.734, 0.517, 0.724, 0.575, 0.775, 0.911, 0.866, 0.812, 0.887, 0.718, 0.873, 0.741, 0.895, 0.897, 0.748, 0.839, 0.764, 0.788, 0.667, 0.869, 0.928, 0.923, 0.729, 0.787, 0.545]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.2778
Averaged Test Accurancy: 0.8022
Averaged Test AUC: 0.9779
Averaged Test F1_score: 0.7556
Averaged Test Recal score: 0.7841
Std Test Accurancy: 0.1161
Std Test AUC: 0.0119
Std Test F1: 0.0017
Std Test Recall: 0.0014
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9337 |Global loss: 2.421| Local H loss: 0.0534  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8661 |Global loss: 1.4446| Local H loss: 0.029  | Global H loss: 0.0151 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8215 |Global loss: 1.057| Local H loss: 0.0219  | Global H loss: 0.0114 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7872 |Global loss: 0.8858| Local H loss: 0.019  | Global H loss: 0.0103 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5939 |Global loss: 2.4183| Local H loss: 0.0862  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.545 |Global loss: 1.8249| Local H loss: 0.0549  | Global H loss: 0.0311 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4934 |Global loss: 1.2203| Local H loss: 0.0469  | Global H loss: 0.0226 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4777 |Global loss: 1.0104| Local H loss: 0.0369  | Global H loss: 0.0179 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4061 |Global loss: 2.2382| Local H loss: 0.093  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3665 |Global loss: 1.2592| Local H loss: 0.0596  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3283 |Global loss: 1.0889| Local H loss: 0.0506  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3099 |Global loss: 0.9869| Local H loss: 0.0496  | Global H loss: 0.0294 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4774 |Global loss: 2.2136| Local H loss: 0.0907  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4112 |Global loss: 1.2145| Local H loss: 0.0626  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.384 |Global loss: 0.956| Local H loss: 0.0502  | Global H loss: 0.0247 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3535 |Global loss: 0.8706| Local H loss: 0.0482  | Global H loss: 0.0239 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5529 |Global loss: 2.1353| Local H loss: 0.0773  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4582 |Global loss: 1.1216| Local H loss: 0.05  | Global H loss: 0.025 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.459 |Global loss: 0.9837| Local H loss: 0.0427  | Global H loss: 0.0205 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4491 |Global loss: 0.978| Local H loss: 0.0414  | Global H loss: 0.021 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6191 |Global loss: 2.2527| Local H loss: 0.079  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5721 |Global loss: 1.4423| Local H loss: 0.0494  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5514 |Global loss: 1.1481| Local H loss: 0.0415  | Global H loss: 0.0205 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5279 |Global loss: 0.9297| Local H loss: 0.0312  | Global H loss: 0.015 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5859 |Global loss: 2.3916| Local H loss: 0.0795  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5059 |Global loss: 1.3041| Local H loss: 0.0458  | Global H loss: 0.0236 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4846 |Global loss: 1.1314| Local H loss: 0.0398  | Global H loss: 0.0209 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4649 |Global loss: 0.9845| Local H loss: 0.0366  | Global H loss: 0.018 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  1.032 |Global loss: 2.2906| Local H loss: 0.0418  | Global H loss: 0.0216 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.9576 |Global loss: 1.1913| Local H loss: 0.0218  | Global H loss: 0.0128 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.8936 |Global loss: 0.9486| Local H loss: 0.0186  | Global H loss: 0.0103 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.8504 |Global loss: 0.945| Local H loss: 0.0178  | Global H loss: 0.0103 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7236 |Global loss: 2.3711| Local H loss: 0.0644  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6516 |Global loss: 1.2808| Local H loss: 0.0426  | Global H loss: 0.0225 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.626 |Global loss: 1.0278| Local H loss: 0.0356  | Global H loss: 0.0181 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.605 |Global loss: 0.9384| Local H loss: 0.0288  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7963 |Global loss: 2.1836| Local H loss: 0.0546  | Global H loss: 0.0291 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7423 |Global loss: 0.9481| Local H loss: 0.0219  | Global H loss: 0.0114 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6599 |Global loss: 0.9045| Local H loss: 0.0202  | Global H loss: 0.0114 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6271 |Global loss: 0.8066| Local H loss: 0.0194  | Global H loss: 0.0103 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8522 |Global loss: 2.0592| Local H loss: 0.0446  | Global H loss: 0.024 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7219 |Global loss: 1.0657| Local H loss: 0.0199  | Global H loss: 0.0115 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6659 |Global loss: 0.8435| Local H loss: 0.0162  | Global H loss: 0.0088 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6139 |Global loss: 0.8919| Local H loss: 0.0205  | Global H loss: 0.0119 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5655 |Global loss: 2.3503| Local H loss: 0.0877  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4831 |Global loss: 1.2575| Local H loss: 0.0455  | Global H loss: 0.0235 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4506 |Global loss: 0.9581| Local H loss: 0.0317  | Global H loss: 0.0161 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4334 |Global loss: 0.8853| Local H loss: 0.0326  | Global H loss: 0.0168 [0m
------------------------- time cost ------------------------- 5.795885324478149
Chosen Clients:  [14, 10, 2, 6, 26, 28, 29, 4, 20, 22, 19, 15]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.868, 0.791, 0.775, 0.855, 0.805, 0.701, 0.732, 0.778, 0.608, 0.949, 0.875, 0.829, 0.901, 0.72, 0.87, 0.783, 0.912, 0.933, 0.764, 0.882, 0.765, 0.86, 0.781, 0.903, 0.939, 0.936, 0.667, 0.884, 0.51]
AUC in each clients:  [85.068, 74.677, 84.266, 77.766, 74.614, 78.707, 74.294, 69.077, 69.116, 71.943, 78.391, 78.647, 80.815, 80.167, 80.245, 89.958, 89.657, 89.619, 89.127, 86.599, 101.41, 79.69, 92.327, 93.968, 101.281, 97.45, 93.529, 93.265, 83.868, 91.047]
F1 Score:  [0.746, 0.875, 0.767, 0.728, 0.839, 0.719, 0.66, 0.741, 0.753, 0.527, 0.95, 0.857, 0.811, 0.89, 0.673, 0.868, 0.73, 0.896, 0.897, 0.725, 0.836, 0.68, 0.823, 0.752, 0.878, 0.929, 0.904, 0.655, 0.761, 0.411]
Recall Score:  [0.756, 0.885, 0.809, 0.784, 0.835, 0.734, 0.686, 0.752, 0.755, 0.606, 0.949, 0.866, 0.812, 0.887, 0.718, 0.873, 0.741, 0.895, 0.897, 0.748, 0.839, 0.764, 0.83, 0.814, 0.869, 0.928, 0.898, 0.669, 0.787, 0.545]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.3535
Averaged Test Accurancy: 0.8150
Averaged Test AUC: 0.9793
Averaged Test F1_score: 0.7760
Averaged Test Recal score: 0.7977
Std Test Accurancy: 0.1011
Std Test AUC: 0.0110
Std Test F1: 0.0015
Std Test Recall: 0.0013
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6808 |Global loss: 2.1924| Local H loss: 0.0664  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6022 |Global loss: 1.0985| Local H loss: 0.0336  | Global H loss: 0.0171 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5539 |Global loss: 0.9006| Local H loss: 0.0222  | Global H loss: 0.0126 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5238 |Global loss: 0.7153| Local H loss: 0.0165  | Global H loss: 0.0087 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3789 |Global loss: 2.3747| Local H loss: 0.0988  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3112 |Global loss: 1.1804| Local H loss: 0.0603  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2991 |Global loss: 1.0249| Local H loss: 0.0489  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2833 |Global loss: 0.8627| Local H loss: 0.0464  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5187 |Global loss: 2.0969| Local H loss: 0.0811  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4202 |Global loss: 1.1345| Local H loss: 0.0417  | Global H loss: 0.024 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4254 |Global loss: 1.0353| Local H loss: 0.039  | Global H loss: 0.0218 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3915 |Global loss: 0.8645| Local H loss: 0.0396  | Global H loss: 0.0212 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8549 |Global loss: 2.2237| Local H loss: 0.0611  | Global H loss: 0.0289 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7937 |Global loss: 1.1331| Local H loss: 0.0315  | Global H loss: 0.0159 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7412 |Global loss: 0.8627| Local H loss: 0.0238  | Global H loss: 0.0118 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7212 |Global loss: 0.9338| Local H loss: 0.0228  | Global H loss: 0.0119 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4105 |Global loss: 2.1635| Local H loss: 0.0929  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3543 |Global loss: 1.0056| Local H loss: 0.0548  | Global H loss: 0.0286 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3289 |Global loss: 0.8096| Local H loss: 0.0424  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3237 |Global loss: 0.85| Local H loss: 0.046  | Global H loss: 0.0247 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7294 |Global loss: 2.1156| Local H loss: 0.0563  | Global H loss: 0.0295 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6601 |Global loss: 1.0149| Local H loss: 0.0299  | Global H loss: 0.0169 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5923 |Global loss: 0.7783| Local H loss: 0.0224  | Global H loss: 0.0116 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5201 |Global loss: 0.6941| Local H loss: 0.0157  | Global H loss: 0.0087 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9446 |Global loss: 2.1975| Local H loss: 0.053  | Global H loss: 0.0257 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8276 |Global loss: 1.122| Local H loss: 0.0284  | Global H loss: 0.0164 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7737 |Global loss: 0.8941| Local H loss: 0.023  | Global H loss: 0.0127 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7363 |Global loss: 0.9354| Local H loss: 0.0204  | Global H loss: 0.0119 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5148 |Global loss: 2.4167| Local H loss: 0.0965  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.426 |Global loss: 1.2039| Local H loss: 0.0511  | Global H loss: 0.0272 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.408 |Global loss: 0.9825| Local H loss: 0.0393  | Global H loss: 0.0204 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3932 |Global loss: 0.9508| Local H loss: 0.0346  | Global H loss: 0.0195 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3513 |Global loss: 2.0057| Local H loss: 0.089  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2807 |Global loss: 0.9239| Local H loss: 0.0548  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.281 |Global loss: 0.896| Local H loss: 0.0498  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2657 |Global loss: 0.7552| Local H loss: 0.0445  | Global H loss: 0.0258 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4849 |Global loss: 2.1039| Local H loss: 0.0834  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.431 |Global loss: 1.2438| Local H loss: 0.0537  | Global H loss: 0.0278 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.383 |Global loss: 1.0033| Local H loss: 0.0523  | Global H loss: 0.0268 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3713 |Global loss: 0.9072| Local H loss: 0.0477  | Global H loss: 0.024 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6537 |Global loss: 2.2254| Local H loss: 0.0755  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5807 |Global loss: 1.1116| Local H loss: 0.0391  | Global H loss: 0.0195 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5537 |Global loss: 1.0014| Local H loss: 0.0309  | Global H loss: 0.0171 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5282 |Global loss: 0.8502| Local H loss: 0.0317  | Global H loss: 0.0166 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6982 |Global loss: 2.2908| Local H loss: 0.067  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6172 |Global loss: 1.0772| Local H loss: 0.0369  | Global H loss: 0.0176 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5934 |Global loss: 0.9953| Local H loss: 0.0348  | Global H loss: 0.0178 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5719 |Global loss: 0.9604| Local H loss: 0.0305  | Global H loss: 0.0156 [0m
------------------------- time cost ------------------------- 6.125872373580933
Chosen Clients:  [22, 6, 7, 25, 5, 24, 9, 15, 14, 21, 16, 19]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.868, 0.93, 0.775, 0.842, 0.805, 0.623, 0.732, 0.778, 0.608, 0.937, 0.875, 0.829, 0.901, 0.78, 0.837, 0.783, 0.912, 0.933, 0.798, 0.912, 0.765, 0.882, 0.781, 0.903, 0.939, 0.936, 0.667, 0.802, 0.812]
AUC in each clients:  [85.068, 74.677, 84.721, 77.766, 74.861, 78.707, 74.712, 69.077, 69.116, 71.943, 78.458, 78.647, 80.815, 80.167, 80.255, 90.046, 89.657, 89.619, 89.127, 86.978, 101.427, 79.69, 92.414, 93.968, 101.281, 97.45, 93.626, 93.265, 84.397, 93.245]
F1 Score:  [0.746, 0.875, 0.929, 0.728, 0.811, 0.719, 0.512, 0.741, 0.753, 0.527, 0.936, 0.857, 0.811, 0.89, 0.73, 0.842, 0.73, 0.896, 0.897, 0.784, 0.874, 0.68, 0.86, 0.752, 0.878, 0.929, 0.911, 0.655, 0.775, 0.785]
Recall Score:  [0.756, 0.885, 0.931, 0.784, 0.814, 0.734, 0.567, 0.752, 0.755, 0.606, 0.935, 0.866, 0.812, 0.887, 0.803, 0.847, 0.741, 0.895, 0.897, 0.804, 0.885, 0.764, 0.858, 0.814, 0.869, 0.928, 0.905, 0.669, 0.824, 0.784]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.4163
Averaged Test Accurancy: 0.8289
Averaged Test AUC: 0.9811
Averaged Test F1_score: 0.7938
Averaged Test Recal score: 0.8124
Std Test Accurancy: 0.0881
Std Test AUC: 0.0094
Std Test F1: 0.0013
Std Test Recall: 0.0012
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4357 |Global loss: 2.1207| Local H loss: 0.0911  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3652 |Global loss: 1.0767| Local H loss: 0.0583  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.358 |Global loss: 1.013| Local H loss: 0.0512  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3632 |Global loss: 0.9264| Local H loss: 0.0489  | Global H loss: 0.0267 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7656 |Global loss: 2.2452| Local H loss: 0.0753  | Global H loss: 0.0336 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7087 |Global loss: 1.3335| Local H loss: 0.0372  | Global H loss: 0.0189 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6826 |Global loss: 1.0627| Local H loss: 0.0326  | Global H loss: 0.0154 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6328 |Global loss: 0.936| Local H loss: 0.0266  | Global H loss: 0.012 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6376 |Global loss: 2.2128| Local H loss: 0.0714  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5558 |Global loss: 0.9525| Local H loss: 0.0329  | Global H loss: 0.0173 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5357 |Global loss: 0.8955| Local H loss: 0.0268  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5064 |Global loss: 0.8451| Local H loss: 0.0273  | Global H loss: 0.0146 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4432 |Global loss: 2.0919| Local H loss: 0.0882  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3913 |Global loss: 1.2623| Local H loss: 0.0566  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3562 |Global loss: 1.1689| Local H loss: 0.0562  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3473 |Global loss: 1.0294| Local H loss: 0.0541  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.9891 |Global loss: 2.2002| Local H loss: 0.0393  | Global H loss: 0.0224 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.8576 |Global loss: 1.2378| Local H loss: 0.0257  | Global H loss: 0.0168 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7829 |Global loss: 0.9435| Local H loss: 0.0206  | Global H loss: 0.0122 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.698 |Global loss: 0.8252| Local H loss: 0.0184  | Global H loss: 0.011 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.672 |Global loss: 2.1158| Local H loss: 0.0679  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6005 |Global loss: 1.2252| Local H loss: 0.0375  | Global H loss: 0.0193 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5651 |Global loss: 1.2082| Local H loss: 0.0355  | Global H loss: 0.0207 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5097 |Global loss: 0.9758| Local H loss: 0.0296  | Global H loss: 0.0165 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.529 |Global loss: 2.4141| Local H loss: 0.0862  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.491 |Global loss: 1.7091| Local H loss: 0.0635  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4837 |Global loss: 1.4451| Local H loss: 0.0573  | Global H loss: 0.0297 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4492 |Global loss: 1.3066| Local H loss: 0.0529  | Global H loss: 0.0278 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6312 |Global loss: 2.0987| Local H loss: 0.0752  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5697 |Global loss: 1.5972| Local H loss: 0.0567  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.543 |Global loss: 1.1088| Local H loss: 0.0455  | Global H loss: 0.0199 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5113 |Global loss: 1.0062| Local H loss: 0.0415  | Global H loss: 0.0189 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5804 |Global loss: 2.3819| Local H loss: 0.0892  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5361 |Global loss: 1.7346| Local H loss: 0.0672  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5243 |Global loss: 1.3611| Local H loss: 0.0551  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4781 |Global loss: 1.1889| Local H loss: 0.0489  | Global H loss: 0.0249 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6068 |Global loss: 2.0973| Local H loss: 0.0686  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5414 |Global loss: 1.0175| Local H loss: 0.0424  | Global H loss: 0.023 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4894 |Global loss: 0.8012| Local H loss: 0.0321  | Global H loss: 0.0162 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4779 |Global loss: 0.7326| Local H loss: 0.0284  | Global H loss: 0.0145 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.831 |Global loss: 2.0335| Local H loss: 0.0482  | Global H loss: 0.0268 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7563 |Global loss: 1.1952| Local H loss: 0.0334  | Global H loss: 0.0186 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6919 |Global loss: 1.1318| Local H loss: 0.034  | Global H loss: 0.0197 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6732 |Global loss: 0.9472| Local H loss: 0.0263  | Global H loss: 0.0139 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5697 |Global loss: 2.1357| Local H loss: 0.0774  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5126 |Global loss: 1.1097| Local H loss: 0.0438  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4797 |Global loss: 0.9454| Local H loss: 0.0375  | Global H loss: 0.0209 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4411 |Global loss: 0.8996| Local H loss: 0.036  | Global H loss: 0.0193 [0m
------------------------- time cost ------------------------- 5.902070999145508
Chosen Clients:  [4, 27, 14, 15, 7, 12, 6, 28, 26, 2, 5, 10]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.868, 0.93, 0.775, 0.842, 0.793, 0.779, 0.662, 0.778, 0.77, 0.937, 0.875, 0.829, 0.901, 0.878, 0.772, 0.793, 0.912, 0.933, 0.798, 0.912, 0.864, 0.882, 0.781, 0.922, 0.959, 0.936, 0.667, 0.802, 0.812]
AUC in each clients:  [85.068, 74.677, 84.721, 77.766, 74.861, 79.283, 75.27, 68.877, 69.116, 72.468, 78.458, 78.647, 80.815, 80.167, 80.755, 90.132, 90.29, 89.619, 89.127, 87.284, 101.427, 80.057, 92.46, 93.968, 101.855, 97.666, 93.626, 93.265, 84.397, 93.245]
F1 Score:  [0.746, 0.875, 0.929, 0.728, 0.811, 0.702, 0.728, 0.639, 0.753, 0.749, 0.936, 0.857, 0.811, 0.89, 0.862, 0.746, 0.717, 0.896, 0.897, 0.805, 0.874, 0.826, 0.86, 0.752, 0.893, 0.949, 0.911, 0.655, 0.775, 0.785]
Recall Score:  [0.756, 0.885, 0.931, 0.784, 0.814, 0.746, 0.748, 0.702, 0.755, 0.762, 0.935, 0.866, 0.812, 0.887, 0.867, 0.775, 0.736, 0.895, 0.897, 0.813, 0.885, 0.861, 0.858, 0.814, 0.896, 0.949, 0.905, 0.669, 0.824, 0.784]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.4503
Averaged Test Accurancy: 0.8417
Averaged Test AUC: 0.9827
Averaged Test F1_score: 0.8119
Averaged Test Recal score: 0.8270
Std Test Accurancy: 0.0757
Std Test AUC: 0.0088
Std Test F1: 0.0012
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4926 |Global loss: 2.194| Local H loss: 0.0893  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4103 |Global loss: 1.1886| Local H loss: 0.0524  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3838 |Global loss: 0.9432| Local H loss: 0.0417  | Global H loss: 0.0225 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3671 |Global loss: 0.9131| Local H loss: 0.0398  | Global H loss: 0.0218 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.572 |Global loss: 2.1094| Local H loss: 0.0837  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5535 |Global loss: 1.2844| Local H loss: 0.0474  | Global H loss: 0.025 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.498 |Global loss: 1.0505| Local H loss: 0.0412  | Global H loss: 0.0208 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4805 |Global loss: 0.9721| Local H loss: 0.036  | Global H loss: 0.0178 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.52 |Global loss: 2.1287| Local H loss: 0.0811  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4355 |Global loss: 1.0801| Local H loss: 0.0443  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4144 |Global loss: 0.8511| Local H loss: 0.0394  | Global H loss: 0.0208 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.395 |Global loss: 0.75| Local H loss: 0.0332  | Global H loss: 0.0176 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.551 |Global loss: 2.1096| Local H loss: 0.0829  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4808 |Global loss: 1.191| Local H loss: 0.0502  | Global H loss: 0.0248 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4586 |Global loss: 1.0833| Local H loss: 0.0465  | Global H loss: 0.0228 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4281 |Global loss: 0.8416| Local H loss: 0.0389  | Global H loss: 0.0176 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5709 |Global loss: 2.2558| Local H loss: 0.0812  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5091 |Global loss: 1.135| Local H loss: 0.0367  | Global H loss: 0.0222 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4643 |Global loss: 0.8783| Local H loss: 0.0287  | Global H loss: 0.0152 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4452 |Global loss: 0.7755| Local H loss: 0.0231  | Global H loss: 0.0118 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5437 |Global loss: 2.2677| Local H loss: 0.0803  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4875 |Global loss: 1.1729| Local H loss: 0.0386  | Global H loss: 0.0228 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4534 |Global loss: 1.1339| Local H loss: 0.039  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4321 |Global loss: 1.0143| Local H loss: 0.0423  | Global H loss: 0.0219 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6904 |Global loss: 2.1565| Local H loss: 0.0734  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6036 |Global loss: 1.08| Local H loss: 0.035  | Global H loss: 0.018 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5585 |Global loss: 0.8666| Local H loss: 0.0271  | Global H loss: 0.0129 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5433 |Global loss: 0.9417| Local H loss: 0.0251  | Global H loss: 0.0131 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5801 |Global loss: 2.0343| Local H loss: 0.074  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5262 |Global loss: 1.0274| Local H loss: 0.0394  | Global H loss: 0.021 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.454 |Global loss: 0.8152| Local H loss: 0.0271  | Global H loss: 0.0148 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4141 |Global loss: 0.6338| Local H loss: 0.0196  | Global H loss: 0.0102 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3793 |Global loss: 2.1548| Local H loss: 0.0961  | Global H loss: 0.0515 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3355 |Global loss: 1.1769| Local H loss: 0.0699  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3011 |Global loss: 0.9123| Local H loss: 0.0511  | Global H loss: 0.0294 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2986 |Global loss: 0.8435| Local H loss: 0.0521  | Global H loss: 0.0289 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4489 |Global loss: 2.1942| Local H loss: 0.0913  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.356 |Global loss: 1.1186| Local H loss: 0.0519  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3557 |Global loss: 1.0176| Local H loss: 0.0483  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3372 |Global loss: 0.8275| Local H loss: 0.0476  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7443 |Global loss: 2.1189| Local H loss: 0.0628  | Global H loss: 0.0303 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6781 |Global loss: 1.1368| Local H loss: 0.0295  | Global H loss: 0.0165 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6328 |Global loss: 0.9006| Local H loss: 0.0223  | Global H loss: 0.0118 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5812 |Global loss: 0.7572| Local H loss: 0.018  | Global H loss: 0.0097 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3562 |Global loss: 2.3821| Local H loss: 0.1022  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2911 |Global loss: 1.2312| Local H loss: 0.0648  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2818 |Global loss: 1.0092| Local H loss: 0.0563  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2667 |Global loss: 0.907| Local H loss: 0.053  | Global H loss: 0.0331 [0m
------------------------- time cost ------------------------- 6.303525686264038
Chosen Clients:  [28, 29, 9, 18, 1, 19, 7, 20, 6, 12, 4, 14]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.868, 0.965, 0.775, 0.921, 0.841, 0.779, 0.761, 0.778, 0.77, 0.962, 0.875, 0.866, 0.901, 0.915, 0.88, 0.793, 0.912, 0.933, 0.798, 0.912, 0.864, 0.882, 0.781, 0.922, 0.959, 0.957, 0.677, 0.767, 0.812]
AUC in each clients:  [85.068, 74.677, 85.007, 77.766, 74.891, 79.499, 75.439, 69.46, 69.116, 72.468, 78.556, 78.647, 81.059, 80.167, 81.106, 90.658, 90.29, 89.619, 89.127, 87.284, 101.427, 80.057, 92.46, 93.968, 101.855, 97.666, 93.695, 93.426, 84.252, 93.245]
F1 Score:  [0.746, 0.875, 0.965, 0.728, 0.911, 0.815, 0.74, 0.738, 0.753, 0.749, 0.963, 0.857, 0.851, 0.89, 0.912, 0.881, 0.717, 0.896, 0.897, 0.805, 0.874, 0.826, 0.86, 0.752, 0.893, 0.949, 0.941, 0.663, 0.705, 0.785]
Recall Score:  [0.756, 0.885, 0.967, 0.784, 0.909, 0.824, 0.756, 0.774, 0.755, 0.762, 0.963, 0.866, 0.85, 0.887, 0.924, 0.886, 0.736, 0.895, 0.897, 0.813, 0.885, 0.861, 0.858, 0.814, 0.896, 0.949, 0.935, 0.675, 0.764, 0.784]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.4435
Averaged Test Accurancy: 0.8564
Averaged Test AUC: 0.9837
Averaged Test F1_score: 0.8312
Averaged Test Recal score: 0.8437
Std Test Accurancy: 0.0739
Std Test AUC: 0.0086
Std Test F1: 0.0013
Std Test Recall: 0.0012
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5105 |Global loss: 2.0432| Local H loss: 0.0871  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4156 |Global loss: 0.9326| Local H loss: 0.0452  | Global H loss: 0.0238 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3889 |Global loss: 0.852| Local H loss: 0.0397  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3661 |Global loss: 0.7027| Local H loss: 0.0279  | Global H loss: 0.0154 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7607 |Global loss: 2.2024| Local H loss: 0.0669  | Global H loss: 0.0323 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7028 |Global loss: 1.4605| Local H loss: 0.0411  | Global H loss: 0.0227 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6539 |Global loss: 1.1099| Local H loss: 0.0301  | Global H loss: 0.0163 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6273 |Global loss: 0.9723| Local H loss: 0.028  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5354 |Global loss: 2.3725| Local H loss: 0.0881  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4782 |Global loss: 1.9229| Local H loss: 0.0658  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4411 |Global loss: 1.4661| Local H loss: 0.0617  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4458 |Global loss: 1.2614| Local H loss: 0.0481  | Global H loss: 0.0271 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4393 |Global loss: 1.8937| Local H loss: 0.0864  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3608 |Global loss: 0.817| Local H loss: 0.0405  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3378 |Global loss: 0.5731| Local H loss: 0.0317  | Global H loss: 0.0159 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2917 |Global loss: 0.4921| Local H loss: 0.0258  | Global H loss: 0.0145 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5039 |Global loss: 2.2048| Local H loss: 0.0843  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4248 |Global loss: 1.1691| Local H loss: 0.048  | Global H loss: 0.0261 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4086 |Global loss: 0.9741| Local H loss: 0.0425  | Global H loss: 0.0224 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3854 |Global loss: 0.9914| Local H loss: 0.0405  | Global H loss: 0.0234 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4992 |Global loss: 2.2| Local H loss: 0.0877  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.444 |Global loss: 1.2289| Local H loss: 0.0473  | Global H loss: 0.0276 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3985 |Global loss: 0.9255| Local H loss: 0.0387  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3993 |Global loss: 0.8536| Local H loss: 0.0407  | Global H loss: 0.0226 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5389 |Global loss: 2.2994| Local H loss: 0.09  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.456 |Global loss: 1.0825| Local H loss: 0.0501  | Global H loss: 0.0255 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4165 |Global loss: 0.9299| Local H loss: 0.0385  | Global H loss: 0.0224 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3799 |Global loss: 0.654| Local H loss: 0.0242  | Global H loss: 0.0133 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3216 |Global loss: 1.8083| Local H loss: 0.0866  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2873 |Global loss: 1.0386| Local H loss: 0.0592  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2588 |Global loss: 0.8012| Local H loss: 0.0512  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2548 |Global loss: 0.7397| Local H loss: 0.0505  | Global H loss: 0.0302 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6001 |Global loss: 2.1936| Local H loss: 0.0856  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.528 |Global loss: 1.2179| Local H loss: 0.0402  | Global H loss: 0.022 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.504 |Global loss: 1.0438| Local H loss: 0.0306  | Global H loss: 0.0174 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4534 |Global loss: 0.8239| Local H loss: 0.0269  | Global H loss: 0.0135 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4867 |Global loss: 2.1344| Local H loss: 0.0837  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4355 |Global loss: 1.3233| Local H loss: 0.0466  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4115 |Global loss: 1.1075| Local H loss: 0.0489  | Global H loss: 0.0274 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3765 |Global loss: 1.0272| Local H loss: 0.0447  | Global H loss: 0.0259 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4402 |Global loss: 2.229| Local H loss: 0.095  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3848 |Global loss: 1.1015| Local H loss: 0.0544  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3389 |Global loss: 0.8949| Local H loss: 0.0449  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3458 |Global loss: 0.9312| Local H loss: 0.0453  | Global H loss: 0.0253 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4644 |Global loss: 2.2103| Local H loss: 0.0935  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3845 |Global loss: 1.0398| Local H loss: 0.0521  | Global H loss: 0.0287 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.366 |Global loss: 0.8536| Local H loss: 0.0398  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3472 |Global loss: 0.7593| Local H loss: 0.0335  | Global H loss: 0.0193 [0m
------------------------- time cost ------------------------- 6.646885395050049
Chosen Clients:  [28, 25, 23, 29, 22, 4, 9, 19, 24, 21, 1, 20]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.895, 0.965, 0.775, 0.908, 0.841, 0.779, 0.803, 0.778, 0.77, 0.962, 0.875, 0.878, 0.901, 0.939, 0.88, 0.793, 0.912, 0.9, 0.854, 0.931, 0.864, 0.882, 0.781, 0.922, 0.959, 0.957, 0.677, 0.919, 0.781]
AUC in each clients:  [85.068, 74.892, 85.007, 77.766, 75.142, 79.499, 75.582, 69.661, 69.116, 72.566, 78.556, 78.647, 81.159, 80.167, 81.363, 90.658, 90.29, 89.619, 89.302, 87.884, 101.501, 80.057, 92.46, 93.968, 101.855, 97.666, 93.695, 93.426, 84.989, 93.938]
F1 Score:  [0.746, 0.904, 0.965, 0.728, 0.895, 0.815, 0.748, 0.805, 0.753, 0.751, 0.963, 0.857, 0.868, 0.89, 0.938, 0.881, 0.717, 0.896, 0.849, 0.843, 0.905, 0.826, 0.86, 0.752, 0.893, 0.949, 0.941, 0.663, 0.884, 0.691]
Recall Score:  [0.756, 0.904, 0.967, 0.784, 0.893, 0.824, 0.76, 0.822, 0.755, 0.766, 0.963, 0.866, 0.865, 0.887, 0.943, 0.886, 0.736, 0.895, 0.858, 0.847, 0.91, 0.861, 0.858, 0.814, 0.896, 0.949, 0.935, 0.675, 0.906, 0.734]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.4285
Averaged Test Accurancy: 0.8646
Averaged Test AUC: 0.9851
Averaged Test F1_score: 0.8392
Averaged Test Recal score: 0.8505
Std Test Accurancy: 0.0718
Std Test AUC: 0.0084
Std Test F1: 0.0013
Std Test Recall: 0.0013
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4455 |Global loss: 2.0386| Local H loss: 0.0947  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3571 |Global loss: 0.8545| Local H loss: 0.0469  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3432 |Global loss: 0.9155| Local H loss: 0.0413  | Global H loss: 0.025 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3335 |Global loss: 0.7635| Local H loss: 0.0362  | Global H loss: 0.0201 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3867 |Global loss: 2.0219| Local H loss: 0.0883  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.34 |Global loss: 1.3131| Local H loss: 0.0652  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3245 |Global loss: 1.079| Local H loss: 0.0613  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3224 |Global loss: 1.0022| Local H loss: 0.0536  | Global H loss: 0.0307 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6524 |Global loss: 2.0024| Local H loss: 0.0698  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5844 |Global loss: 1.0122| Local H loss: 0.0341  | Global H loss: 0.02 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5349 |Global loss: 0.8252| Local H loss: 0.0258  | Global H loss: 0.0136 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5092 |Global loss: 0.7353| Local H loss: 0.0256  | Global H loss: 0.0133 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6632 |Global loss: 2.0822| Local H loss: 0.0735  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5893 |Global loss: 1.2272| Local H loss: 0.0386  | Global H loss: 0.0199 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5523 |Global loss: 1.1909| Local H loss: 0.0327  | Global H loss: 0.0194 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5146 |Global loss: 0.9495| Local H loss: 0.0306  | Global H loss: 0.0158 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.392 |Global loss: 2.0697| Local H loss: 0.0877  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.352 |Global loss: 1.1316| Local H loss: 0.0563  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3412 |Global loss: 0.9601| Local H loss: 0.052  | Global H loss: 0.0292 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3294 |Global loss: 0.9232| Local H loss: 0.0502  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.422 |Global loss: 2.2615| Local H loss: 0.0981  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3601 |Global loss: 1.1843| Local H loss: 0.0592  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3403 |Global loss: 0.9903| Local H loss: 0.0532  | Global H loss: 0.0307 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3158 |Global loss: 0.9057| Local H loss: 0.048  | Global H loss: 0.0287 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4821 |Global loss: 2.4114| Local H loss: 0.0897  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4351 |Global loss: 1.6097| Local H loss: 0.0677  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.443 |Global loss: 1.4467| Local H loss: 0.0622  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4044 |Global loss: 1.2097| Local H loss: 0.0546  | Global H loss: 0.0302 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4478 |Global loss: 2.0116| Local H loss: 0.0831  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3628 |Global loss: 1.0129| Local H loss: 0.0449  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3413 |Global loss: 0.8808| Local H loss: 0.0407  | Global H loss: 0.024 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.318 |Global loss: 0.8059| Local H loss: 0.0358  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5512 |Global loss: 2.0307| Local H loss: 0.0774  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4948 |Global loss: 1.2994| Local H loss: 0.0478  | Global H loss: 0.0263 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4749 |Global loss: 1.1604| Local H loss: 0.0437  | Global H loss: 0.0236 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.436 |Global loss: 0.9791| Local H loss: 0.0441  | Global H loss: 0.0222 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5249 |Global loss: 2.0593| Local H loss: 0.0806  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.477 |Global loss: 0.8605| Local H loss: 0.0407  | Global H loss: 0.0211 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4452 |Global loss: 0.762| Local H loss: 0.0367  | Global H loss: 0.0195 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4229 |Global loss: 0.7107| Local H loss: 0.0281  | Global H loss: 0.0152 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4355 |Global loss: 2.1703| Local H loss: 0.0889  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3903 |Global loss: 1.159| Local H loss: 0.0563  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3435 |Global loss: 1.0404| Local H loss: 0.0488  | Global H loss: 0.0295 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.34 |Global loss: 0.9585| Local H loss: 0.0422  | Global H loss: 0.0255 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3052 |Global loss: 1.8209| Local H loss: 0.093  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2509 |Global loss: 0.9088| Local H loss: 0.0559  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2573 |Global loss: 0.8516| Local H loss: 0.0526  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2387 |Global loss: 0.7068| Local H loss: 0.0458  | Global H loss: 0.0284 [0m
------------------------- time cost ------------------------- 6.690496921539307
Chosen Clients:  [28, 23, 19, 29, 1, 16, 6, 2, 26, 27, 18, 13]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.855, 0.965, 0.775, 0.882, 0.841, 0.779, 0.803, 0.778, 0.838, 0.962, 0.875, 0.878, 0.901, 0.939, 0.88, 0.793, 0.912, 0.9, 0.888, 0.922, 0.864, 0.882, 0.76, 0.951, 0.959, 0.957, 0.677, 0.93, 0.885]
AUC in each clients:  [85.068, 75.038, 85.007, 77.766, 75.208, 79.499, 75.582, 69.661, 69.116, 72.859, 78.556, 78.647, 81.159, 80.167, 81.363, 90.658, 90.29, 89.619, 89.302, 87.972, 101.496, 80.073, 92.47, 94.133, 102.301, 97.669, 93.695, 93.426, 84.999, 94.591]
F1 Score:  [0.746, 0.862, 0.965, 0.728, 0.856, 0.815, 0.748, 0.805, 0.753, 0.813, 0.963, 0.857, 0.868, 0.89, 0.938, 0.881, 0.717, 0.896, 0.849, 0.884, 0.886, 0.821, 0.84, 0.72, 0.931, 0.949, 0.941, 0.663, 0.887, 0.868]
Recall Score:  [0.756, 0.874, 0.967, 0.784, 0.859, 0.824, 0.76, 0.822, 0.755, 0.819, 0.963, 0.866, 0.865, 0.887, 0.943, 0.886, 0.736, 0.895, 0.858, 0.884, 0.897, 0.878, 0.847, 0.798, 0.931, 0.949, 0.935, 0.675, 0.896, 0.868]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.4121
Averaged Test Accurancy: 0.8700
Averaged Test AUC: 0.9858
Averaged Test F1_score: 0.8447
Averaged Test Recal score: 0.8559
Std Test Accurancy: 0.0697
Std Test AUC: 0.0084
Std Test F1: 0.0012
Std Test Recall: 0.0012
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3966 |Global loss: 2.0242| Local H loss: 0.0975  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3245 |Global loss: 1.067| Local H loss: 0.0578  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3101 |Global loss: 0.8872| Local H loss: 0.0446  | Global H loss: 0.0268 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2732 |Global loss: 0.6686| Local H loss: 0.0381  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5506 |Global loss: 1.9619| Local H loss: 0.0795  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4882 |Global loss: 0.8967| Local H loss: 0.0373  | Global H loss: 0.0196 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4319 |Global loss: 0.7531| Local H loss: 0.0355  | Global H loss: 0.0183 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4494 |Global loss: 0.8466| Local H loss: 0.0335  | Global H loss: 0.019 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3973 |Global loss: 1.9736| Local H loss: 0.0922  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3307 |Global loss: 0.9507| Local H loss: 0.0512  | Global H loss: 0.0314 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3084 |Global loss: 0.8271| Local H loss: 0.0463  | Global H loss: 0.0278 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3034 |Global loss: 0.7989| Local H loss: 0.0466  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5409 |Global loss: 2.0648| Local H loss: 0.079  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4746 |Global loss: 1.2793| Local H loss: 0.0443  | Global H loss: 0.0256 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4409 |Global loss: 0.9727| Local H loss: 0.034  | Global H loss: 0.0189 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4078 |Global loss: 0.8186| Local H loss: 0.0322  | Global H loss: 0.0179 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3896 |Global loss: 2.1668| Local H loss: 0.0968  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3334 |Global loss: 1.1242| Local H loss: 0.0533  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3096 |Global loss: 0.9684| Local H loss: 0.0504  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3019 |Global loss: 0.9245| Local H loss: 0.0506  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7095 |Global loss: 2.0537| Local H loss: 0.0683  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6074 |Global loss: 1.1745| Local H loss: 0.0409  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.564 |Global loss: 1.0301| Local H loss: 0.0367  | Global H loss: 0.019 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5679 |Global loss: 0.9753| Local H loss: 0.0309  | Global H loss: 0.0176 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5422 |Global loss: 2.1593| Local H loss: 0.0877  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4784 |Global loss: 1.2696| Local H loss: 0.0428  | Global H loss: 0.024 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4566 |Global loss: 0.92| Local H loss: 0.0332  | Global H loss: 0.017 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4183 |Global loss: 0.8925| Local H loss: 0.0334  | Global H loss: 0.018 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3918 |Global loss: 2.0541| Local H loss: 0.0948  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.346 |Global loss: 1.0483| Local H loss: 0.0519  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3213 |Global loss: 0.9705| Local H loss: 0.053  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3176 |Global loss: 0.8076| Local H loss: 0.0481  | Global H loss: 0.0263 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3518 |Global loss: 2.0285| Local H loss: 0.0944  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3002 |Global loss: 1.1411| Local H loss: 0.0644  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2802 |Global loss: 0.8707| Local H loss: 0.0524  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2781 |Global loss: 0.8471| Local H loss: 0.0554  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5516 |Global loss: 2.1428| Local H loss: 0.0842  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.491 |Global loss: 1.2368| Local H loss: 0.0542  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4752 |Global loss: 1.0585| Local H loss: 0.0478  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4491 |Global loss: 0.9693| Local H loss: 0.042  | Global H loss: 0.0215 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4064 |Global loss: 1.9408| Local H loss: 0.1  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3109 |Global loss: 0.8326| Local H loss: 0.0511  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2882 |Global loss: 0.5835| Local H loss: 0.0361  | Global H loss: 0.0193 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2739 |Global loss: 0.5589| Local H loss: 0.0388  | Global H loss: 0.0213 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5111 |Global loss: 2.2737| Local H loss: 0.0907  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4534 |Global loss: 1.3362| Local H loss: 0.0554  | Global H loss: 0.0306 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4241 |Global loss: 1.2386| Local H loss: 0.052  | Global H loss: 0.0286 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4003 |Global loss: 1.0494| Local H loss: 0.048  | Global H loss: 0.0253 [0m
------------------------- time cost ------------------------- 6.607951641082764
Chosen Clients:  [14, 0, 9, 13, 3, 12, 10, 15, 21, 27, 1, 7]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.816, 0.868, 0.907, 0.775, 0.882, 0.841, 0.792, 0.803, 0.778, 0.838, 0.962, 0.875, 0.878, 0.926, 0.939, 0.88, 0.859, 0.912, 0.922, 0.899, 0.922, 0.864, 0.882, 0.854, 0.951, 0.959, 0.957, 0.76, 0.965, 0.896]
AUC in each clients:  [85.068, 75.144, 84.951, 77.766, 75.208, 79.499, 75.793, 69.661, 69.116, 72.859, 78.556, 78.647, 81.159, 80.511, 81.363, 90.658, 90.487, 89.619, 89.415, 88.265, 101.496, 80.073, 92.47, 94.635, 102.301, 97.669, 93.757, 93.747, 85.246, 95.078]
F1 Score:  [0.746, 0.873, 0.9, 0.728, 0.856, 0.815, 0.764, 0.805, 0.753, 0.813, 0.963, 0.857, 0.868, 0.926, 0.938, 0.881, 0.79, 0.896, 0.875, 0.893, 0.886, 0.821, 0.84, 0.841, 0.931, 0.949, 0.941, 0.733, 0.946, 0.856]
Recall Score:  [0.756, 0.886, 0.913, 0.784, 0.859, 0.824, 0.77, 0.822, 0.755, 0.819, 0.963, 0.866, 0.865, 0.924, 0.943, 0.886, 0.83, 0.895, 0.886, 0.893, 0.897, 0.878, 0.847, 0.875, 0.931, 0.949, 0.935, 0.752, 0.972, 0.872]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.3836
Averaged Test Accurancy: 0.8812
Averaged Test AUC: 0.9869
Averaged Test F1_score: 0.8561
Averaged Test Recal score: 0.8682
Std Test Accurancy: 0.0581
Std Test AUC: 0.0084
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4171 |Global loss: 2.4419| Local H loss: 0.1002  | Global H loss: 0.0531 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3602 |Global loss: 1.2485| Local H loss: 0.0595  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3207 |Global loss: 0.8583| Local H loss: 0.0464  | Global H loss: 0.0266 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.305 |Global loss: 0.7963| Local H loss: 0.0431  | Global H loss: 0.0258 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6272 |Global loss: 2.0447| Local H loss: 0.0658  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5797 |Global loss: 1.2055| Local H loss: 0.0366  | Global H loss: 0.0227 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5273 |Global loss: 1.037| Local H loss: 0.0343  | Global H loss: 0.0211 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4948 |Global loss: 0.7934| Local H loss: 0.0302  | Global H loss: 0.0154 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4469 |Global loss: 2.4128| Local H loss: 0.0885  | Global H loss: 0.0504 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4198 |Global loss: 1.58| Local H loss: 0.0643  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.39 |Global loss: 1.319| Local H loss: 0.0546  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3863 |Global loss: 1.108| Local H loss: 0.0518  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4494 |Global loss: 2.2436| Local H loss: 0.0948  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3844 |Global loss: 1.2368| Local H loss: 0.0574  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3603 |Global loss: 1.0411| Local H loss: 0.0525  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3906 |Global loss: 1.0295| Local H loss: 0.0472  | Global H loss: 0.0261 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7325 |Global loss: 2.2131| Local H loss: 0.0672  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.633 |Global loss: 1.1599| Local H loss: 0.0378  | Global H loss: 0.0196 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6041 |Global loss: 1.1017| Local H loss: 0.0352  | Global H loss: 0.019 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5945 |Global loss: 1.0757| Local H loss: 0.0314  | Global H loss: 0.0179 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4091 |Global loss: 2.1859| Local H loss: 0.0907  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3772 |Global loss: 1.2684| Local H loss: 0.0566  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3441 |Global loss: 1.1102| Local H loss: 0.0485  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.312 |Global loss: 0.9597| Local H loss: 0.0476  | Global H loss: 0.0291 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3532 |Global loss: 2.1948| Local H loss: 0.0992  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.283 |Global loss: 1.1532| Local H loss: 0.0663  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.281 |Global loss: 1.023| Local H loss: 0.0544  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2607 |Global loss: 0.8343| Local H loss: 0.0517  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5227 |Global loss: 2.0599| Local H loss: 0.0907  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4567 |Global loss: 1.1787| Local H loss: 0.0559  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.432 |Global loss: 0.9017| Local H loss: 0.0498  | Global H loss: 0.0246 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4411 |Global loss: 0.7877| Local H loss: 0.0455  | Global H loss: 0.0209 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4777 |Global loss: 2.0256| Local H loss: 0.0863  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4074 |Global loss: 0.9944| Local H loss: 0.0505  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3898 |Global loss: 0.7947| Local H loss: 0.0341  | Global H loss: 0.0191 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3675 |Global loss: 0.6297| Local H loss: 0.0307  | Global H loss: 0.0151 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5154 |Global loss: 2.1331| Local H loss: 0.0869  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4878 |Global loss: 1.3125| Local H loss: 0.0571  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4424 |Global loss: 1.0352| Local H loss: 0.0477  | Global H loss: 0.0253 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4352 |Global loss: 0.9664| Local H loss: 0.0437  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3724 |Global loss: 2.0751| Local H loss: 0.0957  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3051 |Global loss: 1.182| Local H loss: 0.0593  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.302 |Global loss: 0.9587| Local H loss: 0.051  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2775 |Global loss: 0.8744| Local H loss: 0.0494  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4707 |Global loss: 2.1806| Local H loss: 0.0907  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4031 |Global loss: 1.0093| Local H loss: 0.0463  | Global H loss: 0.0271 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3828 |Global loss: 0.82| Local H loss: 0.0374  | Global H loss: 0.0212 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3467 |Global loss: 0.7456| Local H loss: 0.0323  | Global H loss: 0.0187 [0m
------------------------- time cost ------------------------- 6.188892602920532
Chosen Clients:  [7, 11, 18, 14, 27, 19, 17, 0, 2, 3, 26, 23]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.851, 0.882, 0.907, 0.85, 0.882, 0.841, 0.792, 0.775, 0.778, 0.851, 0.962, 0.875, 0.878, 0.914, 0.939, 0.88, 0.859, 0.912, 0.922, 0.899, 0.922, 0.926, 0.882, 0.854, 0.951, 0.959, 0.957, 0.771, 0.965, 0.896]
AUC in each clients:  [85.451, 75.218, 84.951, 78.073, 75.208, 79.499, 75.793, 69.876, 69.116, 72.962, 78.601, 78.647, 81.365, 80.561, 81.503, 90.837, 90.487, 89.619, 89.415, 88.265, 101.496, 80.269, 92.47, 94.635, 102.301, 97.669, 93.757, 93.887, 85.246, 95.078]
F1 Score:  [0.838, 0.888, 0.9, 0.836, 0.856, 0.815, 0.764, 0.777, 0.753, 0.826, 0.963, 0.857, 0.866, 0.909, 0.938, 0.881, 0.79, 0.896, 0.875, 0.893, 0.886, 0.915, 0.84, 0.841, 0.931, 0.949, 0.941, 0.746, 0.946, 0.856]
Recall Score:  [0.829, 0.895, 0.913, 0.861, 0.859, 0.824, 0.77, 0.784, 0.755, 0.833, 0.963, 0.866, 0.865, 0.905, 0.943, 0.886, 0.83, 0.895, 0.886, 0.893, 0.897, 0.934, 0.847, 0.875, 0.931, 0.949, 0.935, 0.769, 0.972, 0.872]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.3683
Averaged Test Accurancy: 0.8866
Averaged Test AUC: 0.9877
Averaged Test F1_score: 0.8657
Averaged Test Recal score: 0.8745
Std Test Accurancy: 0.0547
Std Test AUC: 0.0081
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4512 |Global loss: 2.2082| Local H loss: 0.0963  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3518 |Global loss: 1.0809| Local H loss: 0.0509  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3562 |Global loss: 0.8834| Local H loss: 0.0415  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3149 |Global loss: 0.8007| Local H loss: 0.0418  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5845 |Global loss: 2.2033| Local H loss: 0.0769  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4994 |Global loss: 1.185| Local H loss: 0.0451  | Global H loss: 0.0268 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4975 |Global loss: 1.1123| Local H loss: 0.0401  | Global H loss: 0.0235 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4516 |Global loss: 0.9984| Local H loss: 0.04  | Global H loss: 0.0232 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3795 |Global loss: 1.9817| Local H loss: 0.102  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2885 |Global loss: 0.8216| Local H loss: 0.0566  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2651 |Global loss: 0.641| Local H loss: 0.0464  | Global H loss: 0.0256 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2559 |Global loss: 0.5372| Local H loss: 0.0357  | Global H loss: 0.0203 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3914 |Global loss: 2.1243| Local H loss: 0.0982  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3315 |Global loss: 1.151| Local H loss: 0.0643  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2939 |Global loss: 0.8235| Local H loss: 0.0497  | Global H loss: 0.0298 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2849 |Global loss: 0.8141| Local H loss: 0.0506  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5163 |Global loss: 2.2044| Local H loss: 0.0892  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4357 |Global loss: 1.2549| Local H loss: 0.0591  | Global H loss: 0.0311 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4261 |Global loss: 1.1426| Local H loss: 0.0486  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4086 |Global loss: 0.945| Local H loss: 0.0477  | Global H loss: 0.0255 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3653 |Global loss: 1.9909| Local H loss: 0.0953  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3032 |Global loss: 1.0844| Local H loss: 0.0537  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2811 |Global loss: 0.8637| Local H loss: 0.054  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2829 |Global loss: 0.7609| Local H loss: 0.0442  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6403 |Global loss: 2.0181| Local H loss: 0.0701  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5707 |Global loss: 1.051| Local H loss: 0.0365  | Global H loss: 0.0203 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5324 |Global loss: 0.9248| Local H loss: 0.0335  | Global H loss: 0.0181 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4959 |Global loss: 0.8465| Local H loss: 0.0307  | Global H loss: 0.0164 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5283 |Global loss: 1.9546| Local H loss: 0.0769  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4545 |Global loss: 1.0001| Local H loss: 0.0428  | Global H loss: 0.0249 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4259 |Global loss: 0.7527| Local H loss: 0.0311  | Global H loss: 0.0169 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4162 |Global loss: 0.8781| Local H loss: 0.0421  | Global H loss: 0.0225 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3723 |Global loss: 2.1125| Local H loss: 0.0982  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.306 |Global loss: 1.1029| Local H loss: 0.0571  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2968 |Global loss: 0.9824| Local H loss: 0.049  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2834 |Global loss: 0.8562| Local H loss: 0.0512  | Global H loss: 0.0302 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6224 |Global loss: 2.1174| Local H loss: 0.0797  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5515 |Global loss: 1.2459| Local H loss: 0.0417  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5317 |Global loss: 1.1064| Local H loss: 0.0373  | Global H loss: 0.0202 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5249 |Global loss: 1.065| Local H loss: 0.0335  | Global H loss: 0.0183 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3261 |Global loss: 2.0446| Local H loss: 0.0978  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2784 |Global loss: 1.0062| Local H loss: 0.0599  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2501 |Global loss: 0.7352| Local H loss: 0.0508  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2571 |Global loss: 0.8197| Local H loss: 0.0538  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5026 |Global loss: 2.0572| Local H loss: 0.0923  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4329 |Global loss: 1.0818| Local H loss: 0.049  | Global H loss: 0.0265 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4146 |Global loss: 0.8551| Local H loss: 0.0449  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3844 |Global loss: 0.8715| Local H loss: 0.044  | Global H loss: 0.0246 [0m
------------------------- time cost ------------------------- 8.463263988494873
Chosen Clients:  [1, 28, 17, 7, 0, 11, 23, 12, 21, 2, 15, 29]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.839, 0.882, 0.942, 0.812, 0.882, 0.841, 0.792, 0.859, 0.778, 0.851, 0.962, 0.912, 0.878, 0.914, 0.939, 0.88, 0.859, 0.89, 0.956, 0.921, 0.922, 0.926, 0.882, 0.927, 0.951, 0.959, 0.957, 0.76, 0.965, 0.896]
AUC in each clients:  [85.992, 75.218, 85.155, 78.336, 75.208, 79.499, 75.793, 69.937, 69.116, 72.962, 78.601, 78.885, 81.365, 80.561, 81.602, 90.837, 90.487, 89.843, 89.529, 88.37, 101.496, 80.269, 92.47, 94.964, 102.301, 97.669, 93.801, 93.925, 85.246, 95.078]
F1 Score:  [0.794, 0.888, 0.938, 0.799, 0.856, 0.815, 0.764, 0.867, 0.753, 0.826, 0.963, 0.908, 0.866, 0.909, 0.938, 0.881, 0.79, 0.891, 0.933, 0.917, 0.886, 0.915, 0.84, 0.919, 0.931, 0.949, 0.94, 0.734, 0.946, 0.856]
Recall Score:  [0.786, 0.895, 0.944, 0.808, 0.859, 0.824, 0.77, 0.875, 0.755, 0.833, 0.963, 0.905, 0.865, 0.905, 0.943, 0.886, 0.83, 0.89, 0.934, 0.917, 0.897, 0.934, 0.847, 0.933, 0.931, 0.949, 0.935, 0.759, 0.972, 0.872]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.3437
Averaged Test Accurancy: 0.8932
Averaged Test AUC: 0.9886
Averaged Test F1_score: 0.8737
Averaged Test Recal score: 0.8805
Std Test Accurancy: 0.0556
Std Test AUC: 0.0080
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3505 |Global loss: 2.1382| Local H loss: 0.1009  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3094 |Global loss: 1.2634| Local H loss: 0.0613  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3032 |Global loss: 1.131| Local H loss: 0.0596  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2871 |Global loss: 1.0147| Local H loss: 0.0553  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.37 |Global loss: 2.2006| Local H loss: 0.106  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3044 |Global loss: 1.06| Local H loss: 0.0617  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2887 |Global loss: 0.9394| Local H loss: 0.0508  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2596 |Global loss: 0.6768| Local H loss: 0.0417  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5479 |Global loss: 1.9977| Local H loss: 0.0807  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4693 |Global loss: 1.0802| Local H loss: 0.0391  | Global H loss: 0.0215 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4604 |Global loss: 1.0336| Local H loss: 0.0402  | Global H loss: 0.0216 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4488 |Global loss: 0.8642| Local H loss: 0.0319  | Global H loss: 0.0171 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.389 |Global loss: 2.2282| Local H loss: 0.1007  | Global H loss: 0.0516 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3281 |Global loss: 1.0241| Local H loss: 0.0492  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2949 |Global loss: 0.7902| Local H loss: 0.0465  | Global H loss: 0.0271 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2738 |Global loss: 0.6458| Local H loss: 0.0325  | Global H loss: 0.0199 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4694 |Global loss: 2.1402| Local H loss: 0.0896  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3983 |Global loss: 1.0215| Local H loss: 0.0475  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3705 |Global loss: 0.8449| Local H loss: 0.0393  | Global H loss: 0.0222 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3385 |Global loss: 0.6888| Local H loss: 0.0363  | Global H loss: 0.0192 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4887 |Global loss: 2.2444| Local H loss: 0.0856  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4371 |Global loss: 1.5363| Local H loss: 0.0516  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4018 |Global loss: 0.9918| Local H loss: 0.0455  | Global H loss: 0.0249 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3819 |Global loss: 0.9429| Local H loss: 0.0404  | Global H loss: 0.0237 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4362 |Global loss: 1.9615| Local H loss: 0.0911  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.341 |Global loss: 0.8638| Local H loss: 0.046  | Global H loss: 0.0266 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3703 |Global loss: 0.8943| Local H loss: 0.0362  | Global H loss: 0.0219 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3281 |Global loss: 0.7938| Local H loss: 0.0381  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3988 |Global loss: 2.1825| Local H loss: 0.0916  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3243 |Global loss: 1.2212| Local H loss: 0.0593  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3126 |Global loss: 1.0735| Local H loss: 0.0507  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2972 |Global loss: 0.9578| Local H loss: 0.0503  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4436 |Global loss: 2.0758| Local H loss: 0.092  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3966 |Global loss: 0.9492| Local H loss: 0.0464  | Global H loss: 0.0269 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3418 |Global loss: 0.7539| Local H loss: 0.0419  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3274 |Global loss: 0.6588| Local H loss: 0.0366  | Global H loss: 0.019 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3619 |Global loss: 2.0512| Local H loss: 0.1036  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2842 |Global loss: 0.998| Local H loss: 0.0629  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2865 |Global loss: 0.9563| Local H loss: 0.0547  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2793 |Global loss: 0.9412| Local H loss: 0.0563  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4669 |Global loss: 2.0489| Local H loss: 0.0903  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.437 |Global loss: 1.3211| Local H loss: 0.0585  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3818 |Global loss: 0.9107| Local H loss: 0.0484  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3666 |Global loss: 0.8878| Local H loss: 0.0456  | Global H loss: 0.0235 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4719 |Global loss: 2.3119| Local H loss: 0.0898  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3966 |Global loss: 1.1499| Local H loss: 0.0493  | Global H loss: 0.0288 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3753 |Global loss: 1.1536| Local H loss: 0.0556  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3442 |Global loss: 1.0162| Local H loss: 0.0474  | Global H loss: 0.0299 [0m
------------------------- time cost ------------------------- 7.945852041244507
Chosen Clients:  [6, 0, 23, 3, 25, 15, 7, 17, 27, 19, 12, 4]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.897, 0.855, 0.965, 0.812, 0.882, 0.841, 0.792, 0.817, 0.778, 0.851, 0.962, 0.838, 0.89, 0.914, 0.939, 0.902, 0.859, 0.89, 0.956, 0.921, 0.922, 0.926, 0.882, 0.906, 0.951, 0.959, 0.957, 0.76, 0.942, 0.938]
AUC in each clients:  [86.13, 75.262, 85.406, 78.336, 75.208, 79.499, 75.793, 69.896, 69.116, 72.962, 78.601, 78.756, 81.476, 80.561, 81.602, 90.982, 90.487, 90.013, 89.529, 88.37, 101.496, 80.4, 92.47, 95.1, 102.301, 97.669, 93.801, 93.925, 85.255, 95.457]
F1 Score:  [0.904, 0.859, 0.965, 0.799, 0.856, 0.815, 0.764, 0.815, 0.753, 0.826, 0.963, 0.803, 0.879, 0.909, 0.938, 0.906, 0.79, 0.891, 0.933, 0.917, 0.886, 0.915, 0.84, 0.898, 0.931, 0.949, 0.94, 0.734, 0.917, 0.923]
Recall Score:  [0.9, 0.871, 0.967, 0.808, 0.859, 0.824, 0.77, 0.837, 0.755, 0.833, 0.963, 0.828, 0.878, 0.905, 0.943, 0.91, 0.83, 0.89, 0.934, 0.917, 0.897, 0.934, 0.847, 0.913, 0.931, 0.949, 0.935, 0.759, 0.951, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.3029
Averaged Test Accurancy: 0.8928
Averaged Test AUC: 0.9891
Averaged Test F1_score: 0.8739
Averaged Test Recal score: 0.8820
Std Test Accurancy: 0.0575
Std Test AUC: 0.0082
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4904 |Global loss: 2.0823| Local H loss: 0.0924  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4256 |Global loss: 1.092| Local H loss: 0.0422  | Global H loss: 0.0242 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4165 |Global loss: 0.9803| Local H loss: 0.0384  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3762 |Global loss: 0.9256| Local H loss: 0.0394  | Global H loss: 0.0231 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4201 |Global loss: 2.0544| Local H loss: 0.0922  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3595 |Global loss: 1.1251| Local H loss: 0.0509  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3294 |Global loss: 0.8713| Local H loss: 0.0435  | Global H loss: 0.025 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3087 |Global loss: 0.8015| Local H loss: 0.0395  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.391 |Global loss: 1.9934| Local H loss: 0.0952  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3231 |Global loss: 0.9639| Local H loss: 0.0488  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3109 |Global loss: 0.8717| Local H loss: 0.0463  | Global H loss: 0.0278 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2858 |Global loss: 0.7708| Local H loss: 0.048  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.583 |Global loss: 2.2661| Local H loss: 0.0906  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4922 |Global loss: 1.2549| Local H loss: 0.047  | Global H loss: 0.0253 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4697 |Global loss: 1.1349| Local H loss: 0.0429  | Global H loss: 0.0241 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4329 |Global loss: 0.9834| Local H loss: 0.0417  | Global H loss: 0.0221 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3691 |Global loss: 2.0862| Local H loss: 0.0964  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3066 |Global loss: 1.2072| Local H loss: 0.0598  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2756 |Global loss: 0.9103| Local H loss: 0.0563  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2871 |Global loss: 0.8434| Local H loss: 0.0535  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4493 |Global loss: 2.0987| Local H loss: 0.0923  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3865 |Global loss: 1.1875| Local H loss: 0.0654  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3876 |Global loss: 1.0263| Local H loss: 0.0522  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3693 |Global loss: 0.9582| Local H loss: 0.0494  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3726 |Global loss: 2.2316| Local H loss: 0.1023  | Global H loss: 0.0531 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2937 |Global loss: 1.0509| Local H loss: 0.0575  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2832 |Global loss: 0.7914| Local H loss: 0.0443  | Global H loss: 0.0276 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2828 |Global loss: 0.7193| Local H loss: 0.0395  | Global H loss: 0.0246 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.485 |Global loss: 2.2311| Local H loss: 0.0902  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4207 |Global loss: 1.1175| Local H loss: 0.0506  | Global H loss: 0.0275 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4033 |Global loss: 0.9879| Local H loss: 0.0401  | Global H loss: 0.0214 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3858 |Global loss: 0.967| Local H loss: 0.0439  | Global H loss: 0.0237 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4966 |Global loss: 2.2091| Local H loss: 0.0954  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4639 |Global loss: 1.512| Local H loss: 0.0727  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4399 |Global loss: 1.1948| Local H loss: 0.0621  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3967 |Global loss: 0.919| Local H loss: 0.0442  | Global H loss: 0.023 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3397 |Global loss: 1.9313| Local H loss: 0.0914  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2759 |Global loss: 0.949| Local H loss: 0.0562  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2777 |Global loss: 0.868| Local H loss: 0.0505  | Global H loss: 0.0326 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2578 |Global loss: 0.739| Local H loss: 0.047  | Global H loss: 0.0297 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3596 |Global loss: 2.2506| Local H loss: 0.0962  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2956 |Global loss: 1.2282| Local H loss: 0.0612  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.293 |Global loss: 1.1477| Local H loss: 0.058  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2802 |Global loss: 1.0117| Local H loss: 0.0555  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3968 |Global loss: 2.2333| Local H loss: 0.0982  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.33 |Global loss: 1.1117| Local H loss: 0.0602  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3256 |Global loss: 1.0255| Local H loss: 0.0579  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3191 |Global loss: 0.8859| Local H loss: 0.0489  | Global H loss: 0.0289 [0m
------------------------- time cost ------------------------- 6.460927963256836
Chosen Clients:  [22, 27, 23, 17, 12, 28, 1, 8, 10, 14, 4, 15]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.855, 0.965, 0.925, 0.868, 0.841, 0.792, 0.873, 0.778, 0.851, 0.962, 0.838, 0.915, 0.914, 0.939, 0.891, 0.859, 0.901, 0.956, 0.91, 0.922, 0.926, 0.882, 0.875, 0.951, 0.949, 0.957, 0.771, 0.942, 0.938]
AUC in each clients:  [86.352, 75.262, 85.406, 78.736, 75.322, 79.499, 75.795, 70.037, 69.116, 72.962, 78.601, 78.756, 81.496, 80.561, 81.602, 91.117, 90.487, 90.183, 89.529, 88.428, 101.496, 80.4, 92.47, 95.177, 102.301, 97.762, 93.801, 93.996, 85.255, 95.457]
F1 Score:  [0.914, 0.859, 0.965, 0.926, 0.842, 0.815, 0.775, 0.881, 0.753, 0.826, 0.963, 0.803, 0.905, 0.909, 0.938, 0.891, 0.79, 0.895, 0.933, 0.901, 0.886, 0.915, 0.84, 0.868, 0.931, 0.936, 0.94, 0.745, 0.917, 0.923]
Recall Score:  [0.899, 0.871, 0.967, 0.928, 0.844, 0.824, 0.776, 0.888, 0.755, 0.833, 0.963, 0.828, 0.905, 0.905, 0.943, 0.895, 0.83, 0.897, 0.934, 0.902, 0.897, 0.934, 0.847, 0.885, 0.931, 0.934, 0.935, 0.773, 0.951, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.2566
Averaged Test Accurancy: 0.8974
Averaged Test AUC: 0.9897
Averaged Test F1_score: 0.8795
Averaged Test Recal score: 0.8866
Std Test Accurancy: 0.0534
Std Test AUC: 0.0080
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3708 |Global loss: 2.0158| Local H loss: 0.095  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3247 |Global loss: 1.1626| Local H loss: 0.0591  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3141 |Global loss: 0.869| Local H loss: 0.0528  | Global H loss: 0.0301 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3188 |Global loss: 0.8624| Local H loss: 0.0525  | Global H loss: 0.0306 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4627 |Global loss: 2.1354| Local H loss: 0.0859  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.412 |Global loss: 1.2133| Local H loss: 0.0624  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3812 |Global loss: 0.9317| Local H loss: 0.0497  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3902 |Global loss: 0.8733| Local H loss: 0.0457  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3593 |Global loss: 1.9866| Local H loss: 0.096  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2941 |Global loss: 0.9749| Local H loss: 0.0558  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2794 |Global loss: 0.8411| Local H loss: 0.0527  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.264 |Global loss: 0.7227| Local H loss: 0.0467  | Global H loss: 0.0277 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4459 |Global loss: 2.0804| Local H loss: 0.092  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3897 |Global loss: 1.0582| Local H loss: 0.0499  | Global H loss: 0.0288 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3539 |Global loss: 1.0177| Local H loss: 0.0452  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.346 |Global loss: 0.9631| Local H loss: 0.0434  | Global H loss: 0.0262 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3364 |Global loss: 2.0957| Local H loss: 0.0941  | Global H loss: 0.0526 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2935 |Global loss: 1.1753| Local H loss: 0.0559  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2786 |Global loss: 1.0087| Local H loss: 0.0536  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2665 |Global loss: 0.9418| Local H loss: 0.0538  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3476 |Global loss: 2.1984| Local H loss: 0.1045  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2951 |Global loss: 1.121| Local H loss: 0.0637  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2628 |Global loss: 0.8503| Local H loss: 0.0544  | Global H loss: 0.0336 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2564 |Global loss: 0.7632| Local H loss: 0.0473  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3321 |Global loss: 2.0829| Local H loss: 0.1  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2793 |Global loss: 1.241| Local H loss: 0.0645  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2595 |Global loss: 0.9452| Local H loss: 0.0562  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.259 |Global loss: 0.9274| Local H loss: 0.0556  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.8179 |Global loss: 2.304| Local H loss: 0.0649  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7525 |Global loss: 1.4719| Local H loss: 0.0409  | Global H loss: 0.0217 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.7526 |Global loss: 1.1964| Local H loss: 0.0337  | Global H loss: 0.017 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.7121 |Global loss: 0.9937| Local H loss: 0.0299  | Global H loss: 0.0149 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3199 |Global loss: 2.1074| Local H loss: 0.1001  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2675 |Global loss: 1.0887| Local H loss: 0.0591  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2593 |Global loss: 0.9828| Local H loss: 0.0554  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2452 |Global loss: 0.774| Local H loss: 0.0535  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3504 |Global loss: 2.1288| Local H loss: 0.0981  | Global H loss: 0.0526 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2908 |Global loss: 1.072| Local H loss: 0.0586  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2883 |Global loss: 0.8458| Local H loss: 0.046  | Global H loss: 0.0302 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2645 |Global loss: 0.7689| Local H loss: 0.0505  | Global H loss: 0.0302 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3916 |Global loss: 2.1136| Local H loss: 0.0965  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3257 |Global loss: 1.2485| Local H loss: 0.0643  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3059 |Global loss: 0.9916| Local H loss: 0.0514  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2959 |Global loss: 0.8372| Local H loss: 0.0444  | Global H loss: 0.0275 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4491 |Global loss: 2.0949| Local H loss: 0.0943  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.379 |Global loss: 1.1936| Local H loss: 0.0635  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3923 |Global loss: 1.0456| Local H loss: 0.0609  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3476 |Global loss: 0.8596| Local H loss: 0.05  | Global H loss: 0.0265 [0m
------------------------- time cost ------------------------- 6.471196413040161
Chosen Clients:  [13, 26, 27, 22, 0, 17, 19, 21, 2, 25, 1, 23]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.868, 0.965, 0.925, 0.895, 0.841, 0.792, 0.873, 0.667, 0.851, 0.949, 0.838, 0.902, 0.914, 0.963, 0.891, 0.859, 0.967, 0.956, 0.91, 0.922, 0.926, 0.914, 0.917, 0.951, 0.949, 0.957, 0.802, 0.977, 0.938]
AUC in each clients:  [86.352, 75.336, 85.406, 78.736, 75.444, 79.499, 75.795, 70.037, 69.367, 72.962, 78.682, 78.756, 81.568, 80.561, 81.682, 91.212, 90.487, 90.381, 89.529, 88.428, 101.496, 80.4, 92.49, 95.105, 102.301, 97.762, 93.801, 94.204, 85.441, 95.457]
F1 Score:  [0.914, 0.871, 0.965, 0.926, 0.88, 0.815, 0.775, 0.881, 0.609, 0.826, 0.949, 0.803, 0.891, 0.909, 0.962, 0.892, 0.79, 0.961, 0.933, 0.901, 0.886, 0.915, 0.889, 0.908, 0.931, 0.936, 0.94, 0.782, 0.962, 0.923]
Recall Score:  [0.899, 0.891, 0.967, 0.928, 0.877, 0.824, 0.776, 0.888, 0.694, 0.833, 0.949, 0.828, 0.891, 0.905, 0.964, 0.897, 0.83, 0.962, 0.934, 0.902, 0.897, 0.934, 0.889, 0.925, 0.931, 0.934, 0.935, 0.794, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.2256
Averaged Test Accurancy: 0.9029
Averaged Test AUC: 0.9902
Averaged Test F1_score: 0.8842
Averaged Test Recal score: 0.8927
Std Test Accurancy: 0.0647
Std Test AUC: 0.0077
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4262 |Global loss: 2.1012| Local H loss: 0.0959  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3951 |Global loss: 1.1294| Local H loss: 0.054  | Global H loss: 0.0301 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3282 |Global loss: 0.8844| Local H loss: 0.0409  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3214 |Global loss: 0.7897| Local H loss: 0.0402  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3207 |Global loss: 1.8549| Local H loss: 0.0958  | Global H loss: 0.0522 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2716 |Global loss: 1.0033| Local H loss: 0.059  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2533 |Global loss: 0.8608| Local H loss: 0.0535  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2471 |Global loss: 0.8257| Local H loss: 0.0519  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4596 |Global loss: 2.1135| Local H loss: 0.0898  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3953 |Global loss: 1.0858| Local H loss: 0.0565  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4166 |Global loss: 1.0225| Local H loss: 0.0542  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3849 |Global loss: 0.9982| Local H loss: 0.0531  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3724 |Global loss: 2.16| Local H loss: 0.0987  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3141 |Global loss: 1.1771| Local H loss: 0.0608  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3041 |Global loss: 1.0571| Local H loss: 0.0569  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2982 |Global loss: 0.9738| Local H loss: 0.0567  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3945 |Global loss: 1.9996| Local H loss: 0.0937  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3119 |Global loss: 1.0247| Local H loss: 0.0505  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2983 |Global loss: 0.913| Local H loss: 0.0515  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2763 |Global loss: 0.7267| Local H loss: 0.043  | Global H loss: 0.0264 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3928 |Global loss: 1.9765| Local H loss: 0.0897  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3404 |Global loss: 1.1577| Local H loss: 0.0562  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3233 |Global loss: 0.9447| Local H loss: 0.0463  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3091 |Global loss: 0.9379| Local H loss: 0.0462  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3451 |Global loss: 2.0372| Local H loss: 0.0999  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.28 |Global loss: 1.0847| Local H loss: 0.0654  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2682 |Global loss: 1.028| Local H loss: 0.058  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2719 |Global loss: 0.8449| Local H loss: 0.054  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4103 |Global loss: 2.034| Local H loss: 0.0923  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3469 |Global loss: 0.961| Local H loss: 0.0524  | Global H loss: 0.0323 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.328 |Global loss: 0.8008| Local H loss: 0.0431  | Global H loss: 0.0256 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3035 |Global loss: 0.7404| Local H loss: 0.0417  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3325 |Global loss: 2.1386| Local H loss: 0.1062  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2767 |Global loss: 0.9324| Local H loss: 0.0627  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2852 |Global loss: 1.0356| Local H loss: 0.0576  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2558 |Global loss: 0.7966| Local H loss: 0.0521  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3296 |Global loss: 2.1126| Local H loss: 0.0913  | Global H loss: 0.0538 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2781 |Global loss: 1.0292| Local H loss: 0.0654  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2738 |Global loss: 0.9142| Local H loss: 0.0587  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2703 |Global loss: 0.8531| Local H loss: 0.0574  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3211 |Global loss: 2.1049| Local H loss: 0.0991  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2818 |Global loss: 1.4462| Local H loss: 0.0719  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2737 |Global loss: 1.1238| Local H loss: 0.064  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2587 |Global loss: 1.0546| Local H loss: 0.0562  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3429 |Global loss: 2.0254| Local H loss: 0.1046  | Global H loss: 0.0538 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2739 |Global loss: 0.984| Local H loss: 0.057  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2778 |Global loss: 0.7913| Local H loss: 0.0487  | Global H loss: 0.0297 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2584 |Global loss: 0.7669| Local H loss: 0.0492  | Global H loss: 0.0308 [0m
------------------------- time cost ------------------------- 7.864142417907715
Chosen Clients:  [26, 29, 14, 19, 25, 12, 3, 23, 7, 20, 10, 11]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.897, 0.882, 0.953, 0.925, 0.895, 0.841, 0.792, 0.873, 0.667, 0.851, 0.949, 0.838, 0.902, 0.926, 0.963, 0.891, 0.859, 0.879, 0.956, 0.921, 0.922, 0.901, 0.882, 0.896, 0.951, 0.959, 0.968, 0.771, 0.977, 0.938]
AUC in each clients:  [86.437, 75.34, 85.353, 78.736, 75.444, 79.499, 75.795, 70.037, 69.367, 72.962, 78.682, 78.756, 81.568, 80.657, 81.682, 91.212, 90.487, 90.421, 89.529, 88.495, 101.496, 80.475, 92.508, 95.305, 102.301, 97.727, 93.827, 94.153, 85.441, 95.457]
F1 Score:  [0.887, 0.885, 0.952, 0.926, 0.88, 0.815, 0.775, 0.881, 0.609, 0.826, 0.949, 0.803, 0.891, 0.926, 0.962, 0.892, 0.79, 0.867, 0.933, 0.915, 0.886, 0.868, 0.86, 0.887, 0.931, 0.949, 0.957, 0.746, 0.962, 0.923]
Recall Score:  [0.869, 0.902, 0.956, 0.928, 0.877, 0.824, 0.776, 0.888, 0.694, 0.833, 0.949, 0.828, 0.891, 0.924, 0.964, 0.897, 0.83, 0.869, 0.934, 0.916, 0.897, 0.906, 0.858, 0.901, 0.931, 0.949, 0.954, 0.769, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.1886
Averaged Test Accurancy: 0.8967
Averaged Test AUC: 0.9904
Averaged Test F1_score: 0.8778
Averaged Test Recal score: 0.8873
Std Test Accurancy: 0.0653
Std Test AUC: 0.0078
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3083 |Global loss: 2.0403| Local H loss: 0.0973  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2423 |Global loss: 0.8213| Local H loss: 0.0599  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2378 |Global loss: 0.6916| Local H loss: 0.0523  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2449 |Global loss: 0.8091| Local H loss: 0.0555  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3913 |Global loss: 2.1512| Local H loss: 0.0886  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.328 |Global loss: 1.1415| Local H loss: 0.0523  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3109 |Global loss: 0.9991| Local H loss: 0.0501  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3023 |Global loss: 0.9062| Local H loss: 0.0448  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.332 |Global loss: 2.1212| Local H loss: 0.0999  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.267 |Global loss: 0.8582| Local H loss: 0.0537  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2724 |Global loss: 0.868| Local H loss: 0.0579  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2593 |Global loss: 0.7957| Local H loss: 0.0455  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3148 |Global loss: 2.0073| Local H loss: 0.0979  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2627 |Global loss: 1.2128| Local H loss: 0.0591  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2544 |Global loss: 0.9892| Local H loss: 0.0506  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2505 |Global loss: 0.8596| Local H loss: 0.0515  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3313 |Global loss: 2.0743| Local H loss: 0.0981  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2795 |Global loss: 1.2565| Local H loss: 0.0704  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2586 |Global loss: 0.9893| Local H loss: 0.0603  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2679 |Global loss: 0.9216| Local H loss: 0.0548  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3327 |Global loss: 2.0747| Local H loss: 0.0957  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2614 |Global loss: 1.067| Local H loss: 0.0599  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2652 |Global loss: 1.0021| Local H loss: 0.0593  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.251 |Global loss: 0.9311| Local H loss: 0.054  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4941 |Global loss: 2.2144| Local H loss: 0.0931  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4331 |Global loss: 1.3386| Local H loss: 0.0505  | Global H loss: 0.0286 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4455 |Global loss: 1.1487| Local H loss: 0.0424  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3976 |Global loss: 1.0517| Local H loss: 0.0417  | Global H loss: 0.0244 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3369 |Global loss: 1.927| Local H loss: 0.1019  | Global H loss: 0.052 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.264 |Global loss: 0.9617| Local H loss: 0.0591  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2558 |Global loss: 0.8344| Local H loss: 0.053  | Global H loss: 0.0336 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2811 |Global loss: 0.8963| Local H loss: 0.0443  | Global H loss: 0.0298 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3544 |Global loss: 2.1473| Local H loss: 0.1005  | Global H loss: 0.0531 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2981 |Global loss: 0.937| Local H loss: 0.055  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2644 |Global loss: 0.7182| Local H loss: 0.0447  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2609 |Global loss: 0.7127| Local H loss: 0.0469  | Global H loss: 0.0289 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3022 |Global loss: 1.8061| Local H loss: 0.0916  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2638 |Global loss: 0.906| Local H loss: 0.0594  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2452 |Global loss: 0.7783| Local H loss: 0.0566  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2451 |Global loss: 0.7491| Local H loss: 0.0481  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3272 |Global loss: 2.1203| Local H loss: 0.1018  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2598 |Global loss: 0.922| Local H loss: 0.0632  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2541 |Global loss: 0.8614| Local H loss: 0.0543  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2582 |Global loss: 0.8955| Local H loss: 0.053  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.437 |Global loss: 2.604| Local H loss: 0.0894  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.377 |Global loss: 1.4363| Local H loss: 0.0573  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3609 |Global loss: 1.106| Local H loss: 0.051  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3363 |Global loss: 0.9336| Local H loss: 0.0503  | Global H loss: 0.0301 [0m
------------------------- time cost ------------------------- 7.517581462860107
Chosen Clients:  [25, 15, 18, 21, 20, 10, 0, 11, 22, 23, 6, 12]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.897, 0.882, 0.953, 0.9, 0.895, 0.841, 0.792, 0.789, 0.667, 0.851, 0.937, 0.887, 0.915, 0.926, 0.951, 0.891, 0.859, 0.879, 0.956, 0.933, 0.912, 0.901, 0.882, 0.896, 0.951, 0.959, 0.968, 0.771, 0.977, 0.938]
AUC in each clients:  [86.437, 75.34, 85.353, 78.984, 75.444, 79.499, 75.795, 70.101, 69.367, 72.962, 78.639, 78.945, 81.589, 80.657, 81.674, 91.212, 90.487, 90.421, 89.529, 88.516, 101.474, 80.475, 92.508, 95.33, 102.301, 97.853, 93.836, 94.153, 85.441, 95.521]
F1 Score:  [0.887, 0.885, 0.952, 0.899, 0.88, 0.815, 0.775, 0.794, 0.609, 0.826, 0.938, 0.87, 0.905, 0.926, 0.951, 0.892, 0.79, 0.867, 0.933, 0.925, 0.879, 0.868, 0.86, 0.887, 0.931, 0.951, 0.957, 0.746, 0.962, 0.923]
Recall Score:  [0.869, 0.902, 0.956, 0.903, 0.877, 0.824, 0.776, 0.803, 0.694, 0.833, 0.939, 0.879, 0.905, 0.924, 0.958, 0.897, 0.83, 0.869, 0.934, 0.925, 0.885, 0.906, 0.858, 0.901, 0.931, 0.951, 0.954, 0.769, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.1584
Averaged Test Accurancy: 0.8947
Averaged Test AUC: 0.9907
Averaged Test F1_score: 0.8761
Averaged Test Recal score: 0.8852
Std Test Accurancy: 0.0664
Std Test AUC: 0.0077
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3072 |Global loss: 1.9043| Local H loss: 0.0949  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2614 |Global loss: 1.0144| Local H loss: 0.0642  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2557 |Global loss: 0.9979| Local H loss: 0.0573  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2416 |Global loss: 0.7993| Local H loss: 0.0516  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4124 |Global loss: 2.1124| Local H loss: 0.0956  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3729 |Global loss: 1.0064| Local H loss: 0.0634  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3432 |Global loss: 0.806| Local H loss: 0.0516  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3415 |Global loss: 0.9003| Local H loss: 0.052  | Global H loss: 0.0296 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3327 |Global loss: 1.9098| Local H loss: 0.1028  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2713 |Global loss: 0.7177| Local H loss: 0.0557  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2432 |Global loss: 0.5429| Local H loss: 0.0424  | Global H loss: 0.0256 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2517 |Global loss: 0.6304| Local H loss: 0.0441  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3773 |Global loss: 1.931| Local H loss: 0.0917  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3265 |Global loss: 1.0673| Local H loss: 0.0579  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2987 |Global loss: 0.9022| Local H loss: 0.0491  | Global H loss: 0.0306 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2804 |Global loss: 0.7444| Local H loss: 0.0433  | Global H loss: 0.0262 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2911 |Global loss: 1.9831| Local H loss: 0.099  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2436 |Global loss: 0.9862| Local H loss: 0.0622  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2395 |Global loss: 0.848| Local H loss: 0.0544  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.232 |Global loss: 0.7263| Local H loss: 0.0511  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3245 |Global loss: 2.2129| Local H loss: 0.1084  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.26 |Global loss: 1.1709| Local H loss: 0.0692  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2501 |Global loss: 0.9382| Local H loss: 0.0598  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2457 |Global loss: 0.868| Local H loss: 0.0595  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3485 |Global loss: 1.9861| Local H loss: 0.0981  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2735 |Global loss: 0.9335| Local H loss: 0.0555  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2616 |Global loss: 0.7914| Local H loss: 0.0496  | Global H loss: 0.0311 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2616 |Global loss: 0.7369| Local H loss: 0.0458  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4079 |Global loss: 2.2348| Local H loss: 0.0903  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3708 |Global loss: 1.6269| Local H loss: 0.0629  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3277 |Global loss: 1.1415| Local H loss: 0.0579  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3181 |Global loss: 1.0366| Local H loss: 0.0523  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3472 |Global loss: 2.0019| Local H loss: 0.0877  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2987 |Global loss: 1.0922| Local H loss: 0.0571  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2904 |Global loss: 0.9761| Local H loss: 0.0507  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2745 |Global loss: 0.8573| Local H loss: 0.0523  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3212 |Global loss: 1.9994| Local H loss: 0.1075  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.249 |Global loss: 0.8579| Local H loss: 0.0633  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2486 |Global loss: 0.881| Local H loss: 0.056  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2416 |Global loss: 0.7573| Local H loss: 0.0518  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4443 |Global loss: 2.2671| Local H loss: 0.0943  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3753 |Global loss: 1.2328| Local H loss: 0.0559  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3478 |Global loss: 0.9778| Local H loss: 0.0469  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3281 |Global loss: 0.8758| Local H loss: 0.0433  | Global H loss: 0.0248 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3079 |Global loss: 2.0878| Local H loss: 0.0987  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2609 |Global loss: 1.1621| Local H loss: 0.0628  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2476 |Global loss: 0.969| Local H loss: 0.058  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2481 |Global loss: 0.9244| Local H loss: 0.0603  | Global H loss: 0.0399 [0m
------------------------- time cost ------------------------- 7.500871658325195
Chosen Clients:  [20, 3, 11, 15, 26, 17, 12, 21, 13, 28, 4, 25]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.882, 0.953, 0.9, 0.895, 0.841, 0.844, 0.789, 0.667, 0.851, 0.949, 0.9, 0.915, 0.926, 0.951, 0.87, 0.859, 0.879, 0.911, 0.933, 0.941, 0.926, 0.903, 0.875, 0.951, 0.969, 0.968, 0.771, 0.977, 0.938]
AUC in each clients:  [86.519, 75.34, 85.353, 78.984, 75.444, 79.499, 76.026, 70.101, 69.367, 72.962, 78.711, 79.068, 81.567, 80.657, 81.674, 91.246, 90.487, 90.421, 89.525, 88.516, 101.611, 80.641, 92.553, 95.25, 102.301, 97.886, 93.836, 94.153, 85.441, 95.521]
F1 Score:  [0.914, 0.885, 0.952, 0.899, 0.88, 0.815, 0.827, 0.794, 0.609, 0.826, 0.949, 0.889, 0.905, 0.926, 0.951, 0.864, 0.79, 0.867, 0.862, 0.925, 0.919, 0.915, 0.888, 0.866, 0.931, 0.958, 0.957, 0.746, 0.962, 0.923]
Recall Score:  [0.899, 0.902, 0.956, 0.903, 0.877, 0.824, 0.823, 0.803, 0.694, 0.833, 0.949, 0.892, 0.905, 0.924, 0.958, 0.873, 0.83, 0.869, 0.872, 0.925, 0.923, 0.934, 0.885, 0.885, 0.931, 0.957, 0.954, 0.769, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.1204
Averaged Test Accurancy: 0.8978
Averaged Test AUC: 0.9910
Averaged Test F1_score: 0.8798
Averaged Test Recal score: 0.8884
Std Test Accurancy: 0.0653
Std Test AUC: 0.0077
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2964 |Global loss: 1.7408| Local H loss: 0.0936  | Global H loss: 0.052 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2356 |Global loss: 0.9652| Local H loss: 0.0555  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2403 |Global loss: 0.7903| Local H loss: 0.0536  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2265 |Global loss: 0.7162| Local H loss: 0.0494  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4731 |Global loss: 2.2919| Local H loss: 0.1  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4224 |Global loss: 1.2544| Local H loss: 0.0576  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3987 |Global loss: 1.0622| Local H loss: 0.0477  | Global H loss: 0.0257 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.347 |Global loss: 0.8873| Local H loss: 0.0458  | Global H loss: 0.0254 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3585 |Global loss: 2.1587| Local H loss: 0.0916  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3071 |Global loss: 1.2125| Local H loss: 0.0585  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2931 |Global loss: 1.0595| Local H loss: 0.0552  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2889 |Global loss: 0.914| Local H loss: 0.0516  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4003 |Global loss: 2.0648| Local H loss: 0.0935  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3629 |Global loss: 1.2389| Local H loss: 0.0627  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3481 |Global loss: 1.0131| Local H loss: 0.0556  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.343 |Global loss: 1.0197| Local H loss: 0.0507  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3118 |Global loss: 2.0335| Local H loss: 0.0984  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2596 |Global loss: 0.9824| Local H loss: 0.0671  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2434 |Global loss: 0.8621| Local H loss: 0.056  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2278 |Global loss: 0.6976| Local H loss: 0.0516  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3759 |Global loss: 2.1492| Local H loss: 0.0933  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3152 |Global loss: 1.1371| Local H loss: 0.0599  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2977 |Global loss: 0.9635| Local H loss: 0.0489  | Global H loss: 0.0314 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3074 |Global loss: 1.0886| Local H loss: 0.0527  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3144 |Global loss: 2.0848| Local H loss: 0.1011  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2612 |Global loss: 1.3006| Local H loss: 0.0652  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2574 |Global loss: 1.1547| Local H loss: 0.0606  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2376 |Global loss: 0.9262| Local H loss: 0.0598  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3559 |Global loss: 2.1569| Local H loss: 0.099  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2928 |Global loss: 1.2001| Local H loss: 0.0564  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2522 |Global loss: 0.7187| Local H loss: 0.048  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2703 |Global loss: 0.769| Local H loss: 0.0431  | Global H loss: 0.0285 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4039 |Global loss: 2.1237| Local H loss: 0.0961  | Global H loss: 0.0497 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.369 |Global loss: 1.282| Local H loss: 0.058  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3209 |Global loss: 0.9412| Local H loss: 0.0522  | Global H loss: 0.0323 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3061 |Global loss: 0.8525| Local H loss: 0.0455  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3237 |Global loss: 1.9893| Local H loss: 0.1001  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2621 |Global loss: 1.1489| Local H loss: 0.0633  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2561 |Global loss: 0.9141| Local H loss: 0.0565  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2581 |Global loss: 0.8423| Local H loss: 0.0469  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3875 |Global loss: 2.2905| Local H loss: 0.0982  | Global H loss: 0.0525 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3252 |Global loss: 1.2908| Local H loss: 0.0612  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3057 |Global loss: 1.0242| Local H loss: 0.0566  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2949 |Global loss: 0.9428| Local H loss: 0.0511  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.308 |Global loss: 2.032| Local H loss: 0.0962  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2574 |Global loss: 1.0981| Local H loss: 0.0641  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2478 |Global loss: 0.9423| Local H loss: 0.0557  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2368 |Global loss: 0.7688| Local H loss: 0.0536  | Global H loss: 0.0351 [0m
------------------------- time cost ------------------------- 6.620952844619751
Chosen Clients:  [6, 16, 22, 26, 28, 23, 3, 8, 13, 17, 2, 7]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.882, 0.953, 0.963, 0.908, 0.841, 0.844, 0.789, 0.667, 0.851, 0.949, 0.85, 0.915, 0.926, 0.951, 0.913, 0.859, 0.945, 0.911, 0.933, 0.931, 0.914, 0.903, 0.875, 0.951, 0.959, 0.968, 0.771, 0.977, 0.938]
AUC in each clients:  [86.519, 75.34, 85.353, 79.164, 75.537, 79.499, 76.026, 70.101, 69.367, 72.962, 78.711, 78.973, 81.576, 80.667, 81.674, 91.314, 90.487, 90.575, 89.525, 88.516, 101.585, 80.448, 92.553, 95.25, 102.301, 97.853, 93.829, 94.153, 85.511, 95.521]
F1 Score:  [0.914, 0.885, 0.952, 0.963, 0.895, 0.815, 0.827, 0.794, 0.609, 0.826, 0.949, 0.825, 0.905, 0.926, 0.951, 0.917, 0.79, 0.933, 0.862, 0.925, 0.905, 0.879, 0.888, 0.866, 0.931, 0.943, 0.957, 0.746, 0.962, 0.923]
Recall Score:  [0.899, 0.902, 0.956, 0.963, 0.893, 0.824, 0.823, 0.803, 0.694, 0.833, 0.949, 0.84, 0.905, 0.924, 0.958, 0.921, 0.83, 0.933, 0.872, 0.925, 0.91, 0.924, 0.885, 0.885, 0.931, 0.94, 0.954, 0.769, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.0835
Averaged Test Accurancy: 0.9013
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.8821
Averaged Test Recal score: 0.8916
Std Test Accurancy: 0.0667
Std Test AUC: 0.0077
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3979 |Global loss: 2.1025| Local H loss: 0.0956  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3266 |Global loss: 1.0326| Local H loss: 0.0532  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3236 |Global loss: 0.9216| Local H loss: 0.0499  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3089 |Global loss: 0.8641| Local H loss: 0.0445  | Global H loss: 0.0275 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.586 |Global loss: 1.9825| Local H loss: 0.072  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5437 |Global loss: 1.3311| Local H loss: 0.0506  | Global H loss: 0.0296 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5255 |Global loss: 1.0294| Local H loss: 0.0403  | Global H loss: 0.0223 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4621 |Global loss: 0.7691| Local H loss: 0.0364  | Global H loss: 0.0204 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3507 |Global loss: 1.9222| Local H loss: 0.0916  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2851 |Global loss: 1.085| Local H loss: 0.0557  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3058 |Global loss: 1.0011| Local H loss: 0.0509  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2785 |Global loss: 0.8663| Local H loss: 0.0531  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3066 |Global loss: 1.9504| Local H loss: 0.1016  | Global H loss: 0.0549 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2393 |Global loss: 0.8279| Local H loss: 0.0569  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2323 |Global loss: 0.7964| Local H loss: 0.0529  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2395 |Global loss: 0.7429| Local H loss: 0.0513  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3222 |Global loss: 2.1963| Local H loss: 0.1077  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2636 |Global loss: 1.1751| Local H loss: 0.0658  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2457 |Global loss: 0.8588| Local H loss: 0.0563  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2315 |Global loss: 0.7303| Local H loss: 0.0487  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3274 |Global loss: 2.1045| Local H loss: 0.1004  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2506 |Global loss: 0.8563| Local H loss: 0.0584  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2464 |Global loss: 0.8275| Local H loss: 0.0557  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2405 |Global loss: 0.7291| Local H loss: 0.0538  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4352 |Global loss: 2.125| Local H loss: 0.0959  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4054 |Global loss: 1.36| Local H loss: 0.0539  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3466 |Global loss: 1.1306| Local H loss: 0.0484  | Global H loss: 0.0297 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3453 |Global loss: 1.1359| Local H loss: 0.0484  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.7568 |Global loss: 2.2402| Local H loss: 0.0742  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.7114 |Global loss: 1.4134| Local H loss: 0.0441  | Global H loss: 0.0243 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.6718 |Global loss: 1.1723| Local H loss: 0.0324  | Global H loss: 0.0178 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.6488 |Global loss: 1.0254| Local H loss: 0.0248  | Global H loss: 0.013 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.377 |Global loss: 2.1096| Local H loss: 0.0997  | Global H loss: 0.0518 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3314 |Global loss: 1.1034| Local H loss: 0.0601  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3143 |Global loss: 0.9924| Local H loss: 0.0557  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3178 |Global loss: 1.0244| Local H loss: 0.0535  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3434 |Global loss: 2.0454| Local H loss: 0.0956  | Global H loss: 0.0521 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3031 |Global loss: 1.1751| Local H loss: 0.0621  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2837 |Global loss: 1.0801| Local H loss: 0.0565  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2713 |Global loss: 0.8844| Local H loss: 0.0514  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3208 |Global loss: 2.0822| Local H loss: 0.1068  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2786 |Global loss: 1.3532| Local H loss: 0.0649  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2611 |Global loss: 0.9209| Local H loss: 0.0599  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.253 |Global loss: 0.897| Local H loss: 0.055  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3341 |Global loss: 2.1117| Local H loss: 0.1034  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.277 |Global loss: 0.9886| Local H loss: 0.057  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2564 |Global loss: 0.8935| Local H loss: 0.0525  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2423 |Global loss: 0.7557| Local H loss: 0.0456  | Global H loss: 0.0308 [0m
------------------------- time cost ------------------------- 7.296006202697754
Chosen Clients:  [22, 6, 14, 5, 1, 24, 21, 15, 0, 7, 3, 19]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.882, 0.977, 0.9, 0.908, 0.841, 0.831, 0.845, 0.694, 0.851, 0.949, 0.85, 0.915, 0.963, 0.951, 0.913, 0.87, 0.967, 0.911, 0.933, 0.931, 0.914, 0.892, 0.906, 0.951, 0.959, 0.968, 0.771, 0.988, 0.938]
AUC in each clients:  [86.519, 75.34, 85.5, 79.311, 75.537, 79.499, 76.05, 70.056, 69.705, 72.962, 78.711, 78.973, 81.576, 80.768, 81.674, 91.314, 90.875, 90.676, 89.525, 88.516, 101.585, 80.448, 92.503, 95.403, 102.301, 97.853, 93.837, 94.153, 85.614, 95.521]
F1 Score:  [0.914, 0.885, 0.979, 0.899, 0.895, 0.815, 0.816, 0.845, 0.665, 0.826, 0.949, 0.825, 0.905, 0.971, 0.951, 0.917, 0.816, 0.961, 0.862, 0.925, 0.905, 0.879, 0.876, 0.898, 0.931, 0.943, 0.957, 0.746, 0.98, 0.923]
Recall Score:  [0.899, 0.902, 0.978, 0.902, 0.893, 0.824, 0.817, 0.862, 0.686, 0.833, 0.949, 0.84, 0.905, 0.971, 0.958, 0.921, 0.844, 0.962, 0.872, 0.925, 0.91, 0.924, 0.872, 0.91, 0.931, 0.94, 0.954, 0.769, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.0519
Averaged Test Accurancy: 0.9056
Averaged Test AUC: 0.9916
Averaged Test F1_score: 0.8886
Averaged Test Recal score: 0.8956
Std Test Accurancy: 0.0629
Std Test AUC: 0.0072
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3491 |Global loss: 2.229| Local H loss: 0.1007  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.283 |Global loss: 1.1332| Local H loss: 0.0616  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2773 |Global loss: 1.0013| Local H loss: 0.0531  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2559 |Global loss: 0.9021| Local H loss: 0.0534  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3695 |Global loss: 2.0342| Local H loss: 0.0957  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3155 |Global loss: 1.0855| Local H loss: 0.0586  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3073 |Global loss: 1.0179| Local H loss: 0.0485  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2904 |Global loss: 0.9443| Local H loss: 0.0513  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3191 |Global loss: 2.1467| Local H loss: 0.1028  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2801 |Global loss: 1.1285| Local H loss: 0.0654  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2531 |Global loss: 0.9081| Local H loss: 0.0557  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2541 |Global loss: 0.8261| Local H loss: 0.0501  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6336 |Global loss: 2.0351| Local H loss: 0.0787  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5494 |Global loss: 1.0503| Local H loss: 0.0393  | Global H loss: 0.025 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5454 |Global loss: 0.9389| Local H loss: 0.034  | Global H loss: 0.0207 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5258 |Global loss: 0.8392| Local H loss: 0.0317  | Global H loss: 0.0186 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3017 |Global loss: 2.0848| Local H loss: 0.0957  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2588 |Global loss: 1.0067| Local H loss: 0.062  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2535 |Global loss: 1.0211| Local H loss: 0.0603  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2507 |Global loss: 0.9951| Local H loss: 0.0563  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4509 |Global loss: 2.0799| Local H loss: 0.0795  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4098 |Global loss: 1.2859| Local H loss: 0.0543  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3806 |Global loss: 1.0651| Local H loss: 0.0498  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3734 |Global loss: 1.0274| Local H loss: 0.0522  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3431 |Global loss: 2.0162| Local H loss: 0.0991  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2689 |Global loss: 0.9733| Local H loss: 0.055  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2566 |Global loss: 0.7833| Local H loss: 0.0466  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2503 |Global loss: 0.6757| Local H loss: 0.0434  | Global H loss: 0.0278 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3895 |Global loss: 2.1502| Local H loss: 0.0943  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3641 |Global loss: 1.4886| Local H loss: 0.0727  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3385 |Global loss: 1.0916| Local H loss: 0.0605  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3328 |Global loss: 1.028| Local H loss: 0.0597  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3261 |Global loss: 2.0949| Local H loss: 0.0936  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2844 |Global loss: 1.1621| Local H loss: 0.0692  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2576 |Global loss: 0.9003| Local H loss: 0.0567  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2428 |Global loss: 0.7471| Local H loss: 0.0492  | Global H loss: 0.0313 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3284 |Global loss: 2.1533| Local H loss: 0.1016  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2668 |Global loss: 1.1463| Local H loss: 0.0659  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2551 |Global loss: 0.8439| Local H loss: 0.0544  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2384 |Global loss: 0.7572| Local H loss: 0.0478  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4079 |Global loss: 2.2565| Local H loss: 0.1004  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3599 |Global loss: 1.9392| Local H loss: 0.078  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3273 |Global loss: 1.1223| Local H loss: 0.063  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3184 |Global loss: 1.0464| Local H loss: 0.0546  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3093 |Global loss: 1.9055| Local H loss: 0.0974  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2496 |Global loss: 0.9987| Local H loss: 0.0587  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2438 |Global loss: 0.8527| Local H loss: 0.05  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2334 |Global loss: 0.8403| Local H loss: 0.0523  | Global H loss: 0.037 [0m
------------------------- time cost ------------------------- 7.155043125152588
Chosen Clients:  [21, 2, 0, 1, 10, 15, 28, 12, 22, 8, 26, 7]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.92, 0.868, 0.977, 0.912, 0.908, 0.902, 0.831, 0.831, 0.694, 0.851, 0.949, 0.85, 0.915, 0.963, 0.963, 0.88, 0.87, 0.967, 0.911, 0.933, 0.931, 0.926, 0.903, 0.906, 0.971, 0.959, 0.968, 0.771, 0.988, 0.938]
AUC in each clients:  [86.553, 75.395, 85.5, 79.385, 75.537, 80.135, 76.143, 70.099, 69.705, 72.962, 78.711, 78.973, 81.576, 80.768, 81.754, 91.378, 90.875, 90.676, 89.525, 88.543, 101.585, 80.707, 92.582, 95.403, 102.511, 97.853, 93.837, 94.153, 85.614, 95.521]
F1 Score:  [0.914, 0.873, 0.979, 0.908, 0.895, 0.888, 0.813, 0.833, 0.665, 0.826, 0.949, 0.825, 0.905, 0.971, 0.962, 0.878, 0.816, 0.961, 0.862, 0.925, 0.905, 0.905, 0.873, 0.898, 0.963, 0.943, 0.957, 0.746, 0.98, 0.923]
Recall Score:  [0.899, 0.882, 0.978, 0.911, 0.893, 0.89, 0.809, 0.85, 0.686, 0.833, 0.949, 0.84, 0.905, 0.971, 0.964, 0.885, 0.844, 0.962, 0.872, 0.925, 0.91, 0.934, 0.875, 0.91, 0.962, 0.94, 0.954, 0.769, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.0211
Averaged Test Accurancy: 0.9079
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.8914
Averaged Test Recal score: 0.8972
Std Test Accurancy: 0.0637
Std Test AUC: 0.0066
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3198 |Global loss: 2.0203| Local H loss: 0.0973  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2644 |Global loss: 1.0636| Local H loss: 0.0622  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.25 |Global loss: 0.7903| Local H loss: 0.0471  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2352 |Global loss: 0.7565| Local H loss: 0.0492  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3088 |Global loss: 1.9733| Local H loss: 0.1024  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2668 |Global loss: 1.1215| Local H loss: 0.0708  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2541 |Global loss: 0.9784| Local H loss: 0.0587  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2384 |Global loss: 0.7949| Local H loss: 0.055  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3139 |Global loss: 1.9898| Local H loss: 0.099  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2576 |Global loss: 0.9587| Local H loss: 0.0601  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2526 |Global loss: 0.9011| Local H loss: 0.0588  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2431 |Global loss: 0.835| Local H loss: 0.0546  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3173 |Global loss: 2.2654| Local H loss: 0.1013  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2662 |Global loss: 1.3395| Local H loss: 0.0713  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2484 |Global loss: 1.0305| Local H loss: 0.0637  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2512 |Global loss: 1.0385| Local H loss: 0.0599  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.302 |Global loss: 2.1654| Local H loss: 0.1019  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2486 |Global loss: 1.1268| Local H loss: 0.0622  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2482 |Global loss: 0.9657| Local H loss: 0.0608  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2296 |Global loss: 0.8387| Local H loss: 0.0536  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4172 |Global loss: 2.0696| Local H loss: 0.0942  | Global H loss: 0.0514 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.347 |Global loss: 1.0878| Local H loss: 0.0606  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3291 |Global loss: 0.9323| Local H loss: 0.0575  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3234 |Global loss: 0.8971| Local H loss: 0.0521  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2987 |Global loss: 1.9518| Local H loss: 0.1019  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.256 |Global loss: 0.9814| Local H loss: 0.0587  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2408 |Global loss: 0.8533| Local H loss: 0.0575  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.7043| Local H loss: 0.0497  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2971 |Global loss: 2.0076| Local H loss: 0.1004  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2528 |Global loss: 1.1957| Local H loss: 0.0648  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2409 |Global loss: 0.9337| Local H loss: 0.0582  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2383 |Global loss: 0.8822| Local H loss: 0.0572  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3231 |Global loss: 1.9617| Local H loss: 0.0985  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2796 |Global loss: 1.1245| Local H loss: 0.0567  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2672 |Global loss: 0.9066| Local H loss: 0.0553  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2617 |Global loss: 0.9129| Local H loss: 0.0541  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6946 |Global loss: 2.2297| Local H loss: 0.0806  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6179 |Global loss: 1.3601| Local H loss: 0.0426  | Global H loss: 0.0224 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.633 |Global loss: 1.3144| Local H loss: 0.0379  | Global H loss: 0.0212 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5863 |Global loss: 1.0217| Local H loss: 0.0306  | Global H loss: 0.0165 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.296 |Global loss: 1.9185| Local H loss: 0.1031  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2494 |Global loss: 1.0414| Local H loss: 0.0611  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2246 |Global loss: 0.8383| Local H loss: 0.0505  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2211 |Global loss: 0.6757| Local H loss: 0.0468  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3226 |Global loss: 2.1692| Local H loss: 0.1052  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2572 |Global loss: 1.0714| Local H loss: 0.0621  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2481 |Global loss: 0.8533| Local H loss: 0.0543  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2331 |Global loss: 0.7424| Local H loss: 0.0501  | Global H loss: 0.0344 [0m
------------------------- time cost ------------------------- 7.706267595291138
Chosen Clients:  [16, 9, 12, 5, 13, 11, 4, 6, 7, 2, 23, 3]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.912, 0.908, 0.902, 0.831, 0.845, 0.778, 0.851, 0.949, 0.85, 0.915, 0.963, 0.963, 0.891, 0.87, 0.967, 0.911, 0.933, 0.931, 0.938, 0.935, 0.906, 0.971, 0.959, 0.968, 0.771, 0.988, 0.938]
AUC in each clients:  [86.594, 75.432, 85.443, 79.385, 75.537, 80.135, 76.143, 70.246, 69.904, 72.962, 78.743, 78.973, 81.635, 80.768, 81.754, 91.326, 90.875, 90.676, 89.525, 88.543, 101.585, 80.749, 92.564, 95.403, 102.511, 97.853, 93.873, 94.153, 85.668, 95.521]
F1 Score:  [0.939, 0.873, 0.956, 0.908, 0.895, 0.888, 0.813, 0.851, 0.717, 0.826, 0.949, 0.825, 0.905, 0.971, 0.962, 0.891, 0.816, 0.961, 0.862, 0.925, 0.905, 0.918, 0.917, 0.898, 0.963, 0.943, 0.957, 0.746, 0.989, 0.923]
Recall Score:  [0.928, 0.886, 0.957, 0.911, 0.893, 0.89, 0.809, 0.859, 0.732, 0.833, 0.949, 0.84, 0.905, 0.971, 0.964, 0.897, 0.844, 0.962, 0.872, 0.925, 0.91, 0.944, 0.917, 0.91, 0.962, 0.94, 0.954, 0.769, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 11.0001
Averaged Test Accurancy: 0.9125
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.8964
Averaged Test Recal score: 0.9016
Std Test Accurancy: 0.0549
Std Test AUC: 0.0063
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5048 |Global loss: 1.9072| Local H loss: 0.0824  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4589 |Global loss: 1.0803| Local H loss: 0.0526  | Global H loss: 0.0296 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.411 |Global loss: 0.9028| Local H loss: 0.0422  | Global H loss: 0.0242 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3735 |Global loss: 0.733| Local H loss: 0.0347  | Global H loss: 0.0206 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4463 |Global loss: 2.4802| Local H loss: 0.0859  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4097 |Global loss: 1.5303| Local H loss: 0.062  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3483 |Global loss: 1.1001| Local H loss: 0.0524  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3501 |Global loss: 0.88| Local H loss: 0.0489  | Global H loss: 0.0289 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3104 |Global loss: 2.1787| Local H loss: 0.1012  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2553 |Global loss: 1.4305| Local H loss: 0.0662  | Global H loss: 0.0505 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2534 |Global loss: 1.1671| Local H loss: 0.0604  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.241 |Global loss: 1.0054| Local H loss: 0.0598  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.537 |Global loss: 2.185| Local H loss: 0.0917  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4691 |Global loss: 1.1907| Local H loss: 0.0492  | Global H loss: 0.0262 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4589 |Global loss: 0.9004| Local H loss: 0.036  | Global H loss: 0.0192 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4161 |Global loss: 0.7721| Local H loss: 0.0295  | Global H loss: 0.0173 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3684 |Global loss: 2.0955| Local H loss: 0.0972  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.323 |Global loss: 1.0784| Local H loss: 0.056  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3049 |Global loss: 0.7908| Local H loss: 0.0475  | Global H loss: 0.0282 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2828 |Global loss: 0.6984| Local H loss: 0.0437  | Global H loss: 0.0268 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3584 |Global loss: 2.1808| Local H loss: 0.0989  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3003 |Global loss: 1.2979| Local H loss: 0.0672  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2894 |Global loss: 1.0919| Local H loss: 0.0574  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.281 |Global loss: 0.9353| Local H loss: 0.0563  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3577 |Global loss: 2.0925| Local H loss: 0.0941  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.306 |Global loss: 1.0946| Local H loss: 0.0618  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3143 |Global loss: 0.9996| Local H loss: 0.0558  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2833 |Global loss: 0.8343| Local H loss: 0.0501  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.391 |Global loss: 2.0783| Local H loss: 0.1003  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3069 |Global loss: 1.1561| Local H loss: 0.0548  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2744 |Global loss: 0.889| Local H loss: 0.0534  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2796 |Global loss: 0.9154| Local H loss: 0.0527  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3126 |Global loss: 2.1376| Local H loss: 0.1032  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2537 |Global loss: 0.9909| Local H loss: 0.0623  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2378 |Global loss: 0.7619| Local H loss: 0.0511  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2374 |Global loss: 0.825| Local H loss: 0.0497  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3007 |Global loss: 2.0101| Local H loss: 0.1056  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2561 |Global loss: 0.9841| Local H loss: 0.0674  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2561 |Global loss: 0.9557| Local H loss: 0.0585  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2462 |Global loss: 0.9037| Local H loss: 0.0592  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3101 |Global loss: 1.9852| Local H loss: 0.105  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2458 |Global loss: 0.96| Local H loss: 0.0565  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2318 |Global loss: 0.8365| Local H loss: 0.0549  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2334 |Global loss: 0.7413| Local H loss: 0.0482  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3913 |Global loss: 2.3753| Local H loss: 0.0996  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3226 |Global loss: 1.5498| Local H loss: 0.0678  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2937 |Global loss: 1.026| Local H loss: 0.0564  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2958 |Global loss: 0.9385| Local H loss: 0.0495  | Global H loss: 0.0314 [0m
------------------------- time cost ------------------------- 6.947261571884155
Chosen Clients:  [26, 29, 7, 0, 15, 8, 21, 27, 14, 20, 6, 24]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.947, 0.951, 0.844, 0.859, 0.778, 0.797, 0.949, 0.9, 0.927, 0.951, 0.963, 0.891, 0.924, 0.967, 0.911, 0.933, 0.931, 0.938, 0.935, 0.906, 0.971, 0.959, 0.968, 0.771, 0.988, 0.938]
AUC in each clients:  [86.594, 75.432, 85.511, 79.407, 75.609, 80.588, 76.222, 70.202, 69.904, 72.835, 78.743, 79.089, 81.642, 80.74, 81.754, 91.326, 91.223, 90.676, 89.525, 88.543, 101.585, 80.749, 92.564, 95.377, 102.511, 97.853, 93.873, 94.153, 85.668, 95.521]
F1 Score:  [0.939, 0.873, 0.965, 0.96, 0.942, 0.938, 0.822, 0.863, 0.717, 0.779, 0.949, 0.891, 0.92, 0.952, 0.962, 0.891, 0.91, 0.961, 0.862, 0.925, 0.905, 0.918, 0.917, 0.898, 0.963, 0.943, 0.957, 0.746, 0.989, 0.923]
Recall Score:  [0.928, 0.886, 0.967, 0.964, 0.943, 0.937, 0.821, 0.875, 0.732, 0.788, 0.949, 0.892, 0.919, 0.952, 0.964, 0.897, 0.913, 0.962, 0.872, 0.925, 0.91, 0.944, 0.917, 0.913, 0.962, 0.94, 0.954, 0.769, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.9718
Averaged Test Accurancy: 0.9199
Averaged Test AUC: 0.9928
Averaged Test F1_score: 0.9060
Averaged Test Recal score: 0.9103
Std Test Accurancy: 0.0564
Std Test AUC: 0.0059
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.292 |Global loss: 1.9244| Local H loss: 0.1008  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2523 |Global loss: 1.1978| Local H loss: 0.0673  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2304 |Global loss: 0.8224| Local H loss: 0.0576  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2278 |Global loss: 0.7846| Local H loss: 0.0502  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.366 |Global loss: 2.1491| Local H loss: 0.0949  | Global H loss: 0.0527 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3108 |Global loss: 1.3163| Local H loss: 0.0621  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2931 |Global loss: 1.1025| Local H loss: 0.0588  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2783 |Global loss: 0.9999| Local H loss: 0.0554  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3076 |Global loss: 2.1164| Local H loss: 0.1041  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2584 |Global loss: 1.1136| Local H loss: 0.0626  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2377 |Global loss: 0.8318| Local H loss: 0.0571  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.7373| Local H loss: 0.0522  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3055 |Global loss: 2.1052| Local H loss: 0.0998  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2515 |Global loss: 1.1032| Local H loss: 0.0645  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2383 |Global loss: 0.8842| Local H loss: 0.0559  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2391 |Global loss: 0.7783| Local H loss: 0.0514  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3708 |Global loss: 2.0424| Local H loss: 0.0943  | Global H loss: 0.0525 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3517 |Global loss: 1.2604| Local H loss: 0.0724  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3355 |Global loss: 1.0751| Local H loss: 0.0599  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3308 |Global loss: 1.0318| Local H loss: 0.0561  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6584 |Global loss: 2.3195| Local H loss: 0.0823  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.6181 |Global loss: 1.2938| Local H loss: 0.0459  | Global H loss: 0.0236 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.558 |Global loss: 1.1168| Local H loss: 0.0325  | Global H loss: 0.0181 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5387 |Global loss: 0.9035| Local H loss: 0.028  | Global H loss: 0.0143 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3123 |Global loss: 1.977| Local H loss: 0.1008  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2402 |Global loss: 0.8482| Local H loss: 0.0549  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2373 |Global loss: 0.7666| Local H loss: 0.0537  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.694| Local H loss: 0.0442  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4325 |Global loss: 2.2509| Local H loss: 0.0904  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4219 |Global loss: 1.3495| Local H loss: 0.0669  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3943 |Global loss: 0.967| Local H loss: 0.0526  | Global H loss: 0.028 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3801 |Global loss: 0.927| Local H loss: 0.0465  | Global H loss: 0.0251 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3182 |Global loss: 2.108| Local H loss: 0.1006  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2558 |Global loss: 0.9895| Local H loss: 0.0606  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2473 |Global loss: 0.8698| Local H loss: 0.0549  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2437 |Global loss: 0.7998| Local H loss: 0.0548  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.6835| Local H loss: 0.0944  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2411 |Global loss: 0.9272| Local H loss: 0.0592  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2198 |Global loss: 0.7498| Local H loss: 0.054  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.7501| Local H loss: 0.0508  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3412 |Global loss: 2.1272| Local H loss: 0.1021  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2936 |Global loss: 1.1306| Local H loss: 0.0607  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2771 |Global loss: 0.989| Local H loss: 0.0536  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2707 |Global loss: 0.9378| Local H loss: 0.0549  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4109 |Global loss: 2.1147| Local H loss: 0.0882  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3691 |Global loss: 1.5496| Local H loss: 0.0679  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3455 |Global loss: 1.2181| Local H loss: 0.0606  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3433 |Global loss: 1.0119| Local H loss: 0.052  | Global H loss: 0.0295 [0m
------------------------- time cost ------------------------- 7.712370872497559
Chosen Clients:  [10, 21, 5, 6, 29, 0, 22, 19, 11, 8, 26, 24]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.931, 0.868, 0.965, 0.963, 0.947, 0.951, 0.844, 0.831, 0.694, 0.797, 0.949, 0.9, 0.927, 0.951, 0.939, 0.891, 0.924, 0.967, 0.911, 0.933, 0.961, 0.926, 0.935, 0.906, 0.971, 0.959, 0.979, 0.688, 0.988, 0.938]
AUC in each clients:  [86.634, 75.432, 85.511, 79.407, 75.609, 80.588, 76.248, 70.232, 70.056, 72.835, 78.743, 79.089, 81.642, 80.74, 81.728, 91.292, 91.223, 90.676, 89.525, 88.543, 101.602, 80.745, 92.564, 95.377, 102.737, 97.853, 93.87, 94.171, 85.668, 95.652]
F1 Score:  [0.923, 0.873, 0.965, 0.96, 0.942, 0.938, 0.826, 0.834, 0.656, 0.779, 0.949, 0.891, 0.92, 0.952, 0.938, 0.891, 0.91, 0.961, 0.862, 0.925, 0.949, 0.905, 0.917, 0.898, 0.964, 0.943, 0.966, 0.678, 0.989, 0.923]
Recall Score:  [0.911, 0.886, 0.967, 0.964, 0.943, 0.937, 0.823, 0.843, 0.673, 0.788, 0.949, 0.892, 0.919, 0.952, 0.948, 0.897, 0.913, 0.962, 0.872, 0.925, 0.949, 0.934, 0.917, 0.913, 0.959, 0.94, 0.963, 0.697, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.9162
Averaged Test Accurancy: 0.9137
Averaged Test AUC: 0.9930
Averaged Test F1_score: 0.9009
Averaged Test Recal score: 0.9050
Std Test Accurancy: 0.0731
Std Test AUC: 0.0057
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3006 |Global loss: 1.9831| Local H loss: 0.1  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2523 |Global loss: 1.1025| Local H loss: 0.0699  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2443 |Global loss: 0.9482| Local H loss: 0.0564  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2397 |Global loss: 0.9123| Local H loss: 0.0579  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3074 |Global loss: 1.9954| Local H loss: 0.1024  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.237 |Global loss: 0.9824| Local H loss: 0.0573  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2337 |Global loss: 0.7975| Local H loss: 0.0557  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2273 |Global loss: 0.6996| Local H loss: 0.0526  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4892 |Global loss: 1.9932| Local H loss: 0.0932  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4229 |Global loss: 1.3623| Local H loss: 0.0539  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3973 |Global loss: 1.1062| Local H loss: 0.0451  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4058 |Global loss: 0.9395| Local H loss: 0.0358  | Global H loss: 0.02 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3261 |Global loss: 2.0599| Local H loss: 0.103  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2898 |Global loss: 1.2992| Local H loss: 0.0631  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2644 |Global loss: 0.8647| Local H loss: 0.0523  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2445 |Global loss: 0.8701| Local H loss: 0.0521  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3179 |Global loss: 1.9331| Local H loss: 0.0876  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2834 |Global loss: 1.0644| Local H loss: 0.0579  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2593 |Global loss: 0.9355| Local H loss: 0.0513  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2527 |Global loss: 0.7911| Local H loss: 0.0526  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2997 |Global loss: 1.9927| Local H loss: 0.0978  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2574 |Global loss: 1.0925| Local H loss: 0.0606  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2438 |Global loss: 0.895| Local H loss: 0.0569  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2374 |Global loss: 0.8167| Local H loss: 0.0595  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3193 |Global loss: 1.9523| Local H loss: 0.0932  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2706 |Global loss: 1.0539| Local H loss: 0.0583  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2577 |Global loss: 0.9698| Local H loss: 0.0532  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.258 |Global loss: 0.9013| Local H loss: 0.053  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3222 |Global loss: 1.9511| Local H loss: 0.101  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2584 |Global loss: 1.0473| Local H loss: 0.0608  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2396 |Global loss: 0.8969| Local H loss: 0.055  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2318 |Global loss: 0.8532| Local H loss: 0.0509  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.341 |Global loss: 2.2184| Local H loss: 0.0967  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2829 |Global loss: 1.184| Local H loss: 0.063  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2865 |Global loss: 1.1227| Local H loss: 0.0594  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2646 |Global loss: 0.9647| Local H loss: 0.0542  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.6136 |Global loss: 2.1962| Local H loss: 0.0873  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.568 |Global loss: 1.6085| Local H loss: 0.0585  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.5493 |Global loss: 1.3168| Local H loss: 0.0521  | Global H loss: 0.0245 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.5202 |Global loss: 1.1292| Local H loss: 0.0451  | Global H loss: 0.0215 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2875 |Global loss: 1.8855| Local H loss: 0.1  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2456 |Global loss: 0.9861| Local H loss: 0.0638  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.238 |Global loss: 0.814| Local H loss: 0.0549  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2181 |Global loss: 0.729| Local H loss: 0.0505  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3745 |Global loss: 1.9427| Local H loss: 0.0868  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3211 |Global loss: 1.2682| Local H loss: 0.0621  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3123 |Global loss: 1.0871| Local H loss: 0.0594  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2912 |Global loss: 1.0216| Local H loss: 0.0573  | Global H loss: 0.0355 [0m
------------------------- time cost ------------------------- 7.985511064529419
Chosen Clients:  [7, 12, 17, 21, 23, 14, 13, 9, 28, 29, 25, 4]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.947, 0.939, 0.87, 0.831, 0.722, 0.797, 0.949, 0.887, 0.927, 0.951, 0.939, 0.891, 0.924, 0.967, 0.911, 0.933, 0.961, 0.938, 0.903, 0.906, 0.981, 0.959, 0.957, 0.688, 0.988, 0.948]
AUC in each clients:  [86.654, 75.432, 85.511, 79.407, 75.609, 80.844, 76.27, 70.232, 70.284, 72.835, 78.749, 79.202, 81.642, 80.74, 81.728, 91.292, 91.223, 90.676, 89.525, 88.594, 101.602, 80.753, 92.556, 95.377, 102.795, 97.853, 93.838, 94.171, 85.668, 95.654]
F1 Score:  [0.939, 0.873, 0.965, 0.96, 0.942, 0.926, 0.85, 0.834, 0.682, 0.779, 0.949, 0.876, 0.92, 0.952, 0.938, 0.891, 0.91, 0.961, 0.862, 0.926, 0.949, 0.912, 0.873, 0.898, 0.975, 0.943, 0.936, 0.678, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.967, 0.964, 0.943, 0.914, 0.849, 0.843, 0.697, 0.788, 0.949, 0.879, 0.919, 0.952, 0.948, 0.897, 0.913, 0.962, 0.872, 0.926, 0.949, 0.944, 0.875, 0.913, 0.972, 0.94, 0.931, 0.697, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.9046
Averaged Test Accurancy: 0.9141
Averaged Test AUC: 0.9933
Averaged Test F1_score: 0.9007
Averaged Test Recal score: 0.9048
Std Test Accurancy: 0.0697
Std Test AUC: 0.0052
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2991 |Global loss: 2.1585| Local H loss: 0.1065  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2438 |Global loss: 1.0431| Local H loss: 0.0645  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2298 |Global loss: 0.8123| Local H loss: 0.0577  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2214 |Global loss: 0.7172| Local H loss: 0.0499  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2939 |Global loss: 1.9848| Local H loss: 0.0977  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2503 |Global loss: 0.9898| Local H loss: 0.0637  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2351 |Global loss: 0.9344| Local H loss: 0.0596  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2342 |Global loss: 0.9048| Local H loss: 0.0557  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.342 |Global loss: 2.1349| Local H loss: 0.0981  | Global H loss: 0.0538 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.298 |Global loss: 1.3536| Local H loss: 0.0635  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2851 |Global loss: 1.0861| Local H loss: 0.063  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2734 |Global loss: 1.0782| Local H loss: 0.0559  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3033 |Global loss: 2.0792| Local H loss: 0.0999  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2378 |Global loss: 0.8225| Local H loss: 0.0579  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2274 |Global loss: 0.8014| Local H loss: 0.0546  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2248 |Global loss: 0.7132| Local H loss: 0.0485  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3036 |Global loss: 1.8484| Local H loss: 0.0981  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2472 |Global loss: 0.9311| Local H loss: 0.057  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2301 |Global loss: 0.8442| Local H loss: 0.051  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2379 |Global loss: 0.7743| Local H loss: 0.0549  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3126 |Global loss: 2.0987| Local H loss: 0.1058  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2636 |Global loss: 1.1719| Local H loss: 0.0649  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2507 |Global loss: 0.9235| Local H loss: 0.058  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2536 |Global loss: 0.8869| Local H loss: 0.0545  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3679 |Global loss: 2.0787| Local H loss: 0.0957  | Global H loss: 0.0516 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3218 |Global loss: 1.2352| Local H loss: 0.0575  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2816 |Global loss: 0.8758| Local H loss: 0.0513  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2759 |Global loss: 0.7908| Local H loss: 0.048  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4159 |Global loss: 2.243| Local H loss: 0.091  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3908 |Global loss: 1.49| Local H loss: 0.0671  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3552 |Global loss: 1.0386| Local H loss: 0.0636  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3357 |Global loss: 0.966| Local H loss: 0.0503  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3009 |Global loss: 1.9945| Local H loss: 0.1015  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2516 |Global loss: 1.1531| Local H loss: 0.0679  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2241 |Global loss: 0.7342| Local H loss: 0.0506  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2295 |Global loss: 0.7461| Local H loss: 0.0533  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3156 |Global loss: 2.0611| Local H loss: 0.0956  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.275 |Global loss: 1.3311| Local H loss: 0.0655  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.258 |Global loss: 1.0999| Local H loss: 0.0573  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2475 |Global loss: 0.9955| Local H loss: 0.0567  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3045 |Global loss: 1.9657| Local H loss: 0.0962  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2575 |Global loss: 1.1199| Local H loss: 0.0661  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2466 |Global loss: 0.8878| Local H loss: 0.0577  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2323 |Global loss: 0.7653| Local H loss: 0.0521  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3499 |Global loss: 2.1649| Local H loss: 0.0988  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2932 |Global loss: 1.1666| Local H loss: 0.0609  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2985 |Global loss: 1.1136| Local H loss: 0.0573  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2642 |Global loss: 0.9092| Local H loss: 0.0547  | Global H loss: 0.0352 [0m
------------------------- time cost ------------------------- 7.728977918624878
Chosen Clients:  [13, 9, 5, 19, 23, 10, 24, 4, 22, 12, 28, 0]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.908, 0.939, 0.87, 0.859, 0.722, 0.851, 0.949, 0.887, 0.927, 0.926, 0.963, 0.891, 0.924, 0.956, 0.911, 0.933, 0.961, 0.938, 0.903, 0.917, 0.981, 0.959, 0.957, 0.688, 0.988, 0.958]
AUC in each clients:  [86.654, 75.432, 85.511, 79.407, 75.548, 80.844, 76.27, 70.269, 70.284, 73.031, 78.749, 79.202, 81.654, 80.695, 81.788, 91.292, 91.223, 90.722, 89.525, 88.594, 101.602, 80.738, 92.556, 95.277, 102.795, 97.888, 93.838, 94.171, 85.701, 95.69]
F1 Score:  [0.939, 0.873, 0.965, 0.96, 0.895, 0.926, 0.85, 0.863, 0.682, 0.832, 0.949, 0.876, 0.92, 0.933, 0.96, 0.891, 0.91, 0.947, 0.862, 0.926, 0.949, 0.912, 0.873, 0.91, 0.975, 0.951, 0.936, 0.678, 0.98, 0.947]
Recall Score:  [0.928, 0.886, 0.967, 0.964, 0.893, 0.914, 0.849, 0.875, 0.697, 0.835, 0.949, 0.879, 0.919, 0.935, 0.964, 0.897, 0.913, 0.948, 0.872, 0.926, 0.949, 0.944, 0.875, 0.925, 0.972, 0.951, 0.931, 0.697, 0.991, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.8606
Averaged Test Accurancy: 0.9156
Averaged Test AUC: 0.9934
Averaged Test F1_score: 0.9023
Averaged Test Recal score: 0.9065
Std Test Accurancy: 0.0662
Std Test AUC: 0.0051
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3542 |Global loss: 2.0821| Local H loss: 0.096  | Global H loss: 0.0524 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2974 |Global loss: 1.0914| Local H loss: 0.0667  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2918 |Global loss: 0.9824| Local H loss: 0.0518  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2818 |Global loss: 0.8475| Local H loss: 0.0478  | Global H loss: 0.0303 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4089 |Global loss: 2.4338| Local H loss: 0.0905  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3941 |Global loss: 1.7662| Local H loss: 0.0725  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3772 |Global loss: 1.4593| Local H loss: 0.0651  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3627 |Global loss: 1.2939| Local H loss: 0.0667  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4399 |Global loss: 2.2887| Local H loss: 0.0976  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3499 |Global loss: 1.076| Local H loss: 0.057  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3246 |Global loss: 0.9105| Local H loss: 0.0482  | Global H loss: 0.0285 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.317 |Global loss: 0.7762| Local H loss: 0.0414  | Global H loss: 0.0242 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2965 |Global loss: 1.8958| Local H loss: 0.0983  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2365 |Global loss: 0.9448| Local H loss: 0.056  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2369 |Global loss: 0.8752| Local H loss: 0.0565  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2268 |Global loss: 0.7795| Local H loss: 0.0499  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3033 |Global loss: 1.8229| Local H loss: 0.1061  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2399 |Global loss: 0.8454| Local H loss: 0.0616  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2284 |Global loss: 0.7372| Local H loss: 0.049  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2232 |Global loss: 0.7291| Local H loss: 0.0483  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2909 |Global loss: 2.0492| Local H loss: 0.1005  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2477 |Global loss: 1.0545| Local H loss: 0.0653  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.237 |Global loss: 0.9963| Local H loss: 0.0589  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.8303| Local H loss: 0.0527  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3299 |Global loss: 2.1232| Local H loss: 0.0944  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2939 |Global loss: 1.3159| Local H loss: 0.0658  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2853 |Global loss: 1.1051| Local H loss: 0.0651  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2822 |Global loss: 0.9658| Local H loss: 0.0613  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3376 |Global loss: 2.1002| Local H loss: 0.0996  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2885 |Global loss: 1.2247| Local H loss: 0.0598  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2749 |Global loss: 1.1676| Local H loss: 0.0593  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2647 |Global loss: 0.9658| Local H loss: 0.0551  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3302 |Global loss: 1.9316| Local H loss: 0.0961  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2716 |Global loss: 1.1168| Local H loss: 0.0558  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.254 |Global loss: 0.8913| Local H loss: 0.0561  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2624 |Global loss: 1.0523| Local H loss: 0.0517  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2915 |Global loss: 2.0541| Local H loss: 0.0964  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2412 |Global loss: 1.1232| Local H loss: 0.0632  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2358 |Global loss: 1.1238| Local H loss: 0.0589  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2445 |Global loss: 0.9541| Local H loss: 0.06  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3019 |Global loss: 2.0264| Local H loss: 0.103  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2411 |Global loss: 1.046| Local H loss: 0.0622  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2339 |Global loss: 0.8607| Local H loss: 0.0582  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.214 |Global loss: 0.6778| Local H loss: 0.0516  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2917 |Global loss: 1.9127| Local H loss: 0.0987  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2497 |Global loss: 1.1335| Local H loss: 0.0669  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2353 |Global loss: 0.9194| Local H loss: 0.0603  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2265 |Global loss: 0.7805| Local H loss: 0.056  | Global H loss: 0.0367 [0m
------------------------- time cost ------------------------- 7.6181464195251465
Chosen Clients:  [13, 21, 7, 8, 20, 5, 16, 9, 4, 23, 29, 24]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.931, 0.868, 0.965, 0.963, 0.947, 0.927, 0.87, 0.859, 0.722, 0.865, 0.949, 0.887, 0.927, 0.938, 0.963, 0.891, 0.924, 0.956, 0.911, 0.933, 0.961, 0.938, 0.903, 0.896, 0.981, 0.959, 0.957, 0.688, 0.988, 0.958]
AUC in each clients:  [86.656, 75.432, 85.511, 79.407, 75.665, 81.027, 76.27, 70.269, 70.284, 73.173, 78.783, 79.202, 81.682, 80.793, 81.788, 91.292, 91.223, 90.722, 89.525, 88.603, 101.602, 80.738, 92.542, 95.214, 102.828, 97.888, 93.838, 94.171, 85.726, 95.69]
F1 Score:  [0.923, 0.873, 0.965, 0.96, 0.942, 0.906, 0.85, 0.863, 0.682, 0.845, 0.949, 0.876, 0.92, 0.943, 0.96, 0.891, 0.91, 0.947, 0.862, 0.926, 0.949, 0.912, 0.87, 0.888, 0.974, 0.951, 0.936, 0.678, 0.989, 0.947]
Recall Score:  [0.911, 0.886, 0.967, 0.964, 0.943, 0.91, 0.849, 0.875, 0.697, 0.847, 0.949, 0.879, 0.919, 0.942, 0.964, 0.897, 0.913, 0.948, 0.872, 0.926, 0.949, 0.944, 0.875, 0.913, 0.972, 0.951, 0.931, 0.697, 0.991, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.8099
Averaged Test Accurancy: 0.9160
Averaged Test AUC: 0.9936
Averaged Test F1_score: 0.9029
Averaged Test Recal score: 0.9077
Std Test Accurancy: 0.0661
Std Test AUC: 0.0050
Std Test F1: 0.0012
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3355 |Global loss: 2.0247| Local H loss: 0.0994  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2762 |Global loss: 1.0181| Local H loss: 0.0572  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2715 |Global loss: 0.8917| Local H loss: 0.052  | Global H loss: 0.0326 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2639 |Global loss: 0.8024| Local H loss: 0.0464  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2913 |Global loss: 1.9278| Local H loss: 0.1002  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2355 |Global loss: 0.812| Local H loss: 0.0602  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2254 |Global loss: 0.7384| Local H loss: 0.0513  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2164 |Global loss: 0.6749| Local H loss: 0.0478  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2984 |Global loss: 2.1203| Local H loss: 0.1063  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2433 |Global loss: 1.0001| Local H loss: 0.0599  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2374 |Global loss: 0.8621| Local H loss: 0.0559  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.223 |Global loss: 0.7167| Local H loss: 0.0492  | Global H loss: 0.0336 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5615 |Global loss: 2.216| Local H loss: 0.0838  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5231 |Global loss: 1.2711| Local H loss: 0.0453  | Global H loss: 0.0259 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4886 |Global loss: 1.049| Local H loss: 0.0405  | Global H loss: 0.0233 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4702 |Global loss: 0.9605| Local H loss: 0.0372  | Global H loss: 0.0207 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2866 |Global loss: 1.6906| Local H loss: 0.0957  | Global H loss: 0.0527 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2299 |Global loss: 0.7967| Local H loss: 0.0591  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2296 |Global loss: 0.8041| Local H loss: 0.0547  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2181 |Global loss: 0.6471| Local H loss: 0.0487  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.411 |Global loss: 2.0913| Local H loss: 0.1028  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3683 |Global loss: 1.2126| Local H loss: 0.0578  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3437 |Global loss: 1.0213| Local H loss: 0.0526  | Global H loss: 0.0301 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2971 |Global loss: 0.8768| Local H loss: 0.05  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4483 |Global loss: 2.0927| Local H loss: 0.0888  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4025 |Global loss: 1.2117| Local H loss: 0.0588  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3414 |Global loss: 0.8919| Local H loss: 0.0461  | Global H loss: 0.027 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.311 |Global loss: 0.7489| Local H loss: 0.0379  | Global H loss: 0.0222 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3905 |Global loss: 2.2275| Local H loss: 0.0924  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3851 |Global loss: 1.6487| Local H loss: 0.0648  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3584 |Global loss: 1.4207| Local H loss: 0.066  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3531 |Global loss: 1.2779| Local H loss: 0.0622  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3246 |Global loss: 2.0809| Local H loss: 0.0977  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2785 |Global loss: 1.1665| Local H loss: 0.0655  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2608 |Global loss: 0.954| Local H loss: 0.0574  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2627 |Global loss: 0.8796| Local H loss: 0.0581  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.289 |Global loss: 1.7979| Local H loss: 0.1035  | Global H loss: 0.0549 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.23 |Global loss: 0.8798| Local H loss: 0.0553  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2246 |Global loss: 0.716| Local H loss: 0.0512  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2159 |Global loss: 0.6923| Local H loss: 0.0499  | Global H loss: 0.0336 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3039 |Global loss: 2.0226| Local H loss: 0.0921  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.262 |Global loss: 1.1803| Local H loss: 0.0617  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2483 |Global loss: 1.024| Local H loss: 0.0595  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2386 |Global loss: 0.9614| Local H loss: 0.0613  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3215 |Global loss: 2.1061| Local H loss: 0.0942  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3005 |Global loss: 1.4312| Local H loss: 0.0702  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2882 |Global loss: 1.2332| Local H loss: 0.0681  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2618 |Global loss: 1.0528| Local H loss: 0.0628  | Global H loss: 0.04 [0m
------------------------- time cost ------------------------- 7.369647026062012
Chosen Clients:  [29, 0, 22, 2, 10, 19, 23, 26, 16, 4, 1, 8]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.931, 0.868, 0.965, 0.963, 0.961, 0.963, 0.87, 0.831, 0.722, 0.878, 0.949, 0.887, 0.927, 0.951, 0.963, 0.891, 0.924, 0.956, 0.911, 0.933, 0.941, 0.926, 0.903, 0.906, 0.981, 0.959, 0.957, 0.688, 0.988, 0.948]
AUC in each clients:  [86.656, 75.432, 85.511, 79.407, 75.707, 81.204, 76.27, 70.092, 70.414, 73.246, 78.783, 79.202, 81.682, 80.842, 81.788, 91.292, 91.367, 90.722, 89.525, 88.603, 101.598, 80.736, 92.542, 95.43, 102.842, 97.888, 93.838, 94.171, 85.726, 95.76]
F1 Score:  [0.923, 0.873, 0.965, 0.96, 0.957, 0.954, 0.85, 0.836, 0.679, 0.863, 0.949, 0.876, 0.92, 0.952, 0.96, 0.891, 0.914, 0.947, 0.862, 0.926, 0.92, 0.895, 0.87, 0.898, 0.974, 0.951, 0.936, 0.678, 0.989, 0.935]
Recall Score:  [0.911, 0.886, 0.967, 0.964, 0.959, 0.951, 0.849, 0.85, 0.725, 0.861, 0.949, 0.879, 0.919, 0.952, 0.964, 0.897, 0.913, 0.948, 0.872, 0.926, 0.923, 0.934, 0.875, 0.913, 0.972, 0.951, 0.931, 0.697, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.7906
Averaged Test Accurancy: 0.9164
Averaged Test AUC: 0.9939
Averaged Test F1_score: 0.9034
Averaged Test Recal score: 0.9088
Std Test Accurancy: 0.0670
Std Test AUC: 0.0048
Std Test F1: 0.0012
Std Test Recall: 0.0012
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2914 |Global loss: 2.0712| Local H loss: 0.097  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2506 |Global loss: 1.342| Local H loss: 0.0625  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2413 |Global loss: 0.9976| Local H loss: 0.0636  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2383 |Global loss: 0.8449| Local H loss: 0.0578  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2812 |Global loss: 1.8843| Local H loss: 0.093  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 0.8346| Local H loss: 0.0599  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2385 |Global loss: 1.0215| Local H loss: 0.0572  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2214 |Global loss: 0.7313| Local H loss: 0.0546  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3044 |Global loss: 1.9702| Local H loss: 0.0955  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2581 |Global loss: 1.1197| Local H loss: 0.0582  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2587 |Global loss: 1.0169| Local H loss: 0.0543  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2454 |Global loss: 0.8634| Local H loss: 0.0526  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3133 |Global loss: 2.0126| Local H loss: 0.1062  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2632 |Global loss: 1.2555| Local H loss: 0.0601  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2511 |Global loss: 0.936| Local H loss: 0.0653  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2424 |Global loss: 0.8293| Local H loss: 0.056  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2962 |Global loss: 2.0429| Local H loss: 0.0987  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2445 |Global loss: 1.1469| Local H loss: 0.0646  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2353 |Global loss: 0.9864| Local H loss: 0.0604  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2351 |Global loss: 0.8786| Local H loss: 0.0549  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2954 |Global loss: 1.9288| Local H loss: 0.1004  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2425 |Global loss: 0.9892| Local H loss: 0.063  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.235 |Global loss: 0.7804| Local H loss: 0.0576  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2479 |Global loss: 0.7276| Local H loss: 0.0556  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2995 |Global loss: 1.9415| Local H loss: 0.1048  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2408 |Global loss: 1.0285| Local H loss: 0.0569  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2389 |Global loss: 0.8703| Local H loss: 0.0576  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2185 |Global loss: 0.7398| Local H loss: 0.0501  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2808 |Global loss: 1.838| Local H loss: 0.0979  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2432 |Global loss: 0.9645| Local H loss: 0.0617  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2277 |Global loss: 0.8382| Local H loss: 0.0572  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2208 |Global loss: 0.7648| Local H loss: 0.053  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3855 |Global loss: 1.9074| Local H loss: 0.0927  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3224 |Global loss: 1.1736| Local H loss: 0.0623  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3351 |Global loss: 0.9124| Local H loss: 0.0503  | Global H loss: 0.0303 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2962 |Global loss: 0.9534| Local H loss: 0.0495  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3446 |Global loss: 2.03| Local H loss: 0.0988  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.272 |Global loss: 1.0936| Local H loss: 0.0642  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2706 |Global loss: 0.9987| Local H loss: 0.0609  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2637 |Global loss: 0.8773| Local H loss: 0.0551  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3006 |Global loss: 2.1391| Local H loss: 0.0966  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2543 |Global loss: 1.197| Local H loss: 0.0635  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2525 |Global loss: 1.0173| Local H loss: 0.0643  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2358 |Global loss: 0.8912| Local H loss: 0.0545  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5628 |Global loss: 2.2996| Local H loss: 0.0896  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.5086 |Global loss: 1.6034| Local H loss: 0.0566  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4817 |Global loss: 1.207| Local H loss: 0.0537  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4593 |Global loss: 1.0485| Local H loss: 0.0417  | Global H loss: 0.0232 [0m
------------------------- time cost ------------------------- 7.3332359790802
Chosen Clients:  [27, 23, 6, 29, 5, 17, 10, 1, 28, 20, 4, 13]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.895, 0.919, 0.963, 0.934, 0.963, 0.87, 0.831, 0.736, 0.878, 0.949, 0.887, 0.927, 0.951, 0.963, 0.891, 0.924, 0.956, 0.911, 0.933, 0.941, 0.926, 0.903, 0.906, 0.981, 0.959, 0.968, 0.688, 0.988, 0.958]
AUC in each clients:  [86.693, 75.463, 85.446, 79.407, 75.599, 81.204, 76.27, 70.092, 70.332, 73.246, 78.795, 79.202, 81.682, 80.842, 81.788, 91.292, 91.309, 90.722, 89.525, 88.636, 101.598, 80.736, 92.539, 95.372, 102.842, 97.888, 93.882, 94.171, 85.726, 95.748]
F1 Score:  [0.939, 0.899, 0.91, 0.96, 0.929, 0.954, 0.85, 0.836, 0.669, 0.863, 0.949, 0.876, 0.92, 0.952, 0.96, 0.891, 0.909, 0.947, 0.862, 0.925, 0.92, 0.895, 0.873, 0.898, 0.974, 0.951, 0.948, 0.678, 0.989, 0.947]
Recall Score:  [0.928, 0.912, 0.922, 0.964, 0.939, 0.951, 0.849, 0.85, 0.757, 0.861, 0.949, 0.879, 0.919, 0.952, 0.964, 0.897, 0.903, 0.948, 0.872, 0.925, 0.923, 0.934, 0.875, 0.913, 0.972, 0.951, 0.944, 0.697, 0.991, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.7564
Averaged Test Accurancy: 0.9164
Averaged Test AUC: 0.9938
Averaged Test F1_score: 0.9024
Averaged Test Recal score: 0.9097
Std Test Accurancy: 0.0648
Std Test AUC: 0.0050
Std Test F1: 0.0012
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4574 |Global loss: 2.0441| Local H loss: 0.0885  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3948 |Global loss: 1.2915| Local H loss: 0.065  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3862 |Global loss: 1.0526| Local H loss: 0.0544  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3719 |Global loss: 0.9155| Local H loss: 0.0454  | Global H loss: 0.0258 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2871 |Global loss: 1.8876| Local H loss: 0.0985  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2282 |Global loss: 0.8889| Local H loss: 0.0549  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2223 |Global loss: 0.8122| Local H loss: 0.0518  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2244 |Global loss: 0.726| Local H loss: 0.0518  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3173 |Global loss: 2.0986| Local H loss: 0.1044  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2582 |Global loss: 1.0397| Local H loss: 0.0601  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.264 |Global loss: 0.8993| Local H loss: 0.055  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2463 |Global loss: 0.8161| Local H loss: 0.054  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2876 |Global loss: 1.9556| Local H loss: 0.0922  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2462 |Global loss: 1.1798| Local H loss: 0.0654  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2361 |Global loss: 1.0642| Local H loss: 0.0616  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2254 |Global loss: 0.8532| Local H loss: 0.0593  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3764 |Global loss: 2.0817| Local H loss: 0.1073  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.332 |Global loss: 1.1909| Local H loss: 0.0576  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.297 |Global loss: 1.008| Local H loss: 0.0652  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2874 |Global loss: 0.84| Local H loss: 0.0546  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3181 |Global loss: 1.985| Local H loss: 0.0943  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2854 |Global loss: 1.3429| Local H loss: 0.0634  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2579 |Global loss: 1.0366| Local H loss: 0.059  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2681 |Global loss: 1.0233| Local H loss: 0.0546  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2995 |Global loss: 2.2016| Local H loss: 0.0989  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.242 |Global loss: 1.1365| Local H loss: 0.0665  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2318 |Global loss: 0.8991| Local H loss: 0.0579  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2247 |Global loss: 0.756| Local H loss: 0.0538  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2961 |Global loss: 2.0914| Local H loss: 0.1005  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2518 |Global loss: 1.069| Local H loss: 0.0705  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2385 |Global loss: 0.9755| Local H loss: 0.0609  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2341 |Global loss: 0.8511| Local H loss: 0.0557  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2922 |Global loss: 1.9983| Local H loss: 0.1017  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2497 |Global loss: 1.0989| Local H loss: 0.068  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2234 |Global loss: 0.7825| Local H loss: 0.0545  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2205 |Global loss: 0.7231| Local H loss: 0.054  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2807 |Global loss: 1.8776| Local H loss: 0.0971  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2241 |Global loss: 0.9316| Local H loss: 0.058  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2211 |Global loss: 0.7544| Local H loss: 0.0527  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2181 |Global loss: 0.6805| Local H loss: 0.0492  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3283 |Global loss: 2.0571| Local H loss: 0.1002  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2666 |Global loss: 1.087| Local H loss: 0.0631  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.267 |Global loss: 1.0912| Local H loss: 0.0573  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2524 |Global loss: 0.8574| Local H loss: 0.0555  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3541 |Global loss: 2.1034| Local H loss: 0.0975  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2928 |Global loss: 1.2143| Local H loss: 0.06  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2712 |Global loss: 1.0142| Local H loss: 0.0592  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.263 |Global loss: 0.8686| Local H loss: 0.0524  | Global H loss: 0.0335 [0m
------------------------- time cost ------------------------- 7.263084888458252
Chosen Clients:  [29, 25, 3, 14, 13, 8, 1, 28, 5, 4, 26, 7]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.919, 0.963, 0.921, 0.939, 0.87, 0.831, 0.736, 0.878, 0.937, 0.887, 0.927, 0.951, 0.963, 0.891, 0.924, 0.967, 0.911, 0.933, 0.902, 0.926, 0.903, 0.927, 0.981, 0.959, 0.968, 0.792, 0.988, 0.938]
AUC in each clients:  [86.693, 75.444, 85.446, 79.407, 75.624, 81.241, 76.305, 70.092, 70.332, 73.246, 78.8, 79.202, 81.682, 80.781, 81.788, 91.292, 91.309, 90.769, 89.525, 88.636, 101.588, 80.736, 92.539, 95.269, 102.842, 97.888, 93.882, 94.274, 85.729, 95.805]
F1 Score:  [0.939, 0.886, 0.91, 0.96, 0.911, 0.928, 0.854, 0.836, 0.669, 0.863, 0.938, 0.876, 0.92, 0.961, 0.96, 0.891, 0.909, 0.961, 0.862, 0.925, 0.862, 0.895, 0.873, 0.92, 0.974, 0.951, 0.948, 0.767, 0.98, 0.921]
Recall Score:  [0.928, 0.897, 0.922, 0.964, 0.909, 0.929, 0.851, 0.85, 0.757, 0.861, 0.939, 0.879, 0.919, 0.961, 0.964, 0.897, 0.903, 0.962, 0.872, 0.925, 0.872, 0.934, 0.875, 0.942, 0.972, 0.951, 0.944, 0.797, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.7433
Averaged Test Accurancy: 0.9172
Averaged Test AUC: 0.9939
Averaged Test F1_score: 0.9017
Averaged Test Recal score: 0.9097
Std Test Accurancy: 0.0537
Std Test AUC: 0.0049
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2828 |Global loss: 1.9428| Local H loss: 0.0951  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2487 |Global loss: 1.2603| Local H loss: 0.068  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2366 |Global loss: 1.0746| Local H loss: 0.0604  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2298 |Global loss: 0.8971| Local H loss: 0.0591  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2971 |Global loss: 1.9247| Local H loss: 0.0983  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2531 |Global loss: 1.1044| Local H loss: 0.0633  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2377 |Global loss: 0.8812| Local H loss: 0.0568  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.232 |Global loss: 0.7629| Local H loss: 0.0525  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3647 |Global loss: 2.2715| Local H loss: 0.1027  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3094 |Global loss: 1.3737| Local H loss: 0.0649  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.285 |Global loss: 1.0157| Local H loss: 0.0584  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2865 |Global loss: 1.1352| Local H loss: 0.0577  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.311 |Global loss: 2.165| Local H loss: 0.1025  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2615 |Global loss: 1.1187| Local H loss: 0.0667  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2411 |Global loss: 0.9076| Local H loss: 0.0575  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2333 |Global loss: 0.7972| Local H loss: 0.0609  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3307 |Global loss: 2.1292| Local H loss: 0.1028  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2805 |Global loss: 1.2325| Local H loss: 0.065  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2833 |Global loss: 1.1176| Local H loss: 0.0611  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2842 |Global loss: 1.144| Local H loss: 0.0609  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5262 |Global loss: 2.1386| Local H loss: 0.0902  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4728 |Global loss: 1.2706| Local H loss: 0.0516  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4535 |Global loss: 1.033| Local H loss: 0.0456  | Global H loss: 0.0264 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.428 |Global loss: 0.9257| Local H loss: 0.0372  | Global H loss: 0.0213 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2943 |Global loss: 2.1086| Local H loss: 0.1004  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2537 |Global loss: 1.1281| Local H loss: 0.0716  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2396 |Global loss: 1.0013| Local H loss: 0.0589  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2316 |Global loss: 0.8649| Local H loss: 0.0579  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2944 |Global loss: 2.0873| Local H loss: 0.1051  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2403 |Global loss: 0.9407| Local H loss: 0.068  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2272 |Global loss: 0.7803| Local H loss: 0.0577  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.222 |Global loss: 0.7281| Local H loss: 0.0548  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3493 |Global loss: 2.1665| Local H loss: 0.1043  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3029 |Global loss: 1.2792| Local H loss: 0.0633  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2778 |Global loss: 0.9125| Local H loss: 0.0564  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2652 |Global loss: 0.9069| Local H loss: 0.0534  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3206 |Global loss: 2.0304| Local H loss: 0.096  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.286 |Global loss: 1.2679| Local H loss: 0.0619  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2539 |Global loss: 0.9704| Local H loss: 0.0607  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2644 |Global loss: 0.919| Local H loss: 0.0577  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2828 |Global loss: 1.8954| Local H loss: 0.0965  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2387 |Global loss: 0.974| Local H loss: 0.0606  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2217 |Global loss: 0.7772| Local H loss: 0.0558  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2087 |Global loss: 0.6725| Local H loss: 0.0492  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3028 |Global loss: 2.2622| Local H loss: 0.1079  | Global H loss: 0.0616 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2496 |Global loss: 1.1444| Local H loss: 0.0682  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2426 |Global loss: 0.9993| Local H loss: 0.0597  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.227 |Global loss: 0.8018| Local H loss: 0.0582  | Global H loss: 0.0397 [0m
------------------------- time cost ------------------------- 7.667911767959595
Chosen Clients:  [25, 12, 22, 5, 18, 29, 4, 0, 23, 19, 10, 13]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.919, 0.988, 0.961, 0.951, 0.87, 0.873, 0.722, 0.878, 0.937, 0.887, 0.927, 1.0, 0.963, 0.891, 0.924, 0.967, 0.911, 0.933, 0.902, 0.926, 0.903, 0.927, 0.981, 0.969, 0.947, 0.792, 0.988, 0.958]
AUC in each clients:  [86.693, 75.464, 85.446, 79.599, 75.73, 81.374, 76.305, 70.268, 70.551, 73.246, 78.8, 79.202, 81.682, 80.92, 81.786, 91.292, 91.309, 90.769, 89.525, 88.636, 101.588, 80.736, 92.539, 95.269, 102.842, 97.825, 93.855, 94.274, 85.743, 95.739]
F1 Score:  [0.939, 0.886, 0.91, 0.986, 0.957, 0.941, 0.854, 0.878, 0.682, 0.863, 0.938, 0.876, 0.92, 1.0, 0.963, 0.891, 0.909, 0.961, 0.862, 0.925, 0.862, 0.895, 0.873, 0.92, 0.974, 0.965, 0.916, 0.767, 0.98, 0.947]
Recall Score:  [0.928, 0.897, 0.922, 0.985, 0.959, 0.94, 0.851, 0.887, 0.734, 0.861, 0.939, 0.879, 0.919, 1.0, 0.969, 0.897, 0.903, 0.962, 0.872, 0.925, 0.872, 0.934, 0.875, 0.942, 0.972, 0.966, 0.912, 0.797, 0.991, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.7027
Averaged Test Accurancy: 0.9222
Averaged Test AUC: 0.9942
Averaged Test F1_score: 0.9080
Averaged Test Recal score: 0.9146
Std Test Accurancy: 0.0571
Std Test AUC: 0.0044
Std Test F1: 0.0012
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2948 |Global loss: 2.0245| Local H loss: 0.0984  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2384 |Global loss: 1.0746| Local H loss: 0.0614  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2377 |Global loss: 0.9078| Local H loss: 0.059  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2302 |Global loss: 0.8281| Local H loss: 0.0511  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2887 |Global loss: 2.0892| Local H loss: 0.0995  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2433 |Global loss: 1.1923| Local H loss: 0.0675  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.237 |Global loss: 1.0456| Local H loss: 0.0618  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.235 |Global loss: 0.9471| Local H loss: 0.0587  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3133 |Global loss: 2.0422| Local H loss: 0.0945  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2597 |Global loss: 1.1471| Local H loss: 0.0612  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2459 |Global loss: 1.0515| Local H loss: 0.056  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2589 |Global loss: 1.0214| Local H loss: 0.0511  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3466 |Global loss: 2.0656| Local H loss: 0.1041  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2871 |Global loss: 1.1965| Local H loss: 0.0657  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2572 |Global loss: 0.8853| Local H loss: 0.0552  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2534 |Global loss: 0.827| Local H loss: 0.0493  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3177 |Global loss: 1.7728| Local H loss: 0.0999  | Global H loss: 0.0528 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2644 |Global loss: 0.8186| Local H loss: 0.0649  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2362 |Global loss: 0.642| Local H loss: 0.0466  | Global H loss: 0.0297 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2342 |Global loss: 0.5184| Local H loss: 0.0433  | Global H loss: 0.0255 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2888 |Global loss: 2.055| Local H loss: 0.0964  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2419 |Global loss: 1.2156| Local H loss: 0.0659  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2374 |Global loss: 1.1234| Local H loss: 0.0609  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2338 |Global loss: 0.9293| Local H loss: 0.0591  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3166 |Global loss: 2.1231| Local H loss: 0.0984  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2561 |Global loss: 1.1133| Local H loss: 0.0649  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2678 |Global loss: 1.0491| Local H loss: 0.056  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2504 |Global loss: 0.9131| Local H loss: 0.0537  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2818 |Global loss: 1.8772| Local H loss: 0.096  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 0.9705| Local H loss: 0.063  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2291 |Global loss: 0.8214| Local H loss: 0.0555  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2234 |Global loss: 0.7341| Local H loss: 0.0569  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2836 |Global loss: 1.8277| Local H loss: 0.1024  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.234 |Global loss: 0.9486| Local H loss: 0.0622  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2346 |Global loss: 0.8452| Local H loss: 0.0552  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2202 |Global loss: 0.7856| Local H loss: 0.0524  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2961 |Global loss: 1.9789| Local H loss: 0.1005  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2508 |Global loss: 1.0417| Local H loss: 0.0678  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2352 |Global loss: 0.9238| Local H loss: 0.0566  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2324 |Global loss: 0.7943| Local H loss: 0.0525  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.292 |Global loss: 2.0667| Local H loss: 0.0988  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2483 |Global loss: 1.0951| Local H loss: 0.0641  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2309 |Global loss: 1.0286| Local H loss: 0.0598  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2339 |Global loss: 0.9593| Local H loss: 0.0593  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3227 |Global loss: 2.1078| Local H loss: 0.0985  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2702 |Global loss: 1.1937| Local H loss: 0.0616  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2685 |Global loss: 0.9568| Local H loss: 0.0573  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2406 |Global loss: 0.7884| Local H loss: 0.0492  | Global H loss: 0.0331 [0m
------------------------- time cost ------------------------- 7.4871039390563965
Chosen Clients:  [20, 9, 17, 11, 12, 14, 0, 27, 29, 4, 6, 10]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.919, 0.988, 0.934, 0.976, 0.87, 0.873, 0.722, 0.878, 0.937, 0.887, 0.915, 0.951, 0.963, 0.891, 0.924, 0.967, 0.944, 0.944, 0.902, 0.926, 0.925, 0.927, 0.981, 0.969, 0.947, 0.792, 0.988, 0.948]
AUC in each clients:  [86.712, 75.464, 85.446, 79.599, 75.705, 81.407, 76.305, 70.268, 70.551, 73.246, 78.784, 79.202, 81.674, 80.84, 81.786, 91.292, 91.309, 90.769, 89.562, 88.638, 101.588, 80.736, 92.53, 95.225, 102.842, 97.884, 93.855, 94.274, 85.743, 95.766]
F1 Score:  [0.939, 0.886, 0.91, 0.986, 0.928, 0.972, 0.854, 0.878, 0.682, 0.863, 0.938, 0.876, 0.908, 0.952, 0.963, 0.891, 0.909, 0.961, 0.911, 0.938, 0.862, 0.895, 0.901, 0.92, 0.974, 0.965, 0.916, 0.767, 0.98, 0.933]
Recall Score:  [0.928, 0.897, 0.922, 0.985, 0.926, 0.966, 0.851, 0.887, 0.734, 0.861, 0.939, 0.879, 0.906, 0.952, 0.969, 0.897, 0.903, 0.962, 0.911, 0.938, 0.872, 0.934, 0.903, 0.942, 0.972, 0.966, 0.912, 0.797, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.6690
Averaged Test Accurancy: 0.9222
Averaged Test AUC: 0.9942
Averaged Test F1_score: 0.9086
Averaged Test Recal score: 0.9146
Std Test Accurancy: 0.0557
Std Test AUC: 0.0044
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2815 |Global loss: 1.8425| Local H loss: 0.0988  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2541 |Global loss: 1.3383| Local H loss: 0.068  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2265 |Global loss: 0.8678| Local H loss: 0.0571  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2203 |Global loss: 0.7854| Local H loss: 0.0488  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4065 |Global loss: 2.4093| Local H loss: 0.0895  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3798 |Global loss: 1.6313| Local H loss: 0.072  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3658 |Global loss: 1.4082| Local H loss: 0.0662  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3383 |Global loss: 1.1226| Local H loss: 0.063  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2998 |Global loss: 1.9167| Local H loss: 0.0922  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2618 |Global loss: 1.1885| Local H loss: 0.0627  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2588 |Global loss: 1.0395| Local H loss: 0.0596  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2637 |Global loss: 1.0099| Local H loss: 0.0524  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3283 |Global loss: 2.1404| Local H loss: 0.1005  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2771 |Global loss: 1.3372| Local H loss: 0.0637  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2639 |Global loss: 1.0821| Local H loss: 0.0585  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2562 |Global loss: 0.839| Local H loss: 0.0593  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2922 |Global loss: 2.1365| Local H loss: 0.0998  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2479 |Global loss: 1.2122| Local H loss: 0.0654  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 0.9571| Local H loss: 0.0597  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2423 |Global loss: 1.0191| Local H loss: 0.0588  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.301 |Global loss: 1.9557| Local H loss: 0.1016  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.253 |Global loss: 1.1017| Local H loss: 0.0658  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2335 |Global loss: 0.7783| Local H loss: 0.0529  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2292 |Global loss: 0.7217| Local H loss: 0.0545  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2838 |Global loss: 1.8587| Local H loss: 0.0964  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2325 |Global loss: 0.9653| Local H loss: 0.0613  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2206 |Global loss: 0.7727| Local H loss: 0.0524  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.6959| Local H loss: 0.0561  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4289 |Global loss: 2.1961| Local H loss: 0.0938  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4123 |Global loss: 1.2755| Local H loss: 0.0624  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.377 |Global loss: 1.062| Local H loss: 0.0532  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3866 |Global loss: 1.0121| Local H loss: 0.0489  | Global H loss: 0.0281 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2805 |Global loss: 1.9941| Local H loss: 0.0942  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2378 |Global loss: 1.153| Local H loss: 0.0651  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2355 |Global loss: 0.982| Local H loss: 0.062  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2337 |Global loss: 0.9373| Local H loss: 0.0605  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3254 |Global loss: 2.0645| Local H loss: 0.095  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2664 |Global loss: 1.1075| Local H loss: 0.0632  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2626 |Global loss: 1.0325| Local H loss: 0.0596  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.244 |Global loss: 0.9836| Local H loss: 0.0569  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3265 |Global loss: 2.1031| Local H loss: 0.1031  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2725 |Global loss: 1.2179| Local H loss: 0.0585  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2559 |Global loss: 0.9533| Local H loss: 0.0588  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.245 |Global loss: 0.8504| Local H loss: 0.0554  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2898 |Global loss: 2.1237| Local H loss: 0.1045  | Global H loss: 0.0605 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2328 |Global loss: 0.9987| Local H loss: 0.0622  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.229 |Global loss: 0.8613| Local H loss: 0.0546  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2342 |Global loss: 0.9282| Local H loss: 0.0578  | Global H loss: 0.0411 [0m
------------------------- time cost ------------------------- 7.123791694641113
Chosen Clients:  [7, 10, 28, 1, 15, 20, 9, 24, 6, 29, 2, 16]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.919, 0.988, 0.961, 0.976, 0.844, 0.873, 0.722, 0.824, 0.937, 0.9, 0.915, 0.951, 0.976, 0.891, 0.924, 0.978, 0.944, 0.944, 0.971, 0.926, 0.925, 0.927, 0.981, 0.969, 0.947, 0.812, 0.988, 0.938]
AUC in each clients:  [86.721, 75.464, 85.446, 79.599, 75.733, 81.407, 76.254, 70.268, 70.551, 73.053, 78.799, 79.195, 81.671, 80.84, 81.794, 91.292, 91.309, 90.812, 89.562, 88.638, 101.698, 80.736, 92.53, 95.225, 102.842, 97.884, 93.855, 94.39, 85.743, 95.795]
F1 Score:  [0.939, 0.886, 0.91, 0.986, 0.957, 0.972, 0.83, 0.878, 0.682, 0.813, 0.938, 0.891, 0.905, 0.952, 0.973, 0.891, 0.909, 0.974, 0.911, 0.938, 0.961, 0.895, 0.901, 0.92, 0.974, 0.965, 0.916, 0.796, 0.98, 0.921]
Recall Score:  [0.928, 0.897, 0.922, 0.985, 0.959, 0.966, 0.825, 0.887, 0.734, 0.82, 0.939, 0.892, 0.905, 0.952, 0.974, 0.897, 0.903, 0.974, 0.911, 0.938, 0.962, 0.934, 0.903, 0.942, 0.972, 0.966, 0.912, 0.804, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.6464
Averaged Test Accurancy: 0.9249
Averaged Test AUC: 0.9942
Averaged Test F1_score: 0.9121
Averaged Test Recal score: 0.9172
Std Test Accurancy: 0.0587
Std Test AUC: 0.0045
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3001 |Global loss: 2.1833| Local H loss: 0.1024  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2552 |Global loss: 1.0234| Local H loss: 0.0603  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2354 |Global loss: 0.9508| Local H loss: 0.0593  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2314 |Global loss: 0.7902| Local H loss: 0.0574  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2853 |Global loss: 1.9532| Local H loss: 0.1005  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2355 |Global loss: 0.9785| Local H loss: 0.0601  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2348 |Global loss: 0.9736| Local H loss: 0.0591  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2222 |Global loss: 0.827| Local H loss: 0.0545  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2992 |Global loss: 2.1382| Local H loss: 0.1062  | Global H loss: 0.0599 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2357 |Global loss: 1.0143| Local H loss: 0.0628  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2255 |Global loss: 0.8828| Local H loss: 0.0583  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2184 |Global loss: 0.7577| Local H loss: 0.0517  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2942 |Global loss: 2.1011| Local H loss: 0.0977  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2507 |Global loss: 1.3051| Local H loss: 0.0659  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2364 |Global loss: 0.9575| Local H loss: 0.0624  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2372 |Global loss: 0.8638| Local H loss: 0.0569  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3765 |Global loss: 2.121| Local H loss: 0.089  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3264 |Global loss: 1.1515| Local H loss: 0.0604  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.344 |Global loss: 1.0406| Local H loss: 0.0606  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3184 |Global loss: 0.8859| Local H loss: 0.0522  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.275 |Global loss: 1.6931| Local H loss: 0.0904  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2279 |Global loss: 0.8279| Local H loss: 0.0551  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.221 |Global loss: 0.7295| Local H loss: 0.0535  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2063 |Global loss: 0.6212| Local H loss: 0.0505  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4057 |Global loss: 2.219| Local H loss: 0.0903  | Global H loss: 0.0527 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3738 |Global loss: 1.7417| Local H loss: 0.0643  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3844 |Global loss: 1.4041| Local H loss: 0.069  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3364 |Global loss: 1.189| Local H loss: 0.0604  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3096 |Global loss: 2.0237| Local H loss: 0.0935  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.274 |Global loss: 1.2956| Local H loss: 0.0697  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2648 |Global loss: 1.0981| Local H loss: 0.0642  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2538 |Global loss: 0.9312| Local H loss: 0.0629  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.315 |Global loss: 2.0076| Local H loss: 0.1029  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2551 |Global loss: 1.1022| Local H loss: 0.0617  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2465 |Global loss: 0.9515| Local H loss: 0.062  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2351 |Global loss: 0.7751| Local H loss: 0.0556  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2756 |Global loss: 1.9989| Local H loss: 0.0951  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2314 |Global loss: 1.1065| Local H loss: 0.0653  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2255 |Global loss: 0.9783| Local H loss: 0.0612  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2212 |Global loss: 0.7945| Local H loss: 0.0567  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.311 |Global loss: 2.3217| Local H loss: 0.1046  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2658 |Global loss: 1.2817| Local H loss: 0.066  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.243 |Global loss: 1.056| Local H loss: 0.0671  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2454 |Global loss: 0.9912| Local H loss: 0.0658  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.362 |Global loss: 1.9739| Local H loss: 0.1007  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3226 |Global loss: 1.2638| Local H loss: 0.0647  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2902 |Global loss: 0.9094| Local H loss: 0.0573  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.279 |Global loss: 0.9269| Local H loss: 0.0534  | Global H loss: 0.0355 [0m
------------------------- time cost ------------------------- 7.925936698913574
Chosen Clients:  [2, 5, 24, 26, 14, 20, 19, 25, 29, 13, 23, 8]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.988, 0.961, 0.976, 0.857, 0.859, 0.722, 0.838, 0.949, 0.9, 0.915, 0.951, 0.976, 0.902, 0.924, 0.978, 0.944, 0.944, 0.951, 0.926, 0.925, 0.927, 0.99, 0.969, 0.947, 0.812, 0.988, 0.938]
AUC in each clients:  [86.721, 75.475, 85.635, 79.599, 75.733, 81.407, 76.292, 70.357, 70.551, 73.13, 78.824, 79.195, 81.671, 80.84, 81.794, 91.494, 91.507, 90.812, 89.562, 88.638, 101.664, 80.736, 92.53, 95.225, 102.896, 97.884, 93.855, 94.39, 85.777, 95.766]
F1 Score:  [0.939, 0.873, 0.965, 0.986, 0.957, 0.972, 0.832, 0.867, 0.682, 0.824, 0.949, 0.891, 0.905, 0.952, 0.973, 0.901, 0.91, 0.974, 0.911, 0.938, 0.935, 0.895, 0.901, 0.92, 0.987, 0.965, 0.916, 0.796, 0.989, 0.921]
Recall Score:  [0.928, 0.886, 0.967, 0.985, 0.959, 0.966, 0.833, 0.872, 0.734, 0.825, 0.949, 0.892, 0.905, 0.952, 0.974, 0.904, 0.913, 0.974, 0.911, 0.938, 0.936, 0.934, 0.903, 0.942, 0.986, 0.966, 0.912, 0.804, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.6218
Averaged Test Accurancy: 0.9269
Averaged Test AUC: 0.9946
Averaged Test F1_score: 0.9142
Averaged Test Recal score: 0.9188
Std Test Accurancy: 0.0587
Std Test AUC: 0.0044
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3 |Global loss: 2.0397| Local H loss: 0.1028  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2591 |Global loss: 1.3299| Local H loss: 0.0715  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.242 |Global loss: 1.0311| Local H loss: 0.063  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2294 |Global loss: 0.7741| Local H loss: 0.0543  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.338 |Global loss: 2.0581| Local H loss: 0.1071  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2828 |Global loss: 1.0733| Local H loss: 0.0647  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.26 |Global loss: 0.8756| Local H loss: 0.0569  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2569 |Global loss: 0.9208| Local H loss: 0.0527  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3022 |Global loss: 1.9289| Local H loss: 0.0928  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2715 |Global loss: 1.3338| Local H loss: 0.069  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2564 |Global loss: 1.0725| Local H loss: 0.0688  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.257 |Global loss: 1.0286| Local H loss: 0.065  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2848 |Global loss: 1.8627| Local H loss: 0.1052  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.233 |Global loss: 0.9253| Local H loss: 0.0584  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2115 |Global loss: 0.7028| Local H loss: 0.0515  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2095 |Global loss: 0.6735| Local H loss: 0.0484  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2989 |Global loss: 2.0359| Local H loss: 0.1024  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2538 |Global loss: 1.1497| Local H loss: 0.0663  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2425 |Global loss: 0.9453| Local H loss: 0.057  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2212 |Global loss: 0.7447| Local H loss: 0.0544  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2652 |Global loss: 1.602| Local H loss: 0.0904  | Global H loss: 0.0515 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2261 |Global loss: 0.9241| Local H loss: 0.0564  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2137 |Global loss: 0.6809| Local H loss: 0.0469  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2157 |Global loss: 0.7457| Local H loss: 0.0505  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.288 |Global loss: 1.9113| Local H loss: 0.0974  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.241 |Global loss: 1.0171| Local H loss: 0.06  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2252 |Global loss: 0.8072| Local H loss: 0.0534  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2215 |Global loss: 0.7671| Local H loss: 0.0539  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2916 |Global loss: 1.9731| Local H loss: 0.0974  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2615 |Global loss: 1.2637| Local H loss: 0.0745  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2455 |Global loss: 1.1109| Local H loss: 0.066  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2402 |Global loss: 0.9521| Local H loss: 0.0617  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2813 |Global loss: 2.0526| Local H loss: 0.096  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2425 |Global loss: 1.2615| Local H loss: 0.069  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2331 |Global loss: 0.9786| Local H loss: 0.0654  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2272 |Global loss: 0.8443| Local H loss: 0.0592  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3277 |Global loss: 2.1035| Local H loss: 0.0982  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2857 |Global loss: 1.1731| Local H loss: 0.0572  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2505 |Global loss: 0.9437| Local H loss: 0.0577  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2532 |Global loss: 0.8053| Local H loss: 0.052  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2926 |Global loss: 2.1497| Local H loss: 0.106  | Global H loss: 0.0608 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2581 |Global loss: 1.3623| Local H loss: 0.0757  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2298 |Global loss: 0.9878| Local H loss: 0.0604  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2351 |Global loss: 0.9375| Local H loss: 0.0579  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.5128 |Global loss: 2.2006| Local H loss: 0.0893  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4659 |Global loss: 1.4231| Local H loss: 0.0593  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4545 |Global loss: 1.1128| Local H loss: 0.049  | Global H loss: 0.0266 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4371 |Global loss: 1.0878| Local H loss: 0.0412  | Global H loss: 0.0249 [0m
------------------------- time cost ------------------------- 7.28221583366394
Chosen Clients:  [14, 28, 23, 24, 6, 21, 8, 19, 3, 20, 25, 10]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.988, 0.961, 0.976, 0.857, 0.859, 0.736, 0.838, 0.949, 0.9, 0.915, 0.951, 0.976, 0.902, 0.924, 0.978, 0.944, 0.933, 0.902, 0.926, 0.925, 0.896, 1.0, 0.959, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.721, 75.475, 85.586, 79.599, 75.733, 81.457, 76.292, 70.357, 70.676, 73.13, 78.824, 79.195, 81.671, 80.869, 81.837, 91.494, 91.507, 90.812, 89.562, 88.641, 101.607, 80.736, 92.53, 95.249, 102.936, 97.888, 93.85, 94.39, 85.777, 95.768]
F1 Score:  [0.939, 0.873, 0.956, 0.986, 0.957, 0.972, 0.832, 0.867, 0.699, 0.824, 0.949, 0.891, 0.905, 0.952, 0.973, 0.901, 0.91, 0.974, 0.911, 0.925, 0.862, 0.895, 0.901, 0.888, 1.0, 0.951, 0.924, 0.796, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.957, 0.985, 0.959, 0.966, 0.833, 0.872, 0.728, 0.825, 0.949, 0.892, 0.905, 0.952, 0.974, 0.904, 0.913, 0.974, 0.911, 0.925, 0.872, 0.934, 0.903, 0.913, 1.0, 0.951, 0.917, 0.804, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5840
Averaged Test Accurancy: 0.9238
Averaged Test AUC: 0.9946
Averaged Test F1_score: 0.9112
Averaged Test Recal score: 0.9153
Std Test Accurancy: 0.0572
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2973 |Global loss: 1.963| Local H loss: 0.1018  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2579 |Global loss: 1.0991| Local H loss: 0.0639  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.232 |Global loss: 0.8377| Local H loss: 0.062  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2314 |Global loss: 0.8862| Local H loss: 0.0535  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2854 |Global loss: 2.0132| Local H loss: 0.1036  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2453 |Global loss: 1.0786| Local H loss: 0.0613  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2216 |Global loss: 0.8381| Local H loss: 0.0569  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2225 |Global loss: 0.8125| Local H loss: 0.0569  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2889 |Global loss: 1.9649| Local H loss: 0.0979  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2376 |Global loss: 1.108| Local H loss: 0.0663  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.217 |Global loss: 0.8116| Local H loss: 0.0572  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2177 |Global loss: 0.7616| Local H loss: 0.0515  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2955 |Global loss: 2.0046| Local H loss: 0.0922  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2626 |Global loss: 1.3895| Local H loss: 0.0709  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2517 |Global loss: 1.1358| Local H loss: 0.0655  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2496 |Global loss: 1.0266| Local H loss: 0.0628  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3215 |Global loss: 2.0433| Local H loss: 0.0991  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.263 |Global loss: 1.1817| Local H loss: 0.067  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2544 |Global loss: 0.9641| Local H loss: 0.0601  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2633 |Global loss: 0.8658| Local H loss: 0.0572  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2873 |Global loss: 1.8098| Local H loss: 0.0993  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2238 |Global loss: 0.7858| Local H loss: 0.0539  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2265 |Global loss: 0.8419| Local H loss: 0.0528  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2109 |Global loss: 0.6554| Local H loss: 0.0493  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4837 |Global loss: 2.1751| Local H loss: 0.092  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4434 |Global loss: 1.3539| Local H loss: 0.0561  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4541 |Global loss: 1.2489| Local H loss: 0.0583  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4234 |Global loss: 1.0217| Local H loss: 0.0451  | Global H loss: 0.0252 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2992 |Global loss: 1.8346| Local H loss: 0.0974  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2416 |Global loss: 1.001| Local H loss: 0.0584  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2352 |Global loss: 0.8969| Local H loss: 0.0588  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2363 |Global loss: 0.7688| Local H loss: 0.048  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3284 |Global loss: 2.102| Local H loss: 0.1  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2905 |Global loss: 1.248| Local H loss: 0.0648  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.275 |Global loss: 1.0355| Local H loss: 0.0581  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2762 |Global loss: 1.101| Local H loss: 0.0582  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2691 |Global loss: 1.6278| Local H loss: 0.0925  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2217 |Global loss: 0.8966| Local H loss: 0.059  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2199 |Global loss: 0.7548| Local H loss: 0.0561  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.209 |Global loss: 0.6351| Local H loss: 0.0462  | Global H loss: 0.0313 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2895 |Global loss: 1.9537| Local H loss: 0.0962  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2541 |Global loss: 1.2821| Local H loss: 0.0665  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2416 |Global loss: 1.0698| Local H loss: 0.0647  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2323 |Global loss: 0.8673| Local H loss: 0.0573  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2897 |Global loss: 2.0611| Local H loss: 0.103  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2376 |Global loss: 1.0393| Local H loss: 0.0629  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2288 |Global loss: 0.8918| Local H loss: 0.0605  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2232 |Global loss: 0.8365| Local H loss: 0.0546  | Global H loss: 0.0388 [0m
------------------------- time cost ------------------------- 7.474214792251587
Chosen Clients:  [12, 7, 0, 26, 6, 17, 8, 28, 20, 25, 18, 5]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.988, 0.961, 0.976, 0.857, 0.859, 0.75, 0.838, 0.949, 0.9, 0.915, 0.951, 0.988, 0.902, 0.924, 0.978, 0.944, 0.933, 0.912, 0.938, 0.925, 0.927, 0.99, 0.959, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.721, 75.475, 85.586, 79.641, 75.733, 81.457, 76.354, 70.357, 70.64, 73.13, 78.858, 79.195, 81.671, 80.869, 81.835, 91.494, 91.507, 90.812, 89.562, 88.652, 101.569, 80.786, 92.53, 95.336, 102.927, 97.912, 93.85, 94.39, 85.778, 95.768]
F1 Score:  [0.939, 0.873, 0.956, 0.986, 0.957, 0.972, 0.84, 0.867, 0.707, 0.824, 0.949, 0.891, 0.905, 0.952, 0.987, 0.901, 0.91, 0.974, 0.911, 0.926, 0.875, 0.918, 0.901, 0.922, 0.987, 0.951, 0.924, 0.796, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.957, 0.985, 0.959, 0.966, 0.837, 0.872, 0.755, 0.825, 0.949, 0.892, 0.905, 0.952, 0.99, 0.904, 0.913, 0.974, 0.911, 0.926, 0.885, 0.944, 0.903, 0.942, 0.986, 0.951, 0.917, 0.804, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5691
Averaged Test Accurancy: 0.9261
Averaged Test AUC: 0.9947
Averaged Test F1_score: 0.9141
Averaged Test Recal score: 0.9182
Std Test Accurancy: 0.0555
Std Test AUC: 0.0043
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2762 |Global loss: 1.8949| Local H loss: 0.0951  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2402 |Global loss: 1.1013| Local H loss: 0.065  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2445 |Global loss: 1.1129| Local H loss: 0.0569  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2271 |Global loss: 0.8663| Local H loss: 0.0557  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3012 |Global loss: 2.1815| Local H loss: 0.1058  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2461 |Global loss: 1.1614| Local H loss: 0.0677  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2405 |Global loss: 0.9423| Local H loss: 0.0604  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2225 |Global loss: 0.81| Local H loss: 0.0546  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.9222| Local H loss: 0.0972  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2378 |Global loss: 1.006| Local H loss: 0.0667  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2234 |Global loss: 0.779| Local H loss: 0.0551  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.7401| Local H loss: 0.0536  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2766 |Global loss: 1.7782| Local H loss: 0.0967  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2353 |Global loss: 0.9787| Local H loss: 0.0589  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2111 |Global loss: 0.7092| Local H loss: 0.0515  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2105 |Global loss: 0.6724| Local H loss: 0.0474  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3105 |Global loss: 2.165| Local H loss: 0.0995  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2462 |Global loss: 1.0772| Local H loss: 0.0644  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2421 |Global loss: 0.8744| Local H loss: 0.0587  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2521 |Global loss: 0.9521| Local H loss: 0.0567  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3028 |Global loss: 1.9665| Local H loss: 0.0994  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2623 |Global loss: 1.1001| Local H loss: 0.0647  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2574 |Global loss: 1.0535| Local H loss: 0.0622  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2409 |Global loss: 0.8684| Local H loss: 0.0518  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4827 |Global loss: 2.1997| Local H loss: 0.0909  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4239 |Global loss: 1.159| Local H loss: 0.0572  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4346 |Global loss: 1.0648| Local H loss: 0.0506  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4156 |Global loss: 0.9601| Local H loss: 0.0435  | Global H loss: 0.0261 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.284 |Global loss: 1.912| Local H loss: 0.1045  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.233 |Global loss: 1.0252| Local H loss: 0.0636  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2306 |Global loss: 0.9438| Local H loss: 0.0611  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2099 |Global loss: 0.683| Local H loss: 0.0496  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2655 |Global loss: 1.6591| Local H loss: 0.0943  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2251 |Global loss: 0.882| Local H loss: 0.0583  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2108 |Global loss: 0.6695| Local H loss: 0.0507  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2082 |Global loss: 0.6958| Local H loss: 0.0495  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2855 |Global loss: 1.9293| Local H loss: 0.0894  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2515 |Global loss: 1.3249| Local H loss: 0.0668  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2341 |Global loss: 0.9898| Local H loss: 0.0577  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2368 |Global loss: 0.9415| Local H loss: 0.0539  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3091 |Global loss: 1.8536| Local H loss: 0.105  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2615 |Global loss: 0.8675| Local H loss: 0.0652  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2211 |Global loss: 0.5872| Local H loss: 0.0459  | Global H loss: 0.0294 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2209 |Global loss: 0.5439| Local H loss: 0.0432  | Global H loss: 0.0275 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.317 |Global loss: 1.98| Local H loss: 0.105  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2716 |Global loss: 1.1516| Local H loss: 0.0633  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2474 |Global loss: 0.899| Local H loss: 0.0575  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2686 |Global loss: 0.9963| Local H loss: 0.0604  | Global H loss: 0.0392 [0m
------------------------- time cost ------------------------- 7.561249732971191
Chosen Clients:  [4, 10, 2, 5, 13, 18, 23, 7, 17, 16, 9, 28]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.988, 0.961, 0.951, 0.831, 0.873, 0.722, 0.838, 0.949, 0.9, 0.915, 0.951, 0.988, 0.902, 0.924, 0.978, 0.922, 0.933, 0.931, 0.938, 0.925, 0.927, 0.99, 0.98, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.729, 75.475, 85.586, 79.641, 75.733, 81.443, 76.316, 70.292, 70.713, 73.13, 78.858, 79.195, 81.659, 80.869, 81.835, 91.494, 91.507, 90.836, 89.58, 88.652, 101.59, 80.786, 92.53, 95.336, 102.927, 97.925, 93.862, 94.39, 85.792, 95.768]
F1 Score:  [0.939, 0.873, 0.956, 0.986, 0.957, 0.944, 0.806, 0.879, 0.667, 0.824, 0.949, 0.891, 0.905, 0.952, 0.987, 0.901, 0.91, 0.974, 0.88, 0.926, 0.906, 0.918, 0.901, 0.922, 0.987, 0.971, 0.924, 0.796, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.957, 0.985, 0.959, 0.944, 0.806, 0.887, 0.724, 0.825, 0.949, 0.892, 0.905, 0.952, 0.99, 0.904, 0.913, 0.974, 0.884, 0.926, 0.91, 0.944, 0.903, 0.942, 0.986, 0.968, 0.917, 0.804, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5445
Averaged Test Accurancy: 0.9249
Averaged Test AUC: 0.9948
Averaged Test F1_score: 0.9118
Averaged Test Recal score: 0.9164
Std Test Accurancy: 0.0591
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3269 |Global loss: 2.0884| Local H loss: 0.0947  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2728 |Global loss: 1.2579| Local H loss: 0.0639  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2592 |Global loss: 1.1137| Local H loss: 0.0578  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2388 |Global loss: 0.9145| Local H loss: 0.0555  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2867 |Global loss: 1.9198| Local H loss: 0.0994  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2372 |Global loss: 1.0603| Local H loss: 0.0654  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2319 |Global loss: 0.9392| Local H loss: 0.0614  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2201 |Global loss: 0.7969| Local H loss: 0.0513  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3001 |Global loss: 2.0288| Local H loss: 0.1036  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2489 |Global loss: 1.1305| Local H loss: 0.0653  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2372 |Global loss: 0.8751| Local H loss: 0.0618  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2465 |Global loss: 0.9513| Local H loss: 0.062  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3243 |Global loss: 2.0181| Local H loss: 0.1043  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2556 |Global loss: 1.2002| Local H loss: 0.066  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2487 |Global loss: 0.9031| Local H loss: 0.0594  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2458 |Global loss: 0.8541| Local H loss: 0.0545  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3262 |Global loss: 1.9827| Local H loss: 0.099  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2645 |Global loss: 1.2239| Local H loss: 0.0653  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2399 |Global loss: 0.888| Local H loss: 0.0573  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.249 |Global loss: 0.7957| Local H loss: 0.0513  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3088 |Global loss: 1.732| Local H loss: 0.1009  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2348 |Global loss: 0.695| Local H loss: 0.0536  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2218 |Global loss: 0.5981| Local H loss: 0.0459  | Global H loss: 0.0294 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2141 |Global loss: 0.5548| Local H loss: 0.0451  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2794 |Global loss: 1.885| Local H loss: 0.0993  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2212 |Global loss: 0.9388| Local H loss: 0.0576  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2225 |Global loss: 0.8305| Local H loss: 0.0543  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2236 |Global loss: 0.8179| Local H loss: 0.054  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2876 |Global loss: 2.0083| Local H loss: 0.0974  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.233 |Global loss: 0.9916| Local H loss: 0.0608  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2316 |Global loss: 0.9128| Local H loss: 0.0576  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2385 |Global loss: 0.9381| Local H loss: 0.0533  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2996 |Global loss: 1.9163| Local H loss: 0.0991  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2473 |Global loss: 1.1946| Local H loss: 0.0619  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.243 |Global loss: 0.995| Local H loss: 0.0587  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2299 |Global loss: 0.8039| Local H loss: 0.0529  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.334 |Global loss: 1.9585| Local H loss: 0.0951  | Global H loss: 0.0525 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2964 |Global loss: 1.3233| Local H loss: 0.0679  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2705 |Global loss: 1.0414| Local H loss: 0.0644  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2854 |Global loss: 0.914| Local H loss: 0.0506  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3787 |Global loss: 2.1993| Local H loss: 0.0872  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3455 |Global loss: 1.6879| Local H loss: 0.0657  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3357 |Global loss: 1.2933| Local H loss: 0.0627  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3525 |Global loss: 0.9625| Local H loss: 0.0531  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2892 |Global loss: 2.0887| Local H loss: 0.103  | Global H loss: 0.0597 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2329 |Global loss: 0.9942| Local H loss: 0.0612  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.8837| Local H loss: 0.0566  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2045 |Global loss: 0.6226| Local H loss: 0.0495  | Global H loss: 0.0332 [0m
------------------------- time cost ------------------------- 7.168821573257446
Chosen Clients:  [8, 17, 20, 24, 3, 18, 11, 22, 12, 27, 10, 19]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.988, 0.882, 0.951, 0.831, 0.873, 0.722, 0.878, 0.937, 0.9, 0.915, 1.0, 0.988, 0.902, 0.924, 0.978, 0.922, 0.933, 0.931, 0.938, 0.925, 0.917, 0.99, 0.98, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.729, 75.475, 85.686, 79.641, 75.535, 81.468, 76.316, 70.301, 70.713, 73.174, 78.829, 79.195, 81.659, 80.899, 81.835, 91.494, 91.598, 90.852, 89.599, 88.652, 101.59, 80.786, 92.53, 95.343, 102.927, 97.925, 93.862, 94.39, 85.816, 95.768]
F1 Score:  [0.939, 0.873, 0.965, 0.986, 0.853, 0.941, 0.806, 0.878, 0.667, 0.863, 0.938, 0.891, 0.905, 1.0, 0.987, 0.901, 0.914, 0.974, 0.875, 0.926, 0.906, 0.918, 0.901, 0.91, 0.987, 0.971, 0.924, 0.796, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.967, 0.985, 0.859, 0.94, 0.806, 0.887, 0.724, 0.861, 0.939, 0.892, 0.905, 1.0, 0.99, 0.904, 0.918, 0.974, 0.886, 0.926, 0.91, 0.944, 0.903, 0.93, 0.986, 0.968, 0.917, 0.804, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5339
Averaged Test Accurancy: 0.9249
Averaged Test AUC: 0.9948
Averaged Test F1_score: 0.9106
Averaged Test Recal score: 0.9155
Std Test Accurancy: 0.0592
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4748 |Global loss: 2.1879| Local H loss: 0.0935  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4284 |Global loss: 1.3222| Local H loss: 0.061  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4325 |Global loss: 1.1174| Local H loss: 0.056  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4041 |Global loss: 0.9462| Local H loss: 0.0481  | Global H loss: 0.0275 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3039 |Global loss: 2.086| Local H loss: 0.0986  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2488 |Global loss: 1.2484| Local H loss: 0.0668  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2444 |Global loss: 1.0863| Local H loss: 0.0591  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2415 |Global loss: 1.0055| Local H loss: 0.0568  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2707 |Global loss: 1.7006| Local H loss: 0.0924  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2236 |Global loss: 0.8659| Local H loss: 0.0556  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2177 |Global loss: 0.8202| Local H loss: 0.0551  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2025 |Global loss: 0.6278| Local H loss: 0.0471  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3077 |Global loss: 1.9775| Local H loss: 0.093  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.258 |Global loss: 1.2053| Local H loss: 0.0695  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.243 |Global loss: 0.9675| Local H loss: 0.0629  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2397 |Global loss: 0.8559| Local H loss: 0.063  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3417 |Global loss: 2.0941| Local H loss: 0.0996  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3014 |Global loss: 1.4317| Local H loss: 0.0644  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2775 |Global loss: 1.1644| Local H loss: 0.0604  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2731 |Global loss: 1.0913| Local H loss: 0.0594  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3029 |Global loss: 1.7288| Local H loss: 0.1062  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2408 |Global loss: 0.831| Local H loss: 0.0617  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2173 |Global loss: 0.6211| Local H loss: 0.0506  | Global H loss: 0.0323 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2142 |Global loss: 0.5712| Local H loss: 0.0483  | Global H loss: 0.0313 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3126 |Global loss: 2.0572| Local H loss: 0.0965  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2586 |Global loss: 1.1429| Local H loss: 0.0608  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2484 |Global loss: 0.9249| Local H loss: 0.0594  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2401 |Global loss: 0.8202| Local H loss: 0.053  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2913 |Global loss: 1.829| Local H loss: 0.0933  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.263 |Global loss: 1.0908| Local H loss: 0.0616  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2515 |Global loss: 0.9975| Local H loss: 0.0541  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2382 |Global loss: 0.8876| Local H loss: 0.0546  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.283 |Global loss: 1.9777| Local H loss: 0.0971  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2301 |Global loss: 1.0751| Local H loss: 0.0645  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2305 |Global loss: 0.8592| Local H loss: 0.0588  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2387 |Global loss: 0.9636| Local H loss: 0.0618  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4249 |Global loss: 2.1525| Local H loss: 0.0905  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4065 |Global loss: 1.4961| Local H loss: 0.0683  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3821 |Global loss: 1.0875| Local H loss: 0.0561  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3644 |Global loss: 1.0007| Local H loss: 0.0527  | Global H loss: 0.0298 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2831 |Global loss: 2.0026| Local H loss: 0.0989  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.234 |Global loss: 1.0841| Local H loss: 0.0643  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2244 |Global loss: 0.9511| Local H loss: 0.0603  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2278 |Global loss: 0.8766| Local H loss: 0.0539  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2948 |Global loss: 1.7808| Local H loss: 0.0954  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.234 |Global loss: 0.9616| Local H loss: 0.058  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.8534| Local H loss: 0.058  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2246 |Global loss: 0.8335| Local H loss: 0.0517  | Global H loss: 0.0379 [0m
------------------------- time cost ------------------------- 7.724883317947388
Chosen Clients:  [0, 26, 19, 6, 8, 2, 12, 29, 14, 5, 23, 28]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.882, 0.951, 0.831, 0.873, 0.736, 0.878, 0.962, 0.9, 0.927, 1.0, 0.988, 0.902, 0.924, 0.978, 0.922, 0.944, 0.902, 0.938, 0.914, 0.917, 1.0, 0.98, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.729, 75.475, 85.686, 79.624, 75.535, 81.468, 76.316, 70.301, 70.626, 73.174, 78.864, 79.16, 81.682, 80.899, 81.835, 91.494, 91.598, 90.856, 89.589, 88.638, 101.55, 80.786, 92.581, 95.343, 102.933, 97.925, 93.862, 94.414, 85.816, 95.768]
F1 Score:  [0.939, 0.873, 0.965, 0.96, 0.853, 0.941, 0.806, 0.878, 0.669, 0.863, 0.963, 0.891, 0.919, 1.0, 0.987, 0.901, 0.914, 0.974, 0.875, 0.937, 0.862, 0.918, 0.889, 0.91, 1.0, 0.971, 0.924, 0.793, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.967, 0.961, 0.859, 0.94, 0.806, 0.887, 0.757, 0.861, 0.963, 0.892, 0.919, 1.0, 0.99, 0.904, 0.918, 0.974, 0.886, 0.937, 0.872, 0.944, 0.889, 0.93, 1.0, 0.968, 0.917, 0.806, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.5223
Averaged Test Accurancy: 0.9249
Averaged Test AUC: 0.9948
Averaged Test F1_score: 0.9099
Averaged Test Recal score: 0.9163
Std Test Accurancy: 0.0579
Std Test AUC: 0.0044
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2814 |Global loss: 1.8206| Local H loss: 0.0975  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2367 |Global loss: 1.0714| Local H loss: 0.0667  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2255 |Global loss: 0.8191| Local H loss: 0.0555  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2171 |Global loss: 0.723| Local H loss: 0.0522  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2867 |Global loss: 1.7955| Local H loss: 0.0999  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2319 |Global loss: 0.8739| Local H loss: 0.0583  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.219 |Global loss: 0.834| Local H loss: 0.0541  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2248 |Global loss: 0.7373| Local H loss: 0.0494  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2765 |Global loss: 1.7657| Local H loss: 0.0997  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2352 |Global loss: 1.0648| Local H loss: 0.0571  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2327 |Global loss: 0.8165| Local H loss: 0.0533  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2315 |Global loss: 0.8346| Local H loss: 0.0538  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2931 |Global loss: 1.9739| Local H loss: 0.097  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2606 |Global loss: 1.6567| Local H loss: 0.0671  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2478 |Global loss: 0.9557| Local H loss: 0.062  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2404 |Global loss: 0.9393| Local H loss: 0.0604  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.479 |Global loss: 2.1199| Local H loss: 0.0916  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4357 |Global loss: 1.5456| Local H loss: 0.0658  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4109 |Global loss: 1.0941| Local H loss: 0.0545  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4163 |Global loss: 1.0198| Local H loss: 0.0485  | Global H loss: 0.0288 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2925 |Global loss: 2.0231| Local H loss: 0.1011  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2428 |Global loss: 1.1621| Local H loss: 0.0607  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2302 |Global loss: 0.8631| Local H loss: 0.0601  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2311 |Global loss: 0.869| Local H loss: 0.0566  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2879 |Global loss: 2.0272| Local H loss: 0.1002  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2391 |Global loss: 1.1752| Local H loss: 0.0644  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2286 |Global loss: 0.9764| Local H loss: 0.061  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2295 |Global loss: 0.9316| Local H loss: 0.0563  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2799 |Global loss: 1.9751| Local H loss: 0.0962  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2406 |Global loss: 1.2111| Local H loss: 0.0687  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2281 |Global loss: 0.9796| Local H loss: 0.0615  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2344 |Global loss: 0.9244| Local H loss: 0.0609  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.283 |Global loss: 1.8811| Local H loss: 0.0992  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2358 |Global loss: 0.89| Local H loss: 0.0623  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2324 |Global loss: 0.8719| Local H loss: 0.0561  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.7635| Local H loss: 0.0554  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3092 |Global loss: 2.0346| Local H loss: 0.1038  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2537 |Global loss: 1.0229| Local H loss: 0.0628  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2489 |Global loss: 0.8784| Local H loss: 0.0601  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2462 |Global loss: 0.8283| Local H loss: 0.0543  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2952 |Global loss: 1.8438| Local H loss: 0.0997  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2299 |Global loss: 0.9102| Local H loss: 0.0566  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2251 |Global loss: 0.8704| Local H loss: 0.0575  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2149 |Global loss: 0.7754| Local H loss: 0.0547  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2907 |Global loss: 1.917| Local H loss: 0.102  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 1.0293| Local H loss: 0.0646  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2241 |Global loss: 0.8047| Local H loss: 0.0597  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2191 |Global loss: 0.7339| Local H loss: 0.0503  | Global H loss: 0.0352 [0m
------------------------- time cost ------------------------- 7.475015878677368
Chosen Clients:  [0, 5, 13, 15, 9, 8, 3, 10, 2, 16, 19, 7]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.963, 0.882, 0.963, 0.857, 0.873, 0.764, 0.878, 0.962, 0.9, 0.939, 1.0, 0.988, 0.902, 0.924, 0.978, 0.922, 0.944, 0.902, 0.938, 0.914, 0.917, 1.0, 0.98, 0.947, 0.812, 0.977, 0.938]
AUC in each clients:  [86.73, 75.475, 85.681, 79.624, 75.535, 81.514, 76.368, 70.301, 70.814, 73.174, 78.864, 79.16, 81.717, 80.899, 81.827, 91.494, 91.598, 90.856, 89.589, 88.65, 101.55, 80.786, 92.581, 95.357, 102.933, 97.925, 93.863, 94.414, 85.757, 95.817]
F1 Score:  [0.939, 0.873, 0.956, 0.96, 0.853, 0.959, 0.84, 0.878, 0.719, 0.863, 0.963, 0.891, 0.934, 1.0, 0.987, 0.901, 0.914, 0.974, 0.875, 0.938, 0.862, 0.918, 0.889, 0.91, 1.0, 0.971, 0.924, 0.793, 0.979, 0.921]
Recall Score:  [0.928, 0.886, 0.957, 0.961, 0.859, 0.955, 0.837, 0.887, 0.767, 0.861, 0.963, 0.892, 0.933, 1.0, 0.99, 0.904, 0.918, 0.974, 0.886, 0.939, 0.872, 0.944, 0.889, 0.93, 1.0, 0.968, 0.917, 0.806, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4879
Averaged Test Accurancy: 0.9261
Averaged Test AUC: 0.9949
Averaged Test F1_score: 0.9128
Averaged Test Recal score: 0.9176
Std Test Accurancy: 0.0534
Std Test AUC: 0.0041
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2838 |Global loss: 1.8429| Local H loss: 0.097  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2365 |Global loss: 0.9984| Local H loss: 0.0647  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2253 |Global loss: 0.8679| Local H loss: 0.0557  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2177 |Global loss: 0.7444| Local H loss: 0.053  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3138 |Global loss: 2.1165| Local H loss: 0.1081  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2503 |Global loss: 0.9877| Local H loss: 0.0636  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.247 |Global loss: 0.9676| Local H loss: 0.0602  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.224 |Global loss: 0.7674| Local H loss: 0.0547  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3178 |Global loss: 2.1193| Local H loss: 0.1003  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.259 |Global loss: 1.1561| Local H loss: 0.0652  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2726 |Global loss: 1.0946| Local H loss: 0.0578  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2521 |Global loss: 0.9882| Local H loss: 0.0577  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3773 |Global loss: 2.079| Local H loss: 0.0914  | Global H loss: 0.0531 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3454 |Global loss: 1.2238| Local H loss: 0.0667  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.302 |Global loss: 0.9511| Local H loss: 0.0531  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2962 |Global loss: 0.9115| Local H loss: 0.0534  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3887 |Global loss: 2.3544| Local H loss: 0.0898  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3716 |Global loss: 1.6728| Local H loss: 0.073  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3412 |Global loss: 1.4129| Local H loss: 0.0638  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3285 |Global loss: 1.1425| Local H loss: 0.0621  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.457 |Global loss: 2.2132| Local H loss: 0.089  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4164 |Global loss: 1.3262| Local H loss: 0.058  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3951 |Global loss: 0.9333| Local H loss: 0.0484  | Global H loss: 0.028 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.376 |Global loss: 0.8735| Local H loss: 0.0438  | Global H loss: 0.0262 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3319 |Global loss: 2.0131| Local H loss: 0.0976  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2828 |Global loss: 1.2948| Local H loss: 0.0652  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2625 |Global loss: 1.142| Local H loss: 0.0591  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2644 |Global loss: 1.1147| Local H loss: 0.0615  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2828 |Global loss: 2.0013| Local H loss: 0.1002  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2362 |Global loss: 1.1364| Local H loss: 0.0658  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2255 |Global loss: 0.9006| Local H loss: 0.0598  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2096 |Global loss: 0.7079| Local H loss: 0.0518  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2912 |Global loss: 1.9249| Local H loss: 0.1032  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2397 |Global loss: 1.0942| Local H loss: 0.065  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2326 |Global loss: 0.842| Local H loss: 0.0666  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2241 |Global loss: 0.7435| Local H loss: 0.0579  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3254 |Global loss: 1.8927| Local H loss: 0.0978  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2806 |Global loss: 1.2449| Local H loss: 0.0695  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2837 |Global loss: 0.976| Local H loss: 0.0595  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2582 |Global loss: 0.8324| Local H loss: 0.051  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2772 |Global loss: 1.8617| Local H loss: 0.0975  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.226 |Global loss: 0.9219| Local H loss: 0.0574  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.8118| Local H loss: 0.0518  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2225 |Global loss: 0.7866| Local H loss: 0.0534  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.287 |Global loss: 2.0468| Local H loss: 0.0985  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.0413| Local H loss: 0.0632  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2238 |Global loss: 0.85| Local H loss: 0.0542  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.8321| Local H loss: 0.0533  | Global H loss: 0.0399 [0m
------------------------- time cost ------------------------- 7.823949813842773
Chosen Clients:  [4, 15, 19, 29, 21, 27, 28, 9, 3, 1, 22, 0]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.882, 0.951, 0.857, 0.859, 0.736, 0.811, 0.949, 0.9, 0.939, 0.951, 0.988, 0.87, 0.924, 0.978, 0.922, 0.944, 0.902, 0.938, 0.914, 0.917, 1.0, 0.98, 0.947, 0.812, 0.977, 0.938]
AUC in each clients:  [86.762, 75.475, 85.628, 79.691, 75.535, 81.532, 76.368, 70.27, 70.841, 73.193, 78.852, 79.16, 81.717, 80.944, 81.827, 91.369, 91.709, 90.856, 89.589, 88.68, 101.55, 80.786, 92.581, 95.357, 102.933, 97.925, 93.863, 94.414, 85.757, 95.817]
F1 Score:  [0.939, 0.873, 0.976, 0.973, 0.853, 0.941, 0.84, 0.862, 0.694, 0.798, 0.949, 0.891, 0.934, 0.952, 0.987, 0.864, 0.917, 0.974, 0.875, 0.938, 0.862, 0.918, 0.889, 0.91, 1.0, 0.971, 0.924, 0.793, 0.979, 0.921]
Recall Score:  [0.928, 0.886, 0.978, 0.973, 0.859, 0.94, 0.837, 0.875, 0.743, 0.802, 0.949, 0.892, 0.933, 0.952, 0.99, 0.873, 0.918, 0.974, 0.886, 0.939, 0.872, 0.944, 0.889, 0.93, 1.0, 0.968, 0.917, 0.806, 0.981, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4536
Averaged Test Accurancy: 0.9207
Averaged Test AUC: 0.9950
Averaged Test F1_score: 0.9066
Averaged Test Recal score: 0.9119
Std Test Accurancy: 0.0592
Std Test AUC: 0.0041
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3146 |Global loss: 2.0545| Local H loss: 0.0971  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2575 |Global loss: 1.0523| Local H loss: 0.0632  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2486 |Global loss: 1.1983| Local H loss: 0.0548  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2384 |Global loss: 0.8985| Local H loss: 0.0582  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3661 |Global loss: 2.0425| Local H loss: 0.0931  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3136 |Global loss: 1.0627| Local H loss: 0.0596  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2963 |Global loss: 0.9493| Local H loss: 0.0507  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2892 |Global loss: 0.7953| Local H loss: 0.0507  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2824 |Global loss: 1.8432| Local H loss: 0.1007  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2328 |Global loss: 1.0738| Local H loss: 0.0579  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2242 |Global loss: 0.85| Local H loss: 0.0559  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2325 |Global loss: 0.95| Local H loss: 0.0542  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2795 |Global loss: 2.181| Local H loss: 0.1005  | Global H loss: 0.0612 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2437 |Global loss: 1.3254| Local H loss: 0.0704  | Global H loss: 0.0515 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2344 |Global loss: 1.0737| Local H loss: 0.0642  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.232 |Global loss: 0.9797| Local H loss: 0.0624  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2978 |Global loss: 1.9892| Local H loss: 0.1038  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2269 |Global loss: 0.9989| Local H loss: 0.0598  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2291 |Global loss: 0.9303| Local H loss: 0.0584  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2052 |Global loss: 0.6455| Local H loss: 0.0497  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4115 |Global loss: 1.9858| Local H loss: 0.083  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3808 |Global loss: 1.1262| Local H loss: 0.058  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3713 |Global loss: 1.0346| Local H loss: 0.0519  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3663 |Global loss: 0.9952| Local H loss: 0.0512  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.282 |Global loss: 1.8657| Local H loss: 0.1015  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2318 |Global loss: 1.1078| Local H loss: 0.0623  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2229 |Global loss: 0.8087| Local H loss: 0.0552  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.215 |Global loss: 0.6992| Local H loss: 0.0529  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3599 |Global loss: 2.1235| Local H loss: 0.0903  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3632 |Global loss: 1.7409| Local H loss: 0.0643  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3351 |Global loss: 1.532| Local H loss: 0.0666  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3169 |Global loss: 1.1699| Local H loss: 0.0634  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3194 |Global loss: 2.104| Local H loss: 0.102  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2818 |Global loss: 1.3268| Local H loss: 0.0687  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2674 |Global loss: 1.0851| Local H loss: 0.0649  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2564 |Global loss: 1.0666| Local H loss: 0.0602  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.286 |Global loss: 2.0728| Local H loss: 0.0949  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2452 |Global loss: 1.1194| Local H loss: 0.0674  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2294 |Global loss: 0.9211| Local H loss: 0.0584  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2277 |Global loss: 0.8237| Local H loss: 0.0579  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3031 |Global loss: 1.9487| Local H loss: 0.0956  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2585 |Global loss: 1.1647| Local H loss: 0.056  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2503 |Global loss: 1.0359| Local H loss: 0.0562  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2438 |Global loss: 0.9353| Local H loss: 0.0545  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.28 |Global loss: 1.9605| Local H loss: 0.1001  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2384 |Global loss: 1.111| Local H loss: 0.0668  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2203 |Global loss: 0.8242| Local H loss: 0.0581  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.217 |Global loss: 0.7229| Local H loss: 0.0538  | Global H loss: 0.036 [0m
------------------------- time cost ------------------------- 7.998605966567993
Chosen Clients:  [9, 1, 7, 19, 15, 13, 5, 21, 25, 10, 6, 29]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.963, 0.974, 0.951, 0.857, 0.859, 0.736, 0.851, 0.949, 0.9, 0.939, 0.951, 0.988, 0.88, 0.924, 0.978, 0.922, 0.921, 0.902, 0.951, 0.935, 0.917, 1.0, 0.98, 0.947, 0.812, 0.988, 0.938]
AUC in each clients:  [86.753, 75.475, 85.628, 79.66, 75.795, 81.532, 76.368, 70.27, 70.841, 73.251, 78.852, 79.16, 81.717, 80.944, 81.827, 91.446, 91.709, 90.856, 89.589, 88.657, 101.55, 80.833, 92.579, 95.357, 102.933, 97.925, 93.863, 94.329, 85.792, 95.847]
F1 Score:  [0.939, 0.885, 0.976, 0.961, 0.971, 0.941, 0.84, 0.862, 0.694, 0.83, 0.949, 0.891, 0.934, 0.952, 0.987, 0.874, 0.917, 0.974, 0.875, 0.913, 0.862, 0.931, 0.916, 0.91, 1.0, 0.971, 0.924, 0.793, 0.989, 0.921]
Recall Score:  [0.928, 0.902, 0.978, 0.964, 0.974, 0.94, 0.837, 0.875, 0.743, 0.838, 0.949, 0.892, 0.933, 0.952, 0.99, 0.882, 0.918, 0.974, 0.886, 0.913, 0.872, 0.955, 0.917, 0.93, 1.0, 0.968, 0.917, 0.815, 0.991, 0.923]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4417
Averaged Test Accurancy: 0.9257
Averaged Test AUC: 0.9951
Averaged Test F1_score: 0.9127
Averaged Test Recal score: 0.9185
Std Test Accurancy: 0.0570
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3584 |Global loss: 2.167| Local H loss: 0.0863  | Global H loss: 0.0531 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3369 |Global loss: 1.7124| Local H loss: 0.07  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3251 |Global loss: 1.1922| Local H loss: 0.0612  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3099 |Global loss: 0.9605| Local H loss: 0.0564  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2847 |Global loss: 1.9441| Local H loss: 0.0975  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2482 |Global loss: 1.1537| Local H loss: 0.0688  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2403 |Global loss: 1.1305| Local H loss: 0.0588  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2296 |Global loss: 0.9541| Local H loss: 0.0577  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2842 |Global loss: 2.0089| Local H loss: 0.1032  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2375 |Global loss: 1.0229| Local H loss: 0.0621  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 0.9586| Local H loss: 0.0572  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2113 |Global loss: 0.7229| Local H loss: 0.0551  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2807 |Global loss: 1.8872| Local H loss: 0.1013  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2455 |Global loss: 1.1249| Local H loss: 0.0668  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2269 |Global loss: 1.003| Local H loss: 0.057  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2169 |Global loss: 0.767| Local H loss: 0.054  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3586 |Global loss: 2.0518| Local H loss: 0.0922  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3079 |Global loss: 1.1808| Local H loss: 0.0647  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3101 |Global loss: 1.029| Local H loss: 0.0545  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3119 |Global loss: 0.9121| Local H loss: 0.0526  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.298 |Global loss: 1.993| Local H loss: 0.0969  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.27 |Global loss: 1.1394| Local H loss: 0.0615  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2464 |Global loss: 0.8742| Local H loss: 0.0567  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2428 |Global loss: 0.8309| Local H loss: 0.0545  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.303 |Global loss: 2.0472| Local H loss: 0.1016  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2602 |Global loss: 1.1714| Local H loss: 0.0645  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2434 |Global loss: 0.9907| Local H loss: 0.0563  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2327 |Global loss: 0.771| Local H loss: 0.0526  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2939 |Global loss: 1.9815| Local H loss: 0.1051  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2405 |Global loss: 1.1151| Local H loss: 0.066  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.235 |Global loss: 1.0498| Local H loss: 0.0595  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2231 |Global loss: 0.88| Local H loss: 0.052  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2862 |Global loss: 1.8909| Local H loss: 0.0922  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2326 |Global loss: 0.9852| Local H loss: 0.0607  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2268 |Global loss: 0.8318| Local H loss: 0.0573  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2124 |Global loss: 0.6633| Local H loss: 0.0498  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2797 |Global loss: 1.9277| Local H loss: 0.0978  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2431 |Global loss: 1.2807| Local H loss: 0.061  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2243 |Global loss: 0.8727| Local H loss: 0.0568  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2199 |Global loss: 0.7975| Local H loss: 0.0529  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2978 |Global loss: 2.052| Local H loss: 0.1038  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2433 |Global loss: 0.9962| Local H loss: 0.0639  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2337 |Global loss: 0.8853| Local H loss: 0.0569  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.7401| Local H loss: 0.0537  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.279 |Global loss: 2.1616| Local H loss: 0.0935  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2407 |Global loss: 1.296| Local H loss: 0.0661  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2378 |Global loss: 1.161| Local H loss: 0.0619  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2255 |Global loss: 0.9095| Local H loss: 0.059  | Global H loss: 0.0409 [0m
------------------------- time cost ------------------------- 7.1270530223846436
Chosen Clients:  [23, 22, 15, 3, 27, 5, 0, 4, 7, 29, 10, 20]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.963, 0.974, 0.963, 0.87, 0.831, 0.736, 0.878, 0.937, 0.9, 0.939, 0.963, 0.988, 0.88, 0.924, 0.978, 0.922, 0.933, 0.902, 0.951, 0.935, 0.917, 1.0, 0.969, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.753, 75.483, 85.628, 79.66, 75.795, 81.529, 76.391, 70.195, 70.841, 73.249, 78.841, 79.16, 81.717, 80.929, 81.827, 91.502, 91.709, 90.856, 89.589, 88.681, 101.55, 80.863, 92.579, 95.357, 102.933, 97.902, 93.863, 94.329, 85.792, 95.835]
F1 Score:  [0.939, 0.886, 0.976, 0.961, 0.971, 0.956, 0.85, 0.834, 0.694, 0.863, 0.938, 0.891, 0.934, 0.962, 0.987, 0.878, 0.917, 0.974, 0.875, 0.926, 0.862, 0.931, 0.916, 0.91, 1.0, 0.965, 0.924, 0.793, 0.989, 0.933]
Recall Score:  [0.928, 0.897, 0.978, 0.964, 0.974, 0.959, 0.849, 0.85, 0.743, 0.861, 0.939, 0.892, 0.933, 0.962, 0.99, 0.885, 0.918, 0.974, 0.886, 0.926, 0.872, 0.955, 0.917, 0.93, 1.0, 0.966, 0.917, 0.815, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.4081
Averaged Test Accurancy: 0.9269
Averaged Test AUC: 0.9951
Averaged Test F1_score: 0.9145
Averaged Test Recal score: 0.9202
Std Test Accurancy: 0.0571
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2819 |Global loss: 1.8005| Local H loss: 0.1012  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2224 |Global loss: 0.8426| Local H loss: 0.0569  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.219 |Global loss: 0.8776| Local H loss: 0.055  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2208 |Global loss: 0.7927| Local H loss: 0.0521  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2942 |Global loss: 1.8879| Local H loss: 0.0959  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2535 |Global loss: 1.0586| Local H loss: 0.0579  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2442 |Global loss: 0.9967| Local H loss: 0.0561  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2428 |Global loss: 0.9292| Local H loss: 0.0515  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3537 |Global loss: 2.2559| Local H loss: 0.0913  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3272 |Global loss: 1.3097| Local H loss: 0.0632  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2956 |Global loss: 0.9297| Local H loss: 0.0554  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2869 |Global loss: 0.8744| Local H loss: 0.0537  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3026 |Global loss: 2.0819| Local H loss: 0.1015  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.275 |Global loss: 1.3303| Local H loss: 0.0629  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2819 |Global loss: 1.0674| Local H loss: 0.0588  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2643 |Global loss: 1.0634| Local H loss: 0.0589  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4276 |Global loss: 2.0044| Local H loss: 0.0909  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3799 |Global loss: 1.3408| Local H loss: 0.0641  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3789 |Global loss: 1.0881| Local H loss: 0.0575  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3516 |Global loss: 1.0007| Local H loss: 0.055  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3015 |Global loss: 1.9883| Local H loss: 0.1054  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2419 |Global loss: 1.0586| Local H loss: 0.0589  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2337 |Global loss: 0.8249| Local H loss: 0.0582  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2343 |Global loss: 0.7829| Local H loss: 0.055  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2777 |Global loss: 1.87| Local H loss: 0.0981  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2401 |Global loss: 1.0974| Local H loss: 0.0722  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2249 |Global loss: 0.9023| Local H loss: 0.0591  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2097 |Global loss: 0.6831| Local H loss: 0.0511  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3035 |Global loss: 2.0956| Local H loss: 0.1022  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2836 |Global loss: 1.2065| Local H loss: 0.065  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.243 |Global loss: 0.9846| Local H loss: 0.0589  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2394 |Global loss: 0.9524| Local H loss: 0.057  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2858 |Global loss: 2.0744| Local H loss: 0.1034  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2389 |Global loss: 1.0078| Local H loss: 0.0654  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2165 |Global loss: 0.7642| Local H loss: 0.0585  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.228 |Global loss: 0.8496| Local H loss: 0.0588  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2722 |Global loss: 2.0827| Local H loss: 0.0911  | Global H loss: 0.0597 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2425 |Global loss: 1.3588| Local H loss: 0.0696  | Global H loss: 0.0504 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2288 |Global loss: 1.0194| Local H loss: 0.0615  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2261 |Global loss: 0.9545| Local H loss: 0.0586  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2849 |Global loss: 2.0417| Local H loss: 0.1024  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2481 |Global loss: 1.2943| Local H loss: 0.0607  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.228 |Global loss: 0.9362| Local H loss: 0.0573  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2133 |Global loss: 0.7739| Local H loss: 0.0527  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2685 |Global loss: 1.6044| Local H loss: 0.0988  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2205 |Global loss: 0.8921| Local H loss: 0.0574  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2081 |Global loss: 0.643| Local H loss: 0.0519  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2018 |Global loss: 0.6082| Local H loss: 0.044  | Global H loss: 0.0307 [0m
------------------------- time cost ------------------------- 7.424849987030029
Chosen Clients:  [16, 29, 20, 0, 15, 21, 17, 18, 13, 22, 8, 7]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.975, 0.934, 0.963, 0.87, 0.859, 0.736, 0.878, 0.949, 0.9, 0.939, 0.963, 0.988, 0.924, 0.924, 0.978, 0.922, 0.933, 0.941, 0.951, 0.914, 0.917, 1.0, 0.969, 0.947, 0.812, 0.988, 0.958]
AUC in each clients:  [86.763, 75.483, 85.628, 79.712, 75.703, 81.475, 76.391, 70.309, 70.841, 73.249, 78.871, 79.16, 81.717, 80.929, 81.827, 91.588, 91.709, 90.856, 89.589, 88.681, 101.509, 80.863, 92.597, 95.386, 102.933, 97.902, 93.863, 94.442, 85.792, 95.875]
F1 Score:  [0.939, 0.886, 0.976, 0.975, 0.924, 0.959, 0.85, 0.862, 0.694, 0.863, 0.949, 0.891, 0.934, 0.962, 0.987, 0.921, 0.917, 0.974, 0.875, 0.926, 0.921, 0.931, 0.889, 0.91, 1.0, 0.965, 0.924, 0.794, 0.989, 0.948]
Recall Score:  [0.928, 0.897, 0.978, 0.973, 0.92, 0.963, 0.849, 0.875, 0.743, 0.861, 0.949, 0.892, 0.933, 0.962, 0.99, 0.924, 0.918, 0.974, 0.886, 0.926, 0.923, 0.955, 0.889, 0.93, 1.0, 0.966, 0.917, 0.817, 0.991, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.3919
Averaged Test Accurancy: 0.9300
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9178
Averaged Test Recal score: 0.9226
Std Test Accurancy: 0.0549
Std Test AUC: 0.0040
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3022 |Global loss: 1.8477| Local H loss: 0.0979  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2675 |Global loss: 1.1822| Local H loss: 0.0683  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2637 |Global loss: 1.0704| Local H loss: 0.0579  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2453 |Global loss: 0.9099| Local H loss: 0.0558  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2748 |Global loss: 1.9751| Local H loss: 0.0888  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2338 |Global loss: 1.197| Local H loss: 0.063  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2302 |Global loss: 1.0198| Local H loss: 0.0644  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.223 |Global loss: 0.9019| Local H loss: 0.0627  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2738 |Global loss: 1.7553| Local H loss: 0.0997  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2265 |Global loss: 0.8526| Local H loss: 0.0585  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.225 |Global loss: 0.8949| Local H loss: 0.0565  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2056 |Global loss: 0.6467| Local H loss: 0.0503  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2738 |Global loss: 1.9115| Local H loss: 0.0952  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2342 |Global loss: 1.1189| Local H loss: 0.0647  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.8674| Local H loss: 0.0561  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2245 |Global loss: 0.7863| Local H loss: 0.0538  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3693 |Global loss: 2.0816| Local H loss: 0.0907  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3304 |Global loss: 1.2579| Local H loss: 0.0635  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3048 |Global loss: 1.0061| Local H loss: 0.0548  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2954 |Global loss: 0.94| Local H loss: 0.0511  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2856 |Global loss: 1.7835| Local H loss: 0.0981  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2274 |Global loss: 0.8673| Local H loss: 0.0571  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2146 |Global loss: 0.7016| Local H loss: 0.0545  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2284 |Global loss: 0.8317| Local H loss: 0.0511  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2999 |Global loss: 1.9292| Local H loss: 0.0931  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2513 |Global loss: 1.1094| Local H loss: 0.0641  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2401 |Global loss: 1.0031| Local H loss: 0.0579  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2386 |Global loss: 0.9573| Local H loss: 0.0557  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2979 |Global loss: 1.7538| Local H loss: 0.1024  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2471 |Global loss: 0.7662| Local H loss: 0.0609  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.209 |Global loss: 0.5762| Local H loss: 0.0477  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2354 |Global loss: 0.6243| Local H loss: 0.054  | Global H loss: 0.0334 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3012 |Global loss: 1.9919| Local H loss: 0.0936  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2769 |Global loss: 1.3997| Local H loss: 0.0701  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2439 |Global loss: 1.048| Local H loss: 0.0611  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2558 |Global loss: 0.9723| Local H loss: 0.0601  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2855 |Global loss: 1.7374| Local H loss: 0.0917  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2505 |Global loss: 1.1202| Local H loss: 0.0592  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2367 |Global loss: 1.0203| Local H loss: 0.0555  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2303 |Global loss: 0.8193| Local H loss: 0.0542  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4443 |Global loss: 2.1963| Local H loss: 0.094  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4213 |Global loss: 1.521| Local H loss: 0.067  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3997 |Global loss: 1.1579| Local H loss: 0.0587  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3905 |Global loss: 0.9655| Local H loss: 0.0504  | Global H loss: 0.0279 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2904 |Global loss: 2.0905| Local H loss: 0.106  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2375 |Global loss: 1.1443| Local H loss: 0.0654  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2195 |Global loss: 0.8238| Local H loss: 0.055  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2222 |Global loss: 0.9394| Local H loss: 0.0574  | Global H loss: 0.0431 [0m
------------------------- time cost ------------------------- 6.943662405014038
Chosen Clients:  [17, 6, 20, 9, 15, 27, 18, 12, 26, 4, 13, 8]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.975, 0.934, 0.963, 0.87, 0.859, 0.722, 0.878, 0.949, 0.9, 0.939, 0.963, 0.988, 0.902, 0.957, 0.978, 0.911, 0.933, 0.951, 0.926, 0.914, 0.917, 1.0, 0.969, 0.947, 0.812, 0.988, 0.948]
AUC in each clients:  [86.751, 75.483, 85.628, 79.712, 75.703, 81.475, 76.391, 70.296, 70.712, 73.249, 78.871, 79.16, 81.717, 80.872, 81.827, 91.589, 91.724, 90.876, 89.565, 88.681, 101.668, 80.826, 92.591, 95.386, 102.933, 97.902, 93.863, 94.442, 85.792, 95.83]
F1 Score:  [0.939, 0.886, 0.976, 0.975, 0.924, 0.959, 0.85, 0.867, 0.659, 0.863, 0.949, 0.891, 0.934, 0.971, 0.987, 0.901, 0.948, 0.974, 0.862, 0.926, 0.934, 0.929, 0.886, 0.91, 1.0, 0.965, 0.924, 0.794, 0.989, 0.933]
Recall Score:  [0.928, 0.897, 0.978, 0.973, 0.92, 0.963, 0.849, 0.872, 0.745, 0.861, 0.949, 0.892, 0.933, 0.971, 0.99, 0.906, 0.944, 0.974, 0.872, 0.926, 0.936, 0.934, 0.889, 0.93, 1.0, 0.966, 0.917, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.3601
Averaged Test Accurancy: 0.9288
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9168
Averaged Test Recal score: 0.9220
Std Test Accurancy: 0.0569
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2843 |Global loss: 1.8781| Local H loss: 0.0998  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2496 |Global loss: 1.2122| Local H loss: 0.0631  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2495 |Global loss: 1.1279| Local H loss: 0.0607  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.238 |Global loss: 1.075| Local H loss: 0.0574  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2956 |Global loss: 2.0464| Local H loss: 0.1024  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2644 |Global loss: 1.0907| Local H loss: 0.0671  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2565 |Global loss: 1.0678| Local H loss: 0.0588  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2421 |Global loss: 0.9192| Local H loss: 0.0588  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2778 |Global loss: 1.8784| Local H loss: 0.0997  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 1.0562| Local H loss: 0.0661  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.21 |Global loss: 0.6638| Local H loss: 0.049  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2024 |Global loss: 0.592| Local H loss: 0.0488  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3632 |Global loss: 2.2633| Local H loss: 0.0899  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3396 |Global loss: 1.7735| Local H loss: 0.0647  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3329 |Global loss: 1.403| Local H loss: 0.0665  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3357 |Global loss: 1.2161| Local H loss: 0.0601  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3383 |Global loss: 1.8935| Local H loss: 0.0914  | Global H loss: 0.0533 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3207 |Global loss: 1.2202| Local H loss: 0.0567  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3043 |Global loss: 0.9266| Local H loss: 0.0562  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2968 |Global loss: 0.8477| Local H loss: 0.0524  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4148 |Global loss: 2.1824| Local H loss: 0.0915  | Global H loss: 0.0521 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3696 |Global loss: 1.1844| Local H loss: 0.0605  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3711 |Global loss: 1.2158| Local H loss: 0.0546  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3432 |Global loss: 0.9933| Local H loss: 0.0532  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.295 |Global loss: 1.9706| Local H loss: 0.1099  | Global H loss: 0.0596 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2414 |Global loss: 0.8395| Local H loss: 0.0626  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.6191| Local H loss: 0.0498  | Global H loss: 0.0318 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2111 |Global loss: 0.5486| Local H loss: 0.0481  | Global H loss: 0.03 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2846 |Global loss: 2.0185| Local H loss: 0.096  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 1.0879| Local H loss: 0.0609  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2306 |Global loss: 1.0555| Local H loss: 0.0635  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2309 |Global loss: 0.9784| Local H loss: 0.057  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.7341| Local H loss: 0.0982  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2324 |Global loss: 0.9251| Local H loss: 0.0635  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2262 |Global loss: 0.8819| Local H loss: 0.0523  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2137 |Global loss: 0.7097| Local H loss: 0.0496  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3068 |Global loss: 2.1021| Local H loss: 0.0992  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2516 |Global loss: 1.1464| Local H loss: 0.0621  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2427 |Global loss: 0.9855| Local H loss: 0.0601  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2372 |Global loss: 0.8884| Local H loss: 0.0548  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3085 |Global loss: 1.9615| Local H loss: 0.0939  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2653 |Global loss: 1.347| Local H loss: 0.0674  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2489 |Global loss: 1.0132| Local H loss: 0.0591  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2424 |Global loss: 0.9356| Local H loss: 0.056  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4515 |Global loss: 2.1406| Local H loss: 0.0896  | Global H loss: 0.0497 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4047 |Global loss: 1.3228| Local H loss: 0.0601  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4075 |Global loss: 1.1143| Local H loss: 0.0499  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.4055 |Global loss: 0.9321| Local H loss: 0.0476  | Global H loss: 0.0271 [0m
------------------------- time cost ------------------------- 6.767212390899658
Chosen Clients:  [6, 3, 24, 16, 14, 28, 19, 23, 9, 26, 29, 10]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.975, 0.908, 0.963, 0.857, 0.859, 0.736, 0.865, 0.949, 0.9, 0.939, 0.975, 0.988, 0.891, 0.957, 0.967, 0.922, 0.933, 0.912, 0.926, 0.914, 0.917, 1.0, 0.969, 0.968, 0.76, 0.988, 0.948]
AUC in each clients:  [86.751, 75.483, 85.628, 79.712, 75.659, 81.475, 76.399, 70.296, 70.764, 73.262, 78.871, 79.16, 81.708, 80.973, 81.827, 91.497, 91.724, 90.879, 89.615, 88.681, 101.588, 80.826, 92.591, 95.386, 102.933, 97.902, 93.884, 94.445, 85.792, 95.83]
F1 Score:  [0.939, 0.886, 0.976, 0.975, 0.889, 0.959, 0.828, 0.867, 0.684, 0.85, 0.949, 0.891, 0.934, 0.972, 0.987, 0.888, 0.948, 0.961, 0.882, 0.926, 0.877, 0.929, 0.886, 0.91, 1.0, 0.965, 0.954, 0.762, 0.989, 0.933]
Recall Score:  [0.928, 0.897, 0.978, 0.973, 0.891, 0.963, 0.832, 0.872, 0.742, 0.849, 0.949, 0.892, 0.933, 0.972, 0.99, 0.894, 0.944, 0.96, 0.882, 0.926, 0.885, 0.934, 0.889, 0.93, 1.0, 0.966, 0.949, 0.767, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.3431
Averaged Test Accurancy: 0.9249
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9132
Averaged Test Recal score: 0.9171
Std Test Accurancy: 0.0607
Std Test AUC: 0.0041
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3027 |Global loss: 2.032| Local H loss: 0.1044  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2491 |Global loss: 1.1094| Local H loss: 0.0632  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2325 |Global loss: 0.9151| Local H loss: 0.0598  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.8102| Local H loss: 0.0556  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.307 |Global loss: 2.0467| Local H loss: 0.0977  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2643 |Global loss: 1.2975| Local H loss: 0.067  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.255 |Global loss: 1.1688| Local H loss: 0.0613  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2566 |Global loss: 0.9918| Local H loss: 0.0574  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2933 |Global loss: 1.9894| Local H loss: 0.0986  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2552 |Global loss: 1.2599| Local H loss: 0.0702  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2485 |Global loss: 1.0734| Local H loss: 0.0636  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2369 |Global loss: 0.9598| Local H loss: 0.0605  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3177 |Global loss: 2.0057| Local H loss: 0.0995  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2724 |Global loss: 1.494| Local H loss: 0.0713  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2655 |Global loss: 1.2852| Local H loss: 0.0652  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2482 |Global loss: 1.0924| Local H loss: 0.0614  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.283 |Global loss: 1.9448| Local H loss: 0.1003  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2416 |Global loss: 1.0204| Local H loss: 0.0568  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2315 |Global loss: 0.9288| Local H loss: 0.0546  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2234 |Global loss: 0.7509| Local H loss: 0.0534  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2883 |Global loss: 2.123| Local H loss: 0.1055  | Global H loss: 0.0607 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2381 |Global loss: 1.0148| Local H loss: 0.0669  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2196 |Global loss: 0.8077| Local H loss: 0.0566  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2134 |Global loss: 0.6791| Local H loss: 0.058  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.268 |Global loss: 1.68| Local H loss: 0.0928  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2324 |Global loss: 1.0447| Local H loss: 0.0573  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2271 |Global loss: 0.9513| Local H loss: 0.0537  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.217 |Global loss: 0.7673| Local H loss: 0.0539  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2793 |Global loss: 1.7762| Local H loss: 0.0954  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2305 |Global loss: 0.9494| Local H loss: 0.0651  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2195 |Global loss: 0.7908| Local H loss: 0.0551  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2137 |Global loss: 0.7884| Local H loss: 0.0497  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3574 |Global loss: 2.2721| Local H loss: 0.0889  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3454 |Global loss: 1.6761| Local H loss: 0.07  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3347 |Global loss: 1.5105| Local H loss: 0.0697  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3317 |Global loss: 1.4079| Local H loss: 0.0702  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2891 |Global loss: 1.9179| Local H loss: 0.1004  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2248 |Global loss: 0.8911| Local H loss: 0.0587  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2192 |Global loss: 0.8155| Local H loss: 0.0569  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2226 |Global loss: 0.8842| Local H loss: 0.0544  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2779 |Global loss: 2.0589| Local H loss: 0.0943  | Global H loss: 0.0602 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2378 |Global loss: 1.2915| Local H loss: 0.0658  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 1.0606| Local H loss: 0.0639  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2229 |Global loss: 0.816| Local H loss: 0.0584  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2848 |Global loss: 2.0195| Local H loss: 0.1001  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2338 |Global loss: 1.0436| Local H loss: 0.0624  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2307 |Global loss: 1.0177| Local H loss: 0.0602  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.224 |Global loss: 0.7464| Local H loss: 0.0548  | Global H loss: 0.0377 [0m
------------------------- time cost ------------------------- 6.682111024856567
Chosen Clients:  [24, 26, 0, 27, 1, 16, 21, 7, 2, 18, 3, 6]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.977, 0.975, 0.908, 0.963, 0.857, 0.859, 0.736, 0.838, 0.949, 0.9, 0.939, 0.975, 0.963, 0.891, 0.946, 0.967, 0.922, 0.944, 0.912, 0.926, 0.914, 0.927, 0.981, 0.969, 0.936, 0.76, 0.977, 0.948]
AUC in each clients:  [86.751, 75.483, 85.628, 79.741, 75.659, 81.475, 76.383, 70.296, 70.764, 73.231, 78.86, 79.16, 81.708, 80.973, 81.825, 91.497, 91.702, 90.879, 89.615, 88.692, 101.588, 80.826, 92.591, 95.411, 102.933, 97.902, 93.861, 94.445, 85.795, 95.849]
F1 Score:  [0.939, 0.886, 0.976, 0.973, 0.889, 0.959, 0.836, 0.867, 0.684, 0.815, 0.949, 0.891, 0.934, 0.972, 0.96, 0.888, 0.934, 0.961, 0.882, 0.938, 0.877, 0.929, 0.886, 0.922, 0.975, 0.965, 0.911, 0.762, 0.979, 0.933]
Recall Score:  [0.928, 0.897, 0.978, 0.973, 0.891, 0.963, 0.835, 0.872, 0.742, 0.821, 0.949, 0.892, 0.933, 0.972, 0.964, 0.894, 0.931, 0.96, 0.882, 0.939, 0.885, 0.934, 0.889, 0.942, 0.972, 0.966, 0.903, 0.767, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.3070
Averaged Test Accurancy: 0.9214
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9091
Averaged Test Recal score: 0.9130
Std Test Accurancy: 0.0593
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.283 |Global loss: 1.8703| Local H loss: 0.0938  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2501 |Global loss: 1.3179| Local H loss: 0.0669  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2467 |Global loss: 1.1375| Local H loss: 0.0638  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2341 |Global loss: 0.9546| Local H loss: 0.0595  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.28 |Global loss: 1.7363| Local H loss: 0.0964  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2259 |Global loss: 0.9118| Local H loss: 0.0591  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.226 |Global loss: 0.93| Local H loss: 0.0564  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2175 |Global loss: 0.7683| Local H loss: 0.0521  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2821 |Global loss: 1.9774| Local H loss: 0.1015  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 0.9871| Local H loss: 0.0713  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.22 |Global loss: 0.8492| Local H loss: 0.0561  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2179 |Global loss: 0.7656| Local H loss: 0.0549  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4009 |Global loss: 2.1401| Local H loss: 0.087  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3682 |Global loss: 1.2803| Local H loss: 0.0618  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3498 |Global loss: 1.0718| Local H loss: 0.0555  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3625 |Global loss: 0.9758| Local H loss: 0.0507  | Global H loss: 0.0304 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.29 |Global loss: 2.1285| Local H loss: 0.0968  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2484 |Global loss: 1.2178| Local H loss: 0.0671  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2382 |Global loss: 1.104| Local H loss: 0.0587  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2238 |Global loss: 0.9258| Local H loss: 0.0553  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3024 |Global loss: 2.0492| Local H loss: 0.0906  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2608 |Global loss: 1.6187| Local H loss: 0.0696  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2322 |Global loss: 0.8768| Local H loss: 0.0595  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2391 |Global loss: 0.8585| Local H loss: 0.0574  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2772 |Global loss: 1.834| Local H loss: 0.0993  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2263 |Global loss: 0.9164| Local H loss: 0.0656  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2144 |Global loss: 0.7261| Local H loss: 0.0533  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2103 |Global loss: 0.6447| Local H loss: 0.0487  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2848 |Global loss: 1.9987| Local H loss: 0.1029  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2324 |Global loss: 1.1191| Local H loss: 0.0581  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2268 |Global loss: 0.9754| Local H loss: 0.0599  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.227 |Global loss: 0.8326| Local H loss: 0.0597  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2926 |Global loss: 1.9699| Local H loss: 0.1068  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2399 |Global loss: 1.1255| Local H loss: 0.0629  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2322 |Global loss: 0.8139| Local H loss: 0.059  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2223 |Global loss: 0.7563| Local H loss: 0.056  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2907 |Global loss: 1.735| Local H loss: 0.1046  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2365 |Global loss: 0.857| Local H loss: 0.0597  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2249 |Global loss: 0.7219| Local H loss: 0.0519  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2096 |Global loss: 0.5942| Local H loss: 0.0467  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3136 |Global loss: 2.0435| Local H loss: 0.1037  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2628 |Global loss: 1.1525| Local H loss: 0.0671  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2428 |Global loss: 1.0526| Local H loss: 0.0595  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2488 |Global loss: 1.0499| Local H loss: 0.0607  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.297 |Global loss: 2.3605| Local H loss: 0.1038  | Global H loss: 0.061 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.246 |Global loss: 1.3068| Local H loss: 0.0682  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2427 |Global loss: 1.0225| Local H loss: 0.0632  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2328 |Global loss: 0.8561| Local H loss: 0.0625  | Global H loss: 0.0402 [0m
------------------------- time cost ------------------------- 6.939489841461182
Chosen Clients:  [23, 12, 29, 16, 21, 17, 10, 2, 19, 22, 13, 7]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.95, 0.908, 0.963, 0.87, 0.831, 0.736, 0.838, 0.949, 0.9, 0.939, 0.975, 0.963, 0.891, 0.946, 0.967, 0.911, 0.944, 0.912, 0.926, 0.914, 0.927, 0.981, 0.969, 0.936, 0.812, 0.977, 0.948]
AUC in each clients:  [86.773, 75.477, 85.667, 79.738, 75.659, 81.475, 76.388, 70.259, 70.764, 73.231, 78.86, 79.16, 81.708, 80.973, 81.825, 91.497, 91.706, 90.879, 89.634, 88.692, 101.588, 80.824, 92.591, 95.411, 102.912, 97.902, 93.868, 94.519, 85.795, 95.849]
F1 Score:  [0.939, 0.859, 0.967, 0.948, 0.889, 0.959, 0.851, 0.834, 0.684, 0.815, 0.949, 0.891, 0.934, 0.972, 0.96, 0.888, 0.94, 0.961, 0.864, 0.938, 0.877, 0.905, 0.886, 0.922, 0.975, 0.965, 0.911, 0.793, 0.979, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.949, 0.891, 0.963, 0.852, 0.847, 0.742, 0.821, 0.949, 0.892, 0.933, 0.972, 0.964, 0.894, 0.941, 0.96, 0.866, 0.939, 0.885, 0.934, 0.889, 0.942, 0.972, 0.966, 0.903, 0.815, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.2849
Averaged Test Accurancy: 0.9207
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9063
Averaged Test Recal score: 0.9124
Std Test Accurancy: 0.0558
Std Test AUC: 0.0041
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2801 |Global loss: 1.7928| Local H loss: 0.104  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2228 |Global loss: 0.9366| Local H loss: 0.0578  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2293 |Global loss: 0.903| Local H loss: 0.0533  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2095 |Global loss: 0.7027| Local H loss: 0.0514  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.29 |Global loss: 2.0611| Local H loss: 0.0968  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.251 |Global loss: 1.4546| Local H loss: 0.0703  | Global H loss: 0.0516 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2301 |Global loss: 1.054| Local H loss: 0.0619  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2299 |Global loss: 1.0619| Local H loss: 0.0616  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2714 |Global loss: 1.974| Local H loss: 0.0949  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2326 |Global loss: 1.1| Local H loss: 0.0648  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2293 |Global loss: 1.0264| Local H loss: 0.0591  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2311 |Global loss: 0.976| Local H loss: 0.0624  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2983 |Global loss: 1.9568| Local H loss: 0.0954  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2653 |Global loss: 1.4024| Local H loss: 0.0732  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2479 |Global loss: 1.0663| Local H loss: 0.0653  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.24 |Global loss: 1.0018| Local H loss: 0.0579  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2857 |Global loss: 2.0075| Local H loss: 0.0999  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2184 |Global loss: 0.9033| Local H loss: 0.058  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2171 |Global loss: 0.7589| Local H loss: 0.0549  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2101 |Global loss: 0.7101| Local H loss: 0.0486  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2894 |Global loss: 2.131| Local H loss: 0.0982  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2405 |Global loss: 1.2125| Local H loss: 0.0636  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2321 |Global loss: 1.008| Local H loss: 0.0589  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.9387| Local H loss: 0.0562  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2775 |Global loss: 2.1296| Local H loss: 0.1012  | Global H loss: 0.0617 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2369 |Global loss: 1.1824| Local H loss: 0.0668  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.226 |Global loss: 0.8997| Local H loss: 0.0604  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2159 |Global loss: 0.7959| Local H loss: 0.0555  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2951 |Global loss: 2.0596| Local H loss: 0.1021  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2463 |Global loss: 1.2519| Local H loss: 0.0722  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2268 |Global loss: 0.8691| Local H loss: 0.0603  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2353 |Global loss: 0.9092| Local H loss: 0.0576  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2803 |Global loss: 1.838| Local H loss: 0.0979  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2298 |Global loss: 1.0046| Local H loss: 0.0589  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2202 |Global loss: 0.8794| Local H loss: 0.0571  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2149 |Global loss: 0.779| Local H loss: 0.0525  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2851 |Global loss: 1.7882| Local H loss: 0.0922  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.242 |Global loss: 1.1881| Local H loss: 0.0568  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2297 |Global loss: 0.9284| Local H loss: 0.0551  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2219 |Global loss: 0.7946| Local H loss: 0.0532  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3013 |Global loss: 2.1219| Local H loss: 0.094  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2834 |Global loss: 1.5042| Local H loss: 0.0656  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2396 |Global loss: 0.9534| Local H loss: 0.0592  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2362 |Global loss: 0.8516| Local H loss: 0.0538  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2792 |Global loss: 1.958| Local H loss: 0.1006  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2307 |Global loss: 1.0541| Local H loss: 0.0633  | Global H loss: 0.0485 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2176 |Global loss: 0.8293| Local H loss: 0.0573  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2172 |Global loss: 0.8031| Local H loss: 0.0576  | Global H loss: 0.0415 [0m
------------------------- time cost ------------------------- 6.250773668289185
Chosen Clients:  [18, 16, 1, 23, 24, 14, 15, 5, 7, 3, 25, 13]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.977, 0.95, 0.908, 0.963, 0.87, 0.831, 0.736, 0.838, 0.949, 0.9, 0.939, 0.963, 0.963, 0.891, 0.924, 0.967, 0.911, 0.933, 0.912, 0.938, 0.925, 0.917, 0.981, 0.969, 0.936, 0.812, 0.977, 0.948]
AUC in each clients:  [86.773, 75.477, 85.751, 79.738, 75.659, 81.475, 76.388, 70.254, 70.764, 73.231, 78.854, 79.16, 81.743, 80.955, 81.825, 91.497, 91.74, 90.886, 89.634, 88.65, 101.588, 80.844, 92.568, 95.402, 102.912, 97.902, 93.868, 94.519, 85.795, 95.869]
F1 Score:  [0.939, 0.859, 0.976, 0.948, 0.889, 0.959, 0.851, 0.834, 0.684, 0.815, 0.949, 0.891, 0.934, 0.962, 0.96, 0.888, 0.917, 0.961, 0.864, 0.927, 0.877, 0.918, 0.901, 0.91, 0.975, 0.965, 0.911, 0.793, 0.979, 0.933]
Recall Score:  [0.928, 0.876, 0.978, 0.949, 0.891, 0.963, 0.852, 0.847, 0.742, 0.821, 0.949, 0.892, 0.933, 0.962, 0.964, 0.894, 0.918, 0.96, 0.866, 0.926, 0.885, 0.944, 0.903, 0.93, 0.972, 0.966, 0.903, 0.815, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.2748
Averaged Test Accurancy: 0.9199
Averaged Test AUC: 0.9952
Averaged Test F1_score: 0.9056
Averaged Test Recal score: 0.9115
Std Test Accurancy: 0.0556
Std Test AUC: 0.0041
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2842 |Global loss: 1.6936| Local H loss: 0.1055  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2308 |Global loss: 0.8341| Local H loss: 0.0557  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2121 |Global loss: 0.606| Local H loss: 0.05  | Global H loss: 0.032 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.209 |Global loss: 0.5559| Local H loss: 0.0472  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2906 |Global loss: 1.98| Local H loss: 0.0961  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.256 |Global loss: 1.4347| Local H loss: 0.0688  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2497 |Global loss: 1.1532| Local H loss: 0.0649  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2304 |Global loss: 0.9829| Local H loss: 0.0578  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2829 |Global loss: 1.996| Local H loss: 0.0994  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.24 |Global loss: 1.1584| Local H loss: 0.0658  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2401 |Global loss: 1.0732| Local H loss: 0.0651  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2299 |Global loss: 0.9589| Local H loss: 0.0568  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.7089| Local H loss: 0.0984  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2407 |Global loss: 0.9505| Local H loss: 0.0651  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2241 |Global loss: 0.7637| Local H loss: 0.0546  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2063 |Global loss: 0.6704| Local H loss: 0.0508  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2824 |Global loss: 1.9098| Local H loss: 0.09  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2476 |Global loss: 1.1818| Local H loss: 0.0646  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2374 |Global loss: 0.988| Local H loss: 0.0624  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2343 |Global loss: 0.8792| Local H loss: 0.0609  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2892 |Global loss: 1.8618| Local H loss: 0.1  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2348 |Global loss: 1.0102| Local H loss: 0.0647  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2236 |Global loss: 0.7756| Local H loss: 0.0536  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.215 |Global loss: 0.6645| Local H loss: 0.0515  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3389 |Global loss: 1.8991| Local H loss: 0.0903  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3115 |Global loss: 1.1383| Local H loss: 0.0642  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.285 |Global loss: 0.8969| Local H loss: 0.0516  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2809 |Global loss: 0.8149| Local H loss: 0.0471  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3087 |Global loss: 1.9911| Local H loss: 0.1043  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2553 |Global loss: 1.3916| Local H loss: 0.0657  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2471 |Global loss: 1.013| Local H loss: 0.0606  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2326 |Global loss: 0.8426| Local H loss: 0.0589  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2889 |Global loss: 2.0539| Local H loss: 0.1043  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2332 |Global loss: 1.02| Local H loss: 0.066  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.7719| Local H loss: 0.0566  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.225 |Global loss: 0.7985| Local H loss: 0.057  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3013 |Global loss: 1.9842| Local H loss: 0.1032  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.271 |Global loss: 1.2021| Local H loss: 0.0661  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2448 |Global loss: 1.0726| Local H loss: 0.058  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2498 |Global loss: 0.9959| Local H loss: 0.0596  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.283 |Global loss: 1.7794| Local H loss: 0.0908  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2293 |Global loss: 0.9494| Local H loss: 0.0573  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2185 |Global loss: 0.7619| Local H loss: 0.0528  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2227 |Global loss: 0.7268| Local H loss: 0.0515  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3193 |Global loss: 2.1436| Local H loss: 0.0982  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2662 |Global loss: 1.4216| Local H loss: 0.0685  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2384 |Global loss: 1.0223| Local H loss: 0.0626  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2232 |Global loss: 0.7701| Local H loss: 0.0512  | Global H loss: 0.0352 [0m
------------------------- time cost ------------------------- 8.194523334503174
Chosen Clients:  [0, 17, 22, 15, 6, 14, 4, 5, 20, 3, 26, 19]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.95, 0.908, 0.951, 0.87, 0.845, 0.736, 0.838, 0.949, 0.9, 0.939, 0.988, 0.963, 0.88, 0.935, 0.967, 0.933, 0.933, 0.912, 0.938, 0.925, 0.927, 0.981, 0.969, 0.936, 0.812, 0.977, 0.948]
AUC in each clients:  [86.773, 75.498, 85.751, 79.726, 75.659, 81.567, 76.388, 70.239, 70.764, 73.231, 78.854, 79.16, 81.743, 80.965, 81.829, 91.509, 91.737, 90.886, 89.624, 88.65, 101.588, 80.844, 92.568, 95.408, 102.936, 97.917, 93.868, 94.519, 85.795, 95.869]
F1 Score:  [0.939, 0.873, 0.976, 0.948, 0.889, 0.942, 0.851, 0.85, 0.684, 0.815, 0.949, 0.891, 0.934, 0.981, 0.96, 0.878, 0.929, 0.961, 0.894, 0.927, 0.877, 0.918, 0.901, 0.922, 0.975, 0.958, 0.911, 0.793, 0.979, 0.933]
Recall Score:  [0.928, 0.886, 0.978, 0.949, 0.891, 0.94, 0.852, 0.863, 0.742, 0.821, 0.949, 0.892, 0.933, 0.981, 0.964, 0.885, 0.932, 0.96, 0.896, 0.926, 0.885, 0.944, 0.903, 0.942, 0.972, 0.957, 0.903, 0.815, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.2292
Averaged Test Accurancy: 0.9222
Averaged Test AUC: 0.9953
Averaged Test F1_score: 0.9079
Averaged Test Recal score: 0.9135
Std Test Accurancy: 0.0553
Std Test AUC: 0.0042
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2773 |Global loss: 1.784| Local H loss: 0.0934  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.233 |Global loss: 1.0225| Local H loss: 0.0609  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2217 |Global loss: 0.8168| Local H loss: 0.0566  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2131 |Global loss: 0.7158| Local H loss: 0.0525  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2833 |Global loss: 1.8714| Local H loss: 0.0979  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2349 |Global loss: 1.0582| Local H loss: 0.0633  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2337 |Global loss: 1.0458| Local H loss: 0.0584  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.224 |Global loss: 0.8875| Local H loss: 0.0559  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2828 |Global loss: 1.8146| Local H loss: 0.0938  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.241 |Global loss: 1.1999| Local H loss: 0.0566  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2298 |Global loss: 0.9295| Local H loss: 0.0559  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.8692| Local H loss: 0.0533  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3448 |Global loss: 2.1286| Local H loss: 0.0931  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3144 |Global loss: 1.032| Local H loss: 0.0582  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2915 |Global loss: 0.8087| Local H loss: 0.051  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3017 |Global loss: 0.8242| Local H loss: 0.0547  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2978 |Global loss: 2.3997| Local H loss: 0.0961  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2412 |Global loss: 1.1738| Local H loss: 0.063  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2311 |Global loss: 0.9318| Local H loss: 0.0623  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2496 |Global loss: 0.9662| Local H loss: 0.0555  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2911 |Global loss: 2.0166| Local H loss: 0.1036  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2315 |Global loss: 0.959| Local H loss: 0.0614  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2209 |Global loss: 0.8045| Local H loss: 0.0544  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2131 |Global loss: 0.7052| Local H loss: 0.0511  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2959 |Global loss: 2.0777| Local H loss: 0.0945  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2583 |Global loss: 1.1557| Local H loss: 0.0629  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2374 |Global loss: 0.9613| Local H loss: 0.0596  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2555 |Global loss: 1.0088| Local H loss: 0.0563  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3092 |Global loss: 2.0465| Local H loss: 0.1043  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2479 |Global loss: 1.0092| Local H loss: 0.0625  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2365 |Global loss: 0.9588| Local H loss: 0.0588  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.23 |Global loss: 0.7855| Local H loss: 0.0566  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2699 |Global loss: 1.6956| Local H loss: 0.1008  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2147 |Global loss: 0.8848| Local H loss: 0.0539  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2092 |Global loss: 0.7157| Local H loss: 0.0523  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2045 |Global loss: 0.5954| Local H loss: 0.045  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3152 |Global loss: 2.0504| Local H loss: 0.1007  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2612 |Global loss: 1.274| Local H loss: 0.0633  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2515 |Global loss: 1.1062| Local H loss: 0.06  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2588 |Global loss: 1.083| Local H loss: 0.0571  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2873 |Global loss: 2.1109| Local H loss: 0.095  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.225 |Global loss: 1.1147| Local H loss: 0.0599  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2151 |Global loss: 0.7741| Local H loss: 0.0536  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2049 |Global loss: 0.6538| Local H loss: 0.0491  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2765 |Global loss: 1.7537| Local H loss: 0.0964  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2331 |Global loss: 1.0251| Local H loss: 0.0606  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.9319| Local H loss: 0.0587  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2089 |Global loss: 0.6658| Local H loss: 0.0521  | Global H loss: 0.0355 [0m
------------------------- time cost ------------------------- 7.744782209396362
Chosen Clients:  [25, 20, 19, 7, 24, 5, 28, 4, 12, 6, 21, 2]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.947, 0.951, 0.883, 0.845, 0.736, 0.838, 0.949, 0.9, 0.939, 0.988, 0.976, 0.913, 0.935, 0.978, 0.933, 0.933, 0.941, 0.938, 0.925, 0.927, 0.981, 0.969, 0.957, 0.812, 0.977, 0.948]
AUC in each clients:  [86.784, 75.498, 85.751, 79.782, 75.719, 81.579, 76.4, 70.239, 70.764, 73.231, 78.854, 79.16, 81.743, 80.965, 81.877, 91.653, 91.737, 90.872, 89.624, 88.657, 101.668, 80.844, 92.562, 95.408, 102.936, 97.917, 93.894, 94.519, 85.795, 95.869]
F1 Score:  [0.939, 0.873, 0.976, 0.973, 0.941, 0.942, 0.868, 0.85, 0.684, 0.815, 0.949, 0.891, 0.934, 0.981, 0.973, 0.911, 0.929, 0.974, 0.894, 0.926, 0.919, 0.918, 0.901, 0.922, 0.975, 0.958, 0.937, 0.793, 0.979, 0.933]
Recall Score:  [0.928, 0.886, 0.978, 0.973, 0.941, 0.94, 0.869, 0.863, 0.742, 0.821, 0.949, 0.892, 0.933, 0.981, 0.974, 0.915, 0.932, 0.974, 0.896, 0.926, 0.923, 0.944, 0.903, 0.942, 0.972, 0.957, 0.931, 0.815, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1995
Averaged Test Accurancy: 0.9284
Averaged Test AUC: 0.9955
Averaged Test F1_score: 0.9153
Averaged Test Recal score: 0.9206
Std Test Accurancy: 0.0562
Std Test AUC: 0.0042
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.28 |Global loss: 1.9765| Local H loss: 0.098  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2324 |Global loss: 1.121| Local H loss: 0.0618  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2239 |Global loss: 0.9212| Local H loss: 0.0579  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2243 |Global loss: 0.8313| Local H loss: 0.0529  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2631 |Global loss: 1.5484| Local H loss: 0.0941  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2267 |Global loss: 1.0192| Local H loss: 0.0624  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2072 |Global loss: 0.7255| Local H loss: 0.0533  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2053 |Global loss: 0.6581| Local H loss: 0.0442  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.8443| Local H loss: 0.1003  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2358 |Global loss: 1.0288| Local H loss: 0.0594  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2242 |Global loss: 0.8816| Local H loss: 0.0585  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2144 |Global loss: 0.7315| Local H loss: 0.0545  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2802 |Global loss: 1.9369| Local H loss: 0.1024  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2288 |Global loss: 1.0145| Local H loss: 0.0625  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2225 |Global loss: 0.7805| Local H loss: 0.0559  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2238 |Global loss: 0.7626| Local H loss: 0.0576  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2888 |Global loss: 1.9528| Local H loss: 0.0937  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2555 |Global loss: 1.3289| Local H loss: 0.0761  | Global H loss: 0.0518 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.239 |Global loss: 1.0418| Local H loss: 0.0639  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2346 |Global loss: 0.9341| Local H loss: 0.0627  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3084 |Global loss: 2.0178| Local H loss: 0.1033  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2406 |Global loss: 1.0724| Local H loss: 0.0623  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2417 |Global loss: 0.9448| Local H loss: 0.0585  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2319 |Global loss: 0.7994| Local H loss: 0.0615  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2864 |Global loss: 2.0655| Local H loss: 0.1022  | Global H loss: 0.0605 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2377 |Global loss: 1.1877| Local H loss: 0.0686  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2171 |Global loss: 0.8534| Local H loss: 0.059  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2172 |Global loss: 0.7881| Local H loss: 0.0518  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2944 |Global loss: 1.9835| Local H loss: 0.0962  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2613 |Global loss: 1.3508| Local H loss: 0.0676  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2495 |Global loss: 1.1075| Local H loss: 0.0609  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2317 |Global loss: 0.9355| Local H loss: 0.0557  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2862 |Global loss: 2.0836| Local H loss: 0.0997  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2447 |Global loss: 1.3819| Local H loss: 0.0729  | Global H loss: 0.0521 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 0.973| Local H loss: 0.0635  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2289 |Global loss: 0.9432| Local H loss: 0.0565  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2961 |Global loss: 1.9518| Local H loss: 0.0972  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2391 |Global loss: 1.0867| Local H loss: 0.0633  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2342 |Global loss: 0.9975| Local H loss: 0.0621  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2297 |Global loss: 0.8643| Local H loss: 0.059  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2889 |Global loss: 1.9314| Local H loss: 0.11  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2224 |Global loss: 1.0016| Local H loss: 0.0573  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2154 |Global loss: 0.7862| Local H loss: 0.0543  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2189 |Global loss: 0.8413| Local H loss: 0.0516  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2888 |Global loss: 2.1438| Local H loss: 0.1028  | Global H loss: 0.0602 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.253 |Global loss: 1.2861| Local H loss: 0.0698  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2374 |Global loss: 1.0559| Local H loss: 0.0666  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2356 |Global loss: 0.9858| Local H loss: 0.0618  | Global H loss: 0.0437 [0m
------------------------- time cost ------------------------- 6.962143659591675
Chosen Clients:  [18, 10, 8, 24, 27, 1, 14, 11, 9, 13, 26, 6]

-------------Round number: 59-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.961, 0.963, 0.857, 0.831, 0.736, 0.838, 0.949, 0.9, 0.927, 0.988, 0.976, 0.913, 0.935, 0.978, 0.933, 0.933, 0.961, 0.951, 0.925, 0.927, 1.0, 0.98, 0.957, 0.812, 0.988, 0.948]
AUC in each clients:  [86.784, 75.498, 85.758, 79.782, 75.791, 81.61, 76.416, 70.178, 70.764, 73.231, 78.854, 79.16, 81.731, 80.965, 81.877, 91.653, 91.737, 90.872, 89.624, 88.666, 101.694, 80.871, 92.562, 95.408, 102.951, 97.914, 93.894, 94.519, 85.818, 95.869]
F1 Score:  [0.939, 0.873, 0.976, 0.973, 0.956, 0.954, 0.836, 0.834, 0.684, 0.815, 0.949, 0.891, 0.92, 0.981, 0.973, 0.911, 0.929, 0.974, 0.894, 0.926, 0.947, 0.939, 0.901, 0.922, 1.0, 0.971, 0.937, 0.793, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.978, 0.973, 0.953, 0.951, 0.835, 0.85, 0.742, 0.821, 0.949, 0.892, 0.92, 0.981, 0.974, 0.915, 0.932, 0.974, 0.896, 0.926, 0.949, 0.955, 0.903, 0.942, 1.0, 0.968, 0.931, 0.815, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1781
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9955
Averaged Test F1_score: 0.9173
Averaged Test Recal score: 0.9222
Std Test Accurancy: 0.0599
Std Test AUC: 0.0043
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2887 |Global loss: 1.6564| Local H loss: 0.1019  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2268 |Global loss: 0.7561| Local H loss: 0.0561  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2042 |Global loss: 0.5951| Local H loss: 0.0461  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2001 |Global loss: 0.504| Local H loss: 0.0413  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2822 |Global loss: 2.0487| Local H loss: 0.0986  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2376 |Global loss: 1.1696| Local H loss: 0.0651  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.235 |Global loss: 1.1144| Local H loss: 0.0611  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2129 |Global loss: 0.8429| Local H loss: 0.0569  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4448 |Global loss: 2.1641| Local H loss: 0.0918  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4071 |Global loss: 1.3635| Local H loss: 0.0612  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.399 |Global loss: 1.1042| Local H loss: 0.0574  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3813 |Global loss: 1.0265| Local H loss: 0.048  | Global H loss: 0.0317 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.281 |Global loss: 1.9891| Local H loss: 0.0911  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2466 |Global loss: 1.3844| Local H loss: 0.0686  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2456 |Global loss: 1.1692| Local H loss: 0.0658  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2332 |Global loss: 1.0035| Local H loss: 0.0638  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4082 |Global loss: 2.0033| Local H loss: 0.0863  | Global H loss: 0.0504 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3961 |Global loss: 1.2549| Local H loss: 0.0659  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3485 |Global loss: 0.9734| Local H loss: 0.0553  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.342 |Global loss: 0.8724| Local H loss: 0.047  | Global H loss: 0.0284 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2799 |Global loss: 1.8832| Local H loss: 0.0979  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2365 |Global loss: 1.2245| Local H loss: 0.0659  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.23 |Global loss: 0.9593| Local H loss: 0.0629  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2223 |Global loss: 0.8288| Local H loss: 0.0566  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2905 |Global loss: 1.8829| Local H loss: 0.1045  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2383 |Global loss: 1.0645| Local H loss: 0.0601  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2196 |Global loss: 0.7981| Local H loss: 0.0543  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2166 |Global loss: 0.7092| Local H loss: 0.0511  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2999 |Global loss: 2.0404| Local H loss: 0.0966  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2746 |Global loss: 1.2971| Local H loss: 0.065  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.251 |Global loss: 0.955| Local H loss: 0.0575  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2397 |Global loss: 0.8712| Local H loss: 0.0556  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3522 |Global loss: 2.1133| Local H loss: 0.0857  | Global H loss: 0.0533 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3408 |Global loss: 1.6502| Local H loss: 0.0669  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3231 |Global loss: 1.2724| Local H loss: 0.0613  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2979 |Global loss: 1.0364| Local H loss: 0.0573  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2983 |Global loss: 2.081| Local H loss: 0.0966  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.249 |Global loss: 1.1886| Local H loss: 0.0661  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2437 |Global loss: 1.0191| Local H loss: 0.0601  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.239 |Global loss: 0.932| Local H loss: 0.0578  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2748 |Global loss: 1.7516| Local H loss: 0.0987  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2225 |Global loss: 0.9805| Local H loss: 0.0581  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2174 |Global loss: 0.8032| Local H loss: 0.0534  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2083 |Global loss: 0.6913| Local H loss: 0.0514  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2921 |Global loss: 2.0935| Local H loss: 0.1032  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2417 |Global loss: 1.0774| Local H loss: 0.0659  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2361 |Global loss: 0.9007| Local H loss: 0.0597  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2287 |Global loss: 0.813| Local H loss: 0.0616  | Global H loss: 0.0408 [0m
------------------------- time cost ------------------------- 7.006741285324097
Chosen Clients:  [29, 12, 19, 10, 4, 20, 2, 16, 24, 22, 14, 13]

-------------Round number: 60-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.961, 0.963, 0.883, 0.831, 0.75, 0.824, 0.949, 0.9, 0.927, 0.951, 0.976, 0.913, 0.935, 0.978, 0.911, 0.933, 0.961, 0.951, 0.925, 0.927, 0.99, 0.98, 0.989, 0.802, 0.988, 0.948]
AUC in each clients:  [86.784, 75.471, 85.758, 79.782, 75.791, 81.61, 76.39, 70.178, 70.871, 73.238, 78.869, 79.188, 81.731, 80.97, 81.864, 91.653, 91.737, 90.872, 89.614, 88.666, 101.694, 80.871, 92.562, 95.408, 102.949, 97.914, 93.907, 94.488, 85.818, 95.869]
F1 Score:  [0.939, 0.871, 0.976, 0.973, 0.956, 0.954, 0.864, 0.834, 0.707, 0.812, 0.949, 0.891, 0.92, 0.952, 0.973, 0.911, 0.929, 0.974, 0.867, 0.926, 0.947, 0.939, 0.901, 0.922, 0.987, 0.971, 0.984, 0.781, 0.989, 0.933]
Recall Score:  [0.928, 0.891, 0.978, 0.973, 0.953, 0.951, 0.863, 0.85, 0.755, 0.818, 0.949, 0.892, 0.92, 0.952, 0.974, 0.915, 0.932, 0.974, 0.87, 0.926, 0.949, 0.955, 0.903, 0.942, 0.986, 0.968, 0.981, 0.805, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1737
Averaged Test Accurancy: 0.9296
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9177
Averaged Test Recal score: 0.9227
Std Test Accurancy: 0.0587
Std Test AUC: 0.0041
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2695 |Global loss: 1.9313| Local H loss: 0.0917  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2348 |Global loss: 1.1541| Local H loss: 0.0691  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2263 |Global loss: 1.0903| Local H loss: 0.0614  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2259 |Global loss: 0.9585| Local H loss: 0.0612  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2807 |Global loss: 1.8366| Local H loss: 0.0958  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2377 |Global loss: 1.2535| Local H loss: 0.0624  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2362 |Global loss: 0.9805| Local H loss: 0.0584  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.225 |Global loss: 0.8977| Local H loss: 0.0576  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2774 |Global loss: 1.808| Local H loss: 0.0987  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2269 |Global loss: 0.9445| Local H loss: 0.0604  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2323 |Global loss: 0.9526| Local H loss: 0.0573  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2091 |Global loss: 0.7195| Local H loss: 0.0537  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.972| Local H loss: 0.0952  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2309 |Global loss: 1.1065| Local H loss: 0.0624  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.215 |Global loss: 0.8068| Local H loss: 0.0563  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2217 |Global loss: 0.7908| Local H loss: 0.0571  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2951 |Global loss: 2.0299| Local H loss: 0.1007  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2465 |Global loss: 1.1914| Local H loss: 0.0608  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2484 |Global loss: 1.0081| Local H loss: 0.0616  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2551 |Global loss: 0.9531| Local H loss: 0.0609  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2615 |Global loss: 1.5133| Local H loss: 0.0945  | Global H loss: 0.0524 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2274 |Global loss: 0.9909| Local H loss: 0.0582  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2138 |Global loss: 0.684| Local H loss: 0.0533  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2062 |Global loss: 0.6238| Local H loss: 0.049  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2894 |Global loss: 2.0778| Local H loss: 0.0972  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.245 |Global loss: 1.2212| Local H loss: 0.0747  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2381 |Global loss: 1.0554| Local H loss: 0.064  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2229 |Global loss: 0.7794| Local H loss: 0.0566  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2851 |Global loss: 1.9238| Local H loss: 0.096  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2536 |Global loss: 1.4033| Local H loss: 0.0629  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2355 |Global loss: 1.017| Local H loss: 0.0619  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2375 |Global loss: 0.9983| Local H loss: 0.0616  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2759 |Global loss: 1.8879| Local H loss: 0.0893  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2429 |Global loss: 1.2253| Local H loss: 0.0668  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2346 |Global loss: 1.0026| Local H loss: 0.0609  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2324 |Global loss: 0.8594| Local H loss: 0.0633  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2847 |Global loss: 2.4835| Local H loss: 0.0969  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2488 |Global loss: 1.3279| Local H loss: 0.0652  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2324 |Global loss: 1.023| Local H loss: 0.0546  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2308 |Global loss: 0.9507| Local H loss: 0.061  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2861 |Global loss: 1.8564| Local H loss: 0.1009  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2421 |Global loss: 1.1083| Local H loss: 0.0629  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2273 |Global loss: 0.827| Local H loss: 0.0598  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2199 |Global loss: 0.7238| Local H loss: 0.0594  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2963 |Global loss: 1.9221| Local H loss: 0.097  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2593 |Global loss: 1.2583| Local H loss: 0.0627  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2484 |Global loss: 1.0283| Local H loss: 0.0578  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2511 |Global loss: 1.0337| Local H loss: 0.0587  | Global H loss: 0.0404 [0m
------------------------- time cost ------------------------- 7.538971900939941
Chosen Clients:  [4, 23, 21, 20, 26, 28, 17, 7, 24, 27, 19, 8]

-------------Round number: 61-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.947, 0.963, 0.883, 0.831, 0.75, 0.824, 0.949, 0.9, 0.939, 0.988, 0.976, 0.913, 0.935, 0.978, 0.911, 0.933, 0.941, 0.951, 0.925, 0.927, 1.0, 0.98, 0.989, 0.802, 0.988, 0.948]
AUC in each clients:  [86.784, 75.471, 85.7, 79.782, 75.707, 81.61, 76.39, 70.178, 70.871, 73.238, 78.875, 79.188, 81.742, 80.984, 81.834, 91.653, 91.737, 90.872, 89.614, 88.697, 101.532, 80.871, 92.563, 95.408, 102.962, 97.914, 93.907, 94.488, 85.818, 95.889]
F1 Score:  [0.939, 0.871, 0.976, 0.973, 0.941, 0.954, 0.864, 0.834, 0.707, 0.812, 0.949, 0.891, 0.934, 0.981, 0.975, 0.911, 0.929, 0.974, 0.867, 0.926, 0.922, 0.939, 0.905, 0.922, 1.0, 0.971, 0.984, 0.781, 0.989, 0.935]
Recall Score:  [0.928, 0.891, 0.978, 0.973, 0.941, 0.951, 0.863, 0.85, 0.755, 0.818, 0.949, 0.892, 0.933, 0.981, 0.979, 0.915, 0.932, 0.974, 0.87, 0.926, 0.923, 0.955, 0.903, 0.942, 1.0, 0.968, 0.981, 0.805, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1471
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9955
Averaged Test F1_score: 0.9185
Averaged Test Recal score: 0.9234
Std Test Accurancy: 0.0595
Std Test AUC: 0.0041
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2837 |Global loss: 1.8878| Local H loss: 0.0946  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2546 |Global loss: 1.1927| Local H loss: 0.0634  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2544 |Global loss: 0.9505| Local H loss: 0.0565  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2389 |Global loss: 0.8948| Local H loss: 0.0588  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.281 |Global loss: 1.7467| Local H loss: 0.0979  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2267 |Global loss: 0.8318| Local H loss: 0.0582  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2185 |Global loss: 0.8182| Local H loss: 0.0574  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2167 |Global loss: 0.6583| Local H loss: 0.047  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.8058| Local H loss: 0.102  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2306 |Global loss: 1.1366| Local H loss: 0.061  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2098 |Global loss: 0.6844| Local H loss: 0.0541  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2087 |Global loss: 0.7246| Local H loss: 0.0486  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2716 |Global loss: 1.7293| Local H loss: 0.0961  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2114 |Global loss: 0.8017| Local H loss: 0.059  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2168 |Global loss: 0.8077| Local H loss: 0.0486  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2007 |Global loss: 0.644| Local H loss: 0.0458  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2664 |Global loss: 1.6712| Local H loss: 0.0962  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.228 |Global loss: 1.0279| Local H loss: 0.0576  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2138 |Global loss: 0.7416| Local H loss: 0.0511  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2118 |Global loss: 0.6848| Local H loss: 0.0494  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2819 |Global loss: 1.8759| Local H loss: 0.1026  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2239 |Global loss: 0.9185| Local H loss: 0.0592  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2308 |Global loss: 0.9602| Local H loss: 0.058  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2169 |Global loss: 0.7822| Local H loss: 0.0572  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2902 |Global loss: 2.005| Local H loss: 0.0954  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.242 |Global loss: 1.2231| Local H loss: 0.0622  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2348 |Global loss: 1.0989| Local H loss: 0.0599  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2504 |Global loss: 1.193| Local H loss: 0.0599  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2773 |Global loss: 1.9567| Local H loss: 0.1031  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2317 |Global loss: 1.0553| Local H loss: 0.0606  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2217 |Global loss: 0.8153| Local H loss: 0.0587  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2159 |Global loss: 0.7922| Local H loss: 0.0557  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.9318| Local H loss: 0.0897  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2455 |Global loss: 1.2108| Local H loss: 0.066  | Global H loss: 0.0485 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2357 |Global loss: 1.0383| Local H loss: 0.0617  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2309 |Global loss: 0.9091| Local H loss: 0.0622  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4033 |Global loss: 2.0658| Local H loss: 0.0905  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3749 |Global loss: 1.3759| Local H loss: 0.0662  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3489 |Global loss: 0.9982| Local H loss: 0.0515  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3275 |Global loss: 0.8461| Local H loss: 0.0502  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2783 |Global loss: 1.7282| Local H loss: 0.0964  | Global H loss: 0.0549 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2247 |Global loss: 0.9153| Local H loss: 0.0584  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2228 |Global loss: 0.8953| Local H loss: 0.0571  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2145 |Global loss: 0.7027| Local H loss: 0.0512  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.446 |Global loss: 2.1588| Local H loss: 0.0885  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4494 |Global loss: 1.7405| Local H loss: 0.0723  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.4137 |Global loss: 1.2949| Local H loss: 0.058  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3868 |Global loss: 1.1542| Local H loss: 0.0598  | Global H loss: 0.0355 [0m
------------------------- time cost ------------------------- 7.243810176849365
Chosen Clients:  [28, 7, 16, 17, 8, 2, 10, 26, 18, 27, 13, 14]

-------------Round number: 62-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.974, 0.963, 0.883, 0.845, 0.764, 0.824, 0.949, 0.9, 0.939, 0.988, 0.976, 0.913, 0.935, 0.978, 0.911, 0.944, 0.941, 0.951, 0.925, 0.906, 0.981, 0.98, 0.957, 0.802, 0.988, 0.948]
AUC in each clients:  [86.784, 75.471, 85.7, 79.782, 75.762, 81.61, 76.39, 70.311, 70.895, 73.238, 78.875, 79.188, 81.742, 80.984, 81.834, 91.653, 91.737, 90.909, 89.614, 88.673, 101.66, 80.87, 92.563, 95.441, 102.951, 97.914, 93.899, 94.524, 85.815, 95.889]
F1 Score:  [0.939, 0.871, 0.976, 0.973, 0.971, 0.954, 0.864, 0.854, 0.72, 0.812, 0.949, 0.891, 0.934, 0.981, 0.975, 0.911, 0.929, 0.974, 0.867, 0.938, 0.919, 0.939, 0.905, 0.899, 0.973, 0.971, 0.937, 0.781, 0.989, 0.935]
Recall Score:  [0.928, 0.891, 0.978, 0.973, 0.974, 0.951, 0.863, 0.86, 0.77, 0.818, 0.949, 0.892, 0.933, 0.981, 0.979, 0.915, 0.932, 0.974, 0.87, 0.939, 0.923, 0.955, 0.903, 0.918, 0.972, 0.968, 0.931, 0.805, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1190
Averaged Test Accurancy: 0.9296
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9177
Averaged Test Recal score: 0.9224
Std Test Accurancy: 0.0566
Std Test AUC: 0.0040
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2767 |Global loss: 1.9211| Local H loss: 0.0988  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2266 |Global loss: 0.9911| Local H loss: 0.0626  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2203 |Global loss: 0.7878| Local H loss: 0.0551  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2214 |Global loss: 0.8208| Local H loss: 0.0565  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2883 |Global loss: 1.9475| Local H loss: 0.099  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2277 |Global loss: 0.92| Local H loss: 0.066  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2268 |Global loss: 0.9276| Local H loss: 0.056  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2013 |Global loss: 0.6413| Local H loss: 0.0511  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.291 |Global loss: 2.0566| Local H loss: 0.0983  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2703 |Global loss: 1.3393| Local H loss: 0.0701  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2371 |Global loss: 0.9468| Local H loss: 0.0616  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2229 |Global loss: 0.7546| Local H loss: 0.0588  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2796 |Global loss: 1.9741| Local H loss: 0.0954  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2464 |Global loss: 1.3869| Local H loss: 0.0721  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2289 |Global loss: 1.058| Local H loss: 0.0618  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2361 |Global loss: 1.0363| Local H loss: 0.0585  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4547 |Global loss: 2.0995| Local H loss: 0.0871  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4109 |Global loss: 1.3979| Local H loss: 0.0618  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3904 |Global loss: 1.1093| Local H loss: 0.0554  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3817 |Global loss: 0.9548| Local H loss: 0.0506  | Global H loss: 0.0298 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2855 |Global loss: 1.901| Local H loss: 0.1047  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.236 |Global loss: 1.1371| Local H loss: 0.0607  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.23 |Global loss: 0.9827| Local H loss: 0.0619  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2198 |Global loss: 0.7945| Local H loss: 0.0553  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2803 |Global loss: 1.9501| Local H loss: 0.103  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2303 |Global loss: 1.1555| Local H loss: 0.0646  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2166 |Global loss: 0.8423| Local H loss: 0.0538  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.221 |Global loss: 0.8505| Local H loss: 0.0534  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2752 |Global loss: 1.7666| Local H loss: 0.1006  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2429 |Global loss: 1.1624| Local H loss: 0.0605  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2198 |Global loss: 0.8383| Local H loss: 0.0566  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1997 |Global loss: 0.6389| Local H loss: 0.0496  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2844 |Global loss: 1.7489| Local H loss: 0.1028  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2199 |Global loss: 0.7283| Local H loss: 0.0611  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2177 |Global loss: 0.617| Local H loss: 0.053  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2034 |Global loss: 0.4954| Local H loss: 0.0439  | Global H loss: 0.0276 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4148 |Global loss: 2.2325| Local H loss: 0.0929  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3514 |Global loss: 1.3348| Local H loss: 0.0668  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3402 |Global loss: 1.126| Local H loss: 0.0535  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3735 |Global loss: 0.9253| Local H loss: 0.0545  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2924 |Global loss: 1.9067| Local H loss: 0.0958  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2562 |Global loss: 1.3765| Local H loss: 0.0654  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2388 |Global loss: 0.9469| Local H loss: 0.06  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2389 |Global loss: 0.9873| Local H loss: 0.0561  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2787 |Global loss: 1.8339| Local H loss: 0.1007  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2416 |Global loss: 1.0583| Local H loss: 0.0637  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2238 |Global loss: 0.9129| Local H loss: 0.0557  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.7873| Local H loss: 0.0603  | Global H loss: 0.0404 [0m
------------------------- time cost ------------------------- 9.081664800643921
Chosen Clients:  [11, 21, 27, 15, 29, 1, 18, 12, 13, 19, 4, 8]

-------------Round number: 63-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.974, 0.963, 0.883, 0.831, 0.819, 0.824, 0.949, 0.9, 0.939, 0.988, 0.976, 0.913, 0.924, 0.978, 0.922, 0.944, 0.941, 0.951, 0.925, 0.906, 0.981, 0.98, 0.957, 0.802, 0.988, 0.948]
AUC in each clients:  [86.784, 75.471, 85.751, 79.782, 75.762, 81.61, 76.39, 70.257, 71.091, 73.238, 78.869, 79.188, 81.742, 80.985, 81.856, 91.653, 91.711, 90.919, 89.638, 88.673, 101.66, 80.87, 92.563, 95.441, 102.951, 97.914, 93.907, 94.54, 85.82, 95.889]
F1 Score:  [0.939, 0.871, 0.967, 0.973, 0.971, 0.954, 0.864, 0.838, 0.753, 0.812, 0.949, 0.891, 0.934, 0.981, 0.973, 0.911, 0.914, 0.974, 0.882, 0.938, 0.919, 0.939, 0.905, 0.899, 0.973, 0.971, 0.942, 0.778, 0.989, 0.935]
Recall Score:  [0.928, 0.891, 0.969, 0.973, 0.974, 0.951, 0.863, 0.847, 0.759, 0.818, 0.949, 0.892, 0.933, 0.981, 0.974, 0.915, 0.918, 0.974, 0.882, 0.939, 0.923, 0.955, 0.903, 0.918, 0.972, 0.968, 0.935, 0.8, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.1135
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9180
Averaged Test Recal score: 0.9210
Std Test Accurancy: 0.0523
Std Test AUC: 0.0038
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2995 |Global loss: 1.9285| Local H loss: 0.0969  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2585 |Global loss: 1.2658| Local H loss: 0.0671  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2468 |Global loss: 1.0537| Local H loss: 0.0614  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.239 |Global loss: 0.8841| Local H loss: 0.0591  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2716 |Global loss: 1.7761| Local H loss: 0.1013  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2236 |Global loss: 0.9593| Local H loss: 0.0623  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2172 |Global loss: 0.8347| Local H loss: 0.0493  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2107 |Global loss: 0.7189| Local H loss: 0.0545  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4065 |Global loss: 2.0038| Local H loss: 0.0888  | Global H loss: 0.0533 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3627 |Global loss: 1.2536| Local H loss: 0.0667  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.344 |Global loss: 1.0179| Local H loss: 0.0575  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3353 |Global loss: 0.9485| Local H loss: 0.05  | Global H loss: 0.0303 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3426 |Global loss: 2.0234| Local H loss: 0.0902  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3021 |Global loss: 1.1079| Local H loss: 0.0624  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2833 |Global loss: 0.9941| Local H loss: 0.0531  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2831 |Global loss: 0.8545| Local H loss: 0.0485  | Global H loss: 0.0332 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 2.0191| Local H loss: 0.0947  | Global H loss: 0.0596 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2331 |Global loss: 1.3003| Local H loss: 0.0638  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2276 |Global loss: 1.0264| Local H loss: 0.0613  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2229 |Global loss: 0.8847| Local H loss: 0.0607  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.8978| Local H loss: 0.0954  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2398 |Global loss: 1.1368| Local H loss: 0.0669  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2295 |Global loss: 0.9216| Local H loss: 0.0582  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2424 |Global loss: 1.0942| Local H loss: 0.0627  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2796 |Global loss: 1.5614| Local H loss: 0.0997  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2331 |Global loss: 0.8177| Local H loss: 0.0581  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2074 |Global loss: 0.6245| Local H loss: 0.0507  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1982 |Global loss: 0.5242| Local H loss: 0.0435  | Global H loss: 0.0291 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2707 |Global loss: 1.8748| Local H loss: 0.094  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2331 |Global loss: 1.0932| Local H loss: 0.0622  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2301 |Global loss: 0.983| Local H loss: 0.0574  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2227 |Global loss: 0.8956| Local H loss: 0.0557  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2965 |Global loss: 1.9575| Local H loss: 0.0941  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2485 |Global loss: 1.2059| Local H loss: 0.0635  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2415 |Global loss: 1.013| Local H loss: 0.0611  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2369 |Global loss: 0.9565| Local H loss: 0.0556  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2857 |Global loss: 1.7972| Local H loss: 0.1011  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2185 |Global loss: 0.8627| Local H loss: 0.0546  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2244 |Global loss: 0.8829| Local H loss: 0.0547  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2101 |Global loss: 0.722| Local H loss: 0.0503  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2936 |Global loss: 1.9392| Local H loss: 0.0948  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2507 |Global loss: 1.2946| Local H loss: 0.059  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2395 |Global loss: 1.1016| Local H loss: 0.0619  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2368 |Global loss: 0.9337| Local H loss: 0.0581  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4543 |Global loss: 2.1384| Local H loss: 0.088  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3947 |Global loss: 1.4034| Local H loss: 0.0606  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3892 |Global loss: 1.239| Local H loss: 0.0574  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3811 |Global loss: 1.1097| Local H loss: 0.0445  | Global H loss: 0.0291 [0m
------------------------- time cost ------------------------- 7.0568037033081055
Chosen Clients:  [14, 27, 15, 29, 1, 19, 7, 18, 9, 0, 26, 28]

-------------Round number: 64-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.934, 0.963, 0.883, 0.831, 0.764, 0.824, 0.949, 0.912, 0.927, 0.975, 0.976, 0.924, 0.924, 0.978, 0.933, 0.933, 0.941, 0.938, 0.925, 0.906, 0.981, 0.98, 0.957, 0.812, 0.988, 0.948]
AUC in each clients:  [86.784, 75.495, 85.751, 79.782, 75.745, 81.61, 76.39, 70.257, 70.902, 73.238, 78.869, 79.233, 81.714, 80.978, 81.856, 91.698, 91.711, 90.919, 89.657, 88.683, 101.66, 80.844, 92.563, 95.441, 102.951, 97.914, 93.907, 94.508, 85.82, 95.886]
F1 Score:  [0.939, 0.872, 0.967, 0.973, 0.925, 0.954, 0.864, 0.838, 0.719, 0.812, 0.949, 0.904, 0.92, 0.972, 0.973, 0.921, 0.914, 0.974, 0.894, 0.926, 0.919, 0.918, 0.905, 0.899, 0.973, 0.971, 0.942, 0.795, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.973, 0.926, 0.951, 0.863, 0.847, 0.767, 0.818, 0.949, 0.905, 0.919, 0.972, 0.974, 0.925, 0.918, 0.974, 0.896, 0.926, 0.923, 0.944, 0.903, 0.918, 0.972, 0.968, 0.935, 0.815, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.0946
Averaged Test Accurancy: 0.9276
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9151
Averaged Test Recal score: 0.9197
Std Test Accurancy: 0.0547
Std Test AUC: 0.0040
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2823 |Global loss: 1.9508| Local H loss: 0.1012  | Global H loss: 0.059 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2388 |Global loss: 1.0538| Local H loss: 0.0634  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.227 |Global loss: 0.8582| Local H loss: 0.0541  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2155 |Global loss: 0.7035| Local H loss: 0.0514  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3962 |Global loss: 1.9772| Local H loss: 0.088  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3607 |Global loss: 1.1596| Local H loss: 0.0603  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3595 |Global loss: 0.9616| Local H loss: 0.0534  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3377 |Global loss: 0.9655| Local H loss: 0.0476  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3384 |Global loss: 1.8787| Local H loss: 0.0905  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2849 |Global loss: 1.1597| Local H loss: 0.0652  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2978 |Global loss: 1.0211| Local H loss: 0.0535  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2822 |Global loss: 0.8969| Local H loss: 0.0535  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2653 |Global loss: 1.8377| Local H loss: 0.0926  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.1643| Local H loss: 0.066  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2276 |Global loss: 1.0183| Local H loss: 0.063  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2296 |Global loss: 0.8733| Local H loss: 0.0631  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2763 |Global loss: 1.9172| Local H loss: 0.0956  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2356 |Global loss: 1.152| Local H loss: 0.0625  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.239 |Global loss: 1.1616| Local H loss: 0.0642  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2272 |Global loss: 0.8629| Local H loss: 0.0595  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.7769| Local H loss: 0.1018  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2243 |Global loss: 1.0643| Local H loss: 0.0589  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2186 |Global loss: 0.8228| Local H loss: 0.0548  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2116 |Global loss: 0.7143| Local H loss: 0.0512  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2852 |Global loss: 2.0751| Local H loss: 0.1024  | Global H loss: 0.0598 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2361 |Global loss: 1.129| Local H loss: 0.0672  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2212 |Global loss: 0.9142| Local H loss: 0.0591  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2139 |Global loss: 0.7179| Local H loss: 0.055  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2818 |Global loss: 1.6916| Local H loss: 0.1016  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2345 |Global loss: 0.8809| Local H loss: 0.0643  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2002 |Global loss: 0.571| Local H loss: 0.0473  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2064 |Global loss: 0.5746| Local H loss: 0.0478  | Global H loss: 0.031 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3667 |Global loss: 2.1116| Local H loss: 0.0879  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3227 |Global loss: 1.4731| Local H loss: 0.0646  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3295 |Global loss: 1.1762| Local H loss: 0.0612  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3215 |Global loss: 1.0078| Local H loss: 0.0622  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2733 |Global loss: 1.967| Local H loss: 0.0949  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2371 |Global loss: 1.165| Local H loss: 0.0657  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2226 |Global loss: 0.8671| Local H loss: 0.0572  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2122 |Global loss: 0.6869| Local H loss: 0.0519  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2757 |Global loss: 1.7396| Local H loss: 0.0967  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2219 |Global loss: 0.9013| Local H loss: 0.0595  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2052 |Global loss: 0.6931| Local H loss: 0.0511  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2011 |Global loss: 0.6084| Local H loss: 0.0486  | Global H loss: 0.0333 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2786 |Global loss: 1.7295| Local H loss: 0.0998  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2267 |Global loss: 1.0005| Local H loss: 0.0606  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2174 |Global loss: 0.7969| Local H loss: 0.0539  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2077 |Global loss: 0.6326| Local H loss: 0.0512  | Global H loss: 0.0342 [0m
------------------------- time cost ------------------------- 7.455240249633789
Chosen Clients:  [8, 26, 14, 18, 4, 24, 19, 6, 3, 5, 20, 15]

-------------Round number: 65-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.934, 0.963, 0.883, 0.859, 0.764, 0.878, 0.949, 0.912, 0.927, 0.975, 0.976, 0.891, 0.924, 0.978, 0.911, 0.933, 0.941, 0.938, 0.925, 0.906, 0.981, 0.98, 0.947, 0.802, 0.977, 0.958]
AUC in each clients:  [86.771, 75.496, 85.751, 79.782, 75.745, 81.61, 76.39, 70.312, 70.902, 73.313, 78.869, 79.233, 81.714, 80.978, 81.873, 91.582, 91.711, 90.919, 89.684, 88.685, 101.66, 80.844, 92.563, 95.441, 102.951, 97.914, 93.889, 94.516, 85.813, 95.891]
F1 Score:  [0.939, 0.873, 0.967, 0.973, 0.925, 0.954, 0.864, 0.866, 0.719, 0.863, 0.949, 0.904, 0.92, 0.972, 0.973, 0.888, 0.914, 0.974, 0.864, 0.926, 0.919, 0.918, 0.905, 0.899, 0.973, 0.971, 0.924, 0.782, 0.979, 0.948]
Recall Score:  [0.928, 0.886, 0.969, 0.973, 0.926, 0.951, 0.863, 0.875, 0.767, 0.861, 0.949, 0.905, 0.919, 0.972, 0.974, 0.894, 0.918, 0.974, 0.866, 0.926, 0.923, 0.944, 0.903, 0.918, 0.972, 0.968, 0.917, 0.805, 0.981, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.0694
Averaged Test Accurancy: 0.9272
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9148
Averaged Test Recal score: 0.9192
Std Test Accurancy: 0.0515
Std Test AUC: 0.0039
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.433 |Global loss: 2.1595| Local H loss: 0.0876  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3989 |Global loss: 1.4235| Local H loss: 0.0581  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3827 |Global loss: 1.2051| Local H loss: 0.0569  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3865 |Global loss: 1.0206| Local H loss: 0.053  | Global H loss: 0.0316 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2842 |Global loss: 1.9476| Local H loss: 0.0987  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2258 |Global loss: 0.8836| Local H loss: 0.0643  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2201 |Global loss: 0.7997| Local H loss: 0.0527  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2153 |Global loss: 0.752| Local H loss: 0.0526  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2867 |Global loss: 2.0292| Local H loss: 0.1029  | Global H loss: 0.0601 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2309 |Global loss: 1.056| Local H loss: 0.0625  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2314 |Global loss: 0.9579| Local H loss: 0.0542  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2145 |Global loss: 0.7504| Local H loss: 0.056  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.7908| Local H loss: 0.1026  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2229 |Global loss: 0.8242| Local H loss: 0.0548  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2141 |Global loss: 0.6707| Local H loss: 0.0455  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1985 |Global loss: 0.5414| Local H loss: 0.0431  | Global H loss: 0.0283 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2915 |Global loss: 2.0613| Local H loss: 0.0974  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2604 |Global loss: 1.3547| Local H loss: 0.0695  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2514 |Global loss: 1.0042| Local H loss: 0.0598  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2281 |Global loss: 0.8545| Local H loss: 0.0559  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2783 |Global loss: 1.8709| Local H loss: 0.0928  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2421 |Global loss: 1.2805| Local H loss: 0.0673  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2355 |Global loss: 1.097| Local H loss: 0.0632  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2349 |Global loss: 0.9988| Local H loss: 0.0587  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2736 |Global loss: 1.7526| Local H loss: 0.098  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2275 |Global loss: 0.9602| Local H loss: 0.0586  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2186 |Global loss: 0.8419| Local H loss: 0.0521  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2158 |Global loss: 0.7551| Local H loss: 0.0526  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2877 |Global loss: 1.9981| Local H loss: 0.099  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2531 |Global loss: 1.2211| Local H loss: 0.0656  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2425 |Global loss: 1.0741| Local H loss: 0.0607  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.234 |Global loss: 0.8839| Local H loss: 0.0595  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2941 |Global loss: 1.9094| Local H loss: 0.1008  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2627 |Global loss: 1.3251| Local H loss: 0.0646  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2518 |Global loss: 1.0908| Local H loss: 0.0618  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2434 |Global loss: 1.1359| Local H loss: 0.0615  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3035 |Global loss: 2.0332| Local H loss: 0.103  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2541 |Global loss: 1.1216| Local H loss: 0.0666  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2411 |Global loss: 0.9099| Local H loss: 0.0555  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.239 |Global loss: 0.8007| Local H loss: 0.0584  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2687 |Global loss: 1.6879| Local H loss: 0.0996  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2173 |Global loss: 0.8444| Local H loss: 0.0613  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2018 |Global loss: 0.6408| Local H loss: 0.0516  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2074 |Global loss: 0.6455| Local H loss: 0.0473  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3422 |Global loss: 2.0525| Local H loss: 0.0943  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2918 |Global loss: 1.2727| Local H loss: 0.064  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2977 |Global loss: 0.9242| Local H loss: 0.0537  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2933 |Global loss: 0.9671| Local H loss: 0.0547  | Global H loss: 0.0372 [0m
------------------------- time cost ------------------------- 8.397031545639038
Chosen Clients:  [29, 22, 28, 5, 16, 26, 24, 7, 27, 0, 15, 13]

-------------Round number: 66-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.974, 0.963, 0.857, 0.859, 0.75, 0.878, 0.949, 0.912, 0.927, 0.975, 0.976, 0.891, 0.924, 0.978, 0.944, 0.944, 0.941, 0.938, 0.925, 0.906, 1.0, 0.98, 0.989, 0.802, 0.977, 0.958]
AUC in each clients:  [86.771, 75.496, 85.751, 79.766, 75.823, 81.591, 76.39, 70.312, 70.888, 73.313, 78.869, 79.233, 81.714, 80.978, 81.895, 91.542, 91.711, 90.919, 89.694, 88.676, 101.675, 80.844, 92.563, 95.441, 102.966, 97.914, 93.917, 94.516, 85.813, 95.891]
F1 Score:  [0.939, 0.873, 0.967, 0.962, 0.971, 0.956, 0.836, 0.866, 0.705, 0.863, 0.949, 0.904, 0.92, 0.972, 0.973, 0.888, 0.914, 0.974, 0.912, 0.938, 0.92, 0.918, 0.905, 0.899, 1.0, 0.971, 0.984, 0.782, 0.979, 0.948]
Recall Score:  [0.928, 0.886, 0.969, 0.961, 0.974, 0.959, 0.835, 0.875, 0.752, 0.861, 0.949, 0.905, 0.919, 0.972, 0.974, 0.894, 0.918, 0.974, 0.913, 0.939, 0.923, 0.944, 0.903, 0.918, 1.0, 0.968, 0.981, 0.805, 0.981, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.0522
Averaged Test Accurancy: 0.9307
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9196
Averaged Test Recal score: 0.9243
Std Test Accurancy: 0.0562
Std Test AUC: 0.0040
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2685 |Global loss: 1.9548| Local H loss: 0.093  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 1.2313| Local H loss: 0.0693  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2281 |Global loss: 0.9648| Local H loss: 0.0628  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2208 |Global loss: 0.8268| Local H loss: 0.0602  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.287 |Global loss: 1.913| Local H loss: 0.092  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2422 |Global loss: 1.2862| Local H loss: 0.0617  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2472 |Global loss: 1.1309| Local H loss: 0.0612  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.22 |Global loss: 0.7898| Local H loss: 0.0561  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2781 |Global loss: 2.071| Local H loss: 0.0993  | Global H loss: 0.0602 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2319 |Global loss: 1.0365| Local H loss: 0.0652  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2144 |Global loss: 0.8098| Local H loss: 0.0542  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2153 |Global loss: 0.7413| Local H loss: 0.0527  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.285 |Global loss: 1.8727| Local H loss: 0.1024  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2512 |Global loss: 1.1813| Local H loss: 0.0693  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2231 |Global loss: 0.8308| Local H loss: 0.0591  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2224 |Global loss: 0.7661| Local H loss: 0.0543  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2862 |Global loss: 2.0085| Local H loss: 0.0954  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2508 |Global loss: 1.3865| Local H loss: 0.0668  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2524 |Global loss: 0.9856| Local H loss: 0.0626  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2335 |Global loss: 0.9957| Local H loss: 0.0604  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2692 |Global loss: 1.7085| Local H loss: 0.0949  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2268 |Global loss: 1.0652| Local H loss: 0.0542  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2086 |Global loss: 0.7655| Local H loss: 0.0553  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2002 |Global loss: 0.6378| Local H loss: 0.0463  | Global H loss: 0.0335 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2785 |Global loss: 1.9532| Local H loss: 0.094  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2419 |Global loss: 1.2851| Local H loss: 0.0663  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2513 |Global loss: 1.1106| Local H loss: 0.0633  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2337 |Global loss: 0.9944| Local H loss: 0.0607  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2905 |Global loss: 2.1392| Local H loss: 0.1022  | Global H loss: 0.0598 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2438 |Global loss: 1.3411| Local H loss: 0.068  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2203 |Global loss: 0.8092| Local H loss: 0.0623  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2223 |Global loss: 0.7698| Local H loss: 0.0578  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3883 |Global loss: 1.9743| Local H loss: 0.0897  | Global H loss: 0.0521 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3511 |Global loss: 1.2288| Local H loss: 0.0611  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3323 |Global loss: 1.0433| Local H loss: 0.0527  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3276 |Global loss: 0.9785| Local H loss: 0.0507  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2814 |Global loss: 2.0149| Local H loss: 0.0975  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2389 |Global loss: 1.3133| Local H loss: 0.0691  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2229 |Global loss: 0.8977| Local H loss: 0.0592  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2143 |Global loss: 0.7672| Local H loss: 0.0551  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3379 |Global loss: 1.9667| Local H loss: 0.0932  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3038 |Global loss: 1.3208| Local H loss: 0.0638  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2745 |Global loss: 0.9942| Local H loss: 0.0559  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2699 |Global loss: 0.8202| Local H loss: 0.0489  | Global H loss: 0.0322 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2836 |Global loss: 1.9695| Local H loss: 0.0943  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2487 |Global loss: 1.3173| Local H loss: 0.0633  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2397 |Global loss: 1.0063| Local H loss: 0.057  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.233 |Global loss: 0.9659| Local H loss: 0.0603  | Global H loss: 0.0428 [0m
------------------------- time cost ------------------------- 7.635393857955933
Chosen Clients:  [16, 11, 8, 0, 18, 4, 20, 27, 5, 23, 21, 14]

-------------Round number: 67-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.974, 0.951, 0.857, 0.845, 0.75, 0.878, 0.949, 0.912, 0.927, 0.988, 0.976, 0.88, 0.946, 0.978, 0.944, 0.944, 0.941, 0.938, 0.935, 0.906, 1.0, 0.98, 0.947, 0.771, 0.977, 0.948]
AUC in each clients:  [86.781, 75.496, 85.751, 79.766, 75.823, 81.618, 76.39, 70.224, 70.888, 73.313, 78.869, 79.233, 81.714, 80.994, 81.895, 91.564, 91.748, 90.919, 89.694, 88.676, 101.675, 80.844, 92.64, 95.441, 102.966, 97.914, 93.901, 94.383, 85.838, 95.82]
F1 Score:  [0.939, 0.873, 0.967, 0.962, 0.971, 0.942, 0.836, 0.85, 0.705, 0.863, 0.949, 0.904, 0.92, 0.981, 0.973, 0.874, 0.935, 0.974, 0.912, 0.938, 0.92, 0.918, 0.917, 0.899, 1.0, 0.971, 0.916, 0.761, 0.979, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.961, 0.974, 0.94, 0.835, 0.863, 0.752, 0.861, 0.949, 0.905, 0.919, 0.981, 0.974, 0.882, 0.936, 0.974, 0.913, 0.939, 0.923, 0.944, 0.917, 0.918, 1.0, 0.968, 0.912, 0.784, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.0345
Averaged Test Accurancy: 0.9280
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9161
Averaged Test Recal score: 0.9208
Std Test Accurancy: 0.0587
Std Test AUC: 0.0041
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2705 |Global loss: 1.9532| Local H loss: 0.0963  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2453 |Global loss: 1.3793| Local H loss: 0.0701  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2403 |Global loss: 1.0891| Local H loss: 0.0617  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.239 |Global loss: 0.9706| Local H loss: 0.0609  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3032 |Global loss: 1.9558| Local H loss: 0.0985  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2536 |Global loss: 1.2034| Local H loss: 0.0623  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2381 |Global loss: 0.9799| Local H loss: 0.0615  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.237 |Global loss: 0.9626| Local H loss: 0.058  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.454 |Global loss: 2.0642| Local H loss: 0.0904  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3866 |Global loss: 1.3541| Local H loss: 0.0585  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3677 |Global loss: 1.019| Local H loss: 0.0528  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.371 |Global loss: 1.0175| Local H loss: 0.0529  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2787 |Global loss: 2.0798| Local H loss: 0.0962  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2371 |Global loss: 1.1808| Local H loss: 0.072  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2236 |Global loss: 0.9282| Local H loss: 0.0616  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2242 |Global loss: 0.8359| Local H loss: 0.0554  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2884 |Global loss: 1.8173| Local H loss: 0.1052  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2254 |Global loss: 0.7607| Local H loss: 0.0617  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.1991 |Global loss: 0.5531| Local H loss: 0.0453  | Global H loss: 0.0305 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1999 |Global loss: 0.5561| Local H loss: 0.0454  | Global H loss: 0.0303 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2864 |Global loss: 2.0061| Local H loss: 0.0992  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2497 |Global loss: 1.2126| Local H loss: 0.064  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2442 |Global loss: 1.0397| Local H loss: 0.0601  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2287 |Global loss: 0.8382| Local H loss: 0.0569  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2678 |Global loss: 1.6118| Local H loss: 0.097  | Global H loss: 0.0549 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2256 |Global loss: 0.922| Local H loss: 0.0623  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2045 |Global loss: 0.6739| Local H loss: 0.0503  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2072 |Global loss: 0.6187| Local H loss: 0.0487  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4003 |Global loss: 1.841| Local H loss: 0.0935  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3675 |Global loss: 1.3369| Local H loss: 0.0673  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3563 |Global loss: 1.0455| Local H loss: 0.0569  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3114 |Global loss: 0.8335| Local H loss: 0.0502  | Global H loss: 0.0296 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2977 |Global loss: 1.9342| Local H loss: 0.0966  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2413 |Global loss: 1.1633| Local H loss: 0.0628  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2354 |Global loss: 0.9234| Local H loss: 0.0604  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2287 |Global loss: 0.8174| Local H loss: 0.0583  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.271 |Global loss: 1.6741| Local H loss: 0.0998  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2261 |Global loss: 1.0443| Local H loss: 0.0585  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2209 |Global loss: 0.9072| Local H loss: 0.0531  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2049 |Global loss: 0.698| Local H loss: 0.0498  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2711 |Global loss: 1.7445| Local H loss: 0.101  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.224 |Global loss: 1.0551| Local H loss: 0.0588  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2207 |Global loss: 0.7575| Local H loss: 0.0537  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2171 |Global loss: 0.8253| Local H loss: 0.0517  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2882 |Global loss: 1.881| Local H loss: 0.1051  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2304 |Global loss: 1.0958| Local H loss: 0.0614  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 0.9247| Local H loss: 0.0578  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.208 |Global loss: 0.7256| Local H loss: 0.0526  | Global H loss: 0.0381 [0m
------------------------- time cost ------------------------- 6.62113618850708
Chosen Clients:  [16, 4, 29, 6, 27, 18, 17, 5, 21, 25, 10, 3]

-------------Round number: 68-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.961, 0.963, 0.857, 0.845, 0.736, 0.878, 0.949, 0.912, 0.927, 0.988, 0.963, 0.88, 0.946, 0.978, 0.911, 0.944, 0.941, 0.938, 0.935, 0.927, 1.0, 0.98, 0.947, 0.812, 0.977, 0.948]
AUC in each clients:  [86.778, 75.496, 85.751, 79.766, 75.791, 81.625, 76.39, 70.224, 70.872, 73.313, 78.869, 79.231, 81.714, 80.994, 81.819, 91.564, 91.792, 90.919, 89.685, 88.676, 101.628, 80.842, 92.64, 95.324, 102.966, 97.914, 93.901, 94.535, 85.838, 95.82]
F1 Score:  [0.939, 0.873, 0.967, 0.962, 0.957, 0.954, 0.836, 0.85, 0.685, 0.863, 0.949, 0.904, 0.92, 0.981, 0.961, 0.874, 0.94, 0.974, 0.864, 0.938, 0.92, 0.918, 0.917, 0.922, 1.0, 0.971, 0.916, 0.797, 0.979, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.961, 0.958, 0.951, 0.835, 0.863, 0.745, 0.861, 0.949, 0.905, 0.919, 0.981, 0.964, 0.882, 0.941, 0.974, 0.866, 0.939, 0.923, 0.944, 0.917, 0.942, 1.0, 0.968, 0.912, 0.81, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 10.0012
Averaged Test Accurancy: 0.9284
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9155
Averaged Test Recal score: 0.9203
Std Test Accurancy: 0.0564
Std Test AUC: 0.0040
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2702 |Global loss: 1.8222| Local H loss: 0.0964  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2415 |Global loss: 1.163| Local H loss: 0.0652  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 0.9396| Local H loss: 0.0624  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2258 |Global loss: 0.7748| Local H loss: 0.0593  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.293 |Global loss: 2.1766| Local H loss: 0.0979  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2487 |Global loss: 1.2679| Local H loss: 0.0693  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2363 |Global loss: 0.9304| Local H loss: 0.0613  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2396 |Global loss: 1.0079| Local H loss: 0.0563  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.272 |Global loss: 1.9463| Local H loss: 0.0925  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2328 |Global loss: 1.2481| Local H loss: 0.0661  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2288 |Global loss: 0.9877| Local H loss: 0.0623  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2244 |Global loss: 0.8982| Local H loss: 0.0616  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2965 |Global loss: 1.9779| Local H loss: 0.1012  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.0092| Local H loss: 0.0622  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.228 |Global loss: 0.8785| Local H loss: 0.0609  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2264 |Global loss: 0.8189| Local H loss: 0.0562  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3858 |Global loss: 2.1033| Local H loss: 0.0858  | Global H loss: 0.0533 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3626 |Global loss: 1.2781| Local H loss: 0.0586  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3736 |Global loss: 0.9545| Local H loss: 0.054  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3309 |Global loss: 0.9364| Local H loss: 0.0525  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2869 |Global loss: 1.7919| Local H loss: 0.1081  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.218 |Global loss: 0.7401| Local H loss: 0.0547  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2094 |Global loss: 0.6345| Local H loss: 0.0488  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1987 |Global loss: 0.5231| Local H loss: 0.0459  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2785 |Global loss: 1.9292| Local H loss: 0.0913  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2413 |Global loss: 1.1795| Local H loss: 0.0608  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2324 |Global loss: 1.122| Local H loss: 0.0589  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.23 |Global loss: 0.9527| Local H loss: 0.0556  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2957 |Global loss: 1.8788| Local H loss: 0.0989  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2437 |Global loss: 1.2131| Local H loss: 0.0622  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2288 |Global loss: 0.8901| Local H loss: 0.0569  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2257 |Global loss: 0.8287| Local H loss: 0.0572  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2728 |Global loss: 1.7782| Local H loss: 0.1023  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2185 |Global loss: 0.9157| Local H loss: 0.0585  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2069 |Global loss: 0.7061| Local H loss: 0.0516  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2083 |Global loss: 0.6468| Local H loss: 0.0502  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2728 |Global loss: 1.7139| Local H loss: 0.0949  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2315 |Global loss: 1.0356| Local H loss: 0.0599  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.231 |Global loss: 0.8512| Local H loss: 0.0573  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2222 |Global loss: 0.7435| Local H loss: 0.0519  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2764 |Global loss: 1.843| Local H loss: 0.0974  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2291 |Global loss: 1.0304| Local H loss: 0.063  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.217 |Global loss: 0.8732| Local H loss: 0.0552  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2238 |Global loss: 0.8706| Local H loss: 0.0579  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3009 |Global loss: 2.1407| Local H loss: 0.0988  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2545 |Global loss: 1.2872| Local H loss: 0.0639  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2412 |Global loss: 1.138| Local H loss: 0.0635  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2483 |Global loss: 0.9284| Local H loss: 0.0573  | Global H loss: 0.0414 [0m
------------------------- time cost ------------------------- 6.289140701293945
Chosen Clients:  [24, 29, 12, 25, 10, 0, 1, 8, 15, 26, 23, 14]

-------------Round number: 69-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.961, 0.963, 0.883, 0.845, 0.736, 0.878, 0.949, 0.912, 0.927, 0.988, 0.963, 0.88, 0.935, 0.978, 0.911, 0.944, 0.941, 0.938, 0.935, 0.927, 1.0, 0.959, 0.947, 0.802, 0.977, 0.948]
AUC in each clients:  [86.778, 75.496, 85.751, 79.757, 75.768, 81.669, 76.459, 70.224, 70.872, 73.313, 78.873, 79.231, 81.714, 80.994, 81.819, 91.564, 91.744, 90.903, 89.649, 88.676, 101.628, 80.816, 92.64, 95.324, 102.966, 97.923, 93.901, 94.583, 85.838, 95.868]
F1 Score:  [0.939, 0.873, 0.967, 0.962, 0.957, 0.954, 0.864, 0.85, 0.685, 0.863, 0.949, 0.904, 0.92, 0.981, 0.961, 0.874, 0.929, 0.974, 0.864, 0.938, 0.92, 0.918, 0.917, 0.922, 1.0, 0.951, 0.916, 0.779, 0.979, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.961, 0.958, 0.951, 0.863, 0.863, 0.745, 0.861, 0.949, 0.905, 0.919, 0.981, 0.964, 0.882, 0.932, 0.974, 0.866, 0.939, 0.923, 0.944, 0.917, 0.942, 1.0, 0.951, 0.912, 0.807, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.9575
Averaged Test Accurancy: 0.9276
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9148
Averaged Test Recal score: 0.9203
Std Test Accurancy: 0.0557
Std Test AUC: 0.0039
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2718 |Global loss: 1.9098| Local H loss: 0.0919  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2383 |Global loss: 1.2731| Local H loss: 0.0663  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2353 |Global loss: 1.1047| Local H loss: 0.064  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2297 |Global loss: 0.9393| Local H loss: 0.0577  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.271 |Global loss: 1.8268| Local H loss: 0.0935  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2353 |Global loss: 1.159| Local H loss: 0.069  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2306 |Global loss: 1.0441| Local H loss: 0.0632  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2242 |Global loss: 0.8725| Local H loss: 0.0619  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2778 |Global loss: 1.8288| Local H loss: 0.0984  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2369 |Global loss: 1.1565| Local H loss: 0.0613  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2329 |Global loss: 1.0734| Local H loss: 0.0574  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2329 |Global loss: 1.0164| Local H loss: 0.0606  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2778 |Global loss: 1.8522| Local H loss: 0.0934  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2272 |Global loss: 0.9523| Local H loss: 0.0618  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2184 |Global loss: 0.8299| Local H loss: 0.0534  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2171 |Global loss: 0.7297| Local H loss: 0.0553  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2842 |Global loss: 2.0845| Local H loss: 0.0999  | Global H loss: 0.0601 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2388 |Global loss: 1.3096| Local H loss: 0.0663  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2336 |Global loss: 1.0383| Local H loss: 0.0609  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 0.8416| Local H loss: 0.0616  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 2.0048| Local H loss: 0.0981  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2293 |Global loss: 1.1| Local H loss: 0.0656  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2268 |Global loss: 0.9458| Local H loss: 0.0605  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2173 |Global loss: 0.8133| Local H loss: 0.0533  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2742 |Global loss: 1.9565| Local H loss: 0.0932  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2359 |Global loss: 1.2191| Local H loss: 0.0647  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2344 |Global loss: 1.0478| Local H loss: 0.0629  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2261 |Global loss: 0.9114| Local H loss: 0.0595  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4151 |Global loss: 2.0938| Local H loss: 0.0891  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3954 |Global loss: 1.5123| Local H loss: 0.0624  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3769 |Global loss: 1.0838| Local H loss: 0.0552  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3589 |Global loss: 0.9927| Local H loss: 0.0512  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3295 |Global loss: 2.0018| Local H loss: 0.09  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2863 |Global loss: 1.1662| Local H loss: 0.0624  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2868 |Global loss: 0.9972| Local H loss: 0.0571  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2825 |Global loss: 0.9285| Local H loss: 0.0501  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2694 |Global loss: 1.7187| Local H loss: 0.0934  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.222 |Global loss: 0.8667| Local H loss: 0.0606  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2104 |Global loss: 0.725| Local H loss: 0.0505  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2079 |Global loss: 0.6971| Local H loss: 0.0493  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2768 |Global loss: 1.7872| Local H loss: 0.0999  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2209 |Global loss: 0.9196| Local H loss: 0.0601  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2131 |Global loss: 0.8311| Local H loss: 0.055  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.216 |Global loss: 0.7125| Local H loss: 0.0527  | Global H loss: 0.0366 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2846 |Global loss: 1.8836| Local H loss: 0.0968  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2371 |Global loss: 1.0293| Local H loss: 0.0646  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2225 |Global loss: 0.8201| Local H loss: 0.061  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2128 |Global loss: 0.6954| Local H loss: 0.0495  | Global H loss: 0.0354 [0m
------------------------- time cost ------------------------- 6.282336950302124
Chosen Clients:  [23, 9, 7, 14, 5, 26, 29, 22, 8, 12, 13, 28]

-------------Round number: 70-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.961, 0.963, 0.883, 0.845, 0.778, 0.878, 0.937, 0.912, 0.927, 0.988, 0.976, 0.935, 0.935, 0.978, 0.911, 0.944, 0.941, 0.938, 0.935, 0.927, 1.0, 0.98, 0.968, 0.802, 0.977, 0.948]
AUC in each clients:  [86.773, 75.471, 85.751, 79.757, 75.768, 81.669, 76.459, 70.224, 70.942, 73.313, 78.855, 79.231, 81.712, 80.994, 81.888, 91.683, 91.744, 90.903, 89.649, 88.676, 101.628, 80.816, 92.64, 95.365, 102.973, 97.905, 93.905, 94.583, 85.838, 95.856]
F1 Score:  [0.939, 0.871, 0.967, 0.962, 0.957, 0.954, 0.864, 0.85, 0.731, 0.863, 0.938, 0.904, 0.92, 0.981, 0.973, 0.94, 0.929, 0.974, 0.864, 0.938, 0.92, 0.918, 0.917, 0.922, 1.0, 0.972, 0.957, 0.779, 0.979, 0.933]
Recall Score:  [0.928, 0.891, 0.969, 0.961, 0.958, 0.951, 0.863, 0.863, 0.778, 0.861, 0.939, 0.905, 0.919, 0.981, 0.974, 0.942, 0.932, 0.974, 0.866, 0.939, 0.923, 0.944, 0.917, 0.942, 1.0, 0.972, 0.954, 0.807, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.9384
Averaged Test Accurancy: 0.9323
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9205
Averaged Test Recal score: 0.9257
Std Test Accurancy: 0.0517
Std Test AUC: 0.0039
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2871 |Global loss: 1.8688| Local H loss: 0.1023  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2338 |Global loss: 1.0812| Local H loss: 0.0588  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2161 |Global loss: 0.784| Local H loss: 0.0541  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2085 |Global loss: 0.7598| Local H loss: 0.0543  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3416 |Global loss: 2.1427| Local H loss: 0.0928  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3316 |Global loss: 1.7807| Local H loss: 0.067  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3216 |Global loss: 1.3725| Local H loss: 0.0661  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3074 |Global loss: 1.1176| Local H loss: 0.0616  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2848 |Global loss: 1.9755| Local H loss: 0.0986  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2318 |Global loss: 1.0068| Local H loss: 0.0597  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2242 |Global loss: 0.8646| Local H loss: 0.0624  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2082 |Global loss: 0.7194| Local H loss: 0.0549  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2879 |Global loss: 1.886| Local H loss: 0.0995  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2377 |Global loss: 1.0724| Local H loss: 0.0664  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2203 |Global loss: 0.7991| Local H loss: 0.057  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2162 |Global loss: 0.7282| Local H loss: 0.0577  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2836 |Global loss: 1.8684| Local H loss: 0.1027  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2372 |Global loss: 0.948| Local H loss: 0.0642  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2252 |Global loss: 0.7755| Local H loss: 0.0541  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2198 |Global loss: 0.7431| Local H loss: 0.0521  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2771 |Global loss: 1.7305| Local H loss: 0.0956  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2199 |Global loss: 0.8962| Local H loss: 0.0581  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2125 |Global loss: 0.8185| Local H loss: 0.0555  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2009 |Global loss: 0.6491| Local H loss: 0.0498  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2687 |Global loss: 1.9054| Local H loss: 0.0899  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2457 |Global loss: 1.3668| Local H loss: 0.0707  | Global H loss: 0.0526 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2241 |Global loss: 0.9643| Local H loss: 0.0659  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2252 |Global loss: 0.8805| Local H loss: 0.0631  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2925 |Global loss: 1.9842| Local H loss: 0.0977  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2374 |Global loss: 1.1838| Local H loss: 0.063  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2409 |Global loss: 1.0222| Local H loss: 0.0665  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2304 |Global loss: 0.832| Local H loss: 0.058  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4309 |Global loss: 2.056| Local H loss: 0.0898  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3821 |Global loss: 1.4119| Local H loss: 0.0629  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3828 |Global loss: 1.0347| Local H loss: 0.0542  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3659 |Global loss: 1.0192| Local H loss: 0.0512  | Global H loss: 0.0313 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2799 |Global loss: 1.8553| Local H loss: 0.1021  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2429 |Global loss: 1.195| Local H loss: 0.065  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2319 |Global loss: 1.0928| Local H loss: 0.0585  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2268 |Global loss: 1.034| Local H loss: 0.0617  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2795 |Global loss: 1.8702| Local H loss: 0.0915  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2414 |Global loss: 1.1032| Local H loss: 0.0609  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2505 |Global loss: 1.2135| Local H loss: 0.0584  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2326 |Global loss: 0.788| Local H loss: 0.0521  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2776 |Global loss: 2.013| Local H loss: 0.0986  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2233 |Global loss: 0.9683| Local H loss: 0.0581  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2158 |Global loss: 0.8221| Local H loss: 0.055  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2068 |Global loss: 0.6856| Local H loss: 0.0503  | Global H loss: 0.0348 [0m
------------------------- time cost ------------------------- 6.304870128631592
Chosen Clients:  [13, 20, 27, 19, 29, 8, 1, 12, 4, 0, 16, 6]

-------------Round number: 71-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.963, 0.961, 0.951, 0.883, 0.817, 0.819, 0.905, 0.937, 0.912, 0.939, 0.975, 0.976, 0.935, 0.935, 0.978, 0.911, 0.944, 0.941, 0.938, 0.925, 0.927, 1.0, 0.98, 0.979, 0.802, 0.977, 0.948]
AUC in each clients:  [86.773, 75.471, 85.751, 79.757, 75.768, 81.62, 76.459, 70.296, 71.047, 73.402, 78.855, 79.231, 81.725, 80.969, 81.885, 91.683, 91.744, 90.903, 89.649, 88.676, 101.628, 80.816, 92.57, 95.307, 102.973, 97.905, 93.915, 94.583, 85.869, 95.861]
F1 Score:  [0.939, 0.871, 0.967, 0.962, 0.957, 0.942, 0.864, 0.822, 0.792, 0.891, 0.938, 0.904, 0.931, 0.972, 0.973, 0.94, 0.929, 0.974, 0.864, 0.938, 0.92, 0.918, 0.901, 0.92, 1.0, 0.972, 0.966, 0.779, 0.979, 0.933]
Recall Score:  [0.928, 0.891, 0.969, 0.961, 0.958, 0.94, 0.863, 0.835, 0.814, 0.892, 0.939, 0.905, 0.932, 0.972, 0.974, 0.942, 0.932, 0.974, 0.866, 0.939, 0.923, 0.944, 0.903, 0.942, 1.0, 0.972, 0.963, 0.807, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.9388
Averaged Test Accurancy: 0.9330
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9219
Averaged Test Recal score: 0.9266
Std Test Accurancy: 0.0489
Std Test AUC: 0.0036
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2806 |Global loss: 1.8574| Local H loss: 0.0938  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2465 |Global loss: 1.3005| Local H loss: 0.0685  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2354 |Global loss: 1.007| Local H loss: 0.057  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.228 |Global loss: 0.9251| Local H loss: 0.0563  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2632 |Global loss: 1.6541| Local H loss: 0.0923  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2339 |Global loss: 0.9864| Local H loss: 0.0632  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2081 |Global loss: 0.7187| Local H loss: 0.0502  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1894 |Global loss: 0.5595| Local H loss: 0.0462  | Global H loss: 0.0312 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3904 |Global loss: 1.9272| Local H loss: 0.088  | Global H loss: 0.0515 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3558 |Global loss: 1.4609| Local H loss: 0.0657  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3699 |Global loss: 1.2405| Local H loss: 0.0637  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3362 |Global loss: 0.9388| Local H loss: 0.0518  | Global H loss: 0.0326 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2738 |Global loss: 1.6815| Local H loss: 0.0975  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2244 |Global loss: 0.9378| Local H loss: 0.0555  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2166 |Global loss: 0.8224| Local H loss: 0.054  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2191 |Global loss: 0.7534| Local H loss: 0.0521  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2703 |Global loss: 2.0421| Local H loss: 0.0901  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 1.1314| Local H loss: 0.0687  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2225 |Global loss: 0.9634| Local H loss: 0.0624  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2192 |Global loss: 0.8696| Local H loss: 0.0586  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4261 |Global loss: 2.105| Local H loss: 0.0909  | Global H loss: 0.0524 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.4228 |Global loss: 1.5705| Local H loss: 0.0667  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3732 |Global loss: 1.1174| Local H loss: 0.0599  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3641 |Global loss: 1.0916| Local H loss: 0.0517  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2749 |Global loss: 1.9112| Local H loss: 0.093  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2429 |Global loss: 1.1589| Local H loss: 0.0697  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2216 |Global loss: 0.9072| Local H loss: 0.0618  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2273 |Global loss: 0.8675| Local H loss: 0.0592  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.9456| Local H loss: 0.0988  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2401 |Global loss: 1.2246| Local H loss: 0.0683  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2295 |Global loss: 1.0274| Local H loss: 0.062  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2293 |Global loss: 0.9479| Local H loss: 0.062  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.9482| Local H loss: 0.094  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2429 |Global loss: 1.1531| Local H loss: 0.0633  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2341 |Global loss: 0.9371| Local H loss: 0.061  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.238 |Global loss: 0.9382| Local H loss: 0.0619  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2712 |Global loss: 1.8059| Local H loss: 0.0908  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2275 |Global loss: 0.8923| Local H loss: 0.0628  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2167 |Global loss: 0.8183| Local H loss: 0.0553  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2191 |Global loss: 0.7186| Local H loss: 0.0535  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2782 |Global loss: 1.7667| Local H loss: 0.098  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2392 |Global loss: 1.2996| Local H loss: 0.0627  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.239 |Global loss: 0.9716| Local H loss: 0.071  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.234 |Global loss: 0.7857| Local H loss: 0.0599  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2793 |Global loss: 1.9283| Local H loss: 0.1003  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2458 |Global loss: 1.1032| Local H loss: 0.0618  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2359 |Global loss: 1.0827| Local H loss: 0.0621  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2281 |Global loss: 0.8361| Local H loss: 0.0572  | Global H loss: 0.0407 [0m
------------------------- time cost ------------------------- 6.3919594287872314
Chosen Clients:  [6, 2, 4, 3, 20, 16, 1, 14, 22, 19, 21, 5]

-------------Round number: 72-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.963, 0.895, 0.951, 0.87, 0.817, 0.75, 0.905, 0.937, 0.912, 0.939, 0.988, 0.976, 0.935, 0.924, 0.978, 0.911, 0.933, 0.941, 0.938, 0.925, 0.927, 1.0, 0.98, 0.979, 0.854, 0.977, 0.948]
AUC in each clients:  [86.761, 75.472, 85.751, 79.757, 75.565, 81.62, 76.453, 70.296, 70.852, 73.402, 78.855, 79.231, 81.746, 80.972, 81.885, 91.683, 91.775, 90.903, 89.649, 88.667, 101.642, 80.816, 92.57, 95.307, 102.973, 97.905, 93.915, 94.64, 85.869, 95.847]
F1 Score:  [0.939, 0.86, 0.967, 0.962, 0.869, 0.942, 0.853, 0.822, 0.682, 0.891, 0.938, 0.904, 0.934, 0.981, 0.973, 0.94, 0.917, 0.974, 0.864, 0.926, 0.92, 0.918, 0.901, 0.92, 1.0, 0.972, 0.966, 0.842, 0.979, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.961, 0.874, 0.94, 0.852, 0.835, 0.771, 0.892, 0.939, 0.905, 0.933, 0.981, 0.974, 0.942, 0.918, 0.974, 0.866, 0.926, 0.923, 0.944, 0.903, 0.942, 1.0, 0.972, 0.963, 0.849, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.9172
Averaged Test Accurancy: 0.9300
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9163
Averaged Test Recal score: 0.9223
Std Test Accurancy: 0.0534
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0009
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2773 |Global loss: 1.7648| Local H loss: 0.0975  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.242 |Global loss: 1.2114| Local H loss: 0.0687  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2267 |Global loss: 0.9055| Local H loss: 0.0578  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2341 |Global loss: 0.842| Local H loss: 0.0583  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2824 |Global loss: 1.9826| Local H loss: 0.0999  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2337 |Global loss: 1.0393| Local H loss: 0.062  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2286 |Global loss: 1.0108| Local H loss: 0.0611  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2153 |Global loss: 0.7574| Local H loss: 0.0535  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2842 |Global loss: 1.8762| Local H loss: 0.0951  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2512 |Global loss: 1.325| Local H loss: 0.066  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2338 |Global loss: 0.9505| Local H loss: 0.0599  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2303 |Global loss: 0.9081| Local H loss: 0.0599  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3039 |Global loss: 2.0705| Local H loss: 0.0975  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2569 |Global loss: 1.3443| Local H loss: 0.0689  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2548 |Global loss: 1.178| Local H loss: 0.0649  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2339 |Global loss: 0.9658| Local H loss: 0.0603  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2715 |Global loss: 1.6212| Local H loss: 0.0953  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2163 |Global loss: 0.8603| Local H loss: 0.0599  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2149 |Global loss: 0.78| Local H loss: 0.0559  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2014 |Global loss: 0.6663| Local H loss: 0.0503  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2733 |Global loss: 1.9558| Local H loss: 0.0936  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2442 |Global loss: 1.3308| Local H loss: 0.07  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2334 |Global loss: 1.0378| Local H loss: 0.0621  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2386 |Global loss: 0.9314| Local H loss: 0.0568  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2788 |Global loss: 2.0047| Local H loss: 0.0954  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2378 |Global loss: 1.1568| Local H loss: 0.0619  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2297 |Global loss: 0.9666| Local H loss: 0.0619  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2297 |Global loss: 0.9177| Local H loss: 0.0549  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.869| Local H loss: 0.0994  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2312 |Global loss: 0.936| Local H loss: 0.0604  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2179 |Global loss: 0.8109| Local H loss: 0.0601  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2177 |Global loss: 0.7478| Local H loss: 0.0536  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2833 |Global loss: 2.067| Local H loss: 0.0959  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.236 |Global loss: 0.9792| Local H loss: 0.0603  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2323 |Global loss: 0.9289| Local H loss: 0.0603  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2198 |Global loss: 0.8432| Local H loss: 0.0526  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2779 |Global loss: 1.6981| Local H loss: 0.097  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2302 |Global loss: 0.9403| Local H loss: 0.0622  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2208 |Global loss: 0.9061| Local H loss: 0.0543  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.213 |Global loss: 0.7799| Local H loss: 0.0565  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2758 |Global loss: 1.7487| Local H loss: 0.1016  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.22 |Global loss: 0.9088| Local H loss: 0.058  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2181 |Global loss: 0.7618| Local H loss: 0.0546  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2064 |Global loss: 0.7046| Local H loss: 0.0527  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2907 |Global loss: 1.9578| Local H loss: 0.102  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2409 |Global loss: 1.1814| Local H loss: 0.0632  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2295 |Global loss: 0.9134| Local H loss: 0.0601  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.8164| Local H loss: 0.0529  | Global H loss: 0.0368 [0m
------------------------- time cost ------------------------- 6.550914287567139
Chosen Clients:  [13, 21, 10, 0, 2, 8, 26, 11, 9, 28, 22, 17]

-------------Round number: 73-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.965, 0.963, 0.947, 0.951, 0.87, 0.817, 0.75, 0.905, 0.937, 0.912, 0.939, 0.988, 0.976, 0.935, 0.924, 0.978, 0.911, 0.944, 0.951, 0.963, 0.925, 0.927, 1.0, 0.98, 0.979, 0.854, 0.977, 0.948]
AUC in each clients:  [86.761, 75.541, 85.732, 79.761, 75.728, 81.633, 76.443, 70.296, 70.852, 73.402, 78.855, 79.231, 81.746, 80.972, 81.889, 91.683, 91.781, 90.903, 89.649, 88.666, 101.66, 80.886, 92.65, 95.307, 102.973, 97.905, 93.915, 94.64, 85.869, 95.847]
F1 Score:  [0.939, 0.886, 0.967, 0.962, 0.941, 0.942, 0.85, 0.822, 0.682, 0.891, 0.938, 0.904, 0.934, 0.981, 0.973, 0.94, 0.917, 0.974, 0.864, 0.938, 0.933, 0.951, 0.901, 0.92, 1.0, 0.972, 0.966, 0.842, 0.979, 0.933]
Recall Score:  [0.928, 0.902, 0.969, 0.961, 0.941, 0.947, 0.849, 0.835, 0.771, 0.892, 0.939, 0.905, 0.933, 0.981, 0.974, 0.942, 0.918, 0.974, 0.866, 0.938, 0.936, 0.965, 0.903, 0.942, 1.0, 0.972, 0.963, 0.849, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.8879
Averaged Test Accurancy: 0.9338
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9214
Averaged Test Recal score: 0.9271
Std Test Accurancy: 0.0527
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.9163| Local H loss: 0.0978  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.246 |Global loss: 1.1909| Local H loss: 0.0622  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2329 |Global loss: 1.0289| Local H loss: 0.0625  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2256 |Global loss: 0.916| Local H loss: 0.0598  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2759 |Global loss: 1.7344| Local H loss: 0.1019  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2174 |Global loss: 1.0498| Local H loss: 0.058  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2137 |Global loss: 0.8195| Local H loss: 0.0556  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2038 |Global loss: 0.6619| Local H loss: 0.0489  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2761 |Global loss: 1.9137| Local H loss: 0.1007  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2292 |Global loss: 1.131| Local H loss: 0.0648  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2234 |Global loss: 0.9862| Local H loss: 0.0553  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2146 |Global loss: 0.8448| Local H loss: 0.0556  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2794 |Global loss: 1.8864| Local H loss: 0.0956  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 0.985| Local H loss: 0.0676  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2216 |Global loss: 0.8617| Local H loss: 0.0589  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2116 |Global loss: 0.7261| Local H loss: 0.0522  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2881 |Global loss: 1.8723| Local H loss: 0.101  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2355 |Global loss: 1.1106| Local H loss: 0.0683  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2233 |Global loss: 0.8162| Local H loss: 0.061  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2108 |Global loss: 0.7268| Local H loss: 0.0549  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4227 |Global loss: 2.0721| Local H loss: 0.0878  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3826 |Global loss: 1.3449| Local H loss: 0.0591  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3723 |Global loss: 1.1348| Local H loss: 0.0511  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.367 |Global loss: 0.9953| Local H loss: 0.0515  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2753 |Global loss: 1.7858| Local H loss: 0.1009  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2186 |Global loss: 0.8627| Local H loss: 0.0576  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2083 |Global loss: 0.7138| Local H loss: 0.0487  | Global H loss: 0.0357 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2027 |Global loss: 0.6404| Local H loss: 0.049  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2927 |Global loss: 1.9194| Local H loss: 0.1  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2502 |Global loss: 1.3458| Local H loss: 0.0646  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2435 |Global loss: 0.9948| Local H loss: 0.0613  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2374 |Global loss: 0.9058| Local H loss: 0.0573  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3525 |Global loss: 2.1226| Local H loss: 0.0867  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3206 |Global loss: 1.7053| Local H loss: 0.0656  | Global H loss: 0.0522 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3151 |Global loss: 1.2417| Local H loss: 0.063  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3036 |Global loss: 0.9902| Local H loss: 0.0601  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2853 |Global loss: 1.9289| Local H loss: 0.0991  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2423 |Global loss: 1.1659| Local H loss: 0.0626  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2151 |Global loss: 0.7993| Local H loss: 0.0563  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2175 |Global loss: 0.7705| Local H loss: 0.0573  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.284 |Global loss: 1.8634| Local H loss: 0.093  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2361 |Global loss: 1.1072| Local H loss: 0.0609  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2296 |Global loss: 0.9741| Local H loss: 0.0581  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2245 |Global loss: 0.9782| Local H loss: 0.0555  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.88| Local H loss: 0.0972  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2402 |Global loss: 1.0756| Local H loss: 0.0641  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2283 |Global loss: 0.985| Local H loss: 0.0596  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2222 |Global loss: 0.8694| Local H loss: 0.0557  | Global H loss: 0.0403 [0m
------------------------- time cost ------------------------- 6.956871747970581
Chosen Clients:  [19, 7, 24, 15, 11, 1, 4, 9, 21, 23, 26, 20]

-------------Round number: 74-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.882, 0.965, 0.963, 0.947, 0.951, 0.87, 0.817, 0.833, 0.838, 0.937, 0.912, 0.939, 0.988, 0.976, 0.935, 0.924, 0.978, 0.911, 0.944, 0.951, 0.951, 0.925, 0.927, 1.0, 0.98, 0.989, 0.854, 0.988, 0.948]
AUC in each clients:  [86.773, 75.541, 85.699, 79.761, 75.728, 81.633, 76.443, 70.296, 71.044, 73.182, 78.85, 79.201, 81.746, 80.987, 81.889, 91.683, 91.781, 90.91, 89.649, 88.666, 101.66, 80.853, 92.608, 95.307, 102.973, 97.905, 93.907, 94.64, 85.822, 95.847]
F1 Score:  [0.939, 0.886, 0.967, 0.962, 0.941, 0.942, 0.85, 0.822, 0.812, 0.829, 0.938, 0.904, 0.934, 0.981, 0.973, 0.94, 0.917, 0.974, 0.864, 0.938, 0.933, 0.931, 0.905, 0.92, 1.0, 0.972, 0.984, 0.842, 0.989, 0.933]
Recall Score:  [0.928, 0.902, 0.969, 0.961, 0.941, 0.947, 0.849, 0.835, 0.829, 0.832, 0.939, 0.905, 0.933, 0.981, 0.974, 0.942, 0.918, 0.974, 0.866, 0.938, 0.936, 0.955, 0.903, 0.942, 1.0, 0.972, 0.981, 0.849, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.8859
Averaged Test Accurancy: 0.9346
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9241
Averaged Test Recal score: 0.9276
Std Test Accurancy: 0.0482
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 1.6414| Local H loss: 0.0987  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2329 |Global loss: 0.9727| Local H loss: 0.0568  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2215 |Global loss: 0.9204| Local H loss: 0.0517  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2123 |Global loss: 0.7769| Local H loss: 0.0528  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2777 |Global loss: 1.9417| Local H loss: 0.1022  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2287 |Global loss: 1.0019| Local H loss: 0.0639  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2176 |Global loss: 0.8142| Local H loss: 0.0587  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2002 |Global loss: 0.5907| Local H loss: 0.0509  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.281 |Global loss: 1.9343| Local H loss: 0.0871  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2393 |Global loss: 1.3005| Local H loss: 0.0673  | Global H loss: 0.0497 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2331 |Global loss: 1.1329| Local H loss: 0.0649  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2291 |Global loss: 0.9659| Local H loss: 0.0606  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3296 |Global loss: 1.929| Local H loss: 0.091  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2954 |Global loss: 1.3696| Local H loss: 0.0647  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3207 |Global loss: 1.0233| Local H loss: 0.062  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2881 |Global loss: 1.0517| Local H loss: 0.054  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2925 |Global loss: 1.9697| Local H loss: 0.0985  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2439 |Global loss: 1.2556| Local H loss: 0.0655  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2375 |Global loss: 1.0365| Local H loss: 0.0592  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2234 |Global loss: 0.8038| Local H loss: 0.0538  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2788 |Global loss: 1.9943| Local H loss: 0.0972  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2625 |Global loss: 1.8091| Local H loss: 0.0777  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2439 |Global loss: 1.2779| Local H loss: 0.0671  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2342 |Global loss: 1.0721| Local H loss: 0.0674  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2877 |Global loss: 1.9251| Local H loss: 0.0958  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2505 |Global loss: 1.12| Local H loss: 0.0674  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2445 |Global loss: 1.0075| Local H loss: 0.0597  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2404 |Global loss: 1.002| Local H loss: 0.0588  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3777 |Global loss: 2.2149| Local H loss: 0.0937  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3475 |Global loss: 1.761| Local H loss: 0.0722  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.342 |Global loss: 1.4785| Local H loss: 0.0636  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3148 |Global loss: 1.1198| Local H loss: 0.0628  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2716 |Global loss: 1.7187| Local H loss: 0.1021  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2203 |Global loss: 0.9868| Local H loss: 0.0606  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2037 |Global loss: 0.6933| Local H loss: 0.0524  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2068 |Global loss: 0.6053| Local H loss: 0.0468  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2856 |Global loss: 1.9253| Local H loss: 0.104  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2386 |Global loss: 1.1994| Local H loss: 0.0711  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2222 |Global loss: 0.9151| Local H loss: 0.054  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2112 |Global loss: 0.739| Local H loss: 0.0513  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2805 |Global loss: 1.9345| Local H loss: 0.1012  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2214 |Global loss: 1.1233| Local H loss: 0.06  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2164 |Global loss: 0.7973| Local H loss: 0.0531  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2137 |Global loss: 0.7816| Local H loss: 0.0558  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2676 |Global loss: 1.6322| Local H loss: 0.0937  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2175 |Global loss: 0.8988| Local H loss: 0.0599  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2084 |Global loss: 0.6861| Local H loss: 0.0521  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2002 |Global loss: 0.6214| Local H loss: 0.0461  | Global H loss: 0.0317 [0m
------------------------- time cost ------------------------- 6.849364519119263
Chosen Clients:  [8, 10, 6, 23, 21, 28, 16, 25, 11, 0, 29, 20]

-------------Round number: 75-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.963, 0.947, 0.951, 0.87, 0.859, 0.833, 0.878, 0.937, 0.912, 0.939, 0.988, 0.976, 0.913, 0.924, 0.978, 0.911, 0.944, 0.951, 0.938, 0.925, 0.927, 0.99, 0.98, 0.989, 0.854, 0.988, 0.948]
AUC in each clients:  [86.773, 75.533, 85.699, 79.761, 75.768, 81.633, 76.443, 70.311, 71.044, 73.318, 78.85, 79.207, 81.746, 80.987, 81.889, 91.765, 91.781, 90.91, 89.649, 88.689, 101.67, 80.843, 92.608, 95.366, 102.958, 97.905, 93.917, 94.64, 85.822, 95.847]
F1 Score:  [0.939, 0.859, 0.967, 0.962, 0.941, 0.942, 0.85, 0.868, 0.812, 0.863, 0.938, 0.904, 0.934, 0.981, 0.973, 0.911, 0.917, 0.974, 0.864, 0.938, 0.935, 0.918, 0.905, 0.92, 0.987, 0.972, 0.984, 0.842, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.961, 0.941, 0.947, 0.849, 0.873, 0.829, 0.861, 0.939, 0.905, 0.933, 0.981, 0.974, 0.915, 0.918, 0.974, 0.866, 0.939, 0.936, 0.944, 0.903, 0.942, 0.986, 0.972, 0.981, 0.849, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.8451
Averaged Test Accurancy: 0.9346
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9241
Averaged Test Recal score: 0.9273
Std Test Accurancy: 0.0439
Std Test AUC: 0.0036
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4173 |Global loss: 2.0293| Local H loss: 0.0905  | Global H loss: 0.0527 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3839 |Global loss: 1.5938| Local H loss: 0.0661  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3867 |Global loss: 1.3779| Local H loss: 0.06  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3572 |Global loss: 1.1036| Local H loss: 0.0553  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2723 |Global loss: 1.9119| Local H loss: 0.096  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2416 |Global loss: 1.3306| Local H loss: 0.0684  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2159 |Global loss: 0.8955| Local H loss: 0.0594  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.215 |Global loss: 0.7848| Local H loss: 0.0559  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.285 |Global loss: 1.898| Local H loss: 0.0998  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2524 |Global loss: 1.4911| Local H loss: 0.0653  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2275 |Global loss: 0.9339| Local H loss: 0.0624  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.9021| Local H loss: 0.059  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2714 |Global loss: 1.7517| Local H loss: 0.097  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2241 |Global loss: 0.9823| Local H loss: 0.0593  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.211 |Global loss: 0.7495| Local H loss: 0.0525  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2161 |Global loss: 0.739| Local H loss: 0.0534  | Global H loss: 0.037 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.286 |Global loss: 1.8465| Local H loss: 0.1072  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2162 |Global loss: 0.9917| Local H loss: 0.0576  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2073 |Global loss: 0.6909| Local H loss: 0.0508  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2097 |Global loss: 0.6986| Local H loss: 0.0507  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2767 |Global loss: 1.8745| Local H loss: 0.0981  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2299 |Global loss: 1.0557| Local H loss: 0.0671  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2187 |Global loss: 0.8144| Local H loss: 0.0561  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2135 |Global loss: 0.7334| Local H loss: 0.0561  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2761 |Global loss: 1.9343| Local H loss: 0.0976  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2366 |Global loss: 1.348| Local H loss: 0.0684  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2355 |Global loss: 0.9574| Local H loss: 0.064  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2346 |Global loss: 1.0408| Local H loss: 0.0594  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.7577| Local H loss: 0.0955  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2337 |Global loss: 1.0264| Local H loss: 0.0629  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2243 |Global loss: 0.8385| Local H loss: 0.054  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2105 |Global loss: 0.6679| Local H loss: 0.0482  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2916 |Global loss: 1.9462| Local H loss: 0.099  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2496 |Global loss: 1.3137| Local H loss: 0.0677  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2335 |Global loss: 0.9685| Local H loss: 0.0574  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2356 |Global loss: 0.9942| Local H loss: 0.0579  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2767 |Global loss: 1.9719| Local H loss: 0.0956  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2352 |Global loss: 1.1026| Local H loss: 0.0695  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2243 |Global loss: 0.9136| Local H loss: 0.0605  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2167 |Global loss: 0.7532| Local H loss: 0.0547  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2673 |Global loss: 1.9255| Local H loss: 0.0922  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2305 |Global loss: 1.1325| Local H loss: 0.0663  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2277 |Global loss: 1.1293| Local H loss: 0.0605  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2221 |Global loss: 0.9688| Local H loss: 0.0595  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2706 |Global loss: 1.6523| Local H loss: 0.0972  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2138 |Global loss: 0.7978| Local H loss: 0.0516  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2172 |Global loss: 0.7247| Local H loss: 0.0494  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2021 |Global loss: 0.6202| Local H loss: 0.0502  | Global H loss: 0.034 [0m
------------------------- time cost ------------------------- 6.828375339508057
Chosen Clients:  [9, 23, 16, 14, 25, 12, 0, 3, 22, 18, 20, 26]

-------------Round number: 76-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.931, 0.855, 0.965, 0.963, 0.947, 0.951, 0.883, 0.859, 0.75, 0.878, 0.949, 0.912, 0.939, 0.988, 0.976, 0.913, 0.946, 0.978, 0.911, 0.944, 0.971, 0.975, 0.925, 0.927, 0.99, 0.959, 0.989, 0.854, 0.988, 0.948]
AUC in each clients:  [86.744, 75.533, 85.699, 79.761, 75.768, 81.633, 76.41, 70.311, 70.91, 73.318, 78.868, 79.211, 81.746, 80.987, 81.889, 91.765, 91.762, 90.91, 89.649, 88.689, 101.681, 80.899, 92.608, 95.277, 102.958, 97.91, 93.917, 94.64, 85.864, 95.82]
F1 Score:  [0.923, 0.859, 0.967, 0.962, 0.941, 0.942, 0.867, 0.868, 0.698, 0.863, 0.949, 0.904, 0.934, 0.981, 0.973, 0.911, 0.94, 0.974, 0.864, 0.938, 0.963, 0.976, 0.905, 0.922, 0.987, 0.951, 0.984, 0.842, 0.989, 0.933]
Recall Score:  [0.911, 0.876, 0.969, 0.961, 0.941, 0.947, 0.866, 0.873, 0.757, 0.861, 0.949, 0.905, 0.933, 0.981, 0.974, 0.915, 0.941, 0.974, 0.866, 0.939, 0.962, 0.976, 0.903, 0.942, 0.986, 0.951, 0.981, 0.849, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7913
Averaged Test Accurancy: 0.9346
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9237
Averaged Test Recal score: 0.9272
Std Test Accurancy: 0.0521
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3572 |Global loss: 2.1262| Local H loss: 0.0867  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3342 |Global loss: 1.9836| Local H loss: 0.0711  | Global H loss: 0.0522 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3159 |Global loss: 1.326| Local H loss: 0.0693  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.31 |Global loss: 1.2389| Local H loss: 0.0629  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2767 |Global loss: 1.6871| Local H loss: 0.1014  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2237 |Global loss: 0.9975| Local H loss: 0.0607  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2162 |Global loss: 0.8138| Local H loss: 0.0531  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2119 |Global loss: 0.7415| Local H loss: 0.0496  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2751 |Global loss: 2.3289| Local H loss: 0.0958  | Global H loss: 0.0607 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2456 |Global loss: 1.2454| Local H loss: 0.0687  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2307 |Global loss: 0.9877| Local H loss: 0.0645  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2212 |Global loss: 0.933| Local H loss: 0.0585  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2756 |Global loss: 1.9061| Local H loss: 0.0996  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2283 |Global loss: 0.9842| Local H loss: 0.059  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2154 |Global loss: 0.8797| Local H loss: 0.0523  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2167 |Global loss: 0.7942| Local H loss: 0.055  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2747 |Global loss: 1.6475| Local H loss: 0.0913  | Global H loss: 0.0539 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2396 |Global loss: 1.1563| Local H loss: 0.0581  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2222 |Global loss: 0.9022| Local H loss: 0.0565  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2189 |Global loss: 0.7711| Local H loss: 0.0544  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2843 |Global loss: 1.8527| Local H loss: 0.093  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2451 |Global loss: 1.3328| Local H loss: 0.0683  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2271 |Global loss: 1.0402| Local H loss: 0.0603  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2302 |Global loss: 1.0028| Local H loss: 0.0566  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2729 |Global loss: 1.7735| Local H loss: 0.0973  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2275 |Global loss: 0.962| Local H loss: 0.0644  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2253 |Global loss: 0.9183| Local H loss: 0.0605  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2116 |Global loss: 0.7054| Local H loss: 0.0522  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3039 |Global loss: 1.9302| Local H loss: 0.0958  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2671 |Global loss: 1.4309| Local H loss: 0.0642  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2438 |Global loss: 1.1155| Local H loss: 0.0591  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2406 |Global loss: 1.1456| Local H loss: 0.062  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2819 |Global loss: 1.9162| Local H loss: 0.0983  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2329 |Global loss: 1.0783| Local H loss: 0.0607  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2231 |Global loss: 0.9017| Local H loss: 0.057  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2257 |Global loss: 0.9234| Local H loss: 0.0536  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2862 |Global loss: 1.6187| Local H loss: 0.1053  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2259 |Global loss: 0.8228| Local H loss: 0.0532  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2017 |Global loss: 0.5616| Local H loss: 0.047  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1954 |Global loss: 0.506| Local H loss: 0.044  | Global H loss: 0.0294 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2625 |Global loss: 1.569| Local H loss: 0.0956  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2272 |Global loss: 0.862| Local H loss: 0.0549  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.1991 |Global loss: 0.6249| Local H loss: 0.0454  | Global H loss: 0.0326 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2078 |Global loss: 0.6306| Local H loss: 0.0488  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2781 |Global loss: 1.8057| Local H loss: 0.0976  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2221 |Global loss: 0.9909| Local H loss: 0.0602  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.223 |Global loss: 0.9225| Local H loss: 0.0546  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2109 |Global loss: 0.7155| Local H loss: 0.0518  | Global H loss: 0.0364 [0m
------------------------- time cost ------------------------- 7.571943521499634
Chosen Clients:  [29, 19, 15, 21, 1, 27, 25, 2, 3, 18, 14, 13]

-------------Round number: 77-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.938, 0.947, 0.951, 0.883, 0.859, 0.75, 0.824, 0.949, 0.912, 0.927, 0.988, 0.976, 0.913, 0.935, 0.978, 0.933, 0.944, 0.951, 0.975, 0.914, 0.917, 0.99, 0.98, 0.989, 0.854, 0.988, 0.948]
AUC in each clients:  [86.815, 75.533, 85.699, 79.718, 75.768, 81.633, 76.41, 70.311, 70.91, 73.227, 78.868, 79.211, 81.737, 80.987, 81.891, 91.765, 91.749, 90.91, 89.696, 88.689, 101.612, 80.899, 92.591, 95.365, 102.958, 97.921, 93.912, 94.64, 85.864, 95.82]
F1 Score:  [0.939, 0.859, 0.967, 0.934, 0.941, 0.942, 0.867, 0.868, 0.698, 0.812, 0.949, 0.904, 0.921, 0.981, 0.973, 0.911, 0.929, 0.974, 0.894, 0.938, 0.933, 0.976, 0.886, 0.91, 0.987, 0.971, 0.984, 0.842, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.94, 0.941, 0.947, 0.866, 0.873, 0.757, 0.818, 0.949, 0.905, 0.92, 0.981, 0.974, 0.915, 0.932, 0.974, 0.896, 0.939, 0.936, 0.976, 0.889, 0.93, 0.986, 0.968, 0.981, 0.849, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7779
Averaged Test Accurancy: 0.9319
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9204
Averaged Test Recal score: 0.9247
Std Test Accurancy: 0.0546
Std Test AUC: 0.0039
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2708 |Global loss: 1.9621| Local H loss: 0.0941  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2299 |Global loss: 1.1647| Local H loss: 0.0643  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2273 |Global loss: 0.9941| Local H loss: 0.0618  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2218 |Global loss: 0.8315| Local H loss: 0.0603  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.6907| Local H loss: 0.0985  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2305 |Global loss: 1.0133| Local H loss: 0.0573  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2208 |Global loss: 0.8706| Local H loss: 0.056  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.213 |Global loss: 0.7897| Local H loss: 0.0528  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3339 |Global loss: 1.871| Local H loss: 0.0868  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.277 |Global loss: 1.0999| Local H loss: 0.0568  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2765 |Global loss: 0.9709| Local H loss: 0.0546  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2726 |Global loss: 0.913| Local H loss: 0.0488  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2779 |Global loss: 1.7568| Local H loss: 0.1057  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2161 |Global loss: 1.0083| Local H loss: 0.0562  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2178 |Global loss: 0.882| Local H loss: 0.0577  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2094 |Global loss: 0.7449| Local H loss: 0.0506  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2708 |Global loss: 2.0286| Local H loss: 0.0939  | Global H loss: 0.0599 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2323 |Global loss: 1.144| Local H loss: 0.0674  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2241 |Global loss: 0.9896| Local H loss: 0.0594  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2282 |Global loss: 0.8973| Local H loss: 0.0576  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.375 |Global loss: 2.1194| Local H loss: 0.0872  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3469 |Global loss: 1.3354| Local H loss: 0.0602  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3384 |Global loss: 1.2135| Local H loss: 0.0615  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3274 |Global loss: 0.9927| Local H loss: 0.0531  | Global H loss: 0.0329 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2794 |Global loss: 2.0469| Local H loss: 0.0985  | Global H loss: 0.0596 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2309 |Global loss: 1.2561| Local H loss: 0.0656  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2243 |Global loss: 0.9756| Local H loss: 0.0576  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2145 |Global loss: 0.7654| Local H loss: 0.0516  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2777 |Global loss: 1.9847| Local H loss: 0.1029  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2406 |Global loss: 1.1445| Local H loss: 0.0708  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2222 |Global loss: 0.9114| Local H loss: 0.0552  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2157 |Global loss: 0.7622| Local H loss: 0.0537  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2971 |Global loss: 2.0323| Local H loss: 0.096  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2555 |Global loss: 1.3263| Local H loss: 0.0633  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2385 |Global loss: 1.0315| Local H loss: 0.0638  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2381 |Global loss: 0.9924| Local H loss: 0.0569  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2812 |Global loss: 1.7095| Local H loss: 0.0994  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.21 |Global loss: 0.7105| Local H loss: 0.0544  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2104 |Global loss: 0.6381| Local H loss: 0.0469  | Global H loss: 0.0327 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1946 |Global loss: 0.5165| Local H loss: 0.0398  | Global H loss: 0.0273 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2781 |Global loss: 1.8346| Local H loss: 0.0983  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.236 |Global loss: 1.0559| Local H loss: 0.065  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2195 |Global loss: 0.7688| Local H loss: 0.0536  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2098 |Global loss: 0.632| Local H loss: 0.0502  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2891 |Global loss: 1.9573| Local H loss: 0.0961  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2512 |Global loss: 1.3545| Local H loss: 0.064  | Global H loss: 0.0485 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2385 |Global loss: 1.0793| Local H loss: 0.0616  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2318 |Global loss: 0.9656| Local H loss: 0.0593  | Global H loss: 0.042 [0m
------------------------- time cost ------------------------- 6.726753234863281
Chosen Clients:  [29, 20, 19, 27, 0, 17, 9, 16, 8, 1, 28, 6]

-------------Round number: 78-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.975, 0.947, 0.951, 0.883, 0.859, 0.75, 0.824, 0.949, 0.912, 0.927, 0.988, 0.963, 0.891, 0.935, 0.978, 0.933, 0.944, 0.951, 0.963, 0.914, 0.917, 0.99, 0.969, 0.989, 0.833, 0.988, 0.948]
AUC in each clients:  [86.815, 75.516, 85.74, 79.803, 75.768, 81.633, 76.41, 70.311, 70.91, 73.227, 78.868, 79.211, 81.737, 80.993, 81.854, 91.614, 91.749, 90.91, 89.699, 88.709, 101.612, 80.868, 92.591, 95.365, 102.958, 97.929, 93.912, 94.754, 85.864, 95.832]
F1 Score:  [0.939, 0.859, 0.967, 0.973, 0.941, 0.942, 0.867, 0.868, 0.698, 0.812, 0.949, 0.904, 0.921, 0.981, 0.96, 0.891, 0.929, 0.974, 0.892, 0.938, 0.933, 0.951, 0.886, 0.91, 0.987, 0.958, 0.984, 0.818, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.973, 0.941, 0.947, 0.866, 0.873, 0.757, 0.818, 0.949, 0.905, 0.92, 0.981, 0.964, 0.897, 0.932, 0.974, 0.898, 0.939, 0.936, 0.965, 0.889, 0.93, 0.986, 0.957, 0.981, 0.836, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7724
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9185
Averaged Test Recal score: 0.9238
Std Test Accurancy: 0.0558
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2708 |Global loss: 1.9134| Local H loss: 0.0935  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2296 |Global loss: 1.159| Local H loss: 0.0672  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2253 |Global loss: 0.9924| Local H loss: 0.0614  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2148 |Global loss: 0.8612| Local H loss: 0.0572  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2658 |Global loss: 1.6028| Local H loss: 0.095  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2194 |Global loss: 0.9701| Local H loss: 0.0592  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2096 |Global loss: 0.7227| Local H loss: 0.0517  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2138 |Global loss: 0.7228| Local H loss: 0.0495  | Global H loss: 0.0349 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2731 |Global loss: 1.6873| Local H loss: 0.098  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2265 |Global loss: 1.0206| Local H loss: 0.0575  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2158 |Global loss: 0.8422| Local H loss: 0.0527  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2164 |Global loss: 0.8339| Local H loss: 0.0524  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3846 |Global loss: 2.0919| Local H loss: 0.0879  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3631 |Global loss: 1.3567| Local H loss: 0.0705  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3679 |Global loss: 1.1092| Local H loss: 0.0628  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3473 |Global loss: 0.9694| Local H loss: 0.0545  | Global H loss: 0.0315 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2774 |Global loss: 2.0166| Local H loss: 0.0954  | Global H loss: 0.0596 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 1.1309| Local H loss: 0.0667  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.228 |Global loss: 0.9487| Local H loss: 0.0638  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2168 |Global loss: 0.797| Local H loss: 0.0564  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2765 |Global loss: 1.8026| Local H loss: 0.0906  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2393 |Global loss: 1.1789| Local H loss: 0.0672  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.226 |Global loss: 0.988| Local H loss: 0.0596  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.9811| Local H loss: 0.0573  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3539 |Global loss: 2.1903| Local H loss: 0.0893  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3206 |Global loss: 1.9551| Local H loss: 0.067  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3169 |Global loss: 1.3188| Local H loss: 0.067  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3167 |Global loss: 1.2206| Local H loss: 0.0655  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2722 |Global loss: 1.9072| Local H loss: 0.0949  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2406 |Global loss: 1.3971| Local H loss: 0.0702  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2285 |Global loss: 1.0218| Local H loss: 0.0605  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2322 |Global loss: 0.9713| Local H loss: 0.0583  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4206 |Global loss: 2.0198| Local H loss: 0.0885  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3794 |Global loss: 1.2875| Local H loss: 0.0597  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3774 |Global loss: 1.0832| Local H loss: 0.058  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3476 |Global loss: 0.9546| Local H loss: 0.0522  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2761 |Global loss: 2.1332| Local H loss: 0.0936  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2391 |Global loss: 1.2817| Local H loss: 0.0654  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2412 |Global loss: 1.1318| Local H loss: 0.0651  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2343 |Global loss: 1.0282| Local H loss: 0.0586  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2763 |Global loss: 1.9204| Local H loss: 0.1025  | Global H loss: 0.0598 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2251 |Global loss: 0.9901| Local H loss: 0.0599  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2172 |Global loss: 0.799| Local H loss: 0.0572  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2181 |Global loss: 0.7768| Local H loss: 0.0559  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2783 |Global loss: 1.8316| Local H loss: 0.0976  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2409 |Global loss: 1.1774| Local H loss: 0.064  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2314 |Global loss: 0.9407| Local H loss: 0.0593  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2226 |Global loss: 0.8242| Local H loss: 0.0551  | Global H loss: 0.0388 [0m
------------------------- time cost ------------------------- 7.183242082595825
Chosen Clients:  [24, 19, 5, 8, 16, 1, 28, 17, 9, 27, 22, 18]

-------------Round number: 79-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.947, 0.951, 0.883, 0.859, 0.764, 0.797, 0.949, 0.912, 0.927, 0.988, 0.963, 0.891, 0.946, 0.978, 0.933, 0.944, 0.941, 0.963, 0.914, 0.917, 0.99, 0.969, 0.989, 0.76, 0.988, 0.948]
AUC in each clients:  [86.776, 75.545, 85.74, 79.803, 75.768, 81.633, 76.472, 70.311, 70.955, 73.229, 78.868, 79.211, 81.737, 80.993, 81.854, 91.614, 91.793, 90.91, 89.699, 88.688, 101.668, 80.868, 92.591, 95.365, 102.958, 97.929, 93.912, 94.388, 85.816, 95.805]
F1 Score:  [0.939, 0.873, 0.967, 0.973, 0.941, 0.942, 0.862, 0.868, 0.716, 0.78, 0.949, 0.904, 0.921, 0.981, 0.96, 0.891, 0.94, 0.974, 0.892, 0.938, 0.918, 0.951, 0.886, 0.91, 0.987, 0.958, 0.984, 0.716, 0.98, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.973, 0.941, 0.947, 0.864, 0.873, 0.763, 0.788, 0.949, 0.905, 0.92, 0.981, 0.964, 0.897, 0.941, 0.974, 0.898, 0.938, 0.923, 0.965, 0.889, 0.93, 0.986, 0.957, 0.981, 0.771, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7825
Averaged Test Accurancy: 0.9276
Averaged Test AUC: 0.9957
Averaged Test F1_score: 0.9145
Averaged Test Recal score: 0.9209
Std Test Accurancy: 0.0611
Std Test AUC: 0.0040
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2712 |Global loss: 1.7848| Local H loss: 0.089  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2352 |Global loss: 1.1379| Local H loss: 0.0658  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 1.0135| Local H loss: 0.0634  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2282 |Global loss: 0.8698| Local H loss: 0.0581  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2734 |Global loss: 1.7975| Local H loss: 0.0989  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2366 |Global loss: 1.0211| Local H loss: 0.0607  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2189 |Global loss: 0.9484| Local H loss: 0.0584  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2171 |Global loss: 0.8684| Local H loss: 0.0553  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2907 |Global loss: 1.8899| Local H loss: 0.0999  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2424 |Global loss: 1.0781| Local H loss: 0.0596  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2308 |Global loss: 0.8711| Local H loss: 0.0574  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2214 |Global loss: 0.7542| Local H loss: 0.0522  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4065 |Global loss: 2.0913| Local H loss: 0.0875  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3927 |Global loss: 1.3613| Local H loss: 0.0645  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3577 |Global loss: 1.2546| Local H loss: 0.0555  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3566 |Global loss: 1.0001| Local H loss: 0.0502  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2768 |Global loss: 2.0296| Local H loss: 0.0962  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2422 |Global loss: 1.3819| Local H loss: 0.0641  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2357 |Global loss: 1.0803| Local H loss: 0.0591  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2297 |Global loss: 1.024| Local H loss: 0.0596  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2759 |Global loss: 2.237| Local H loss: 0.0947  | Global H loss: 0.0607 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.235 |Global loss: 1.208| Local H loss: 0.0696  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2263 |Global loss: 0.9544| Local H loss: 0.0598  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2231 |Global loss: 0.9256| Local H loss: 0.0606  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2722 |Global loss: 1.8481| Local H loss: 0.0929  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2255 |Global loss: 1.0353| Local H loss: 0.0637  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2087 |Global loss: 0.7159| Local H loss: 0.0548  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2128 |Global loss: 0.6473| Local H loss: 0.053  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2755 |Global loss: 1.7988| Local H loss: 0.094  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2482 |Global loss: 1.0918| Local H loss: 0.064  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.226 |Global loss: 0.9775| Local H loss: 0.0594  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2378 |Global loss: 1.1361| Local H loss: 0.0572  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3349 |Global loss: 2.0428| Local H loss: 0.0873  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3367 |Global loss: 1.6301| Local H loss: 0.0708  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3124 |Global loss: 1.2611| Local H loss: 0.0657  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3093 |Global loss: 1.0197| Local H loss: 0.0658  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3863 |Global loss: 2.038| Local H loss: 0.0816  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3598 |Global loss: 1.416| Local H loss: 0.0666  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3144 |Global loss: 1.0313| Local H loss: 0.0525  | Global H loss: 0.035 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3188 |Global loss: 0.9015| Local H loss: 0.0492  | Global H loss: 0.0299 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2827 |Global loss: 1.7937| Local H loss: 0.0995  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2325 |Global loss: 1.1459| Local H loss: 0.0593  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2229 |Global loss: 0.8782| Local H loss: 0.0553  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2267 |Global loss: 0.7586| Local H loss: 0.0557  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2801 |Global loss: 1.6837| Local H loss: 0.1063  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.217 |Global loss: 0.7692| Local H loss: 0.0597  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.1976 |Global loss: 0.5271| Local H loss: 0.0449  | Global H loss: 0.0293 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1947 |Global loss: 0.4963| Local H loss: 0.0426  | Global H loss: 0.0287 [0m
------------------------- time cost ------------------------- 9.119556427001953
Chosen Clients:  [10, 17, 20, 4, 16, 29, 6, 12, 9, 25, 21, 0]

-------------Round number: 80-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.975, 0.947, 0.963, 0.883, 0.859, 0.764, 0.905, 0.949, 0.912, 0.927, 0.988, 0.963, 0.891, 0.924, 0.978, 0.911, 0.944, 0.941, 0.963, 0.925, 0.917, 1.0, 0.969, 0.989, 0.812, 0.988, 0.948]
AUC in each clients:  [86.776, 75.481, 85.74, 79.803, 75.768, 81.66, 76.472, 70.311, 70.973, 73.466, 78.868, 79.211, 81.737, 80.993, 81.854, 91.614, 91.784, 90.917, 89.695, 88.693, 101.668, 80.868, 92.557, 95.365, 102.968, 97.929, 93.912, 94.654, 85.852, 95.805]
F1 Score:  [0.939, 0.859, 0.967, 0.973, 0.941, 0.954, 0.862, 0.868, 0.716, 0.891, 0.949, 0.904, 0.921, 0.981, 0.96, 0.891, 0.917, 0.974, 0.867, 0.938, 0.918, 0.951, 0.901, 0.91, 1.0, 0.958, 0.984, 0.792, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.973, 0.941, 0.951, 0.864, 0.873, 0.763, 0.892, 0.949, 0.905, 0.92, 0.981, 0.964, 0.897, 0.918, 0.974, 0.87, 0.939, 0.923, 0.965, 0.903, 0.93, 1.0, 0.957, 0.981, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7545
Averaged Test Accurancy: 0.9319
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9203
Averaged Test Recal score: 0.9250
Std Test Accurancy: 0.0530
Std Test AUC: 0.0036
Std Test F1: 0.0011
Std Test Recall: 0.0011
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2736 |Global loss: 1.8791| Local H loss: 0.0995  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2189 |Global loss: 0.9484| Local H loss: 0.0585  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2234 |Global loss: 0.9093| Local H loss: 0.0604  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 0.8679| Local H loss: 0.0555  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2759 |Global loss: 1.7821| Local H loss: 0.095  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2387 |Global loss: 1.2293| Local H loss: 0.0634  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2266 |Global loss: 1.017| Local H loss: 0.0602  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.224 |Global loss: 0.9335| Local H loss: 0.0559  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2721 |Global loss: 1.7417| Local H loss: 0.0946  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2275 |Global loss: 1.0341| Local H loss: 0.0606  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2127 |Global loss: 0.8189| Local H loss: 0.0535  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2098 |Global loss: 0.7676| Local H loss: 0.0495  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2832 |Global loss: 1.9721| Local H loss: 0.095  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2485 |Global loss: 1.3117| Local H loss: 0.0672  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2361 |Global loss: 1.0192| Local H loss: 0.0601  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2275 |Global loss: 0.9024| Local H loss: 0.0603  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2769 |Global loss: 1.8658| Local H loss: 0.0944  | Global H loss: 0.0574 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2415 |Global loss: 1.3724| Local H loss: 0.066  | Global H loss: 0.0514 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2369 |Global loss: 1.0111| Local H loss: 0.0633  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 0.8429| Local H loss: 0.0584  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2739 |Global loss: 1.9995| Local H loss: 0.0956  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2372 |Global loss: 1.373| Local H loss: 0.0623  | Global H loss: 0.0505 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2281 |Global loss: 1.0467| Local H loss: 0.062  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.22 |Global loss: 0.89| Local H loss: 0.057  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.7643| Local H loss: 0.0973  | Global H loss: 0.0542 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2325 |Global loss: 1.1209| Local H loss: 0.0645  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2261 |Global loss: 0.8992| Local H loss: 0.0579  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2172 |Global loss: 0.7501| Local H loss: 0.0541  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2714 |Global loss: 1.8732| Local H loss: 0.0958  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2414 |Global loss: 1.0817| Local H loss: 0.0626  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2248 |Global loss: 0.9916| Local H loss: 0.0588  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2273 |Global loss: 0.9553| Local H loss: 0.0625  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3438 |Global loss: 2.0538| Local H loss: 0.0849  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3177 |Global loss: 1.7974| Local H loss: 0.0668  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3094 |Global loss: 1.2897| Local H loss: 0.0679  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2939 |Global loss: 1.0448| Local H loss: 0.0567  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2753 |Global loss: 1.6896| Local H loss: 0.0935  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2305 |Global loss: 1.0665| Local H loss: 0.0588  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.227 |Global loss: 0.9169| Local H loss: 0.0525  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.215 |Global loss: 0.7685| Local H loss: 0.0528  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.8752| Local H loss: 0.105  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2256 |Global loss: 0.8678| Local H loss: 0.0577  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2111 |Global loss: 0.7179| Local H loss: 0.0513  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2132 |Global loss: 0.8534| Local H loss: 0.0522  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2713 |Global loss: 1.8986| Local H loss: 0.0909  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2295 |Global loss: 0.992| Local H loss: 0.0627  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2223 |Global loss: 0.8535| Local H loss: 0.0566  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2182 |Global loss: 0.7449| Local H loss: 0.0557  | Global H loss: 0.0383 [0m
------------------------- time cost ------------------------- 7.412712812423706
Chosen Clients:  [14, 5, 0, 27, 24, 4, 16, 21, 25, 2, 7, 20]

-------------Round number: 81-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.931, 0.855, 0.965, 0.975, 0.961, 0.963, 0.87, 0.859, 0.764, 0.811, 0.949, 0.912, 0.939, 0.988, 0.963, 0.891, 0.935, 0.978, 0.911, 0.944, 0.961, 0.938, 0.925, 0.917, 1.0, 0.959, 0.989, 0.812, 0.988, 0.948]
AUC in each clients:  [86.767, 75.481, 85.74, 79.803, 75.776, 81.66, 76.481, 70.311, 70.973, 73.394, 78.873, 79.211, 81.747, 80.993, 81.854, 91.614, 91.764, 90.909, 89.695, 88.693, 101.667, 80.853, 92.557, 95.365, 102.968, 97.917, 93.912, 94.654, 85.852, 95.879]
F1 Score:  [0.923, 0.859, 0.967, 0.973, 0.957, 0.954, 0.851, 0.868, 0.716, 0.798, 0.949, 0.904, 0.934, 0.981, 0.96, 0.891, 0.929, 0.974, 0.867, 0.938, 0.949, 0.918, 0.901, 0.91, 1.0, 0.951, 0.984, 0.792, 0.989, 0.933]
Recall Score:  [0.911, 0.876, 0.969, 0.973, 0.958, 0.951, 0.852, 0.873, 0.763, 0.802, 0.949, 0.905, 0.933, 0.981, 0.964, 0.897, 0.932, 0.974, 0.87, 0.939, 0.949, 0.944, 0.903, 0.93, 1.0, 0.951, 0.981, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7057
Averaged Test Accurancy: 0.9292
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9173
Averaged Test Recal score: 0.9225
Std Test Accurancy: 0.0573
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2769 |Global loss: 1.8394| Local H loss: 0.1018  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2384 |Global loss: 1.0915| Local H loss: 0.0573  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2142 |Global loss: 0.8031| Local H loss: 0.0561  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2152 |Global loss: 0.7616| Local H loss: 0.0517  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2919 |Global loss: 1.8434| Local H loss: 0.1006  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2421 |Global loss: 1.1841| Local H loss: 0.0632  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.229 |Global loss: 0.9275| Local H loss: 0.0582  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2206 |Global loss: 0.8098| Local H loss: 0.0524  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2646 |Global loss: 1.758| Local H loss: 0.0919  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2288 |Global loss: 1.0022| Local H loss: 0.0634  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2215 |Global loss: 0.9131| Local H loss: 0.0571  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2163 |Global loss: 0.7678| Local H loss: 0.0529  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3771 |Global loss: 2.0655| Local H loss: 0.0874  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3777 |Global loss: 1.4799| Local H loss: 0.0666  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3065 |Global loss: 0.884| Local H loss: 0.0502  | Global H loss: 0.0323 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3537 |Global loss: 1.014| Local H loss: 0.0553  | Global H loss: 0.0337 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.8154| Local H loss: 0.0923  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2426 |Global loss: 1.3259| Local H loss: 0.0698  | Global H loss: 0.0514 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2294 |Global loss: 1.024| Local H loss: 0.0616  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.226 |Global loss: 0.9062| Local H loss: 0.0592  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2835 |Global loss: 1.8818| Local H loss: 0.0964  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2469 |Global loss: 1.1871| Local H loss: 0.0647  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.231 |Global loss: 0.9814| Local H loss: 0.0607  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2301 |Global loss: 0.8897| Local H loss: 0.0556  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2689 |Global loss: 1.8522| Local H loss: 0.0945  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2316 |Global loss: 1.1226| Local H loss: 0.0647  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2342 |Global loss: 0.9983| Local H loss: 0.0647  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2318 |Global loss: 0.9289| Local H loss: 0.0583  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2794 |Global loss: 1.8287| Local H loss: 0.1005  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2222 |Global loss: 0.9652| Local H loss: 0.0556  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2092 |Global loss: 0.7855| Local H loss: 0.0528  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2049 |Global loss: 0.6986| Local H loss: 0.0487  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2651 |Global loss: 1.7011| Local H loss: 0.09  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 1.0742| Local H loss: 0.0578  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2121 |Global loss: 0.8079| Local H loss: 0.0523  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2109 |Global loss: 0.6892| Local H loss: 0.0495  | Global H loss: 0.0344 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2793 |Global loss: 1.7996| Local H loss: 0.0995  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2338 |Global loss: 1.0221| Local H loss: 0.0637  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2343 |Global loss: 1.0373| Local H loss: 0.0635  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2242 |Global loss: 0.892| Local H loss: 0.0571  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2781 |Global loss: 1.8656| Local H loss: 0.1014  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2227 |Global loss: 0.9846| Local H loss: 0.0615  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2208 |Global loss: 0.8082| Local H loss: 0.0574  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2186 |Global loss: 0.8302| Local H loss: 0.0551  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 1.6223| Local H loss: 0.0973  | Global H loss: 0.0534 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2158 |Global loss: 0.8405| Local H loss: 0.053  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2091 |Global loss: 0.7712| Local H loss: 0.0553  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2032 |Global loss: 0.6284| Local H loss: 0.0506  | Global H loss: 0.0341 [0m
------------------------- time cost ------------------------- 7.095006465911865
Chosen Clients:  [14, 10, 4, 25, 19, 7, 5, 23, 0, 26, 20, 1]

-------------Round number: 82-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.975, 0.947, 0.951, 0.87, 0.817, 0.764, 0.811, 0.949, 0.912, 0.939, 0.988, 0.976, 0.891, 0.924, 0.978, 0.911, 0.944, 0.931, 0.963, 0.925, 0.917, 0.981, 0.969, 0.989, 0.802, 0.988, 0.948]
AUC in each clients:  [86.823, 75.481, 85.734, 79.803, 75.715, 81.632, 76.481, 70.168, 70.973, 73.394, 78.873, 79.211, 81.747, 80.993, 81.898, 91.614, 91.775, 90.909, 89.695, 88.693, 101.615, 80.866, 92.557, 95.365, 102.965, 97.926, 93.912, 94.723, 85.852, 95.879]
F1 Score:  [0.939, 0.859, 0.967, 0.973, 0.941, 0.942, 0.851, 0.824, 0.716, 0.798, 0.949, 0.904, 0.934, 0.981, 0.973, 0.891, 0.914, 0.974, 0.867, 0.938, 0.905, 0.951, 0.901, 0.91, 0.973, 0.958, 0.984, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.973, 0.941, 0.94, 0.852, 0.838, 0.763, 0.802, 0.949, 0.905, 0.933, 0.981, 0.974, 0.897, 0.918, 0.974, 0.87, 0.939, 0.91, 0.965, 0.903, 0.93, 0.972, 0.957, 0.981, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.7071
Averaged Test Accurancy: 0.9265
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9139
Averaged Test Recal score: 0.9191
Std Test Accurancy: 0.0596
Std Test AUC: 0.0038
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2825 |Global loss: 1.8616| Local H loss: 0.0982  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2283 |Global loss: 0.9792| Local H loss: 0.0613  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2257 |Global loss: 0.899| Local H loss: 0.0578  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2165 |Global loss: 0.7822| Local H loss: 0.054  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2759 |Global loss: 1.793| Local H loss: 0.0968  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2293 |Global loss: 1.0798| Local H loss: 0.0645  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2179 |Global loss: 0.8199| Local H loss: 0.058  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2161 |Global loss: 0.7719| Local H loss: 0.0538  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.277 |Global loss: 1.8518| Local H loss: 0.0956  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2646 |Global loss: 1.1621| Local H loss: 0.062  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2301 |Global loss: 0.9948| Local H loss: 0.0588  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2333 |Global loss: 0.8759| Local H loss: 0.0592  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2784 |Global loss: 1.7685| Local H loss: 0.0919  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2241 |Global loss: 0.9681| Local H loss: 0.0608  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2213 |Global loss: 0.843| Local H loss: 0.0542  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2121 |Global loss: 0.7076| Local H loss: 0.0528  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.273 |Global loss: 1.7494| Local H loss: 0.0995  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2232 |Global loss: 0.9098| Local H loss: 0.0593  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.216 |Global loss: 0.8703| Local H loss: 0.0514  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.211 |Global loss: 0.7458| Local H loss: 0.0503  | Global H loss: 0.0365 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.9211| Local H loss: 0.1026  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2274 |Global loss: 1.0939| Local H loss: 0.061  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2197 |Global loss: 0.8407| Local H loss: 0.0589  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2115 |Global loss: 0.7397| Local H loss: 0.0511  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2754 |Global loss: 1.8072| Local H loss: 0.0989  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2472 |Global loss: 1.1633| Local H loss: 0.0618  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2284 |Global loss: 0.9193| Local H loss: 0.0597  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2176 |Global loss: 0.7981| Local H loss: 0.0554  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2865 |Global loss: 1.9395| Local H loss: 0.0997  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2206 |Global loss: 0.9471| Local H loss: 0.0579  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2152 |Global loss: 0.7651| Local H loss: 0.0557  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2069 |Global loss: 0.683| Local H loss: 0.0496  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2743 |Global loss: 1.7357| Local H loss: 0.0957  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.227 |Global loss: 0.9322| Local H loss: 0.0618  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2192 |Global loss: 0.776| Local H loss: 0.0585  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2123 |Global loss: 0.7104| Local H loss: 0.0531  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2695 |Global loss: 1.6557| Local H loss: 0.0952  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2256 |Global loss: 0.9426| Local H loss: 0.0593  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2202 |Global loss: 0.8321| Local H loss: 0.0579  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2169 |Global loss: 0.7957| Local H loss: 0.0528  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2682 |Global loss: 1.5678| Local H loss: 0.0992  | Global H loss: 0.0538 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2134 |Global loss: 0.8043| Local H loss: 0.053  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2021 |Global loss: 0.6479| Local H loss: 0.0514  | Global H loss: 0.0351 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2068 |Global loss: 0.653| Local H loss: 0.0499  | Global H loss: 0.0341 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2711 |Global loss: 1.8218| Local H loss: 0.0913  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2344 |Global loss: 1.0721| Local H loss: 0.0647  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2233 |Global loss: 0.9515| Local H loss: 0.055  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2214 |Global loss: 0.8526| Local H loss: 0.0571  | Global H loss: 0.0405 [0m
------------------------- time cost ------------------------- 6.573301076889038
Chosen Clients:  [24, 0, 2, 17, 26, 25, 3, 4, 18, 14, 1, 5]

-------------Round number: 83-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.975, 0.961, 0.951, 0.87, 0.831, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.891, 0.924, 0.978, 0.911, 0.944, 0.951, 0.963, 0.925, 0.917, 0.981, 0.969, 0.979, 0.802, 0.988, 0.948]
AUC in each clients:  [86.829, 75.493, 85.734, 79.803, 75.773, 81.686, 76.481, 70.284, 70.973, 73.394, 78.852, 79.211, 81.747, 80.993, 81.905, 91.614, 91.775, 90.909, 89.695, 88.708, 101.599, 80.866, 92.557, 95.316, 102.965, 97.924, 93.904, 94.723, 85.852, 95.879]
F1 Score:  [0.939, 0.859, 0.967, 0.973, 0.957, 0.945, 0.851, 0.834, 0.716, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.891, 0.914, 0.974, 0.867, 0.938, 0.935, 0.951, 0.901, 0.91, 0.973, 0.958, 0.971, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.973, 0.958, 0.94, 0.852, 0.847, 0.763, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.897, 0.918, 0.974, 0.87, 0.939, 0.936, 0.965, 0.903, 0.93, 0.972, 0.957, 0.968, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.6887
Averaged Test Accurancy: 0.9272
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9151
Averaged Test Recal score: 0.9201
Std Test Accurancy: 0.0587
Std Test AUC: 0.0037
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.9199| Local H loss: 0.0884  | Global H loss: 0.0569 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2382 |Global loss: 1.3628| Local H loss: 0.0657  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2317 |Global loss: 1.1218| Local H loss: 0.0625  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2264 |Global loss: 0.8432| Local H loss: 0.0609  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2731 |Global loss: 1.7291| Local H loss: 0.0928  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2266 |Global loss: 1.0464| Local H loss: 0.0624  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2187 |Global loss: 0.8545| Local H loss: 0.0535  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2202 |Global loss: 0.824| Local H loss: 0.0579  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2849 |Global loss: 1.9109| Local H loss: 0.0988  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2322 |Global loss: 0.9827| Local H loss: 0.0646  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2318 |Global loss: 0.9012| Local H loss: 0.0591  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2217 |Global loss: 0.7839| Local H loss: 0.0577  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2778 |Global loss: 2.0143| Local H loss: 0.0941  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2337 |Global loss: 1.1878| Local H loss: 0.0648  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2358 |Global loss: 1.013| Local H loss: 0.0625  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2223 |Global loss: 0.9276| Local H loss: 0.0559  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.274 |Global loss: 1.9081| Local H loss: 0.0989  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2195 |Global loss: 0.8648| Local H loss: 0.0581  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2149 |Global loss: 0.781| Local H loss: 0.0545  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2096 |Global loss: 0.6566| Local H loss: 0.0492  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2758 |Global loss: 2.0051| Local H loss: 0.0925  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2458 |Global loss: 1.2993| Local H loss: 0.0706  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2309 |Global loss: 1.0446| Local H loss: 0.0652  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2241 |Global loss: 0.8838| Local H loss: 0.0602  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2898 |Global loss: 1.9269| Local H loss: 0.0906  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2659 |Global loss: 1.4152| Local H loss: 0.0679  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2384 |Global loss: 1.0546| Local H loss: 0.0623  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2383 |Global loss: 0.9947| Local H loss: 0.0595  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2939 |Global loss: 2.0238| Local H loss: 0.1011  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2462 |Global loss: 1.2487| Local H loss: 0.0621  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2363 |Global loss: 1.0435| Local H loss: 0.0619  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2427 |Global loss: 0.9233| Local H loss: 0.0592  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 1.6394| Local H loss: 0.0993  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2126 |Global loss: 0.7044| Local H loss: 0.0571  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2149 |Global loss: 0.6792| Local H loss: 0.0488  | Global H loss: 0.0338 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2021 |Global loss: 0.6087| Local H loss: 0.0452  | Global H loss: 0.0309 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.869| Local H loss: 0.1021  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.237 |Global loss: 1.3487| Local H loss: 0.0634  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2104 |Global loss: 0.8313| Local H loss: 0.0558  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2151 |Global loss: 0.858| Local H loss: 0.0544  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2703 |Global loss: 1.7999| Local H loss: 0.091  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2363 |Global loss: 1.2093| Local H loss: 0.0655  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2333 |Global loss: 1.0475| Local H loss: 0.0589  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2184 |Global loss: 0.8595| Local H loss: 0.0563  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2802 |Global loss: 1.8409| Local H loss: 0.0944  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2491 |Global loss: 1.2212| Local H loss: 0.0584  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.218 |Global loss: 0.8121| Local H loss: 0.056  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2198 |Global loss: 0.786| Local H loss: 0.0531  | Global H loss: 0.0377 [0m
------------------------- time cost ------------------------- 7.69439959526062
Chosen Clients:  [8, 21, 1, 15, 26, 11, 12, 29, 3, 23, 6, 2]

-------------Round number: 84-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.842, 0.988, 0.975, 0.961, 0.963, 0.87, 0.831, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.963, 0.891, 0.924, 0.978, 0.933, 0.944, 0.951, 0.963, 0.925, 0.917, 0.981, 0.98, 0.979, 0.802, 0.988, 0.948]
AUC in each clients:  [86.815, 75.443, 85.719, 79.795, 75.785, 81.661, 76.481, 70.284, 70.973, 73.394, 78.852, 79.211, 81.747, 80.993, 81.869, 91.614, 91.775, 90.93, 89.699, 88.708, 101.599, 80.866, 92.557, 95.316, 102.967, 97.927, 93.909, 94.723, 85.852, 95.879]
F1 Score:  [0.939, 0.844, 0.987, 0.973, 0.957, 0.956, 0.851, 0.834, 0.716, 0.798, 0.938, 0.904, 0.934, 0.981, 0.96, 0.891, 0.914, 0.974, 0.892, 0.938, 0.935, 0.951, 0.901, 0.91, 0.973, 0.971, 0.971, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.866, 0.989, 0.973, 0.958, 0.959, 0.852, 0.847, 0.763, 0.802, 0.939, 0.905, 0.933, 0.981, 0.964, 0.897, 0.918, 0.974, 0.898, 0.939, 0.936, 0.965, 0.903, 0.93, 0.972, 0.968, 0.968, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.6528
Averaged Test Accurancy: 0.9288
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9165
Averaged Test Recal score: 0.9220
Std Test Accurancy: 0.0601
Std Test AUC: 0.0037
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.406 |Global loss: 1.9856| Local H loss: 0.088  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3717 |Global loss: 1.3008| Local H loss: 0.0588  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3448 |Global loss: 1.0592| Local H loss: 0.0509  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3754 |Global loss: 0.9601| Local H loss: 0.0525  | Global H loss: 0.033 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2894 |Global loss: 1.8499| Local H loss: 0.1094  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.226 |Global loss: 1.0874| Local H loss: 0.0601  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2103 |Global loss: 0.7805| Local H loss: 0.0544  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2055 |Global loss: 0.6564| Local H loss: 0.0489  | Global H loss: 0.0352 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2749 |Global loss: 1.8697| Local H loss: 0.0926  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2342 |Global loss: 1.0878| Local H loss: 0.0657  | Global H loss: 0.0473 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2182 |Global loss: 0.8688| Local H loss: 0.059  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2236 |Global loss: 0.8959| Local H loss: 0.0594  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3221 |Global loss: 1.9405| Local H loss: 0.0887  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2975 |Global loss: 1.4093| Local H loss: 0.0662  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.269 |Global loss: 0.9957| Local H loss: 0.0587  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2759 |Global loss: 0.9162| Local H loss: 0.0543  | Global H loss: 0.0372 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2691 |Global loss: 1.8544| Local H loss: 0.0989  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2211 |Global loss: 0.8834| Local H loss: 0.059  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2163 |Global loss: 0.9001| Local H loss: 0.0518  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2143 |Global loss: 0.7672| Local H loss: 0.051  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2918 |Global loss: 1.9581| Local H loss: 0.0999  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2431 |Global loss: 1.2509| Local H loss: 0.0658  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2341 |Global loss: 1.1047| Local H loss: 0.0629  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2306 |Global loss: 0.9515| Local H loss: 0.0546  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.8845| Local H loss: 0.0969  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2286 |Global loss: 1.1235| Local H loss: 0.0602  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2295 |Global loss: 1.0311| Local H loss: 0.0571  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.216 |Global loss: 0.8541| Local H loss: 0.059  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2716 |Global loss: 2.0159| Local H loss: 0.0908  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2321 |Global loss: 1.2807| Local H loss: 0.0637  | Global H loss: 0.0502 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2245 |Global loss: 1.0573| Local H loss: 0.0631  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2176 |Global loss: 0.8465| Local H loss: 0.0601  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2883 |Global loss: 1.9573| Local H loss: 0.0982  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2486 |Global loss: 1.3112| Local H loss: 0.064  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2445 |Global loss: 1.1588| Local H loss: 0.0615  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2419 |Global loss: 1.0116| Local H loss: 0.0609  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2762 |Global loss: 1.7615| Local H loss: 0.0978  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2185 |Global loss: 0.8882| Local H loss: 0.057  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2186 |Global loss: 0.8178| Local H loss: 0.0546  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2139 |Global loss: 0.7595| Local H loss: 0.0524  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2911 |Global loss: 2.154| Local H loss: 0.101  | Global H loss: 0.0597 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2486 |Global loss: 1.3237| Local H loss: 0.0642  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.232 |Global loss: 1.0115| Local H loss: 0.0659  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2389 |Global loss: 0.9085| Local H loss: 0.0592  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2861 |Global loss: 2.2637| Local H loss: 0.102  | Global H loss: 0.0604 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2565 |Global loss: 1.5939| Local H loss: 0.0773  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.236 |Global loss: 1.0157| Local H loss: 0.0738  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2241 |Global loss: 0.8603| Local H loss: 0.0632  | Global H loss: 0.0419 [0m
------------------------- time cost ------------------------- 7.41233229637146
Chosen Clients:  [2, 22, 5, 1, 20, 13, 29, 14, 7, 23, 12, 3]

-------------Round number: 85-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.953, 0.95, 0.961, 0.963, 0.87, 0.831, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.963, 0.967, 0.924, 0.978, 0.933, 0.944, 0.951, 0.963, 0.925, 0.927, 0.981, 0.98, 0.979, 0.802, 0.988, 0.948]
AUC in each clients:  [86.815, 75.508, 85.69, 79.761, 75.785, 81.661, 76.49, 70.284, 70.952, 73.394, 78.852, 79.32, 81.721, 80.993, 81.869, 91.779, 91.775, 90.93, 89.699, 88.708, 101.599, 80.88, 92.557, 95.29, 102.967, 97.927, 93.925, 94.723, 85.852, 95.842]
F1 Score:  [0.939, 0.859, 0.954, 0.946, 0.957, 0.956, 0.851, 0.834, 0.711, 0.798, 0.938, 0.904, 0.934, 0.981, 0.96, 0.966, 0.914, 0.974, 0.892, 0.938, 0.935, 0.951, 0.901, 0.92, 0.973, 0.971, 0.966, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.957, 0.947, 0.958, 0.959, 0.852, 0.847, 0.768, 0.802, 0.939, 0.905, 0.933, 0.981, 0.964, 0.967, 0.918, 0.974, 0.898, 0.939, 0.936, 0.965, 0.903, 0.942, 0.972, 0.968, 0.963, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.6429
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9175
Averaged Test Recal score: 0.9232
Std Test Accurancy: 0.0582
Std Test AUC: 0.0036
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.9668| Local H loss: 0.1007  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2257 |Global loss: 0.9827| Local H loss: 0.0646  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.234 |Global loss: 0.9584| Local H loss: 0.0587  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.217 |Global loss: 0.8677| Local H loss: 0.0577  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2746 |Global loss: 1.7197| Local H loss: 0.0963  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2382 |Global loss: 1.1646| Local H loss: 0.0579  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.227 |Global loss: 0.9711| Local H loss: 0.0544  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 0.8151| Local H loss: 0.0516  | Global H loss: 0.0364 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.288 |Global loss: 1.9779| Local H loss: 0.1025  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2344 |Global loss: 1.14| Local H loss: 0.0604  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.223 |Global loss: 0.8672| Local H loss: 0.0565  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2273 |Global loss: 0.8259| Local H loss: 0.0577  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2782 |Global loss: 1.8729| Local H loss: 0.099  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2285 |Global loss: 1.0605| Local H loss: 0.0643  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2249 |Global loss: 0.9934| Local H loss: 0.0591  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2245 |Global loss: 0.9304| Local H loss: 0.059  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2661 |Global loss: 1.6695| Local H loss: 0.0969  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2149 |Global loss: 0.8563| Local H loss: 0.0551  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2042 |Global loss: 0.6853| Local H loss: 0.0503  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2041 |Global loss: 0.6494| Local H loss: 0.047  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2807 |Global loss: 2.0253| Local H loss: 0.0919  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2515 |Global loss: 1.3803| Local H loss: 0.0702  | Global H loss: 0.052 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2404 |Global loss: 0.9999| Local H loss: 0.0591  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2324 |Global loss: 0.9478| Local H loss: 0.0569  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2758 |Global loss: 1.9505| Local H loss: 0.0905  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 1.274| Local H loss: 0.0658  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2234 |Global loss: 1.0525| Local H loss: 0.0631  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2236 |Global loss: 0.9478| Local H loss: 0.0611  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2789 |Global loss: 1.7959| Local H loss: 0.0985  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2241 |Global loss: 1.0467| Local H loss: 0.0603  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 0.885| Local H loss: 0.0612  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2151 |Global loss: 0.7157| Local H loss: 0.053  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2766 |Global loss: 1.9059| Local H loss: 0.1049  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2311 |Global loss: 1.0869| Local H loss: 0.0615  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2285 |Global loss: 0.8915| Local H loss: 0.0602  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2184 |Global loss: 0.7747| Local H loss: 0.0544  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.278 |Global loss: 1.7255| Local H loss: 0.1014  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2223 |Global loss: 0.9537| Local H loss: 0.0582  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2105 |Global loss: 0.77| Local H loss: 0.0509  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2037 |Global loss: 0.7103| Local H loss: 0.0497  | Global H loss: 0.0368 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2799 |Global loss: 1.9049| Local H loss: 0.0945  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2364 |Global loss: 1.2596| Local H loss: 0.0648  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2264 |Global loss: 0.9541| Local H loss: 0.0616  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2218 |Global loss: 0.9062| Local H loss: 0.0586  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2839 |Global loss: 1.9198| Local H loss: 0.096  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2517 |Global loss: 1.3853| Local H loss: 0.0614  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2319 |Global loss: 1.0613| Local H loss: 0.0621  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2589 |Global loss: 1.0177| Local H loss: 0.0583  | Global H loss: 0.0424 [0m
------------------------- time cost ------------------------- 6.051703691482544
Chosen Clients:  [10, 23, 13, 22, 28, 11, 2, 4, 7, 29, 24, 15]

-------------Round number: 86-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.977, 0.975, 0.961, 0.963, 0.87, 0.831, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.967, 0.924, 0.978, 0.933, 0.944, 0.941, 0.963, 0.935, 0.917, 0.981, 0.98, 0.979, 0.802, 0.988, 0.948]
AUC in each clients:  [86.815, 75.49, 85.791, 79.819, 75.785, 81.691, 76.49, 70.224, 70.952, 73.394, 78.852, 79.32, 81.722, 80.992, 81.918, 91.779, 91.775, 90.93, 89.699, 88.708, 101.684, 80.88, 92.62, 95.376, 102.967, 97.927, 93.925, 94.723, 85.852, 95.857]
F1 Score:  [0.939, 0.859, 0.976, 0.973, 0.957, 0.954, 0.851, 0.833, 0.711, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.966, 0.914, 0.974, 0.892, 0.938, 0.92, 0.951, 0.916, 0.91, 0.973, 0.971, 0.966, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.978, 0.973, 0.958, 0.951, 0.852, 0.85, 0.768, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.967, 0.918, 0.974, 0.898, 0.939, 0.923, 0.965, 0.917, 0.93, 0.972, 0.968, 0.963, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5970
Averaged Test Accurancy: 0.9319
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9191
Averaged Test Recal score: 0.9245
Std Test Accurancy: 0.0594
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.8903| Local H loss: 0.0959  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2308 |Global loss: 1.0389| Local H loss: 0.0662  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2216 |Global loss: 0.9279| Local H loss: 0.0576  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2173 |Global loss: 0.8337| Local H loss: 0.0555  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2806 |Global loss: 1.8678| Local H loss: 0.1026  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2216 |Global loss: 0.8717| Local H loss: 0.0582  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.216 |Global loss: 0.7457| Local H loss: 0.0516  | Global H loss: 0.0375 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.216 |Global loss: 0.8291| Local H loss: 0.0529  | Global H loss: 0.0389 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2808 |Global loss: 2.033| Local H loss: 0.0979  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2682 |Global loss: 1.467| Local H loss: 0.0681  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2386 |Global loss: 1.0226| Local H loss: 0.0639  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2309 |Global loss: 0.9739| Local H loss: 0.062  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.274 |Global loss: 1.7269| Local H loss: 0.0931  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2288 |Global loss: 1.0223| Local H loss: 0.0571  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2323 |Global loss: 1.0128| Local H loss: 0.052  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2235 |Global loss: 0.8634| Local H loss: 0.0524  | Global H loss: 0.0383 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2719 |Global loss: 1.762| Local H loss: 0.0992  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2251 |Global loss: 0.9235| Local H loss: 0.0598  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.216 |Global loss: 0.7726| Local H loss: 0.0553  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2164 |Global loss: 0.8133| Local H loss: 0.0533  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2865 |Global loss: 2.0155| Local H loss: 0.0973  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2383 |Global loss: 1.1406| Local H loss: 0.065  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2307 |Global loss: 0.9167| Local H loss: 0.0631  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2321 |Global loss: 0.8654| Local H loss: 0.0567  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2787 |Global loss: 1.8222| Local H loss: 0.0989  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2291 |Global loss: 1.0327| Local H loss: 0.0599  | Global H loss: 0.0462 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2289 |Global loss: 0.9447| Local H loss: 0.0569  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2269 |Global loss: 0.9832| Local H loss: 0.054  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2901 |Global loss: 1.8798| Local H loss: 0.0952  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2464 |Global loss: 1.1867| Local H loss: 0.0666  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2398 |Global loss: 0.9805| Local H loss: 0.0555  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2289 |Global loss: 0.9077| Local H loss: 0.0556  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2821 |Global loss: 2.0216| Local H loss: 0.1014  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2411 |Global loss: 1.3219| Local H loss: 0.0668  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2435 |Global loss: 1.2012| Local H loss: 0.0649  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2289 |Global loss: 0.9969| Local H loss: 0.0609  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2709 |Global loss: 1.9771| Local H loss: 0.0914  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2279 |Global loss: 1.2186| Local H loss: 0.0635  | Global H loss: 0.0505 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2293 |Global loss: 1.0457| Local H loss: 0.0621  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2222 |Global loss: 0.8614| Local H loss: 0.0638  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2685 |Global loss: 1.9614| Local H loss: 0.0891  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2369 |Global loss: 1.2267| Local H loss: 0.0667  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2324 |Global loss: 1.0725| Local H loss: 0.0655  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.228 |Global loss: 0.9124| Local H loss: 0.0628  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.326 |Global loss: 1.9328| Local H loss: 0.0867  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2828 |Global loss: 1.2126| Local H loss: 0.0624  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2667 |Global loss: 0.9811| Local H loss: 0.0563  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2614 |Global loss: 0.8994| Local H loss: 0.0541  | Global H loss: 0.0378 [0m
------------------------- time cost ------------------------- 6.573232650756836
Chosen Clients:  [7, 23, 26, 11, 19, 10, 15, 18, 13, 27, 14, 20]

-------------Round number: 87-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.977, 0.975, 0.961, 0.963, 0.87, 0.845, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.88, 0.924, 0.978, 0.933, 0.944, 0.941, 0.963, 0.925, 0.927, 0.981, 0.98, 0.979, 0.802, 0.988, 0.948]
AUC in each clients:  [86.815, 75.49, 85.761, 79.819, 75.797, 81.691, 76.49, 70.31, 70.952, 73.394, 78.854, 79.214, 81.722, 80.985, 81.918, 91.586, 91.775, 90.93, 89.699, 88.708, 101.684, 80.88, 92.614, 95.458, 102.966, 97.927, 93.925, 94.723, 85.864, 95.833]
F1 Score:  [0.939, 0.859, 0.977, 0.973, 0.957, 0.954, 0.851, 0.85, 0.711, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.878, 0.914, 0.974, 0.892, 0.938, 0.92, 0.951, 0.901, 0.922, 0.973, 0.971, 0.966, 0.779, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.98, 0.973, 0.958, 0.951, 0.852, 0.863, 0.768, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.885, 0.918, 0.974, 0.898, 0.939, 0.923, 0.965, 0.903, 0.942, 0.972, 0.968, 0.963, 0.807, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5971
Averaged Test Accurancy: 0.9292
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9167
Averaged Test Recal score: 0.9222
Std Test Accurancy: 0.0588
Std Test AUC: 0.0037
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2747 |Global loss: 1.8758| Local H loss: 0.0966  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2283 |Global loss: 0.9987| Local H loss: 0.0628  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2201 |Global loss: 0.9226| Local H loss: 0.0548  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2166 |Global loss: 0.7664| Local H loss: 0.0578  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2818 |Global loss: 1.8046| Local H loss: 0.0986  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2222 |Global loss: 0.9173| Local H loss: 0.0598  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2141 |Global loss: 0.7894| Local H loss: 0.0525  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2091 |Global loss: 0.7391| Local H loss: 0.0548  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2815 |Global loss: 1.832| Local H loss: 0.0975  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2302 |Global loss: 1.0377| Local H loss: 0.0645  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2154 |Global loss: 0.8713| Local H loss: 0.0582  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2088 |Global loss: 0.7011| Local H loss: 0.0485  | Global H loss: 0.0348 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.285 |Global loss: 1.8791| Local H loss: 0.0971  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2397 |Global loss: 1.16| Local H loss: 0.0654  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2348 |Global loss: 1.0072| Local H loss: 0.0603  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2278 |Global loss: 0.8788| Local H loss: 0.0565  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2664 |Global loss: 1.6292| Local H loss: 0.0956  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2329 |Global loss: 0.9988| Local H loss: 0.0575  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2175 |Global loss: 0.9098| Local H loss: 0.055  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2159 |Global loss: 0.8622| Local H loss: 0.0519  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2691 |Global loss: 1.8441| Local H loss: 0.0968  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2374 |Global loss: 1.2604| Local H loss: 0.0642  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2318 |Global loss: 0.9228| Local H loss: 0.0551  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2131 |Global loss: 0.8358| Local H loss: 0.0557  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3126 |Global loss: 1.8829| Local H loss: 0.089  | Global H loss: 0.0549 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2816 |Global loss: 1.3015| Local H loss: 0.0625  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2812 |Global loss: 0.8207| Local H loss: 0.0509  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2541 |Global loss: 0.8082| Local H loss: 0.0505  | Global H loss: 0.0354 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2805 |Global loss: 1.6493| Local H loss: 0.1035  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2276 |Global loss: 0.791| Local H loss: 0.0605  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2079 |Global loss: 0.63| Local H loss: 0.0491  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1878 |Global loss: 0.4572| Local H loss: 0.0415  | Global H loss: 0.0266 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2778 |Global loss: 1.9567| Local H loss: 0.0943  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2395 |Global loss: 1.1496| Local H loss: 0.0633  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2319 |Global loss: 1.0496| Local H loss: 0.0635  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2322 |Global loss: 0.9855| Local H loss: 0.0587  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3755 |Global loss: 1.9372| Local H loss: 0.0856  | Global H loss: 0.0526 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3583 |Global loss: 1.4264| Local H loss: 0.0621  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3317 |Global loss: 1.1211| Local H loss: 0.0606  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3218 |Global loss: 0.9879| Local H loss: 0.0563  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2735 |Global loss: 1.8434| Local H loss: 0.0967  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2302 |Global loss: 0.9362| Local H loss: 0.0632  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.229 |Global loss: 0.924| Local H loss: 0.0604  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.214 |Global loss: 0.744| Local H loss: 0.0547  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2587 |Global loss: 1.4685| Local H loss: 0.093  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2199 |Global loss: 0.9025| Local H loss: 0.0548  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2152 |Global loss: 0.7318| Local H loss: 0.0516  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2122 |Global loss: 0.7059| Local H loss: 0.0468  | Global H loss: 0.0334 [0m
------------------------- time cost ------------------------- 6.311306715011597
Chosen Clients:  [1, 23, 15, 8, 2, 22, 19, 7, 27, 11, 3, 4]

-------------Round number: 88-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.977, 0.975, 0.961, 0.963, 0.87, 0.859, 0.764, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.902, 0.924, 0.978, 0.933, 0.944, 0.922, 0.963, 0.925, 0.927, 0.981, 0.98, 0.989, 0.833, 0.988, 0.948]
AUC in each clients:  [86.815, 75.49, 85.761, 79.819, 75.797, 81.691, 76.49, 70.269, 70.952, 73.394, 78.847, 79.255, 81.722, 80.993, 81.899, 91.645, 91.775, 90.93, 89.693, 88.703, 101.535, 80.88, 92.614, 95.397, 102.966, 97.927, 93.933, 94.761, 85.864, 95.833]
F1 Score:  [0.939, 0.859, 0.977, 0.973, 0.957, 0.954, 0.851, 0.866, 0.711, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.901, 0.914, 0.974, 0.894, 0.938, 0.89, 0.951, 0.901, 0.92, 0.973, 0.971, 0.984, 0.82, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.98, 0.973, 0.958, 0.951, 0.852, 0.875, 0.768, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.906, 0.918, 0.974, 0.896, 0.938, 0.897, 0.965, 0.903, 0.942, 0.972, 0.968, 0.981, 0.829, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5789
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9189
Averaged Test Recal score: 0.9237
Std Test Accurancy: 0.0561
Std Test AUC: 0.0036
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2782 |Global loss: 2.1357| Local H loss: 0.0939  | Global H loss: 0.0603 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2354 |Global loss: 1.2008| Local H loss: 0.0663  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2235 |Global loss: 0.969| Local H loss: 0.0594  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2184 |Global loss: 0.8461| Local H loss: 0.0579  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.273 |Global loss: 1.7831| Local H loss: 0.1005  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2234 |Global loss: 1.0768| Local H loss: 0.0597  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2122 |Global loss: 0.7922| Local H loss: 0.0546  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2077 |Global loss: 0.7702| Local H loss: 0.0514  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.31 |Global loss: 1.7385| Local H loss: 0.0891  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2752 |Global loss: 1.1373| Local H loss: 0.06  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2663 |Global loss: 1.0002| Local H loss: 0.0568  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2549 |Global loss: 0.7874| Local H loss: 0.0501  | Global H loss: 0.0343 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4175 |Global loss: 2.092| Local H loss: 0.0884  | Global H loss: 0.0516 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3832 |Global loss: 1.4754| Local H loss: 0.0644  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3544 |Global loss: 1.2236| Local H loss: 0.0576  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3588 |Global loss: 1.0135| Local H loss: 0.0542  | Global H loss: 0.0347 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2751 |Global loss: 1.8742| Local H loss: 0.1011  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2352 |Global loss: 1.1295| Local H loss: 0.066  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 1.1012| Local H loss: 0.0612  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2157 |Global loss: 0.843| Local H loss: 0.0551  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2805 |Global loss: 1.7191| Local H loss: 0.0981  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2398 |Global loss: 1.1216| Local H loss: 0.0576  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.8399| Local H loss: 0.0593  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2251 |Global loss: 0.8972| Local H loss: 0.0569  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2745 |Global loss: 1.7089| Local H loss: 0.0967  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2175 |Global loss: 0.912| Local H loss: 0.0574  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.214 |Global loss: 0.8184| Local H loss: 0.0505  | Global H loss: 0.0394 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2111 |Global loss: 0.7564| Local H loss: 0.0524  | Global H loss: 0.0387 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2849 |Global loss: 1.8766| Local H loss: 0.0979  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.232 |Global loss: 1.1222| Local H loss: 0.0648  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2115 |Global loss: 0.7758| Local H loss: 0.0576  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2172 |Global loss: 0.7625| Local H loss: 0.056  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3684 |Global loss: 1.9585| Local H loss: 0.085  | Global H loss: 0.0525 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3675 |Global loss: 1.4436| Local H loss: 0.0677  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3323 |Global loss: 1.0471| Local H loss: 0.059  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3131 |Global loss: 0.9314| Local H loss: 0.0513  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.9196| Local H loss: 0.0979  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2501 |Global loss: 1.3705| Local H loss: 0.0715  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2305 |Global loss: 1.0376| Local H loss: 0.0622  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2274 |Global loss: 0.9503| Local H loss: 0.0609  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.285 |Global loss: 2.0549| Local H loss: 0.0983  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2446 |Global loss: 1.3348| Local H loss: 0.0637  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2541 |Global loss: 1.1311| Local H loss: 0.065  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2301 |Global loss: 0.9479| Local H loss: 0.0601  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.286 |Global loss: 1.9418| Local H loss: 0.0996  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2421 |Global loss: 1.2028| Local H loss: 0.0629  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2274 |Global loss: 0.8646| Local H loss: 0.0569  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2355 |Global loss: 0.821| Local H loss: 0.0588  | Global H loss: 0.0384 [0m
------------------------- time cost ------------------------- 6.313965320587158
Chosen Clients:  [15, 3, 7, 5, 16, 28, 24, 1, 0, 21, 25, 8]

-------------Round number: 89-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.855, 0.965, 0.975, 0.947, 0.963, 0.87, 0.817, 0.847, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.913, 0.924, 0.978, 0.933, 0.944, 0.922, 0.963, 0.903, 0.927, 0.981, 0.98, 0.989, 0.823, 0.988, 0.948]
AUC in each clients:  [86.815, 75.471, 85.812, 79.789, 75.728, 81.691, 76.49, 70.125, 71.1, 73.394, 78.847, 79.268, 81.722, 80.993, 81.899, 91.702, 91.775, 90.93, 89.693, 88.701, 101.535, 80.88, 92.585, 95.205, 102.966, 97.927, 93.933, 94.693, 85.864, 95.833]
F1 Score:  [0.939, 0.859, 0.967, 0.973, 0.941, 0.954, 0.851, 0.824, 0.827, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.911, 0.914, 0.974, 0.894, 0.938, 0.89, 0.951, 0.871, 0.921, 0.973, 0.971, 0.984, 0.806, 0.989, 0.933]
Recall Score:  [0.928, 0.876, 0.969, 0.973, 0.941, 0.951, 0.852, 0.838, 0.843, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.915, 0.918, 0.974, 0.896, 0.938, 0.897, 0.965, 0.875, 0.942, 0.972, 0.968, 0.981, 0.826, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5843
Averaged Test Accurancy: 0.9307
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9194
Averaged Test Recal score: 0.9233
Std Test Accurancy: 0.0523
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3178 |Global loss: 1.8226| Local H loss: 0.0928  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2852 |Global loss: 1.0221| Local H loss: 0.0584  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2715 |Global loss: 0.998| Local H loss: 0.0572  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.265 |Global loss: 0.9326| Local H loss: 0.0541  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2938 |Global loss: 2.1263| Local H loss: 0.1038  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2575 |Global loss: 1.3346| Local H loss: 0.0677  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2452 |Global loss: 1.1068| Local H loss: 0.061  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2304 |Global loss: 0.9314| Local H loss: 0.0618  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2804 |Global loss: 1.96| Local H loss: 0.1  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2323 |Global loss: 1.0823| Local H loss: 0.0656  | Global H loss: 0.0485 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2174 |Global loss: 0.8092| Local H loss: 0.0585  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2138 |Global loss: 0.7608| Local H loss: 0.0564  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2853 |Global loss: 1.8556| Local H loss: 0.1003  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2404 |Global loss: 1.1253| Local H loss: 0.0623  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2274 |Global loss: 0.9169| Local H loss: 0.0592  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2195 |Global loss: 0.7887| Local H loss: 0.0544  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3029 |Global loss: 1.8574| Local H loss: 0.0938  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2339 |Global loss: 1.0806| Local H loss: 0.0659  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2284 |Global loss: 1.0158| Local H loss: 0.0649  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2211 |Global loss: 0.8356| Local H loss: 0.0589  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2782 |Global loss: 1.7483| Local H loss: 0.0944  | Global H loss: 0.0554 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2308 |Global loss: 1.0345| Local H loss: 0.0604  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2165 |Global loss: 0.7989| Local H loss: 0.0568  | Global H loss: 0.0401 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.212 |Global loss: 0.7125| Local H loss: 0.05  | Global H loss: 0.036 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2706 |Global loss: 1.805| Local H loss: 0.0942  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.2995| Local H loss: 0.0666  | Global H loss: 0.0504 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2255 |Global loss: 0.9402| Local H loss: 0.0628  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2241 |Global loss: 0.8257| Local H loss: 0.0601  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.273 |Global loss: 1.9036| Local H loss: 0.0966  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2291 |Global loss: 1.2513| Local H loss: 0.0661  | Global H loss: 0.0496 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2245 |Global loss: 1.0303| Local H loss: 0.061  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2216 |Global loss: 0.7757| Local H loss: 0.052  | Global H loss: 0.0369 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.8631| Local H loss: 0.0981  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2339 |Global loss: 1.2126| Local H loss: 0.0663  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2191 |Global loss: 0.9278| Local H loss: 0.0574  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2171 |Global loss: 0.8333| Local H loss: 0.0552  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2803 |Global loss: 1.8467| Local H loss: 0.1014  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2167 |Global loss: 0.875| Local H loss: 0.0613  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2166 |Global loss: 0.8543| Local H loss: 0.0547  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2059 |Global loss: 0.6915| Local H loss: 0.051  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2714 |Global loss: 1.8128| Local H loss: 0.0918  | Global H loss: 0.057 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2351 |Global loss: 1.1214| Local H loss: 0.0621  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2183 |Global loss: 0.8967| Local H loss: 0.0545  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2173 |Global loss: 0.8132| Local H loss: 0.0523  | Global H loss: 0.0392 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4066 |Global loss: 1.9583| Local H loss: 0.0883  | Global H loss: 0.0504 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3874 |Global loss: 1.4869| Local H loss: 0.0616  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.38 |Global loss: 1.1336| Local H loss: 0.0603  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.377 |Global loss: 1.1489| Local H loss: 0.0549  | Global H loss: 0.0377 [0m
------------------------- time cost ------------------------- 6.373900890350342
Chosen Clients:  [7, 11, 29, 23, 2, 17, 28, 18, 21, 16, 3, 22]

-------------Round number: 90-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.947, 0.951, 0.87, 0.817, 0.792, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.946, 0.924, 0.978, 0.933, 0.944, 0.922, 0.975, 0.903, 0.927, 1.0, 0.98, 0.989, 0.823, 0.977, 0.948]
AUC in each clients:  [86.807, 75.505, 85.812, 79.806, 75.728, 81.67, 76.49, 70.128, 70.962, 73.394, 78.847, 79.268, 81.722, 80.993, 81.899, 91.777, 91.826, 90.93, 89.693, 88.701, 101.535, 80.909, 92.585, 95.205, 102.97, 97.924, 93.933, 94.693, 85.89, 95.833]
F1 Score:  [0.939, 0.871, 0.967, 0.973, 0.941, 0.942, 0.851, 0.824, 0.734, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.94, 0.917, 0.974, 0.894, 0.938, 0.89, 0.976, 0.871, 0.921, 1.0, 0.971, 0.984, 0.806, 0.979, 0.933]
Recall Score:  [0.928, 0.891, 0.969, 0.973, 0.941, 0.94, 0.852, 0.838, 0.808, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.943, 0.918, 0.974, 0.896, 0.938, 0.897, 0.976, 0.875, 0.942, 1.0, 0.968, 0.981, 0.826, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5494
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9188
Averaged Test Recal score: 0.9242
Std Test Accurancy: 0.0560
Std Test AUC: 0.0039
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2765 |Global loss: 1.9643| Local H loss: 0.1024  | Global H loss: 0.0599 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2263 |Global loss: 0.9613| Local H loss: 0.0619  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2215 |Global loss: 0.9037| Local H loss: 0.0593  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.216 |Global loss: 0.726| Local H loss: 0.055  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2829 |Global loss: 1.9863| Local H loss: 0.1022  | Global H loss: 0.0597 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2388 |Global loss: 1.2646| Local H loss: 0.0692  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.222 |Global loss: 0.7654| Local H loss: 0.0585  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2261 |Global loss: 0.9576| Local H loss: 0.0611  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2665 |Global loss: 1.8413| Local H loss: 0.0921  | Global H loss: 0.0587 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2356 |Global loss: 1.1497| Local H loss: 0.0668  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2217 |Global loss: 1.0205| Local H loss: 0.0621  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 1.0069| Local H loss: 0.0606  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2807 |Global loss: 1.8649| Local H loss: 0.1023  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2365 |Global loss: 1.1413| Local H loss: 0.0671  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2193 |Global loss: 0.8966| Local H loss: 0.0608  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2063 |Global loss: 0.7157| Local H loss: 0.0529  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 2.2985| Local H loss: 0.1015  | Global H loss: 0.0617 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2402 |Global loss: 1.4164| Local H loss: 0.0688  | Global H loss: 0.052 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.9258| Local H loss: 0.0653  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2258 |Global loss: 0.8994| Local H loss: 0.058  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2747 |Global loss: 1.8216| Local H loss: 0.0941  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.236 |Global loss: 1.1867| Local H loss: 0.0625  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2227 |Global loss: 0.9842| Local H loss: 0.0587  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2157 |Global loss: 0.8596| Local H loss: 0.0557  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.273 |Global loss: 1.7317| Local H loss: 0.0963  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2258 |Global loss: 0.9981| Local H loss: 0.061  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2146 |Global loss: 0.8083| Local H loss: 0.0564  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2125 |Global loss: 0.7672| Local H loss: 0.05  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2851 |Global loss: 1.6974| Local H loss: 0.1019  | Global H loss: 0.0555 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.222 |Global loss: 0.8081| Local H loss: 0.0563  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2033 |Global loss: 0.5746| Local H loss: 0.049  | Global H loss: 0.0331 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2062 |Global loss: 0.6079| Local H loss: 0.0516  | Global H loss: 0.0345 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.281 |Global loss: 2.0178| Local H loss: 0.1031  | Global H loss: 0.0599 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2303 |Global loss: 1.0628| Local H loss: 0.066  | Global H loss: 0.0466 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2161 |Global loss: 0.8727| Local H loss: 0.0603  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2173 |Global loss: 0.8935| Local H loss: 0.0579  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2775 |Global loss: 1.8934| Local H loss: 0.0925  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2317 |Global loss: 1.1714| Local H loss: 0.0655  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2252 |Global loss: 1.0005| Local H loss: 0.0618  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2213 |Global loss: 0.8369| Local H loss: 0.0608  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.282 |Global loss: 1.9002| Local H loss: 0.0925  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.241 |Global loss: 1.2798| Local H loss: 0.0683  | Global H loss: 0.0501 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.236 |Global loss: 1.0637| Local H loss: 0.0605  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2341 |Global loss: 0.9921| Local H loss: 0.0602  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2733 |Global loss: 1.8306| Local H loss: 0.098  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2296 |Global loss: 1.0293| Local H loss: 0.0615  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2215 |Global loss: 0.8311| Local H loss: 0.0592  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.222 |Global loss: 0.7992| Local H loss: 0.057  | Global H loss: 0.039 [0m
------------------------- time cost ------------------------- 7.0604088306427
Chosen Clients:  [7, 28, 26, 24, 1, 4, 22, 21, 25, 14, 12, 19]

-------------Round number: 91-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.947, 0.951, 0.87, 0.817, 0.792, 0.811, 0.937, 0.912, 0.939, 0.988, 0.976, 0.946, 0.924, 0.967, 0.944, 0.944, 0.922, 0.951, 0.935, 0.927, 1.0, 0.98, 0.989, 0.823, 0.977, 0.948]
AUC in each clients:  [86.807, 75.505, 85.799, 79.794, 75.728, 81.67, 76.49, 70.264, 70.962, 73.394, 78.847, 79.253, 81.722, 80.993, 81.899, 91.777, 91.792, 90.925, 89.701, 88.701, 101.535, 80.877, 92.61, 95.417, 102.97, 97.924, 93.933, 94.693, 85.881, 95.848]
F1 Score:  [0.939, 0.871, 0.967, 0.973, 0.941, 0.942, 0.851, 0.822, 0.734, 0.798, 0.938, 0.904, 0.934, 0.981, 0.973, 0.94, 0.914, 0.961, 0.912, 0.938, 0.89, 0.931, 0.916, 0.922, 1.0, 0.971, 0.984, 0.806, 0.979, 0.933]
Recall Score:  [0.928, 0.891, 0.969, 0.973, 0.941, 0.94, 0.852, 0.835, 0.808, 0.802, 0.939, 0.905, 0.933, 0.981, 0.974, 0.943, 0.918, 0.96, 0.913, 0.938, 0.897, 0.955, 0.917, 0.942, 1.0, 0.968, 0.981, 0.826, 0.981, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.5120
Averaged Test Accurancy: 0.9315
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9188
Averaged Test Recal score: 0.9249
Std Test Accurancy: 0.0551
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2774 |Global loss: 1.9261| Local H loss: 0.1013  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2373 |Global loss: 1.0826| Local H loss: 0.0618  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2183 |Global loss: 0.8572| Local H loss: 0.0595  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2102 |Global loss: 0.7563| Local H loss: 0.0552  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2735 |Global loss: 1.8175| Local H loss: 0.1007  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2198 |Global loss: 0.974| Local H loss: 0.0581  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2115 |Global loss: 0.7532| Local H loss: 0.0563  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2145 |Global loss: 0.7503| Local H loss: 0.0529  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2773 |Global loss: 1.7266| Local H loss: 0.092  | Global H loss: 0.0547 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2228 |Global loss: 1.0212| Local H loss: 0.0602  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2083 |Global loss: 0.7694| Local H loss: 0.0525  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2119 |Global loss: 0.7706| Local H loss: 0.0494  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2764 |Global loss: 1.9286| Local H loss: 0.0922  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2478 |Global loss: 1.4386| Local H loss: 0.066  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2356 |Global loss: 1.1429| Local H loss: 0.0622  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2259 |Global loss: 0.9602| Local H loss: 0.0603  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2751 |Global loss: 2.3481| Local H loss: 0.0932  | Global H loss: 0.0596 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 1.5219| Local H loss: 0.0709  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2276 |Global loss: 1.111| Local H loss: 0.0654  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2244 |Global loss: 0.9859| Local H loss: 0.0635  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2892 |Global loss: 1.8537| Local H loss: 0.0979  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.234 |Global loss: 1.0679| Local H loss: 0.0616  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2453 |Global loss: 1.0291| Local H loss: 0.0602  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2615 |Global loss: 0.8665| Local H loss: 0.062  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2805 |Global loss: 1.8929| Local H loss: 0.0953  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2374 |Global loss: 1.1203| Local H loss: 0.0573  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2275 |Global loss: 1.0619| Local H loss: 0.0574  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2258 |Global loss: 0.9331| Local H loss: 0.0567  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2782 |Global loss: 1.8186| Local H loss: 0.0963  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2324 |Global loss: 1.3272| Local H loss: 0.0608  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.211 |Global loss: 0.8449| Local H loss: 0.0516  | Global H loss: 0.0421 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2079 |Global loss: 0.7361| Local H loss: 0.0506  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.6704| Local H loss: 0.0895  | Global H loss: 0.0537 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2192 |Global loss: 0.8692| Local H loss: 0.0564  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.224 |Global loss: 0.8987| Local H loss: 0.054  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2112 |Global loss: 0.7427| Local H loss: 0.0498  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2754 |Global loss: 1.9251| Local H loss: 0.1036  | Global H loss: 0.0605 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2313 |Global loss: 1.0931| Local H loss: 0.0624  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2177 |Global loss: 0.8644| Local H loss: 0.0538  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2151 |Global loss: 0.8154| Local H loss: 0.0572  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2751 |Global loss: 1.7673| Local H loss: 0.0971  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2369 |Global loss: 1.166| Local H loss: 0.0668  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.229 |Global loss: 1.0024| Local H loss: 0.06  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2213 |Global loss: 0.9801| Local H loss: 0.0582  | Global H loss: 0.0438 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.274 |Global loss: 1.7422| Local H loss: 0.0986  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2232 |Global loss: 0.9191| Local H loss: 0.0588  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2133 |Global loss: 0.8113| Local H loss: 0.0551  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2153 |Global loss: 0.7625| Local H loss: 0.0542  | Global H loss: 0.039 [0m
------------------------- time cost ------------------------- 6.359759569168091
Chosen Clients:  [4, 28, 2, 15, 9, 19, 6, 7, 29, 3, 21, 24]

-------------Round number: 92-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.965, 0.975, 0.947, 0.951, 0.87, 0.845, 0.792, 0.811, 0.937, 0.912, 0.915, 0.988, 0.976, 0.946, 0.924, 0.967, 0.944, 0.944, 0.922, 0.975, 0.935, 0.927, 1.0, 0.969, 0.979, 0.823, 0.988, 0.948]
AUC in each clients:  [86.807, 75.504, 85.799, 79.794, 75.78, 81.67, 76.49, 70.36, 70.962, 73.394, 78.847, 79.253, 81.694, 80.993, 81.868, 91.777, 91.792, 90.925, 89.701, 88.719, 101.535, 80.92, 92.629, 95.417, 102.97, 97.93, 93.926, 94.693, 85.859, 95.848]
F1 Score:  [0.939, 0.873, 0.967, 0.973, 0.941, 0.942, 0.851, 0.852, 0.734, 0.798, 0.938, 0.904, 0.908, 0.981, 0.973, 0.94, 0.914, 0.961, 0.912, 0.938, 0.89, 0.976, 0.917, 0.922, 1.0, 0.958, 0.973, 0.806, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.969, 0.973, 0.941, 0.94, 0.852, 0.859, 0.808, 0.802, 0.939, 0.905, 0.906, 0.981, 0.974, 0.943, 0.918, 0.96, 0.913, 0.939, 0.897, 0.976, 0.917, 0.942, 1.0, 0.957, 0.968, 0.826, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4912
Averaged Test Accurancy: 0.9319
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9201
Averaged Test Recal score: 0.9249
Std Test Accurancy: 0.0536
Std Test AUC: 0.0036
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2776 |Global loss: 1.8914| Local H loss: 0.0947  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2409 |Global loss: 1.1672| Local H loss: 0.0659  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2359 |Global loss: 1.0527| Local H loss: 0.0607  | Global H loss: 0.0456 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2348 |Global loss: 0.9593| Local H loss: 0.0597  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2806 |Global loss: 1.8305| Local H loss: 0.0997  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2219 |Global loss: 0.9588| Local H loss: 0.0603  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2123 |Global loss: 0.7623| Local H loss: 0.0531  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2076 |Global loss: 0.6559| Local H loss: 0.055  | Global H loss: 0.0362 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2846 |Global loss: 2.0513| Local H loss: 0.1045  | Global H loss: 0.06 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.245 |Global loss: 1.3097| Local H loss: 0.0719  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 0.9644| Local H loss: 0.0629  | Global H loss: 0.0451 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2197 |Global loss: 0.8359| Local H loss: 0.0597  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3053 |Global loss: 1.815| Local H loss: 0.0908  | Global H loss: 0.0546 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2774 |Global loss: 1.1033| Local H loss: 0.0591  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2805 |Global loss: 1.0334| Local H loss: 0.0545  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2657 |Global loss: 0.8505| Local H loss: 0.0557  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3336 |Global loss: 2.0254| Local H loss: 0.0862  | Global H loss: 0.0544 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3226 |Global loss: 1.6907| Local H loss: 0.071  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3148 |Global loss: 1.2052| Local H loss: 0.0617  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2999 |Global loss: 1.0965| Local H loss: 0.0559  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2704 |Global loss: 1.641| Local H loss: 0.0964  | Global H loss: 0.0536 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2221 |Global loss: 0.8953| Local H loss: 0.0549  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2199 |Global loss: 0.9151| Local H loss: 0.0536  | Global H loss: 0.0412 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2151 |Global loss: 0.7698| Local H loss: 0.0522  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2858 |Global loss: 1.8445| Local H loss: 0.0964  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2353 |Global loss: 1.0012| Local H loss: 0.0654  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2332 |Global loss: 1.0409| Local H loss: 0.0644  | Global H loss: 0.0453 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2197 |Global loss: 0.8345| Local H loss: 0.0563  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2792 |Global loss: 1.9539| Local H loss: 0.1012  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.227 |Global loss: 1.1198| Local H loss: 0.0642  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2216 |Global loss: 0.8556| Local H loss: 0.0559  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2145 |Global loss: 0.7608| Local H loss: 0.0585  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2642 |Global loss: 1.7795| Local H loss: 0.0938  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2323 |Global loss: 1.1624| Local H loss: 0.0646  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2225 |Global loss: 0.9287| Local H loss: 0.0637  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2255 |Global loss: 0.9244| Local H loss: 0.0585  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2886 |Global loss: 1.8212| Local H loss: 0.094  | Global H loss: 0.0552 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2549 |Global loss: 1.3385| Local H loss: 0.0689  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2393 |Global loss: 1.2376| Local H loss: 0.062  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2313 |Global loss: 1.0147| Local H loss: 0.0572  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 1.8092| Local H loss: 0.0963  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2179 |Global loss: 0.9681| Local H loss: 0.0584  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2273 |Global loss: 0.7439| Local H loss: 0.0582  | Global H loss: 0.0399 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1972 |Global loss: 0.6049| Local H loss: 0.05  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2673 |Global loss: 1.8712| Local H loss: 0.0919  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2393 |Global loss: 1.3623| Local H loss: 0.0689  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2309 |Global loss: 1.0378| Local H loss: 0.0629  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2278 |Global loss: 0.9532| Local H loss: 0.0586  | Global H loss: 0.0423 [0m
------------------------- time cost ------------------------- 6.648495197296143
Chosen Clients:  [6, 5, 13, 18, 3, 27, 8, 22, 0, 25, 11, 16]

-------------Round number: 93-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.947, 0.951, 0.87, 0.845, 0.792, 0.838, 0.937, 0.912, 0.915, 0.988, 0.976, 0.967, 0.924, 0.967, 0.944, 0.944, 0.922, 0.938, 0.935, 0.927, 1.0, 0.969, 0.979, 0.823, 0.988, 0.948]
AUC in each clients:  [86.807, 75.504, 85.741, 79.803, 75.746, 81.67, 76.512, 70.219, 70.962, 73.22, 78.847, 79.253, 81.694, 80.993, 81.868, 91.762, 91.792, 90.925, 89.701, 88.73, 101.535, 80.871, 92.629, 95.417, 102.971, 97.93, 93.926, 94.693, 85.874, 95.865]
F1 Score:  [0.939, 0.873, 0.977, 0.973, 0.941, 0.942, 0.845, 0.852, 0.734, 0.826, 0.938, 0.904, 0.908, 0.981, 0.973, 0.969, 0.914, 0.961, 0.912, 0.938, 0.89, 0.918, 0.917, 0.922, 1.0, 0.958, 0.973, 0.806, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.98, 0.973, 0.941, 0.94, 0.846, 0.863, 0.808, 0.832, 0.939, 0.905, 0.906, 0.981, 0.974, 0.97, 0.918, 0.96, 0.913, 0.939, 0.897, 0.944, 0.917, 0.942, 1.0, 0.957, 0.968, 0.826, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4855
Averaged Test Accurancy: 0.9327
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9202
Averaged Test Recal score: 0.9260
Std Test Accurancy: 0.0519
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2865 |Global loss: 1.9926| Local H loss: 0.1015  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2513 |Global loss: 1.3387| Local H loss: 0.0705  | Global H loss: 0.0509 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2358 |Global loss: 1.0343| Local H loss: 0.0618  | Global H loss: 0.0446 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2219 |Global loss: 0.8369| Local H loss: 0.061  | Global H loss: 0.0419 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2853 |Global loss: 1.8926| Local H loss: 0.1002  | Global H loss: 0.0576 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2419 |Global loss: 1.0702| Local H loss: 0.0693  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2218 |Global loss: 0.8561| Local H loss: 0.0568  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2205 |Global loss: 0.8006| Local H loss: 0.0551  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2815 |Global loss: 1.9147| Local H loss: 0.0952  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2406 |Global loss: 1.0988| Local H loss: 0.0669  | Global H loss: 0.0481 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2337 |Global loss: 0.9846| Local H loss: 0.0628  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2273 |Global loss: 0.861| Local H loss: 0.0553  | Global H loss: 0.0402 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2735 |Global loss: 1.6667| Local H loss: 0.1012  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2196 |Global loss: 0.7099| Local H loss: 0.066  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2148 |Global loss: 0.6694| Local H loss: 0.0526  | Global H loss: 0.0356 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2084 |Global loss: 0.5504| Local H loss: 0.0459  | Global H loss: 0.0307 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2831 |Global loss: 1.9483| Local H loss: 0.0948  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2394 |Global loss: 1.2206| Local H loss: 0.0656  | Global H loss: 0.0499 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2433 |Global loss: 1.1904| Local H loss: 0.0621  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.227 |Global loss: 0.9505| Local H loss: 0.06  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3975 |Global loss: 1.8822| Local H loss: 0.0953  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.344 |Global loss: 1.383| Local H loss: 0.0732  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3308 |Global loss: 1.1237| Local H loss: 0.0609  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3252 |Global loss: 0.9265| Local H loss: 0.0529  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4138 |Global loss: 2.0033| Local H loss: 0.0909  | Global H loss: 0.0522 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3718 |Global loss: 1.3114| Local H loss: 0.0628  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3402 |Global loss: 1.0104| Local H loss: 0.0545  | Global H loss: 0.0355 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3648 |Global loss: 0.9969| Local H loss: 0.0505  | Global H loss: 0.0321 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2812 |Global loss: 1.8899| Local H loss: 0.1008  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2422 |Global loss: 1.3611| Local H loss: 0.0677  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2349 |Global loss: 1.1744| Local H loss: 0.062  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2336 |Global loss: 1.0455| Local H loss: 0.0584  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2677 |Global loss: 1.8105| Local H loss: 0.0933  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2311 |Global loss: 1.0646| Local H loss: 0.0634  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2209 |Global loss: 0.8024| Local H loss: 0.0578  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2185 |Global loss: 0.8221| Local H loss: 0.0577  | Global H loss: 0.041 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2684 |Global loss: 1.8633| Local H loss: 0.0936  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.1979| Local H loss: 0.0666  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2246 |Global loss: 0.9921| Local H loss: 0.0562  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2162 |Global loss: 0.9024| Local H loss: 0.0543  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2799 |Global loss: 1.9206| Local H loss: 0.0943  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2383 |Global loss: 1.1427| Local H loss: 0.0659  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2284 |Global loss: 1.0611| Local H loss: 0.0618  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2178 |Global loss: 0.8023| Local H loss: 0.0566  | Global H loss: 0.0398 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2724 |Global loss: 1.807| Local H loss: 0.0888  | Global H loss: 0.0557 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2348 |Global loss: 1.3474| Local H loss: 0.0668  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2295 |Global loss: 1.2207| Local H loss: 0.0621  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2193 |Global loss: 0.8876| Local H loss: 0.0595  | Global H loss: 0.0425 [0m
------------------------- time cost ------------------------- 6.301179885864258
Chosen Clients:  [27, 26, 10, 18, 24, 0, 21, 16, 13, 19, 8, 9]

-------------Round number: 94-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.963, 0.947, 0.951, 0.883, 0.845, 0.847, 0.838, 0.937, 0.887, 0.915, 0.975, 0.976, 0.967, 0.935, 0.967, 0.933, 0.944, 0.922, 0.938, 0.946, 0.927, 1.0, 0.969, 0.979, 0.823, 0.988, 0.948]
AUC in each clients:  [86.792, 75.504, 85.741, 79.77, 75.746, 81.666, 76.481, 70.219, 71.131, 73.22, 78.847, 79.192, 81.694, 80.971, 81.868, 91.762, 91.787, 90.925, 89.724, 88.73, 101.535, 80.871, 92.645, 95.417, 102.971, 97.928, 93.926, 94.705, 85.874, 95.865]
F1 Score:  [0.939, 0.873, 0.977, 0.96, 0.941, 0.941, 0.867, 0.852, 0.824, 0.826, 0.938, 0.872, 0.908, 0.972, 0.973, 0.969, 0.929, 0.961, 0.894, 0.938, 0.89, 0.918, 0.931, 0.922, 1.0, 0.958, 0.973, 0.811, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.98, 0.962, 0.941, 0.94, 0.866, 0.863, 0.84, 0.832, 0.939, 0.879, 0.906, 0.972, 0.974, 0.97, 0.932, 0.96, 0.896, 0.939, 0.897, 0.944, 0.931, 0.942, 1.0, 0.957, 0.968, 0.82, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4697
Averaged Test Accurancy: 0.9334
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9226
Averaged Test Recal score: 0.9264
Std Test Accurancy: 0.0470
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3642 |Global loss: 2.1722| Local H loss: 0.084  | Global H loss: 0.0532 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3322 |Global loss: 1.4228| Local H loss: 0.0634  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3211 |Global loss: 1.0794| Local H loss: 0.0552  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.305 |Global loss: 0.8854| Local H loss: 0.0528  | Global H loss: 0.0325 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2779 |Global loss: 1.8131| Local H loss: 0.0974  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2176 |Global loss: 0.893| Local H loss: 0.057  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.21 |Global loss: 0.7253| Local H loss: 0.0519  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2018 |Global loss: 0.6379| Local H loss: 0.0485  | Global H loss: 0.0339 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.921| Local H loss: 0.0968  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2253 |Global loss: 1.0427| Local H loss: 0.0666  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2165 |Global loss: 0.8445| Local H loss: 0.0549  | Global H loss: 0.0409 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2178 |Global loss: 0.8527| Local H loss: 0.0557  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2701 |Global loss: 1.6463| Local H loss: 0.097  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2257 |Global loss: 0.8186| Local H loss: 0.0568  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2126 |Global loss: 0.6802| Local H loss: 0.052  | Global H loss: 0.0358 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1972 |Global loss: 0.538| Local H loss: 0.0454  | Global H loss: 0.0307 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2641 |Global loss: 1.7667| Local H loss: 0.0873  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2338 |Global loss: 1.2164| Local H loss: 0.0655  | Global H loss: 0.0498 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.232 |Global loss: 1.0544| Local H loss: 0.0644  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2281 |Global loss: 0.8635| Local H loss: 0.0624  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2737 |Global loss: 1.9257| Local H loss: 0.097  | Global H loss: 0.0594 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2288 |Global loss: 1.0883| Local H loss: 0.0635  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2209 |Global loss: 0.8562| Local H loss: 0.0631  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2113 |Global loss: 0.7542| Local H loss: 0.0536  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2736 |Global loss: 1.8017| Local H loss: 0.1008  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2315 |Global loss: 0.8815| Local H loss: 0.0654  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2159 |Global loss: 0.8196| Local H loss: 0.0582  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2047 |Global loss: 0.6786| Local H loss: 0.0545  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2762 |Global loss: 1.799| Local H loss: 0.094  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2318 |Global loss: 1.1207| Local H loss: 0.0598  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2233 |Global loss: 0.8787| Local H loss: 0.0629  | Global H loss: 0.0445 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2244 |Global loss: 0.806| Local H loss: 0.06  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2862 |Global loss: 1.888| Local H loss: 0.0962  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2422 |Global loss: 1.2668| Local H loss: 0.066  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2396 |Global loss: 1.0195| Local H loss: 0.0606  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2347 |Global loss: 0.9239| Local H loss: 0.0614  | Global H loss: 0.0423 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2718 |Global loss: 1.7827| Local H loss: 0.0962  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2194 |Global loss: 0.9659| Local H loss: 0.0561  | Global H loss: 0.0443 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2104 |Global loss: 0.8147| Local H loss: 0.0514  | Global H loss: 0.0388 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2204 |Global loss: 0.8755| Local H loss: 0.0523  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4251 |Global loss: 2.0074| Local H loss: 0.0873  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3709 |Global loss: 1.4361| Local H loss: 0.0635  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3628 |Global loss: 1.0993| Local H loss: 0.0586  | Global H loss: 0.0384 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3392 |Global loss: 0.9876| Local H loss: 0.0562  | Global H loss: 0.034 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3443 |Global loss: 2.0032| Local H loss: 0.0891  | Global H loss: 0.0545 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3158 |Global loss: 1.7794| Local H loss: 0.0696  | Global H loss: 0.053 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3118 |Global loss: 1.4235| Local H loss: 0.0693  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3138 |Global loss: 1.2172| Local H loss: 0.0653  | Global H loss: 0.0455 [0m
------------------------- time cost ------------------------- 5.8624444007873535
Chosen Clients:  [29, 21, 18, 25, 8, 9, 16, 24, 6, 23, 27, 7]

-------------Round number: 95-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.963, 0.947, 0.951, 0.883, 0.845, 0.847, 0.797, 0.937, 0.887, 0.915, 0.988, 0.976, 0.967, 0.935, 0.967, 0.944, 0.944, 0.922, 0.951, 0.946, 0.927, 0.981, 0.969, 0.936, 0.812, 0.988, 0.948]
AUC in each clients:  [86.814, 75.504, 85.741, 79.77, 75.746, 81.666, 76.481, 70.219, 71.076, 73.338, 78.843, 79.192, 81.694, 80.994, 81.868, 91.762, 91.781, 90.925, 89.678, 88.726, 101.535, 80.852, 92.645, 95.417, 102.957, 97.928, 93.886, 94.67, 85.874, 95.865]
F1 Score:  [0.939, 0.873, 0.977, 0.96, 0.941, 0.941, 0.867, 0.852, 0.824, 0.78, 0.938, 0.872, 0.908, 0.981, 0.973, 0.969, 0.929, 0.961, 0.912, 0.938, 0.89, 0.931, 0.931, 0.922, 0.975, 0.958, 0.911, 0.794, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.98, 0.962, 0.941, 0.94, 0.866, 0.863, 0.84, 0.788, 0.939, 0.879, 0.906, 0.981, 0.974, 0.97, 0.932, 0.96, 0.913, 0.938, 0.897, 0.955, 0.931, 0.942, 0.972, 0.957, 0.903, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4566
Averaged Test Accurancy: 0.9307
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9190
Averaged Test Recal score: 0.9229
Std Test Accurancy: 0.0500
Std Test AUC: 0.0036
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2644 |Global loss: 1.9569| Local H loss: 0.0895  | Global H loss: 0.0588 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2353 |Global loss: 1.3244| Local H loss: 0.0666  | Global H loss: 0.0523 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2229 |Global loss: 1.0541| Local H loss: 0.0624  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2181 |Global loss: 0.9422| Local H loss: 0.0589  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2757 |Global loss: 1.8212| Local H loss: 0.0999  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2195 |Global loss: 0.9516| Local H loss: 0.0628  | Global H loss: 0.0472 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2068 |Global loss: 0.7717| Local H loss: 0.0554  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2179 |Global loss: 0.8606| Local H loss: 0.0511  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.6487| Local H loss: 0.1069  | Global H loss: 0.0558 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2165 |Global loss: 0.7956| Local H loss: 0.0604  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2023 |Global loss: 0.5436| Local H loss: 0.0457  | Global H loss: 0.0308 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1924 |Global loss: 0.4778| Local H loss: 0.044  | Global H loss: 0.029 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2739 |Global loss: 1.7292| Local H loss: 0.0913  | Global H loss: 0.056 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2306 |Global loss: 1.0566| Local H loss: 0.0575  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2205 |Global loss: 0.8592| Local H loss: 0.0503  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2129 |Global loss: 0.7342| Local H loss: 0.0514  | Global H loss: 0.0374 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4026 |Global loss: 1.924| Local H loss: 0.09  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3806 |Global loss: 1.6656| Local H loss: 0.0674  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3757 |Global loss: 1.3409| Local H loss: 0.0586  | Global H loss: 0.0411 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3592 |Global loss: 1.1089| Local H loss: 0.0572  | Global H loss: 0.0379 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3429 |Global loss: 2.006| Local H loss: 0.0862  | Global H loss: 0.0535 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3089 |Global loss: 1.7889| Local H loss: 0.0693  | Global H loss: 0.0519 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3097 |Global loss: 1.4974| Local H loss: 0.0666  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3043 |Global loss: 1.1121| Local H loss: 0.0628  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2734 |Global loss: 1.9064| Local H loss: 0.0969  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2332 |Global loss: 1.1493| Local H loss: 0.0625  | Global H loss: 0.0486 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2197 |Global loss: 0.8942| Local H loss: 0.0614  | Global H loss: 0.0442 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2236 |Global loss: 0.8966| Local H loss: 0.0552  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2675 |Global loss: 1.869| Local H loss: 0.0944  | Global H loss: 0.0586 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2343 |Global loss: 1.1996| Local H loss: 0.0651  | Global H loss: 0.0495 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2306 |Global loss: 1.0735| Local H loss: 0.0637  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2233 |Global loss: 0.9407| Local H loss: 0.0597  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2774 |Global loss: 1.8336| Local H loss: 0.0952  | Global H loss: 0.0562 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2417 |Global loss: 1.3015| Local H loss: 0.0637  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2287 |Global loss: 0.9703| Local H loss: 0.061  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2239 |Global loss: 0.8327| Local H loss: 0.0588  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2666 |Global loss: 1.6484| Local H loss: 0.0995  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2235 |Global loss: 0.9269| Local H loss: 0.0588  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2097 |Global loss: 0.8334| Local H loss: 0.0536  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2037 |Global loss: 0.6893| Local H loss: 0.0491  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3661 |Global loss: 1.9052| Local H loss: 0.0874  | Global H loss: 0.0513 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.331 |Global loss: 1.21| Local H loss: 0.0659  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3132 |Global loss: 1.0717| Local H loss: 0.0557  | Global H loss: 0.0376 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3347 |Global loss: 1.07| Local H loss: 0.057  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2798 |Global loss: 1.9556| Local H loss: 0.0985  | Global H loss: 0.0585 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.237 |Global loss: 1.2177| Local H loss: 0.0606  | Global H loss: 0.049 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2173 |Global loss: 0.909| Local H loss: 0.0571  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2125 |Global loss: 0.7087| Local H loss: 0.0516  | Global H loss: 0.0384 [0m
------------------------- time cost ------------------------- 6.712582111358643
Chosen Clients:  [13, 24, 27, 1, 28, 29, 3, 23, 26, 19, 10, 6]

-------------Round number: 96-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.963, 0.947, 0.951, 0.883, 0.817, 0.847, 0.824, 0.937, 0.887, 0.915, 0.988, 0.976, 0.967, 0.924, 0.967, 0.933, 0.944, 0.922, 0.975, 0.946, 0.927, 1.0, 0.98, 0.936, 0.792, 0.988, 0.948]
AUC in each clients:  [86.814, 75.504, 85.741, 79.77, 75.746, 81.666, 76.506, 70.211, 71.059, 73.387, 78.843, 79.192, 81.694, 80.994, 81.868, 91.762, 91.757, 90.925, 89.735, 88.726, 101.535, 80.928, 92.645, 95.388, 102.971, 97.929, 93.886, 94.639, 85.874, 95.854]
F1 Score:  [0.939, 0.873, 0.977, 0.96, 0.941, 0.941, 0.867, 0.815, 0.82, 0.812, 0.938, 0.872, 0.908, 0.981, 0.973, 0.969, 0.914, 0.961, 0.894, 0.938, 0.89, 0.976, 0.931, 0.92, 1.0, 0.972, 0.911, 0.766, 0.989, 0.933]
Recall Score:  [0.928, 0.886, 0.98, 0.962, 0.941, 0.94, 0.866, 0.837, 0.844, 0.818, 0.939, 0.879, 0.906, 0.981, 0.974, 0.97, 0.918, 0.96, 0.896, 0.938, 0.897, 0.976, 0.931, 0.942, 1.0, 0.972, 0.903, 0.797, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4598
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9194
Averaged Test Recal score: 0.9236
Std Test Accurancy: 0.0529
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2775 |Global loss: 1.9313| Local H loss: 0.0946  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2458 |Global loss: 1.2078| Local H loss: 0.0675  | Global H loss: 0.0487 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2328 |Global loss: 0.9789| Local H loss: 0.0656  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2285 |Global loss: 0.9293| Local H loss: 0.0594  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2699 |Global loss: 1.8418| Local H loss: 0.0876  | Global H loss: 0.0566 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2362 |Global loss: 1.3203| Local H loss: 0.0651  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2262 |Global loss: 1.0511| Local H loss: 0.062  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2303 |Global loss: 0.9799| Local H loss: 0.0581  | Global H loss: 0.0427 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3751 |Global loss: 1.8845| Local H loss: 0.0872  | Global H loss: 0.0512 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3463 |Global loss: 1.3483| Local H loss: 0.0694  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3129 |Global loss: 1.0781| Local H loss: 0.0592  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3002 |Global loss: 0.8676| Local H loss: 0.051  | Global H loss: 0.0324 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.269 |Global loss: 1.766| Local H loss: 0.0922  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2329 |Global loss: 1.0672| Local H loss: 0.0675  | Global H loss: 0.0485 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2242 |Global loss: 1.029| Local H loss: 0.0583  | Global H loss: 0.0467 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2199 |Global loss: 0.8984| Local H loss: 0.0558  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2666 |Global loss: 1.7127| Local H loss: 0.0954  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2225 |Global loss: 0.9651| Local H loss: 0.0607  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2176 |Global loss: 0.7849| Local H loss: 0.0571  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2037 |Global loss: 0.6412| Local H loss: 0.052  | Global H loss: 0.0359 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2627 |Global loss: 1.8059| Local H loss: 0.0898  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2277 |Global loss: 1.0563| Local H loss: 0.0652  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2247 |Global loss: 0.912| Local H loss: 0.0622  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2228 |Global loss: 0.7978| Local H loss: 0.0592  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.9944| Local H loss: 0.092  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2529 |Global loss: 1.4055| Local H loss: 0.0676  | Global H loss: 0.0521 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2346 |Global loss: 1.1264| Local H loss: 0.062  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2313 |Global loss: 1.0406| Local H loss: 0.0605  | Global H loss: 0.0458 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2791 |Global loss: 1.8343| Local H loss: 0.0997  | Global H loss: 0.0577 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2208 |Global loss: 0.9312| Local H loss: 0.0566  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2139 |Global loss: 0.7842| Local H loss: 0.0537  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2092 |Global loss: 0.7402| Local H loss: 0.0531  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2685 |Global loss: 1.688| Local H loss: 0.0971  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2215 |Global loss: 1.0914| Local H loss: 0.0575  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2144 |Global loss: 0.8599| Local H loss: 0.0569  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2056 |Global loss: 0.6902| Local H loss: 0.0486  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2745 |Global loss: 1.8451| Local H loss: 0.101  | Global H loss: 0.0589 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2374 |Global loss: 1.0919| Local H loss: 0.0652  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.9419| Local H loss: 0.06  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2231 |Global loss: 0.9261| Local H loss: 0.0589  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2702 |Global loss: 1.9073| Local H loss: 0.0974  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2248 |Global loss: 0.9783| Local H loss: 0.0635  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2169 |Global loss: 0.8564| Local H loss: 0.0553  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2132 |Global loss: 0.8515| Local H loss: 0.0561  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2834 |Global loss: 2.1138| Local H loss: 0.0952  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2396 |Global loss: 1.2709| Local H loss: 0.0655  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2406 |Global loss: 1.1336| Local H loss: 0.0674  | Global H loss: 0.0474 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2231 |Global loss: 0.8699| Local H loss: 0.0608  | Global H loss: 0.0425 [0m
------------------------- time cost ------------------------- 6.211841344833374
Chosen Clients:  [25, 4, 8, 14, 16, 22, 15, 21, 13, 1, 26, 5]

-------------Round number: 97-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.842, 0.977, 0.975, 0.947, 0.951, 0.883, 0.817, 0.847, 0.824, 0.937, 0.887, 0.915, 0.988, 0.976, 0.967, 0.924, 0.967, 0.933, 0.944, 0.922, 0.975, 0.946, 0.927, 0.981, 0.98, 0.989, 0.812, 0.977, 0.958]
AUC in each clients:  [86.814, 75.464, 85.741, 79.817, 75.746, 81.666, 76.532, 70.211, 71.059, 73.387, 78.849, 79.192, 81.694, 80.987, 81.868, 91.762, 91.757, 90.925, 89.735, 88.743, 101.535, 80.928, 92.645, 95.236, 102.971, 97.929, 93.929, 94.746, 85.881, 95.822]
F1 Score:  [0.939, 0.844, 0.977, 0.973, 0.941, 0.941, 0.868, 0.815, 0.82, 0.812, 0.938, 0.872, 0.908, 0.981, 0.973, 0.969, 0.914, 0.961, 0.894, 0.938, 0.89, 0.976, 0.931, 0.92, 0.973, 0.972, 0.984, 0.793, 0.979, 0.947]
Recall Score:  [0.928, 0.866, 0.98, 0.976, 0.941, 0.94, 0.869, 0.837, 0.844, 0.818, 0.939, 0.879, 0.906, 0.981, 0.974, 0.97, 0.918, 0.96, 0.896, 0.939, 0.897, 0.976, 0.931, 0.942, 0.972, 0.972, 0.981, 0.817, 0.981, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.4368
Averaged Test Accurancy: 0.9327
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9214
Averaged Test Recal score: 0.9260
Std Test Accurancy: 0.0529
Std Test AUC: 0.0037
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2628 |Global loss: 1.7395| Local H loss: 0.0924  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2199 |Global loss: 0.9314| Local H loss: 0.0569  | Global H loss: 0.0433 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2133 |Global loss: 0.8518| Local H loss: 0.0523  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2131 |Global loss: 0.7567| Local H loss: 0.0497  | Global H loss: 0.0373 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2749 |Global loss: 1.886| Local H loss: 0.0923  | Global H loss: 0.0568 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2495 |Global loss: 1.0793| Local H loss: 0.0654  | Global H loss: 0.0477 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.25 |Global loss: 0.8994| Local H loss: 0.0561  | Global H loss: 0.0404 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2254 |Global loss: 0.8336| Local H loss: 0.0567  | Global H loss: 0.0405 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3874 |Global loss: 1.9768| Local H loss: 0.0893  | Global H loss: 0.0525 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3628 |Global loss: 1.4461| Local H loss: 0.0596  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.343 |Global loss: 1.1509| Local H loss: 0.0505  | Global H loss: 0.0353 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3433 |Global loss: 0.9796| Local H loss: 0.0524  | Global H loss: 0.0342 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2809 |Global loss: 1.9148| Local H loss: 0.0972  | Global H loss: 0.0581 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.233 |Global loss: 1.1487| Local H loss: 0.0607  | Global H loss: 0.048 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2272 |Global loss: 0.8845| Local H loss: 0.062  | Global H loss: 0.0437 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2156 |Global loss: 0.8131| Local H loss: 0.0541  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2712 |Global loss: 1.8564| Local H loss: 0.0981  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2426 |Global loss: 1.2961| Local H loss: 0.068  | Global H loss: 0.0514 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2319 |Global loss: 1.0589| Local H loss: 0.0641  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2187 |Global loss: 0.9531| Local H loss: 0.0592  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2675 |Global loss: 1.706| Local H loss: 0.0936  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2294 |Global loss: 1.13| Local H loss: 0.061  | Global H loss: 0.0484 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2299 |Global loss: 1.0981| Local H loss: 0.0556  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2174 |Global loss: 0.9075| Local H loss: 0.0568  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3069 |Global loss: 1.8726| Local H loss: 0.0918  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2763 |Global loss: 1.7555| Local H loss: 0.065  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2615 |Global loss: 1.0971| Local H loss: 0.0585  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2523 |Global loss: 0.8716| Local H loss: 0.0539  | Global H loss: 0.0381 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2682 |Global loss: 1.7047| Local H loss: 0.0979  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2184 |Global loss: 0.8758| Local H loss: 0.0576  | Global H loss: 0.0432 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2035 |Global loss: 0.668| Local H loss: 0.0529  | Global H loss: 0.0378 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2116 |Global loss: 0.7428| Local H loss: 0.0547  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2711 |Global loss: 1.8506| Local H loss: 0.0921  | Global H loss: 0.0571 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2398 |Global loss: 1.2225| Local H loss: 0.0639  | Global H loss: 0.0492 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2315 |Global loss: 0.9838| Local H loss: 0.0619  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.226 |Global loss: 0.8659| Local H loss: 0.0607  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2691 |Global loss: 1.7933| Local H loss: 0.0942  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2376 |Global loss: 1.3062| Local H loss: 0.0654  | Global H loss: 0.051 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2318 |Global loss: 1.1407| Local H loss: 0.0653  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2147 |Global loss: 0.8208| Local H loss: 0.0581  | Global H loss: 0.0414 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.269 |Global loss: 1.6722| Local H loss: 0.0964  | Global H loss: 0.0553 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 1.1109| Local H loss: 0.0587  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2143 |Global loss: 0.8463| Local H loss: 0.0585  | Global H loss: 0.0426 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2086 |Global loss: 0.744| Local H loss: 0.0504  | Global H loss: 0.0371 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2867 |Global loss: 1.9017| Local H loss: 0.0982  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2367 |Global loss: 1.0922| Local H loss: 0.0616  | Global H loss: 0.0463 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2283 |Global loss: 0.9191| Local H loss: 0.0576  | Global H loss: 0.042 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2185 |Global loss: 0.8003| Local H loss: 0.053  | Global H loss: 0.0382 [0m
------------------------- time cost ------------------------- 6.162126541137695
Chosen Clients:  [16, 7, 29, 13, 28, 22, 6, 15, 12, 4, 10, 17]

-------------Round number: 98-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.974, 0.963, 0.883, 0.817, 0.778, 0.824, 0.937, 0.887, 0.915, 0.988, 0.976, 0.957, 0.935, 0.967, 0.933, 0.944, 0.922, 0.963, 0.935, 0.927, 0.981, 0.969, 0.989, 0.812, 0.977, 0.958]
AUC in each clients:  [86.814, 75.471, 85.741, 79.817, 75.805, 81.696, 76.532, 70.211, 70.923, 73.387, 78.849, 79.192, 81.694, 80.993, 81.876, 91.781, 91.798, 90.925, 89.735, 88.743, 101.535, 80.878, 92.699, 95.236, 102.971, 97.926, 93.924, 94.746, 85.881, 95.822]
F1 Score:  [0.939, 0.871, 0.977, 0.973, 0.971, 0.956, 0.868, 0.815, 0.722, 0.812, 0.938, 0.872, 0.908, 0.981, 0.973, 0.953, 0.929, 0.961, 0.894, 0.938, 0.89, 0.951, 0.916, 0.92, 0.973, 0.958, 0.984, 0.793, 0.979, 0.947]
Recall Score:  [0.928, 0.891, 0.98, 0.976, 0.974, 0.959, 0.869, 0.837, 0.78, 0.818, 0.939, 0.879, 0.906, 0.981, 0.974, 0.955, 0.932, 0.96, 0.896, 0.939, 0.897, 0.965, 0.917, 0.942, 0.972, 0.957, 0.981, 0.817, 0.981, 0.949]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.3968
Averaged Test Accurancy: 0.9315
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9187
Averaged Test Recal score: 0.9250
Std Test Accurancy: 0.0565
Std Test AUC: 0.0038
Std Test F1: 0.0010
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2766 |Global loss: 1.7845| Local H loss: 0.0884  | Global H loss: 0.0543 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2384 |Global loss: 1.2599| Local H loss: 0.0647  | Global H loss: 0.0506 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2214 |Global loss: 0.8984| Local H loss: 0.0584  | Global H loss: 0.0431 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2177 |Global loss: 0.7403| Local H loss: 0.0589  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2728 |Global loss: 1.8246| Local H loss: 0.0997  | Global H loss: 0.0565 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2249 |Global loss: 1.0693| Local H loss: 0.0632  | Global H loss: 0.0489 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2154 |Global loss: 0.8844| Local H loss: 0.0553  | Global H loss: 0.044 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2159 |Global loss: 0.7926| Local H loss: 0.054  | Global H loss: 0.04 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2654 |Global loss: 1.8623| Local H loss: 0.0897  | Global H loss: 0.0583 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2314 |Global loss: 1.192| Local H loss: 0.0654  | Global H loss: 0.0507 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2254 |Global loss: 0.9985| Local H loss: 0.0618  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2243 |Global loss: 0.8989| Local H loss: 0.0606  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2714 |Global loss: 1.867| Local H loss: 0.0912  | Global H loss: 0.058 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2362 |Global loss: 1.2207| Local H loss: 0.0667  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2384 |Global loss: 1.0222| Local H loss: 0.0594  | Global H loss: 0.0435 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2286 |Global loss: 0.9187| Local H loss: 0.0565  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2776 |Global loss: 1.9529| Local H loss: 0.0988  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2233 |Global loss: 0.9891| Local H loss: 0.0625  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2135 |Global loss: 0.8713| Local H loss: 0.0589  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2131 |Global loss: 0.756| Local H loss: 0.0552  | Global H loss: 0.039 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2736 |Global loss: 1.7954| Local H loss: 0.0947  | Global H loss: 0.0563 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2318 |Global loss: 1.162| Local H loss: 0.0595  | Global H loss: 0.0478 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2257 |Global loss: 1.007| Local H loss: 0.0586  | Global H loss: 0.0459 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2235 |Global loss: 0.8364| Local H loss: 0.0554  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2763 |Global loss: 1.77| Local H loss: 0.0931  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2449 |Global loss: 1.1319| Local H loss: 0.0637  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2328 |Global loss: 0.9177| Local H loss: 0.0616  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.228 |Global loss: 0.85| Local H loss: 0.0588  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3078 |Global loss: 1.7975| Local H loss: 0.0928  | Global H loss: 0.0551 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2759 |Global loss: 1.2845| Local H loss: 0.0637  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2557 |Global loss: 1.0522| Local H loss: 0.0564  | Global H loss: 0.0415 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2791 |Global loss: 0.8953| Local H loss: 0.0534  | Global H loss: 0.0363 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2726 |Global loss: 2.0015| Local H loss: 0.0937  | Global H loss: 0.0593 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.246 |Global loss: 1.3531| Local H loss: 0.0706  | Global H loss: 0.0517 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2328 |Global loss: 1.1017| Local H loss: 0.0631  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2291 |Global loss: 0.9288| Local H loss: 0.0597  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2783 |Global loss: 1.9384| Local H loss: 0.0941  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2383 |Global loss: 1.2582| Local H loss: 0.0615  | Global H loss: 0.0503 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2357 |Global loss: 1.071| Local H loss: 0.0618  | Global H loss: 0.0471 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2272 |Global loss: 1.0011| Local H loss: 0.0559  | Global H loss: 0.0429 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2845 |Global loss: 2.1488| Local H loss: 0.1019  | Global H loss: 0.0613 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2353 |Global loss: 1.2499| Local H loss: 0.069  | Global H loss: 0.0505 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2233 |Global loss: 1.0382| Local H loss: 0.0638  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2137 |Global loss: 0.7939| Local H loss: 0.0542  | Global H loss: 0.0386 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.9358| Local H loss: 0.0938  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 1.167| Local H loss: 0.0667  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2279 |Global loss: 1.1554| Local H loss: 0.0591  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2218 |Global loss: 0.9509| Local H loss: 0.0556  | Global H loss: 0.0429 [0m
------------------------- time cost ------------------------- 6.375813722610474
Chosen Clients:  [27, 15, 5, 11, 2, 0, 6, 17, 26, 3, 19, 22]

-------------Round number: 99-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.977, 0.975, 0.961, 0.963, 0.883, 0.845, 0.778, 0.824, 0.937, 0.887, 0.927, 0.988, 0.976, 0.913, 0.935, 0.978, 0.933, 0.944, 0.922, 0.963, 0.925, 0.927, 0.981, 0.969, 0.989, 0.812, 0.988, 0.948]
AUC in each clients:  [86.814, 75.471, 85.741, 79.817, 75.788, 81.696, 76.518, 70.319, 70.923, 73.387, 78.872, 79.192, 81.738, 80.996, 81.876, 91.676, 91.739, 90.94, 89.735, 88.743, 101.535, 80.878, 92.694, 95.236, 102.971, 97.926, 93.924, 94.746, 85.841, 95.86]
F1 Score:  [0.939, 0.871, 0.977, 0.973, 0.957, 0.956, 0.862, 0.852, 0.722, 0.812, 0.938, 0.872, 0.921, 0.981, 0.973, 0.914, 0.924, 0.974, 0.894, 0.938, 0.89, 0.951, 0.901, 0.92, 0.973, 0.958, 0.984, 0.793, 0.98, 0.933]
Recall Score:  [0.928, 0.891, 0.98, 0.976, 0.958, 0.959, 0.864, 0.859, 0.78, 0.818, 0.939, 0.879, 0.92, 0.981, 0.974, 0.918, 0.927, 0.974, 0.896, 0.939, 0.897, 0.965, 0.903, 0.942, 0.972, 0.957, 0.981, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.3850
Averaged Test Accurancy: 0.9307
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9178
Averaged Test Recal score: 0.9240
Std Test Accurancy: 0.0549
Std Test AUC: 0.0038
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3608 |Global loss: 1.871| Local H loss: 0.0843  | Global H loss: 0.0511 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3256 |Global loss: 1.1877| Local H loss: 0.0666  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3327 |Global loss: 0.9953| Local H loss: 0.0562  | Global H loss: 0.0361 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3073 |Global loss: 0.954| Local H loss: 0.0549  | Global H loss: 0.0346 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3462 |Global loss: 1.8458| Local H loss: 0.0904  | Global H loss: 0.0548 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.272 |Global loss: 1.1643| Local H loss: 0.0612  | Global H loss: 0.045 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2687 |Global loss: 1.036| Local H loss: 0.0549  | Global H loss: 0.0408 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2683 |Global loss: 0.9918| Local H loss: 0.0508  | Global H loss: 0.0377 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2837 |Global loss: 1.8691| Local H loss: 0.1053  | Global H loss: 0.0591 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 1.0647| Local H loss: 0.0617  | Global H loss: 0.0468 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2272 |Global loss: 0.9399| Local H loss: 0.0591  | Global H loss: 0.0425 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2136 |Global loss: 0.751| Local H loss: 0.0548  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2814 |Global loss: 2.0275| Local H loss: 0.1016  | Global H loss: 0.0606 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2418 |Global loss: 1.2185| Local H loss: 0.0634  | Global H loss: 0.0494 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2197 |Global loss: 0.9566| Local H loss: 0.0597  | Global H loss: 0.0461 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2257 |Global loss: 0.9006| Local H loss: 0.0579  | Global H loss: 0.0424 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.276 |Global loss: 1.7582| Local H loss: 0.0935  | Global H loss: 0.055 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2352 |Global loss: 1.0313| Local H loss: 0.0675  | Global H loss: 0.0482 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2281 |Global loss: 0.9978| Local H loss: 0.0614  | Global H loss: 0.0464 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2134 |Global loss: 0.7472| Local H loss: 0.0557  | Global H loss: 0.0397 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2688 |Global loss: 1.8134| Local H loss: 0.0915  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2335 |Global loss: 0.9884| Local H loss: 0.0692  | Global H loss: 0.047 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2187 |Global loss: 0.8336| Local H loss: 0.0575  | Global H loss: 0.0407 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2241 |Global loss: 0.8288| Local H loss: 0.058  | Global H loss: 0.0403 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2736 |Global loss: 1.8194| Local H loss: 0.0936  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2287 |Global loss: 1.0048| Local H loss: 0.0634  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.227 |Global loss: 0.9445| Local H loss: 0.0617  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2271 |Global loss: 0.8793| Local H loss: 0.0556  | Global H loss: 0.0396 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2684 |Global loss: 1.7792| Local H loss: 0.0934  | Global H loss: 0.0572 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2306 |Global loss: 1.0675| Local H loss: 0.0602  | Global H loss: 0.0469 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2191 |Global loss: 0.9273| Local H loss: 0.0544  | Global H loss: 0.0418 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.218 |Global loss: 0.8795| Local H loss: 0.0566  | Global H loss: 0.0406 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2746 |Global loss: 1.7443| Local H loss: 0.0986  | Global H loss: 0.0564 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.219 |Global loss: 1.019| Local H loss: 0.0583  | Global H loss: 0.0454 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2082 |Global loss: 0.7263| Local H loss: 0.0547  | Global H loss: 0.0382 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2219 |Global loss: 0.844| Local H loss: 0.0569  | Global H loss: 0.0413 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.275 |Global loss: 1.9621| Local H loss: 0.093  | Global H loss: 0.0582 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2476 |Global loss: 1.3241| Local H loss: 0.0639  | Global H loss: 0.05 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2395 |Global loss: 1.072| Local H loss: 0.0602  | Global H loss: 0.0447 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2378 |Global loss: 1.004| Local H loss: 0.0567  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.273 |Global loss: 1.8007| Local H loss: 0.0951  | Global H loss: 0.0567 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2347 |Global loss: 1.0515| Local H loss: 0.0633  | Global H loss: 0.0476 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2248 |Global loss: 0.8831| Local H loss: 0.058  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2226 |Global loss: 0.7176| Local H loss: 0.0591  | Global H loss: 0.0391 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2792 |Global loss: 1.9631| Local H loss: 0.0938  | Global H loss: 0.0575 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2285 |Global loss: 1.1952| Local H loss: 0.0637  | Global H loss: 0.0488 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2339 |Global loss: 0.9626| Local H loss: 0.0594  | Global H loss: 0.0417 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2206 |Global loss: 0.8684| Local H loss: 0.056  | Global H loss: 0.04 [0m
------------------------- time cost ------------------------- 6.262645721435547
Chosen Clients:  [5, 9, 2, 8, 25, 19, 0, 28, 24, 16, 13, 7]

-------------Round number: 100-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Accuracy in each clients:  [0.943, 0.868, 0.953, 0.975, 0.961, 0.963, 0.883, 0.845, 0.778, 0.824, 0.937, 0.912, 0.927, 0.988, 0.976, 0.913, 0.935, 0.978, 0.933, 0.944, 0.922, 0.963, 0.935, 0.927, 0.981, 0.969, 0.968, 0.812, 0.988, 0.948]
AUC in each clients:  [86.809, 75.471, 85.724, 79.855, 75.788, 81.691, 76.523, 70.319, 70.923, 73.387, 78.872, 79.18, 81.738, 80.996, 81.876, 91.664, 91.739, 90.933, 89.735, 88.726, 101.535, 80.878, 92.706, 95.236, 102.971, 97.926, 93.918, 94.694, 85.841, 95.86]
F1 Score:  [0.939, 0.871, 0.954, 0.973, 0.957, 0.956, 0.867, 0.852, 0.722, 0.812, 0.938, 0.904, 0.921, 0.981, 0.973, 0.914, 0.924, 0.974, 0.894, 0.938, 0.89, 0.951, 0.919, 0.92, 0.973, 0.958, 0.954, 0.793, 0.98, 0.933]
Recall Score:  [0.928, 0.891, 0.957, 0.973, 0.958, 0.959, 0.869, 0.859, 0.78, 0.818, 0.939, 0.905, 0.92, 0.981, 0.974, 0.918, 0.927, 0.974, 0.896, 0.939, 0.897, 0.965, 0.917, 0.942, 0.972, 0.957, 0.949, 0.817, 0.991, 0.936]
Number of sample in client:  [87, 76, 86, 80, 76, 82, 77, 71, 72, 74, 79, 80, 82, 81, 82, 92, 92, 91, 90, 89, 102, 81, 93, 96, 103, 98, 94, 96, 86, 96]
Averaged Train Loss: 9.3682
Averaged Test Accurancy: 0.9303
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9178
Averaged Test Recal score: 0.9236
Std Test Accurancy: 0.0533
Std Test AUC: 0.0038
Std Test F1: 0.0011
Std Test Recall: 0.0010
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2723 |Global loss: 1.8525| Local H loss: 0.0948  | Global H loss: 0.0573 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2341 |Global loss: 1.1374| Local H loss: 0.0676  | Global H loss: 0.0491 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2267 |Global loss: 0.8899| Local H loss: 0.0596  | Global H loss: 0.0416 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2156 |Global loss: 0.7609| Local H loss: 0.054  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.3382 |Global loss: 2.0167| Local H loss: 0.0831  | Global H loss: 0.0541 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3087 |Global loss: 2.0483| Local H loss: 0.0672  | Global H loss: 0.054 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3118 |Global loss: 1.439| Local H loss: 0.0654  | Global H loss: 0.0465 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3026 |Global loss: 1.182| Local H loss: 0.0631  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2826 |Global loss: 1.9848| Local H loss: 0.1009  | Global H loss: 0.0592 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2344 |Global loss: 1.1869| Local H loss: 0.0645  | Global H loss: 0.0493 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2237 |Global loss: 0.9483| Local H loss: 0.0624  | Global H loss: 0.0448 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.225 |Global loss: 0.9388| Local H loss: 0.0565  | Global H loss: 0.0428 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.4059 |Global loss: 2.0002| Local H loss: 0.0921  | Global H loss: 0.0529 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.3732 |Global loss: 1.41| Local H loss: 0.0631  | Global H loss: 0.0452 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.3889 |Global loss: 0.996| Local H loss: 0.0592  | Global H loss: 0.0367 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.3474 |Global loss: 0.9552| Local H loss: 0.0495  | Global H loss: 0.0319 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2679 |Global loss: 1.7316| Local H loss: 0.0933  | Global H loss: 0.0561 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2219 |Global loss: 0.9962| Local H loss: 0.0568  | Global H loss: 0.0449 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2138 |Global loss: 0.803| Local H loss: 0.0518  | Global H loss: 0.0393 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2223 |Global loss: 0.7854| Local H loss: 0.0527  | Global H loss: 0.038 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2726 |Global loss: 1.7126| Local H loss: 0.0949  | Global H loss: 0.0556 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2287 |Global loss: 1.1933| Local H loss: 0.0628  | Global H loss: 0.0479 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.222 |Global loss: 0.9945| Local H loss: 0.0548  | Global H loss: 0.0444 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2101 |Global loss: 0.7646| Local H loss: 0.0533  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2731 |Global loss: 1.881| Local H loss: 0.0944  | Global H loss: 0.0584 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2289 |Global loss: 1.0035| Local H loss: 0.0631  | Global H loss: 0.0457 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2222 |Global loss: 0.8735| Local H loss: 0.0595  | Global H loss: 0.0422 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2187 |Global loss: 0.7605| Local H loss: 0.0566  | Global H loss: 0.0385 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2725 |Global loss: 1.7982| Local H loss: 0.0988  | Global H loss: 0.0579 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2198 |Global loss: 0.8912| Local H loss: 0.0593  | Global H loss: 0.0439 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2137 |Global loss: 0.8067| Local H loss: 0.0537  | Global H loss: 0.0395 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.1993 |Global loss: 0.577| Local H loss: 0.0505  | Global H loss: 0.0328 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2635 |Global loss: 1.8414| Local H loss: 0.0892  | Global H loss: 0.0578 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2326 |Global loss: 1.1257| Local H loss: 0.0652  | Global H loss: 0.0483 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2321 |Global loss: 1.0725| Local H loss: 0.0619  | Global H loss: 0.046 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2264 |Global loss: 0.9499| Local H loss: 0.0597  | Global H loss: 0.0434 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2699 |Global loss: 2.0105| Local H loss: 0.093  | Global H loss: 0.0595 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2408 |Global loss: 1.4426| Local H loss: 0.0676  | Global H loss: 0.0522 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2294 |Global loss: 1.1263| Local H loss: 0.0623  | Global H loss: 0.0475 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2309 |Global loss: 1.0744| Local H loss: 0.0597  | Global H loss: 0.0455 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2796 |Global loss: 1.8459| Local H loss: 0.0927  | Global H loss: 0.0559 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2405 |Global loss: 1.2963| Local H loss: 0.0643  | Global H loss: 0.0508 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2378 |Global loss: 1.0292| Local H loss: 0.0606  | Global H loss: 0.0436 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.2295 |Global loss: 0.9216| Local H loss: 0.0606  | Global H loss: 0.043 [0m
0 0
[94mEpoch: 0|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 0|  Loss:  0.2817 |Global loss: 2.0125| Local H loss: 0.1023  | Global H loss: 0.0597 [0m
0 0
[94mEpoch: 1|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 1|  Loss:  0.2346 |Global loss: 1.334| Local H loss: 0.0663  | Global H loss: 0.0524 [0m
0 0
[94mEpoch: 2|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 2|  Loss:  0.2254 |Global loss: 0.9244| Local H loss: 0.0607  | Global H loss: 0.0441 [0m
0 0
[94mEpoch: 3|  NKD Loss: 0.0 | CT Loss: 0.0| [0m
[91mEpoch: 3|  Loss:  0.227 |Global loss: 0.9187| Local H loss: 0.0565  | Global H loss: 0.0445 [0m
------------------------- time cost ------------------------- 7.199547052383423

Best accuracy.
0.9345975232198143

Average time cost per round.
6.994103186130523
File path: ../results/HAR_FedKDX_test_0.h5
All Client results path:  ../results/HAR_FedKDX_test_0_all_resuls_0.9_32_100_30_2025_04_10_16_35.pkl

Average time cost: 709.92s.
Length:  101
std for best accurancy: 0.0
mean for best accurancy: 0.9345975232198143
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 170319990 	Used Memory: 539.85M
The allocated memory on cuda:0: 558.10M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 20520 	Used Memory: 150.00K
-------------------------------------------------------------------------------
