
Join ratio / total clients: 0.4 / 9
Finished creating server and clients.
Chosen Clients:  [5, 3, 2]

-------------Round number: 0-------------

Evaluate personalized models
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([3, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([28, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([17, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([31, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([15, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([3, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([2, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([32, 32, 2, 124])
torch.Size([27, 32, 2, 124])
torch.Size([12, 32, 2, 124])
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8]
Accuracy in each clients:  [0.083, 0.094, 0.122, 0.116, 0.093, 0.095, 0.131, 0.114, 0.0]
AUC in each clients:  [242.113, 240.111, 164.162, 223.412, 259.558, 234.449, 230.275, 250.856, 0.0]
F1 Score:  [0.013, 0.014, 0.027, 0.021, 0.014, 0.016, 0.021, 0.017, 0.0]
Recall Score:  [0.083, 0.083, 0.125, 0.1, 0.083, 0.091, 0.091, 0.083, 0.0]
Number of sample in client:  [483, 508, 337, 447, 527, 483, 450, 507, 12]
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkdx.py", line 41, in train
    self.evaluate()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 306, in evaluate
    stats_train = self.train_metrics()
                  ^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 295, in train_metrics
    cl, ns = c.train_metrics()
             ^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 188, in train_metrics
    trainloader = self.load_train_data()
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientbase.py", line 109, in load_train_data
    train_data = read_client_data(self.dataset, self.id, is_train=True)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/utils/data_utils.py", line 50, in read_client_data
    train_data = read_data(dataset, idx, is_train)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/utils/data_utils.py", line 29, in read_data
    train_data = np.load(f, allow_pickle=True)['data'].tolist()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/lib/npyio.py", line 256, in __getitem__
    return format.read_array(bytes,
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/lib/format.py", line 800, in read_array
    array = pickle.load(fp, **pickle_kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/zipfile/__init__.py", line 978, in read
    data = self._read1(n)
           ^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/zipfile/__init__.py", line 1054, in _read1
    data = self._decompressor.decompress(data, n)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
