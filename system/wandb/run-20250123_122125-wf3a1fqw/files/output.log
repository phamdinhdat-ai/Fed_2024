
Join ratio / total clients: 0.4 / 15
Finished creating server and clients.
Chosen Clients:  [10, 3, 0, 8, 9, 2]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [61.674, 62.267, 61.577, 60.87, 61.827, 61.234, 61.995, 61.47, 61.178, 61.266, 62.158, 62.669, 60.302, 60.288, 61.196]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2947
Averaged Test Accurancy: 0.0667
Averaged Test AUC: 0.5122
Averaged Test F1_score: 0.0100
Averaged Test Recal score: 0.0830
Std Test Accurancy: 0.0000
Std Test AUC: 0.0054
Std Test F1: 0.0000
Std Test Recall: 0.0000
Epoch: 0|  NKD Loss: 3.8012
Epoch: 0|  Loss:  6.2979 |Global loss: 6.2992| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 3.801
Epoch: 1|  Loss:  6.2911 |Global loss: 6.2956| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  6.2854 |Global loss: 6.2927| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 3|  NKD Loss: 3.8009
Epoch: 3|  Loss:  6.2794 |Global loss: 6.2893| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.3013 |Global loss: 6.3029| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 3.8007
Epoch: 1|  Loss:  6.2956 |Global loss: 6.3006| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 2|  NKD Loss: 3.8008
Epoch: 2|  Loss:  6.2886 |Global loss: 6.2965| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 3|  NKD Loss: 3.801
Epoch: 3|  Loss:  6.2827 |Global loss: 6.2931| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 0|  NKD Loss: 3.8012
Epoch: 0|  Loss:  6.2996 |Global loss: 6.3008| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 1|  NKD Loss: 3.8011
Epoch: 1|  Loss:  6.2948 |Global loss: 6.2989| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 3.8012
Epoch: 2|  Loss:  6.2892 |Global loss: 6.2958| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 3.8013
Epoch: 3|  Loss:  6.284 |Global loss: 6.2926| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 3.801
Epoch: 0|  Loss:  6.2999 |Global loss: 6.3012| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 3.8008
Epoch: 1|  Loss:  6.294 |Global loss: 6.2984| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 3.801
Epoch: 2|  Loss:  6.2889 |Global loss: 6.2953| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 3|  NKD Loss: 3.801
Epoch: 3|  Loss:  6.2834 |Global loss: 6.292| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.3014 |Global loss: 6.3028| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 3.8008
Epoch: 1|  Loss:  6.2948 |Global loss: 6.2996| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  6.2881 |Global loss: 6.2959| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 3.8011
Epoch: 3|  Loss:  6.2819 |Global loss: 6.2927| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 3.8012
Epoch: 0|  Loss:  6.2992 |Global loss: 6.3004| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 1|  NKD Loss: 3.8013
Epoch: 1|  Loss:  6.2922 |Global loss: 6.2963| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 3.801
Epoch: 2|  Loss:  6.2884 |Global loss: 6.2956| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 3|  NKD Loss: 3.8011
Epoch: 3|  Loss:  6.2825 |Global loss: 6.2922| Local H loss: 0.0124  | Global H loss: 0.0124
------------------------- time cost ------------------------- 5.125342607498169
Chosen Clients:  [0, 11, 12, 10, 13, 7]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.142, 0.067, 0.225, 0.192, 0.067, 0.067, 0.067, 0.067, 0.133, 0.133, 0.258, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [73.983, 62.267, 76.581, 75.734, 61.827, 61.234, 61.995, 61.47, 73.847, 74.812, 76.67, 62.669, 60.302, 60.288, 61.196]
F1 Score:  [0.057, 0.01, 0.097, 0.168, 0.01, 0.01, 0.01, 0.01, 0.06, 0.041, 0.113, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.167, 0.083, 0.234, 0.241, 0.083, 0.083, 0.083, 0.083, 0.157, 0.157, 0.24, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2846
Averaged Test Accurancy: 0.1122
Averaged Test AUC: 0.5583
Averaged Test F1_score: 0.0417
Averaged Test Recal score: 0.1295
Std Test Accurancy: 0.0637
Std Test AUC: 0.0569
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7994
Epoch: 0|  Loss:  6.2755 |Global loss: 6.2945| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.799
Epoch: 1|  Loss:  6.272 |Global loss: 6.294| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7989
Epoch: 2|  Loss:  6.2669 |Global loss: 6.2919| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7991
Epoch: 3|  Loss:  6.2598 |Global loss: 6.2878| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 3.801
Epoch: 0|  Loss:  6.2965 |Global loss: 6.2965| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 3.8006
Epoch: 1|  Loss:  6.29 |Global loss: 6.2948| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 3.8003
Epoch: 2|  Loss:  6.2838 |Global loss: 6.2931| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 3.7998
Epoch: 3|  Loss:  6.2786 |Global loss: 6.2926| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.2968 |Global loss: 6.2967| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 3.8005
Epoch: 1|  Loss:  6.2902 |Global loss: 6.2941| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 2|  NKD Loss: 3.8003
Epoch: 2|  Loss:  6.2834 |Global loss: 6.2919| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.8
Epoch: 3|  Loss:  6.2775 |Global loss: 6.2904| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 3.7987
Epoch: 0|  Loss:  6.2693 |Global loss: 6.2944| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.7986
Epoch: 1|  Loss:  6.2632 |Global loss: 6.292| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7982
Epoch: 2|  Loss:  6.2561 |Global loss: 6.2899| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 3.7977
Epoch: 3|  Loss:  6.2501 |Global loss: 6.2891| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 3.8009
Epoch: 0|  Loss:  6.2993 |Global loss: 6.2971| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 3.8006
Epoch: 1|  Loss:  6.2942 |Global loss: 6.2948| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 3.8002
Epoch: 2|  Loss:  6.288 |Global loss: 6.2934| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 3.8002
Epoch: 3|  Loss:  6.2814 |Global loss: 6.2895| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 3.8011
Epoch: 0|  Loss:  6.2971 |Global loss: 6.295| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 3.8007
Epoch: 1|  Loss:  6.2929 |Global loss: 6.2937| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 3.8006
Epoch: 2|  Loss:  6.2873 |Global loss: 6.2909| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 3|  NKD Loss: 3.8004
Epoch: 3|  Loss:  6.282 |Global loss: 6.2889| Local H loss: 0.0109  | Global H loss: 0.0109
------------------------- time cost ------------------------- 4.734359502792358
Chosen Clients:  [0, 1, 6, 12, 10, 8]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.333, 0.067, 0.225, 0.192, 0.067, 0.067, 0.067, 0.067, 0.133, 0.133, 0.283, 0.133, 0.067, 0.075, 0.067]
AUC in each clients:  [81.96, 62.267, 76.581, 75.734, 61.827, 61.234, 61.995, 73.983, 73.847, 74.812, 85.392, 74.366, 75.073, 73.136, 61.196]
F1 Score:  [0.187, 0.01, 0.097, 0.168, 0.01, 0.01, 0.01, 0.01, 0.06, 0.041, 0.155, 0.072, 0.01, 0.057, 0.01]
Recall Score:  [0.33, 0.083, 0.234, 0.241, 0.083, 0.083, 0.083, 0.083, 0.157, 0.157, 0.278, 0.157, 0.083, 0.102, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2762
Averaged Test Accurancy: 0.1317
Averaged Test AUC: 0.5963
Averaged Test F1_score: 0.0605
Averaged Test Recal score: 0.1491
Std Test Accurancy: 0.0852
Std Test AUC: 0.0636
Std Test F1: 0.0005
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 3.7973
Epoch: 0|  Loss:  6.2537 |Global loss: 6.2942| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7973
Epoch: 1|  Loss:  6.248 |Global loss: 6.292| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.797
Epoch: 2|  Loss:  6.2426 |Global loss: 6.2909| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 3.7969
Epoch: 3|  Loss:  6.2351 |Global loss: 6.2883| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 0|  NKD Loss: 3.8003
Epoch: 0|  Loss:  6.2966 |Global loss: 6.2967| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.8001
Epoch: 1|  Loss:  6.292 |Global loss: 6.2948| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 3.7998
Epoch: 2|  Loss:  6.2883 |Global loss: 6.294| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 3.7994
Epoch: 3|  Loss:  6.2846 |Global loss: 6.2933| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 3.8002
Epoch: 0|  Loss:  6.2967 |Global loss: 6.2977| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.8001
Epoch: 1|  Loss:  6.2908 |Global loss: 6.295| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 3.7994
Epoch: 2|  Loss:  6.2866 |Global loss: 6.2954| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 3.7995
Epoch: 3|  Loss:  6.2807 |Global loss: 6.2921| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 0|  NKD Loss: 3.7983
Epoch: 0|  Loss:  6.2688 |Global loss: 6.2953| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.7985
Epoch: 1|  Loss:  6.2629 |Global loss: 6.2922| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  6.2559 |Global loss: 6.2922| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7982
Epoch: 3|  Loss:  6.249 |Global loss: 6.2888| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.797
Epoch: 0|  Loss:  6.2425 |Global loss: 6.2915| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 3.7965
Epoch: 1|  Loss:  6.2332 |Global loss: 6.2893| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 3.7963
Epoch: 2|  Loss:  6.2262 |Global loss: 6.2882| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 3.7959
Epoch: 3|  Loss:  6.2183 |Global loss: 6.2875| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 3.7991
Epoch: 0|  Loss:  6.2737 |Global loss: 6.2935| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.7987
Epoch: 1|  Loss:  6.2692 |Global loss: 6.293| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7984
Epoch: 2|  Loss:  6.2631 |Global loss: 6.2914| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.7979
Epoch: 3|  Loss:  6.2582 |Global loss: 6.2919| Local H loss: 0.0101  | Global H loss: 0.0101
------------------------- time cost ------------------------- 4.777413845062256
Chosen Clients:  [4, 10, 5, 0, 11, 6]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.25, 0.142, 0.225, 0.192, 0.067, 0.067, 0.192, 0.067, 0.392, 0.133, 0.375, 0.133, 0.2, 0.075, 0.067]
AUC in each clients:  [89.114, 71.393, 76.581, 75.734, 61.827, 61.234, 71.834, 73.983, 81.638, 74.812, 92.231, 74.366, 84.421, 73.136, 61.196]
F1 Score:  [0.167, 0.059, 0.097, 0.168, 0.01, 0.01, 0.14, 0.01, 0.322, 0.041, 0.238, 0.072, 0.142, 0.057, 0.01]
Recall Score:  [0.3, 0.167, 0.234, 0.241, 0.083, 0.083, 0.241, 0.083, 0.407, 0.157, 0.388, 0.157, 0.25, 0.102, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2674
Averaged Test Accurancy: 0.1717
Averaged Test AUC: 0.6242
Averaged Test F1_score: 0.1029
Averaged Test Recal score: 0.1984
Std Test Accurancy: 0.1025
Std Test AUC: 0.0749
Std Test F1: 0.0007
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.7999
Epoch: 0|  Loss:  6.2979 |Global loss: 6.2988| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 3.7997
Epoch: 1|  Loss:  6.2924 |Global loss: 6.2967| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 3.7996
Epoch: 2|  Loss:  6.2869 |Global loss: 6.2944| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 3.7991
Epoch: 3|  Loss:  6.282 |Global loss: 6.2938| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 3.7953
Epoch: 0|  Loss:  6.2088 |Global loss: 6.2915| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.7955
Epoch: 1|  Loss:  6.1977 |Global loss: 6.2879| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 3.7951
Epoch: 2|  Loss:  6.1916 |Global loss: 6.2893| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7954
Epoch: 3|  Loss:  6.178 |Global loss: 6.2859| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 0|  NKD Loss: 3.7997
Epoch: 0|  Loss:  6.2981 |Global loss: 6.2991| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 3.7993
Epoch: 1|  Loss:  6.2926 |Global loss: 6.2978| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 3.7992
Epoch: 2|  Loss:  6.2861 |Global loss: 6.2949| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 3.7987
Epoch: 3|  Loss:  6.2805 |Global loss: 6.2943| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 3.7959
Epoch: 0|  Loss:  6.2287 |Global loss: 6.2919| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 3.7959
Epoch: 1|  Loss:  6.2203 |Global loss: 6.2891| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 3.7955
Epoch: 2|  Loss:  6.2146 |Global loss: 6.2889| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 3.7952
Epoch: 3|  Loss:  6.2042 |Global loss: 6.2868| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7984
Epoch: 0|  Loss:  6.2715 |Global loss: 6.2952| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.7982
Epoch: 1|  Loss:  6.266 |Global loss: 6.2942| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 3.7983
Epoch: 2|  Loss:  6.2599 |Global loss: 6.2912| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 3.798
Epoch: 3|  Loss:  6.2544 |Global loss: 6.2908| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7987
Epoch: 0|  Loss:  6.2736 |Global loss: 6.2928| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7981
Epoch: 1|  Loss:  6.2701 |Global loss: 6.294| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 3.7979
Epoch: 2|  Loss:  6.2648 |Global loss: 6.2927| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 3.7981
Epoch: 3|  Loss:  6.2585 |Global loss: 6.2891| Local H loss: 0.0099  | Global H loss: 0.0099
------------------------- time cost ------------------------- 4.727189779281616
Chosen Clients:  [4, 9, 1, 11, 7, 2]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.267, 0.142, 0.225, 0.192, 0.067, 0.183, 0.192, 0.067, 0.392, 0.133, 0.467, 0.192, 0.2, 0.075, 0.067]
AUC in each clients:  [97.509, 71.393, 76.581, 75.734, 72.98, 72.88, 79.448, 73.983, 81.638, 74.812, 96.96, 82.688, 84.421, 73.136, 61.196]
F1 Score:  [0.186, 0.059, 0.097, 0.168, 0.01, 0.1, 0.152, 0.01, 0.322, 0.041, 0.328, 0.163, 0.142, 0.057, 0.01]
Recall Score:  [0.319, 0.167, 0.234, 0.241, 0.083, 0.191, 0.241, 0.083, 0.407, 0.157, 0.464, 0.241, 0.25, 0.102, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2569
Averaged Test Accurancy: 0.1906
Averaged Test AUC: 0.6530
Averaged Test F1_score: 0.1230
Averaged Test Recal score: 0.2175
Std Test Accurancy: 0.1122
Std Test AUC: 0.0761
Std Test F1: 0.0008
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.798
Epoch: 0|  Loss:  6.2765 |Global loss: 6.2967| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.7979
Epoch: 1|  Loss:  6.2716 |Global loss: 6.2949| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  6.2652 |Global loss: 6.2919| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7975
Epoch: 3|  Loss:  6.2615 |Global loss: 6.2927| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 3.7979
Epoch: 0|  Loss:  6.2699 |Global loss: 6.2953| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.7976
Epoch: 1|  Loss:  6.2638 |Global loss: 6.2944| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7974
Epoch: 2|  Loss:  6.2568 |Global loss: 6.2928| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7968
Epoch: 3|  Loss:  6.25 |Global loss: 6.2925| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 3.798
Epoch: 0|  Loss:  6.2777 |Global loss: 6.2957| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.7981
Epoch: 1|  Loss:  6.2736 |Global loss: 6.2926| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7975
Epoch: 2|  Loss:  6.2703 |Global loss: 6.2931| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7974
Epoch: 3|  Loss:  6.2647 |Global loss: 6.2912| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7971
Epoch: 0|  Loss:  6.2483 |Global loss: 6.2935| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7968
Epoch: 1|  Loss:  6.2444 |Global loss: 6.2937| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7968
Epoch: 2|  Loss:  6.238 |Global loss: 6.2923| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 3.7962
Epoch: 3|  Loss:  6.2305 |Global loss: 6.2927| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7981
Epoch: 0|  Loss:  6.2727 |Global loss: 6.2936| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.7978
Epoch: 1|  Loss:  6.2678 |Global loss: 6.2922| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 3.7973
Epoch: 2|  Loss:  6.263 |Global loss: 6.2918| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.7968
Epoch: 3|  Loss:  6.2585 |Global loss: 6.292| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 3.798
Epoch: 0|  Loss:  6.2708 |Global loss: 6.2953| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7978
Epoch: 1|  Loss:  6.2657 |Global loss: 6.294| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 3.7974
Epoch: 2|  Loss:  6.2604 |Global loss: 6.2936| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7973
Epoch: 3|  Loss:  6.2539 |Global loss: 6.2912| Local H loss: 0.01  | Global H loss: 0.01
------------------------- time cost ------------------------- 5.418277025222778
Chosen Clients:  [7, 5, 1, 9, 11, 13]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.267, 0.125, 0.308, 0.192, 0.1, 0.183, 0.192, 0.183, 0.392, 0.35, 0.467, 0.292, 0.2, 0.075, 0.067]
AUC in each clients:  [97.509, 79.048, 84.331, 75.734, 78.25, 72.88, 79.448, 80.768, 81.638, 86.164, 96.96, 89.795, 84.421, 73.136, 61.196]
F1 Score:  [0.186, 0.048, 0.186, 0.168, 0.058, 0.1, 0.152, 0.083, 0.322, 0.246, 0.328, 0.193, 0.142, 0.057, 0.01]
Recall Score:  [0.319, 0.167, 0.329, 0.241, 0.12, 0.191, 0.241, 0.201, 0.407, 0.348, 0.464, 0.324, 0.25, 0.102, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2476
Averaged Test Accurancy: 0.2261
Averaged Test AUC: 0.6785
Averaged Test F1_score: 0.1519
Averaged Test Recal score: 0.2525
Std Test Accurancy: 0.1138
Std Test AUC: 0.0750
Std Test F1: 0.0008
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.7961
Epoch: 0|  Loss:  6.2498 |Global loss: 6.2936| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 3.7955
Epoch: 1|  Loss:  6.2445 |Global loss: 6.2945| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 3.7953
Epoch: 2|  Loss:  6.2388 |Global loss: 6.2938| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7954
Epoch: 3|  Loss:  6.2294 |Global loss: 6.2908| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 3.7972
Epoch: 0|  Loss:  6.2743 |Global loss: 6.2967| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.2687 |Global loss: 6.2955| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 3.7971
Epoch: 2|  Loss:  6.2622 |Global loss: 6.2916| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7964
Epoch: 3|  Loss:  6.2567 |Global loss: 6.2922| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7965
Epoch: 0|  Loss:  6.2584 |Global loss: 6.2935| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 3.7963
Epoch: 1|  Loss:  6.2535 |Global loss: 6.2916| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 3.7958
Epoch: 2|  Loss:  6.2483 |Global loss: 6.2919| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 3.7958
Epoch: 3|  Loss:  6.2414 |Global loss: 6.2897| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 0|  NKD Loss: 3.7961
Epoch: 0|  Loss:  6.2434 |Global loss: 6.2948| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.7961
Epoch: 1|  Loss:  6.2347 |Global loss: 6.2919| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.796
Epoch: 2|  Loss:  6.23 |Global loss: 6.2914| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7955
Epoch: 3|  Loss:  6.221 |Global loss: 6.2914| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7957
Epoch: 0|  Loss:  6.2227 |Global loss: 6.2948| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 3.7963
Epoch: 1|  Loss:  6.2131 |Global loss: 6.2911| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 2|  NKD Loss: 3.796
Epoch: 2|  Loss:  6.2054 |Global loss: 6.2914| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 3|  NKD Loss: 3.7957
Epoch: 3|  Loss:  6.1963 |Global loss: 6.2926| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7976
Epoch: 0|  Loss:  6.2733 |Global loss: 6.2946| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.2684 |Global loss: 6.2941| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7969
Epoch: 2|  Loss:  6.2619 |Global loss: 6.2918| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7964
Epoch: 3|  Loss:  6.2567 |Global loss: 6.2914| Local H loss: 0.0098  | Global H loss: 0.0098
------------------------- time cost ------------------------- 4.783731937408447
Chosen Clients:  [5, 2, 3, 8, 12, 9]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.267, 0.217, 0.308, 0.192, 0.1, 0.258, 0.192, 0.2, 0.392, 0.383, 0.467, 0.217, 0.2, 0.15, 0.067]
AUC in each clients:  [97.509, 83.466, 84.331, 75.734, 78.25, 80.695, 79.448, 89.021, 81.638, 91.886, 96.96, 94.085, 84.421, 80.661, 61.196]
F1 Score:  [0.186, 0.13, 0.186, 0.168, 0.058, 0.142, 0.152, 0.096, 0.322, 0.286, 0.328, 0.098, 0.142, 0.082, 0.01]
Recall Score:  [0.319, 0.243, 0.329, 0.241, 0.12, 0.241, 0.241, 0.25, 0.407, 0.426, 0.464, 0.243, 0.25, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2355
Averaged Test Accurancy: 0.2406
Averaged Test AUC: 0.6996
Averaged Test F1_score: 0.1591
Averaged Test Recal score: 0.2697
Std Test Accurancy: 0.1056
Std Test AUC: 0.0748
Std Test F1: 0.0007
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 3.7956
Epoch: 0|  Loss:  6.2496 |Global loss: 6.2931| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 3.7954
Epoch: 1|  Loss:  6.2443 |Global loss: 6.2928| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 3.7949
Epoch: 2|  Loss:  6.2381 |Global loss: 6.2926| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 3.7943
Epoch: 3|  Loss:  6.2323 |Global loss: 6.2939| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 0|  NKD Loss: 3.7959
Epoch: 0|  Loss:  6.2482 |Global loss: 6.2953| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2401 |Global loss: 6.2933| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 3.7956
Epoch: 2|  Loss:  6.233 |Global loss: 6.2918| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7954
Epoch: 3|  Loss:  6.2253 |Global loss: 6.2914| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7976
Epoch: 0|  Loss:  6.2712 |Global loss: 6.2956| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 3.7966
Epoch: 1|  Loss:  6.2662 |Global loss: 6.2965| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 3.7965
Epoch: 2|  Loss:  6.26 |Global loss: 6.295| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 3.7961
Epoch: 3|  Loss:  6.2508 |Global loss: 6.2934| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 3.796
Epoch: 0|  Loss:  6.248 |Global loss: 6.2929| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2427 |Global loss: 6.2927| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.7949
Epoch: 2|  Loss:  6.2356 |Global loss: 6.294| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7948
Epoch: 3|  Loss:  6.2276 |Global loss: 6.2923| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.2413 |Global loss: 6.2938| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2339 |Global loss: 6.2927| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7954
Epoch: 2|  Loss:  6.2252 |Global loss: 6.2922| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 3.7952
Epoch: 3|  Loss:  6.2149 |Global loss: 6.2921| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 3.795
Epoch: 0|  Loss:  6.2127 |Global loss: 6.2926| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7947
Epoch: 1|  Loss:  6.2003 |Global loss: 6.2917| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.7948
Epoch: 2|  Loss:  6.1925 |Global loss: 6.2917| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 3.7947
Epoch: 3|  Loss:  6.1822 |Global loss: 6.2919| Local H loss: 0.0099  | Global H loss: 0.0099
------------------------- time cost ------------------------- 4.952603816986084
Chosen Clients:  [10, 4, 0, 7, 9, 11]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.267, 0.217, 0.35, 0.192, 0.1, 0.258, 0.192, 0.2, 0.383, 0.25, 0.467, 0.217, 0.2, 0.15, 0.067]
AUC in each clients:  [97.509, 83.466, 89.312, 82.869, 78.25, 86.787, 79.448, 89.021, 88.32, 97.083, 96.96, 94.085, 90.748, 80.661, 61.196]
F1 Score:  [0.186, 0.13, 0.234, 0.135, 0.058, 0.116, 0.152, 0.096, 0.277, 0.136, 0.328, 0.098, 0.105, 0.082, 0.01]
Recall Score:  [0.319, 0.243, 0.389, 0.241, 0.12, 0.241, 0.241, 0.25, 0.398, 0.333, 0.464, 0.243, 0.25, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2227
Averaged Test Accurancy: 0.2339
Averaged Test AUC: 0.7198
Averaged Test F1_score: 0.1429
Averaged Test Recal score: 0.2669
Std Test Accurancy: 0.1004
Std Test AUC: 0.0761
Std Test F1: 0.0007
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.1644 |Global loss: 6.2927| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 3.7935
Epoch: 1|  Loss:  6.1535 |Global loss: 6.2943| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7941
Epoch: 2|  Loss:  6.138 |Global loss: 6.2922| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 3.7944
Epoch: 3|  Loss:  6.1246 |Global loss: 6.293| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.2535 |Global loss: 6.2937| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7953
Epoch: 1|  Loss:  6.2485 |Global loss: 6.2947| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 3.7951
Epoch: 2|  Loss:  6.2417 |Global loss: 6.2933| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 3|  NKD Loss: 3.795
Epoch: 3|  Loss:  6.2359 |Global loss: 6.2921| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7933
Epoch: 0|  Loss:  6.1906 |Global loss: 6.2892| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 3.7925
Epoch: 1|  Loss:  6.1832 |Global loss: 6.2916| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 3.7925
Epoch: 2|  Loss:  6.174 |Global loss: 6.2911| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 3.7921
Epoch: 3|  Loss:  6.1619 |Global loss: 6.2914| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 0|  NKD Loss: 3.7942
Epoch: 0|  Loss:  6.2201 |Global loss: 6.2934| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.794
Epoch: 1|  Loss:  6.2089 |Global loss: 6.2913| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 3.7936
Epoch: 2|  Loss:  6.1994 |Global loss: 6.2927| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 3.7935
Epoch: 3|  Loss:  6.1894 |Global loss: 6.2927| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 3.7943
Epoch: 0|  Loss:  6.175 |Global loss: 6.2958| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 3.7951
Epoch: 1|  Loss:  6.1598 |Global loss: 6.295| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7956
Epoch: 2|  Loss:  6.1505 |Global loss: 6.2939| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.796
Epoch: 3|  Loss:  6.1376 |Global loss: 6.2944| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 0|  NKD Loss: 3.7954
Epoch: 0|  Loss:  6.1851 |Global loss: 6.2932| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 3.7955
Epoch: 1|  Loss:  6.1751 |Global loss: 6.2926| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7955
Epoch: 2|  Loss:  6.1638 |Global loss: 6.2936| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7958
Epoch: 3|  Loss:  6.1558 |Global loss: 6.2937| Local H loss: 0.0098  | Global H loss: 0.0098
------------------------- time cost ------------------------- 4.905902862548828
Chosen Clients:  [6, 2, 0, 10, 14, 5]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.258, 0.217, 0.35, 0.192, 0.242, 0.258, 0.192, 0.2, 0.383, 0.25, 0.475, 0.317, 0.2, 0.15, 0.067]
AUC in each clients:  [101.074, 83.466, 89.312, 82.869, 83.414, 86.787, 79.448, 93.458, 88.32, 99.277, 101.405, 98.062, 90.748, 80.661, 61.196]
F1 Score:  [0.171, 0.13, 0.234, 0.135, 0.172, 0.116, 0.152, 0.09, 0.277, 0.133, 0.334, 0.233, 0.105, 0.082, 0.01]
Recall Score:  [0.312, 0.243, 0.389, 0.241, 0.294, 0.241, 0.241, 0.25, 0.398, 0.333, 0.473, 0.359, 0.25, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2055
Averaged Test Accurancy: 0.2500
Averaged Test AUC: 0.7331
Averaged Test F1_score: 0.1583
Averaged Test Recal score: 0.2863
Std Test Accurancy: 0.0965
Std Test AUC: 0.0842
Std Test F1: 0.0007
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 3.795
Epoch: 0|  Loss:  6.2492 |Global loss: 6.2935| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7947
Epoch: 1|  Loss:  6.2433 |Global loss: 6.2925| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 2|  NKD Loss: 3.7937
Epoch: 2|  Loss:  6.2364 |Global loss: 6.2944| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 3|  NKD Loss: 3.7938
Epoch: 3|  Loss:  6.2292 |Global loss: 6.2916| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7943
Epoch: 0|  Loss:  6.2183 |Global loss: 6.2936| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7939
Epoch: 1|  Loss:  6.2088 |Global loss: 6.2945| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 3.7942
Epoch: 2|  Loss:  6.1988 |Global loss: 6.2934| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7937
Epoch: 3|  Loss:  6.1892 |Global loss: 6.2952| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 3.7922
Epoch: 0|  Loss:  6.1473 |Global loss: 6.2917| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7921
Epoch: 1|  Loss:  6.1337 |Global loss: 6.2934| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 3.7922
Epoch: 2|  Loss:  6.1207 |Global loss: 6.2932| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7929
Epoch: 3|  Loss:  6.1045 |Global loss: 6.2912| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.1083 |Global loss: 6.2963| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 3.7968
Epoch: 1|  Loss:  6.0943 |Global loss: 6.2963| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 3.7977
Epoch: 2|  Loss:  6.0798 |Global loss: 6.2994| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 3.7987
Epoch: 3|  Loss:  6.0647 |Global loss: 6.2999| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 0|  NKD Loss: 3.7982
Epoch: 0|  Loss:  6.2962 |Global loss: 6.2997| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 3.7981
Epoch: 1|  Loss:  6.287 |Global loss: 6.2946| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 2|  NKD Loss: 3.7969
Epoch: 2|  Loss:  6.2821 |Global loss: 6.2965| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.7964
Epoch: 3|  Loss:  6.2752 |Global loss: 6.2947| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 3.7936
Epoch: 0|  Loss:  6.2245 |Global loss: 6.293| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 3.7934
Epoch: 1|  Loss:  6.2154 |Global loss: 6.2921| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.2074 |Global loss: 6.2938| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 3.793
Epoch: 3|  Loss:  6.1976 |Global loss: 6.292| Local H loss: 0.0089  | Global H loss: 0.0089
------------------------- time cost ------------------------- 4.71797513961792
Chosen Clients:  [11, 3, 1, 6, 0, 4]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.283, 0.217, 0.408, 0.192, 0.242, 0.375, 0.192, 0.2, 0.383, 0.25, 0.525, 0.317, 0.2, 0.15, 0.067]
AUC in each clients:  [103.198, 83.466, 92.439, 82.869, 83.414, 91.52, 84.689, 93.458, 88.32, 99.277, 104.953, 98.062, 90.748, 80.661, 73.998]
F1 Score:  [0.206, 0.13, 0.324, 0.135, 0.172, 0.269, 0.163, 0.09, 0.277, 0.133, 0.425, 0.233, 0.105, 0.082, 0.01]
Recall Score:  [0.333, 0.243, 0.484, 0.241, 0.294, 0.394, 0.241, 0.25, 0.398, 0.333, 0.557, 0.359, 0.25, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1883
Averaged Test Accurancy: 0.2667
Averaged Test AUC: 0.7506
Averaged Test F1_score: 0.1836
Averaged Test Recal score: 0.3099
Std Test Accurancy: 0.1132
Std Test AUC: 0.0707
Std Test F1: 0.0009
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 3.7956
Epoch: 0|  Loss:  6.1428 |Global loss: 6.2958| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 3.7963
Epoch: 1|  Loss:  6.1323 |Global loss: 6.2963| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7968
Epoch: 2|  Loss:  6.1158 |Global loss: 6.2966| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.7972
Epoch: 3|  Loss:  6.0997 |Global loss: 6.2983| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 0|  NKD Loss: 3.7943
Epoch: 0|  Loss:  6.2417 |Global loss: 6.2946| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.794
Epoch: 1|  Loss:  6.2349 |Global loss: 6.2936| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 3.7937
Epoch: 2|  Loss:  6.2252 |Global loss: 6.2917| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 3.7933
Epoch: 3|  Loss:  6.2188 |Global loss: 6.2923| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.2329 |Global loss: 6.2927| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 1|  NKD Loss: 3.793
Epoch: 1|  Loss:  6.2256 |Global loss: 6.2927| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 2|  NKD Loss: 3.7931
Epoch: 2|  Loss:  6.2179 |Global loss: 6.29| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 3|  NKD Loss: 3.792
Epoch: 3|  Loss:  6.2112 |Global loss: 6.2936| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.2218 |Global loss: 6.292| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 3.7927
Epoch: 1|  Loss:  6.2128 |Global loss: 6.2907| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 3.7921
Epoch: 2|  Loss:  6.2043 |Global loss: 6.2918| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 3|  NKD Loss: 3.7919
Epoch: 3|  Loss:  6.1956 |Global loss: 6.2916| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7937
Epoch: 0|  Loss:  6.087 |Global loss: 6.2939| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 1|  NKD Loss: 3.7944
Epoch: 1|  Loss:  6.069 |Global loss: 6.2921| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 3.7958
Epoch: 2|  Loss:  6.0513 |Global loss: 6.297| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 3|  NKD Loss: 3.7965
Epoch: 3|  Loss:  6.0407 |Global loss: 6.2982| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.228 |Global loss: 6.2943| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 3.7937
Epoch: 1|  Loss:  6.2213 |Global loss: 6.2921| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 3.7934
Epoch: 2|  Loss:  6.2125 |Global loss: 6.2912| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 3.7927
Epoch: 3|  Loss:  6.205 |Global loss: 6.2933| Local H loss: 0.0092  | Global H loss: 0.0092
------------------------- time cost ------------------------- 4.864120244979858
Chosen Clients:  [14, 9, 6, 4, 3, 12]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.375, 0.292, 0.408, 0.267, 0.225, 0.375, 0.317, 0.2, 0.383, 0.25, 0.525, 0.325, 0.2, 0.15, 0.067]
AUC in each clients:  [105.676, 88.334, 92.439, 86.57, 88.541, 91.52, 88.987, 93.458, 88.32, 99.277, 104.953, 99.542, 90.748, 80.661, 73.998]
F1 Score:  [0.311, 0.191, 0.324, 0.212, 0.152, 0.269, 0.282, 0.09, 0.277, 0.133, 0.425, 0.277, 0.105, 0.082, 0.01]
Recall Score:  [0.427, 0.326, 0.484, 0.324, 0.28, 0.394, 0.407, 0.25, 0.398, 0.333, 0.557, 0.412, 0.25, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1717
Averaged Test Accurancy: 0.2906
Averaged Test AUC: 0.7628
Averaged Test F1_score: 0.2093
Averaged Test Recal score: 0.3409
Std Test Accurancy: 0.1115
Std Test AUC: 0.0679
Std Test F1: 0.0009
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 3.7949
Epoch: 0|  Loss:  6.2685 |Global loss: 6.2954| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 3.7944
Epoch: 1|  Loss:  6.263 |Global loss: 6.2948| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.794
Epoch: 2|  Loss:  6.2547 |Global loss: 6.2919| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 3.7933
Epoch: 3|  Loss:  6.2486 |Global loss: 6.2923| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7952
Epoch: 0|  Loss:  6.124 |Global loss: 6.2961| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.1106 |Global loss: 6.2948| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 2|  NKD Loss: 3.7971
Epoch: 2|  Loss:  6.1023 |Global loss: 6.2971| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 3.7968
Epoch: 3|  Loss:  6.0863 |Global loss: 6.2988| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 0|  NKD Loss: 3.792
Epoch: 0|  Loss:  6.1859 |Global loss: 6.2901| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 3.7912
Epoch: 1|  Loss:  6.1755 |Global loss: 6.2936| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7915
Epoch: 2|  Loss:  6.1632 |Global loss: 6.2919| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7915
Epoch: 3|  Loss:  6.1504 |Global loss: 6.2901| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.1967 |Global loss: 6.2908| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 3.7926
Epoch: 1|  Loss:  6.1855 |Global loss: 6.2918| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 3.793
Epoch: 2|  Loss:  6.1753 |Global loss: 6.2895| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 3|  NKD Loss: 3.7924
Epoch: 3|  Loss:  6.1642 |Global loss: 6.2911| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 0|  NKD Loss: 3.7927
Epoch: 0|  Loss:  6.2091 |Global loss: 6.2927| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7924
Epoch: 1|  Loss:  6.2015 |Global loss: 6.2928| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7922
Epoch: 2|  Loss:  6.192 |Global loss: 6.2919| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 3.7917
Epoch: 3|  Loss:  6.1833 |Global loss: 6.2943| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 3.7933
Epoch: 0|  Loss:  6.2066 |Global loss: 6.2934| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7931
Epoch: 1|  Loss:  6.1939 |Global loss: 6.2945| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.7932
Epoch: 2|  Loss:  6.1806 |Global loss: 6.2941| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 3.7935
Epoch: 3|  Loss:  6.1685 |Global loss: 6.2949| Local H loss: 0.0101  | Global H loss: 0.0101
------------------------- time cost ------------------------- 4.945327281951904
Chosen Clients:  [3, 2, 10, 6, 4, 12]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.375, 0.292, 0.408, 0.267, 0.283, 0.375, 0.325, 0.2, 0.383, 0.267, 0.525, 0.325, 0.233, 0.15, 0.067]
AUC in each clients:  [105.676, 88.334, 92.439, 90.977, 92.685, 91.52, 92.859, 93.458, 88.32, 100.767, 104.953, 99.542, 93.748, 80.661, 80.483]
F1 Score:  [0.311, 0.191, 0.324, 0.177, 0.242, 0.269, 0.267, 0.09, 0.277, 0.165, 0.425, 0.277, 0.155, 0.082, 0.01]
Recall Score:  [0.427, 0.326, 0.484, 0.324, 0.352, 0.394, 0.414, 0.25, 0.398, 0.35, 0.557, 0.412, 0.306, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1536
Averaged Test Accurancy: 0.2983
Averaged Test AUC: 0.7758
Averaged Test F1_score: 0.2175
Averaged Test Recal score: 0.3510
Std Test Accurancy: 0.1082
Std Test AUC: 0.0596
Std Test F1: 0.0009
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.7919
Epoch: 0|  Loss:  6.1715 |Global loss: 6.2942| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 3.792
Epoch: 1|  Loss:  6.1611 |Global loss: 6.2935| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 2|  NKD Loss: 3.7916
Epoch: 2|  Loss:  6.1511 |Global loss: 6.2956| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 3.7924
Epoch: 3|  Loss:  6.1371 |Global loss: 6.2919| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.1766 |Global loss: 6.2929| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 3.7934
Epoch: 1|  Loss:  6.1676 |Global loss: 6.2947| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 3.7941
Epoch: 2|  Loss:  6.1507 |Global loss: 6.2919| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 3|  NKD Loss: 3.7943
Epoch: 3|  Loss:  6.1418 |Global loss: 6.2961| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 0|  NKD Loss: 3.7993
Epoch: 0|  Loss:  6.0462 |Global loss: 6.302| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 3.8009
Epoch: 1|  Loss:  6.0252 |Global loss: 6.3028| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 2|  NKD Loss: 3.8025
Epoch: 2|  Loss:  6.0195 |Global loss: 6.3059| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 3|  NKD Loss: 3.8031
Epoch: 3|  Loss:  5.9959 |Global loss: 6.3048| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 3.7913
Epoch: 0|  Loss:  6.1372 |Global loss: 6.2931| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 3.7923
Epoch: 1|  Loss:  6.1262 |Global loss: 6.291| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 3.7926
Epoch: 2|  Loss:  6.1089 |Global loss: 6.2934| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 3.7929
Epoch: 3|  Loss:  6.0967 |Global loss: 6.2949| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 3.7929
Epoch: 0|  Loss:  6.1544 |Global loss: 6.2922| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7929
Epoch: 1|  Loss:  6.1505 |Global loss: 6.2946| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 3.7935
Epoch: 2|  Loss:  6.1341 |Global loss: 6.2949| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7938
Epoch: 3|  Loss:  6.1236 |Global loss: 6.2949| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 3.7946
Epoch: 0|  Loss:  6.1562 |Global loss: 6.295| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 3.7954
Epoch: 1|  Loss:  6.1407 |Global loss: 6.2961| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 2|  NKD Loss: 3.7964
Epoch: 2|  Loss:  6.1252 |Global loss: 6.2981| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 3|  NKD Loss: 3.7976
Epoch: 3|  Loss:  6.1165 |Global loss: 6.2974| Local H loss: 0.011  | Global H loss: 0.011
------------------------- time cost ------------------------- 4.7958292961120605
Chosen Clients:  [4, 7, 11, 5, 1, 2]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.375, 0.292, 0.317, 0.267, 0.292, 0.375, 0.4, 0.2, 0.383, 0.267, 0.525, 0.325, 0.25, 0.15, 0.067]
AUC in each clients:  [105.676, 88.334, 96.041, 94.447, 95.659, 91.52, 95.642, 93.458, 88.32, 100.767, 107.346, 99.542, 95.787, 80.661, 80.483]
F1 Score:  [0.311, 0.191, 0.267, 0.174, 0.256, 0.269, 0.351, 0.09, 0.277, 0.165, 0.425, 0.277, 0.17, 0.082, 0.01]
Recall Score:  [0.427, 0.326, 0.407, 0.324, 0.366, 0.394, 0.477, 0.25, 0.398, 0.35, 0.557, 0.412, 0.333, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1314
Averaged Test Accurancy: 0.2989
Averaged Test AUC: 0.7854
Averaged Test F1_score: 0.2210
Averaged Test Recal score: 0.3528
Std Test Accurancy: 0.1069
Std Test AUC: 0.0622
Std Test F1: 0.0009
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.7945
Epoch: 0|  Loss:  6.109 |Global loss: 6.296| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7943
Epoch: 1|  Loss:  6.0952 |Global loss: 6.298| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 3.7956
Epoch: 2|  Loss:  6.0787 |Global loss: 6.2959| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 3.7958
Epoch: 3|  Loss:  6.0705 |Global loss: 6.2976| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 0|  NKD Loss: 3.7912
Epoch: 0|  Loss:  6.1741 |Global loss: 6.2912| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7907
Epoch: 1|  Loss:  6.1658 |Global loss: 6.2946| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 3.7914
Epoch: 2|  Loss:  6.1562 |Global loss: 6.2938| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 3.7916
Epoch: 3|  Loss:  6.1401 |Global loss: 6.2956| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 0|  NKD Loss: 3.7957
Epoch: 0|  Loss:  6.0799 |Global loss: 6.2988| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.0676 |Global loss: 6.2994| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 3.7986
Epoch: 2|  Loss:  6.0526 |Global loss: 6.3015| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 3.7989
Epoch: 3|  Loss:  6.0347 |Global loss: 6.3021| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 0|  NKD Loss: 3.7906
Epoch: 0|  Loss:  6.1874 |Global loss: 6.2904| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 3.7906
Epoch: 1|  Loss:  6.1745 |Global loss: 6.289| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 3.79
Epoch: 2|  Loss:  6.1646 |Global loss: 6.2908| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 3.7903
Epoch: 3|  Loss:  6.1514 |Global loss: 6.2901| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7905
Epoch: 0|  Loss:  6.2004 |Global loss: 6.2923| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 3.7908
Epoch: 1|  Loss:  6.1891 |Global loss: 6.2885| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 3.7902
Epoch: 2|  Loss:  6.1808 |Global loss: 6.2892| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 3.7898
Epoch: 3|  Loss:  6.1722 |Global loss: 6.292| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 3.7945
Epoch: 0|  Loss:  6.1306 |Global loss: 6.2974| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 3.796
Epoch: 1|  Loss:  6.1169 |Global loss: 6.2969| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 3.7963
Epoch: 2|  Loss:  6.1011 |Global loss: 6.2984| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 3|  NKD Loss: 3.7974
Epoch: 3|  Loss:  6.0919 |Global loss: 6.2988| Local H loss: 0.0114  | Global H loss: 0.0114
------------------------- time cost ------------------------- 4.92108416557312
Chosen Clients:  [13, 0, 9, 12, 5, 10]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.375, 0.25, 0.192, 0.267, 0.242, 0.258, 0.4, 0.2, 0.383, 0.267, 0.525, 0.342, 0.25, 0.15, 0.067]
AUC in each clients:  [105.676, 90.277, 98.511, 94.447, 97.636, 93.047, 95.642, 96.263, 88.32, 100.767, 107.346, 102.102, 95.787, 80.661, 80.483]
F1 Score:  [0.311, 0.176, 0.13, 0.174, 0.169, 0.153, 0.351, 0.09, 0.277, 0.165, 0.425, 0.258, 0.17, 0.082, 0.01]
Recall Score:  [0.427, 0.333, 0.25, 0.324, 0.296, 0.324, 0.477, 0.25, 0.398, 0.35, 0.557, 0.435, 0.333, 0.188, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1091
Averaged Test Accurancy: 0.2778
Averaged Test AUC: 0.7928
Averaged Test F1_score: 0.1961
Averaged Test Recal score: 0.3350
Std Test Accurancy: 0.1091
Std Test AUC: 0.0631
Std Test F1: 0.0009
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 3.7927
Epoch: 0|  Loss:  6.2459 |Global loss: 6.2911| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7913
Epoch: 1|  Loss:  6.24 |Global loss: 6.2922| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7908
Epoch: 2|  Loss:  6.2293 |Global loss: 6.288| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 3.7893
Epoch: 3|  Loss:  6.2231 |Global loss: 6.2905| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7953
Epoch: 0|  Loss:  6.0133 |Global loss: 6.2989| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 1|  NKD Loss: 3.7968
Epoch: 1|  Loss:  5.9867 |Global loss: 6.2965| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  5.9765 |Global loss: 6.3041| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 3|  NKD Loss: 3.7996
Epoch: 3|  Loss:  5.9586 |Global loss: 6.306| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 3.7965
Epoch: 0|  Loss:  6.0638 |Global loss: 6.2975| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 1|  NKD Loss: 3.7971
Epoch: 1|  Loss:  6.053 |Global loss: 6.3001| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 3.7984
Epoch: 2|  Loss:  6.0345 |Global loss: 6.299| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 3.7983
Epoch: 3|  Loss:  6.0239 |Global loss: 6.3009| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 0|  NKD Loss: 3.7972
Epoch: 0|  Loss:  6.1013 |Global loss: 6.2995| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 1|  NKD Loss: 3.7985
Epoch: 1|  Loss:  6.0905 |Global loss: 6.3023| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 2|  NKD Loss: 3.7988
Epoch: 2|  Loss:  6.0732 |Global loss: 6.3| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 3|  NKD Loss: 3.8003
Epoch: 3|  Loss:  6.0551 |Global loss: 6.3024| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 3.7908
Epoch: 0|  Loss:  6.1406 |Global loss: 6.2898| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7906
Epoch: 1|  Loss:  6.1301 |Global loss: 6.2926| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7905
Epoch: 2|  Loss:  6.1153 |Global loss: 6.2918| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 3.7917
Epoch: 3|  Loss:  6.1035 |Global loss: 6.2931| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 3.8033
Epoch: 0|  Loss:  5.9799 |Global loss: 6.3117| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 1|  NKD Loss: 3.8058
Epoch: 1|  Loss:  5.9615 |Global loss: 6.3108| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 2|  NKD Loss: 3.8061
Epoch: 2|  Loss:  5.9397 |Global loss: 6.3121| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 3|  NKD Loss: 3.8063
Epoch: 3|  Loss:  5.9358 |Global loss: 6.3114| Local H loss: 0.0139  | Global H loss: 0.0139
------------------------- time cost ------------------------- 4.795330286026001
Chosen Clients:  [12, 1, 4, 9, 7, 13]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.192, 0.267, 0.242, 0.267, 0.4, 0.2, 0.383, 0.317, 0.533, 0.342, 0.267, 0.2, 0.067]
AUC in each clients:  [106.988, 90.277, 98.511, 94.447, 97.636, 95.215, 95.642, 96.263, 88.32, 102.419, 108.839, 102.102, 97.693, 85.011, 80.483]
F1 Score:  [0.329, 0.176, 0.13, 0.174, 0.169, 0.158, 0.351, 0.09, 0.277, 0.228, 0.425, 0.258, 0.203, 0.129, 0.01]
Recall Score:  [0.484, 0.333, 0.25, 0.324, 0.296, 0.333, 0.477, 0.25, 0.398, 0.398, 0.564, 0.435, 0.352, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0850
Averaged Test Accurancy: 0.2900
Averaged Test AUC: 0.7999
Averaged Test F1_score: 0.2071
Averaged Test Recal score: 0.3485
Std Test Accurancy: 0.1104
Std Test AUC: 0.0621
Std Test F1: 0.0009
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 3.8007
Epoch: 0|  Loss:  6.0544 |Global loss: 6.308| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 1|  NKD Loss: 3.8011
Epoch: 1|  Loss:  6.0355 |Global loss: 6.3048| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 2|  NKD Loss: 3.7998
Epoch: 2|  Loss:  6.0172 |Global loss: 6.3069| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 3.8007
Epoch: 3|  Loss:  6.0147 |Global loss: 6.3075| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 0|  NKD Loss: 3.789
Epoch: 0|  Loss:  6.1559 |Global loss: 6.2904| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.789
Epoch: 1|  Loss:  6.144 |Global loss: 6.2905| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 3.7894
Epoch: 2|  Loss:  6.1331 |Global loss: 6.2925| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7907
Epoch: 3|  Loss:  6.1184 |Global loss: 6.2902| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.0547 |Global loss: 6.3002| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.7966
Epoch: 1|  Loss:  6.041 |Global loss: 6.2979| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 3.7968
Epoch: 2|  Loss:  6.0336 |Global loss: 6.3024| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 3.7967
Epoch: 3|  Loss:  6.0109 |Global loss: 6.3035| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 3.7998
Epoch: 0|  Loss:  6.0017 |Global loss: 6.3074| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  5.9883 |Global loss: 6.3033| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  5.9716 |Global loss: 6.3063| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 3|  NKD Loss: 3.8032
Epoch: 3|  Loss:  5.9638 |Global loss: 6.3046| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 3.7912
Epoch: 0|  Loss:  6.121 |Global loss: 6.2942| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.7918
Epoch: 1|  Loss:  6.1088 |Global loss: 6.2954| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 3.7931
Epoch: 2|  Loss:  6.0889 |Global loss: 6.2936| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 3|  NKD Loss: 3.7943
Epoch: 3|  Loss:  6.0762 |Global loss: 6.2969| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 3.7885
Epoch: 0|  Loss:  6.2137 |Global loss: 6.2882| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7865
Epoch: 1|  Loss:  6.2034 |Global loss: 6.2923| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.7869
Epoch: 2|  Loss:  6.1907 |Global loss: 6.287| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.786
Epoch: 3|  Loss:  6.1814 |Global loss: 6.2879| Local H loss: 0.01  | Global H loss: 0.01
------------------------- time cost ------------------------- 4.849134683609009
Chosen Clients:  [12, 11, 9, 3, 2, 0]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.192, 0.267, 0.292, 0.267, 0.4, 0.142, 0.383, 0.408, 0.533, 0.342, 0.317, 0.2, 0.067]
AUC in each clients:  [106.988, 91.845, 98.511, 94.447, 99.464, 95.215, 95.642, 98.223, 88.32, 104.639, 108.839, 102.102, 100.742, 89.005, 80.483]
F1 Score:  [0.329, 0.173, 0.13, 0.174, 0.237, 0.158, 0.351, 0.041, 0.277, 0.301, 0.425, 0.258, 0.232, 0.122, 0.01]
Recall Score:  [0.484, 0.333, 0.25, 0.324, 0.352, 0.333, 0.477, 0.167, 0.398, 0.484, 0.564, 0.435, 0.407, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0630
Averaged Test Accurancy: 0.2989
Averaged Test AUC: 0.8080
Averaged Test F1_score: 0.2145
Averaged Test Recal score: 0.3561
Std Test Accurancy: 0.1174
Std Test AUC: 0.0608
Std Test F1: 0.0009
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 3.8018
Epoch: 0|  Loss:  5.9917 |Global loss: 6.3076| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  5.9816 |Global loss: 6.3076| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 2|  NKD Loss: 3.8014
Epoch: 2|  Loss:  5.9664 |Global loss: 6.3086| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 3|  NKD Loss: 3.8011
Epoch: 3|  Loss:  5.9383 |Global loss: 6.3107| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 3.7974
Epoch: 0|  Loss:  6.0178 |Global loss: 6.3011| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 3.7983
Epoch: 1|  Loss:  5.999 |Global loss: 6.3029| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 3.7979
Epoch: 2|  Loss:  5.9807 |Global loss: 6.3054| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 3|  NKD Loss: 3.7998
Epoch: 3|  Loss:  5.9617 |Global loss: 6.3053| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 0|  NKD Loss: 3.8045
Epoch: 0|  Loss:  5.9455 |Global loss: 6.3079| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 1|  NKD Loss: 3.8035
Epoch: 1|  Loss:  5.9328 |Global loss: 6.3125| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 3.804
Epoch: 2|  Loss:  5.9115 |Global loss: 6.3113| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 3|  NKD Loss: 3.8031
Epoch: 3|  Loss:  5.8851 |Global loss: 6.3141| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 0|  NKD Loss: 3.7876
Epoch: 0|  Loss:  6.1214 |Global loss: 6.2931| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 3.7874
Epoch: 1|  Loss:  6.1072 |Global loss: 6.292| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 3.7871
Epoch: 2|  Loss:  6.0967 |Global loss: 6.293| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 3|  NKD Loss: 3.7867
Epoch: 3|  Loss:  6.08 |Global loss: 6.292| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 3.7951
Epoch: 0|  Loss:  6.0722 |Global loss: 6.2983| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 1|  NKD Loss: 3.7955
Epoch: 1|  Loss:  6.0609 |Global loss: 6.2987| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.0433 |Global loss: 6.3016| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 3|  NKD Loss: 3.7969
Epoch: 3|  Loss:  6.0307 |Global loss: 6.3019| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 3.799
Epoch: 0|  Loss:  5.932 |Global loss: 6.307| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 1|  NKD Loss: 3.8017
Epoch: 1|  Loss:  5.9296 |Global loss: 6.3134| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 3.8017
Epoch: 2|  Loss:  5.8981 |Global loss: 6.3086| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 3|  NKD Loss: 3.8032
Epoch: 3|  Loss:  5.8766 |Global loss: 6.3136| Local H loss: 0.0141  | Global H loss: 0.0141
------------------------- time cost ------------------------- 4.727553844451904
Chosen Clients:  [7, 13, 2, 11, 12, 5]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.192, 0.292, 0.292, 0.267, 0.4, 0.142, 0.383, 0.417, 0.533, 0.325, 0.383, 0.2, 0.067]
AUC in each clients:  [108.947, 91.845, 100.944, 96.186, 99.464, 95.215, 95.642, 98.223, 88.32, 107.09, 108.839, 103.553, 103.388, 89.005, 80.483]
F1 Score:  [0.319, 0.173, 0.104, 0.209, 0.237, 0.158, 0.351, 0.041, 0.277, 0.308, 0.425, 0.226, 0.319, 0.122, 0.01]
Recall Score:  [0.484, 0.333, 0.25, 0.345, 0.352, 0.333, 0.477, 0.167, 0.398, 0.493, 0.564, 0.417, 0.491, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0333
Averaged Test Accurancy: 0.3044
Averaged Test AUC: 0.8151
Averaged Test F1_score: 0.2186
Averaged Test Recal score: 0.3625
Std Test Accurancy: 0.1191
Std Test AUC: 0.0655
Std Test F1: 0.0010
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.0622 |Global loss: 6.2963| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 3.7938
Epoch: 1|  Loss:  6.0457 |Global loss: 6.2999| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 3.7947
Epoch: 2|  Loss:  6.0347 |Global loss: 6.3005| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 3.7963
Epoch: 3|  Loss:  6.0341 |Global loss: 6.2983| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 0|  NKD Loss: 3.7835
Epoch: 0|  Loss:  6.1704 |Global loss: 6.2888| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 3.7831
Epoch: 1|  Loss:  6.1544 |Global loss: 6.2859| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 3.7821
Epoch: 2|  Loss:  6.1382 |Global loss: 6.2872| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 3.7823
Epoch: 3|  Loss:  6.1291 |Global loss: 6.288| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 0|  NKD Loss: 3.7965
Epoch: 0|  Loss:  6.0157 |Global loss: 6.306| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 3.7967
Epoch: 1|  Loss:  5.9977 |Global loss: 6.3051| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 2|  NKD Loss: 3.7975
Epoch: 2|  Loss:  5.9906 |Global loss: 6.3076| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 3|  NKD Loss: 3.7973
Epoch: 3|  Loss:  5.9645 |Global loss: 6.3064| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 0|  NKD Loss: 3.8012
Epoch: 0|  Loss:  5.9491 |Global loss: 6.3092| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 3.8021
Epoch: 1|  Loss:  5.9222 |Global loss: 6.3097| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 2|  NKD Loss: 3.8026
Epoch: 2|  Loss:  5.9122 |Global loss: 6.3151| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 3.8023
Epoch: 3|  Loss:  5.8928 |Global loss: 6.3123| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 3.8028
Epoch: 0|  Loss:  5.941 |Global loss: 6.3132| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 3.8009
Epoch: 1|  Loss:  5.9004 |Global loss: 6.3127| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 2|  NKD Loss: 3.8034
Epoch: 2|  Loss:  5.888 |Global loss: 6.3159| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 3.8032
Epoch: 3|  Loss:  5.8619 |Global loss: 6.3119| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 0|  NKD Loss: 3.7875
Epoch: 0|  Loss:  6.0886 |Global loss: 6.2948| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.7881
Epoch: 1|  Loss:  6.0754 |Global loss: 6.2959| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 3.7892
Epoch: 2|  Loss:  6.0564 |Global loss: 6.2943| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 3|  NKD Loss: 3.7889
Epoch: 3|  Loss:  6.0387 |Global loss: 6.2961| Local H loss: 0.0107  | Global H loss: 0.0107
------------------------- time cost ------------------------- 5.28454065322876
Chosen Clients:  [1, 4, 7, 2, 10, 9]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.192, 0.292, 0.292, 0.258, 0.4, 0.167, 0.383, 0.417, 0.533, 0.375, 0.55, 0.217, 0.067]
AUC in each clients:  [108.947, 91.845, 102.603, 96.186, 99.464, 96.78, 95.642, 99.589, 88.32, 107.09, 108.839, 105.81, 105.582, 92.203, 80.483]
F1 Score:  [0.319, 0.173, 0.093, 0.209, 0.237, 0.155, 0.351, 0.105, 0.277, 0.308, 0.425, 0.299, 0.54, 0.154, 0.01]
Recall Score:  [0.484, 0.333, 0.25, 0.345, 0.352, 0.324, 0.477, 0.208, 0.398, 0.493, 0.564, 0.472, 0.65, 0.269, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0057
Averaged Test Accurancy: 0.3211
Averaged Test AUC: 0.8219
Averaged Test F1_score: 0.2437
Averaged Test Recal score: 0.3801
Std Test Accurancy: 0.1310
Std Test AUC: 0.0660
Std Test F1: 0.0011
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 3.7863
Epoch: 0|  Loss:  6.1013 |Global loss: 6.2924| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 3.7862
Epoch: 1|  Loss:  6.0922 |Global loss: 6.2982| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 3.7887
Epoch: 2|  Loss:  6.0799 |Global loss: 6.2947| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 3.7896
Epoch: 3|  Loss:  6.061 |Global loss: 6.2941| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 0|  NKD Loss: 3.7934
Epoch: 0|  Loss:  5.9914 |Global loss: 6.3013| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 3.794
Epoch: 1|  Loss:  5.9731 |Global loss: 6.3033| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 2|  NKD Loss: 3.7941
Epoch: 2|  Loss:  5.9553 |Global loss: 6.3016| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 3|  NKD Loss: 3.7944
Epoch: 3|  Loss:  5.9383 |Global loss: 6.3003| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 3.7951
Epoch: 0|  Loss:  6.0161 |Global loss: 6.3028| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 3.7969
Epoch: 1|  Loss:  6.0007 |Global loss: 6.3039| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 3.7952
Epoch: 2|  Loss:  5.9834 |Global loss: 6.3032| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 3.7962
Epoch: 3|  Loss:  5.9825 |Global loss: 6.3075| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 0|  NKD Loss: 3.7996
Epoch: 0|  Loss:  5.9601 |Global loss: 6.3082| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 3.7975
Epoch: 1|  Loss:  5.9321 |Global loss: 6.3092| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  5.9245 |Global loss: 6.3129| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 3|  NKD Loss: 3.7985
Epoch: 3|  Loss:  5.9017 |Global loss: 6.3084| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 0|  NKD Loss: 3.8035
Epoch: 0|  Loss:  5.9058 |Global loss: 6.3163| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 3.803
Epoch: 1|  Loss:  5.8746 |Global loss: 6.3135| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 2|  NKD Loss: 3.8023
Epoch: 2|  Loss:  5.8568 |Global loss: 6.32| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 3.8038
Epoch: 3|  Loss:  5.8385 |Global loss: 6.3188| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 0|  NKD Loss: 3.8028
Epoch: 0|  Loss:  5.8694 |Global loss: 6.3115| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 1|  NKD Loss: 3.8032
Epoch: 1|  Loss:  5.8459 |Global loss: 6.3108| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 2|  NKD Loss: 3.801
Epoch: 2|  Loss:  5.8263 |Global loss: 6.3147| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 3.8018
Epoch: 3|  Loss:  5.8023 |Global loss: 6.3176| Local H loss: 0.0161  | Global H loss: 0.0161
------------------------- time cost ------------------------- 4.8913352489471436
Chosen Clients:  [2, 5, 14, 6, 10, 1]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.217, 0.292, 0.425, 0.258, 0.4, 0.192, 0.383, 0.442, 0.508, 0.375, 0.55, 0.217, 0.067]
AUC in each clients:  [108.947, 93.289, 104.818, 96.186, 100.731, 96.78, 95.642, 101.048, 88.32, 109.32, 109.256, 105.81, 105.582, 92.203, 80.483]
F1 Score:  [0.319, 0.173, 0.136, 0.209, 0.353, 0.155, 0.351, 0.135, 0.277, 0.338, 0.442, 0.299, 0.54, 0.154, 0.01]
Recall Score:  [0.484, 0.333, 0.278, 0.345, 0.472, 0.324, 0.477, 0.25, 0.398, 0.51, 0.601, 0.472, 0.65, 0.269, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9765
Averaged Test Accurancy: 0.3333
Averaged Test AUC: 0.8269
Averaged Test F1_score: 0.2594
Averaged Test Recal score: 0.3964
Std Test Accurancy: 0.1285
Std Test AUC: 0.0681
Std Test F1: 0.0011
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 3.7992
Epoch: 0|  Loss:  5.8762 |Global loss: 6.3154| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 1|  NKD Loss: 3.8004
Epoch: 1|  Loss:  5.8573 |Global loss: 6.3164| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 2|  NKD Loss: 3.7985
Epoch: 2|  Loss:  5.839 |Global loss: 6.3147| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 3|  NKD Loss: 3.8017
Epoch: 3|  Loss:  5.8235 |Global loss: 6.313| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 3.7863
Epoch: 0|  Loss:  6.0287 |Global loss: 6.293| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 3.7861
Epoch: 1|  Loss:  6.0128 |Global loss: 6.295| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 3.7853
Epoch: 2|  Loss:  5.9954 |Global loss: 6.292| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 3.7843
Epoch: 3|  Loss:  5.9906 |Global loss: 6.2981| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 0|  NKD Loss: 3.7844
Epoch: 0|  Loss:  6.2351 |Global loss: 6.2962| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 3.7837
Epoch: 1|  Loss:  6.2247 |Global loss: 6.2888| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 3.7824
Epoch: 2|  Loss:  6.2156 |Global loss: 6.2842| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 3.7797
Epoch: 3|  Loss:  6.2051 |Global loss: 6.2855| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 3.7834
Epoch: 0|  Loss:  6.071 |Global loss: 6.291| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 3.7828
Epoch: 1|  Loss:  6.0506 |Global loss: 6.2887| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 2|  NKD Loss: 3.7811
Epoch: 2|  Loss:  6.0328 |Global loss: 6.2924| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 3|  NKD Loss: 3.7825
Epoch: 3|  Loss:  6.0149 |Global loss: 6.2886| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 0|  NKD Loss: 3.8047
Epoch: 0|  Loss:  5.8141 |Global loss: 6.3173| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 3.8047
Epoch: 1|  Loss:  5.8061 |Global loss: 6.3208| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 2|  NKD Loss: 3.8042
Epoch: 2|  Loss:  5.7675 |Global loss: 6.3182| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 3.8026
Epoch: 3|  Loss:  5.7451 |Global loss: 6.3222| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 0|  NKD Loss: 3.7893
Epoch: 0|  Loss:  6.0549 |Global loss: 6.3011| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.7905
Epoch: 1|  Loss:  6.0392 |Global loss: 6.3007| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 3.7902
Epoch: 2|  Loss:  6.0275 |Global loss: 6.2986| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 3|  NKD Loss: 3.7905
Epoch: 3|  Loss:  6.0129 |Global loss: 6.3005| Local H loss: 0.0116  | Global H loss: 0.0116
------------------------- time cost ------------------------- 4.824948072433472
Chosen Clients:  [13, 6, 7, 9, 14, 10]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.25, 0.292, 0.425, 0.258, 0.25, 0.192, 0.383, 0.442, 0.55, 0.375, 0.55, 0.217, 0.067]
AUC in each clients:  [108.947, 95.231, 106.448, 96.186, 100.731, 98.173, 95.077, 101.048, 88.32, 109.32, 110.325, 105.81, 105.582, 92.203, 82.459]
F1 Score:  [0.319, 0.182, 0.17, 0.209, 0.353, 0.155, 0.167, 0.135, 0.277, 0.338, 0.491, 0.299, 0.54, 0.154, 0.01]
Recall Score:  [0.484, 0.333, 0.31, 0.345, 0.472, 0.324, 0.333, 0.25, 0.398, 0.51, 0.647, 0.472, 0.65, 0.269, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9483
Averaged Test Accurancy: 0.3283
Averaged Test AUC: 0.8310
Averaged Test F1_score: 0.2533
Averaged Test Recal score: 0.3920
Std Test Accurancy: 0.1315
Std Test AUC: 0.0663
Std Test F1: 0.0011
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 3.7755
Epoch: 0|  Loss:  6.1035 |Global loss: 6.2855| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 3.7747
Epoch: 1|  Loss:  6.0864 |Global loss: 6.2847| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 2|  NKD Loss: 3.774
Epoch: 2|  Loss:  6.0708 |Global loss: 6.2842| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 3|  NKD Loss: 3.7716
Epoch: 3|  Loss:  6.0493 |Global loss: 6.2844| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 3.7813
Epoch: 0|  Loss:  5.9945 |Global loss: 6.2935| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 3.7801
Epoch: 1|  Loss:  5.9894 |Global loss: 6.294| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 3.7798
Epoch: 2|  Loss:  5.9591 |Global loss: 6.2959| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 3|  NKD Loss: 3.7801
Epoch: 3|  Loss:  5.9446 |Global loss: 6.2942| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 0|  NKD Loss: 3.7927
Epoch: 0|  Loss:  5.959 |Global loss: 6.3035| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 3.7907
Epoch: 1|  Loss:  5.944 |Global loss: 6.3025| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 2|  NKD Loss: 3.7895
Epoch: 2|  Loss:  5.9278 |Global loss: 6.3038| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 3|  NKD Loss: 3.7876
Epoch: 3|  Loss:  5.9112 |Global loss: 6.3046| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 0|  NKD Loss: 3.798
Epoch: 0|  Loss:  5.7881 |Global loss: 6.3137| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 1|  NKD Loss: 3.7976
Epoch: 1|  Loss:  5.7743 |Global loss: 6.3194| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 2|  NKD Loss: 3.7949
Epoch: 2|  Loss:  5.7331 |Global loss: 6.3133| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 3.7957
Epoch: 3|  Loss:  5.724 |Global loss: 6.3133| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 0|  NKD Loss: 3.7757
Epoch: 0|  Loss:  6.1932 |Global loss: 6.2877| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 3.7741
Epoch: 1|  Loss:  6.1829 |Global loss: 6.2862| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 3.7725
Epoch: 2|  Loss:  6.1707 |Global loss: 6.2859| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 3.7725
Epoch: 3|  Loss:  6.1545 |Global loss: 6.2777| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 3.8049
Epoch: 0|  Loss:  5.7343 |Global loss: 6.3235| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 1|  NKD Loss: 3.8033
Epoch: 1|  Loss:  5.714 |Global loss: 6.3269| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 3.8015
Epoch: 2|  Loss:  5.6858 |Global loss: 6.3234| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 3.7979
Epoch: 3|  Loss:  5.6568 |Global loss: 6.3223| Local H loss: 0.0184  | Global H loss: 0.0184
------------------------- time cost ------------------------- 4.902294635772705
Chosen Clients:  [10, 7, 1, 4, 8, 12]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.25, 0.292, 0.425, 0.258, 0.25, 0.283, 0.383, 0.525, 0.633, 0.375, 0.55, 0.217, 0.067]
AUC in each clients:  [108.947, 95.231, 106.448, 96.186, 100.731, 98.173, 96.53, 103.336, 88.32, 110.745, 111.55, 105.81, 105.582, 92.911, 84.354]
F1 Score:  [0.319, 0.182, 0.17, 0.209, 0.353, 0.155, 0.167, 0.193, 0.277, 0.418, 0.611, 0.299, 0.54, 0.128, 0.011]
Recall Score:  [0.484, 0.333, 0.31, 0.345, 0.472, 0.324, 0.333, 0.326, 0.398, 0.565, 0.73, 0.472, 0.65, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9143
Averaged Test Accurancy: 0.3456
Averaged Test AUC: 0.8360
Averaged Test F1_score: 0.2688
Averaged Test Recal score: 0.4050
Std Test Accurancy: 0.1433
Std Test AUC: 0.0656
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 3.8015
Epoch: 0|  Loss:  5.641 |Global loss: 6.3207| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 1|  NKD Loss: 3.7975
Epoch: 1|  Loss:  5.601 |Global loss: 6.3205| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 3.7925
Epoch: 2|  Loss:  5.5767 |Global loss: 6.3263| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 3|  NKD Loss: 3.7904
Epoch: 3|  Loss:  5.5451 |Global loss: 6.3185| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 0|  NKD Loss: 3.7891
Epoch: 0|  Loss:  5.8929 |Global loss: 6.3029| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 1|  NKD Loss: 3.7858
Epoch: 1|  Loss:  5.8821 |Global loss: 6.3051| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 3.7837
Epoch: 2|  Loss:  5.86 |Global loss: 6.3036| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 3|  NKD Loss: 3.7814
Epoch: 3|  Loss:  5.8462 |Global loss: 6.3032| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 0|  NKD Loss: 3.787
Epoch: 0|  Loss:  5.9998 |Global loss: 6.2988| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 1|  NKD Loss: 3.7855
Epoch: 1|  Loss:  5.9903 |Global loss: 6.297| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 2|  NKD Loss: 3.7833
Epoch: 2|  Loss:  5.9741 |Global loss: 6.3036| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 3|  NKD Loss: 3.7815
Epoch: 3|  Loss:  5.9684 |Global loss: 6.2989| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 3.7857
Epoch: 0|  Loss:  5.9141 |Global loss: 6.3024| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 3.7836
Epoch: 1|  Loss:  5.8965 |Global loss: 6.2975| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 2|  NKD Loss: 3.7816
Epoch: 2|  Loss:  5.8726 |Global loss: 6.2959| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 3|  NKD Loss: 3.7791
Epoch: 3|  Loss:  5.863 |Global loss: 6.2998| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 0|  NKD Loss: 3.783
Epoch: 0|  Loss:  6.204 |Global loss: 6.2907| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 3.7795
Epoch: 1|  Loss:  6.194 |Global loss: 6.2895| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 3.7758
Epoch: 2|  Loss:  6.1812 |Global loss: 6.2882| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 3.7727
Epoch: 3|  Loss:  6.1656 |Global loss: 6.2864| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 3.7919
Epoch: 0|  Loss:  5.831 |Global loss: 6.3142| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 3.7895
Epoch: 1|  Loss:  5.801 |Global loss: 6.312| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 2|  NKD Loss: 3.7906
Epoch: 2|  Loss:  5.7856 |Global loss: 6.3165| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 3.7895
Epoch: 3|  Loss:  5.7568 |Global loss: 6.3117| Local H loss: 0.0172  | Global H loss: 0.0172
------------------------- time cost ------------------------- 4.8827385902404785
Chosen Clients:  [2, 14, 0, 7, 9, 3]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.25, 0.292, 0.433, 0.258, 0.25, 0.358, 0.142, 0.525, 0.633, 0.375, 0.55, 0.217, 0.067]
AUC in each clients:  [108.947, 97.308, 106.448, 96.186, 102.008, 98.173, 96.53, 106.3, 87.727, 110.745, 112.859, 105.81, 106.102, 92.911, 84.354]
F1 Score:  [0.319, 0.186, 0.17, 0.209, 0.357, 0.155, 0.167, 0.29, 0.045, 0.418, 0.611, 0.299, 0.544, 0.128, 0.011]
Recall Score:  [0.484, 0.333, 0.31, 0.345, 0.479, 0.324, 0.333, 0.41, 0.167, 0.565, 0.73, 0.472, 0.65, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.8816
Averaged Test Accurancy: 0.3350
Averaged Test AUC: 0.8402
Averaged Test F1_score: 0.2606
Averaged Test Recal score: 0.3957
Std Test Accurancy: 0.1514
Std Test AUC: 0.0677
Std Test F1: 0.0014
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 3.7912
Epoch: 0|  Loss:  5.7954 |Global loss: 6.3215| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 1|  NKD Loss: 3.7862
Epoch: 1|  Loss:  5.7666 |Global loss: 6.313| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 3.7877
Epoch: 2|  Loss:  5.7552 |Global loss: 6.3093| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 3|  NKD Loss: 3.7825
Epoch: 3|  Loss:  5.7311 |Global loss: 6.3122| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 0|  NKD Loss: 3.7635
Epoch: 0|  Loss:  6.136 |Global loss: 6.2813| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 3.7612
Epoch: 1|  Loss:  6.1223 |Global loss: 6.2797| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 2|  NKD Loss: 3.7583
Epoch: 2|  Loss:  6.107 |Global loss: 6.2809| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 3.7569
Epoch: 3|  Loss:  6.0861 |Global loss: 6.2752| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 3.7857
Epoch: 0|  Loss:  5.8325 |Global loss: 6.3097| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 3.783
Epoch: 1|  Loss:  5.8166 |Global loss: 6.3071| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 2|  NKD Loss: 3.7815
Epoch: 2|  Loss:  5.7881 |Global loss: 6.3029| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 3|  NKD Loss: 3.7766
Epoch: 3|  Loss:  5.768 |Global loss: 6.3029| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 0|  NKD Loss: 3.7811
Epoch: 0|  Loss:  5.8286 |Global loss: 6.313| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 1|  NKD Loss: 3.7791
Epoch: 1|  Loss:  5.8125 |Global loss: 6.301| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 3.7766
Epoch: 2|  Loss:  5.7878 |Global loss: 6.3033| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 3|  NKD Loss: 3.7761
Epoch: 3|  Loss:  5.7635 |Global loss: 6.2987| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 0|  NKD Loss: 3.7866
Epoch: 0|  Loss:  5.685 |Global loss: 6.3141| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 3.7838
Epoch: 1|  Loss:  5.6531 |Global loss: 6.3141| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 3.7814
Epoch: 2|  Loss:  5.6366 |Global loss: 6.3069| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 3|  NKD Loss: 3.7756
Epoch: 3|  Loss:  5.5974 |Global loss: 6.302| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 0|  NKD Loss: 3.7698
Epoch: 0|  Loss:  6.0441 |Global loss: 6.2897| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 3.7665
Epoch: 1|  Loss:  6.0264 |Global loss: 6.2885| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 2|  NKD Loss: 3.7639
Epoch: 2|  Loss:  6.0125 |Global loss: 6.2844| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 3.7617
Epoch: 3|  Loss:  5.9898 |Global loss: 6.2804| Local H loss: 0.0131  | Global H loss: 0.0131
------------------------- time cost ------------------------- 4.941197156906128
Chosen Clients:  [3, 9, 12, 2, 11, 10]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.317, 0.267, 0.433, 0.258, 0.25, 0.383, 0.142, 0.542, 0.633, 0.375, 0.55, 0.217, 0.25]
AUC in each clients:  [108.961, 97.308, 107.911, 94.689, 102.008, 98.173, 96.53, 108.098, 87.727, 112.296, 112.859, 105.81, 106.102, 92.911, 86.886]
F1 Score:  [0.321, 0.186, 0.225, 0.204, 0.357, 0.155, 0.167, 0.284, 0.045, 0.44, 0.611, 0.299, 0.544, 0.128, 0.223]
Recall Score:  [0.484, 0.333, 0.367, 0.324, 0.479, 0.324, 0.333, 0.445, 0.167, 0.576, 0.73, 0.472, 0.65, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.8419
Averaged Test Accurancy: 0.3528
Averaged Test AUC: 0.8435
Averaged Test F1_score: 0.2793
Averaged Test Recal score: 0.4171
Std Test Accurancy: 0.1363
Std Test AUC: 0.0681
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 3.7577
Epoch: 0|  Loss:  5.9614 |Global loss: 6.2829| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 1|  NKD Loss: 3.7544
Epoch: 1|  Loss:  5.9479 |Global loss: 6.2806| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 2|  NKD Loss: 3.7507
Epoch: 2|  Loss:  5.9243 |Global loss: 6.2765| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 3|  NKD Loss: 3.7454
Epoch: 3|  Loss:  5.9005 |Global loss: 6.2807| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 3.7748
Epoch: 0|  Loss:  5.5717 |Global loss: 6.3082| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 1|  NKD Loss: 3.7695
Epoch: 1|  Loss:  5.5462 |Global loss: 6.308| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 2|  NKD Loss: 3.7638
Epoch: 2|  Loss:  5.499 |Global loss: 6.3074| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 3|  NKD Loss: 3.7587
Epoch: 3|  Loss:  5.4663 |Global loss: 6.3009| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 0|  NKD Loss: 3.7798
Epoch: 0|  Loss:  5.7338 |Global loss: 6.3113| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 3.7818
Epoch: 1|  Loss:  5.7284 |Global loss: 6.3124| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 3.7725
Epoch: 2|  Loss:  5.6709 |Global loss: 6.3068| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 3|  NKD Loss: 3.7679
Epoch: 3|  Loss:  5.6461 |Global loss: 6.3037| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 0|  NKD Loss: 3.782
Epoch: 0|  Loss:  5.7053 |Global loss: 6.3163| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 1|  NKD Loss: 3.7795
Epoch: 1|  Loss:  5.7018 |Global loss: 6.3157| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 3.7731
Epoch: 2|  Loss:  5.6691 |Global loss: 6.3111| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 3|  NKD Loss: 3.7714
Epoch: 3|  Loss:  5.645 |Global loss: 6.3083| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 0|  NKD Loss: 3.7816
Epoch: 0|  Loss:  5.8431 |Global loss: 6.3077| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 3.7771
Epoch: 1|  Loss:  5.8121 |Global loss: 6.3053| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 3.772
Epoch: 2|  Loss:  5.8043 |Global loss: 6.3073| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 3|  NKD Loss: 3.7691
Epoch: 3|  Loss:  5.7765 |Global loss: 6.3001| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 3.7848
Epoch: 0|  Loss:  5.5292 |Global loss: 6.3164| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 1|  NKD Loss: 3.7788
Epoch: 1|  Loss:  5.5116 |Global loss: 6.3139| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 3.7713
Epoch: 2|  Loss:  5.4779 |Global loss: 6.3143| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 3.7638
Epoch: 3|  Loss:  5.4288 |Global loss: 6.3094| Local H loss: 0.0213  | Global H loss: 0.0213
------------------------- time cost ------------------------- 5.036613702774048
Chosen Clients:  [7, 11, 9, 1, 0, 3]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.25, 0.325, 0.267, 0.433, 0.258, 0.25, 0.383, 0.142, 0.55, 0.633, 0.392, 0.55, 0.217, 0.25]
AUC in each clients:  [108.961, 97.308, 109.298, 96.403, 102.008, 98.173, 96.53, 108.098, 87.727, 113.526, 113.452, 105.164, 107.047, 92.911, 86.886]
F1 Score:  [0.321, 0.186, 0.234, 0.204, 0.357, 0.155, 0.167, 0.284, 0.045, 0.479, 0.611, 0.337, 0.542, 0.128, 0.223]
Recall Score:  [0.484, 0.333, 0.375, 0.324, 0.479, 0.324, 0.333, 0.445, 0.167, 0.588, 0.73, 0.491, 0.65, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.7902
Averaged Test Accurancy: 0.3550
Averaged Test AUC: 0.8464
Averaged Test F1_score: 0.2849
Averaged Test Recal score: 0.4197
Std Test Accurancy: 0.1372
Std Test AUC: 0.0697
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 3.7573
Epoch: 0|  Loss:  5.7249 |Global loss: 6.2962| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 3.7522
Epoch: 1|  Loss:  5.6983 |Global loss: 6.2895| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 2|  NKD Loss: 3.7439
Epoch: 2|  Loss:  5.6542 |Global loss: 6.2966| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 3.7366
Epoch: 3|  Loss:  5.6317 |Global loss: 6.2798| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 0|  NKD Loss: 3.7629
Epoch: 0|  Loss:  5.7475 |Global loss: 6.3041| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 1|  NKD Loss: 3.756
Epoch: 1|  Loss:  5.7125 |Global loss: 6.3011| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 3.7485
Epoch: 2|  Loss:  5.6899 |Global loss: 6.2986| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 3.7388
Epoch: 3|  Loss:  5.6637 |Global loss: 6.2891| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 0|  NKD Loss: 3.7545
Epoch: 0|  Loss:  5.4097 |Global loss: 6.2968| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 3.7465
Epoch: 1|  Loss:  5.3908 |Global loss: 6.2928| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 2|  NKD Loss: 3.7383
Epoch: 2|  Loss:  5.3588 |Global loss: 6.296| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 3.7218
Epoch: 3|  Loss:  5.273 |Global loss: 6.285| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 3.7604
Epoch: 0|  Loss:  5.9303 |Global loss: 6.2932| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 1|  NKD Loss: 3.7544
Epoch: 1|  Loss:  5.9109 |Global loss: 6.2843| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 2|  NKD Loss: 3.7471
Epoch: 2|  Loss:  5.8903 |Global loss: 6.2818| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 3|  NKD Loss: 3.7394
Epoch: 3|  Loss:  5.8695 |Global loss: 6.2783| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 0|  NKD Loss: 3.7599
Epoch: 0|  Loss:  5.7347 |Global loss: 6.2956| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 3.7544
Epoch: 1|  Loss:  5.7507 |Global loss: 6.2999| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 3.7439
Epoch: 2|  Loss:  5.6657 |Global loss: 6.2831| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 3|  NKD Loss: 3.7377
Epoch: 3|  Loss:  5.6525 |Global loss: 6.2848| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 0|  NKD Loss: 3.7407
Epoch: 0|  Loss:  5.8716 |Global loss: 6.2825| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 1|  NKD Loss: 3.7352
Epoch: 1|  Loss:  5.861 |Global loss: 6.2792| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 2|  NKD Loss: 3.7287
Epoch: 2|  Loss:  5.8281 |Global loss: 6.2757| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 3.72
Epoch: 3|  Loss:  5.791 |Global loss: 6.2669| Local H loss: 0.0153  | Global H loss: 0.0153
------------------------- time cost ------------------------- 4.7369701862335205
Chosen Clients:  [8, 4, 10, 6, 0, 1]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.442, 0.192, 0.325, 0.267, 0.433, 0.258, 0.25, 0.417, 0.142, 0.758, 0.633, 0.483, 0.55, 0.217, 0.25]
AUC in each clients:  [108.298, 98.53, 109.298, 99.18, 102.008, 98.173, 96.53, 109.138, 87.727, 115.537, 113.452, 106.591, 107.047, 92.911, 86.886]
F1 Score:  [0.361, 0.135, 0.234, 0.204, 0.357, 0.155, 0.167, 0.308, 0.045, 0.678, 0.611, 0.433, 0.542, 0.128, 0.223]
Recall Score:  [0.512, 0.25, 0.375, 0.324, 0.479, 0.324, 0.333, 0.493, 0.167, 0.744, 0.73, 0.567, 0.65, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.7358
Averaged Test Accurancy: 0.3744
Averaged Test AUC: 0.8507
Averaged Test F1_score: 0.3054
Averaged Test Recal score: 0.4347
Std Test Accurancy: 0.1708
Std Test AUC: 0.0708
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 3.7437
Epoch: 0|  Loss:  6.1221 |Global loss: 6.2832| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 3.7297
Epoch: 1|  Loss:  6.0963 |Global loss: 6.2784| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 3.7183
Epoch: 2|  Loss:  6.0736 |Global loss: 6.2679| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 3.7074
Epoch: 3|  Loss:  6.053 |Global loss: 6.2632| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 0|  NKD Loss: 3.7381
Epoch: 0|  Loss:  5.7937 |Global loss: 6.2893| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 1|  NKD Loss: 3.7214
Epoch: 1|  Loss:  5.7597 |Global loss: 6.2804| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 3.7088
Epoch: 2|  Loss:  5.7235 |Global loss: 6.267| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 3|  NKD Loss: 3.693
Epoch: 3|  Loss:  5.6834 |Global loss: 6.2633| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 0|  NKD Loss: 3.7353
Epoch: 0|  Loss:  5.3784 |Global loss: 6.3011| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 3.7216
Epoch: 1|  Loss:  5.3602 |Global loss: 6.2942| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 3.7045
Epoch: 2|  Loss:  5.324 |Global loss: 6.2833| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 3.6765
Epoch: 3|  Loss:  5.2679 |Global loss: 6.2713| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 3.7333
Epoch: 0|  Loss:  5.875 |Global loss: 6.2835| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 3.7182
Epoch: 1|  Loss:  5.8429 |Global loss: 6.2738| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 2|  NKD Loss: 3.7046
Epoch: 2|  Loss:  5.7992 |Global loss: 6.2566| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 3|  NKD Loss: 3.6886
Epoch: 3|  Loss:  5.7665 |Global loss: 6.2545| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 0|  NKD Loss: 3.7257
Epoch: 0|  Loss:  5.639 |Global loss: 6.2875| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 3.7115
Epoch: 1|  Loss:  5.5902 |Global loss: 6.2689| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 3.6971
Epoch: 2|  Loss:  5.5628 |Global loss: 6.2699| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 3|  NKD Loss: 3.6805
Epoch: 3|  Loss:  5.5134 |Global loss: 6.256| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 0|  NKD Loss: 3.7277
Epoch: 0|  Loss:  5.8449 |Global loss: 6.2762| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 3.715
Epoch: 1|  Loss:  5.8269 |Global loss: 6.2716| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 2|  NKD Loss: 3.7019
Epoch: 2|  Loss:  5.7943 |Global loss: 6.256| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 3|  NKD Loss: 3.6794
Epoch: 3|  Loss:  5.7609 |Global loss: 6.2536| Local H loss: 0.0141  | Global H loss: 0.0141
------------------------- time cost ------------------------- 4.9793782234191895
Chosen Clients:  [7, 6, 5, 8, 1, 12]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.192, 0.325, 0.267, 0.342, 0.258, 0.25, 0.417, 0.067, 0.758, 0.567, 0.483, 0.55, 0.217, 0.25]
AUC in each clients:  [108.037, 99.201, 109.298, 99.18, 103.069, 98.173, 94.038, 109.138, 84.542, 115.537, 111.92, 106.591, 107.047, 92.911, 86.886]
F1 Score:  [0.363, 0.142, 0.234, 0.204, 0.304, 0.155, 0.204, 0.308, 0.01, 0.678, 0.513, 0.433, 0.542, 0.128, 0.223]
Recall Score:  [0.484, 0.25, 0.375, 0.324, 0.407, 0.324, 0.333, 0.493, 0.083, 0.744, 0.656, 0.567, 0.65, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.6677
Averaged Test Accurancy: 0.3578
Averaged Test AUC: 0.8475
Averaged Test F1_score: 0.2961
Averaged Test Recal score: 0.4175
Std Test Accurancy: 0.1712
Std Test AUC: 0.0739
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 3.6957
Epoch: 0|  Loss:  5.5598 |Global loss: 6.2684| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 1|  NKD Loss: 3.6687
Epoch: 1|  Loss:  5.5244 |Global loss: 6.2626| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 3.6356
Epoch: 2|  Loss:  5.4738 |Global loss: 6.2421| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 3|  NKD Loss: 3.5881
Epoch: 3|  Loss:  5.4046 |Global loss: 6.218| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 3.6736
Epoch: 0|  Loss:  5.7384 |Global loss: 6.2449| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 3.6435
Epoch: 1|  Loss:  5.6969 |Global loss: 6.2393| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 2|  NKD Loss: 3.6087
Epoch: 2|  Loss:  5.6328 |Global loss: 6.2165| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 3.5535
Epoch: 3|  Loss:  5.5672 |Global loss: 6.1903| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 3.708
Epoch: 0|  Loss:  5.8944 |Global loss: 6.2761| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 3.6729
Epoch: 1|  Loss:  5.8533 |Global loss: 6.2469| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 3.6401
Epoch: 2|  Loss:  5.8175 |Global loss: 6.2346| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 3|  NKD Loss: 3.6044
Epoch: 3|  Loss:  5.7708 |Global loss: 6.2153| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 3.6795
Epoch: 0|  Loss:  6.0072 |Global loss: 6.2522| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 1|  NKD Loss: 3.66
Epoch: 1|  Loss:  5.9708 |Global loss: 6.2308| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 2|  NKD Loss: 3.6312
Epoch: 2|  Loss:  5.9387 |Global loss: 6.2219| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 3|  NKD Loss: 3.5959
Epoch: 3|  Loss:  5.8984 |Global loss: 6.2066| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 3.6775
Epoch: 0|  Loss:  5.7459 |Global loss: 6.258| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 1|  NKD Loss: 3.6525
Epoch: 1|  Loss:  5.7097 |Global loss: 6.2404| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 3.6194
Epoch: 2|  Loss:  5.6461 |Global loss: 6.2196| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 3|  NKD Loss: 3.5692
Epoch: 3|  Loss:  5.5789 |Global loss: 6.194| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 0|  NKD Loss: 3.7089
Epoch: 0|  Loss:  5.5732 |Global loss: 6.2896| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 1|  NKD Loss: 3.6854
Epoch: 1|  Loss:  5.5182 |Global loss: 6.265| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 2|  NKD Loss: 3.6548
Epoch: 2|  Loss:  5.4683 |Global loss: 6.2532| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 3.6163
Epoch: 3|  Loss:  5.4203 |Global loss: 6.2337| Local H loss: 0.0208  | Global H loss: 0.0208
------------------------- time cost ------------------------- 4.86444616317749
Chosen Clients:  [12, 8, 9, 3, 7, 11]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.192, 0.325, 0.267, 0.342, 0.117, 0.125, 0.358, 0.067, 0.758, 0.567, 0.483, 0.45, 0.217, 0.25]
AUC in each clients:  [108.037, 101.005, 109.298, 99.18, 103.069, 92.129, 95.11, 108.188, 85.414, 115.537, 111.92, 106.591, 105.841, 92.911, 86.886]
F1 Score:  [0.363, 0.164, 0.234, 0.204, 0.304, 0.055, 0.084, 0.318, 0.01, 0.678, 0.513, 0.433, 0.475, 0.128, 0.223]
Recall Score:  [0.484, 0.25, 0.375, 0.324, 0.407, 0.167, 0.167, 0.41, 0.083, 0.744, 0.656, 0.567, 0.529, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.5554
Averaged Test Accurancy: 0.3294
Averaged Test AUC: 0.8451
Averaged Test F1_score: 0.2791
Averaged Test Recal score: 0.3824
Std Test Accurancy: 0.1801
Std Test AUC: 0.0740
Std Test F1: 0.0015
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 3.569
Epoch: 0|  Loss:  5.3619 |Global loss: 6.2198| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 3.4727
Epoch: 1|  Loss:  5.2386 |Global loss: 6.1698| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 3.2857
Epoch: 2|  Loss:  5.0444 |Global loss: 6.0762| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 2.6556
Epoch: 3|  Loss:  4.5366 |Global loss: 5.8295| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 0|  NKD Loss: 3.5456
Epoch: 0|  Loss:  5.8332 |Global loss: 6.1804| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 3.4536
Epoch: 1|  Loss:  5.7472 |Global loss: 6.1419| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 2|  NKD Loss: 3.2742
Epoch: 2|  Loss:  5.5884 |Global loss: 6.064| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 3|  NKD Loss: 2.7
Epoch: 3|  Loss:  5.1208 |Global loss: 5.8322| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 0|  NKD Loss: 3.5696
Epoch: 0|  Loss:  5.1144 |Global loss: 6.2235| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 3.4797
Epoch: 1|  Loss:  4.9889 |Global loss: 6.1708| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 3.3086
Epoch: 2|  Loss:  4.8012 |Global loss: 6.0913| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 2.7946
Epoch: 3|  Loss:  4.3678 |Global loss: 5.8751| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 3.5808
Epoch: 0|  Loss:  5.6566 |Global loss: 6.2205| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 1|  NKD Loss: 3.4985
Epoch: 1|  Loss:  5.5536 |Global loss: 6.1772| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 3.3613
Epoch: 2|  Loss:  5.4433 |Global loss: 6.1163| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 3|  NKD Loss: 3.0056
Epoch: 3|  Loss:  5.1037 |Global loss: 5.95| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 0|  NKD Loss: 3.5616
Epoch: 0|  Loss:  5.3398 |Global loss: 6.2008| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 3.4657
Epoch: 1|  Loss:  5.2208 |Global loss: 6.1608| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 2|  NKD Loss: 3.2587
Epoch: 2|  Loss:  5.032 |Global loss: 6.0643| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 3|  NKD Loss: 2.5871
Epoch: 3|  Loss:  4.4354 |Global loss: 5.7997| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 0|  NKD Loss: 3.5929
Epoch: 0|  Loss:  5.5015 |Global loss: 6.2372| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 1|  NKD Loss: 3.5064
Epoch: 1|  Loss:  5.4009 |Global loss: 6.1924| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 2|  NKD Loss: 3.3522
Epoch: 2|  Loss:  5.2284 |Global loss: 6.1164| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 3|  NKD Loss: 2.9047
Epoch: 3|  Loss:  4.8412 |Global loss: 5.9046| Local H loss: 0.0197  | Global H loss: 0.0197
------------------------- time cost ------------------------- 4.909144878387451
Chosen Clients:  [3, 10, 8, 7, 1, 6]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.192, 0.325, 0.133, 0.342, 0.117, 0.125, 0.067, 0.067, 0.242, 0.567, 0.067, 0.067, 0.217, 0.25]
AUC in each clients:  [108.037, 101.005, 109.298, 96.716, 103.069, 92.129, 95.11, 104.795, 84.286, 109.719, 111.92, 100.561, 102.145, 92.911, 86.886]
F1 Score:  [0.363, 0.164, 0.234, 0.09, 0.304, 0.055, 0.084, 0.01, 0.01, 0.258, 0.513, 0.01, 0.01, 0.128, 0.223]
Recall Score:  [0.484, 0.25, 0.375, 0.157, 0.407, 0.167, 0.167, 0.083, 0.083, 0.324, 0.656, 0.083, 0.083, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.1391
Averaged Test Accurancy: 0.2133
Averaged Test AUC: 0.8325
Averaged Test F1_score: 0.1637
Averaged Test Recal score: 0.2595
Std Test Accurancy: 0.1439
Std Test AUC: 0.0678
Std Test F1: 0.0012
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 2.179
Epoch: 0|  Loss:  4.4594 |Global loss: 5.6822| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.4039
Epoch: 1|  Loss:  3.915 |Global loss: 5.6196| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.3244
Epoch: 2|  Loss:  3.8139 |Global loss: 5.6159| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2957
Epoch: 3|  Loss:  3.729 |Global loss: 5.6047| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 0|  NKD Loss: 2.4872
Epoch: 0|  Loss:  4.2364 |Global loss: 5.844| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.4632
Epoch: 1|  Loss:  3.4872 |Global loss: 5.6154| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.2949
Epoch: 2|  Loss:  3.2854 |Global loss: 5.6382| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.2434
Epoch: 3|  Loss:  3.1202 |Global loss: 5.6434| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 2.0795
Epoch: 0|  Loss:  4.6741 |Global loss: 5.6311| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.3568
Epoch: 1|  Loss:  4.1765 |Global loss: 5.6211| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.3065
Epoch: 2|  Loss:  4.1183 |Global loss: 5.6229| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 3|  NKD Loss: 1.3044
Epoch: 3|  Loss:  4.0856 |Global loss: 5.6303| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 0|  NKD Loss: 2.0563
Epoch: 0|  Loss:  4.0089 |Global loss: 5.6555| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 1|  NKD Loss: 1.337
Epoch: 1|  Loss:  3.4948 |Global loss: 5.6581| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 2|  NKD Loss: 1.2681
Epoch: 2|  Loss:  3.3076 |Global loss: 5.6502| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 3|  NKD Loss: 1.2649
Epoch: 3|  Loss:  3.1999 |Global loss: 5.6675| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 0|  NKD Loss: 2.4842
Epoch: 0|  Loss:  4.6443 |Global loss: 5.82| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 1|  NKD Loss: 1.4594
Epoch: 1|  Loss:  3.9574 |Global loss: 5.6104| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 2|  NKD Loss: 1.289
Epoch: 2|  Loss:  3.8153 |Global loss: 5.6466| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.2885
Epoch: 3|  Loss:  3.7188 |Global loss: 5.6258| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 2.4251
Epoch: 0|  Loss:  4.5879 |Global loss: 5.7961| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 1|  NKD Loss: 1.4291
Epoch: 1|  Loss:  3.9253 |Global loss: 5.5983| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 2|  NKD Loss: 1.2954
Epoch: 2|  Loss:  3.758 |Global loss: 5.6187| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.2496
Epoch: 3|  Loss:  3.693 |Global loss: 5.6373| Local H loss: 0.0164  | Global H loss: 0.0164
------------------------- time cost ------------------------- 4.83104395866394
Chosen Clients:  [0, 8, 4, 3, 9, 14]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.067, 0.325, 0.067, 0.342, 0.117, 0.125, 0.067, 0.067, 0.242, 0.117, 0.067, 0.067, 0.217, 0.25]
AUC in each clients:  [108.037, 102.474, 109.298, 100.127, 103.069, 92.129, 97.174, 106.768, 90.601, 109.719, 106.736, 100.561, 102.145, 92.911, 86.886]
F1 Score:  [0.363, 0.01, 0.234, 0.01, 0.304, 0.055, 0.094, 0.01, 0.01, 0.258, 0.094, 0.01, 0.01, 0.128, 0.223]
Recall Score:  [0.484, 0.083, 0.375, 0.083, 0.407, 0.167, 0.167, 0.083, 0.083, 0.324, 0.167, 0.083, 0.083, 0.25, 0.323]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.5804
Averaged Test Accurancy: 0.1706
Averaged Test AUC: 0.8381
Averaged Test F1_score: 0.1209
Averaged Test Recal score: 0.2108
Std Test Accurancy: 0.1166
Std Test AUC: 0.0582
Std Test F1: 0.0010
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.9844
Epoch: 0|  Loss:  4.1964 |Global loss: 5.8251| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 1|  NKD Loss: 1.3385
Epoch: 1|  Loss:  3.7872 |Global loss: 5.604| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.2903
Epoch: 2|  Loss:  3.667 |Global loss: 5.6| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 3|  NKD Loss: 1.2753
Epoch: 3|  Loss:  3.5634 |Global loss: 5.6084| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 0|  NKD Loss: 1.4353
Epoch: 0|  Loss:  4.1358 |Global loss: 5.5986| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.276
Epoch: 1|  Loss:  4.0031 |Global loss: 5.643| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 2|  NKD Loss: 1.2842
Epoch: 2|  Loss:  3.9901 |Global loss: 5.6248| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 3|  NKD Loss: 1.273
Epoch: 3|  Loss:  3.9312 |Global loss: 5.6323| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 0|  NKD Loss: 2.0791
Epoch: 0|  Loss:  4.369 |Global loss: 5.9231| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 1.3527
Epoch: 1|  Loss:  3.9087 |Global loss: 5.5975| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 1.2779
Epoch: 2|  Loss:  3.8059 |Global loss: 5.6221| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 3|  NKD Loss: 1.2796
Epoch: 3|  Loss:  3.7073 |Global loss: 5.6173| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.3696
Epoch: 0|  Loss:  3.751 |Global loss: 5.6313| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 1|  NKD Loss: 1.2791
Epoch: 1|  Loss:  3.6054 |Global loss: 5.6209| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.2566
Epoch: 2|  Loss:  3.5194 |Global loss: 5.6246| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.2616
Epoch: 3|  Loss:  3.4432 |Global loss: 5.6154| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 0|  NKD Loss: 1.4691
Epoch: 0|  Loss:  3.241 |Global loss: 5.63| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.2681
Epoch: 1|  Loss:  3.0151 |Global loss: 5.6217| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 2|  NKD Loss: 1.2224
Epoch: 2|  Loss:  2.8505 |Global loss: 5.627| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.2082
Epoch: 3|  Loss:  2.7323 |Global loss: 5.6336| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 2.7909
Epoch: 0|  Loss:  5.2306 |Global loss: 6.3926| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.5421
Epoch: 1|  Loss:  4.4936 |Global loss: 5.6083| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 1.321
Epoch: 2|  Loss:  4.3281 |Global loss: 5.5944| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 3|  NKD Loss: 1.2876
Epoch: 3|  Loss:  4.2693 |Global loss: 5.5876| Local H loss: 0.0132  | Global H loss: 0.0132
------------------------- time cost ------------------------- 4.756467342376709
Chosen Clients:  [11, 5, 3, 7, 14, 12]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.325, 0.133, 0.067, 0.117, 0.125, 0.067, 0.067, 0.192, 0.117, 0.067, 0.067, 0.217, 0.067]
AUC in each clients:  [105.586, 102.474, 109.298, 103.755, 100.204, 92.129, 97.174, 106.768, 94.78, 110.51, 106.736, 100.561, 102.145, 92.911, 83.142]
F1 Score:  [0.01, 0.01, 0.234, 0.09, 0.01, 0.055, 0.094, 0.01, 0.01, 0.178, 0.094, 0.01, 0.01, 0.128, 0.01]
Recall Score:  [0.083, 0.083, 0.375, 0.157, 0.083, 0.167, 0.167, 0.083, 0.083, 0.25, 0.167, 0.083, 0.083, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1748
Averaged Test Accurancy: 0.1172
Averaged Test AUC: 0.8379
Averaged Test F1_score: 0.0635
Averaged Test Recal score: 0.1465
Std Test Accurancy: 0.0727
Std Test AUC: 0.0598
Std Test F1: 0.0006
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.4227
Epoch: 0|  Loss:  3.6811 |Global loss: 5.675| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.2934
Epoch: 1|  Loss:  3.5469 |Global loss: 5.6143| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.2743
Epoch: 2|  Loss:  3.425 |Global loss: 5.6115| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.2504
Epoch: 3|  Loss:  3.3345 |Global loss: 5.6342| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.6942
Epoch: 0|  Loss:  4.3166 |Global loss: 5.7951| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 1.3148
Epoch: 1|  Loss:  4.1159 |Global loss: 5.5852| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 1.3104
Epoch: 2|  Loss:  4.0502 |Global loss: 5.5939| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 3|  NKD Loss: 1.278
Epoch: 3|  Loss:  3.9789 |Global loss: 5.5983| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 0|  NKD Loss: 1.3053
Epoch: 0|  Loss:  3.4677 |Global loss: 5.6458| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 1.2537
Epoch: 1|  Loss:  3.3806 |Global loss: 5.6436| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 2|  NKD Loss: 1.2384
Epoch: 2|  Loss:  3.326 |Global loss: 5.6524| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 3|  NKD Loss: 1.2256
Epoch: 3|  Loss:  3.2776 |Global loss: 5.6593| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 0|  NKD Loss: 1.3391
Epoch: 0|  Loss:  3.2461 |Global loss: 5.6686| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 1.2555
Epoch: 1|  Loss:  3.093 |Global loss: 5.6648| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 1.2458
Epoch: 2|  Loss:  2.9975 |Global loss: 5.6719| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 1.2275
Epoch: 3|  Loss:  2.9104 |Global loss: 5.6794| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 1.3119
Epoch: 0|  Loss:  4.2258 |Global loss: 5.6117| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 1.2882
Epoch: 1|  Loss:  4.1638 |Global loss: 5.5871| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 2|  NKD Loss: 1.271
Epoch: 2|  Loss:  4.1094 |Global loss: 5.6123| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.2942
Epoch: 3|  Loss:  4.0819 |Global loss: 5.5967| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 0|  NKD Loss: 1.4143
Epoch: 0|  Loss:  3.5152 |Global loss: 5.6444| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2964
Epoch: 1|  Loss:  3.405 |Global loss: 5.623| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 2|  NKD Loss: 1.2495
Epoch: 2|  Loss:  3.2839 |Global loss: 5.6559| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 3|  NKD Loss: 1.2622
Epoch: 3|  Loss:  3.197 |Global loss: 5.6497| Local H loss: 0.0211  | Global H loss: 0.0211
------------------------- time cost ------------------------- 4.890762567520142
Chosen Clients:  [10, 13, 14, 3, 7, 4]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.325, 0.133, 0.067, 0.067, 0.125, 0.142, 0.067, 0.192, 0.117, 0.067, 0.117, 0.217, 0.067]
AUC in each clients:  [105.586, 102.474, 109.298, 105.881, 100.204, 94.177, 97.174, 108.053, 94.78, 110.51, 106.736, 104.305, 105.372, 92.911, 90.733]
F1 Score:  [0.01, 0.01, 0.234, 0.09, 0.01, 0.01, 0.094, 0.095, 0.01, 0.178, 0.094, 0.01, 0.094, 0.128, 0.01]
Recall Score:  [0.083, 0.083, 0.375, 0.157, 0.083, 0.083, 0.167, 0.167, 0.083, 0.25, 0.167, 0.083, 0.167, 0.25, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9843
Averaged Test Accurancy: 0.1222
Averaged Test AUC: 0.8490
Averaged Test F1_score: 0.0718
Averaged Test Recal score: 0.1521
Std Test Accurancy: 0.0717
Std Test AUC: 0.0518
Std Test F1: 0.0006
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.283
Epoch: 0|  Loss:  3.0621 |Global loss: 5.6534| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 1.2222
Epoch: 1|  Loss:  2.9548 |Global loss: 5.6434| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 2|  NKD Loss: 1.2288
Epoch: 2|  Loss:  2.9045 |Global loss: 5.6502| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1877
Epoch: 3|  Loss:  2.8069 |Global loss: 5.6715| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 2.6693
Epoch: 0|  Loss:  5.0737 |Global loss: 6.4142| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 1.4691
Epoch: 1|  Loss:  4.3438 |Global loss: 5.5542| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 2|  NKD Loss: 1.3098
Epoch: 2|  Loss:  4.2318 |Global loss: 5.5763| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.2861
Epoch: 3|  Loss:  4.1611 |Global loss: 5.5953| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 0|  NKD Loss: 1.3028
Epoch: 0|  Loss:  4.0539 |Global loss: 5.6066| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 1|  NKD Loss: 1.2872
Epoch: 1|  Loss:  3.9981 |Global loss: 5.6068| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 2|  NKD Loss: 1.2685
Epoch: 2|  Loss:  3.9762 |Global loss: 5.6096| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 3|  NKD Loss: 1.2778
Epoch: 3|  Loss:  3.9381 |Global loss: 5.6023| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 0|  NKD Loss: 1.2557
Epoch: 0|  Loss:  3.2417 |Global loss: 5.6634| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 1.2158
Epoch: 1|  Loss:  3.1546 |Global loss: 5.6506| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 2|  NKD Loss: 1.2095
Epoch: 2|  Loss:  3.1041 |Global loss: 5.6746| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 3|  NKD Loss: 1.2237
Epoch: 3|  Loss:  3.0663 |Global loss: 5.6554| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 0|  NKD Loss: 1.3328
Epoch: 0|  Loss:  3.0095 |Global loss: 5.6972| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 1.2166
Epoch: 1|  Loss:  2.8143 |Global loss: 5.7033| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.1972
Epoch: 2|  Loss:  2.711 |Global loss: 5.7043| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 1.1994
Epoch: 3|  Loss:  2.7039 |Global loss: 5.7156| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 1.2786
Epoch: 0|  Loss:  3.6019 |Global loss: 5.6232| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 1|  NKD Loss: 1.2676
Epoch: 1|  Loss:  3.5161 |Global loss: 5.6112| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 2|  NKD Loss: 1.2568
Epoch: 2|  Loss:  3.3992 |Global loss: 5.6071| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 3|  NKD Loss: 1.2402
Epoch: 3|  Loss:  3.3407 |Global loss: 5.6256| Local H loss: 0.0188  | Global H loss: 0.0188
------------------------- time cost ------------------------- 4.823265314102173
Chosen Clients:  [1, 14, 5, 2, 7, 8]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.325, 0.133, 0.067, 0.067, 0.125, 0.142, 0.067, 0.192, 0.117, 0.067, 0.117, 0.067, 0.067]
AUC in each clients:  [105.586, 102.474, 109.298, 107.629, 105.251, 94.177, 97.174, 108.906, 94.78, 110.51, 107.551, 104.305, 105.372, 89.485, 94.273]
F1 Score:  [0.01, 0.01, 0.234, 0.09, 0.01, 0.01, 0.094, 0.095, 0.01, 0.178, 0.094, 0.01, 0.094, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.375, 0.157, 0.083, 0.083, 0.167, 0.167, 0.083, 0.25, 0.167, 0.083, 0.167, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7635
Averaged Test Accurancy: 0.1122
Averaged Test AUC: 0.8538
Averaged Test F1_score: 0.0639
Averaged Test Recal score: 0.1409
Std Test Accurancy: 0.0682
Std Test AUC: 0.0538
Std Test F1: 0.0006
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.2595
Epoch: 0|  Loss:  3.6701 |Global loss: 5.6415| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 1|  NKD Loss: 1.2731
Epoch: 1|  Loss:  3.6181 |Global loss: 5.6184| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.2768
Epoch: 2|  Loss:  3.5523 |Global loss: 5.6205| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2591
Epoch: 3|  Loss:  3.4807 |Global loss: 5.6389| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 0|  NKD Loss: 1.2878
Epoch: 0|  Loss:  3.9164 |Global loss: 5.6272| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2691
Epoch: 1|  Loss:  3.8914 |Global loss: 5.6098| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.2584
Epoch: 2|  Loss:  3.8494 |Global loss: 5.6221| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 3|  NKD Loss: 1.2738
Epoch: 3|  Loss:  3.8178 |Global loss: 5.6203| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 0|  NKD Loss: 1.2831
Epoch: 0|  Loss:  3.9164 |Global loss: 5.6104| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 1.2937
Epoch: 1|  Loss:  3.8966 |Global loss: 5.5954| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 2|  NKD Loss: 1.2694
Epoch: 2|  Loss:  3.8447 |Global loss: 5.6076| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 1.262
Epoch: 3|  Loss:  3.7912 |Global loss: 5.6147| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 2.2167
Epoch: 0|  Loss:  4.282 |Global loss: 6.0996| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 1|  NKD Loss: 1.3622
Epoch: 1|  Loss:  3.7335 |Global loss: 5.5933| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.2602
Epoch: 2|  Loss:  3.6447 |Global loss: 5.6109| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 1.262
Epoch: 3|  Loss:  3.5463 |Global loss: 5.6062| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 0|  NKD Loss: 1.2683
Epoch: 0|  Loss:  2.717 |Global loss: 5.7316| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.1789
Epoch: 1|  Loss:  2.536 |Global loss: 5.7289| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.1912
Epoch: 2|  Loss:  2.5787 |Global loss: 5.7305| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.1466
Epoch: 3|  Loss:  2.4987 |Global loss: 5.7495| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.2754
Epoch: 0|  Loss:  3.8906 |Global loss: 5.6319| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.286
Epoch: 1|  Loss:  3.8869 |Global loss: 5.6197| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.2684
Epoch: 2|  Loss:  3.8227 |Global loss: 5.6205| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 3|  NKD Loss: 1.2532
Epoch: 3|  Loss:  3.7729 |Global loss: 5.6446| Local H loss: 0.016  | Global H loss: 0.016
------------------------- time cost ------------------------- 4.769983768463135
Chosen Clients:  [10, 1, 13, 5, 9, 12]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.133, 0.067, 0.067, 0.125, 0.208, 0.067, 0.192, 0.117, 0.067, 0.117, 0.067, 0.067]
AUC in each clients:  [105.586, 104.409, 103.915, 107.629, 105.251, 99.31, 97.174, 110.412, 99.577, 110.51, 107.551, 104.305, 105.372, 89.485, 98.327]
F1 Score:  [0.01, 0.01, 0.01, 0.09, 0.01, 0.01, 0.094, 0.174, 0.01, 0.178, 0.094, 0.01, 0.094, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.167, 0.241, 0.083, 0.25, 0.167, 0.083, 0.167, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6007
Averaged Test Accurancy: 0.0994
Averaged Test AUC: 0.8605
Averaged Test F1_score: 0.0543
Averaged Test Recal score: 0.1264
Std Test Accurancy: 0.0465
Std Test AUC: 0.0450
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2705
Epoch: 0|  Loss:  2.8124 |Global loss: 5.6678| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.2136
Epoch: 1|  Loss:  2.6875 |Global loss: 5.6807| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 1.1606
Epoch: 2|  Loss:  2.6216 |Global loss: 5.6955| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.187
Epoch: 3|  Loss:  2.6074 |Global loss: 5.685| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.2491
Epoch: 0|  Loss:  3.4374 |Global loss: 5.6634| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.2524
Epoch: 1|  Loss:  3.3688 |Global loss: 5.654| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2537
Epoch: 2|  Loss:  3.2939 |Global loss: 5.6555| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 3|  NKD Loss: 1.2453
Epoch: 3|  Loss:  3.2574 |Global loss: 5.6607| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2864
Epoch: 0|  Loss:  4.1197 |Global loss: 5.6001| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 1.2798
Epoch: 1|  Loss:  4.0425 |Global loss: 5.5867| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 2|  NKD Loss: 1.2918
Epoch: 2|  Loss:  4.016 |Global loss: 5.583| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.2741
Epoch: 3|  Loss:  3.9637 |Global loss: 5.5967| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 0|  NKD Loss: 1.2721
Epoch: 0|  Loss:  3.7531 |Global loss: 5.6332| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 1|  NKD Loss: 1.2623
Epoch: 1|  Loss:  3.7086 |Global loss: 5.614| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 1.2686
Epoch: 2|  Loss:  3.6594 |Global loss: 5.6163| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2601
Epoch: 3|  Loss:  3.6165 |Global loss: 5.6284| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 0|  NKD Loss: 1.2056
Epoch: 0|  Loss:  2.6594 |Global loss: 5.6409| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.1721
Epoch: 1|  Loss:  2.5402 |Global loss: 5.6374| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 1.1593
Epoch: 2|  Loss:  2.4141 |Global loss: 5.6504| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.1284
Epoch: 3|  Loss:  2.3199 |Global loss: 5.6592| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.2717
Epoch: 0|  Loss:  3.1667 |Global loss: 5.6566| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 1.2182
Epoch: 1|  Loss:  3.0456 |Global loss: 5.6824| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 1.2038
Epoch: 2|  Loss:  2.916 |Global loss: 5.6808| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 1.2093
Epoch: 3|  Loss:  2.8592 |Global loss: 5.684| Local H loss: 0.0236  | Global H loss: 0.0236
------------------------- time cost ------------------------- 4.847565650939941
Chosen Clients:  [14, 3, 12, 13, 9, 2]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.133, 0.067, 0.067, 0.125, 0.208, 0.067, 0.4, 0.175, 0.067, 0.117, 0.067, 0.067]
AUC in each clients:  [105.586, 105.586, 103.915, 107.629, 105.251, 101.803, 97.174, 110.412, 99.577, 112.972, 109.145, 104.305, 107.323, 95.123, 98.327]
F1 Score:  [0.01, 0.01, 0.01, 0.09, 0.01, 0.01, 0.094, 0.174, 0.01, 0.385, 0.178, 0.01, 0.094, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.167, 0.241, 0.083, 0.444, 0.25, 0.083, 0.167, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4699
Averaged Test Accurancy: 0.1172
Averaged Test AUC: 0.8690
Averaged Test F1_score: 0.0737
Averaged Test Recal score: 0.1449
Std Test Accurancy: 0.0875
Std Test AUC: 0.0408
Std Test F1: 0.0008
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.272
Epoch: 0|  Loss:  3.8031 |Global loss: 5.6388| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.2744
Epoch: 1|  Loss:  3.7407 |Global loss: 5.6202| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 1.2525
Epoch: 2|  Loss:  3.6954 |Global loss: 5.6229| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 1.2506
Epoch: 3|  Loss:  3.6782 |Global loss: 5.6382| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 0|  NKD Loss: 1.2562
Epoch: 0|  Loss:  3.0752 |Global loss: 5.6644| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 1.2027
Epoch: 1|  Loss:  2.982 |Global loss: 5.6651| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 2|  NKD Loss: 1.2002
Epoch: 2|  Loss:  2.9319 |Global loss: 5.6697| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 1.1952
Epoch: 3|  Loss:  2.8681 |Global loss: 5.6721| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 1.2043
Epoch: 0|  Loss:  2.7933 |Global loss: 5.6965| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.215
Epoch: 1|  Loss:  2.7589 |Global loss: 5.7037| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1905
Epoch: 2|  Loss:  2.6836 |Global loss: 5.7307| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 1.1864
Epoch: 3|  Loss:  2.7199 |Global loss: 5.7501| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 1.2733
Epoch: 0|  Loss:  3.9316 |Global loss: 5.6154| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 1|  NKD Loss: 1.2641
Epoch: 1|  Loss:  3.8763 |Global loss: 5.6084| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.2662
Epoch: 2|  Loss:  3.8462 |Global loss: 5.6154| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 3|  NKD Loss: 1.2582
Epoch: 3|  Loss:  3.8113 |Global loss: 5.614| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 0|  NKD Loss: 1.1832
Epoch: 0|  Loss:  2.2755 |Global loss: 5.6518| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 1.1046
Epoch: 1|  Loss:  2.1446 |Global loss: 5.6809| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 1.1101
Epoch: 2|  Loss:  2.1018 |Global loss: 5.6757| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 1.0788
Epoch: 3|  Loss:  1.974 |Global loss: 5.6821| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 1.2655
Epoch: 0|  Loss:  3.5203 |Global loss: 5.6311| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.2348
Epoch: 1|  Loss:  3.3965 |Global loss: 5.6348| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 2|  NKD Loss: 1.2455
Epoch: 2|  Loss:  3.3182 |Global loss: 5.6229| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 3|  NKD Loss: 1.2364
Epoch: 3|  Loss:  3.2707 |Global loss: 5.6429| Local H loss: 0.0191  | Global H loss: 0.0191
------------------------- time cost ------------------------- 4.822532653808594
Chosen Clients:  [9, 6, 7, 13, 8, 11]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.117, 0.133, 0.067, 0.067, 0.125, 0.208, 0.067, 0.75, 0.175, 0.067, 0.408, 0.067, 0.067]
AUC in each clients:  [105.586, 105.586, 105.961, 109.13, 105.251, 101.803, 97.174, 110.412, 99.577, 115.548, 109.145, 104.305, 110.408, 97.833, 101.237]
F1 Score:  [0.01, 0.01, 0.094, 0.09, 0.01, 0.01, 0.094, 0.174, 0.01, 0.68, 0.178, 0.01, 0.428, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.167, 0.157, 0.083, 0.083, 0.167, 0.241, 0.083, 0.729, 0.25, 0.083, 0.493, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3441
Averaged Test Accurancy: 0.1633
Averaged Test AUC: 0.8772
Averaged Test F1_score: 0.1212
Averaged Test Recal score: 0.1912
Std Test Accurancy: 0.1799
Std Test AUC: 0.0415
Std Test F1: 0.0015
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.1448
Epoch: 0|  Loss:  2.0256 |Global loss: 5.6889| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 1.0908
Epoch: 1|  Loss:  1.8662 |Global loss: 5.6807| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 1.0512
Epoch: 2|  Loss:  1.8012 |Global loss: 5.6968| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0724
Epoch: 3|  Loss:  1.8023 |Global loss: 5.6902| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.2502
Epoch: 0|  Loss:  3.6211 |Global loss: 5.6025| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 1|  NKD Loss: 1.2401
Epoch: 1|  Loss:  3.5822 |Global loss: 5.6059| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 2|  NKD Loss: 1.2246
Epoch: 2|  Loss:  3.5141 |Global loss: 5.6041| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.2363
Epoch: 3|  Loss:  3.4803 |Global loss: 5.6112| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 0|  NKD Loss: 1.2037
Epoch: 0|  Loss:  2.5042 |Global loss: 5.7482| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.1356
Epoch: 1|  Loss:  2.3716 |Global loss: 5.7589| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.159
Epoch: 2|  Loss:  2.3631 |Global loss: 5.7436| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.1177
Epoch: 3|  Loss:  2.2484 |Global loss: 5.7557| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 1.2685
Epoch: 0|  Loss:  3.7618 |Global loss: 5.6333| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 1|  NKD Loss: 1.2533
Epoch: 1|  Loss:  3.7292 |Global loss: 5.625| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 2|  NKD Loss: 1.2601
Epoch: 2|  Loss:  3.7036 |Global loss: 5.6385| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 1.2588
Epoch: 3|  Loss:  3.6713 |Global loss: 5.6305| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 0|  NKD Loss: 1.2546
Epoch: 0|  Loss:  3.7233 |Global loss: 5.6577| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 1|  NKD Loss: 1.2719
Epoch: 1|  Loss:  3.7032 |Global loss: 5.6249| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.2577
Epoch: 2|  Loss:  3.6438 |Global loss: 5.6337| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 3|  NKD Loss: 1.2256
Epoch: 3|  Loss:  3.6354 |Global loss: 5.6598| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 0|  NKD Loss: 1.2216
Epoch: 0|  Loss:  3.2039 |Global loss: 5.6486| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 1.198
Epoch: 1|  Loss:  3.0791 |Global loss: 5.6554| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1899
Epoch: 2|  Loss:  3.0084 |Global loss: 5.666| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.2088
Epoch: 3|  Loss:  2.9332 |Global loss: 5.6664| Local H loss: 0.0252  | Global H loss: 0.0252
------------------------- time cost ------------------------- 5.173692464828491
Chosen Clients:  [10, 11, 12, 14, 7, 5]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.117, 0.133, 0.067, 0.067, 0.125, 0.208, 0.067, 0.808, 0.175, 0.225, 0.408, 0.067, 0.067]
AUC in each clients:  [105.586, 105.586, 105.961, 109.13, 105.251, 101.803, 102.345, 111.314, 102.751, 117.341, 109.145, 108.065, 110.408, 99.655, 101.237]
F1 Score:  [0.01, 0.01, 0.094, 0.09, 0.01, 0.01, 0.094, 0.174, 0.01, 0.76, 0.178, 0.171, 0.428, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.167, 0.157, 0.083, 0.083, 0.167, 0.241, 0.083, 0.799, 0.25, 0.236, 0.493, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2396
Averaged Test Accurancy: 0.1778
Averaged Test AUC: 0.8864
Averaged Test F1_score: 0.1373
Averaged Test Recal score: 0.2061
Std Test Accurancy: 0.1913
Std Test AUC: 0.0375
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.176
Epoch: 0|  Loss:  2.503 |Global loss: 5.6797| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.1599
Epoch: 1|  Loss:  2.4373 |Global loss: 5.6956| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1433
Epoch: 2|  Loss:  2.3999 |Global loss: 5.6983| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.1449
Epoch: 3|  Loss:  2.3288 |Global loss: 5.7021| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.2058
Epoch: 0|  Loss:  2.8869 |Global loss: 5.6833| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.1986
Epoch: 1|  Loss:  2.7845 |Global loss: 5.6806| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 1.1733
Epoch: 2|  Loss:  2.6708 |Global loss: 5.6882| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 1.163
Epoch: 3|  Loss:  2.6399 |Global loss: 5.7004| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.1893
Epoch: 0|  Loss:  2.5832 |Global loss: 5.7243| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 1.1713
Epoch: 1|  Loss:  2.5858 |Global loss: 5.7514| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 1.1508
Epoch: 2|  Loss:  2.5091 |Global loss: 5.7589| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.1363
Epoch: 3|  Loss:  2.387 |Global loss: 5.7368| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.2282
Epoch: 0|  Loss:  3.5857 |Global loss: 5.6557| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 1.2285
Epoch: 1|  Loss:  3.5538 |Global loss: 5.6496| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 1.2438
Epoch: 2|  Loss:  3.5074 |Global loss: 5.6449| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 3|  NKD Loss: 1.2414
Epoch: 3|  Loss:  3.4695 |Global loss: 5.6468| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 0|  NKD Loss: 1.2093
Epoch: 0|  Loss:  2.3666 |Global loss: 5.77| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 1.1262
Epoch: 1|  Loss:  2.1994 |Global loss: 5.7581| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 1.1363
Epoch: 2|  Loss:  2.2496 |Global loss: 5.7752| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 1.0984
Epoch: 3|  Loss:  2.0836 |Global loss: 5.7622| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.2248
Epoch: 0|  Loss:  3.5569 |Global loss: 5.6605| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 1|  NKD Loss: 1.2405
Epoch: 1|  Loss:  3.517 |Global loss: 5.6322| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 1.2449
Epoch: 2|  Loss:  3.4717 |Global loss: 5.6461| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2422
Epoch: 3|  Loss:  3.4156 |Global loss: 5.6381| Local H loss: 0.0178  | Global H loss: 0.0178
------------------------- time cost ------------------------- 4.816688299179077
Chosen Clients:  [9, 10, 5, 6, 3, 2]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.117, 0.133, 0.067, 0.067, 0.125, 0.458, 0.067, 0.808, 0.325, 0.317, 0.408, 0.067, 0.067]
AUC in each clients:  [105.586, 105.586, 105.961, 109.13, 105.251, 104.334, 102.345, 113.701, 102.751, 117.341, 110.327, 110.093, 110.644, 99.655, 103.752]
F1 Score:  [0.01, 0.01, 0.094, 0.09, 0.01, 0.01, 0.094, 0.421, 0.01, 0.76, 0.354, 0.26, 0.423, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.167, 0.157, 0.083, 0.083, 0.167, 0.477, 0.083, 0.799, 0.404, 0.326, 0.493, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1364
Averaged Test Accurancy: 0.2106
Averaged Test AUC: 0.8925
Averaged Test F1_score: 0.1711
Averaged Test Recal score: 0.2381
Std Test Accurancy: 0.2080
Std Test AUC: 0.0379
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0726
Epoch: 0|  Loss:  1.7005 |Global loss: 5.6765| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 1.0245
Epoch: 1|  Loss:  1.6044 |Global loss: 5.671| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9985
Epoch: 2|  Loss:  1.5593 |Global loss: 5.6824| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 1.0249
Epoch: 3|  Loss:  1.5825 |Global loss: 5.6986| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 1.1373
Epoch: 0|  Loss:  2.2926 |Global loss: 5.7235| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.1237
Epoch: 1|  Loss:  2.3012 |Global loss: 5.721| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.1189
Epoch: 2|  Loss:  2.1678 |Global loss: 5.7087| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 1.1116
Epoch: 3|  Loss:  2.1316 |Global loss: 5.7021| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.2338
Epoch: 0|  Loss:  3.335 |Global loss: 5.6475| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 1.2085
Epoch: 1|  Loss:  3.2565 |Global loss: 5.6686| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.2359
Epoch: 2|  Loss:  3.2351 |Global loss: 5.6503| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 3|  NKD Loss: 1.2223
Epoch: 3|  Loss:  3.1718 |Global loss: 5.653| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 0|  NKD Loss: 1.2327
Epoch: 0|  Loss:  3.4529 |Global loss: 5.627| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 1.2319
Epoch: 1|  Loss:  3.3584 |Global loss: 5.6139| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 2|  NKD Loss: 1.2249
Epoch: 2|  Loss:  3.3608 |Global loss: 5.6239| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 3|  NKD Loss: 1.2167
Epoch: 3|  Loss:  3.294 |Global loss: 5.6342| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 0|  NKD Loss: 1.2172
Epoch: 0|  Loss:  2.8311 |Global loss: 5.6982| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.1638
Epoch: 1|  Loss:  2.771 |Global loss: 5.6962| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.1709
Epoch: 2|  Loss:  2.7364 |Global loss: 5.6955| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 1.1813
Epoch: 3|  Loss:  2.6763 |Global loss: 5.6744| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.2497
Epoch: 0|  Loss:  3.2381 |Global loss: 5.6603| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 1|  NKD Loss: 1.219
Epoch: 1|  Loss:  3.1805 |Global loss: 5.6663| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 2|  NKD Loss: 1.2227
Epoch: 2|  Loss:  3.1391 |Global loss: 5.6606| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.217
Epoch: 3|  Loss:  3.0641 |Global loss: 5.6737| Local H loss: 0.0207  | Global H loss: 0.0207
------------------------- time cost ------------------------- 4.78306770324707
Chosen Clients:  [9, 10, 1, 3, 6, 7]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.133, 0.133, 0.067, 0.067, 0.125, 0.458, 0.067, 0.892, 0.575, 0.317, 0.408, 0.067, 0.067]
AUC in each clients:  [105.586, 105.586, 107.378, 110.143, 105.251, 106.036, 104.317, 113.701, 102.751, 118.286, 113.077, 110.093, 110.644, 99.655, 103.752]
F1 Score:  [0.01, 0.01, 0.125, 0.09, 0.01, 0.01, 0.094, 0.421, 0.01, 0.863, 0.581, 0.26, 0.423, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.185, 0.157, 0.083, 0.083, 0.167, 0.477, 0.083, 0.894, 0.635, 0.326, 0.493, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0428
Averaged Test Accurancy: 0.2339
Averaged Test AUC: 0.8979
Averaged Test F1_score: 0.1951
Averaged Test Recal score: 0.2610
Std Test Accurancy: 0.2401
Std Test AUC: 0.0392
Std Test F1: 0.0021
Std Test Recall: 0.0020
Epoch: 0|  NKD Loss: 1.0186
Epoch: 0|  Loss:  1.5507 |Global loss: 5.7069| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9907
Epoch: 1|  Loss:  1.4756 |Global loss: 5.6943| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.9671
Epoch: 2|  Loss:  1.4796 |Global loss: 5.7248| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9308
Epoch: 3|  Loss:  1.3784 |Global loss: 5.7187| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.1572
Epoch: 0|  Loss:  2.2092 |Global loss: 5.7239| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 1.0758
Epoch: 1|  Loss:  2.0159 |Global loss: 5.7114| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 1.0621
Epoch: 2|  Loss:  1.9532 |Global loss: 5.7204| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 1.0925
Epoch: 3|  Loss:  1.9457 |Global loss: 5.7546| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.2399
Epoch: 0|  Loss:  3.2171 |Global loss: 5.6816| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2359
Epoch: 1|  Loss:  3.142 |Global loss: 5.6608| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 2|  NKD Loss: 1.2223
Epoch: 2|  Loss:  3.076 |Global loss: 5.6782| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 3|  NKD Loss: 1.2273
Epoch: 3|  Loss:  3.077 |Global loss: 5.6756| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 0|  NKD Loss: 1.1884
Epoch: 0|  Loss:  2.6826 |Global loss: 5.7171| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 1.1468
Epoch: 1|  Loss:  2.5113 |Global loss: 5.6958| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 1.1579
Epoch: 2|  Loss:  2.5329 |Global loss: 5.7156| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.1519
Epoch: 3|  Loss:  2.4891 |Global loss: 5.7158| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.2077
Epoch: 0|  Loss:  3.2717 |Global loss: 5.6634| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.232
Epoch: 1|  Loss:  3.2622 |Global loss: 5.6412| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 2|  NKD Loss: 1.2167
Epoch: 2|  Loss:  3.231 |Global loss: 5.6503| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 3|  NKD Loss: 1.2076
Epoch: 3|  Loss:  3.1348 |Global loss: 5.6507| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 0|  NKD Loss: 1.1693
Epoch: 0|  Loss:  2.1664 |Global loss: 5.7691| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 1.0596
Epoch: 1|  Loss:  1.9742 |Global loss: 5.7789| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 1.1059
Epoch: 2|  Loss:  2.1189 |Global loss: 5.806| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 1.064
Epoch: 3|  Loss:  1.9019 |Global loss: 5.766| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 4.867628812789917
Chosen Clients:  [4, 13, 12, 6, 14, 11]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.133, 0.208, 0.067, 0.067, 0.125, 0.575, 0.067, 0.892, 0.633, 0.317, 0.408, 0.067, 0.067]
AUC in each clients:  [105.586, 107.578, 107.378, 111.161, 105.251, 106.036, 105.557, 115.052, 102.751, 118.311, 113.914, 110.093, 110.644, 99.655, 103.752]
F1 Score:  [0.01, 0.01, 0.125, 0.174, 0.01, 0.01, 0.094, 0.571, 0.01, 0.863, 0.658, 0.26, 0.423, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.185, 0.241, 0.083, 0.083, 0.167, 0.616, 0.083, 0.894, 0.703, 0.326, 0.493, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9423
Averaged Test Accurancy: 0.2506
Averaged Test AUC: 0.9015
Averaged Test F1_score: 0.2159
Averaged Test Recal score: 0.2804
Std Test Accurancy: 0.2530
Std Test AUC: 0.0403
Std Test F1: 0.0023
Std Test Recall: 0.0022
Epoch: 0|  NKD Loss: 1.1981
Epoch: 0|  Loss:  3.1959 |Global loss: 5.6395| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.2261
Epoch: 1|  Loss:  3.0958 |Global loss: 5.6172| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.1897
Epoch: 2|  Loss:  3.0298 |Global loss: 5.6392| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.2191
Epoch: 3|  Loss:  2.8956 |Global loss: 5.6235| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 0|  NKD Loss: 1.2554
Epoch: 0|  Loss:  3.6388 |Global loss: 5.6498| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 1|  NKD Loss: 1.2552
Epoch: 1|  Loss:  3.5967 |Global loss: 5.6396| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 2|  NKD Loss: 1.2498
Epoch: 2|  Loss:  3.5628 |Global loss: 5.6461| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 3|  NKD Loss: 1.2441
Epoch: 3|  Loss:  3.5175 |Global loss: 5.6488| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 0|  NKD Loss: 1.1592
Epoch: 0|  Loss:  2.455 |Global loss: 5.7696| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.1253
Epoch: 1|  Loss:  2.3381 |Global loss: 5.7649| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.103
Epoch: 2|  Loss:  2.3179 |Global loss: 5.7762| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0965
Epoch: 3|  Loss:  2.2476 |Global loss: 5.7809| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 1.2133
Epoch: 0|  Loss:  3.0898 |Global loss: 5.6674| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.1921
Epoch: 1|  Loss:  3.0504 |Global loss: 5.6648| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 2|  NKD Loss: 1.212
Epoch: 2|  Loss:  3.0518 |Global loss: 5.6694| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 3|  NKD Loss: 1.1943
Epoch: 3|  Loss:  3.0091 |Global loss: 5.6729| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 0|  NKD Loss: 1.2184
Epoch: 0|  Loss:  3.4498 |Global loss: 5.6735| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 1|  NKD Loss: 1.2406
Epoch: 1|  Loss:  3.3728 |Global loss: 5.6479| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2097
Epoch: 2|  Loss:  3.3009 |Global loss: 5.6703| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 3|  NKD Loss: 1.2212
Epoch: 3|  Loss:  3.2805 |Global loss: 5.6622| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 0|  NKD Loss: 1.1595
Epoch: 0|  Loss:  2.5558 |Global loss: 5.717| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.1496
Epoch: 1|  Loss:  2.5634 |Global loss: 5.7301| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 1.1416
Epoch: 2|  Loss:  2.5115 |Global loss: 5.7431| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 1.1437
Epoch: 3|  Loss:  2.4253 |Global loss: 5.722| Local H loss: 0.03  | Global H loss: 0.03
------------------------- time cost ------------------------- 4.745150566101074
Chosen Clients:  [8, 10, 1, 5, 2, 12]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.133, 0.208, 0.15, 0.067, 0.125, 0.575, 0.067, 0.892, 0.633, 0.317, 0.408, 0.067, 0.133]
AUC in each clients:  [105.586, 107.578, 107.378, 111.161, 109.189, 106.036, 106.664, 115.052, 102.751, 118.311, 113.914, 110.858, 111.902, 102.354, 104.663]
F1 Score:  [0.01, 0.01, 0.125, 0.174, 0.095, 0.01, 0.089, 0.571, 0.01, 0.863, 0.658, 0.26, 0.423, 0.01, 0.094]
Recall Score:  [0.083, 0.083, 0.185, 0.241, 0.167, 0.083, 0.167, 0.616, 0.083, 0.894, 0.703, 0.326, 0.493, 0.083, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8902
Averaged Test Accurancy: 0.2606
Averaged Test AUC: 0.9074
Averaged Test F1_score: 0.2268
Averaged Test Recal score: 0.2916
Std Test Accurancy: 0.2470
Std Test AUC: 0.0370
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.2525
Epoch: 0|  Loss:  3.5586 |Global loss: 5.6622| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 1|  NKD Loss: 1.2641
Epoch: 1|  Loss:  3.5406 |Global loss: 5.6378| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2368
Epoch: 2|  Loss:  3.449 |Global loss: 5.6636| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.252
Epoch: 3|  Loss:  3.41 |Global loss: 5.6627| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 0|  NKD Loss: 1.1319
Epoch: 0|  Loss:  2.0109 |Global loss: 5.7246| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0778
Epoch: 1|  Loss:  1.8947 |Global loss: 5.7139| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 1.0461
Epoch: 2|  Loss:  1.8349 |Global loss: 5.7239| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 1.0393
Epoch: 3|  Loss:  1.7698 |Global loss: 5.7156| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.2082
Epoch: 0|  Loss:  2.9657 |Global loss: 5.7012| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.2065
Epoch: 1|  Loss:  2.932 |Global loss: 5.6976| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 2|  NKD Loss: 1.205
Epoch: 2|  Loss:  2.9282 |Global loss: 5.7011| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2076
Epoch: 3|  Loss:  2.829 |Global loss: 5.7008| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 0|  NKD Loss: 1.2176
Epoch: 0|  Loss:  3.0826 |Global loss: 5.6696| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.1922
Epoch: 1|  Loss:  3.0203 |Global loss: 5.672| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 2|  NKD Loss: 1.1981
Epoch: 2|  Loss:  3.0085 |Global loss: 5.6898| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 3|  NKD Loss: 1.187
Epoch: 3|  Loss:  2.9295 |Global loss: 5.6843| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 1.2022
Epoch: 0|  Loss:  3.0701 |Global loss: 5.6875| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 1.1936
Epoch: 1|  Loss:  2.9653 |Global loss: 5.6882| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 2|  NKD Loss: 1.2234
Epoch: 2|  Loss:  2.9802 |Global loss: 5.6853| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 3|  NKD Loss: 1.1878
Epoch: 3|  Loss:  2.8794 |Global loss: 5.6931| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 1.1684
Epoch: 0|  Loss:  2.3779 |Global loss: 5.7965| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.106
Epoch: 1|  Loss:  2.1735 |Global loss: 5.7675| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 1.1137
Epoch: 2|  Loss:  2.2546 |Global loss: 5.8043| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 1.0746
Epoch: 3|  Loss:  2.1404 |Global loss: 5.7902| Local H loss: 0.0295  | Global H loss: 0.0295
------------------------- time cost ------------------------- 5.038757801055908
Chosen Clients:  [3, 5, 11, 6, 10, 4]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.192, 0.208, 0.15, 0.1, 0.125, 0.575, 0.067, 0.892, 0.725, 0.317, 0.483, 0.067, 0.133]
AUC in each clients:  [105.586, 109.098, 108.116, 111.161, 109.189, 107.401, 106.664, 115.052, 105.077, 118.311, 115.352, 110.858, 112.601, 102.354, 104.663]
F1 Score:  [0.01, 0.094, 0.178, 0.174, 0.095, 0.077, 0.089, 0.571, 0.01, 0.863, 0.756, 0.26, 0.504, 0.01, 0.094]
Recall Score:  [0.083, 0.167, 0.25, 0.241, 0.167, 0.139, 0.167, 0.616, 0.083, 0.894, 0.81, 0.326, 0.576, 0.083, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7916
Averaged Test Accurancy: 0.2811
Averaged Test AUC: 0.9119
Averaged Test F1_score: 0.2523
Averaged Test Recal score: 0.3179
Std Test Accurancy: 0.2547
Std Test AUC: 0.0361
Std Test F1: 0.0023
Std Test Recall: 0.0022
Epoch: 0|  NKD Loss: 1.1596
Epoch: 0|  Loss:  2.3889 |Global loss: 5.7068| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 1.1381
Epoch: 1|  Loss:  2.4021 |Global loss: 5.73| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1253
Epoch: 2|  Loss:  2.3935 |Global loss: 5.7536| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.1193
Epoch: 3|  Loss:  2.277 |Global loss: 5.7292| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 1.2018
Epoch: 0|  Loss:  2.886 |Global loss: 5.6911| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.1928
Epoch: 1|  Loss:  2.8079 |Global loss: 5.6892| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1936
Epoch: 2|  Loss:  2.746 |Global loss: 5.686| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1736
Epoch: 3|  Loss:  2.681 |Global loss: 5.6877| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.13
Epoch: 0|  Loss:  2.3707 |Global loss: 5.7503| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 1.1151
Epoch: 1|  Loss:  2.2793 |Global loss: 5.7389| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.1124
Epoch: 2|  Loss:  2.2436 |Global loss: 5.7456| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 1.1169
Epoch: 3|  Loss:  2.176 |Global loss: 5.7413| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 1.2241
Epoch: 0|  Loss:  2.9879 |Global loss: 5.6721| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 1.1874
Epoch: 1|  Loss:  2.9399 |Global loss: 5.6756| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.1962
Epoch: 2|  Loss:  2.8638 |Global loss: 5.6798| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1919
Epoch: 3|  Loss:  2.8267 |Global loss: 5.6881| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 0|  NKD Loss: 1.1136
Epoch: 0|  Loss:  1.8975 |Global loss: 5.7618| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0299
Epoch: 1|  Loss:  1.7453 |Global loss: 5.7186| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0567
Epoch: 2|  Loss:  1.7594 |Global loss: 5.7412| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 1.0522
Epoch: 3|  Loss:  1.7725 |Global loss: 5.7579| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 1.1998
Epoch: 0|  Loss:  2.821 |Global loss: 5.6539| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 1.1881
Epoch: 1|  Loss:  2.7179 |Global loss: 5.6569| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1725
Epoch: 2|  Loss:  2.6343 |Global loss: 5.6682| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 3|  NKD Loss: 1.1509
Epoch: 3|  Loss:  2.5481 |Global loss: 5.6885| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 4.712332248687744
Chosen Clients:  [11, 4, 5, 13, 12, 8]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.192, 0.433, 0.358, 0.142, 0.125, 0.575, 0.067, 0.892, 0.658, 0.458, 0.483, 0.067, 0.133]
AUC in each clients:  [105.586, 109.098, 108.116, 112.063, 111.336, 108.877, 108.234, 115.052, 105.077, 118.311, 114.701, 112.702, 112.601, 102.354, 104.663]
F1 Score:  [0.01, 0.094, 0.178, 0.416, 0.339, 0.136, 0.094, 0.571, 0.01, 0.863, 0.674, 0.425, 0.504, 0.01, 0.094]
Recall Score:  [0.083, 0.167, 0.25, 0.477, 0.4, 0.194, 0.167, 0.616, 0.083, 0.894, 0.736, 0.484, 0.576, 0.083, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7039
Averaged Test Accurancy: 0.3178
Averaged Test AUC: 0.9160
Averaged Test F1_score: 0.2945
Averaged Test Recal score: 0.3585
Std Test Accurancy: 0.2478
Std Test AUC: 0.0358
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.0903
Epoch: 0|  Loss:  2.1889 |Global loss: 5.7792| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 1.1121
Epoch: 1|  Loss:  2.1467 |Global loss: 5.7574| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 1.0552
Epoch: 2|  Loss:  2.0159 |Global loss: 5.7668| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 1.0907
Epoch: 3|  Loss:  1.9647 |Global loss: 5.7587| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 1.1656
Epoch: 0|  Loss:  2.4528 |Global loss: 5.6997| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.1465
Epoch: 1|  Loss:  2.3968 |Global loss: 5.6954| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.1399
Epoch: 2|  Loss:  2.3222 |Global loss: 5.7123| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.1564
Epoch: 3|  Loss:  2.3092 |Global loss: 5.7115| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.1805
Epoch: 0|  Loss:  2.6372 |Global loss: 5.714| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.1575
Epoch: 1|  Loss:  2.6009 |Global loss: 5.7156| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1677
Epoch: 2|  Loss:  2.58 |Global loss: 5.7225| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 1.1543
Epoch: 3|  Loss:  2.5633 |Global loss: 5.7255| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 1.2535
Epoch: 0|  Loss:  3.4941 |Global loss: 5.6551| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 1|  NKD Loss: 1.2281
Epoch: 1|  Loss:  3.4498 |Global loss: 5.6602| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 2|  NKD Loss: 1.226
Epoch: 2|  Loss:  3.393 |Global loss: 5.6515| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.2422
Epoch: 3|  Loss:  3.3444 |Global loss: 5.6517| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.1539
Epoch: 0|  Loss:  2.2792 |Global loss: 5.8153| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 1.0888
Epoch: 1|  Loss:  2.1531 |Global loss: 5.7888| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 1.0611
Epoch: 2|  Loss:  2.0509 |Global loss: 5.787| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 1.0901
Epoch: 3|  Loss:  2.117 |Global loss: 5.8122| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.2354
Epoch: 0|  Loss:  3.4097 |Global loss: 5.676| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2447
Epoch: 1|  Loss:  3.3763 |Global loss: 5.6725| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 2|  NKD Loss: 1.2413
Epoch: 2|  Loss:  3.3267 |Global loss: 5.676| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 3|  NKD Loss: 1.2422
Epoch: 3|  Loss:  3.2831 |Global loss: 5.6645| Local H loss: 0.0198  | Global H loss: 0.0198
------------------------- time cost ------------------------- 4.9170982837677
Chosen Clients:  [6, 3, 10, 1, 4, 9]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.192, 0.433, 0.358, 0.258, 0.125, 0.575, 0.067, 0.892, 0.658, 0.517, 0.55, 0.142, 0.133]
AUC in each clients:  [105.586, 109.098, 108.116, 112.063, 112.361, 110.798, 108.234, 115.052, 106.21, 118.311, 114.701, 113.361, 113.014, 103.861, 104.663]
F1 Score:  [0.01, 0.094, 0.178, 0.416, 0.339, 0.258, 0.094, 0.571, 0.01, 0.863, 0.674, 0.509, 0.589, 0.095, 0.094]
Recall Score:  [0.083, 0.167, 0.25, 0.477, 0.4, 0.324, 0.167, 0.616, 0.083, 0.894, 0.736, 0.567, 0.65, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6379
Averaged Test Accurancy: 0.3389
Averaged Test AUC: 0.9197
Averaged Test F1_score: 0.3196
Averaged Test Recal score: 0.3832
Std Test Accurancy: 0.2452
Std Test AUC: 0.0342
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.1839
Epoch: 0|  Loss:  2.8157 |Global loss: 5.698| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1755
Epoch: 1|  Loss:  2.7398 |Global loss: 5.6894| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 2|  NKD Loss: 1.1755
Epoch: 2|  Loss:  2.7196 |Global loss: 5.6889| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 3|  NKD Loss: 1.179
Epoch: 3|  Loss:  2.7512 |Global loss: 5.7127| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.1296
Epoch: 0|  Loss:  2.2782 |Global loss: 5.7524| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.082
Epoch: 1|  Loss:  2.1478 |Global loss: 5.7494| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 1.1133
Epoch: 2|  Loss:  2.1776 |Global loss: 5.7485| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.0992
Epoch: 3|  Loss:  2.1257 |Global loss: 5.7561| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 1.0853
Epoch: 0|  Loss:  1.8125 |Global loss: 5.7424| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 1.0312
Epoch: 1|  Loss:  1.7223 |Global loss: 5.7363| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0232
Epoch: 2|  Loss:  1.6534 |Global loss: 5.716| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 1.0143
Epoch: 3|  Loss:  1.634 |Global loss: 5.7384| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 1.1843
Epoch: 0|  Loss:  2.7624 |Global loss: 5.7156| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 1|  NKD Loss: 1.1837
Epoch: 1|  Loss:  2.7336 |Global loss: 5.7207| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 2|  NKD Loss: 1.1698
Epoch: 2|  Loss:  2.6631 |Global loss: 5.716| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 3|  NKD Loss: 1.177
Epoch: 3|  Loss:  2.5969 |Global loss: 5.7122| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 1.1235
Epoch: 0|  Loss:  2.2241 |Global loss: 5.7465| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.112
Epoch: 1|  Loss:  2.1551 |Global loss: 5.7334| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.1126
Epoch: 2|  Loss:  2.0334 |Global loss: 5.7215| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 1.0907
Epoch: 3|  Loss:  2.0392 |Global loss: 5.7692| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.9855
Epoch: 0|  Loss:  1.4262 |Global loss: 5.7003| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.9507
Epoch: 1|  Loss:  1.3782 |Global loss: 5.7187| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9223
Epoch: 2|  Loss:  1.3133 |Global loss: 5.7039| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9533
Epoch: 3|  Loss:  1.3779 |Global loss: 5.7228| Local H loss: 0.0378  | Global H loss: 0.0378
------------------------- time cost ------------------------- 4.725733518600464
Chosen Clients:  [1, 12, 9, 5, 11, 4]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.192, 0.192, 0.4, 0.458, 0.258, 0.267, 0.575, 0.067, 0.892, 0.725, 0.517, 0.55, 0.142, 0.133]
AUC in each clients:  [105.586, 110.399, 108.116, 112.449, 113.921, 110.798, 109.647, 115.052, 106.21, 118.168, 115.97, 113.361, 113.014, 103.861, 104.663]
F1 Score:  [0.01, 0.178, 0.178, 0.391, 0.452, 0.258, 0.252, 0.571, 0.01, 0.863, 0.753, 0.509, 0.589, 0.095, 0.094]
Recall Score:  [0.083, 0.25, 0.25, 0.442, 0.5, 0.324, 0.324, 0.616, 0.083, 0.894, 0.81, 0.567, 0.65, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5392
Averaged Test Accurancy: 0.3622
Averaged Test AUC: 0.9229
Averaged Test F1_score: 0.3469
Averaged Test Recal score: 0.4085
Std Test Accurancy: 0.2423
Std Test AUC: 0.0351
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.1603
Epoch: 0|  Loss:  2.5754 |Global loss: 5.7419| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.1463
Epoch: 1|  Loss:  2.5066 |Global loss: 5.7437| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1326
Epoch: 2|  Loss:  2.3809 |Global loss: 5.726| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 1.1682
Epoch: 3|  Loss:  2.4597 |Global loss: 5.7409| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.1074
Epoch: 0|  Loss:  2.0456 |Global loss: 5.8035| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 1.0916
Epoch: 1|  Loss:  2.0834 |Global loss: 5.805| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0833
Epoch: 2|  Loss:  2.1155 |Global loss: 5.8462| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 1.0823
Epoch: 3|  Loss:  2.1137 |Global loss: 5.841| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.9687
Epoch: 0|  Loss:  1.3379 |Global loss: 5.6967| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9438
Epoch: 1|  Loss:  1.3507 |Global loss: 5.7317| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.95
Epoch: 2|  Loss:  1.3379 |Global loss: 5.6971| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9316
Epoch: 3|  Loss:  1.3094 |Global loss: 5.7206| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.1494
Epoch: 0|  Loss:  2.4564 |Global loss: 5.7317| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.1374
Epoch: 1|  Loss:  2.3889 |Global loss: 5.7238| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 1.1296
Epoch: 2|  Loss:  2.3343 |Global loss: 5.7274| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.1209
Epoch: 3|  Loss:  2.2821 |Global loss: 5.7219| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 1.0787
Epoch: 0|  Loss:  1.9588 |Global loss: 5.7598| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 1.0791
Epoch: 1|  Loss:  1.9824 |Global loss: 5.7797| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 1.0229
Epoch: 2|  Loss:  1.838 |Global loss: 5.7743| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 1.0654
Epoch: 3|  Loss:  1.9376 |Global loss: 5.7826| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 1.0789
Epoch: 0|  Loss:  1.9707 |Global loss: 5.7639| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 1.0589
Epoch: 1|  Loss:  1.8812 |Global loss: 5.7551| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.0684
Epoch: 2|  Loss:  1.8704 |Global loss: 5.7611| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 1.0372
Epoch: 3|  Loss:  1.7841 |Global loss: 5.7729| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.864421606063843
Chosen Clients:  [14, 10, 1, 9, 8, 7]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.292, 0.192, 0.4, 0.592, 0.367, 0.267, 0.575, 0.067, 0.892, 0.725, 0.525, 0.55, 0.142, 0.133]
AUC in each clients:  [105.586, 111.02, 108.116, 112.449, 114.352, 112.373, 109.647, 115.052, 106.21, 118.402, 115.97, 113.899, 112.545, 103.861, 104.663]
F1 Score:  [0.01, 0.3, 0.178, 0.391, 0.558, 0.333, 0.252, 0.571, 0.01, 0.863, 0.753, 0.517, 0.59, 0.095, 0.094]
Recall Score:  [0.083, 0.352, 0.25, 0.442, 0.6, 0.396, 0.324, 0.616, 0.083, 0.894, 0.81, 0.574, 0.65, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4907
Averaged Test Accurancy: 0.3856
Averaged Test AUC: 0.9245
Averaged Test F1_score: 0.3677
Averaged Test Recal score: 0.4272
Std Test Accurancy: 0.2427
Std Test AUC: 0.0357
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.2056
Epoch: 0|  Loss:  3.1678 |Global loss: 5.6753| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 1.218
Epoch: 1|  Loss:  3.193 |Global loss: 5.6695| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 2|  NKD Loss: 1.2147
Epoch: 2|  Loss:  3.0719 |Global loss: 5.6648| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2142
Epoch: 3|  Loss:  3.0588 |Global loss: 5.6609| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.0452
Epoch: 0|  Loss:  1.6805 |Global loss: 5.7253| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 1|  NKD Loss: 1.0277
Epoch: 1|  Loss:  1.6509 |Global loss: 5.756| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 1.0117
Epoch: 2|  Loss:  1.672 |Global loss: 5.7521| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 1.0125
Epoch: 3|  Loss:  1.5769 |Global loss: 5.7285| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.1378
Epoch: 0|  Loss:  2.4129 |Global loss: 5.7688| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1257
Epoch: 1|  Loss:  2.2989 |Global loss: 5.7396| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1314
Epoch: 2|  Loss:  2.2806 |Global loss: 5.7505| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 1.1466
Epoch: 3|  Loss:  2.2735 |Global loss: 5.75| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9432
Epoch: 0|  Loss:  1.2938 |Global loss: 5.7199| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.9217
Epoch: 1|  Loss:  1.2729 |Global loss: 5.7145| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9204
Epoch: 2|  Loss:  1.2672 |Global loss: 5.7223| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.9252
Epoch: 3|  Loss:  1.2378 |Global loss: 5.6932| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 1.217
Epoch: 0|  Loss:  3.205 |Global loss: 5.6957| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 1|  NKD Loss: 1.2329
Epoch: 1|  Loss:  3.1625 |Global loss: 5.6804| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 2|  NKD Loss: 1.2317
Epoch: 2|  Loss:  3.083 |Global loss: 5.6876| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 3|  NKD Loss: 1.2263
Epoch: 3|  Loss:  3.0725 |Global loss: 5.6848| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.0858
Epoch: 0|  Loss:  1.8722 |Global loss: 5.7701| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 1.0772
Epoch: 1|  Loss:  1.9214 |Global loss: 5.7993| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 1.0858
Epoch: 2|  Loss:  1.9717 |Global loss: 5.8146| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0618
Epoch: 3|  Loss:  1.8374 |Global loss: 5.7962| Local H loss: 0.0341  | Global H loss: 0.0341
------------------------- time cost ------------------------- 4.857387542724609
Chosen Clients:  [9, 13, 14, 8, 3, 0]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.358, 0.192, 0.4, 0.592, 0.367, 0.267, 0.608, 0.067, 0.892, 0.717, 0.525, 0.55, 0.142, 0.133]
AUC in each clients:  [105.586, 112.88, 108.116, 112.449, 114.352, 112.373, 109.647, 115.836, 107.101, 118.451, 115.961, 113.899, 112.545, 103.861, 106.958]
F1 Score:  [0.01, 0.344, 0.178, 0.391, 0.558, 0.333, 0.252, 0.588, 0.01, 0.863, 0.748, 0.517, 0.59, 0.095, 0.094]
Recall Score:  [0.083, 0.41, 0.25, 0.442, 0.6, 0.396, 0.324, 0.637, 0.083, 0.894, 0.802, 0.574, 0.65, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4218
Averaged Test Accurancy: 0.3917
Averaged Test AUC: 0.9278
Averaged Test F1_score: 0.3714
Averaged Test Recal score: 0.4319
Std Test Accurancy: 0.2427
Std Test AUC: 0.0342
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 0.9071
Epoch: 0|  Loss:  1.2122 |Global loss: 5.7045| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.9056
Epoch: 1|  Loss:  1.2117 |Global loss: 5.7071| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9304
Epoch: 2|  Loss:  1.2301 |Global loss: 5.6981| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9197
Epoch: 3|  Loss:  1.2577 |Global loss: 5.7285| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 1.1791
Epoch: 0|  Loss:  3.2921 |Global loss: 5.6993| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 1.2365
Epoch: 1|  Loss:  3.2752 |Global loss: 5.6562| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 2|  NKD Loss: 1.2213
Epoch: 2|  Loss:  3.2282 |Global loss: 5.6636| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.2227
Epoch: 3|  Loss:  3.1818 |Global loss: 5.6547| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.1791
Epoch: 0|  Loss:  2.9598 |Global loss: 5.7102| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 1|  NKD Loss: 1.202
Epoch: 1|  Loss:  2.8931 |Global loss: 5.6789| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 1.2037
Epoch: 2|  Loss:  2.8931 |Global loss: 5.6861| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 1.1805
Epoch: 3|  Loss:  2.7415 |Global loss: 5.6876| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 0|  NKD Loss: 1.2098
Epoch: 0|  Loss:  3.0097 |Global loss: 5.6965| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 1.2159
Epoch: 1|  Loss:  2.9349 |Global loss: 5.6986| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.1986
Epoch: 2|  Loss:  2.8407 |Global loss: 5.7074| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1968
Epoch: 3|  Loss:  2.8208 |Global loss: 5.7032| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.0958
Epoch: 0|  Loss:  2.145 |Global loss: 5.7571| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.0834
Epoch: 1|  Loss:  2.0452 |Global loss: 5.7483| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0449
Epoch: 2|  Loss:  2.0027 |Global loss: 5.7789| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0658
Epoch: 3|  Loss:  1.9731 |Global loss: 5.7538| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.2108
Epoch: 0|  Loss:  3.4548 |Global loss: 5.6363| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 1|  NKD Loss: 1.2587
Epoch: 1|  Loss:  3.3839 |Global loss: 5.601| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 2|  NKD Loss: 1.2474
Epoch: 2|  Loss:  3.3073 |Global loss: 5.6058| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.2383
Epoch: 3|  Loss:  3.2207 |Global loss: 5.6162| Local H loss: 0.0195  | Global H loss: 0.0195
------------------------- time cost ------------------------- 4.901456356048584
Chosen Clients:  [3, 1, 9, 4, 8, 2]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.358, 0.192, 0.475, 0.592, 0.367, 0.267, 0.608, 0.125, 0.9, 0.717, 0.525, 0.55, 0.142, 0.275]
AUC in each clients:  [107.28, 112.88, 108.116, 114.315, 114.352, 112.373, 109.647, 115.836, 108.717, 118.46, 115.961, 113.899, 112.545, 104.644, 110.032]
F1 Score:  [0.01, 0.344, 0.178, 0.478, 0.558, 0.333, 0.252, 0.588, 0.089, 0.869, 0.748, 0.517, 0.59, 0.095, 0.258]
Recall Score:  [0.083, 0.41, 0.25, 0.519, 0.6, 0.396, 0.324, 0.637, 0.167, 0.9, 0.802, 0.574, 0.65, 0.167, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3560
Averaged Test Accurancy: 0.4106
Averaged Test AUC: 0.9328
Averaged Test F1_score: 0.3938
Averaged Test Recal score: 0.4535
Std Test Accurancy: 0.2317
Std Test AUC: 0.0304
Std Test F1: 0.0020
Std Test Recall: 0.0019
Epoch: 0|  NKD Loss: 1.0973
Epoch: 0|  Loss:  2.041 |Global loss: 5.7701| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 1.0589
Epoch: 1|  Loss:  1.9551 |Global loss: 5.7815| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 1.0558
Epoch: 2|  Loss:  1.8999 |Global loss: 5.7677| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 1.0372
Epoch: 3|  Loss:  1.8236 |Global loss: 5.757| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.1043
Epoch: 0|  Loss:  2.137 |Global loss: 5.7593| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.1104
Epoch: 1|  Loss:  2.1319 |Global loss: 5.7514| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0694
Epoch: 2|  Loss:  2.0839 |Global loss: 5.7872| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 1.0835
Epoch: 3|  Loss:  2.0476 |Global loss: 5.7744| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9095
Epoch: 0|  Loss:  1.1841 |Global loss: 5.6949| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9107
Epoch: 1|  Loss:  1.1936 |Global loss: 5.7111| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9184
Epoch: 2|  Loss:  1.2262 |Global loss: 5.7162| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9287
Epoch: 3|  Loss:  1.2393 |Global loss: 5.698| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 1.0473
Epoch: 0|  Loss:  1.7803 |Global loss: 5.7743| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 1.0274
Epoch: 1|  Loss:  1.7351 |Global loss: 5.7723| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 1.0312
Epoch: 2|  Loss:  1.7259 |Global loss: 5.7727| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 1.0152
Epoch: 3|  Loss:  1.649 |Global loss: 5.7607| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 1.2002
Epoch: 0|  Loss:  2.7441 |Global loss: 5.7158| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.2069
Epoch: 1|  Loss:  2.7513 |Global loss: 5.7139| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.1602
Epoch: 2|  Loss:  2.6682 |Global loss: 5.7408| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 1.1854
Epoch: 3|  Loss:  2.6058 |Global loss: 5.7102| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 1.1483
Epoch: 0|  Loss:  2.8191 |Global loss: 5.7229| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 1.1881
Epoch: 1|  Loss:  2.8305 |Global loss: 5.7115| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 1.1991
Epoch: 2|  Loss:  2.8139 |Global loss: 5.6946| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 1.17
Epoch: 3|  Loss:  2.751 |Global loss: 5.7101| Local H loss: 0.0235  | Global H loss: 0.0235
------------------------- time cost ------------------------- 5.029537916183472
Chosen Clients:  [13, 12, 1, 7, 4, 11]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.533, 0.192, 0.6, 0.833, 0.367, 0.267, 0.608, 0.125, 0.9, 0.717, 0.525, 0.55, 0.142, 0.275]
AUC in each clients:  [107.28, 114.061, 108.69, 115.411, 116.768, 112.373, 109.647, 115.836, 109.765, 118.623, 115.961, 113.899, 112.545, 104.644, 110.032]
F1 Score:  [0.01, 0.499, 0.178, 0.573, 0.764, 0.333, 0.252, 0.588, 0.084, 0.869, 0.748, 0.517, 0.59, 0.095, 0.258]
Recall Score:  [0.083, 0.556, 0.25, 0.616, 0.81, 0.396, 0.324, 0.637, 0.167, 0.9, 0.802, 0.574, 0.65, 0.167, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2747
Averaged Test Accurancy: 0.4467
Averaged Test AUC: 0.9364
Averaged Test F1_score: 0.4239
Averaged Test Recal score: 0.4837
Std Test Accurancy: 0.2551
Std Test AUC: 0.0317
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 1.2004
Epoch: 0|  Loss:  3.1065 |Global loss: 5.6865| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.2097
Epoch: 1|  Loss:  3.0721 |Global loss: 5.67| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.1956
Epoch: 2|  Loss:  3.0405 |Global loss: 5.6742| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 3|  NKD Loss: 1.2029
Epoch: 3|  Loss:  2.9915 |Global loss: 5.6788| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.0531
Epoch: 0|  Loss:  1.9319 |Global loss: 5.798| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 1.0514
Epoch: 1|  Loss:  1.9325 |Global loss: 5.8019| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.0107
Epoch: 2|  Loss:  1.8169 |Global loss: 5.7974| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 1.0647
Epoch: 3|  Loss:  1.8726 |Global loss: 5.8148| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0976
Epoch: 0|  Loss:  2.0372 |Global loss: 5.766| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.0755
Epoch: 1|  Loss:  1.9665 |Global loss: 5.762| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.0801
Epoch: 2|  Loss:  1.9307 |Global loss: 5.7634| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0731
Epoch: 3|  Loss:  1.8351 |Global loss: 5.7548| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 1.0589
Epoch: 0|  Loss:  1.7416 |Global loss: 5.7745| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 1.0119
Epoch: 1|  Loss:  1.6845 |Global loss: 5.7991| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 1.0341
Epoch: 2|  Loss:  1.741 |Global loss: 5.8139| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0337
Epoch: 3|  Loss:  1.7183 |Global loss: 5.8106| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 1.0419
Epoch: 0|  Loss:  1.6999 |Global loss: 5.7777| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 1.0065
Epoch: 1|  Loss:  1.648 |Global loss: 5.7957| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 1.0091
Epoch: 2|  Loss:  1.6072 |Global loss: 5.7706| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.9773
Epoch: 3|  Loss:  1.5638 |Global loss: 5.7828| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 1.0365
Epoch: 0|  Loss:  1.8279 |Global loss: 5.7899| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 1.0401
Epoch: 1|  Loss:  1.8378 |Global loss: 5.7941| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 1.0198
Epoch: 2|  Loss:  1.7589 |Global loss: 5.7808| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 1.0259
Epoch: 3|  Loss:  1.7315 |Global loss: 5.7844| Local H loss: 0.0383  | Global H loss: 0.0383
------------------------- time cost ------------------------- 5.1565260887146
Chosen Clients:  [12, 4, 7, 11, 5, 3]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.65, 0.192, 0.6, 0.833, 0.367, 0.267, 0.908, 0.125, 0.9, 0.717, 0.725, 0.55, 0.142, 0.275]
AUC in each clients:  [107.28, 115.167, 108.69, 115.411, 117.566, 112.373, 109.647, 117.357, 109.765, 118.623, 115.961, 114.758, 113.674, 105.78, 110.032]
F1 Score:  [0.01, 0.626, 0.178, 0.573, 0.764, 0.333, 0.252, 0.867, 0.084, 0.869, 0.748, 0.756, 0.58, 0.095, 0.258]
Recall Score:  [0.083, 0.67, 0.25, 0.616, 0.81, 0.396, 0.324, 0.894, 0.167, 0.9, 0.802, 0.81, 0.65, 0.167, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2060
Averaged Test Accurancy: 0.4878
Averaged Test AUC: 0.9400
Averaged Test F1_score: 0.4662
Averaged Test Recal score: 0.5242
Std Test Accurancy: 0.2879
Std Test AUC: 0.0325
Std Test F1: 0.0025
Std Test Recall: 0.0023
Epoch: 0|  NKD Loss: 1.0723
Epoch: 0|  Loss:  1.894 |Global loss: 5.8084| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 1.027
Epoch: 1|  Loss:  1.7906 |Global loss: 5.814| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 1.0557
Epoch: 2|  Loss:  1.8564 |Global loss: 5.8263| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0184
Epoch: 3|  Loss:  1.821 |Global loss: 5.8358| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.0185
Epoch: 0|  Loss:  1.6141 |Global loss: 5.7764| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.9854
Epoch: 1|  Loss:  1.5454 |Global loss: 5.7781| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 1.0144
Epoch: 2|  Loss:  1.6228 |Global loss: 5.8108| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 1.0047
Epoch: 3|  Loss:  1.5767 |Global loss: 5.769| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.0517
Epoch: 0|  Loss:  1.7207 |Global loss: 5.8069| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0072
Epoch: 1|  Loss:  1.6378 |Global loss: 5.813| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 1.0
Epoch: 2|  Loss:  1.5648 |Global loss: 5.7884| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9901
Epoch: 3|  Loss:  1.5713 |Global loss: 5.823| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 1.0255
Epoch: 0|  Loss:  1.7654 |Global loss: 5.7967| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 1.0186
Epoch: 1|  Loss:  1.7314 |Global loss: 5.7705| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 1.006
Epoch: 2|  Loss:  1.6522 |Global loss: 5.7835| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 3|  NKD Loss: 0.9693
Epoch: 3|  Loss:  1.5928 |Global loss: 5.78| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 1.0987
Epoch: 0|  Loss:  2.2174 |Global loss: 5.7481| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.1057
Epoch: 1|  Loss:  2.2052 |Global loss: 5.745| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.1023
Epoch: 2|  Loss:  2.2067 |Global loss: 5.7515| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.1012
Epoch: 3|  Loss:  2.1206 |Global loss: 5.7351| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 1.0578
Epoch: 0|  Loss:  1.9177 |Global loss: 5.7741| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0254
Epoch: 1|  Loss:  1.763 |Global loss: 5.7562| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 1.0248
Epoch: 2|  Loss:  1.7748 |Global loss: 5.7783| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 1.01
Epoch: 3|  Loss:  1.7098 |Global loss: 5.7631| Local H loss: 0.0321  | Global H loss: 0.0321
------------------------- time cost ------------------------- 4.597813606262207
Chosen Clients:  [10, 1, 13, 12, 8, 0]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.65, 0.192, 0.833, 0.833, 0.45, 0.267, 0.908, 0.125, 0.9, 0.717, 0.725, 0.6, 0.142, 0.275]
AUC in each clients:  [107.28, 115.167, 108.69, 116.746, 117.551, 112.775, 109.647, 117.682, 109.765, 118.623, 115.961, 115.312, 114.016, 105.78, 110.032]
F1 Score:  [0.01, 0.626, 0.178, 0.768, 0.764, 0.423, 0.252, 0.911, 0.084, 0.869, 0.748, 0.76, 0.634, 0.095, 0.258]
Recall Score:  [0.083, 0.67, 0.25, 0.81, 0.81, 0.481, 0.324, 0.924, 0.167, 0.9, 0.802, 0.81, 0.684, 0.167, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1486
Averaged Test Accurancy: 0.5122
Averaged Test AUC: 0.9417
Averaged Test F1_score: 0.4920
Averaged Test Recal score: 0.5471
Std Test Accurancy: 0.2985
Std Test AUC: 0.0335
Std Test F1: 0.0026
Std Test Recall: 0.0024
Epoch: 0|  NKD Loss: 1.004
Epoch: 0|  Loss:  1.562 |Global loss: 5.7423| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 0.9569
Epoch: 1|  Loss:  1.4716 |Global loss: 5.7337| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.9751
Epoch: 2|  Loss:  1.4742 |Global loss: 5.7273| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9729
Epoch: 3|  Loss:  1.5037 |Global loss: 5.747| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 1.0604
Epoch: 0|  Loss:  1.8962 |Global loss: 5.7936| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0593
Epoch: 1|  Loss:  1.856 |Global loss: 5.7953| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 1.0347
Epoch: 2|  Loss:  1.7656 |Global loss: 5.7707| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 1.059
Epoch: 3|  Loss:  1.8175 |Global loss: 5.7958| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.1496
Epoch: 0|  Loss:  2.9029 |Global loss: 5.7268| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 1.1825
Epoch: 1|  Loss:  2.8735 |Global loss: 5.6946| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 1.1995
Epoch: 2|  Loss:  2.9226 |Global loss: 5.7076| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 1.1793
Epoch: 3|  Loss:  2.8225 |Global loss: 5.695| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 1.0702
Epoch: 0|  Loss:  1.8701 |Global loss: 5.8299| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.013
Epoch: 1|  Loss:  1.7283 |Global loss: 5.8161| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 1.015
Epoch: 2|  Loss:  1.709 |Global loss: 5.809| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 1.0158
Epoch: 3|  Loss:  1.7051 |Global loss: 5.8116| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 1.1716
Epoch: 0|  Loss:  2.5841 |Global loss: 5.744| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.1549
Epoch: 1|  Loss:  2.4328 |Global loss: 5.7239| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1469
Epoch: 2|  Loss:  2.3827 |Global loss: 5.7265| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.1242
Epoch: 3|  Loss:  2.2963 |Global loss: 5.7457| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.197
Epoch: 0|  Loss:  3.091 |Global loss: 5.6564| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 1.2159
Epoch: 1|  Loss:  3.0408 |Global loss: 5.6426| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 2|  NKD Loss: 1.1901
Epoch: 2|  Loss:  2.9483 |Global loss: 5.6631| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 3|  NKD Loss: 1.1846
Epoch: 3|  Loss:  2.8946 |Global loss: 5.6798| Local H loss: 0.0226  | Global H loss: 0.0226
------------------------- time cost ------------------------- 4.960341215133667
Chosen Clients:  [11, 0, 7, 4, 14, 9]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.725, 0.192, 0.833, 0.833, 0.45, 0.267, 0.908, 0.242, 0.9, 0.725, 0.725, 0.617, 0.233, 0.275]
AUC in each clients:  [108.242, 115.854, 108.69, 116.746, 117.551, 112.775, 109.647, 117.682, 110.88, 118.623, 115.936, 115.312, 114.743, 107.61, 110.032]
F1 Score:  [0.01, 0.683, 0.178, 0.768, 0.764, 0.423, 0.252, 0.911, 0.232, 0.869, 0.753, 0.76, 0.641, 0.175, 0.258]
Recall Score:  [0.083, 0.736, 0.25, 0.81, 0.81, 0.481, 0.324, 0.924, 0.294, 0.9, 0.81, 0.81, 0.695, 0.243, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1084
Averaged Test Accurancy: 0.5328
Averaged Test AUC: 0.9446
Averaged Test F1_score: 0.5118
Averaged Test Recal score: 0.5663
Std Test Accurancy: 0.2860
Std Test AUC: 0.0309
Std Test F1: 0.0024
Std Test Recall: 0.0023
Epoch: 0|  NKD Loss: 1.005
Epoch: 0|  Loss:  1.645 |Global loss: 5.7896| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.9752
Epoch: 1|  Loss:  1.5948 |Global loss: 5.8008| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 0.9915
Epoch: 2|  Loss:  1.5709 |Global loss: 5.778| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.9835
Epoch: 3|  Loss:  1.5412 |Global loss: 5.7651| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 1.1688
Epoch: 0|  Loss:  2.8128 |Global loss: 5.6975| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1832
Epoch: 1|  Loss:  2.7359 |Global loss: 5.678| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1601
Epoch: 2|  Loss:  2.6306 |Global loss: 5.6915| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.1721
Epoch: 3|  Loss:  2.6074 |Global loss: 5.6889| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 1.042
Epoch: 0|  Loss:  1.7242 |Global loss: 5.8276| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 1.0121
Epoch: 1|  Loss:  1.6216 |Global loss: 5.828| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9994
Epoch: 2|  Loss:  1.5866 |Global loss: 5.807| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 1.0205
Epoch: 3|  Loss:  1.699 |Global loss: 5.8532| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9759
Epoch: 0|  Loss:  1.5075 |Global loss: 5.772| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9634
Epoch: 1|  Loss:  1.5124 |Global loss: 5.7854| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.9665
Epoch: 2|  Loss:  1.5042 |Global loss: 5.7806| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.9502
Epoch: 3|  Loss:  1.4596 |Global loss: 5.7607| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 1.1687
Epoch: 0|  Loss:  2.6988 |Global loss: 5.7103| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1708
Epoch: 1|  Loss:  2.637 |Global loss: 5.6914| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.1769
Epoch: 2|  Loss:  2.6785 |Global loss: 5.705| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 1.1434
Epoch: 3|  Loss:  2.5061 |Global loss: 5.6955| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.8976
Epoch: 0|  Loss:  1.1747 |Global loss: 5.6957| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.1956 |Global loss: 5.6863| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9192
Epoch: 2|  Loss:  1.2184 |Global loss: 5.6911| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9122
Epoch: 3|  Loss:  1.1737 |Global loss: 5.6795| Local H loss: 0.0376  | Global H loss: 0.0376
------------------------- time cost ------------------------- 4.852592945098877
Chosen Clients:  [11, 6, 4, 10, 1, 14]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.192, 0.725, 0.192, 0.833, 0.833, 0.45, 0.267, 0.875, 0.242, 0.942, 0.725, 0.725, 0.617, 0.233, 0.35]
AUC in each clients:  [109.942, 115.854, 108.69, 116.746, 117.688, 112.775, 109.647, 117.526, 110.88, 118.298, 115.936, 115.695, 114.743, 107.61, 111.797]
F1 Score:  [0.127, 0.683, 0.178, 0.768, 0.764, 0.423, 0.252, 0.856, 0.232, 0.935, 0.753, 0.756, 0.641, 0.175, 0.343]
Recall Score:  [0.182, 0.736, 0.25, 0.81, 0.81, 0.481, 0.324, 0.887, 0.294, 0.942, 0.81, 0.81, 0.695, 0.243, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0340
Averaged Test Accurancy: 0.5467
Averaged Test AUC: 0.9466
Averaged Test F1_score: 0.5257
Averaged Test Recal score: 0.5787
Std Test Accurancy: 0.2706
Std Test AUC: 0.0289
Std Test F1: 0.0023
Std Test Recall: 0.0022
Epoch: 0|  NKD Loss: 0.9968
Epoch: 0|  Loss:  1.5698 |Global loss: 5.7769| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.9575
Epoch: 1|  Loss:  1.4719 |Global loss: 5.7809| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.9413
Epoch: 2|  Loss:  1.4768 |Global loss: 5.793| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.9679
Epoch: 3|  Loss:  1.4556 |Global loss: 5.7777| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 0|  NKD Loss: 1.1508
Epoch: 0|  Loss:  2.658 |Global loss: 5.7152| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.155
Epoch: 1|  Loss:  2.5911 |Global loss: 5.7109| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.164
Epoch: 2|  Loss:  2.5851 |Global loss: 5.6989| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.1528
Epoch: 3|  Loss:  2.4918 |Global loss: 5.7046| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9737
Epoch: 0|  Loss:  1.511 |Global loss: 5.7778| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.966
Epoch: 1|  Loss:  1.4596 |Global loss: 5.7626| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 0.9594
Epoch: 2|  Loss:  1.4493 |Global loss: 5.7713| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9639
Epoch: 3|  Loss:  1.4545 |Global loss: 5.7628| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 1.0129
Epoch: 0|  Loss:  1.5483 |Global loss: 5.7749| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.9735
Epoch: 1|  Loss:  1.468 |Global loss: 5.7411| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.9793
Epoch: 2|  Loss:  1.4497 |Global loss: 5.7308| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9764
Epoch: 3|  Loss:  1.4951 |Global loss: 5.7369| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.0673
Epoch: 0|  Loss:  1.7979 |Global loss: 5.7826| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 1.0288
Epoch: 1|  Loss:  1.7758 |Global loss: 5.8011| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 1.025
Epoch: 2|  Loss:  1.7086 |Global loss: 5.7676| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0213
Epoch: 3|  Loss:  1.6502 |Global loss: 5.7614| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 1.128
Epoch: 0|  Loss:  2.4626 |Global loss: 5.7355| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 1.1288
Epoch: 1|  Loss:  2.3532 |Global loss: 5.712| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.1053
Epoch: 2|  Loss:  2.2152 |Global loss: 5.715| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0845
Epoch: 3|  Loss:  2.1613 |Global loss: 5.7258| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 5.028319835662842
Chosen Clients:  [14, 7, 10, 0, 4, 3]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.192, 0.85, 0.192, 0.833, 0.833, 0.45, 0.267, 0.875, 0.242, 0.942, 0.742, 0.75, 0.617, 0.233, 0.35]
AUC in each clients:  [109.942, 116.866, 108.69, 116.746, 117.895, 112.775, 110.75, 117.526, 110.88, 118.298, 115.671, 116.513, 114.743, 107.61, 112.666]
F1 Score:  [0.127, 0.783, 0.178, 0.768, 0.764, 0.423, 0.252, 0.856, 0.232, 0.935, 0.737, 0.79, 0.641, 0.175, 0.343]
Recall Score:  [0.182, 0.821, 0.25, 0.81, 0.81, 0.481, 0.324, 0.887, 0.294, 0.942, 0.782, 0.827, 0.695, 0.243, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9806
Averaged Test Accurancy: 0.5578
Averaged Test AUC: 0.9487
Averaged Test F1_score: 0.5336
Averaged Test Recal score: 0.5837
Std Test Accurancy: 0.2796
Std Test AUC: 0.0289
Std Test F1: 0.0024
Std Test Recall: 0.0022
Epoch: 0|  NKD Loss: 1.0908
Epoch: 0|  Loss:  2.1707 |Global loss: 5.7476| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 1.1182
Epoch: 1|  Loss:  2.233 |Global loss: 5.75| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 1.0659
Epoch: 2|  Loss:  2.0449 |Global loss: 5.7417| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 1.0749
Epoch: 3|  Loss:  2.002 |Global loss: 5.7342| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.9823
Epoch: 0|  Loss:  1.4813 |Global loss: 5.7918| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.9718
Epoch: 1|  Loss:  1.4616 |Global loss: 5.7943| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.956
Epoch: 2|  Loss:  1.4492 |Global loss: 5.8115| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9318
Epoch: 3|  Loss:  1.3738 |Global loss: 5.7955| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.9752
Epoch: 0|  Loss:  1.3909 |Global loss: 5.7177| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9844
Epoch: 1|  Loss:  1.4578 |Global loss: 5.7618| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9757
Epoch: 2|  Loss:  1.4752 |Global loss: 5.7244| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9774
Epoch: 3|  Loss:  1.3753 |Global loss: 5.7333| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 1.1334
Epoch: 0|  Loss:  2.4879 |Global loss: 5.7181| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.1447
Epoch: 1|  Loss:  2.4483 |Global loss: 5.7046| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 1.1361
Epoch: 2|  Loss:  2.385 |Global loss: 5.7192| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.1114
Epoch: 3|  Loss:  2.2987 |Global loss: 5.7191| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9607
Epoch: 0|  Loss:  1.4305 |Global loss: 5.7589| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.9474
Epoch: 1|  Loss:  1.403 |Global loss: 5.7514| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9544
Epoch: 2|  Loss:  1.4481 |Global loss: 5.7636| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9552
Epoch: 3|  Loss:  1.4383 |Global loss: 5.7561| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 1.0782
Epoch: 0|  Loss:  1.9388 |Global loss: 5.8318| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 1.0087
Epoch: 1|  Loss:  1.6748 |Global loss: 5.7483| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 1.0252
Epoch: 2|  Loss:  1.7174 |Global loss: 5.7638| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0148
Epoch: 3|  Loss:  1.7136 |Global loss: 5.7867| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.776789903640747
Chosen Clients:  [9, 5, 1, 2, 7, 14]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.458, 0.85, 0.192, 0.708, 0.833, 0.45, 0.267, 0.975, 0.242, 0.942, 0.725, 0.75, 0.617, 0.233, 0.433]
AUC in each clients:  [112.418, 116.866, 108.69, 116.728, 117.813, 112.775, 110.75, 119.023, 110.88, 118.298, 116.358, 116.513, 114.743, 107.61, 112.924]
F1 Score:  [0.405, 0.783, 0.178, 0.675, 0.764, 0.423, 0.252, 0.973, 0.232, 0.935, 0.753, 0.79, 0.641, 0.175, 0.416]
Recall Score:  [0.451, 0.821, 0.25, 0.731, 0.81, 0.481, 0.324, 0.977, 0.294, 0.942, 0.81, 0.827, 0.695, 0.243, 0.477]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9257
Averaged Test Accurancy: 0.5783
Averaged Test AUC: 0.9513
Averaged Test F1_score: 0.5597
Averaged Test Recal score: 0.6089
Std Test Accurancy: 0.2618
Std Test AUC: 0.0289
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.169 |Global loss: 5.6845| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.8901
Epoch: 1|  Loss:  1.1331 |Global loss: 5.6806| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.9015
Epoch: 2|  Loss:  1.1586 |Global loss: 5.6801| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.9242
Epoch: 3|  Loss:  1.2207 |Global loss: 5.699| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 1.0781
Epoch: 0|  Loss:  2.107 |Global loss: 5.7705| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 1.0925
Epoch: 1|  Loss:  2.0861 |Global loss: 5.7484| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.0771
Epoch: 2|  Loss:  2.0148 |Global loss: 5.7575| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 1.0623
Epoch: 3|  Loss:  1.9615 |Global loss: 5.7576| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.0277
Epoch: 0|  Loss:  1.6972 |Global loss: 5.7829| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9996
Epoch: 1|  Loss:  1.5904 |Global loss: 5.7889| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.9896
Epoch: 2|  Loss:  1.5865 |Global loss: 5.7754| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9955
Epoch: 3|  Loss:  1.5699 |Global loss: 5.7746| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.1439
Epoch: 0|  Loss:  2.7013 |Global loss: 5.7303| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.153
Epoch: 1|  Loss:  2.6581 |Global loss: 5.7101| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.1868
Epoch: 2|  Loss:  2.6511 |Global loss: 5.6992| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 1.1637
Epoch: 3|  Loss:  2.6386 |Global loss: 5.6996| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9819
Epoch: 0|  Loss:  1.4866 |Global loss: 5.806| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9712
Epoch: 1|  Loss:  1.4558 |Global loss: 5.8264| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9354
Epoch: 2|  Loss:  1.3618 |Global loss: 5.7937| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.9303
Epoch: 3|  Loss:  1.3203 |Global loss: 5.7846| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 1.0633
Epoch: 0|  Loss:  2.0522 |Global loss: 5.777| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 1.1147
Epoch: 1|  Loss:  2.1539 |Global loss: 5.7838| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0812
Epoch: 2|  Loss:  2.0155 |Global loss: 5.7646| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 1.0496
Epoch: 3|  Loss:  1.8576 |Global loss: 5.7354| Local H loss: 0.0351  | Global H loss: 0.0351
------------------------- time cost ------------------------- 5.14271354675293
Chosen Clients:  [5, 1, 11, 7, 6, 13]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.458, 0.858, 0.192, 0.708, 0.833, 0.55, 0.267, 0.975, 0.242, 0.917, 0.725, 0.75, 0.617, 0.233, 0.525]
AUC in each clients:  [112.418, 117.536, 109.276, 116.728, 117.813, 114.161, 110.75, 118.923, 110.88, 118.536, 116.358, 116.513, 114.743, 107.61, 113.783]
F1 Score:  [0.405, 0.787, 0.178, 0.675, 0.764, 0.506, 0.252, 0.973, 0.232, 0.9, 0.753, 0.79, 0.641, 0.175, 0.53]
Recall Score:  [0.451, 0.826, 0.25, 0.731, 0.81, 0.567, 0.324, 0.977, 0.294, 0.917, 0.81, 0.827, 0.695, 0.243, 0.565]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8759
Averaged Test Accurancy: 0.5900
Averaged Test AUC: 0.9533
Averaged Test F1_score: 0.5707
Averaged Test Recal score: 0.6191
Std Test Accurancy: 0.2556
Std Test AUC: 0.0285
Std Test F1: 0.0022
Std Test Recall: 0.0020
Epoch: 0|  NKD Loss: 1.0826
Epoch: 0|  Loss:  1.9856 |Global loss: 5.7706| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0787
Epoch: 1|  Loss:  1.9894 |Global loss: 5.7799| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0539
Epoch: 2|  Loss:  1.8829 |Global loss: 5.7582| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 1.0566
Epoch: 3|  Loss:  1.9074 |Global loss: 5.7661| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 1.0188
Epoch: 0|  Loss:  1.5934 |Global loss: 5.7878| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.9924
Epoch: 1|  Loss:  1.5433 |Global loss: 5.7812| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.9893
Epoch: 2|  Loss:  1.5184 |Global loss: 5.7571| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 1.0135
Epoch: 3|  Loss:  1.5851 |Global loss: 5.7955| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.9486
Epoch: 0|  Loss:  1.3926 |Global loss: 5.7733| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 1|  NKD Loss: 0.9487
Epoch: 1|  Loss:  1.3799 |Global loss: 5.7535| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 2|  NKD Loss: 0.9321
Epoch: 2|  Loss:  1.3542 |Global loss: 5.7551| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 3|  NKD Loss: 0.9408
Epoch: 3|  Loss:  1.344 |Global loss: 5.7511| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 0|  NKD Loss: 0.9638
Epoch: 0|  Loss:  1.3895 |Global loss: 5.8122| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.9465
Epoch: 1|  Loss:  1.3951 |Global loss: 5.8156| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9332
Epoch: 2|  Loss:  1.3342 |Global loss: 5.7927| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9196
Epoch: 3|  Loss:  1.2645 |Global loss: 5.7855| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 1.1332
Epoch: 0|  Loss:  2.4892 |Global loss: 5.737| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.1377
Epoch: 1|  Loss:  2.4451 |Global loss: 5.7158| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 1.125
Epoch: 2|  Loss:  2.3789 |Global loss: 5.7242| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.1316
Epoch: 3|  Loss:  2.377 |Global loss: 5.7105| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.1553
Epoch: 0|  Loss:  2.8033 |Global loss: 5.7126| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1694
Epoch: 1|  Loss:  2.7096 |Global loss: 5.6912| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 1.1518
Epoch: 2|  Loss:  2.7118 |Global loss: 5.6948| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.1648
Epoch: 3|  Loss:  2.6932 |Global loss: 5.6965| Local H loss: 0.0253  | Global H loss: 0.0253
------------------------- time cost ------------------------- 4.764423370361328
Chosen Clients:  [12, 9, 11, 4, 0, 1]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.458, 0.85, 0.192, 0.708, 0.833, 0.633, 0.275, 0.975, 0.242, 0.917, 0.725, 0.85, 0.617, 0.275, 0.525]
AUC in each clients:  [112.418, 117.556, 109.276, 116.728, 117.813, 114.861, 111.723, 119.042, 110.88, 118.536, 116.358, 117.389, 114.743, 107.844, 113.783]
F1 Score:  [0.405, 0.779, 0.178, 0.675, 0.764, 0.634, 0.276, 0.973, 0.232, 0.9, 0.753, 0.857, 0.641, 0.245, 0.53]
Recall Score:  [0.451, 0.819, 0.25, 0.731, 0.81, 0.672, 0.338, 0.977, 0.294, 0.917, 0.81, 0.894, 0.695, 0.303, 0.565]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8530
Averaged Test Accurancy: 0.6050
Averaged Test AUC: 0.9550
Averaged Test F1_score: 0.5895
Averaged Test Recal score: 0.6351
Std Test Accurancy: 0.2557
Std Test AUC: 0.0282
Std Test F1: 0.0021
Std Test Recall: 0.0020
Epoch: 0|  NKD Loss: 1.0065
Epoch: 0|  Loss:  1.6538 |Global loss: 5.7952| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.994
Epoch: 1|  Loss:  1.6398 |Global loss: 5.7992| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 1.0537
Epoch: 2|  Loss:  1.7648 |Global loss: 5.829| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 1.0477
Epoch: 3|  Loss:  1.7195 |Global loss: 5.8213| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8965
Epoch: 0|  Loss:  1.128 |Global loss: 5.6559| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.8977
Epoch: 1|  Loss:  1.1237 |Global loss: 5.662| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.8856
Epoch: 2|  Loss:  1.1065 |Global loss: 5.6632| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.9082
Epoch: 3|  Loss:  1.1523 |Global loss: 5.6776| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9215
Epoch: 0|  Loss:  1.284 |Global loss: 5.7641| Local H loss: 0.0444  | Global H loss: 0.0444
Epoch: 1|  NKD Loss: 0.9124
Epoch: 1|  Loss:  1.2653 |Global loss: 5.7505| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 2|  NKD Loss: 0.9258
Epoch: 2|  Loss:  1.2872 |Global loss: 5.7568| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 3|  NKD Loss: 0.9166
Epoch: 3|  Loss:  1.2758 |Global loss: 5.7528| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 0|  NKD Loss: 0.9656
Epoch: 0|  Loss:  1.44 |Global loss: 5.7463| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9229
Epoch: 1|  Loss:  1.4128 |Global loss: 5.7575| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.9553
Epoch: 2|  Loss:  1.4063 |Global loss: 5.7399| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9228
Epoch: 3|  Loss:  1.3634 |Global loss: 5.7428| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 1.0866
Epoch: 0|  Loss:  2.2385 |Global loss: 5.7482| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 1.0935
Epoch: 1|  Loss:  2.2064 |Global loss: 5.7383| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 1.0832
Epoch: 2|  Loss:  2.1609 |Global loss: 5.7381| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 1.0798
Epoch: 3|  Loss:  2.1008 |Global loss: 5.7328| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 0.9834
Epoch: 0|  Loss:  1.5047 |Global loss: 5.7756| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0026
Epoch: 1|  Loss:  1.4955 |Global loss: 5.7796| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.9869
Epoch: 2|  Loss:  1.5197 |Global loss: 5.7774| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9891
Epoch: 3|  Loss:  1.4795 |Global loss: 5.7586| Local H loss: 0.0333  | Global H loss: 0.0333
------------------------- time cost ------------------------- 4.995386600494385
Chosen Clients:  [4, 8, 13, 12, 11, 7]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.575, 0.858, 0.192, 0.708, 0.833, 0.633, 0.275, 0.975, 0.242, 0.983, 0.725, 0.975, 0.617, 0.275, 0.525]
AUC in each clients:  [114.51, 117.183, 109.276, 116.728, 117.916, 114.861, 111.723, 119.042, 110.88, 118.841, 116.358, 117.716, 114.583, 107.844, 113.783]
F1 Score:  [0.572, 0.787, 0.178, 0.675, 0.764, 0.634, 0.276, 0.973, 0.232, 0.981, 0.753, 0.973, 0.65, 0.245, 0.53]
Recall Score:  [0.612, 0.826, 0.25, 0.731, 0.81, 0.672, 0.338, 0.977, 0.294, 0.984, 0.81, 0.977, 0.695, 0.303, 0.565]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8208
Averaged Test Accurancy: 0.6261
Averaged Test AUC: 0.9562
Averaged Test F1_score: 0.6149
Averaged Test Recal score: 0.6563
Std Test Accurancy: 0.2684
Std Test AUC: 0.0280
Std Test F1: 0.0022
Std Test Recall: 0.0021
Epoch: 0|  NKD Loss: 0.9603
Epoch: 0|  Loss:  1.4087 |Global loss: 5.7454| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9345
Epoch: 1|  Loss:  1.3953 |Global loss: 5.7373| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.9515
Epoch: 2|  Loss:  1.379 |Global loss: 5.727| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9226
Epoch: 3|  Loss:  1.3509 |Global loss: 5.7242| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 1.1107
Epoch: 0|  Loss:  2.2482 |Global loss: 5.7499| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.1206
Epoch: 1|  Loss:  2.2552 |Global loss: 5.7325| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.1189
Epoch: 2|  Loss:  2.1794 |Global loss: 5.7226| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 1.1186
Epoch: 3|  Loss:  2.1151 |Global loss: 5.7089| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.1465
Epoch: 0|  Loss:  2.6576 |Global loss: 5.7054| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.1495
Epoch: 1|  Loss:  2.5816 |Global loss: 5.6881| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1296
Epoch: 2|  Loss:  2.5551 |Global loss: 5.6972| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.1183
Epoch: 3|  Loss:  2.54 |Global loss: 5.7054| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.0008
Epoch: 0|  Loss:  1.5723 |Global loss: 5.7874| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.9814
Epoch: 1|  Loss:  1.5837 |Global loss: 5.7966| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 1.0029
Epoch: 2|  Loss:  1.615 |Global loss: 5.8128| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.9935
Epoch: 3|  Loss:  1.5739 |Global loss: 5.7845| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9188
Epoch: 0|  Loss:  1.2411 |Global loss: 5.7358| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 1|  NKD Loss: 0.9183
Epoch: 1|  Loss:  1.2617 |Global loss: 5.734| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 2|  NKD Loss: 0.8716
Epoch: 2|  Loss:  1.1859 |Global loss: 5.7555| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 3|  NKD Loss: 0.894
Epoch: 3|  Loss:  1.1856 |Global loss: 5.729| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.9684
Epoch: 0|  Loss:  1.4003 |Global loss: 5.7893| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9228
Epoch: 1|  Loss:  1.2756 |Global loss: 5.7686| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9197
Epoch: 2|  Loss:  1.347 |Global loss: 5.8076| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9104
Epoch: 3|  Loss:  1.2873 |Global loss: 5.7884| Local H loss: 0.0379  | Global H loss: 0.0379
------------------------- time cost ------------------------- 5.175477027893066
Chosen Clients:  [1, 3, 14, 6, 10, 9]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.575, 0.858, 0.192, 0.708, 0.833, 0.633, 0.275, 0.975, 0.458, 0.983, 0.725, 0.975, 0.675, 0.292, 0.525]
AUC in each clients:  [114.51, 117.183, 109.276, 116.728, 117.958, 114.861, 111.723, 119.066, 112.96, 118.841, 116.358, 118.605, 115.259, 109.405, 113.783]
F1 Score:  [0.572, 0.787, 0.178, 0.675, 0.764, 0.634, 0.276, 0.973, 0.415, 0.981, 0.753, 0.973, 0.678, 0.26, 0.53]
Recall Score:  [0.612, 0.826, 0.25, 0.731, 0.81, 0.672, 0.338, 0.977, 0.484, 0.984, 0.81, 0.977, 0.734, 0.326, 0.565]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7814
Averaged Test Accurancy: 0.6456
Averaged Test AUC: 0.9592
Averaged Test F1_score: 0.6299
Averaged Test Recal score: 0.6731
Std Test Accurancy: 0.2511
Std Test AUC: 0.0258
Std Test F1: 0.0021
Std Test Recall: 0.0019
Epoch: 0|  NKD Loss: 0.9624
Epoch: 0|  Loss:  1.415 |Global loss: 5.7505| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.9704
Epoch: 1|  Loss:  1.4684 |Global loss: 5.7743| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.9683
Epoch: 2|  Loss:  1.4302 |Global loss: 5.7441| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.9687
Epoch: 3|  Loss:  1.4345 |Global loss: 5.7479| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9925
Epoch: 0|  Loss:  1.5714 |Global loss: 5.7307| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 1.0186
Epoch: 1|  Loss:  1.6686 |Global loss: 5.7901| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.9729
Epoch: 2|  Loss:  1.5206 |Global loss: 5.7309| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.5955 |Global loss: 5.7466| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 1.0535
Epoch: 0|  Loss:  1.8858 |Global loss: 5.7379| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 1.0376
Epoch: 1|  Loss:  1.8383 |Global loss: 5.7478| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 1.0199
Epoch: 2|  Loss:  1.7328 |Global loss: 5.7396| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 1.0774
Epoch: 3|  Loss:  1.9525 |Global loss: 5.7596| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 1.122
Epoch: 0|  Loss:  2.3489 |Global loss: 5.726| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.1146
Epoch: 1|  Loss:  2.2649 |Global loss: 5.723| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.1205
Epoch: 2|  Loss:  2.3029 |Global loss: 5.7248| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.0903
Epoch: 3|  Loss:  2.1925 |Global loss: 5.6942| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.011
Epoch: 0|  Loss:  1.5622 |Global loss: 5.7692| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9278
Epoch: 1|  Loss:  1.2722 |Global loss: 5.6828| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9475
Epoch: 2|  Loss:  1.3382 |Global loss: 5.7228| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.95
Epoch: 3|  Loss:  1.3453 |Global loss: 5.6978| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.8983
Epoch: 0|  Loss:  1.1293 |Global loss: 5.6509| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.8961
Epoch: 1|  Loss:  1.1325 |Global loss: 5.6611| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.889
Epoch: 2|  Loss:  1.1304 |Global loss: 5.6696| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.8734
Epoch: 3|  Loss:  1.1033 |Global loss: 5.6419| Local H loss: 0.0374  | Global H loss: 0.0374
------------------------- time cost ------------------------- 5.178065299987793
Chosen Clients:  [12, 13, 14, 4, 8, 10]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.575, 0.917, 0.192, 0.808, 0.833, 0.633, 0.492, 0.975, 0.458, 0.983, 0.842, 0.975, 0.675, 0.292, 0.625]
AUC in each clients:  [114.51, 118.471, 109.276, 117.448, 117.958, 114.861, 112.789, 119.066, 112.96, 119.305, 116.673, 118.605, 115.259, 109.405, 114.877]
F1 Score:  [0.572, 0.877, 0.178, 0.733, 0.764, 0.634, 0.496, 0.973, 0.415, 0.981, 0.849, 0.973, 0.678, 0.26, 0.648]
Recall Score:  [0.612, 0.91, 0.25, 0.764, 0.81, 0.672, 0.553, 0.977, 0.484, 0.984, 0.888, 0.977, 0.734, 0.326, 0.694]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7568
Averaged Test Accurancy: 0.6850
Averaged Test AUC: 0.9619
Averaged Test F1_score: 0.6687
Averaged Test Recal score: 0.7090
Std Test Accurancy: 0.2419
Std Test AUC: 0.0262
Std Test F1: 0.0020
Std Test Recall: 0.0019
Epoch: 0|  NKD Loss: 0.9688
Epoch: 0|  Loss:  1.487 |Global loss: 5.7647| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9932
Epoch: 1|  Loss:  1.5643 |Global loss: 5.7811| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.993
Epoch: 2|  Loss:  1.5414 |Global loss: 5.7789| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 1.0232
Epoch: 3|  Loss:  1.6489 |Global loss: 5.7865| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.1418
Epoch: 0|  Loss:  2.5539 |Global loss: 5.6973| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.1353
Epoch: 1|  Loss:  2.5095 |Global loss: 5.6874| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 1.143
Epoch: 2|  Loss:  2.5175 |Global loss: 5.664| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.1289
Epoch: 3|  Loss:  2.4349 |Global loss: 5.6455| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.0158
Epoch: 0|  Loss:  1.7377 |Global loss: 5.7471| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 1.0258
Epoch: 1|  Loss:  1.7233 |Global loss: 5.7316| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9897
Epoch: 2|  Loss:  1.6298 |Global loss: 5.7226| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 1.0058
Epoch: 3|  Loss:  1.6205 |Global loss: 5.6951| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9339
Epoch: 0|  Loss:  1.3481 |Global loss: 5.7124| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.9356
Epoch: 1|  Loss:  1.3905 |Global loss: 5.7243| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.9268
Epoch: 2|  Loss:  1.357 |Global loss: 5.702| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.8969
Epoch: 3|  Loss:  1.3189 |Global loss: 5.6941| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 1.0855
Epoch: 0|  Loss:  2.0205 |Global loss: 5.7193| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.059
Epoch: 1|  Loss:  1.9744 |Global loss: 5.7168| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 1.096
Epoch: 2|  Loss:  2.0686 |Global loss: 5.7167| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 1.0593
Epoch: 3|  Loss:  1.9549 |Global loss: 5.694| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9435
Epoch: 0|  Loss:  1.2947 |Global loss: 5.7073| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.9176
Epoch: 1|  Loss:  1.2947 |Global loss: 5.7314| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9367
Epoch: 2|  Loss:  1.2934 |Global loss: 5.7033| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9306
Epoch: 3|  Loss:  1.253 |Global loss: 5.6802| Local H loss: 0.0376  | Global H loss: 0.0376
------------------------- time cost ------------------------- 4.891021490097046
Chosen Clients:  [4, 10, 3, 8, 5, 13]

-------------Round number: 59-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.575, 0.917, 0.192, 0.808, 0.833, 0.633, 0.492, 0.975, 0.583, 0.983, 0.85, 0.975, 0.65, 0.292, 0.75]
AUC in each clients:  [114.51, 118.471, 109.276, 117.448, 117.866, 114.861, 112.789, 119.066, 115.753, 119.305, 117.252, 118.605, 113.166, 110.731, 115.772]
F1 Score:  [0.572, 0.877, 0.178, 0.733, 0.764, 0.634, 0.496, 0.973, 0.506, 0.981, 0.853, 0.973, 0.665, 0.254, 0.754]
Recall Score:  [0.612, 0.91, 0.25, 0.764, 0.81, 0.672, 0.553, 0.977, 0.567, 0.984, 0.894, 0.977, 0.715, 0.326, 0.803]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7454
Averaged Test Accurancy: 0.7006
Averaged Test AUC: 0.9638
Averaged Test F1_score: 0.6809
Averaged Test Recal score: 0.7209
Std Test Accurancy: 0.2363
Std Test AUC: 0.0249
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.948
Epoch: 0|  Loss:  1.354 |Global loss: 5.687| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9148
Epoch: 1|  Loss:  1.3198 |Global loss: 5.6741| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.9375
Epoch: 2|  Loss:  1.3341 |Global loss: 5.6754| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9111
Epoch: 3|  Loss:  1.3152 |Global loss: 5.6449| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9352
Epoch: 0|  Loss:  1.2555 |Global loss: 5.6918| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.9238
Epoch: 1|  Loss:  1.257 |Global loss: 5.6853| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.9413
Epoch: 2|  Loss:  1.3057 |Global loss: 5.6826| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.938
Epoch: 3|  Loss:  1.306 |Global loss: 5.7001| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9999
Epoch: 0|  Loss:  1.5532 |Global loss: 5.7288| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 0.9798
Epoch: 1|  Loss:  1.5081 |Global loss: 5.6933| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.9614
Epoch: 2|  Loss:  1.4101 |Global loss: 5.6788| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9563
Epoch: 3|  Loss:  1.4243 |Global loss: 5.6969| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 1.0642
Epoch: 0|  Loss:  1.8631 |Global loss: 5.714| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 1.0463
Epoch: 1|  Loss:  1.8287 |Global loss: 5.6833| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 1.0539
Epoch: 2|  Loss:  1.787 |Global loss: 5.6885| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.0279
Epoch: 3|  Loss:  1.7313 |Global loss: 5.6551| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 1.051
Epoch: 0|  Loss:  1.8954 |Global loss: 5.7561| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 1.0101
Epoch: 1|  Loss:  1.8021 |Global loss: 5.7369| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.0376
Epoch: 2|  Loss:  1.8349 |Global loss: 5.7049| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 1.0356
Epoch: 3|  Loss:  1.815 |Global loss: 5.6826| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 1.1013
Epoch: 0|  Loss:  2.3684 |Global loss: 5.6731| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.1294
Epoch: 1|  Loss:  2.4111 |Global loss: 5.6647| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.1052
Epoch: 2|  Loss:  2.3231 |Global loss: 5.6286| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 1.0902
Epoch: 3|  Loss:  2.3173 |Global loss: 5.6398| Local H loss: 0.0288  | Global H loss: 0.0288
------------------------- time cost ------------------------- 5.0523130893707275
Chosen Clients:  [9, 1, 0, 3, 7, 8]

-------------Round number: 60-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.575, 0.917, 0.192, 0.967, 0.85, 0.608, 0.492, 0.975, 0.75, 0.983, 0.975, 0.975, 0.65, 0.375, 0.75]
AUC in each clients:  [114.51, 118.471, 109.276, 118.395, 118.027, 114.713, 112.789, 119.066, 116.921, 119.305, 117.842, 118.605, 113.166, 111.651, 115.772]
F1 Score:  [0.572, 0.877, 0.178, 0.963, 0.797, 0.592, 0.496, 0.973, 0.675, 0.981, 0.974, 0.973, 0.665, 0.339, 0.754]
Recall Score:  [0.612, 0.91, 0.25, 0.965, 0.829, 0.65, 0.553, 0.977, 0.727, 0.984, 0.977, 0.977, 0.715, 0.41, 0.803]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7079
Averaged Test Accurancy: 0.7356
Averaged Test AUC: 0.9658
Averaged Test F1_score: 0.7206
Averaged Test Recal score: 0.7559
Std Test Accurancy: 0.2405
Std Test AUC: 0.0249
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.8989
Epoch: 0|  Loss:  1.1066 |Global loss: 5.5778| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.8562
Epoch: 1|  Loss:  1.0583 |Global loss: 5.5626| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.8947
Epoch: 2|  Loss:  1.1235 |Global loss: 5.5544| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.8665
Epoch: 3|  Loss:  1.0673 |Global loss: 5.4998| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.9871
Epoch: 0|  Loss:  1.4835 |Global loss: 5.7181| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9426
Epoch: 1|  Loss:  1.3543 |Global loss: 5.6556| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.923
Epoch: 2|  Loss:  1.318 |Global loss: 5.6234| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9319
Epoch: 3|  Loss:  1.3288 |Global loss: 5.583| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 1.0509
Epoch: 0|  Loss:  2.0355 |Global loss: 5.6718| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0558
Epoch: 1|  Loss:  2.0249 |Global loss: 5.6289| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0283
Epoch: 2|  Loss:  1.9544 |Global loss: 5.5954| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.9893
Epoch: 3|  Loss:  1.85 |Global loss: 5.5437| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.9178
Epoch: 0|  Loss:  1.3105 |Global loss: 5.6879| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9331
Epoch: 1|  Loss:  1.3063 |Global loss: 5.6483| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.9734
Epoch: 2|  Loss:  1.4622 |Global loss: 5.6763| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9285
Epoch: 3|  Loss:  1.3278 |Global loss: 5.6215| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9156
Epoch: 0|  Loss:  1.2189 |Global loss: 5.6928| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.9398
Epoch: 1|  Loss:  1.357 |Global loss: 5.7199| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9473
Epoch: 2|  Loss:  1.4043 |Global loss: 5.7393| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.9042
Epoch: 3|  Loss:  1.2506 |Global loss: 5.6657| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 1.0282
Epoch: 0|  Loss:  1.6793 |Global loss: 5.6663| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 1.0509
Epoch: 1|  Loss:  1.8599 |Global loss: 5.6766| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 1.018
Epoch: 2|  Loss:  1.6961 |Global loss: 5.6358| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.9783
Epoch: 3|  Loss:  1.6127 |Global loss: 5.6007| Local H loss: 0.0349  | Global H loss: 0.0349
------------------------- time cost ------------------------- 4.644606113433838
Chosen Clients:  [0, 9, 7, 11, 14, 5]

-------------Round number: 61-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.858, 0.192, 0.975, 0.85, 0.608, 0.492, 0.975, 0.833, 0.983, 0.975, 0.975, 0.65, 0.375, 0.75]
AUC in each clients:  [115.158, 117.423, 109.276, 118.586, 118.027, 114.713, 112.789, 119.017, 117.589, 119.407, 117.842, 118.605, 113.166, 111.651, 115.772]
F1 Score:  [0.609, 0.787, 0.178, 0.974, 0.797, 0.592, 0.496, 0.973, 0.77, 0.981, 0.974, 0.973, 0.665, 0.339, 0.754]
Recall Score:  [0.641, 0.826, 0.25, 0.976, 0.829, 0.65, 0.553, 0.977, 0.81, 0.984, 0.977, 0.977, 0.715, 0.41, 0.803]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6709
Averaged Test Accurancy: 0.7394
Averaged Test AUC: 0.9661
Averaged Test F1_score: 0.7241
Averaged Test Recal score: 0.7585
Std Test Accurancy: 0.2388
Std Test AUC: 0.0246
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 1.0194
Epoch: 0|  Loss:  1.8833 |Global loss: 5.622| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 0.9629
Epoch: 1|  Loss:  1.7728 |Global loss: 5.4982| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.9314
Epoch: 2|  Loss:  1.7372 |Global loss: 5.4092| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.8295
Epoch: 3|  Loss:  1.559 |Global loss: 5.2405| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.8636
Epoch: 0|  Loss:  1.0692 |Global loss: 5.5115| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.8394
Epoch: 1|  Loss:  1.0302 |Global loss: 5.4584| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.8439
Epoch: 2|  Loss:  1.0543 |Global loss: 5.4462| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.8224
Epoch: 3|  Loss:  1.0084 |Global loss: 5.3611| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.9345
Epoch: 0|  Loss:  1.2945 |Global loss: 5.6629| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.8863
Epoch: 1|  Loss:  1.2088 |Global loss: 5.6256| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.8515
Epoch: 2|  Loss:  1.1532 |Global loss: 5.6067| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 0.9403
Epoch: 3|  Loss:  1.4193 |Global loss: 5.6191| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.9043
Epoch: 0|  Loss:  1.186 |Global loss: 5.6055| Local H loss: 0.0481  | Global H loss: 0.0481
Epoch: 1|  NKD Loss: 0.8799
Epoch: 1|  Loss:  1.1821 |Global loss: 5.6006| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 2|  NKD Loss: 0.8822
Epoch: 2|  Loss:  1.1743 |Global loss: 5.5729| Local H loss: 0.0479  | Global H loss: 0.0479
Epoch: 3|  NKD Loss: 0.8578
Epoch: 3|  Loss:  1.1162 |Global loss: 5.5389| Local H loss: 0.0489  | Global H loss: 0.0489
Epoch: 0|  NKD Loss: 0.9956
Epoch: 0|  Loss:  1.6686 |Global loss: 5.6317| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.9607
Epoch: 1|  Loss:  1.5246 |Global loss: 5.5422| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.9411
Epoch: 2|  Loss:  1.4706 |Global loss: 5.4686| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9256
Epoch: 3|  Loss:  1.474 |Global loss: 5.3879| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 1.0034
Epoch: 0|  Loss:  1.7029 |Global loss: 5.6234| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9878
Epoch: 1|  Loss:  1.6717 |Global loss: 5.5714| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.9839
Epoch: 2|  Loss:  1.6537 |Global loss: 5.5194| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.9764
Epoch: 3|  Loss:  1.704 |Global loss: 5.4818| Local H loss: 0.0348  | Global H loss: 0.0348
------------------------- time cost ------------------------- 4.857426881790161
Chosen Clients:  [0, 1, 4, 6, 12, 5]

-------------Round number: 62-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.858, 0.192, 0.975, 0.85, 0.658, 0.492, 0.975, 0.833, 0.983, 0.975, 0.975, 0.65, 0.375, 0.808]
AUC in each clients:  [115.714, 117.423, 109.276, 118.586, 118.027, 115.012, 112.789, 119.011, 117.589, 119.592, 117.842, 119.03, 113.166, 111.651, 117.35]
F1 Score:  [0.719, 0.787, 0.178, 0.974, 0.797, 0.689, 0.496, 0.973, 0.77, 0.981, 0.974, 0.973, 0.665, 0.339, 0.815]
Recall Score:  [0.746, 0.826, 0.25, 0.976, 0.829, 0.708, 0.553, 0.977, 0.81, 0.984, 0.977, 0.977, 0.715, 0.41, 0.85]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6424
Averaged Test Accurancy: 0.7528
Averaged Test AUC: 0.9678
Averaged Test F1_score: 0.7420
Averaged Test Recal score: 0.7725
Std Test Accurancy: 0.2352
Std Test AUC: 0.0250
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.9261
Epoch: 0|  Loss:  1.6624 |Global loss: 5.437| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8082
Epoch: 1|  Loss:  1.4891 |Global loss: 5.2548| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.7639
Epoch: 2|  Loss:  1.3844 |Global loss: 5.1932| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 3|  NKD Loss: 0.7493
Epoch: 3|  Loss:  1.3843 |Global loss: 5.1629| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 0|  NKD Loss: 0.9028
Epoch: 0|  Loss:  1.3495 |Global loss: 5.4812| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8573
Epoch: 1|  Loss:  1.2564 |Global loss: 5.3473| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.816
Epoch: 2|  Loss:  1.2157 |Global loss: 5.3622| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.8048
Epoch: 3|  Loss:  1.2327 |Global loss: 5.2768| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.9011
Epoch: 0|  Loss:  1.3175 |Global loss: 5.4695| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8626
Epoch: 1|  Loss:  1.2608 |Global loss: 5.3642| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.8054
Epoch: 2|  Loss:  1.1707 |Global loss: 5.3054| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.7927
Epoch: 3|  Loss:  1.1911 |Global loss: 5.2377| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 1.0497
Epoch: 0|  Loss:  2.2106 |Global loss: 5.4838| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.0765
Epoch: 1|  Loss:  2.181 |Global loss: 5.4022| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.9839
Epoch: 2|  Loss:  1.9928 |Global loss: 5.3447| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.9772
Epoch: 3|  Loss:  1.9616 |Global loss: 5.2869| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.9964
Epoch: 0|  Loss:  1.5938 |Global loss: 5.5842| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9228
Epoch: 1|  Loss:  1.4249 |Global loss: 5.4812| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.8979
Epoch: 2|  Loss:  1.4067 |Global loss: 5.4466| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.8624
Epoch: 3|  Loss:  1.3577 |Global loss: 5.403| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.9708
Epoch: 0|  Loss:  1.6038 |Global loss: 5.4863| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9303
Epoch: 1|  Loss:  1.5623 |Global loss: 5.4231| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.8923
Epoch: 2|  Loss:  1.5101 |Global loss: 5.3597| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.8728
Epoch: 3|  Loss:  1.4746 |Global loss: 5.3498| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 4.738690614700317
Chosen Clients:  [4, 6, 2, 11, 9, 3]

-------------Round number: 63-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.917, 0.192, 0.975, 0.867, 0.775, 0.517, 0.975, 0.833, 0.983, 0.975, 0.975, 0.758, 0.375, 0.808]
AUC in each clients:  [116.349, 118.811, 109.276, 118.586, 118.021, 116.667, 113.21, 119.011, 117.589, 119.592, 117.842, 119.03, 116.394, 111.651, 117.35]
F1 Score:  [0.762, 0.881, 0.178, 0.974, 0.824, 0.799, 0.535, 0.973, 0.77, 0.981, 0.974, 0.973, 0.766, 0.339, 0.815]
Recall Score:  [0.809, 0.91, 0.25, 0.976, 0.847, 0.824, 0.581, 0.977, 0.81, 0.984, 0.977, 0.977, 0.817, 0.41, 0.85]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5913
Averaged Test Accurancy: 0.7783
Averaged Test AUC: 0.9719
Averaged Test F1_score: 0.7696
Averaged Test Recal score: 0.7999
Std Test Accurancy: 0.2315
Std Test AUC: 0.0240
Std Test F1: 0.0019
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.8116
Epoch: 0|  Loss:  1.2478 |Global loss: 5.3343| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.7618
Epoch: 1|  Loss:  1.1454 |Global loss: 5.2105| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.7479
Epoch: 2|  Loss:  1.1085 |Global loss: 5.2022| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.7544
Epoch: 3|  Loss:  1.1313 |Global loss: 5.1306| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.9824
Epoch: 0|  Loss:  2.0408 |Global loss: 5.4063| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.9263
Epoch: 1|  Loss:  1.8329 |Global loss: 5.2666| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.909
Epoch: 2|  Loss:  1.7717 |Global loss: 5.2012| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.9432
Epoch: 3|  Loss:  1.8537 |Global loss: 5.2123| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 1.0413
Epoch: 0|  Loss:  2.4507 |Global loss: 5.3992| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.0248
Epoch: 1|  Loss:  2.3688 |Global loss: 5.2087| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.9973
Epoch: 2|  Loss:  2.32 |Global loss: 5.2106| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0154
Epoch: 3|  Loss:  2.3183 |Global loss: 5.1687| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.8334
Epoch: 0|  Loss:  1.0957 |Global loss: 5.5082| Local H loss: 0.0486  | Global H loss: 0.0486
Epoch: 1|  NKD Loss: 0.8237
Epoch: 1|  Loss:  1.0895 |Global loss: 5.4676| Local H loss: 0.049  | Global H loss: 0.049
Epoch: 2|  NKD Loss: 0.8185
Epoch: 2|  Loss:  1.0849 |Global loss: 5.3844| Local H loss: 0.0502  | Global H loss: 0.0502
Epoch: 3|  NKD Loss: 0.824
Epoch: 3|  Loss:  1.073 |Global loss: 5.3348| Local H loss: 0.0508  | Global H loss: 0.0508
Epoch: 0|  NKD Loss: 0.7702
Epoch: 0|  Loss:  0.9559 |Global loss: 5.2673| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.7332
Epoch: 1|  Loss:  0.9188 |Global loss: 5.1742| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.701
Epoch: 2|  Loss:  0.882 |Global loss: 5.1224| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.7237
Epoch: 3|  Loss:  0.9059 |Global loss: 5.0804| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.8555
Epoch: 0|  Loss:  1.1892 |Global loss: 5.4593| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.8141
Epoch: 1|  Loss:  1.1714 |Global loss: 5.3631| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.8022
Epoch: 2|  Loss:  1.128 |Global loss: 5.3029| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.7785
Epoch: 3|  Loss:  1.0664 |Global loss: 5.2739| Local H loss: 0.0418  | Global H loss: 0.0418
------------------------- time cost ------------------------- 4.899406671524048
Chosen Clients:  [5, 11, 8, 10, 3, 1]

-------------Round number: 64-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.917, 0.192, 0.983, 0.858, 0.775, 0.525, 0.975, 0.833, 0.983, 0.975, 0.975, 0.758, 0.375, 0.808]
AUC in each clients:  [116.349, 118.811, 110.499, 118.787, 117.833, 116.667, 114.687, 119.011, 117.589, 119.683, 117.842, 118.992, 116.394, 111.651, 117.35]
F1 Score:  [0.762, 0.881, 0.178, 0.983, 0.813, 0.799, 0.542, 0.973, 0.77, 0.981, 0.974, 0.973, 0.766, 0.339, 0.815]
Recall Score:  [0.809, 0.91, 0.25, 0.986, 0.841, 0.824, 0.591, 0.977, 0.81, 0.984, 0.977, 0.977, 0.817, 0.41, 0.85]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6467
Averaged Test Accurancy: 0.7789
Averaged Test AUC: 0.9734
Averaged Test F1_score: 0.7699
Averaged Test Recal score: 0.8009
Std Test Accurancy: 0.2312
Std Test AUC: 0.0215
Std Test F1: 0.0019
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.889
Epoch: 0|  Loss:  1.4377 |Global loss: 5.2627| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.8197
Epoch: 1|  Loss:  1.3512 |Global loss: 5.1908| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.8011
Epoch: 2|  Loss:  1.2826 |Global loss: 5.1218| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.8005
Epoch: 3|  Loss:  1.2771 |Global loss: 5.1018| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.8316
Epoch: 0|  Loss:  1.0676 |Global loss: 5.4462| Local H loss: 0.0504  | Global H loss: 0.0504
Epoch: 1|  NKD Loss: 0.7916
Epoch: 1|  Loss:  1.0352 |Global loss: 5.3327| Local H loss: 0.0505  | Global H loss: 0.0505
Epoch: 2|  NKD Loss: 0.7803
Epoch: 2|  Loss:  1.0101 |Global loss: 5.2319| Local H loss: 0.0519  | Global H loss: 0.0519
Epoch: 3|  NKD Loss: 0.7793
Epoch: 3|  Loss:  1.005 |Global loss: 5.2298| Local H loss: 0.0514  | Global H loss: 0.0514
Epoch: 0|  NKD Loss: 0.9083
Epoch: 0|  Loss:  1.4968 |Global loss: 5.3242| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.8708
Epoch: 1|  Loss:  1.4705 |Global loss: 5.2098| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.856
Epoch: 2|  Loss:  1.4261 |Global loss: 5.1657| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.8289
Epoch: 3|  Loss:  1.3882 |Global loss: 5.1669| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.9059
Epoch: 0|  Loss:  1.2528 |Global loss: 5.5854| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.9233
Epoch: 1|  Loss:  1.2247 |Global loss: 5.4263| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.8683
Epoch: 2|  Loss:  1.1681 |Global loss: 5.3727| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.9231
Epoch: 3|  Loss:  1.2955 |Global loss: 5.338| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 0|  NKD Loss: 0.8488
Epoch: 0|  Loss:  1.1786 |Global loss: 5.3625| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.7926
Epoch: 1|  Loss:  1.1032 |Global loss: 5.2502| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.8028
Epoch: 2|  Loss:  1.1519 |Global loss: 5.2658| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.787
Epoch: 3|  Loss:  1.1154 |Global loss: 5.1854| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.8199
Epoch: 0|  Loss:  1.1826 |Global loss: 5.2436| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.7868
Epoch: 1|  Loss:  1.1775 |Global loss: 5.1904| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.7341
Epoch: 2|  Loss:  1.0673 |Global loss: 5.0904| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.7599
Epoch: 3|  Loss:  1.1935 |Global loss: 5.1425| Local H loss: 0.0388  | Global H loss: 0.0388
------------------------- time cost ------------------------- 4.8833348751068115
Chosen Clients:  [1, 10, 0, 3, 9, 5]

-------------Round number: 65-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.192, 0.975, 0.858, 0.792, 0.525, 0.975, 0.908, 0.983, 0.725, 0.975, 0.758, 0.375, 0.808]
AUC in each clients:  [116.349, 118.663, 110.499, 119.023, 117.833, 116.626, 114.687, 119.011, 118.564, 119.683, 115.406, 119.258, 116.394, 111.651, 117.35]
F1 Score:  [0.762, 0.873, 0.178, 0.973, 0.813, 0.79, 0.542, 0.973, 0.865, 0.981, 0.684, 0.973, 0.766, 0.339, 0.815]
Recall Score:  [0.809, 0.903, 0.25, 0.977, 0.841, 0.824, 0.591, 0.977, 0.894, 0.984, 0.747, 0.977, 0.817, 0.41, 0.85]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7500
Averaged Test Accurancy: 0.7672
Averaged Test AUC: 0.9728
Averaged Test F1_score: 0.7551
Averaged Test Recal score: 0.7901
Std Test Accurancy: 0.2269
Std Test AUC: 0.0221
Std Test F1: 0.0019
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 0.8205
Epoch: 0|  Loss:  1.1924 |Global loss: 5.17| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.7662
Epoch: 1|  Loss:  1.1456 |Global loss: 5.0967| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.7194
Epoch: 2|  Loss:  1.0352 |Global loss: 5.0267| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.7318
Epoch: 3|  Loss:  1.0769 |Global loss: 5.0639| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 0|  NKD Loss: 0.8911
Epoch: 0|  Loss:  1.2082 |Global loss: 5.4476| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.8627
Epoch: 1|  Loss:  1.1757 |Global loss: 5.3896| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 2|  NKD Loss: 0.8436
Epoch: 2|  Loss:  1.131 |Global loss: 5.2993| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.8358
Epoch: 3|  Loss:  1.1596 |Global loss: 5.258| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.8155
Epoch: 0|  Loss:  1.4183 |Global loss: 5.1496| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 1|  NKD Loss: 0.7399
Epoch: 1|  Loss:  1.3177 |Global loss: 5.0129| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 2|  NKD Loss: 0.7267
Epoch: 2|  Loss:  1.2919 |Global loss: 4.9524| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 3|  NKD Loss: 0.7126
Epoch: 3|  Loss:  1.238 |Global loss: 4.9558| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 0|  NKD Loss: 0.8282
Epoch: 0|  Loss:  1.0946 |Global loss: 5.3326| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 1|  NKD Loss: 0.775
Epoch: 1|  Loss:  1.0697 |Global loss: 5.1934| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 0.7586
Epoch: 2|  Loss:  1.0271 |Global loss: 5.1538| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 3|  NKD Loss: 0.7949
Epoch: 3|  Loss:  1.1146 |Global loss: 5.1849| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 0|  NKD Loss: 0.7578
Epoch: 0|  Loss:  0.9373 |Global loss: 5.0976| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 0.7259
Epoch: 1|  Loss:  0.9166 |Global loss: 5.0486| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.7106
Epoch: 2|  Loss:  0.9047 |Global loss: 4.9865| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.6816
Epoch: 3|  Loss:  0.8583 |Global loss: 4.9634| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.8811
Epoch: 0|  Loss:  1.3863 |Global loss: 5.2363| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.7958
Epoch: 1|  Loss:  1.2759 |Global loss: 5.0676| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.8091
Epoch: 2|  Loss:  1.2947 |Global loss: 5.1158| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.7705
Epoch: 3|  Loss:  1.2096 |Global loss: 5.05| Local H loss: 0.0419  | Global H loss: 0.0419
------------------------- time cost ------------------------- 5.118742942810059
Chosen Clients:  [5, 0, 8, 3, 14, 4]

-------------Round number: 66-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.917, 0.192, 0.983, 0.858, 0.933, 0.525, 0.975, 0.908, 0.983, 0.975, 0.975, 0.758, 0.375, 0.808]
AUC in each clients:  [116.131, 118.657, 110.499, 119.011, 117.833, 117.642, 114.687, 119.011, 118.564, 119.601, 118.205, 119.258, 116.394, 111.651, 117.35]
F1 Score:  [0.749, 0.877, 0.178, 0.983, 0.813, 0.941, 0.542, 0.973, 0.865, 0.981, 0.973, 0.973, 0.766, 0.339, 0.815]
Recall Score:  [0.794, 0.91, 0.25, 0.986, 0.841, 0.949, 0.591, 0.977, 0.894, 0.984, 0.977, 0.977, 0.817, 0.41, 0.85]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7460
Averaged Test Accurancy: 0.7939
Averaged Test AUC: 0.9747
Averaged Test F1_score: 0.7845
Averaged Test Recal score: 0.8138
Std Test Accurancy: 0.2362
Std Test AUC: 0.0221
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.8834
Epoch: 0|  Loss:  1.3919 |Global loss: 5.215| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 1|  NKD Loss: 0.8065
Epoch: 1|  Loss:  1.2298 |Global loss: 5.0518| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 2|  NKD Loss: 0.7747
Epoch: 2|  Loss:  1.1674 |Global loss: 5.0333| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.7698
Epoch: 3|  Loss:  1.2019 |Global loss: 5.0025| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 0.8032
Epoch: 0|  Loss:  1.3281 |Global loss: 5.1307| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 1|  NKD Loss: 0.7251
Epoch: 1|  Loss:  1.2548 |Global loss: 4.965| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.7088
Epoch: 2|  Loss:  1.2487 |Global loss: 4.9082| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 3|  NKD Loss: 0.703
Epoch: 3|  Loss:  1.2151 |Global loss: 4.9584| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 0|  NKD Loss: 0.9046
Epoch: 0|  Loss:  1.4669 |Global loss: 5.2084| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.8115
Epoch: 1|  Loss:  1.3142 |Global loss: 5.1067| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.8142
Epoch: 2|  Loss:  1.3147 |Global loss: 5.0831| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.8257
Epoch: 3|  Loss:  1.4077 |Global loss: 5.0979| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.8169
Epoch: 0|  Loss:  1.0789 |Global loss: 5.2719| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.7622
Epoch: 1|  Loss:  1.0067 |Global loss: 5.1675| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 2|  NKD Loss: 0.728
Epoch: 2|  Loss:  0.9591 |Global loss: 5.0993| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 3|  NKD Loss: 0.7076
Epoch: 3|  Loss:  0.9457 |Global loss: 5.0615| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 0|  NKD Loss: 0.8761
Epoch: 0|  Loss:  1.3538 |Global loss: 5.143| Local H loss: 0.046  | Global H loss: 0.046
Epoch: 1|  NKD Loss: 0.882
Epoch: 1|  Loss:  1.5127 |Global loss: 5.1659| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 2|  NKD Loss: 0.8146
Epoch: 2|  Loss:  1.313 |Global loss: 5.0162| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 3|  NKD Loss: 0.7932
Epoch: 3|  Loss:  1.2471 |Global loss: 4.9724| Local H loss: 0.0482  | Global H loss: 0.0482
Epoch: 0|  NKD Loss: 0.7939
Epoch: 0|  Loss:  1.1711 |Global loss: 5.1308| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.7421
Epoch: 1|  Loss:  1.0873 |Global loss: 4.9724| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.7687
Epoch: 2|  Loss:  1.188 |Global loss: 4.9651| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.7548
Epoch: 3|  Loss:  1.1407 |Global loss: 4.9687| Local H loss: 0.0409  | Global H loss: 0.0409
------------------------- time cost ------------------------- 4.93657922744751
Chosen Clients:  [5, 2, 8, 4, 14, 9]

-------------Round number: 67-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.917, 0.192, 0.983, 0.867, 0.942, 0.525, 0.975, 0.975, 0.983, 0.975, 0.975, 0.758, 0.375, 0.875]
AUC in each clients:  [116.583, 118.657, 110.499, 119.039, 117.983, 117.727, 114.687, 119.011, 118.653, 119.601, 118.205, 119.258, 116.394, 111.651, 117.852]
F1 Score:  [0.767, 0.877, 0.178, 0.983, 0.821, 0.948, 0.542, 0.973, 0.974, 0.981, 0.973, 0.973, 0.766, 0.339, 0.858]
Recall Score:  [0.817, 0.91, 0.25, 0.986, 0.847, 0.955, 0.591, 0.977, 0.977, 0.984, 0.977, 0.977, 0.817, 0.41, 0.895]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8595
Averaged Test Accurancy: 0.8050
Averaged Test AUC: 0.9754
Averaged Test F1_score: 0.7969
Averaged Test Recal score: 0.8247
Std Test Accurancy: 0.2398
Std Test AUC: 0.0221
Std Test F1: 0.0020
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 0.8436
Epoch: 0|  Loss:  1.2629 |Global loss: 5.2029| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.7595
Epoch: 1|  Loss:  1.1615 |Global loss: 5.0541| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.7835
Epoch: 2|  Loss:  1.1964 |Global loss: 5.0001| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.7527
Epoch: 3|  Loss:  1.1356 |Global loss: 4.9647| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 1.0209
Epoch: 0|  Loss:  2.2488 |Global loss: 5.1634| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9647
Epoch: 1|  Loss:  2.1332 |Global loss: 4.9983| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.9751
Epoch: 2|  Loss:  2.1505 |Global loss: 5.0072| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9934
Epoch: 3|  Loss:  2.135 |Global loss: 5.0183| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.8257
Epoch: 0|  Loss:  1.2476 |Global loss: 5.091| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.8146
Epoch: 1|  Loss:  1.3131 |Global loss: 5.0603| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7728
Epoch: 2|  Loss:  1.1933 |Global loss: 4.9852| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.7849
Epoch: 3|  Loss:  1.263 |Global loss: 4.9742| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 0.8122
Epoch: 0|  Loss:  1.1635 |Global loss: 5.1068| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.7551
Epoch: 1|  Loss:  1.1643 |Global loss: 4.9409| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.7347
Epoch: 2|  Loss:  1.1236 |Global loss: 4.8984| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.7356
Epoch: 3|  Loss:  1.1077 |Global loss: 4.8804| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.8752
Epoch: 0|  Loss:  1.2911 |Global loss: 5.1848| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 1|  NKD Loss: 0.7757
Epoch: 1|  Loss:  1.1732 |Global loss: 4.9935| Local H loss: 0.0483  | Global H loss: 0.0483
Epoch: 2|  NKD Loss: 0.7818
Epoch: 2|  Loss:  1.2352 |Global loss: 5.0155| Local H loss: 0.0472  | Global H loss: 0.0472
Epoch: 3|  NKD Loss: 0.7897
Epoch: 3|  Loss:  1.2599 |Global loss: 4.9923| Local H loss: 0.0476  | Global H loss: 0.0476
Epoch: 0|  NKD Loss: 0.7396
Epoch: 0|  Loss:  0.9236 |Global loss: 5.0114| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.6948
Epoch: 1|  Loss:  0.8935 |Global loss: 4.9607| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.7034
Epoch: 2|  Loss:  0.8714 |Global loss: 4.849| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 3|  NKD Loss: 0.6743
Epoch: 3|  Loss:  0.8524 |Global loss: 4.8597| Local H loss: 0.0425  | Global H loss: 0.0425
------------------------- time cost ------------------------- 4.836523056030273
Chosen Clients:  [3, 9, 14, 10, 5, 13]

-------------Round number: 68-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.917, 0.317, 0.983, 0.883, 0.967, 0.525, 0.975, 0.975, 0.983, 0.975, 0.975, 0.758, 0.375, 0.858]
AUC in each clients:  [116.583, 118.657, 111.562, 119.039, 118.085, 117.866, 114.687, 119.011, 119.014, 119.527, 118.205, 119.258, 116.394, 111.651, 117.771]
F1 Score:  [0.767, 0.877, 0.296, 0.983, 0.844, 0.967, 0.542, 0.973, 0.973, 0.981, 0.973, 0.973, 0.766, 0.339, 0.844]
Recall Score:  [0.817, 0.91, 0.344, 0.986, 0.873, 0.971, 0.591, 0.977, 0.977, 0.984, 0.977, 0.977, 0.817, 0.41, 0.881]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9025
Averaged Test Accurancy: 0.8150
Averaged Test AUC: 0.9763
Averaged Test F1_score: 0.8065
Averaged Test Recal score: 0.8328
Std Test Accurancy: 0.2208
Std Test AUC: 0.0209
Std Test F1: 0.0019
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 0.7927
Epoch: 0|  Loss:  1.0109 |Global loss: 5.2148| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 1|  NKD Loss: 0.7367
Epoch: 1|  Loss:  0.9628 |Global loss: 5.058| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.7046
Epoch: 2|  Loss:  0.909 |Global loss: 4.9689| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 3|  NKD Loss: 0.6982
Epoch: 3|  Loss:  0.9057 |Global loss: 4.9737| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 0|  NKD Loss: 0.761
Epoch: 0|  Loss:  0.9359 |Global loss: 4.9991| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.68
Epoch: 1|  Loss:  0.8541 |Global loss: 4.8501| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.6867
Epoch: 2|  Loss:  0.8534 |Global loss: 4.8404| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 3|  NKD Loss: 0.6874
Epoch: 3|  Loss:  0.877 |Global loss: 4.8713| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8478
Epoch: 0|  Loss:  1.2615 |Global loss: 5.1445| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 1|  NKD Loss: 0.7647
Epoch: 1|  Loss:  1.1362 |Global loss: 4.9966| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 2|  NKD Loss: 0.7605
Epoch: 2|  Loss:  1.1483 |Global loss: 4.9636| Local H loss: 0.0478  | Global H loss: 0.0478
Epoch: 3|  NKD Loss: 0.7595
Epoch: 3|  Loss:  1.1196 |Global loss: 4.9484| Local H loss: 0.0487  | Global H loss: 0.0487
Epoch: 0|  NKD Loss: 0.854
Epoch: 0|  Loss:  1.1273 |Global loss: 5.5064| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.8397
Epoch: 1|  Loss:  1.1271 |Global loss: 5.2249| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.8196
Epoch: 2|  Loss:  1.0847 |Global loss: 5.1555| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.8217
Epoch: 3|  Loss:  1.0937 |Global loss: 5.0851| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.8435
Epoch: 0|  Loss:  1.2012 |Global loss: 5.1059| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.7565
Epoch: 1|  Loss:  1.1633 |Global loss: 4.9736| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.7461
Epoch: 2|  Loss:  1.1559 |Global loss: 4.9498| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.7407
Epoch: 3|  Loss:  1.0874 |Global loss: 4.8545| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 0|  NKD Loss: 1.0338
Epoch: 0|  Loss:  2.2163 |Global loss: 5.2295| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.9976
Epoch: 1|  Loss:  2.1291 |Global loss: 5.0497| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.9695
Epoch: 2|  Loss:  2.0698 |Global loss: 4.9976| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9488
Epoch: 3|  Loss:  2.0136 |Global loss: 4.9449| Local H loss: 0.037  | Global H loss: 0.037
------------------------- time cost ------------------------- 4.88197660446167
Chosen Clients:  [4, 5, 8, 13, 6, 14]

-------------Round number: 69-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.917, 0.317, 0.983, 0.883, 0.95, 0.525, 0.975, 0.975, 0.983, 0.975, 0.975, 0.758, 0.517, 0.817]
AUC in each clients:  [116.583, 118.657, 111.562, 119.106, 118.085, 117.812, 114.687, 119.011, 119.014, 119.465, 118.464, 119.258, 116.394, 112.63, 117.155]
F1 Score:  [0.767, 0.877, 0.296, 0.983, 0.844, 0.953, 0.542, 0.973, 0.973, 0.981, 0.974, 0.973, 0.766, 0.509, 0.822]
Recall Score:  [0.817, 0.91, 0.344, 0.986, 0.873, 0.956, 0.591, 0.977, 0.977, 0.984, 0.977, 0.977, 0.817, 0.576, 0.856]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9576
Averaged Test Accurancy: 0.8206
Averaged Test AUC: 0.9766
Averaged Test F1_score: 0.8155
Averaged Test Recal score: 0.8412
Std Test Accurancy: 0.2033
Std Test AUC: 0.0198
Std Test F1: 0.0017
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 0.8284
Epoch: 0|  Loss:  1.2652 |Global loss: 5.0786| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.7433
Epoch: 1|  Loss:  1.1074 |Global loss: 4.8889| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.7421
Epoch: 2|  Loss:  1.0996 |Global loss: 4.8606| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 3|  NKD Loss: 0.715
Epoch: 3|  Loss:  1.0689 |Global loss: 4.8135| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.8249
Epoch: 0|  Loss:  1.1488 |Global loss: 5.081| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.7383
Epoch: 1|  Loss:  1.0907 |Global loss: 4.8952| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 2|  NKD Loss: 0.7172
Epoch: 2|  Loss:  1.0211 |Global loss: 4.8595| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.728
Epoch: 3|  Loss:  1.0815 |Global loss: 4.8927| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.8656
Epoch: 0|  Loss:  1.2912 |Global loss: 5.0997| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.7381
Epoch: 1|  Loss:  1.0995 |Global loss: 4.9542| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.749
Epoch: 2|  Loss:  1.1106 |Global loss: 4.8989| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.7975
Epoch: 3|  Loss:  1.2727 |Global loss: 4.9455| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 1.0017
Epoch: 0|  Loss:  2.0502 |Global loss: 5.1847| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9296
Epoch: 1|  Loss:  1.9511 |Global loss: 5.0137| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9294
Epoch: 2|  Loss:  1.9644 |Global loss: 4.9589| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9493
Epoch: 3|  Loss:  1.9063 |Global loss: 4.8941| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.983
Epoch: 0|  Loss:  1.8294 |Global loss: 5.1113| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.8548
Epoch: 1|  Loss:  1.6535 |Global loss: 4.9254| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.8432
Epoch: 2|  Loss:  1.5592 |Global loss: 4.863| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.8738
Epoch: 3|  Loss:  1.646 |Global loss: 4.9199| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.8145
Epoch: 0|  Loss:  1.1696 |Global loss: 5.1142| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 1|  NKD Loss: 0.7677
Epoch: 1|  Loss:  1.1674 |Global loss: 4.9966| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 2|  NKD Loss: 0.7478
Epoch: 2|  Loss:  1.126 |Global loss: 4.9629| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 3|  NKD Loss: 0.7864
Epoch: 3|  Loss:  1.2068 |Global loss: 4.9219| Local H loss: 0.0474  | Global H loss: 0.0474
------------------------- time cost ------------------------- 4.920647859573364
Chosen Clients:  [8, 0, 7, 6, 3, 12]

-------------Round number: 70-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.917, 0.317, 0.983, 0.875, 0.95, 0.517, 0.975, 0.975, 0.983, 0.975, 0.975, 0.758, 0.583, 0.975]
AUC in each clients:  [116.583, 118.657, 111.562, 119.106, 118.133, 117.873, 114.866, 119.011, 118.998, 119.465, 118.464, 119.258, 116.394, 113.512, 118.583]
F1 Score:  [0.767, 0.877, 0.296, 0.983, 0.835, 0.953, 0.531, 0.973, 0.973, 0.981, 0.974, 0.973, 0.766, 0.59, 0.973]
Recall Score:  [0.817, 0.91, 0.344, 0.986, 0.862, 0.956, 0.575, 0.977, 0.977, 0.984, 0.977, 0.977, 0.817, 0.65, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0131
Averaged Test Accurancy: 0.8344
Averaged Test AUC: 0.9780
Averaged Test F1_score: 0.8297
Averaged Test Recal score: 0.8524
Std Test Accurancy: 0.2014
Std Test AUC: 0.0190
Std Test F1: 0.0017
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 0.8387
Epoch: 0|  Loss:  1.2008 |Global loss: 5.1091| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.7753
Epoch: 1|  Loss:  1.1669 |Global loss: 4.9262| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.7208
Epoch: 2|  Loss:  1.0098 |Global loss: 4.815| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 3|  NKD Loss: 0.747
Epoch: 3|  Loss:  1.0905 |Global loss: 4.8454| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.8264
Epoch: 0|  Loss:  1.3368 |Global loss: 5.0644| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 1|  NKD Loss: 0.6979
Epoch: 1|  Loss:  1.1816 |Global loss: 4.8148| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 2|  NKD Loss: 0.7097
Epoch: 2|  Loss:  1.2163 |Global loss: 4.8127| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 3|  NKD Loss: 0.6784
Epoch: 3|  Loss:  1.1228 |Global loss: 4.7623| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.8331
Epoch: 0|  Loss:  1.1866 |Global loss: 5.4212| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.7707
Epoch: 1|  Loss:  1.0634 |Global loss: 5.2009| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.7636
Epoch: 2|  Loss:  1.0886 |Global loss: 5.1423| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.7363
Epoch: 3|  Loss:  1.011 |Global loss: 5.0691| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 0|  NKD Loss: 0.9111
Epoch: 0|  Loss:  1.6277 |Global loss: 5.0847| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.8553
Epoch: 1|  Loss:  1.6354 |Global loss: 4.9228| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.8516
Epoch: 2|  Loss:  1.5238 |Global loss: 4.8742| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.8402
Epoch: 3|  Loss:  1.5238 |Global loss: 4.8557| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.8254
Epoch: 0|  Loss:  1.0249 |Global loss: 5.1535| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 1|  NKD Loss: 0.713
Epoch: 1|  Loss:  0.912 |Global loss: 4.9812| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 2|  NKD Loss: 0.6944
Epoch: 2|  Loss:  0.8913 |Global loss: 4.8974| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 3|  NKD Loss: 0.6968
Epoch: 3|  Loss:  0.896 |Global loss: 4.9127| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 0|  NKD Loss: 0.9562
Epoch: 0|  Loss:  1.4643 |Global loss: 5.2662| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.8255
Epoch: 1|  Loss:  1.2991 |Global loss: 5.0305| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.8301
Epoch: 2|  Loss:  1.3332 |Global loss: 5.0489| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.8136
Epoch: 3|  Loss:  1.3217 |Global loss: 5.0072| Local H loss: 0.0423  | Global H loss: 0.0423
------------------------- time cost ------------------------- 5.129156112670898
Chosen Clients:  [7, 4, 1, 0, 14, 9]

-------------Round number: 71-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.917, 0.317, 0.983, 0.875, 0.95, 0.842, 0.975, 0.975, 0.983, 0.975, 0.975, 0.675, 0.583, 0.975]
AUC in each clients:  [116.727, 118.657, 111.562, 119.188, 118.133, 117.873, 116.805, 119.027, 119.144, 119.465, 118.464, 119.258, 116.319, 113.512, 118.583]
F1 Score:  [0.767, 0.877, 0.296, 0.983, 0.835, 0.953, 0.804, 0.973, 0.973, 0.981, 0.974, 0.973, 0.673, 0.59, 0.973]
Recall Score:  [0.817, 0.91, 0.344, 0.986, 0.862, 0.956, 0.833, 0.977, 0.977, 0.984, 0.977, 0.977, 0.734, 0.65, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0112
Averaged Test Accurancy: 0.8506
Averaged Test AUC: 0.9793
Averaged Test F1_score: 0.8417
Averaged Test Recal score: 0.8641
Std Test Accurancy: 0.1868
Std Test AUC: 0.0183
Std Test F1: 0.0016
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.7828
Epoch: 0|  Loss:  1.0803 |Global loss: 5.3352| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.75
Epoch: 1|  Loss:  1.0393 |Global loss: 5.0909| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 2|  NKD Loss: 0.7401
Epoch: 2|  Loss:  1.0382 |Global loss: 5.0288| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 3|  NKD Loss: 0.7461
Epoch: 3|  Loss:  1.092 |Global loss: 5.0484| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.801
Epoch: 0|  Loss:  1.1605 |Global loss: 5.0227| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.7245
Epoch: 1|  Loss:  1.0717 |Global loss: 4.8275| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7234
Epoch: 2|  Loss:  1.06 |Global loss: 4.7745| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.7348
Epoch: 3|  Loss:  1.0794 |Global loss: 4.8028| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.7858
Epoch: 0|  Loss:  1.0901 |Global loss: 5.0717| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.7054
Epoch: 1|  Loss:  1.0158 |Global loss: 4.9061| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.7288
Epoch: 2|  Loss:  1.0973 |Global loss: 4.9565| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 3|  NKD Loss: 0.714
Epoch: 3|  Loss:  1.0345 |Global loss: 4.8791| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.8032
Epoch: 0|  Loss:  1.2636 |Global loss: 4.9769| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 1|  NKD Loss: 0.7003
Epoch: 1|  Loss:  1.1514 |Global loss: 4.8137| Local H loss: 0.0454  | Global H loss: 0.0454
Epoch: 2|  NKD Loss: 0.6808
Epoch: 2|  Loss:  1.1321 |Global loss: 4.7415| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 3|  NKD Loss: 0.6711
Epoch: 3|  Loss:  1.0919 |Global loss: 4.6851| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 0|  NKD Loss: 0.9252
Epoch: 0|  Loss:  1.4454 |Global loss: 5.1817| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 1|  NKD Loss: 0.7421
Epoch: 1|  Loss:  1.0792 |Global loss: 4.9159| Local H loss: 0.0472  | Global H loss: 0.0472
Epoch: 2|  NKD Loss: 0.7374
Epoch: 2|  Loss:  1.0667 |Global loss: 4.8143| Local H loss: 0.0487  | Global H loss: 0.0487
Epoch: 3|  NKD Loss: 0.736
Epoch: 3|  Loss:  1.072 |Global loss: 4.8536| Local H loss: 0.0477  | Global H loss: 0.0477
Epoch: 0|  NKD Loss: 0.7863
Epoch: 0|  Loss:  0.9611 |Global loss: 4.966| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 1|  NKD Loss: 0.7191
Epoch: 1|  Loss:  0.9111 |Global loss: 4.78| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.6657
Epoch: 2|  Loss:  0.8355 |Global loss: 4.7446| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.672
Epoch: 3|  Loss:  0.8412 |Global loss: 4.7166| Local H loss: 0.0423  | Global H loss: 0.0423
------------------------- time cost ------------------------- 5.292843341827393
Chosen Clients:  [10, 14, 7, 4, 0, 6]

-------------Round number: 72-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.908, 0.317, 0.983, 0.9, 0.95, 0.842, 0.975, 0.975, 0.983, 0.975, 0.975, 0.675, 0.583, 0.975]
AUC in each clients:  [116.889, 118.426, 111.562, 119.188, 118.43, 117.873, 116.805, 118.995, 119.144, 119.539, 118.464, 119.258, 116.319, 113.512, 118.933]
F1 Score:  [0.773, 0.869, 0.296, 0.983, 0.858, 0.953, 0.804, 0.973, 0.973, 0.981, 0.974, 0.973, 0.673, 0.59, 0.973]
Recall Score:  [0.826, 0.903, 0.344, 0.986, 0.884, 0.956, 0.833, 0.977, 0.977, 0.984, 0.977, 0.977, 0.734, 0.65, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0139
Averaged Test Accurancy: 0.8522
Averaged Test AUC: 0.9796
Averaged Test F1_score: 0.8431
Averaged Test Recal score: 0.8657
Std Test Accurancy: 0.1867
Std Test AUC: 0.0184
Std Test F1: 0.0016
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9381
Epoch: 0|  Loss:  1.2382 |Global loss: 5.5232| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.8407
Epoch: 1|  Loss:  1.0725 |Global loss: 5.1139| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.8557
Epoch: 2|  Loss:  1.1395 |Global loss: 5.0864| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.8273
Epoch: 3|  Loss:  1.0912 |Global loss: 4.9981| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.7876
Epoch: 0|  Loss:  1.0844 |Global loss: 4.9916| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 1|  NKD Loss: 0.7231
Epoch: 1|  Loss:  1.0712 |Global loss: 4.8686| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 2|  NKD Loss: 0.7798
Epoch: 2|  Loss:  1.1751 |Global loss: 4.9015| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 3|  NKD Loss: 0.7162
Epoch: 3|  Loss:  1.0454 |Global loss: 4.8243| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 0|  NKD Loss: 0.8027
Epoch: 0|  Loss:  1.0774 |Global loss: 5.4057| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.7192
Epoch: 1|  Loss:  0.9924 |Global loss: 5.0754| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 2|  NKD Loss: 0.7453
Epoch: 2|  Loss:  1.0385 |Global loss: 4.9835| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 3|  NKD Loss: 0.7142
Epoch: 3|  Loss:  0.9914 |Global loss: 4.976| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 0|  NKD Loss: 0.7831
Epoch: 0|  Loss:  1.1463 |Global loss: 5.0078| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.7186
Epoch: 1|  Loss:  1.0152 |Global loss: 4.7824| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.7337
Epoch: 2|  Loss:  1.0801 |Global loss: 4.7752| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.7608
Epoch: 3|  Loss:  1.1543 |Global loss: 4.8458| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.7272
Epoch: 0|  Loss:  1.1541 |Global loss: 4.9922| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 1|  NKD Loss: 0.6897
Epoch: 1|  Loss:  1.1511 |Global loss: 4.8351| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 2|  NKD Loss: 0.6638
Epoch: 2|  Loss:  1.07 |Global loss: 4.6849| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 3|  NKD Loss: 0.6747
Epoch: 3|  Loss:  1.0925 |Global loss: 4.6907| Local H loss: 0.046  | Global H loss: 0.046
Epoch: 0|  NKD Loss: 0.8763
Epoch: 0|  Loss:  1.5193 |Global loss: 4.9725| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.8059
Epoch: 1|  Loss:  1.4188 |Global loss: 4.839| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.8212
Epoch: 2|  Loss:  1.4224 |Global loss: 4.8315| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.8013
Epoch: 3|  Loss:  1.3727 |Global loss: 4.7924| Local H loss: 0.0415  | Global H loss: 0.0415
------------------------- time cost ------------------------- 4.912542819976807
Chosen Clients:  [6, 4, 2, 1, 5, 10]

-------------Round number: 73-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.908, 0.317, 0.983, 0.9, 0.95, 0.742, 0.975, 0.975, 0.983, 0.975, 0.975, 0.675, 0.583, 0.975]
AUC in each clients:  [116.892, 118.426, 111.562, 119.188, 118.236, 117.873, 115.458, 119.023, 119.144, 119.539, 118.874, 119.258, 116.319, 113.512, 118.88]
F1 Score:  [0.773, 0.869, 0.296, 0.983, 0.858, 0.953, 0.73, 0.973, 0.973, 0.981, 0.973, 0.973, 0.673, 0.59, 0.973]
Recall Score:  [0.826, 0.903, 0.344, 0.986, 0.884, 0.956, 0.769, 0.977, 0.977, 0.984, 0.977, 0.977, 0.734, 0.65, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0755
Averaged Test Accurancy: 0.8456
Averaged Test AUC: 0.9790
Averaged Test F1_score: 0.8381
Averaged Test Recal score: 0.8614
Std Test Accurancy: 0.1887
Std Test AUC: 0.0189
Std Test F1: 0.0016
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.8984
Epoch: 0|  Loss:  1.4353 |Global loss: 5.0737| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.8551
Epoch: 1|  Loss:  1.5331 |Global loss: 4.8875| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.8111
Epoch: 2|  Loss:  1.3733 |Global loss: 4.8151| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.7903
Epoch: 3|  Loss:  1.3438 |Global loss: 4.7771| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.832
Epoch: 0|  Loss:  1.1981 |Global loss: 5.0438| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.7235
Epoch: 1|  Loss:  1.0317 |Global loss: 4.7606| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 0.7183
Epoch: 2|  Loss:  1.0622 |Global loss: 4.7114| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.7434
Epoch: 3|  Loss:  1.13 |Global loss: 4.7392| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 1.017
Epoch: 0|  Loss:  2.1275 |Global loss: 5.2528| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.9566
Epoch: 1|  Loss:  2.0213 |Global loss: 4.8926| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9479
Epoch: 2|  Loss:  1.9513 |Global loss: 4.92| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9411
Epoch: 3|  Loss:  1.9209 |Global loss: 4.8874| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.799
Epoch: 0|  Loss:  1.1481 |Global loss: 5.0932| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 1|  NKD Loss: 0.68
Epoch: 1|  Loss:  0.9548 |Global loss: 4.9096| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.6974
Epoch: 2|  Loss:  1.0049 |Global loss: 4.8902| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 3|  NKD Loss: 0.7084
Epoch: 3|  Loss:  1.0272 |Global loss: 4.8642| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.8374
Epoch: 0|  Loss:  1.1526 |Global loss: 5.0556| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.7361
Epoch: 1|  Loss:  1.0368 |Global loss: 4.9023| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.7261
Epoch: 2|  Loss:  1.0694 |Global loss: 4.8463| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.7268
Epoch: 3|  Loss:  1.0658 |Global loss: 4.8306| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.8731
Epoch: 0|  Loss:  1.2286 |Global loss: 5.4519| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.8469
Epoch: 1|  Loss:  1.1152 |Global loss: 5.134| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.8054
Epoch: 2|  Loss:  1.0588 |Global loss: 5.0339| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8107
Epoch: 3|  Loss:  1.07 |Global loss: 4.9762| Local H loss: 0.0416  | Global H loss: 0.0416
------------------------- time cost ------------------------- 4.997441291809082
Chosen Clients:  [13, 12, 6, 10, 1, 0]

-------------Round number: 74-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.983, 0.308, 0.983, 0.908, 0.967, 0.875, 0.975, 0.975, 0.983, 0.975, 0.975, 0.675, 0.583, 0.975]
AUC in each clients:  [116.892, 119.055, 112.009, 119.188, 118.401, 118.127, 116.702, 119.023, 119.144, 119.539, 118.594, 119.258, 116.319, 113.512, 118.88]
F1 Score:  [0.773, 0.982, 0.331, 0.983, 0.859, 0.967, 0.836, 0.973, 0.973, 0.981, 0.973, 0.973, 0.673, 0.59, 0.973]
Recall Score:  [0.826, 0.984, 0.398, 0.986, 0.894, 0.971, 0.862, 0.977, 0.977, 0.984, 0.977, 0.977, 0.734, 0.65, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0517
Averaged Test Accurancy: 0.8606
Averaged Test AUC: 0.9804
Averaged Test F1_score: 0.8560
Averaged Test Recal score: 0.8783
Std Test Accurancy: 0.1914
Std Test AUC: 0.0180
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9306
Epoch: 0|  Loss:  1.8765 |Global loss: 5.0875| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.8756
Epoch: 1|  Loss:  1.7618 |Global loss: 4.8794| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.8922
Epoch: 2|  Loss:  1.7654 |Global loss: 4.7775| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.8942
Epoch: 3|  Loss:  1.7416 |Global loss: 4.7675| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.867
Epoch: 0|  Loss:  1.2991 |Global loss: 5.2103| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.8186
Epoch: 1|  Loss:  1.29 |Global loss: 4.9726| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 2|  NKD Loss: 0.8434
Epoch: 2|  Loss:  1.3485 |Global loss: 4.9477| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 3|  NKD Loss: 0.8375
Epoch: 3|  Loss:  1.3154 |Global loss: 4.8716| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 0|  NKD Loss: 0.8767
Epoch: 0|  Loss:  1.3989 |Global loss: 5.0499| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.7699
Epoch: 1|  Loss:  1.2315 |Global loss: 4.8448| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.8027
Epoch: 2|  Loss:  1.3413 |Global loss: 4.8403| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.8091
Epoch: 3|  Loss:  1.377 |Global loss: 4.8723| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.9277
Epoch: 0|  Loss:  1.1817 |Global loss: 5.4702| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.882
Epoch: 1|  Loss:  1.1823 |Global loss: 5.0665| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.8229
Epoch: 2|  Loss:  1.0819 |Global loss: 4.9533| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.8128
Epoch: 3|  Loss:  1.0511 |Global loss: 4.9274| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 0|  NKD Loss: 0.8172
Epoch: 0|  Loss:  1.1656 |Global loss: 5.0799| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 1|  NKD Loss: 0.7375
Epoch: 1|  Loss:  1.0391 |Global loss: 4.8878| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.6995
Epoch: 2|  Loss:  0.9818 |Global loss: 4.8254| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.7191
Epoch: 3|  Loss:  1.0078 |Global loss: 4.8657| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.775
Epoch: 0|  Loss:  1.1839 |Global loss: 4.929| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 1|  NKD Loss: 0.6794
Epoch: 1|  Loss:  1.0644 |Global loss: 4.7198| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 2|  NKD Loss: 0.68
Epoch: 2|  Loss:  1.0898 |Global loss: 4.7349| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 3|  NKD Loss: 0.6772
Epoch: 3|  Loss:  1.0974 |Global loss: 4.6775| Local H loss: 0.0458  | Global H loss: 0.0458
------------------------- time cost ------------------------- 4.878876209259033
Chosen Clients:  [4, 5, 14, 12, 2, 6]

-------------Round number: 75-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.983, 0.308, 0.983, 0.908, 0.967, 0.883, 0.975, 0.975, 0.983, 0.975, 0.975, 0.808, 0.708, 0.975]
AUC in each clients:  [117.239, 119.056, 112.009, 119.188, 118.401, 118.127, 116.945, 119.023, 119.144, 119.539, 118.945, 119.258, 117.015, 114.354, 118.88]
F1 Score:  [0.803, 0.982, 0.331, 0.983, 0.859, 0.967, 0.854, 0.973, 0.973, 0.981, 0.973, 0.973, 0.82, 0.679, 0.973]
Recall Score:  [0.843, 0.984, 0.398, 0.986, 0.894, 0.971, 0.872, 0.977, 0.977, 0.984, 0.977, 0.977, 0.855, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0420
Averaged Test Accurancy: 0.8800
Averaged Test AUC: 0.9817
Averaged Test F1_score: 0.8749
Averaged Test Recal score: 0.8937
Std Test Accurancy: 0.1741
Std Test AUC: 0.0169
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.7904
Epoch: 0|  Loss:  1.1422 |Global loss: 4.9023| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.7218
Epoch: 1|  Loss:  1.0708 |Global loss: 4.7205| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.7273
Epoch: 2|  Loss:  1.0577 |Global loss: 4.7097| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.7354
Epoch: 3|  Loss:  1.0942 |Global loss: 4.726| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8484
Epoch: 0|  Loss:  1.195 |Global loss: 5.0365| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.7052
Epoch: 1|  Loss:  1.0053 |Global loss: 4.8157| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.6963
Epoch: 2|  Loss:  0.9876 |Global loss: 4.7282| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.7084
Epoch: 3|  Loss:  1.0326 |Global loss: 4.8122| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.8338
Epoch: 0|  Loss:  1.1171 |Global loss: 5.0734| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 1|  NKD Loss: 0.7242
Epoch: 1|  Loss:  1.0184 |Global loss: 4.811| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 2|  NKD Loss: 0.719
Epoch: 2|  Loss:  1.0165 |Global loss: 4.773| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.7559
Epoch: 3|  Loss:  1.1333 |Global loss: 4.8141| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 0|  NKD Loss: 0.8731
Epoch: 0|  Loss:  1.3382 |Global loss: 5.1856| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.8196
Epoch: 1|  Loss:  1.3139 |Global loss: 4.9424| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.8165
Epoch: 2|  Loss:  1.2818 |Global loss: 4.8463| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.807
Epoch: 3|  Loss:  1.2749 |Global loss: 4.8213| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 0|  NKD Loss: 1.0154
Epoch: 0|  Loss:  2.057 |Global loss: 5.2625| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 0.9298
Epoch: 1|  Loss:  1.8795 |Global loss: 4.9443| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9254
Epoch: 2|  Loss:  1.829 |Global loss: 4.8909| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9109
Epoch: 3|  Loss:  1.8401 |Global loss: 4.8518| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.881
Epoch: 0|  Loss:  1.3822 |Global loss: 5.0973| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 0.7824
Epoch: 1|  Loss:  1.2383 |Global loss: 4.7854| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.8074
Epoch: 2|  Loss:  1.2519 |Global loss: 4.7514| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.7616
Epoch: 3|  Loss:  1.2284 |Global loss: 4.7531| Local H loss: 0.0409  | Global H loss: 0.0409
------------------------- time cost ------------------------- 5.052807092666626
Chosen Clients:  [14, 0, 8, 9, 5, 10]

-------------Round number: 76-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.983, 0.575, 0.983, 0.9, 0.967, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.833, 0.708, 0.975]
AUC in each clients:  [117.239, 119.056, 114.902, 119.188, 118.301, 118.192, 118.058, 119.023, 119.144, 119.539, 118.945, 119.258, 116.792, 114.354, 119.003]
F1 Score:  [0.803, 0.982, 0.574, 0.983, 0.883, 0.967, 0.896, 0.973, 0.973, 0.981, 0.973, 0.973, 0.85, 0.679, 0.973]
Recall Score:  [0.843, 0.984, 0.624, 0.986, 0.89, 0.971, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.885, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0329
Averaged Test Accurancy: 0.9011
Averaged Test AUC: 0.9839
Averaged Test F1_score: 0.8975
Averaged Test Recal score: 0.9132
Std Test Accurancy: 0.1189
Std Test AUC: 0.0129
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.7956
Epoch: 0|  Loss:  1.0962 |Global loss: 5.0167| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 1|  NKD Loss: 0.7089
Epoch: 1|  Loss:  0.9689 |Global loss: 4.7905| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 2|  NKD Loss: 0.7207
Epoch: 2|  Loss:  1.0036 |Global loss: 4.736| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.7237
Epoch: 3|  Loss:  1.0143 |Global loss: 4.6796| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 0|  NKD Loss: 0.756
Epoch: 0|  Loss:  1.159 |Global loss: 4.9485| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 1|  NKD Loss: 0.6816
Epoch: 1|  Loss:  1.1011 |Global loss: 4.6416| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 2|  NKD Loss: 0.6516
Epoch: 2|  Loss:  1.0361 |Global loss: 4.6134| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 3|  NKD Loss: 0.6654
Epoch: 3|  Loss:  1.041 |Global loss: 4.5691| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 0|  NKD Loss: 0.8792
Epoch: 0|  Loss:  1.2711 |Global loss: 5.0131| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.7412
Epoch: 1|  Loss:  1.0513 |Global loss: 4.6927| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 2|  NKD Loss: 0.8095
Epoch: 2|  Loss:  1.3128 |Global loss: 4.8069| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.7254
Epoch: 3|  Loss:  1.0327 |Global loss: 4.6623| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 0|  NKD Loss: 0.7744
Epoch: 0|  Loss:  0.9463 |Global loss: 4.9367| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.6755
Epoch: 1|  Loss:  0.8451 |Global loss: 4.6704| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 2|  NKD Loss: 0.679
Epoch: 2|  Loss:  0.859 |Global loss: 4.6528| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.6809
Epoch: 3|  Loss:  0.8565 |Global loss: 4.6606| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.8437
Epoch: 0|  Loss:  1.1334 |Global loss: 5.0224| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.7287
Epoch: 1|  Loss:  1.054 |Global loss: 4.7989| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.7166
Epoch: 2|  Loss:  0.9911 |Global loss: 4.7439| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.7163
Epoch: 3|  Loss:  0.9977 |Global loss: 4.7621| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.8757
Epoch: 0|  Loss:  1.0928 |Global loss: 5.4764| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.8044
Epoch: 1|  Loss:  1.053 |Global loss: 4.9928| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.8459
Epoch: 2|  Loss:  1.1238 |Global loss: 5.0074| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.8469
Epoch: 3|  Loss:  1.1046 |Global loss: 4.8963| Local H loss: 0.0419  | Global H loss: 0.0419
------------------------- time cost ------------------------- 4.794965982437134
Chosen Clients:  [14, 4, 12, 7, 1, 10]

-------------Round number: 77-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.983, 0.575, 0.983, 0.9, 0.967, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.833, 0.708, 0.975]
AUC in each clients:  [117.082, 119.056, 114.902, 119.188, 118.301, 118.164, 118.058, 119.023, 119.258, 119.485, 119.035, 119.258, 116.792, 114.354, 118.952]
F1 Score:  [0.773, 0.982, 0.574, 0.983, 0.883, 0.967, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.85, 0.679, 0.973]
Recall Score:  [0.826, 0.984, 0.624, 0.986, 0.89, 0.971, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.885, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0319
Averaged Test Accurancy: 0.8994
Averaged Test AUC: 0.9838
Averaged Test F1_score: 0.8956
Averaged Test Recal score: 0.9121
Std Test Accurancy: 0.1206
Std Test AUC: 0.0129
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8588
Epoch: 0|  Loss:  1.21 |Global loss: 5.0621| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 1|  NKD Loss: 0.7248
Epoch: 1|  Loss:  1.019 |Global loss: 4.7299| Local H loss: 0.046  | Global H loss: 0.046
Epoch: 2|  NKD Loss: 0.688
Epoch: 2|  Loss:  0.945 |Global loss: 4.6662| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 3|  NKD Loss: 0.7063
Epoch: 3|  Loss:  0.9421 |Global loss: 4.6174| Local H loss: 0.0476  | Global H loss: 0.0476
Epoch: 0|  NKD Loss: 0.779
Epoch: 0|  Loss:  1.1014 |Global loss: 5.0105| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.7277
Epoch: 1|  Loss:  1.0549 |Global loss: 4.7102| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.7317
Epoch: 2|  Loss:  1.0298 |Global loss: 4.6499| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.7274
Epoch: 3|  Loss:  1.0523 |Global loss: 4.6557| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.8923
Epoch: 0|  Loss:  1.262 |Global loss: 5.1308| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.8697
Epoch: 1|  Loss:  1.3939 |Global loss: 4.9378| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.7765
Epoch: 2|  Loss:  1.1698 |Global loss: 4.7314| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 3|  NKD Loss: 0.7769
Epoch: 3|  Loss:  1.1787 |Global loss: 4.7039| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 0|  NKD Loss: 0.8374
Epoch: 0|  Loss:  1.1541 |Global loss: 5.3314| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 0.8665
Epoch: 1|  Loss:  1.3146 |Global loss: 5.1054| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.7105
Epoch: 2|  Loss:  0.9863 |Global loss: 4.9229| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 3|  NKD Loss: 0.7311
Epoch: 3|  Loss:  1.023 |Global loss: 4.8758| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 0|  NKD Loss: 0.8206
Epoch: 0|  Loss:  1.0922 |Global loss: 5.0284| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.7707
Epoch: 1|  Loss:  1.1187 |Global loss: 4.8925| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.7216
Epoch: 2|  Loss:  1.0172 |Global loss: 4.7568| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.712
Epoch: 3|  Loss:  0.9814 |Global loss: 4.73| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.2423 |Global loss: 5.4092| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.8116
Epoch: 1|  Loss:  1.0266 |Global loss: 5.0877| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.8093
Epoch: 2|  Loss:  1.0214 |Global loss: 4.8387| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.8087
Epoch: 3|  Loss:  1.0235 |Global loss: 4.8577| Local H loss: 0.0422  | Global H loss: 0.0422
------------------------- time cost ------------------------- 4.954310894012451
Chosen Clients:  [3, 10, 7, 12, 9, 1]

-------------Round number: 78-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.967, 0.575, 0.983, 0.933, 0.967, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.858, 0.708, 0.975]
AUC in each clients:  [117.082, 119.168, 114.902, 119.188, 118.728, 118.164, 118.058, 119.043, 119.258, 119.485, 119.057, 119.258, 117.196, 114.354, 119.027]
F1 Score:  [0.773, 0.961, 0.574, 0.983, 0.921, 0.967, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.866, 0.679, 0.973]
Recall Score:  [0.826, 0.965, 0.624, 0.986, 0.926, 0.971, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.903, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0353
Averaged Test Accurancy: 0.9022
Averaged Test AUC: 0.9844
Averaged Test F1_score: 0.8978
Averaged Test Recal score: 0.9144
Std Test Accurancy: 0.1195
Std Test AUC: 0.0129
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8398
Epoch: 0|  Loss:  1.0693 |Global loss: 5.1969| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.7323
Epoch: 1|  Loss:  0.9315 |Global loss: 4.8647| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 2|  NKD Loss: 0.7112
Epoch: 2|  Loss:  0.9039 |Global loss: 4.7898| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 3|  NKD Loss: 0.7115
Epoch: 3|  Loss:  0.9169 |Global loss: 4.7569| Local H loss: 0.045  | Global H loss: 0.045
Epoch: 0|  NKD Loss: 0.8866
Epoch: 0|  Loss:  1.1272 |Global loss: 5.3877| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.8155
Epoch: 1|  Loss:  1.0692 |Global loss: 4.9861| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.8252
Epoch: 2|  Loss:  1.0882 |Global loss: 4.872| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8179
Epoch: 3|  Loss:  1.0552 |Global loss: 4.8648| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.8323
Epoch: 0|  Loss:  1.0888 |Global loss: 5.2709| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.8084
Epoch: 1|  Loss:  1.2178 |Global loss: 5.0229| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7228
Epoch: 2|  Loss:  0.9652 |Global loss: 4.841| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 3|  NKD Loss: 0.7228
Epoch: 3|  Loss:  0.9819 |Global loss: 4.8128| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 0|  NKD Loss: 0.8452
Epoch: 0|  Loss:  1.2415 |Global loss: 5.0849| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.8355
Epoch: 1|  Loss:  1.3266 |Global loss: 4.8457| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.7956
Epoch: 2|  Loss:  1.2233 |Global loss: 4.6837| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 3|  NKD Loss: 0.7477
Epoch: 3|  Loss:  1.1595 |Global loss: 4.639| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 0|  NKD Loss: 0.7921
Epoch: 0|  Loss:  0.9646 |Global loss: 4.9412| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.679
Epoch: 1|  Loss:  0.8493 |Global loss: 4.6124| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.6736
Epoch: 2|  Loss:  0.8413 |Global loss: 4.5669| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.6653
Epoch: 3|  Loss:  0.8359 |Global loss: 4.5887| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8332
Epoch: 0|  Loss:  1.08 |Global loss: 4.966| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.6942
Epoch: 1|  Loss:  0.9485 |Global loss: 4.7747| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.6874
Epoch: 2|  Loss:  0.9809 |Global loss: 4.7243| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.6602
Epoch: 3|  Loss:  0.9037 |Global loss: 4.7018| Local H loss: 0.0417  | Global H loss: 0.0417
------------------------- time cost ------------------------- 4.7124857902526855
Chosen Clients:  [1, 11, 5, 7, 4, 3]

-------------Round number: 79-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.983, 0.575, 0.983, 0.933, 0.967, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.85, 0.708, 0.975]
AUC in each clients:  [117.082, 119.098, 114.902, 119.08, 118.728, 118.164, 118.058, 119.06, 119.258, 119.528, 119.005, 119.258, 117.539, 114.354, 119.027]
F1 Score:  [0.773, 0.982, 0.574, 0.983, 0.921, 0.967, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.856, 0.679, 0.973]
Recall Score:  [0.826, 0.984, 0.624, 0.986, 0.926, 0.971, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.894, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0066
Averaged Test Accurancy: 0.9028
Averaged Test AUC: 0.9845
Averaged Test F1_score: 0.8985
Averaged Test Recal score: 0.9151
Std Test Accurancy: 0.1204
Std Test AUC: 0.0128
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8424
Epoch: 0|  Loss:  1.1472 |Global loss: 5.071| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 1|  NKD Loss: 0.6604
Epoch: 1|  Loss:  0.8658 |Global loss: 4.7285| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.6761
Epoch: 2|  Loss:  0.9161 |Global loss: 4.7089| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.7062
Epoch: 3|  Loss:  0.9412 |Global loss: 4.7337| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.8299
Epoch: 0|  Loss:  1.0537 |Global loss: 5.1796| Local H loss: 0.0532  | Global H loss: 0.0532
Epoch: 1|  NKD Loss: 0.7879
Epoch: 1|  Loss:  1.0384 |Global loss: 4.9275| Local H loss: 0.0548  | Global H loss: 0.0548
Epoch: 2|  NKD Loss: 0.7596
Epoch: 2|  Loss:  0.9903 |Global loss: 4.8058| Local H loss: 0.0567  | Global H loss: 0.0567
Epoch: 3|  NKD Loss: 0.7442
Epoch: 3|  Loss:  0.9676 |Global loss: 4.7808| Local H loss: 0.0571  | Global H loss: 0.0571
Epoch: 0|  NKD Loss: 0.8608
Epoch: 0|  Loss:  1.134 |Global loss: 5.0581| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.7489
Epoch: 1|  Loss:  1.0579 |Global loss: 4.7868| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7248
Epoch: 2|  Loss:  1.0243 |Global loss: 4.7354| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.6971
Epoch: 3|  Loss:  0.9599 |Global loss: 4.6379| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.8604
Epoch: 0|  Loss:  1.181 |Global loss: 5.3259| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.7687
Epoch: 1|  Loss:  1.0672 |Global loss: 4.903| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.7122
Epoch: 2|  Loss:  0.9904 |Global loss: 4.7836| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.7479
Epoch: 3|  Loss:  1.0772 |Global loss: 4.7726| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.7756
Epoch: 0|  Loss:  1.1221 |Global loss: 4.9785| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.7295
Epoch: 1|  Loss:  1.0299 |Global loss: 4.6307| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.7508
Epoch: 2|  Loss:  1.1082 |Global loss: 4.649| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.7399
Epoch: 3|  Loss:  1.0512 |Global loss: 4.6082| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.8756
Epoch: 0|  Loss:  1.1755 |Global loss: 5.1479| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.715
Epoch: 1|  Loss:  0.9109 |Global loss: 4.8253| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 2|  NKD Loss: 0.7268
Epoch: 2|  Loss:  0.9401 |Global loss: 4.7254| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 3|  NKD Loss: 0.7236
Epoch: 3|  Loss:  0.9403 |Global loss: 4.7104| Local H loss: 0.0438  | Global H loss: 0.0438
------------------------- time cost ------------------------- 4.9840569496154785
Chosen Clients:  [0, 5, 14, 3, 13, 12]

-------------Round number: 80-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.983, 0.575, 0.983, 0.892, 0.975, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.85, 0.708, 0.975]
AUC in each clients:  [117.082, 119.069, 114.902, 119.199, 118.563, 118.184, 118.058, 119.005, 119.258, 119.528, 119.005, 119.356, 117.539, 114.354, 119.027]
F1 Score:  [0.773, 0.982, 0.574, 0.983, 0.86, 0.974, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.856, 0.679, 0.973]
Recall Score:  [0.826, 0.984, 0.624, 0.986, 0.876, 0.977, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.894, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0316
Averaged Test Accurancy: 0.9006
Averaged Test AUC: 0.9845
Averaged Test F1_score: 0.8949
Averaged Test Recal score: 0.9121
Std Test Accurancy: 0.1204
Std Test AUC: 0.0128
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.7994
Epoch: 0|  Loss:  1.2035 |Global loss: 4.8961| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 1|  NKD Loss: 0.6618
Epoch: 1|  Loss:  1.0178 |Global loss: 4.5267| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 2|  NKD Loss: 0.6561
Epoch: 2|  Loss:  1.0137 |Global loss: 4.5346| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 3|  NKD Loss: 0.6637
Epoch: 3|  Loss:  1.0516 |Global loss: 4.4935| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 0|  NKD Loss: 0.8007
Epoch: 0|  Loss:  1.0913 |Global loss: 5.0256| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.6987
Epoch: 1|  Loss:  0.9475 |Global loss: 4.7409| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.7265
Epoch: 2|  Loss:  1.0191 |Global loss: 4.7191| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 3|  NKD Loss: 0.7411
Epoch: 3|  Loss:  1.068 |Global loss: 4.7648| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.8514
Epoch: 0|  Loss:  1.1394 |Global loss: 5.0521| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 1|  NKD Loss: 0.759
Epoch: 1|  Loss:  1.0618 |Global loss: 4.7674| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 2|  NKD Loss: 0.708
Epoch: 2|  Loss:  0.9638 |Global loss: 4.5737| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 3|  NKD Loss: 0.7081
Epoch: 3|  Loss:  0.9674 |Global loss: 4.5685| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 0|  NKD Loss: 0.809
Epoch: 0|  Loss:  0.9979 |Global loss: 5.0956| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.7182
Epoch: 1|  Loss:  0.9381 |Global loss: 4.7242| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 0.7162
Epoch: 2|  Loss:  0.9105 |Global loss: 4.6911| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 3|  NKD Loss: 0.6832
Epoch: 3|  Loss:  0.8716 |Global loss: 4.6223| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 0|  NKD Loss: 1.0257
Epoch: 0|  Loss:  1.8698 |Global loss: 5.0825| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.9189
Epoch: 1|  Loss:  1.7403 |Global loss: 4.7558| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 2|  NKD Loss: 0.9331
Epoch: 2|  Loss:  1.7686 |Global loss: 4.7072| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 3|  NKD Loss: 0.9076
Epoch: 3|  Loss:  1.7153 |Global loss: 4.6979| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 0|  NKD Loss: 0.8966
Epoch: 0|  Loss:  1.2407 |Global loss: 5.1282| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.7865
Epoch: 1|  Loss:  1.1476 |Global loss: 4.667| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 2|  NKD Loss: 0.7952
Epoch: 2|  Loss:  1.262 |Global loss: 4.6555| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 3|  NKD Loss: 0.8209
Epoch: 3|  Loss:  1.3378 |Global loss: 4.664| Local H loss: 0.0421  | Global H loss: 0.0421
------------------------- time cost ------------------------- 4.698015928268433
Chosen Clients:  [4, 3, 10, 14, 11, 0]

-------------Round number: 81-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.858, 0.983, 0.575, 0.983, 0.892, 0.975, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.867, 0.708, 0.975]
AUC in each clients:  [117.519, 119.069, 114.902, 119.251, 118.563, 118.162, 118.058, 119.005, 119.258, 119.528, 119.005, 119.356, 117.374, 115.04, 119.088]
F1 Score:  [0.863, 0.982, 0.574, 0.983, 0.86, 0.974, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.875, 0.679, 0.973]
Recall Score:  [0.903, 0.984, 0.624, 0.986, 0.876, 0.977, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.908, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1414
Averaged Test Accurancy: 0.9078
Averaged Test AUC: 0.9851
Averaged Test F1_score: 0.9022
Averaged Test Recal score: 0.9182
Std Test Accurancy: 0.1152
Std Test AUC: 0.0118
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8284
Epoch: 0|  Loss:  1.1625 |Global loss: 4.9659| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.7541
Epoch: 1|  Loss:  1.1021 |Global loss: 4.6067| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.7376
Epoch: 2|  Loss:  1.0543 |Global loss: 4.5211| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.7568
Epoch: 3|  Loss:  1.0886 |Global loss: 4.5741| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.891
Epoch: 0|  Loss:  1.0679 |Global loss: 5.2501| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 1|  NKD Loss: 0.7622
Epoch: 1|  Loss:  0.9614 |Global loss: 4.8015| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.7731
Epoch: 2|  Loss:  1.0182 |Global loss: 4.7547| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.7603
Epoch: 3|  Loss:  0.988 |Global loss: 4.7081| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 0|  NKD Loss: 0.9781
Epoch: 0|  Loss:  1.2571 |Global loss: 5.4548| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.8241
Epoch: 1|  Loss:  1.0372 |Global loss: 4.8971| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.9015
Epoch: 2|  Loss:  1.3541 |Global loss: 4.8944| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.8558
Epoch: 3|  Loss:  1.2117 |Global loss: 4.7236| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 0|  NKD Loss: 0.8103
Epoch: 0|  Loss:  1.0639 |Global loss: 4.9255| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 1|  NKD Loss: 0.745
Epoch: 1|  Loss:  0.9892 |Global loss: 4.6436| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 2|  NKD Loss: 0.7167
Epoch: 2|  Loss:  0.9739 |Global loss: 4.6047| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 3|  NKD Loss: 0.7014
Epoch: 3|  Loss:  0.946 |Global loss: 4.5335| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 0|  NKD Loss: 0.8589
Epoch: 0|  Loss:  1.0749 |Global loss: 5.1189| Local H loss: 0.0535  | Global H loss: 0.0535
Epoch: 1|  NKD Loss: 0.7934
Epoch: 1|  Loss:  1.0222 |Global loss: 4.8763| Local H loss: 0.0547  | Global H loss: 0.0547
Epoch: 2|  NKD Loss: 0.7593
Epoch: 2|  Loss:  0.9916 |Global loss: 4.7735| Local H loss: 0.0559  | Global H loss: 0.0559
Epoch: 3|  NKD Loss: 0.7735
Epoch: 3|  Loss:  1.0147 |Global loss: 4.7213| Local H loss: 0.0563  | Global H loss: 0.0563
Epoch: 0|  NKD Loss: 0.8199
Epoch: 0|  Loss:  1.1957 |Global loss: 4.8683| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 1|  NKD Loss: 0.6746
Epoch: 1|  Loss:  1.0259 |Global loss: 4.4525| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 2|  NKD Loss: 0.6479
Epoch: 2|  Loss:  0.9657 |Global loss: 4.4296| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.6647
Epoch: 3|  Loss:  1.0113 |Global loss: 4.4107| Local H loss: 0.0471  | Global H loss: 0.0471
------------------------- time cost ------------------------- 4.779710054397583
Chosen Clients:  [14, 9, 12, 4, 7, 6]

-------------Round number: 82-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.983, 0.575, 0.983, 0.883, 0.975, 0.917, 0.975, 0.975, 0.983, 0.975, 0.975, 0.867, 0.708, 0.975]
AUC in each clients:  [117.595, 119.069, 114.902, 119.232, 118.653, 118.162, 118.058, 119.005, 119.258, 119.528, 118.865, 119.327, 117.374, 115.04, 119.023]
F1 Score:  [0.904, 0.982, 0.574, 0.983, 0.851, 0.974, 0.896, 0.973, 0.974, 0.981, 0.973, 0.973, 0.875, 0.679, 0.973]
Recall Score:  [0.925, 0.984, 0.624, 0.986, 0.867, 0.977, 0.912, 0.977, 0.977, 0.984, 0.977, 0.977, 0.908, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0760
Averaged Test Accurancy: 0.9094
Averaged Test AUC: 0.9851
Averaged Test F1_score: 0.9043
Averaged Test Recal score: 0.9191
Std Test Accurancy: 0.1147
Std Test AUC: 0.0118
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8052
Epoch: 0|  Loss:  1.037 |Global loss: 4.9874| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.7445
Epoch: 1|  Loss:  1.0142 |Global loss: 4.5579| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 2|  NKD Loss: 0.726
Epoch: 2|  Loss:  0.9514 |Global loss: 4.4908| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 3|  NKD Loss: 0.7011
Epoch: 3|  Loss:  0.935 |Global loss: 4.4892| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 0|  NKD Loss: 0.8249
Epoch: 0|  Loss:  0.994 |Global loss: 4.96| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.7297
Epoch: 1|  Loss:  0.9146 |Global loss: 4.6163| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.6921
Epoch: 2|  Loss:  0.8762 |Global loss: 4.5813| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.725
Epoch: 3|  Loss:  0.9473 |Global loss: 4.6214| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 0|  NKD Loss: 0.8845
Epoch: 0|  Loss:  1.3092 |Global loss: 5.0377| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 1|  NKD Loss: 0.7591
Epoch: 1|  Loss:  1.1006 |Global loss: 4.5422| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.7731
Epoch: 2|  Loss:  1.1367 |Global loss: 4.5374| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 3|  NKD Loss: 0.7638
Epoch: 3|  Loss:  1.1119 |Global loss: 4.4881| Local H loss: 0.0444  | Global H loss: 0.0444
Epoch: 0|  NKD Loss: 0.8311
Epoch: 0|  Loss:  1.2157 |Global loss: 5.0773| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.7508
Epoch: 1|  Loss:  1.0319 |Global loss: 4.6363| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.746
Epoch: 2|  Loss:  1.0618 |Global loss: 4.4819| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.7115
Epoch: 3|  Loss:  1.0286 |Global loss: 4.4835| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.8318
Epoch: 0|  Loss:  1.1192 |Global loss: 5.1448| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 1|  NKD Loss: 0.7266
Epoch: 1|  Loss:  0.9962 |Global loss: 4.8064| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.8433
Epoch: 2|  Loss:  1.3148 |Global loss: 4.7949| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.7202
Epoch: 3|  Loss:  0.9954 |Global loss: 4.64| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 0|  NKD Loss: 0.9611
Epoch: 0|  Loss:  1.3811 |Global loss: 4.9712| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 1|  NKD Loss: 0.7824
Epoch: 1|  Loss:  1.191 |Global loss: 4.5961| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 2|  NKD Loss: 0.8307
Epoch: 2|  Loss:  1.271 |Global loss: 4.6301| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.8218
Epoch: 3|  Loss:  1.2705 |Global loss: 4.6129| Local H loss: 0.0432  | Global H loss: 0.0432
------------------------- time cost ------------------------- 4.740219831466675
Chosen Clients:  [13, 0, 12, 3, 9, 10]

-------------Round number: 83-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.983, 0.575, 0.983, 0.9, 0.975, 0.817, 0.975, 0.975, 0.983, 0.975, 0.975, 0.95, 0.708, 0.975]
AUC in each clients:  [117.595, 119.069, 114.902, 119.232, 118.731, 118.162, 116.326, 119.101, 119.258, 119.548, 118.865, 119.327, 118.004, 115.04, 119.178]
F1 Score:  [0.904, 0.982, 0.574, 0.983, 0.883, 0.974, 0.814, 0.973, 0.974, 0.981, 0.973, 0.973, 0.957, 0.679, 0.973]
Recall Score:  [0.925, 0.984, 0.624, 0.986, 0.89, 0.977, 0.852, 0.977, 0.977, 0.984, 0.977, 0.977, 0.963, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1602
Averaged Test Accurancy: 0.9094
Averaged Test AUC: 0.9846
Averaged Test F1_score: 0.9065
Averaged Test Recal score: 0.9203
Std Test Accurancy: 0.1169
Std Test AUC: 0.0124
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9509
Epoch: 0|  Loss:  1.71 |Global loss: 5.1317| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8583
Epoch: 1|  Loss:  1.5748 |Global loss: 4.6079| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 2|  NKD Loss: 0.8799
Epoch: 2|  Loss:  1.6333 |Global loss: 4.6491| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 3|  NKD Loss: 0.8123
Epoch: 3|  Loss:  1.484 |Global loss: 4.5084| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 0|  NKD Loss: 0.7892
Epoch: 0|  Loss:  1.1247 |Global loss: 4.8313| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 1|  NKD Loss: 0.6662
Epoch: 1|  Loss:  1.0055 |Global loss: 4.4826| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 2|  NKD Loss: 0.6688
Epoch: 2|  Loss:  0.9985 |Global loss: 4.4059| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 3|  NKD Loss: 0.6533
Epoch: 3|  Loss:  0.9999 |Global loss: 4.3463| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 0|  NKD Loss: 0.8371
Epoch: 0|  Loss:  1.1249 |Global loss: 4.9169| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.7347
Epoch: 1|  Loss:  1.0149 |Global loss: 4.5186| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 2|  NKD Loss: 0.8509
Epoch: 2|  Loss:  1.3718 |Global loss: 4.7312| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.7396
Epoch: 3|  Loss:  1.0758 |Global loss: 4.4208| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 0|  NKD Loss: 0.8186
Epoch: 0|  Loss:  1.0071 |Global loss: 5.0737| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.7229
Epoch: 1|  Loss:  0.9266 |Global loss: 4.5782| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.7139
Epoch: 2|  Loss:  0.9119 |Global loss: 4.5523| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.692
Epoch: 3|  Loss:  0.8713 |Global loss: 4.5128| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.8356
Epoch: 0|  Loss:  1.0402 |Global loss: 4.9394| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.7113
Epoch: 1|  Loss:  0.892 |Global loss: 4.626| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.6777
Epoch: 2|  Loss:  0.8426 |Global loss: 4.512| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.667
Epoch: 3|  Loss:  0.8305 |Global loss: 4.4774| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8559
Epoch: 0|  Loss:  1.0654 |Global loss: 5.3371| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.8258
Epoch: 1|  Loss:  1.0797 |Global loss: 4.8978| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.8191
Epoch: 2|  Loss:  1.0782 |Global loss: 4.6824| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.766
Epoch: 3|  Loss:  0.9816 |Global loss: 4.5912| Local H loss: 0.0427  | Global H loss: 0.0427
------------------------- time cost ------------------------- 5.379593849182129
Chosen Clients:  [10, 9, 14, 0, 7, 11]

-------------Round number: 84-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.983, 0.575, 0.975, 0.9, 0.975, 0.817, 0.975, 0.975, 0.983, 0.975, 0.975, 0.958, 0.708, 0.975]
AUC in each clients:  [118.155, 119.069, 114.902, 119.271, 118.731, 118.162, 116.326, 119.101, 119.258, 119.527, 119.097, 119.327, 118.09, 115.39, 119.178]
F1 Score:  [0.912, 0.982, 0.574, 0.973, 0.883, 0.974, 0.814, 0.973, 0.974, 0.981, 0.973, 0.973, 0.96, 0.675, 0.973]
Recall Score:  [0.931, 0.984, 0.624, 0.977, 0.89, 0.977, 0.852, 0.977, 0.977, 0.984, 0.977, 0.977, 0.965, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1273
Averaged Test Accurancy: 0.9111
Averaged Test AUC: 0.9853
Averaged Test F1_score: 0.9063
Averaged Test Recal score: 0.9202
Std Test Accurancy: 0.1167
Std Test AUC: 0.0120
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8634
Epoch: 0|  Loss:  1.0656 |Global loss: 5.2244| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.7834
Epoch: 1|  Loss:  0.9905 |Global loss: 4.7813| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.7981
Epoch: 2|  Loss:  1.0366 |Global loss: 4.6887| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.7482
Epoch: 3|  Loss:  0.9561 |Global loss: 4.5534| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.8181
Epoch: 0|  Loss:  1.0015 |Global loss: 4.964| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.7007
Epoch: 1|  Loss:  0.8733 |Global loss: 4.4845| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7006
Epoch: 2|  Loss:  0.888 |Global loss: 4.5516| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.6854
Epoch: 3|  Loss:  0.8559 |Global loss: 4.4251| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 0|  NKD Loss: 0.8197
Epoch: 0|  Loss:  1.0399 |Global loss: 4.8599| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 1|  NKD Loss: 0.741
Epoch: 1|  Loss:  0.9957 |Global loss: 4.5406| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 2|  NKD Loss: 0.7443
Epoch: 2|  Loss:  1.0399 |Global loss: 4.4787| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 3|  NKD Loss: 0.7432
Epoch: 3|  Loss:  1.0066 |Global loss: 4.4231| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 0|  NKD Loss: 0.8116
Epoch: 0|  Loss:  1.1682 |Global loss: 4.85| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.7126
Epoch: 1|  Loss:  1.0763 |Global loss: 4.4842| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 2|  NKD Loss: 0.6766
Epoch: 2|  Loss:  1.0169 |Global loss: 4.3839| Local H loss: 0.0454  | Global H loss: 0.0454
Epoch: 3|  NKD Loss: 0.6628
Epoch: 3|  Loss:  1.015 |Global loss: 4.381| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 0|  NKD Loss: 0.8113
Epoch: 0|  Loss:  1.0365 |Global loss: 5.0798| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.7352
Epoch: 1|  Loss:  0.9823 |Global loss: 4.7838| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.6897
Epoch: 2|  Loss:  0.9221 |Global loss: 4.6217| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.8026
Epoch: 3|  Loss:  1.192 |Global loss: 4.7125| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 0.9011
Epoch: 0|  Loss:  1.1225 |Global loss: 5.0097| Local H loss: 0.0532  | Global H loss: 0.0532
Epoch: 1|  NKD Loss: 0.7854
Epoch: 1|  Loss:  1.0171 |Global loss: 4.7255| Local H loss: 0.0549  | Global H loss: 0.0549
Epoch: 2|  NKD Loss: 0.769
Epoch: 2|  Loss:  0.9916 |Global loss: 4.6281| Local H loss: 0.057  | Global H loss: 0.057
Epoch: 3|  NKD Loss: 0.7686
Epoch: 3|  Loss:  0.9941 |Global loss: 4.5861| Local H loss: 0.0571  | Global H loss: 0.0571
------------------------- time cost ------------------------- 4.783045291900635
Chosen Clients:  [11, 10, 2, 1, 0, 12]

-------------Round number: 85-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.908, 0.983, 0.575, 0.975, 0.9, 0.975, 0.817, 0.975, 0.975, 0.983, 0.975, 0.975, 0.958, 0.708, 0.975]
AUC in each clients:  [117.942, 119.069, 114.902, 119.271, 118.731, 118.162, 116.326, 119.064, 119.258, 119.483, 119.132, 119.44, 118.09, 115.39, 118.883]
F1 Score:  [0.921, 0.982, 0.574, 0.973, 0.883, 0.974, 0.814, 0.973, 0.974, 0.981, 0.973, 0.973, 0.96, 0.675, 0.973]
Recall Score:  [0.936, 0.984, 0.624, 0.977, 0.89, 0.977, 0.852, 0.977, 0.977, 0.984, 0.977, 0.977, 0.965, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1534
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9851
Averaged Test F1_score: 0.9069
Averaged Test Recal score: 0.9205
Std Test Accurancy: 0.1167
Std Test AUC: 0.0120
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8839
Epoch: 0|  Loss:  1.1 |Global loss: 5.232| Local H loss: 0.0497  | Global H loss: 0.0497
Epoch: 1|  NKD Loss: 0.7664
Epoch: 1|  Loss:  0.9817 |Global loss: 4.8301| Local H loss: 0.0535  | Global H loss: 0.0535
Epoch: 2|  NKD Loss: 0.7656
Epoch: 2|  Loss:  0.9799 |Global loss: 4.718| Local H loss: 0.0547  | Global H loss: 0.0547
Epoch: 3|  NKD Loss: 0.7683
Epoch: 3|  Loss:  0.9851 |Global loss: 4.6973| Local H loss: 0.054  | Global H loss: 0.054
Epoch: 0|  NKD Loss: 0.9158
Epoch: 0|  Loss:  1.2309 |Global loss: 5.3618| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.7711
Epoch: 1|  Loss:  0.9662 |Global loss: 4.7139| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.7565
Epoch: 2|  Loss:  0.9646 |Global loss: 4.5859| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.787
Epoch: 3|  Loss:  1.0912 |Global loss: 4.5999| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 0|  NKD Loss: 0.9721
Epoch: 0|  Loss:  1.8717 |Global loss: 5.3286| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.899
Epoch: 1|  Loss:  1.6985 |Global loss: 4.6561| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 2|  NKD Loss: 0.9578
Epoch: 2|  Loss:  1.9467 |Global loss: 4.7931| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.9472
Epoch: 3|  Loss:  1.9659 |Global loss: 4.7564| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.8645
Epoch: 0|  Loss:  1.143 |Global loss: 5.1777| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.6937
Epoch: 1|  Loss:  0.9196 |Global loss: 4.6128| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 2|  NKD Loss: 0.6754
Epoch: 2|  Loss:  0.8831 |Global loss: 4.5823| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.6657
Epoch: 3|  Loss:  0.8887 |Global loss: 4.5496| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 0|  NKD Loss: 0.7715
Epoch: 0|  Loss:  1.1032 |Global loss: 4.7634| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.6908
Epoch: 1|  Loss:  1.0774 |Global loss: 4.463| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 2|  NKD Loss: 0.6851
Epoch: 2|  Loss:  1.008 |Global loss: 4.319| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 3|  NKD Loss: 0.6368
Epoch: 3|  Loss:  0.9228 |Global loss: 4.2518| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 0|  NKD Loss: 0.8681
Epoch: 0|  Loss:  1.2454 |Global loss: 4.8893| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.755
Epoch: 1|  Loss:  1.0987 |Global loss: 4.4376| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 2|  NKD Loss: 0.7876
Epoch: 2|  Loss:  1.1485 |Global loss: 4.443| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 3|  NKD Loss: 0.7201
Epoch: 3|  Loss:  1.0357 |Global loss: 4.3102| Local H loss: 0.0451  | Global H loss: 0.0451
------------------------- time cost ------------------------- 4.790112018585205
Chosen Clients:  [14, 1, 13, 5, 7, 6]

-------------Round number: 86-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.542, 0.975, 0.9, 0.975, 0.817, 0.975, 0.975, 0.983, 0.975, 0.975, 0.925, 0.708, 0.975]
AUC in each clients:  [118.305, 119.179, 114.512, 119.271, 118.731, 118.162, 116.326, 119.064, 119.258, 119.483, 119.095, 119.523, 118.29, 115.39, 118.883]
F1 Score:  [0.983, 0.981, 0.562, 0.973, 0.883, 0.974, 0.814, 0.973, 0.974, 0.981, 0.974, 0.973, 0.924, 0.675, 0.973]
Recall Score:  [0.986, 0.984, 0.608, 0.977, 0.89, 0.977, 0.852, 0.977, 0.977, 0.984, 0.977, 0.977, 0.938, 0.734, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1406
Averaged Test Accurancy: 0.9111
Averaged Test AUC: 0.9853
Averaged Test F1_score: 0.9078
Averaged Test Recal score: 0.9210
Std Test Accurancy: 0.1241
Std Test AUC: 0.0125
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.8334
Epoch: 0|  Loss:  1.0656 |Global loss: 4.8897| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.7655
Epoch: 1|  Loss:  1.0252 |Global loss: 4.655| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.7255
Epoch: 2|  Loss:  0.958 |Global loss: 4.5213| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 3|  NKD Loss: 0.7326
Epoch: 3|  Loss:  0.9686 |Global loss: 4.4309| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 0|  NKD Loss: 0.8058
Epoch: 0|  Loss:  0.9923 |Global loss: 5.1017| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 1|  NKD Loss: 0.6974
Epoch: 1|  Loss:  0.8848 |Global loss: 4.6478| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 2|  NKD Loss: 0.7541
Epoch: 2|  Loss:  0.9961 |Global loss: 4.6589| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.7086
Epoch: 3|  Loss:  0.9036 |Global loss: 4.5884| Local H loss: 0.0431  | Global H loss: 0.0431
Epoch: 0|  NKD Loss: 0.9819
Epoch: 0|  Loss:  1.6467 |Global loss: 5.282| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.8953
Epoch: 1|  Loss:  1.6209 |Global loss: 4.7698| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 2|  NKD Loss: 0.8887
Epoch: 2|  Loss:  1.5846 |Global loss: 4.701| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 3|  NKD Loss: 0.8621
Epoch: 3|  Loss:  1.4743 |Global loss: 4.523| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 0|  NKD Loss: 0.8816
Epoch: 0|  Loss:  1.1447 |Global loss: 5.1559| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.7425
Epoch: 1|  Loss:  1.0011 |Global loss: 4.603| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.7478
Epoch: 2|  Loss:  0.9986 |Global loss: 4.6465| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.7145
Epoch: 3|  Loss:  0.9793 |Global loss: 4.5513| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.8555
Epoch: 0|  Loss:  1.207 |Global loss: 5.1624| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.7104
Epoch: 1|  Loss:  0.9531 |Global loss: 4.6019| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.8422
Epoch: 2|  Loss:  1.304 |Global loss: 4.6839| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.7358
Epoch: 3|  Loss:  0.979 |Global loss: 4.4383| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 0|  NKD Loss: 0.9107
Epoch: 0|  Loss:  1.3262 |Global loss: 5.0397| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.7826
Epoch: 1|  Loss:  1.1944 |Global loss: 4.7382| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.8059
Epoch: 2|  Loss:  1.1859 |Global loss: 4.5426| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 3|  NKD Loss: 0.81
Epoch: 3|  Loss:  1.1928 |Global loss: 4.5236| Local H loss: 0.0442  | Global H loss: 0.0442
------------------------- time cost ------------------------- 4.8330748081207275
Chosen Clients:  [3, 2, 11, 8, 14, 1]

-------------Round number: 87-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.542, 0.975, 0.9, 0.983, 0.942, 0.983, 0.975, 0.983, 0.975, 0.975, 0.925, 0.8, 0.975]
AUC in each clients:  [118.305, 119.106, 114.512, 119.271, 118.731, 118.207, 118.595, 119.133, 119.258, 119.483, 119.095, 119.523, 118.29, 115.861, 119.17]
F1 Score:  [0.983, 0.982, 0.562, 0.973, 0.883, 0.982, 0.933, 0.981, 0.974, 0.981, 0.974, 0.973, 0.924, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.608, 0.977, 0.89, 0.984, 0.94, 0.984, 0.977, 0.984, 0.977, 0.977, 0.938, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9661
Averaged Test Accurancy: 0.9267
Averaged Test AUC: 0.9870
Averaged Test F1_score: 0.9227
Averaged Test Recal score: 0.9329
Std Test Accurancy: 0.1134
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.8755
Epoch: 0|  Loss:  1.0428 |Global loss: 5.2441| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.7637
Epoch: 1|  Loss:  0.9721 |Global loss: 4.7765| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.7741
Epoch: 2|  Loss:  1.0031 |Global loss: 4.7386| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 3|  NKD Loss: 0.7266
Epoch: 3|  Loss:  0.9074 |Global loss: 4.6907| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 0|  NKD Loss: 1.0632
Epoch: 0|  Loss:  1.9362 |Global loss: 5.2624| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9684
Epoch: 1|  Loss:  1.8712 |Global loss: 4.841| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.8952
Epoch: 2|  Loss:  1.6649 |Global loss: 4.6388| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.967
Epoch: 3|  Loss:  1.8901 |Global loss: 4.7628| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.8788
Epoch: 0|  Loss:  1.0958 |Global loss: 5.2158| Local H loss: 0.0487  | Global H loss: 0.0487
Epoch: 1|  NKD Loss: 0.7848
Epoch: 1|  Loss:  0.9988 |Global loss: 4.6264| Local H loss: 0.0543  | Global H loss: 0.0543
Epoch: 2|  NKD Loss: 0.748
Epoch: 2|  Loss:  0.9442 |Global loss: 4.5409| Local H loss: 0.055  | Global H loss: 0.055
Epoch: 3|  NKD Loss: 0.7535
Epoch: 3|  Loss:  0.9679 |Global loss: 4.5294| Local H loss: 0.0547  | Global H loss: 0.0547
Epoch: 0|  NKD Loss: 0.8812
Epoch: 0|  Loss:  1.1838 |Global loss: 4.8756| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 1|  NKD Loss: 0.8642
Epoch: 1|  Loss:  1.3384 |Global loss: 4.6029| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 2|  NKD Loss: 0.7959
Epoch: 2|  Loss:  1.1891 |Global loss: 4.401| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 3|  NKD Loss: 0.7199
Epoch: 3|  Loss:  1.0285 |Global loss: 4.2662| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 0|  NKD Loss: 0.8054
Epoch: 0|  Loss:  1.0002 |Global loss: 4.9305| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.7552
Epoch: 1|  Loss:  0.973 |Global loss: 4.5282| Local H loss: 0.0431  | Global H loss: 0.0431
Epoch: 2|  NKD Loss: 0.712
Epoch: 2|  Loss:  0.9422 |Global loss: 4.4199| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 3|  NKD Loss: 0.7099
Epoch: 3|  Loss:  0.9165 |Global loss: 4.4338| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 0|  NKD Loss: 0.8581
Epoch: 0|  Loss:  1.0691 |Global loss: 4.9109| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.7775
Epoch: 1|  Loss:  1.0237 |Global loss: 4.7138| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.6981
Epoch: 2|  Loss:  0.8988 |Global loss: 4.5429| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.6946
Epoch: 3|  Loss:  0.8728 |Global loss: 4.472| Local H loss: 0.0437  | Global H loss: 0.0437
------------------------- time cost ------------------------- 4.866893768310547
Chosen Clients:  [14, 7, 0, 2, 1, 12]

-------------Round number: 88-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.608, 0.983, 0.9, 0.983, 0.942, 0.983, 0.975, 0.983, 0.975, 0.975, 0.925, 0.8, 0.975]
AUC in each clients:  [118.305, 119.255, 115.257, 119.192, 118.731, 118.207, 118.595, 119.133, 119.287, 119.483, 119.095, 119.52, 118.29, 115.861, 119.089]
F1 Score:  [0.983, 0.982, 0.613, 0.983, 0.883, 0.982, 0.933, 0.981, 0.973, 0.981, 0.974, 0.973, 0.924, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.652, 0.986, 0.89, 0.984, 0.94, 0.984, 0.977, 0.984, 0.977, 0.977, 0.938, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9406
Averaged Test Accurancy: 0.9317
Averaged Test AUC: 0.9874
Averaged Test F1_score: 0.9267
Averaged Test Recal score: 0.9364
Std Test Accurancy: 0.0988
Std Test AUC: 0.0102
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.8291
Epoch: 0|  Loss:  1.0729 |Global loss: 5.0453| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.7722
Epoch: 1|  Loss:  0.9961 |Global loss: 4.5155| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.7248
Epoch: 2|  Loss:  0.9393 |Global loss: 4.4689| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.7142
Epoch: 3|  Loss:  0.9366 |Global loss: 4.346| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 0|  NKD Loss: 0.8135
Epoch: 0|  Loss:  1.0475 |Global loss: 5.0026| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.7031
Epoch: 1|  Loss:  0.9007 |Global loss: 4.4097| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.6835
Epoch: 2|  Loss:  0.9547 |Global loss: 4.4325| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.7335
Epoch: 3|  Loss:  1.0569 |Global loss: 4.4949| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 0|  NKD Loss: 0.7954
Epoch: 0|  Loss:  1.0887 |Global loss: 4.9334| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 0.6815
Epoch: 1|  Loss:  1.0018 |Global loss: 4.378| Local H loss: 0.0444  | Global H loss: 0.0444
Epoch: 2|  NKD Loss: 0.6474
Epoch: 2|  Loss:  0.916 |Global loss: 4.325| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 3|  NKD Loss: 0.6602
Epoch: 3|  Loss:  0.971 |Global loss: 4.2788| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 0|  NKD Loss: 0.9597
Epoch: 0|  Loss:  1.7127 |Global loss: 5.1528| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9389
Epoch: 1|  Loss:  1.7425 |Global loss: 4.749| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.9091
Epoch: 2|  Loss:  1.6825 |Global loss: 4.5888| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.8915
Epoch: 3|  Loss:  1.6496 |Global loss: 4.5577| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.8158
Epoch: 0|  Loss:  1.0103 |Global loss: 5.0766| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.6893
Epoch: 1|  Loss:  0.8681 |Global loss: 4.6224| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.7138
Epoch: 2|  Loss:  0.908 |Global loss: 4.5855| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.6892
Epoch: 3|  Loss:  0.8827 |Global loss: 4.5027| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.922
Epoch: 0|  Loss:  1.2651 |Global loss: 5.0326| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.796
Epoch: 1|  Loss:  1.1198 |Global loss: 4.5713| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.7896
Epoch: 2|  Loss:  1.0665 |Global loss: 4.4873| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 3|  NKD Loss: 0.7905
Epoch: 3|  Loss:  1.0899 |Global loss: 4.5007| Local H loss: 0.0426  | Global H loss: 0.0426
------------------------- time cost ------------------------- 4.757347822189331
Chosen Clients:  [10, 14, 8, 6, 9, 12]

-------------Round number: 89-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.75, 0.983, 0.9, 0.983, 0.942, 0.983, 0.975, 0.983, 0.975, 0.975, 0.85, 0.8, 0.975]
AUC in each clients:  [118.436, 119.285, 116.119, 119.192, 118.731, 118.207, 118.595, 119.23, 119.287, 119.483, 119.095, 119.52, 117.02, 115.861, 119.055]
F1 Score:  [0.956, 0.982, 0.731, 0.983, 0.883, 0.982, 0.933, 0.982, 0.973, 0.981, 0.974, 0.973, 0.855, 0.763, 0.973]
Recall Score:  [0.964, 0.984, 0.762, 0.986, 0.89, 0.984, 0.94, 0.984, 0.977, 0.984, 0.977, 0.977, 0.894, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0620
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9283
Averaged Test Recal score: 0.9393
Std Test Accurancy: 0.0727
Std Test AUC: 0.0096
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9257
Epoch: 0|  Loss:  1.1516 |Global loss: 5.4072| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.7584
Epoch: 1|  Loss:  0.9589 |Global loss: 4.6922| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 0.7314
Epoch: 2|  Loss:  0.917 |Global loss: 4.5568| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.7211
Epoch: 3|  Loss:  0.93 |Global loss: 4.4246| Local H loss: 0.0431  | Global H loss: 0.0431
Epoch: 0|  NKD Loss: 0.8191
Epoch: 0|  Loss:  1.0221 |Global loss: 4.9185| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 0.7514
Epoch: 1|  Loss:  0.9568 |Global loss: 4.5452| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.7096
Epoch: 2|  Loss:  0.9014 |Global loss: 4.3569| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.7048
Epoch: 3|  Loss:  0.9162 |Global loss: 4.3832| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.9082
Epoch: 0|  Loss:  1.1846 |Global loss: 4.8784| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 1|  NKD Loss: 0.814
Epoch: 1|  Loss:  1.1387 |Global loss: 4.3507| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 2|  NKD Loss: 0.7608
Epoch: 2|  Loss:  1.0385 |Global loss: 4.3046| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 3|  NKD Loss: 0.7264
Epoch: 3|  Loss:  1.001 |Global loss: 4.2102| Local H loss: 0.0476  | Global H loss: 0.0476
Epoch: 0|  NKD Loss: 0.8899
Epoch: 0|  Loss:  1.2669 |Global loss: 4.9057| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.7652
Epoch: 1|  Loss:  1.114 |Global loss: 4.4726| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 2|  NKD Loss: 0.8284
Epoch: 2|  Loss:  1.1632 |Global loss: 4.5958| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 3|  NKD Loss: 0.7273
Epoch: 3|  Loss:  1.0328 |Global loss: 4.3528| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 0|  NKD Loss: 0.7993
Epoch: 0|  Loss:  0.9733 |Global loss: 4.9839| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.7253
Epoch: 1|  Loss:  0.9007 |Global loss: 4.5812| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.7161
Epoch: 2|  Loss:  0.8823 |Global loss: 4.5208| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 0.7037
Epoch: 3|  Loss:  0.876 |Global loss: 4.4099| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9077
Epoch: 0|  Loss:  1.2184 |Global loss: 4.9487| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.8129
Epoch: 1|  Loss:  1.1801 |Global loss: 4.437| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.7647
Epoch: 2|  Loss:  1.0537 |Global loss: 4.3548| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 3|  NKD Loss: 0.8054
Epoch: 3|  Loss:  1.1044 |Global loss: 4.3436| Local H loss: 0.0435  | Global H loss: 0.0435
------------------------- time cost ------------------------- 4.774562835693359
Chosen Clients:  [12, 8, 0, 7, 3, 10]

-------------Round number: 90-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.75, 0.983, 0.9, 0.983, 0.967, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.8, 0.967]
AUC in each clients:  [118.436, 119.285, 116.119, 119.192, 118.731, 118.207, 118.69, 119.23, 119.345, 119.526, 119.18, 119.52, 118.783, 115.861, 118.905]
F1 Score:  [0.956, 0.982, 0.731, 0.983, 0.883, 0.982, 0.964, 0.982, 0.974, 0.981, 0.973, 0.973, 0.969, 0.763, 0.965]
Recall Score:  [0.964, 0.984, 0.762, 0.986, 0.89, 0.984, 0.968, 0.984, 0.977, 0.984, 0.977, 0.977, 0.974, 0.81, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9945
Averaged Test Accurancy: 0.9428
Averaged Test AUC: 0.9883
Averaged Test F1_score: 0.9374
Averaged Test Recal score: 0.9461
Std Test Accurancy: 0.0695
Std Test AUC: 0.0091
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8401
Epoch: 0|  Loss:  1.0971 |Global loss: 4.9964| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.7762
Epoch: 1|  Loss:  1.0904 |Global loss: 4.3866| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.7568
Epoch: 2|  Loss:  1.0462 |Global loss: 4.2677| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 3|  NKD Loss: 0.7216
Epoch: 3|  Loss:  0.9576 |Global loss: 4.2251| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 0|  NKD Loss: 0.8341
Epoch: 0|  Loss:  1.1252 |Global loss: 4.7611| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 1|  NKD Loss: 0.7884
Epoch: 1|  Loss:  1.0753 |Global loss: 4.3703| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 2|  NKD Loss: 0.734
Epoch: 2|  Loss:  0.9496 |Global loss: 4.2035| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.7468
Epoch: 3|  Loss:  0.9911 |Global loss: 4.3019| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 0|  NKD Loss: 0.828
Epoch: 0|  Loss:  1.1219 |Global loss: 4.93| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.6878
Epoch: 1|  Loss:  0.995 |Global loss: 4.3745| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 2|  NKD Loss: 0.6734
Epoch: 2|  Loss:  0.9737 |Global loss: 4.2442| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 3|  NKD Loss: 0.6657
Epoch: 3|  Loss:  0.931 |Global loss: 4.2536| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 0|  NKD Loss: 0.8466
Epoch: 0|  Loss:  1.053 |Global loss: 4.9791| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.782
Epoch: 1|  Loss:  1.1814 |Global loss: 4.569| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.676
Epoch: 2|  Loss:  0.956 |Global loss: 4.3632| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.6631
Epoch: 3|  Loss:  0.9 |Global loss: 4.3297| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.856
Epoch: 0|  Loss:  1.0524 |Global loss: 5.2343| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.737
Epoch: 1|  Loss:  0.9207 |Global loss: 4.4562| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.7405
Epoch: 2|  Loss:  0.959 |Global loss: 4.4465| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.6692
Epoch: 3|  Loss:  0.8521 |Global loss: 4.3808| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.8527
Epoch: 0|  Loss:  1.0349 |Global loss: 5.4221| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.7587
Epoch: 1|  Loss:  0.9587 |Global loss: 4.6482| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.7409
Epoch: 2|  Loss:  0.9769 |Global loss: 4.5116| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.701
Epoch: 3|  Loss:  0.9449 |Global loss: 4.3468| Local H loss: 0.0434  | Global H loss: 0.0434
------------------------- time cost ------------------------- 5.182112216949463
Chosen Clients:  [2, 6, 14, 0, 12, 11]

-------------Round number: 91-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.75, 0.983, 0.9, 0.983, 0.967, 0.983, 0.975, 0.983, 0.975, 0.975, 0.908, 0.8, 0.967]
AUC in each clients:  [118.545, 119.285, 116.119, 119.177, 118.731, 118.207, 118.69, 119.172, 119.358, 119.526, 119.205, 119.52, 118.136, 115.861, 118.905]
F1 Score:  [0.983, 0.982, 0.731, 0.984, 0.883, 0.982, 0.964, 0.982, 0.974, 0.981, 0.973, 0.973, 0.897, 0.763, 0.965]
Recall Score:  [0.986, 0.984, 0.762, 0.986, 0.89, 0.984, 0.968, 0.984, 0.977, 0.984, 0.977, 0.977, 0.921, 0.81, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0976
Averaged Test Accurancy: 0.9411
Averaged Test AUC: 0.9880
Averaged Test F1_score: 0.9345
Averaged Test Recal score: 0.9440
Std Test Accurancy: 0.0705
Std Test AUC: 0.0091
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9091
Epoch: 0|  Loss:  1.599 |Global loss: 5.2235| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.8759
Epoch: 1|  Loss:  1.5896 |Global loss: 4.6548| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.949
Epoch: 2|  Loss:  1.7925 |Global loss: 4.5951| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 3|  NKD Loss: 0.9175
Epoch: 3|  Loss:  1.7203 |Global loss: 4.5864| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.9156
Epoch: 0|  Loss:  1.2233 |Global loss: 5.1782| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.7603
Epoch: 1|  Loss:  1.1034 |Global loss: 4.5194| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 2|  NKD Loss: 0.7735
Epoch: 2|  Loss:  1.1033 |Global loss: 4.4505| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 3|  NKD Loss: 0.8062
Epoch: 3|  Loss:  1.1319 |Global loss: 4.4439| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 0|  NKD Loss: 0.9079
Epoch: 0|  Loss:  1.1506 |Global loss: 5.0901| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.7483
Epoch: 1|  Loss:  0.9494 |Global loss: 4.3845| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.7507
Epoch: 2|  Loss:  0.9703 |Global loss: 4.4653| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.7264
Epoch: 3|  Loss:  0.9305 |Global loss: 4.3849| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.8719
Epoch: 0|  Loss:  1.2424 |Global loss: 5.0104| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.6887
Epoch: 1|  Loss:  0.9558 |Global loss: 4.2166| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 2|  NKD Loss: 0.6913
Epoch: 2|  Loss:  0.9655 |Global loss: 4.218| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 3|  NKD Loss: 0.6606
Epoch: 3|  Loss:  0.9307 |Global loss: 4.1521| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 0|  NKD Loss: 0.9852
Epoch: 0|  Loss:  1.4719 |Global loss: 5.1689| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.8403
Epoch: 1|  Loss:  1.2031 |Global loss: 4.5621| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.8543
Epoch: 2|  Loss:  1.2651 |Global loss: 4.4423| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.7575
Epoch: 3|  Loss:  1.0562 |Global loss: 4.2779| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.8671
Epoch: 0|  Loss:  1.0689 |Global loss: 5.276| Local H loss: 0.0484  | Global H loss: 0.0484
Epoch: 1|  NKD Loss: 0.7368
Epoch: 1|  Loss:  0.9458 |Global loss: 4.5644| Local H loss: 0.053  | Global H loss: 0.053
Epoch: 2|  NKD Loss: 0.7042
Epoch: 2|  Loss:  0.917 |Global loss: 4.4402| Local H loss: 0.0543  | Global H loss: 0.0543
Epoch: 3|  NKD Loss: 0.7185
Epoch: 3|  Loss:  0.9317 |Global loss: 4.4574| Local H loss: 0.0538  | Global H loss: 0.0538
------------------------- time cost ------------------------- 4.762346267700195
Chosen Clients:  [10, 6, 11, 3, 8, 0]

-------------Round number: 92-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.933, 0.983, 0.742, 0.983, 0.9, 0.983, 0.942, 0.983, 0.975, 0.983, 0.975, 0.975, 0.925, 0.8, 0.975]
AUC in each clients:  [118.326, 119.285, 117.122, 119.177, 118.731, 118.207, 118.764, 119.172, 119.358, 119.526, 119.205, 119.578, 118.105, 115.861, 119.31]
F1 Score:  [0.942, 0.982, 0.725, 0.984, 0.883, 0.982, 0.933, 0.982, 0.974, 0.981, 0.973, 0.973, 0.93, 0.763, 0.973]
Recall Score:  [0.953, 0.984, 0.756, 0.986, 0.89, 0.984, 0.94, 0.984, 0.977, 0.984, 0.977, 0.977, 0.944, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0960
Averaged Test Accurancy: 0.9372
Averaged Test AUC: 0.9887
Averaged Test F1_score: 0.9320
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0707
Std Test AUC: 0.0082
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8479
Epoch: 0|  Loss:  1.0846 |Global loss: 5.3895| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.7031
Epoch: 1|  Loss:  0.8968 |Global loss: 4.5932| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.7011
Epoch: 2|  Loss:  0.9348 |Global loss: 4.502| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.6869
Epoch: 3|  Loss:  0.8989 |Global loss: 4.344| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 0|  NKD Loss: 0.9583
Epoch: 0|  Loss:  1.2747 |Global loss: 5.012| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.7898
Epoch: 1|  Loss:  1.1099 |Global loss: 4.4457| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 2|  NKD Loss: 0.7434
Epoch: 2|  Loss:  1.0311 |Global loss: 4.3162| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 3|  NKD Loss: 0.7569
Epoch: 3|  Loss:  1.0661 |Global loss: 4.3911| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 0|  NKD Loss: 0.8408
Epoch: 0|  Loss:  1.0497 |Global loss: 5.2117| Local H loss: 0.0477  | Global H loss: 0.0477
Epoch: 1|  NKD Loss: 0.7305
Epoch: 1|  Loss:  0.9379 |Global loss: 4.5865| Local H loss: 0.0518  | Global H loss: 0.0518
Epoch: 2|  NKD Loss: 0.7027
Epoch: 2|  Loss:  0.9046 |Global loss: 4.3898| Local H loss: 0.0541  | Global H loss: 0.0541
Epoch: 3|  NKD Loss: 0.7077
Epoch: 3|  Loss:  0.9199 |Global loss: 4.5003| Local H loss: 0.052  | Global H loss: 0.052
Epoch: 0|  NKD Loss: 0.8541
Epoch: 0|  Loss:  1.0446 |Global loss: 5.367| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.6825
Epoch: 1|  Loss:  0.862 |Global loss: 4.5777| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.6437
Epoch: 2|  Loss:  0.8208 |Global loss: 4.3883| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.6446
Epoch: 3|  Loss:  0.8189 |Global loss: 4.3767| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.8898
Epoch: 0|  Loss:  1.1389 |Global loss: 4.6981| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 1|  NKD Loss: 0.8248
Epoch: 1|  Loss:  1.1017 |Global loss: 4.2987| Local H loss: 0.0449  | Global H loss: 0.0449
Epoch: 2|  NKD Loss: 0.7633
Epoch: 2|  Loss:  1.0333 |Global loss: 4.1767| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 3|  NKD Loss: 0.7506
Epoch: 3|  Loss:  0.9739 |Global loss: 4.078| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 0|  NKD Loss: 0.785
Epoch: 0|  Loss:  1.0474 |Global loss: 5.0745| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.7158
Epoch: 1|  Loss:  1.0068 |Global loss: 4.3159| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 2|  NKD Loss: 0.6959
Epoch: 2|  Loss:  1.0164 |Global loss: 4.346| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.7076
Epoch: 3|  Loss:  1.0687 |Global loss: 4.4194| Local H loss: 0.0406  | Global H loss: 0.0406
------------------------- time cost ------------------------- 4.833476543426514
Chosen Clients:  [13, 3, 11, 8, 5, 6]

-------------Round number: 93-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.983, 0.742, 0.983, 0.9, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.925, 0.8, 0.975]
AUC in each clients:  [118.407, 119.285, 117.122, 119.344, 118.731, 118.207, 118.855, 119.172, 119.32, 119.526, 119.206, 119.614, 118.105, 115.861, 119.31]
F1 Score:  [0.961, 0.982, 0.725, 0.984, 0.883, 0.982, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.93, 0.763, 0.973]
Recall Score:  [0.967, 0.984, 0.756, 0.986, 0.89, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.944, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1060
Averaged Test Accurancy: 0.9411
Averaged Test AUC: 0.9889
Averaged Test F1_score: 0.9360
Averaged Test Recal score: 0.9449
Std Test Accurancy: 0.0715
Std Test AUC: 0.0083
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0335
Epoch: 0|  Loss:  1.6336 |Global loss: 5.3572| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.8772
Epoch: 1|  Loss:  1.485 |Global loss: 4.7026| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 2|  NKD Loss: 0.9157
Epoch: 2|  Loss:  1.5748 |Global loss: 4.7099| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 3|  NKD Loss: 0.8652
Epoch: 3|  Loss:  1.4346 |Global loss: 4.4372| Local H loss: 0.0476  | Global H loss: 0.0476
Epoch: 0|  NKD Loss: 0.8139
Epoch: 0|  Loss:  1.0119 |Global loss: 5.0545| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.6717
Epoch: 1|  Loss:  0.8504 |Global loss: 4.3644| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.7069
Epoch: 2|  Loss:  0.9645 |Global loss: 4.4145| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.621
Epoch: 3|  Loss:  0.7945 |Global loss: 4.1883| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 0|  NKD Loss: 0.8251
Epoch: 0|  Loss:  1.0242 |Global loss: 4.957| Local H loss: 0.0485  | Global H loss: 0.0485
Epoch: 1|  NKD Loss: 0.769
Epoch: 1|  Loss:  0.9824 |Global loss: 4.7383| Local H loss: 0.0491  | Global H loss: 0.0491
Epoch: 2|  NKD Loss: 0.7039
Epoch: 2|  Loss:  0.9177 |Global loss: 4.4527| Local H loss: 0.0515  | Global H loss: 0.0515
Epoch: 3|  NKD Loss: 0.6631
Epoch: 3|  Loss:  0.8729 |Global loss: 4.317| Local H loss: 0.0538  | Global H loss: 0.0538
Epoch: 0|  NKD Loss: 0.8337
Epoch: 0|  Loss:  1.0508 |Global loss: 4.6796| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.7627
Epoch: 1|  Loss:  0.9965 |Global loss: 4.2374| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.7632
Epoch: 2|  Loss:  1.0589 |Global loss: 4.2166| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 3|  NKD Loss: 0.7428
Epoch: 3|  Loss:  0.9647 |Global loss: 4.1113| Local H loss: 0.0454  | Global H loss: 0.0454
Epoch: 0|  NKD Loss: 0.9653
Epoch: 0|  Loss:  1.2662 |Global loss: 5.4592| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.825
Epoch: 1|  Loss:  1.0982 |Global loss: 4.6569| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.834
Epoch: 2|  Loss:  1.0922 |Global loss: 4.7233| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 3|  NKD Loss: 0.7889
Epoch: 3|  Loss:  1.0402 |Global loss: 4.5005| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8281
Epoch: 0|  Loss:  1.1511 |Global loss: 4.9615| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.7287
Epoch: 1|  Loss:  0.9759 |Global loss: 4.3931| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 2|  NKD Loss: 0.709
Epoch: 2|  Loss:  0.9784 |Global loss: 4.3351| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 3|  NKD Loss: 0.7589
Epoch: 3|  Loss:  1.0291 |Global loss: 4.4371| Local H loss: 0.0455  | Global H loss: 0.0455
------------------------- time cost ------------------------- 4.734156608581543
Chosen Clients:  [10, 7, 0, 13, 12, 5]

-------------Round number: 94-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.983, 0.742, 0.983, 0.9, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.975, 0.925, 0.8, 0.975]
AUC in each clients:  [118.407, 119.285, 117.122, 119.308, 118.731, 118.371, 118.811, 119.172, 119.262, 119.526, 119.206, 119.579, 118.105, 115.506, 119.31]
F1 Score:  [0.961, 0.982, 0.725, 0.984, 0.883, 0.976, 0.954, 0.982, 0.974, 0.981, 0.973, 0.973, 0.93, 0.759, 0.973]
Recall Score:  [0.967, 0.984, 0.756, 0.986, 0.89, 0.981, 0.958, 0.984, 0.977, 0.984, 0.977, 0.977, 0.944, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0809
Averaged Test Accurancy: 0.9394
Averaged Test AUC: 0.9887
Averaged Test F1_score: 0.9340
Averaged Test Recal score: 0.9435
Std Test Accurancy: 0.0707
Std Test AUC: 0.0088
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8249
Epoch: 0|  Loss:  1.0229 |Global loss: 5.4113| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.7154
Epoch: 1|  Loss:  0.9314 |Global loss: 4.5458| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.7128
Epoch: 2|  Loss:  0.9469 |Global loss: 4.3589| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.6959
Epoch: 3|  Loss:  0.9412 |Global loss: 4.2671| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 0|  NKD Loss: 0.8864
Epoch: 0|  Loss:  1.1281 |Global loss: 5.1408| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.7077
Epoch: 1|  Loss:  0.9291 |Global loss: 4.4153| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.6824
Epoch: 2|  Loss:  0.9019 |Global loss: 4.3558| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.6882
Epoch: 3|  Loss:  0.8944 |Global loss: 4.2474| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 0|  NKD Loss: 0.8197
Epoch: 0|  Loss:  1.0896 |Global loss: 5.1542| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.6383
Epoch: 1|  Loss:  0.8794 |Global loss: 4.1628| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 2|  NKD Loss: 0.6484
Epoch: 2|  Loss:  0.956 |Global loss: 4.2051| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 3|  NKD Loss: 0.6331
Epoch: 3|  Loss:  0.9482 |Global loss: 4.2296| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.9516
Epoch: 0|  Loss:  1.5456 |Global loss: 5.2529| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8763
Epoch: 1|  Loss:  1.481 |Global loss: 4.6515| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 2|  NKD Loss: 0.8453
Epoch: 2|  Loss:  1.4405 |Global loss: 4.5029| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 3|  NKD Loss: 0.8215
Epoch: 3|  Loss:  1.4008 |Global loss: 4.3659| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 0|  NKD Loss: 0.8715
Epoch: 0|  Loss:  1.1457 |Global loss: 4.8181| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.7739
Epoch: 1|  Loss:  1.0664 |Global loss: 4.2938| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.8158
Epoch: 2|  Loss:  1.1713 |Global loss: 4.3412| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.763
Epoch: 3|  Loss:  1.0496 |Global loss: 4.1143| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 0.851
Epoch: 0|  Loss:  1.0835 |Global loss: 5.2471| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.8136
Epoch: 1|  Loss:  1.1258 |Global loss: 4.7483| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.774
Epoch: 2|  Loss:  1.0709 |Global loss: 4.5067| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.7601
Epoch: 3|  Loss:  1.032 |Global loss: 4.4736| Local H loss: 0.0403  | Global H loss: 0.0403
------------------------- time cost ------------------------- 4.988189220428467
Chosen Clients:  [9, 14, 7, 6, 3, 12]

-------------Round number: 95-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.742, 0.983, 0.9, 0.983, 0.958, 0.983, 0.975, 0.983, 0.975, 0.975, 0.958, 0.792, 0.975]
AUC in each clients:  [118.742, 119.285, 117.122, 119.308, 118.731, 118.431, 118.811, 119.334, 119.262, 119.526, 118.903, 119.579, 118.697, 116.048, 119.31]
F1 Score:  [0.983, 0.982, 0.725, 0.984, 0.883, 0.982, 0.954, 0.982, 0.974, 0.981, 0.973, 0.973, 0.961, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.756, 0.986, 0.89, 0.984, 0.958, 0.984, 0.977, 0.984, 0.977, 0.977, 0.967, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1015
Averaged Test Accurancy: 0.9433
Averaged Test AUC: 0.9895
Averaged Test F1_score: 0.9379
Averaged Test Recal score: 0.9460
Std Test Accurancy: 0.0729
Std Test AUC: 0.0077
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8046
Epoch: 0|  Loss:  0.9708 |Global loss: 5.169| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.7067
Epoch: 1|  Loss:  0.8732 |Global loss: 4.3815| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.7097
Epoch: 2|  Loss:  0.878 |Global loss: 4.4312| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.7114
Epoch: 3|  Loss:  0.8837 |Global loss: 4.3848| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.8892
Epoch: 0|  Loss:  1.1075 |Global loss: 5.1621| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.7445
Epoch: 1|  Loss:  0.9552 |Global loss: 4.4022| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.7014
Epoch: 2|  Loss:  0.9013 |Global loss: 4.3235| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.6792
Epoch: 3|  Loss:  0.8851 |Global loss: 4.2636| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.7991
Epoch: 0|  Loss:  0.9744 |Global loss: 4.9602| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.6681
Epoch: 1|  Loss:  0.8651 |Global loss: 4.3292| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.639
Epoch: 2|  Loss:  0.8451 |Global loss: 4.1787| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.6788
Epoch: 3|  Loss:  0.8736 |Global loss: 4.2189| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.812
Epoch: 0|  Loss:  1.0795 |Global loss: 5.0431| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.7489
Epoch: 1|  Loss:  0.9919 |Global loss: 4.3449| Local H loss: 0.046  | Global H loss: 0.046
Epoch: 2|  NKD Loss: 0.735
Epoch: 2|  Loss:  0.9658 |Global loss: 4.3678| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 3|  NKD Loss: 0.7227
Epoch: 3|  Loss:  0.9536 |Global loss: 4.3605| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.8603
Epoch: 0|  Loss:  1.0202 |Global loss: 5.0814| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.7856
Epoch: 1|  Loss:  1.0173 |Global loss: 4.3655| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.7144
Epoch: 2|  Loss:  0.8927 |Global loss: 4.1765| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.6646
Epoch: 3|  Loss:  0.8434 |Global loss: 4.1611| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.8712
Epoch: 0|  Loss:  1.1757 |Global loss: 4.9983| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.8072
Epoch: 1|  Loss:  1.1239 |Global loss: 4.2793| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8502
Epoch: 2|  Loss:  1.3429 |Global loss: 4.3558| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.7798
Epoch: 3|  Loss:  1.1056 |Global loss: 4.1616| Local H loss: 0.0394  | Global H loss: 0.0394
------------------------- time cost ------------------------- 5.105899810791016
Chosen Clients:  [9, 7, 8, 12, 14, 6]

-------------Round number: 96-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.742, 0.983, 0.9, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.792, 0.975]
AUC in each clients:  [118.742, 119.285, 117.122, 119.311, 118.731, 118.431, 119.091, 119.236, 119.262, 119.519, 118.903, 119.579, 118.673, 116.048, 118.852]
F1 Score:  [0.983, 0.982, 0.725, 0.983, 0.883, 0.982, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.948, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.756, 0.986, 0.89, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.957, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1793
Averaged Test Accurancy: 0.9439
Averaged Test AUC: 0.9893
Averaged Test F1_score: 0.9383
Averaged Test Recal score: 0.9466
Std Test Accurancy: 0.0731
Std Test AUC: 0.0076
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.823
Epoch: 0|  Loss:  0.9992 |Global loss: 4.9247| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.7252
Epoch: 1|  Loss:  0.9369 |Global loss: 4.5048| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.6885
Epoch: 2|  Loss:  0.8576 |Global loss: 4.3633| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.693
Epoch: 3|  Loss:  0.8741 |Global loss: 4.327| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.9036
Epoch: 0|  Loss:  1.1773 |Global loss: 5.1461| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 0.6869
Epoch: 1|  Loss:  0.8765 |Global loss: 4.3212| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.663
Epoch: 2|  Loss:  0.8784 |Global loss: 4.2324| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.664
Epoch: 3|  Loss:  0.8578 |Global loss: 4.1516| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.9056
Epoch: 0|  Loss:  1.1985 |Global loss: 4.9144| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.74
Epoch: 1|  Loss:  1.0005 |Global loss: 4.1517| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 2|  NKD Loss: 0.7392
Epoch: 2|  Loss:  0.9761 |Global loss: 4.1798| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.7571
Epoch: 3|  Loss:  1.039 |Global loss: 4.1309| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.9039
Epoch: 0|  Loss:  1.1616 |Global loss: 4.8773| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.8018
Epoch: 1|  Loss:  1.0658 |Global loss: 4.2687| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.8011
Epoch: 2|  Loss:  1.1652 |Global loss: 4.2726| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.7362
Epoch: 3|  Loss:  1.0101 |Global loss: 4.1365| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.8315
Epoch: 0|  Loss:  1.059 |Global loss: 5.104| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.7817
Epoch: 1|  Loss:  0.9786 |Global loss: 4.4085| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.7076
Epoch: 2|  Loss:  0.8921 |Global loss: 4.2463| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.6969
Epoch: 3|  Loss:  0.9079 |Global loss: 4.3106| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 0|  NKD Loss: 0.8653
Epoch: 0|  Loss:  1.0916 |Global loss: 5.0283| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.7308
Epoch: 1|  Loss:  0.98 |Global loss: 4.4933| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 2|  NKD Loss: 0.8269
Epoch: 2|  Loss:  1.0872 |Global loss: 4.513| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 3|  NKD Loss: 0.7884
Epoch: 3|  Loss:  1.0557 |Global loss: 4.5654| Local H loss: 0.0431  | Global H loss: 0.0431
------------------------- time cost ------------------------- 4.843154668807983
Chosen Clients:  [10, 14, 8, 4, 2, 12]

-------------Round number: 97-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.742, 0.983, 0.9, 0.983, 0.975, 0.992, 0.975, 0.983, 0.975, 0.975, 0.967, 0.792, 0.975]
AUC in each clients:  [118.742, 119.285, 117.122, 119.311, 118.731, 118.431, 119.213, 119.284, 119.184, 119.574, 118.903, 119.579, 118.922, 116.048, 118.957]
F1 Score:  [0.983, 0.982, 0.725, 0.983, 0.883, 0.982, 0.974, 0.992, 0.974, 0.981, 0.973, 0.973, 0.965, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.756, 0.986, 0.89, 0.984, 0.977, 0.993, 0.977, 0.984, 0.977, 0.977, 0.971, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1993
Averaged Test Accurancy: 0.9456
Averaged Test AUC: 0.9896
Averaged Test F1_score: 0.9401
Averaged Test Recal score: 0.9481
Std Test Accurancy: 0.0737
Std Test AUC: 0.0077
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.238 |Global loss: 5.4914| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.7442
Epoch: 1|  Loss:  0.9449 |Global loss: 4.5749| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 2|  NKD Loss: 0.7413
Epoch: 2|  Loss:  0.9777 |Global loss: 4.4157| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.6975
Epoch: 3|  Loss:  0.9105 |Global loss: 4.2706| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.8297
Epoch: 0|  Loss:  1.02 |Global loss: 5.0632| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.7009
Epoch: 1|  Loss:  0.8866 |Global loss: 4.3064| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.7103
Epoch: 2|  Loss:  0.9063 |Global loss: 4.2628| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 3|  NKD Loss: 0.7568
Epoch: 3|  Loss:  0.9914 |Global loss: 4.3248| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.8514
Epoch: 0|  Loss:  1.0906 |Global loss: 4.7359| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.8012
Epoch: 1|  Loss:  1.1152 |Global loss: 4.2137| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.7359
Epoch: 2|  Loss:  1.0018 |Global loss: 4.0792| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.7664
Epoch: 3|  Loss:  1.0385 |Global loss: 4.0886| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.8062
Epoch: 0|  Loss:  1.1267 |Global loss: 5.1081| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 0.7974
Epoch: 1|  Loss:  1.1124 |Global loss: 4.3863| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 0.7044
Epoch: 2|  Loss:  1.0194 |Global loss: 4.2494| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 3|  NKD Loss: 0.7316
Epoch: 3|  Loss:  1.018 |Global loss: 4.2041| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 0.9667
Epoch: 0|  Loss:  1.6682 |Global loss: 5.2167| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.8742
Epoch: 1|  Loss:  1.6112 |Global loss: 4.6659| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.8653
Epoch: 2|  Loss:  1.5541 |Global loss: 4.5028| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.884
Epoch: 3|  Loss:  1.6502 |Global loss: 4.4938| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.8213
Epoch: 0|  Loss:  1.067 |Global loss: 4.9489| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.7894
Epoch: 1|  Loss:  1.0585 |Global loss: 4.2127| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.7862
Epoch: 2|  Loss:  1.0895 |Global loss: 4.2384| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.749
Epoch: 3|  Loss:  1.0141 |Global loss: 4.0804| Local H loss: 0.04  | Global H loss: 0.04
------------------------- time cost ------------------------- 4.8352203369140625
Chosen Clients:  [14, 8, 7, 11, 6, 0]

-------------Round number: 98-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.7, 0.983, 0.917, 0.983, 0.975, 0.992, 0.975, 0.983, 0.975, 0.975, 0.917, 0.792, 0.975]
AUC in each clients:  [118.742, 119.285, 116.23, 119.311, 118.967, 118.431, 119.213, 119.284, 119.248, 119.574, 119.196, 119.579, 118.624, 116.048, 119.145]
F1 Score:  [0.983, 0.982, 0.679, 0.983, 0.904, 0.982, 0.974, 0.992, 0.973, 0.981, 0.973, 0.973, 0.907, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.734, 0.986, 0.91, 0.984, 0.977, 0.993, 0.977, 0.984, 0.977, 0.977, 0.928, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2942
Averaged Test Accurancy: 0.9406
Averaged Test AUC: 0.9894
Averaged Test F1_score: 0.9345
Averaged Test Recal score: 0.9451
Std Test Accurancy: 0.0812
Std Test AUC: 0.0088
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.7807
Epoch: 0|  Loss:  0.95 |Global loss: 5.0324| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 0.7091
Epoch: 1|  Loss:  0.9236 |Global loss: 4.3048| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.7273
Epoch: 2|  Loss:  0.9472 |Global loss: 4.2769| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.6905
Epoch: 3|  Loss:  0.8816 |Global loss: 4.1884| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 0|  NKD Loss: 0.8671
Epoch: 0|  Loss:  1.0832 |Global loss: 4.8311| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.729
Epoch: 1|  Loss:  0.9289 |Global loss: 4.0118| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 2|  NKD Loss: 0.7835
Epoch: 2|  Loss:  1.0725 |Global loss: 4.1757| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.6826
Epoch: 3|  Loss:  0.892 |Global loss: 3.8837| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 0.9578
Epoch: 0|  Loss:  1.2291 |Global loss: 5.4383| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 1|  NKD Loss: 0.7743
Epoch: 1|  Loss:  0.9542 |Global loss: 4.4621| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.7489
Epoch: 2|  Loss:  0.9368 |Global loss: 4.3761| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.7844
Epoch: 3|  Loss:  1.1339 |Global loss: 4.2945| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.8765
Epoch: 0|  Loss:  1.0719 |Global loss: 5.1641| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 1|  NKD Loss: 0.79
Epoch: 1|  Loss:  0.9835 |Global loss: 4.912| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 2|  NKD Loss: 0.7392
Epoch: 2|  Loss:  0.9439 |Global loss: 4.527| Local H loss: 0.0499  | Global H loss: 0.0499
Epoch: 3|  NKD Loss: 0.7244
Epoch: 3|  Loss:  0.9302 |Global loss: 4.3784| Local H loss: 0.0513  | Global H loss: 0.0513
Epoch: 0|  NKD Loss: 0.8436
Epoch: 0|  Loss:  1.0851 |Global loss: 5.175| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.7236
Epoch: 1|  Loss:  0.9642 |Global loss: 4.4388| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 2|  NKD Loss: 0.7398
Epoch: 2|  Loss:  0.9793 |Global loss: 4.3803| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 3|  NKD Loss: 0.687
Epoch: 3|  Loss:  0.895 |Global loss: 4.2518| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 0|  NKD Loss: 0.8146
Epoch: 0|  Loss:  1.105 |Global loss: 4.949| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.6522
Epoch: 1|  Loss:  0.9228 |Global loss: 4.2742| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.648
Epoch: 2|  Loss:  0.9188 |Global loss: 4.1561| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.6461
Epoch: 3|  Loss:  0.9297 |Global loss: 4.0782| Local H loss: 0.043  | Global H loss: 0.043
------------------------- time cost ------------------------- 4.8193066120147705
Chosen Clients:  [10, 1, 2, 14, 4, 7]

-------------Round number: 99-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.7, 0.983, 0.917, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.917, 0.792, 0.975]
AUC in each clients:  [118.686, 119.285, 116.23, 119.311, 118.967, 118.431, 119.155, 119.049, 119.1, 119.574, 119.196, 119.635, 118.624, 116.048, 119.048]
F1 Score:  [0.983, 0.982, 0.679, 0.983, 0.904, 0.982, 0.974, 0.973, 0.974, 0.981, 0.973, 0.973, 0.907, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.734, 0.986, 0.91, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.928, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3342
Averaged Test Accurancy: 0.9394
Averaged Test AUC: 0.9891
Averaged Test F1_score: 0.9333
Averaged Test Recal score: 0.9441
Std Test Accurancy: 0.0806
Std Test AUC: 0.0087
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9017
Epoch: 0|  Loss:  1.0841 |Global loss: 5.3569| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 1|  NKD Loss: 0.7222
Epoch: 1|  Loss:  0.9152 |Global loss: 4.4486| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 0.7402
Epoch: 2|  Loss:  1.0693 |Global loss: 4.4787| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.7213
Epoch: 3|  Loss:  0.9542 |Global loss: 4.2892| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.8848
Epoch: 0|  Loss:  1.1041 |Global loss: 5.198| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.7039
Epoch: 1|  Loss:  0.8812 |Global loss: 4.5556| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.7914
Epoch: 2|  Loss:  0.9841 |Global loss: 4.52| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.7501
Epoch: 3|  Loss:  0.9487 |Global loss: 4.4417| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 1.1009
Epoch: 0|  Loss:  1.9144 |Global loss: 5.5618| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.9248
Epoch: 1|  Loss:  1.6977 |Global loss: 4.8092| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.8972
Epoch: 2|  Loss:  1.6618 |Global loss: 4.4844| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.8664
Epoch: 3|  Loss:  1.5513 |Global loss: 4.3557| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.8744
Epoch: 0|  Loss:  1.0659 |Global loss: 5.1218| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.7335
Epoch: 1|  Loss:  0.9242 |Global loss: 4.3423| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.6916
Epoch: 2|  Loss:  0.8756 |Global loss: 4.1971| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.7204
Epoch: 3|  Loss:  0.9141 |Global loss: 4.1701| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.898
Epoch: 0|  Loss:  1.2518 |Global loss: 5.0107| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 0.7284
Epoch: 1|  Loss:  1.0407 |Global loss: 4.3267| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.7094
Epoch: 2|  Loss:  1.0414 |Global loss: 4.2308| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.7639
Epoch: 3|  Loss:  1.1134 |Global loss: 4.3027| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.8734
Epoch: 0|  Loss:  1.067 |Global loss: 5.115| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.7481
Epoch: 1|  Loss:  0.9609 |Global loss: 4.3898| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.7
Epoch: 2|  Loss:  0.8949 |Global loss: 4.1671| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 3|  NKD Loss: 0.7342
Epoch: 3|  Loss:  0.9504 |Global loss: 4.159| Local H loss: 0.0399  | Global H loss: 0.0399
------------------------- time cost ------------------------- 4.860745191574097
Chosen Clients:  [11, 3, 12, 0, 8, 2]

-------------Round number: 100-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.817, 0.983, 0.942, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.917, 0.792, 0.975]
AUC in each clients:  [118.686, 119.35, 117.017, 119.311, 118.896, 118.431, 119.155, 119.245, 119.1, 119.574, 119.168, 119.635, 118.624, 116.048, 119.374]
F1 Score:  [0.983, 0.982, 0.815, 0.983, 0.935, 0.982, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.907, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.841, 0.986, 0.938, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.928, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1959
Averaged Test Accurancy: 0.9494
Averaged Test AUC: 0.9898
Averaged Test F1_score: 0.9449
Averaged Test Recal score: 0.9535
Std Test Accurancy: 0.0599
Std Test AUC: 0.0080
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8705
Epoch: 0|  Loss:  1.0656 |Global loss: 5.2075| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 1|  NKD Loss: 0.78
Epoch: 1|  Loss:  0.9734 |Global loss: 4.5181| Local H loss: 0.0498  | Global H loss: 0.0498
Epoch: 2|  NKD Loss: 0.7338
Epoch: 2|  Loss:  0.9158 |Global loss: 4.4453| Local H loss: 0.05  | Global H loss: 0.05
Epoch: 3|  NKD Loss: 0.6902
Epoch: 3|  Loss:  0.8868 |Global loss: 4.3233| Local H loss: 0.0508  | Global H loss: 0.0508
Epoch: 0|  NKD Loss: 0.8733
Epoch: 0|  Loss:  1.0426 |Global loss: 5.2416| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.6728
Epoch: 1|  Loss:  0.8614 |Global loss: 4.1833| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.6946
Epoch: 2|  Loss:  0.9076 |Global loss: 4.1722| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.6386
Epoch: 3|  Loss:  0.8296 |Global loss: 3.9339| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.8946
Epoch: 0|  Loss:  1.1972 |Global loss: 4.8654| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.7916
Epoch: 1|  Loss:  1.0739 |Global loss: 4.2197| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.784
Epoch: 2|  Loss:  1.1051 |Global loss: 4.2589| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.8002
Epoch: 3|  Loss:  1.1063 |Global loss: 4.1519| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.8011
Epoch: 0|  Loss:  1.0722 |Global loss: 5.1005| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.6858
Epoch: 1|  Loss:  0.944 |Global loss: 4.2796| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.6321
Epoch: 2|  Loss:  0.8797 |Global loss: 4.1639| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.6329
Epoch: 3|  Loss:  0.8654 |Global loss: 4.0779| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.8518
Epoch: 0|  Loss:  1.0381 |Global loss: 4.8258| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.7674
Epoch: 1|  Loss:  1.008 |Global loss: 4.1757| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.7392
Epoch: 2|  Loss:  0.9699 |Global loss: 4.1751| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.727
Epoch: 3|  Loss:  0.9939 |Global loss: 4.0247| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 1.0425
Epoch: 0|  Loss:  1.6889 |Global loss: 5.2463| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.8916
Epoch: 1|  Loss:  1.5336 |Global loss: 4.5016| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8181
Epoch: 2|  Loss:  1.4089 |Global loss: 4.3856| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.8264
Epoch: 3|  Loss:  1.4758 |Global loss: 4.2778| Local H loss: 0.0419  | Global H loss: 0.0419
------------------------- time cost ------------------------- 4.932149648666382
Chosen Clients:  [5, 8, 2, 9, 12, 13]

-------------Round number: 101-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.875, 0.975, 0.942, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.792, 0.975]
AUC in each clients:  [118.623, 119.35, 117.506, 119.261, 118.896, 118.431, 119.155, 119.245, 119.293, 119.574, 119.168, 119.614, 118.804, 116.048, 119.374]
F1 Score:  [0.983, 0.982, 0.854, 0.973, 0.935, 0.982, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.975, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.884, 0.977, 0.938, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3724
Averaged Test Accurancy: 0.9567
Averaged Test AUC: 0.9902
Averaged Test F1_score: 0.9514
Averaged Test Recal score: 0.9593
Std Test Accurancy: 0.0517
Std Test AUC: 0.0075
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9733
Epoch: 0|  Loss:  1.2501 |Global loss: 5.5732| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 0.8516
Epoch: 1|  Loss:  1.153 |Global loss: 4.8308| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.7642
Epoch: 2|  Loss:  1.0277 |Global loss: 4.5726| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.789
Epoch: 3|  Loss:  1.054 |Global loss: 4.5104| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9133
Epoch: 0|  Loss:  1.106 |Global loss: 4.7949| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.7365
Epoch: 1|  Loss:  0.9837 |Global loss: 4.0686| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.8131
Epoch: 2|  Loss:  1.1174 |Global loss: 4.2605| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.7439
Epoch: 3|  Loss:  1.0031 |Global loss: 4.109| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 1.0724
Epoch: 0|  Loss:  1.7409 |Global loss: 5.267| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.8541
Epoch: 1|  Loss:  1.365 |Global loss: 4.3887| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.8572
Epoch: 2|  Loss:  1.4699 |Global loss: 4.3861| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.8175
Epoch: 3|  Loss:  1.4306 |Global loss: 4.2318| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.8933
Epoch: 0|  Loss:  1.0816 |Global loss: 5.2519| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.7008
Epoch: 1|  Loss:  0.8683 |Global loss: 4.437| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.6968
Epoch: 2|  Loss:  0.8622 |Global loss: 4.4307| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.6846
Epoch: 3|  Loss:  0.8522 |Global loss: 4.3386| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9079
Epoch: 0|  Loss:  1.1577 |Global loss: 4.9869| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 1|  NKD Loss: 0.7188
Epoch: 1|  Loss:  0.9678 |Global loss: 4.045| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 2|  NKD Loss: 0.8188
Epoch: 2|  Loss:  1.1108 |Global loss: 4.174| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.8261
Epoch: 3|  Loss:  1.2726 |Global loss: 4.1751| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9707
Epoch: 0|  Loss:  1.5145 |Global loss: 5.413| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 0.8573
Epoch: 1|  Loss:  1.4187 |Global loss: 4.4451| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 2|  NKD Loss: 0.8975
Epoch: 2|  Loss:  1.4418 |Global loss: 4.5334| Local H loss: 0.045  | Global H loss: 0.045
Epoch: 3|  NKD Loss: 0.8158
Epoch: 3|  Loss:  1.3315 |Global loss: 4.3581| Local H loss: 0.0464  | Global H loss: 0.0464
------------------------- time cost ------------------------- 4.892440557479858
Chosen Clients:  [10, 4, 8, 6, 11, 0]

-------------Round number: 102-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.775, 0.975, 0.942, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.933, 0.792, 0.975]
AUC in each clients:  [118.623, 119.35, 116.916, 119.261, 118.896, 118.352, 119.155, 119.245, 119.148, 119.54, 119.168, 119.614, 118.416, 115.939, 119.374]
F1 Score:  [0.983, 0.982, 0.768, 0.973, 0.935, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.938, 0.758, 0.973]
Recall Score:  [0.986, 0.984, 0.817, 0.977, 0.938, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2664
Averaged Test Accurancy: 0.9478
Averaged Test AUC: 0.9894
Averaged Test F1_score: 0.9439
Averaged Test Recal score: 0.9533
Std Test Accurancy: 0.0663
Std Test AUC: 0.0082
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8646
Epoch: 0|  Loss:  1.0572 |Global loss: 5.3968| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.7178
Epoch: 1|  Loss:  0.9097 |Global loss: 4.4538| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.6775
Epoch: 2|  Loss:  0.863 |Global loss: 4.2441| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.6984
Epoch: 3|  Loss:  0.8763 |Global loss: 4.2228| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 0.8962
Epoch: 0|  Loss:  1.2341 |Global loss: 5.3872| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.7035
Epoch: 1|  Loss:  1.0418 |Global loss: 4.2664| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.7257
Epoch: 2|  Loss:  1.0529 |Global loss: 4.329| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.7175
Epoch: 3|  Loss:  0.9921 |Global loss: 4.1177| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9153
Epoch: 0|  Loss:  1.194 |Global loss: 4.6124| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.7752
Epoch: 1|  Loss:  1.0677 |Global loss: 4.1266| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.7317
Epoch: 2|  Loss:  0.9537 |Global loss: 3.9821| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.7057
Epoch: 3|  Loss:  0.9362 |Global loss: 3.8892| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.9208
Epoch: 0|  Loss:  1.1684 |Global loss: 5.1151| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.7269
Epoch: 1|  Loss:  0.9393 |Global loss: 4.4368| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 2|  NKD Loss: 0.699
Epoch: 2|  Loss:  0.9212 |Global loss: 4.2148| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 3|  NKD Loss: 0.6736
Epoch: 3|  Loss:  0.878 |Global loss: 4.3136| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 0|  NKD Loss: 0.9261
Epoch: 0|  Loss:  1.1292 |Global loss: 5.2279| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 1|  NKD Loss: 0.7802
Epoch: 1|  Loss:  0.9701 |Global loss: 4.6533| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 2|  NKD Loss: 0.7696
Epoch: 2|  Loss:  0.9541 |Global loss: 4.5219| Local H loss: 0.048  | Global H loss: 0.048
Epoch: 3|  NKD Loss: 0.706
Epoch: 3|  Loss:  0.9001 |Global loss: 4.2142| Local H loss: 0.0515  | Global H loss: 0.0515
Epoch: 0|  NKD Loss: 0.8854
Epoch: 0|  Loss:  1.1495 |Global loss: 5.393| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.6731
Epoch: 1|  Loss:  0.9471 |Global loss: 4.2669| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.6458
Epoch: 2|  Loss:  0.9085 |Global loss: 4.1528| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.6116
Epoch: 3|  Loss:  0.8598 |Global loss: 4.0446| Local H loss: 0.0422  | Global H loss: 0.0422
------------------------- time cost ------------------------- 5.016287803649902
Chosen Clients:  [9, 7, 1, 12, 11, 4]

-------------Round number: 103-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.983, 0.775, 0.975, 0.925, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.933, 0.792, 0.975]
AUC in each clients:  [117.967, 119.35, 116.916, 119.261, 118.598, 118.352, 119.272, 119.245, 119.122, 119.54, 119.267, 119.596, 118.416, 115.939, 119.374]
F1 Score:  [0.913, 0.982, 0.768, 0.973, 0.909, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.938, 0.758, 0.973]
Recall Score:  [0.931, 0.984, 0.817, 0.977, 0.921, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0761
Averaged Test Accurancy: 0.9411
Averaged Test AUC: 0.9890
Averaged Test F1_score: 0.9375
Averaged Test Recal score: 0.9485
Std Test Accurancy: 0.0667
Std Test AUC: 0.0084
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.815
Epoch: 0|  Loss:  0.9776 |Global loss: 5.1807| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.6852
Epoch: 1|  Loss:  0.8515 |Global loss: 4.42| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.7201
Epoch: 2|  Loss:  0.897 |Global loss: 4.5298| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.6846
Epoch: 3|  Loss:  0.8608 |Global loss: 4.3173| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.8622
Epoch: 0|  Loss:  1.0646 |Global loss: 4.9978| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.7016
Epoch: 1|  Loss:  0.8791 |Global loss: 4.2451| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.68
Epoch: 2|  Loss:  0.867 |Global loss: 4.0689| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.6566
Epoch: 3|  Loss:  0.8558 |Global loss: 4.0005| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.8546
Epoch: 0|  Loss:  1.056 |Global loss: 5.372| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.7499
Epoch: 1|  Loss:  0.9605 |Global loss: 4.7056| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.806
Epoch: 2|  Loss:  1.0519 |Global loss: 4.6391| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 3|  NKD Loss: 0.7542
Epoch: 3|  Loss:  0.9622 |Global loss: 4.6038| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.8815
Epoch: 0|  Loss:  1.1218 |Global loss: 4.7486| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.7508
Epoch: 1|  Loss:  1.0521 |Global loss: 4.1007| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.7129
Epoch: 2|  Loss:  0.9658 |Global loss: 3.9382| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.8019
Epoch: 3|  Loss:  1.0862 |Global loss: 4.0258| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.8321
Epoch: 0|  Loss:  1.0052 |Global loss: 5.1834| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 1|  NKD Loss: 0.731
Epoch: 1|  Loss:  0.9163 |Global loss: 4.3584| Local H loss: 0.049  | Global H loss: 0.049
Epoch: 2|  NKD Loss: 0.67
Epoch: 2|  Loss:  0.8595 |Global loss: 4.2405| Local H loss: 0.0498  | Global H loss: 0.0498
Epoch: 3|  NKD Loss: 0.6662
Epoch: 3|  Loss:  0.8434 |Global loss: 4.2107| Local H loss: 0.05  | Global H loss: 0.05
Epoch: 0|  NKD Loss: 0.8612
Epoch: 0|  Loss:  1.1961 |Global loss: 5.2633| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 0.7033
Epoch: 1|  Loss:  0.9937 |Global loss: 4.2209| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.7252
Epoch: 2|  Loss:  1.0285 |Global loss: 4.0665| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.7937
Epoch: 3|  Loss:  1.1316 |Global loss: 4.3231| Local H loss: 0.0368  | Global H loss: 0.0368
------------------------- time cost ------------------------- 4.770431041717529
Chosen Clients:  [5, 4, 2, 13, 11, 1]

-------------Round number: 104-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.983, 0.775, 0.975, 0.908, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.933, 0.792, 0.975]
AUC in each clients:  [117.967, 119.296, 116.916, 119.261, 118.164, 118.352, 119.272, 119.287, 119.122, 119.425, 119.267, 119.646, 118.772, 115.939, 119.374]
F1 Score:  [0.913, 0.982, 0.768, 0.973, 0.861, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.938, 0.758, 0.973]
Recall Score:  [0.931, 0.984, 0.817, 0.977, 0.894, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.803, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0893
Averaged Test Accurancy: 0.9400
Averaged Test AUC: 0.9889
Averaged Test F1_score: 0.9343
Averaged Test Recal score: 0.9467
Std Test Accurancy: 0.0671
Std Test AUC: 0.0085
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.849
Epoch: 0|  Loss:  1.0706 |Global loss: 5.3937| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.7991
Epoch: 1|  Loss:  1.0599 |Global loss: 4.7064| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.7632
Epoch: 2|  Loss:  1.0211 |Global loss: 4.4835| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.7727
Epoch: 3|  Loss:  1.0504 |Global loss: 4.4629| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.842
Epoch: 0|  Loss:  1.1927 |Global loss: 4.9243| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.6774
Epoch: 1|  Loss:  0.9578 |Global loss: 4.2652| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.7847
Epoch: 2|  Loss:  1.1254 |Global loss: 4.3198| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.7095
Epoch: 3|  Loss:  1.0316 |Global loss: 4.1521| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.933
Epoch: 0|  Loss:  1.5074 |Global loss: 5.3033| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9339
Epoch: 1|  Loss:  1.6875 |Global loss: 4.6117| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.7984
Epoch: 2|  Loss:  1.3413 |Global loss: 4.2413| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.8113
Epoch: 3|  Loss:  1.4727 |Global loss: 4.2791| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9693
Epoch: 0|  Loss:  1.5051 |Global loss: 5.4828| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.8917
Epoch: 1|  Loss:  1.4173 |Global loss: 4.4156| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 2|  NKD Loss: 0.8984
Epoch: 2|  Loss:  1.4121 |Global loss: 4.5144| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 3|  NKD Loss: 0.847
Epoch: 3|  Loss:  1.3522 |Global loss: 4.3938| Local H loss: 0.0444  | Global H loss: 0.0444
Epoch: 0|  NKD Loss: 0.8409
Epoch: 0|  Loss:  1.0098 |Global loss: 5.3431| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 1|  NKD Loss: 0.7599
Epoch: 1|  Loss:  0.9347 |Global loss: 4.4985| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 2|  NKD Loss: 0.6969
Epoch: 2|  Loss:  0.8823 |Global loss: 4.2445| Local H loss: 0.0488  | Global H loss: 0.0488
Epoch: 3|  NKD Loss: 0.7296
Epoch: 3|  Loss:  0.9262 |Global loss: 4.248| Local H loss: 0.0487  | Global H loss: 0.0487
Epoch: 0|  NKD Loss: 0.8337
Epoch: 0|  Loss:  0.9935 |Global loss: 5.2102| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.7427
Epoch: 1|  Loss:  0.9179 |Global loss: 4.5659| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.7151
Epoch: 2|  Loss:  0.9225 |Global loss: 4.5093| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.7102
Epoch: 3|  Loss:  0.89 |Global loss: 4.4258| Local H loss: 0.0408  | Global H loss: 0.0408
------------------------- time cost ------------------------- 4.896604537963867
Chosen Clients:  [14, 4, 12, 10, 5, 1]

-------------Round number: 105-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.942, 0.9, 0.975, 0.908, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.933, 0.825, 0.975]
AUC in each clients:  [117.967, 119.011, 117.598, 119.261, 118.496, 118.495, 119.272, 119.287, 119.122, 119.425, 119.267, 119.687, 118.772, 116.271, 119.374]
F1 Score:  [0.913, 0.921, 0.869, 0.973, 0.897, 0.982, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.938, 0.829, 0.973]
Recall Score:  [0.931, 0.927, 0.9, 0.977, 0.899, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.859, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0348
Averaged Test Accurancy: 0.9472
Averaged Test AUC: 0.9896
Averaged Test F1_score: 0.9434
Averaged Test Recal score: 0.9519
Std Test Accurancy: 0.0445
Std Test AUC: 0.0072
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.7605
Epoch: 0|  Loss:  0.9414 |Global loss: 5.0366| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.7074
Epoch: 1|  Loss:  0.9014 |Global loss: 4.3134| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.7069
Epoch: 2|  Loss:  0.9073 |Global loss: 4.2226| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.6991
Epoch: 3|  Loss:  0.8978 |Global loss: 4.1629| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.7657
Epoch: 0|  Loss:  1.0688 |Global loss: 4.8863| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.743
Epoch: 1|  Loss:  1.0292 |Global loss: 4.1395| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.7239
Epoch: 2|  Loss:  1.0365 |Global loss: 4.1088| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.6828
Epoch: 3|  Loss:  0.9482 |Global loss: 3.9966| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9021
Epoch: 0|  Loss:  1.1993 |Global loss: 4.9941| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 0.7741
Epoch: 1|  Loss:  1.0441 |Global loss: 4.004| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.7432
Epoch: 2|  Loss:  0.9989 |Global loss: 3.9697| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.7862
Epoch: 3|  Loss:  1.0903 |Global loss: 4.0262| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.81
Epoch: 0|  Loss:  0.9989 |Global loss: 5.3298| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.7366
Epoch: 1|  Loss:  0.9601 |Global loss: 4.5839| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.6678
Epoch: 2|  Loss:  0.8505 |Global loss: 4.304| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.6851
Epoch: 3|  Loss:  0.8783 |Global loss: 4.1784| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.8775
Epoch: 0|  Loss:  1.1184 |Global loss: 5.3158| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.7019
Epoch: 1|  Loss:  0.9194 |Global loss: 4.3951| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.8065
Epoch: 2|  Loss:  1.0485 |Global loss: 4.6339| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.7547
Epoch: 3|  Loss:  1.008 |Global loss: 4.3289| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 0|  NKD Loss: 0.7901
Epoch: 0|  Loss:  0.9734 |Global loss: 5.3017| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.7117
Epoch: 1|  Loss:  0.8833 |Global loss: 4.5222| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 0.687
Epoch: 2|  Loss:  0.856 |Global loss: 4.4862| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.7346
Epoch: 3|  Loss:  0.9234 |Global loss: 4.4988| Local H loss: 0.0392  | Global H loss: 0.0392
------------------------- time cost ------------------------- 4.77066445350647
Chosen Clients:  [7, 2, 11, 14, 8, 0]

-------------Round number: 106-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.983, 0.9, 0.975, 0.95, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.825, 0.975]
AUC in each clients:  [117.967, 119.333, 117.598, 119.261, 118.536, 118.326, 119.272, 119.287, 119.122, 119.425, 119.253, 119.687, 118.929, 116.271, 119.116]
F1 Score:  [0.913, 0.982, 0.869, 0.973, 0.941, 0.973, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.975, 0.829, 0.973]
Recall Score:  [0.931, 0.984, 0.9, 0.977, 0.946, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.859, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0293
Averaged Test Accurancy: 0.9550
Averaged Test AUC: 0.9897
Averaged Test F1_score: 0.9523
Averaged Test Recal score: 0.9605
Std Test Accurancy: 0.0437
Std Test AUC: 0.0073
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.7655
Epoch: 0|  Loss:  0.9301 |Global loss: 5.3076| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.714
Epoch: 1|  Loss:  0.8849 |Global loss: 4.6935| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.7035
Epoch: 2|  Loss:  0.888 |Global loss: 4.4801| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.687
Epoch: 3|  Loss:  0.8652 |Global loss: 4.3093| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9241
Epoch: 0|  Loss:  1.4459 |Global loss: 5.367| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.8686
Epoch: 1|  Loss:  1.5629 |Global loss: 4.622| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.8228
Epoch: 2|  Loss:  1.3408 |Global loss: 4.3043| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 3|  NKD Loss: 0.7972
Epoch: 3|  Loss:  1.2914 |Global loss: 4.2184| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8809
Epoch: 0|  Loss:  1.0441 |Global loss: 5.5101| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.7253
Epoch: 1|  Loss:  0.9001 |Global loss: 4.3539| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 2|  NKD Loss: 0.7027
Epoch: 2|  Loss:  0.8905 |Global loss: 4.3272| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 3|  NKD Loss: 0.7586
Epoch: 3|  Loss:  0.9669 |Global loss: 4.4008| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 0|  NKD Loss: 0.8394
Epoch: 0|  Loss:  1.0367 |Global loss: 5.0266| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.6916
Epoch: 1|  Loss:  0.8854 |Global loss: 4.2847| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.7277
Epoch: 2|  Loss:  0.9106 |Global loss: 4.2462| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.7108
Epoch: 3|  Loss:  0.896 |Global loss: 4.2161| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 0|  NKD Loss: 0.867
Epoch: 0|  Loss:  1.11 |Global loss: 4.7766| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.7605
Epoch: 1|  Loss:  1.0658 |Global loss: 4.1049| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.6589
Epoch: 2|  Loss:  0.8575 |Global loss: 3.8688| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.7041
Epoch: 3|  Loss:  0.8842 |Global loss: 3.8036| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.8217
Epoch: 0|  Loss:  1.0924 |Global loss: 5.2619| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.6225
Epoch: 1|  Loss:  0.8862 |Global loss: 4.2323| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.5895
Epoch: 2|  Loss:  0.8245 |Global loss: 4.0403| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.6217
Epoch: 3|  Loss:  0.8865 |Global loss: 4.0416| Local H loss: 0.0411  | Global H loss: 0.0411
------------------------- time cost ------------------------- 4.9114274978637695
Chosen Clients:  [10, 8, 12, 13, 11, 7]

-------------Round number: 107-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.85, 0.975, 0.95, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.825, 0.975]
AUC in each clients:  [118.626, 119.333, 117.452, 119.261, 118.536, 118.326, 119.272, 119.223, 119.089, 119.425, 119.253, 119.615, 118.929, 116.271, 119.265]
F1 Score:  [0.956, 0.982, 0.839, 0.973, 0.941, 0.973, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.975, 0.829, 0.973]
Recall Score:  [0.964, 0.984, 0.867, 0.977, 0.946, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.859, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2666
Averaged Test Accurancy: 0.9550
Averaged Test AUC: 0.9899
Averaged Test F1_score: 0.9531
Averaged Test Recal score: 0.9605
Std Test Accurancy: 0.0473
Std Test AUC: 0.0071
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.9783
Epoch: 0|  Loss:  1.1396 |Global loss: 5.6735| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.8008
Epoch: 1|  Loss:  1.0375 |Global loss: 4.6799| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.7121
Epoch: 2|  Loss:  0.8907 |Global loss: 4.4032| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.6836
Epoch: 3|  Loss:  0.8739 |Global loss: 4.2082| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 0.8559
Epoch: 0|  Loss:  1.0311 |Global loss: 4.7775| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 0.6631
Epoch: 1|  Loss:  0.8584 |Global loss: 3.8382| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.6875
Epoch: 2|  Loss:  0.8816 |Global loss: 3.8406| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.6711
Epoch: 3|  Loss:  0.8981 |Global loss: 3.8915| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.9054
Epoch: 0|  Loss:  1.1644 |Global loss: 4.9118| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.7684
Epoch: 1|  Loss:  0.9929 |Global loss: 4.1901| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.8076
Epoch: 2|  Loss:  1.0445 |Global loss: 4.0534| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.8906
Epoch: 3|  Loss:  1.2833 |Global loss: 4.2957| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 1.0274
Epoch: 0|  Loss:  1.5433 |Global loss: 5.2376| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.8379
Epoch: 1|  Loss:  1.3226 |Global loss: 4.5036| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.8651
Epoch: 2|  Loss:  1.3888 |Global loss: 4.5571| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.8935
Epoch: 3|  Loss:  1.4066 |Global loss: 4.2149| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.8609
Epoch: 0|  Loss:  1.0336 |Global loss: 5.1026| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.7715
Epoch: 1|  Loss:  0.961 |Global loss: 4.5463| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 2|  NKD Loss: 0.7309
Epoch: 2|  Loss:  0.9146 |Global loss: 4.2238| Local H loss: 0.0472  | Global H loss: 0.0472
Epoch: 3|  NKD Loss: 0.6963
Epoch: 3|  Loss:  0.8749 |Global loss: 4.2276| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 0|  NKD Loss: 0.8356
Epoch: 0|  Loss:  1.0384 |Global loss: 5.1194| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.692
Epoch: 1|  Loss:  0.8791 |Global loss: 4.1551| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.6663
Epoch: 2|  Loss:  0.8596 |Global loss: 4.023| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.7134
Epoch: 3|  Loss:  0.977 |Global loss: 4.1004| Local H loss: 0.0374  | Global H loss: 0.0374
------------------------- time cost ------------------------- 4.858746290206909
Chosen Clients:  [7, 12, 10, 14, 5, 6]

-------------Round number: 108-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.85, 0.975, 0.95, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.817, 0.975]
AUC in each clients:  [118.626, 119.333, 117.452, 119.261, 118.536, 118.326, 119.272, 119.183, 119.02, 119.425, 119.244, 119.642, 119.145, 116.476, 119.265]
F1 Score:  [0.956, 0.982, 0.839, 0.973, 0.941, 0.973, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.983, 0.803, 0.973]
Recall Score:  [0.964, 0.984, 0.867, 0.977, 0.946, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2814
Averaged Test Accurancy: 0.9550
Averaged Test AUC: 0.9901
Averaged Test F1_score: 0.9519
Averaged Test Recal score: 0.9595
Std Test Accurancy: 0.0491
Std Test AUC: 0.0068
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8216
Epoch: 0|  Loss:  1.0335 |Global loss: 5.4033| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.7515
Epoch: 1|  Loss:  0.9275 |Global loss: 4.5654| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.7084
Epoch: 2|  Loss:  0.9004 |Global loss: 4.375| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.7548
Epoch: 3|  Loss:  0.9411 |Global loss: 4.3549| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9171
Epoch: 0|  Loss:  1.1559 |Global loss: 4.7605| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.8047
Epoch: 1|  Loss:  1.1009 |Global loss: 4.1381| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.7763
Epoch: 2|  Loss:  1.0215 |Global loss: 3.9228| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.814
Epoch: 3|  Loss:  1.1604 |Global loss: 3.9775| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9544
Epoch: 0|  Loss:  1.1288 |Global loss: 5.5566| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.7337
Epoch: 1|  Loss:  0.8952 |Global loss: 4.6836| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.7695
Epoch: 2|  Loss:  0.9434 |Global loss: 4.5141| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.7741
Epoch: 3|  Loss:  0.9729 |Global loss: 4.3986| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.8791
Epoch: 0|  Loss:  1.0517 |Global loss: 5.0037| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 0.6819
Epoch: 1|  Loss:  0.8656 |Global loss: 4.2687| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.677
Epoch: 2|  Loss:  0.8733 |Global loss: 4.147| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.665
Epoch: 3|  Loss:  0.8465 |Global loss: 4.0967| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 0|  NKD Loss: 0.8844
Epoch: 0|  Loss:  1.0904 |Global loss: 5.3594| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.7578
Epoch: 1|  Loss:  1.0076 |Global loss: 4.6918| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.7109
Epoch: 2|  Loss:  0.9413 |Global loss: 4.4292| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.8143
Epoch: 3|  Loss:  1.0979 |Global loss: 4.5839| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8867
Epoch: 0|  Loss:  1.0923 |Global loss: 5.3719| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.7391
Epoch: 1|  Loss:  0.9724 |Global loss: 4.5281| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.7002
Epoch: 2|  Loss:  0.9099 |Global loss: 4.3732| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.697
Epoch: 3|  Loss:  0.889 |Global loss: 4.2314| Local H loss: 0.0448  | Global H loss: 0.0448
------------------------- time cost ------------------------- 5.096806049346924
Chosen Clients:  [9, 1, 0, 2, 10, 12]

-------------Round number: 109-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.85, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.817, 0.975]
AUC in each clients:  [118.626, 119.333, 117.452, 119.261, 118.536, 118.29, 119.298, 119.508, 119.02, 119.425, 119.374, 119.642, 118.635, 116.476, 119.13]
F1 Score:  [0.956, 0.982, 0.839, 0.973, 0.941, 0.982, 0.974, 0.981, 0.973, 0.981, 0.982, 0.973, 0.968, 0.803, 0.973]
Recall Score:  [0.964, 0.984, 0.867, 0.977, 0.946, 0.984, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.975, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1875
Averaged Test Accurancy: 0.9550
Averaged Test AUC: 0.9900
Averaged Test F1_score: 0.9521
Averaged Test Recal score: 0.9597
Std Test Accurancy: 0.0492
Std Test AUC: 0.0070
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8549
Epoch: 0|  Loss:  1.0122 |Global loss: 5.1721| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.6731
Epoch: 1|  Loss:  0.8346 |Global loss: 4.4531| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.6944
Epoch: 2|  Loss:  0.8646 |Global loss: 4.3167| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.6832
Epoch: 3|  Loss:  0.8458 |Global loss: 4.2095| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.8466
Epoch: 0|  Loss:  1.007 |Global loss: 5.3268| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.6963
Epoch: 1|  Loss:  0.8701 |Global loss: 4.5706| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.6733
Epoch: 2|  Loss:  0.8419 |Global loss: 4.5407| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.7217
Epoch: 3|  Loss:  0.8984 |Global loss: 4.559| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.7848
Epoch: 0|  Loss:  1.0438 |Global loss: 5.0669| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 0.6587
Epoch: 1|  Loss:  0.9288 |Global loss: 4.1995| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.6661
Epoch: 2|  Loss:  0.9246 |Global loss: 4.2174| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.6075
Epoch: 3|  Loss:  0.8367 |Global loss: 3.9275| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.9581
Epoch: 0|  Loss:  1.5537 |Global loss: 5.8396| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.8001
Epoch: 1|  Loss:  1.2692 |Global loss: 4.3508| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8228
Epoch: 2|  Loss:  1.3276 |Global loss: 4.2713| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.7603
Epoch: 3|  Loss:  1.2913 |Global loss: 4.2052| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 0.8639
Epoch: 0|  Loss:  1.0204 |Global loss: 5.5279| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.7321
Epoch: 1|  Loss:  0.9706 |Global loss: 4.4991| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.7365
Epoch: 2|  Loss:  0.9374 |Global loss: 4.2136| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.7264
Epoch: 3|  Loss:  0.9035 |Global loss: 4.1902| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.8845
Epoch: 0|  Loss:  1.1488 |Global loss: 5.1016| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.763
Epoch: 1|  Loss:  0.9794 |Global loss: 4.1052| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.783
Epoch: 2|  Loss:  1.0432 |Global loss: 4.1152| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.7558
Epoch: 3|  Loss:  1.0065 |Global loss: 3.9679| Local H loss: 0.0344  | Global H loss: 0.0344
------------------------- time cost ------------------------- 4.616375207901001
Chosen Clients:  [3, 5, 9, 1, 0, 14]

-------------Round number: 110-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.883, 0.992, 0.875, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.817, 0.975]
AUC in each clients:  [117.886, 119.19, 117.794, 119.261, 118.536, 118.29, 119.298, 119.508, 119.02, 119.427, 119.287, 119.642, 119.223, 116.476, 119.13]
F1 Score:  [0.894, 0.992, 0.849, 0.973, 0.941, 0.982, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.965, 0.803, 0.973]
Recall Score:  [0.919, 0.993, 0.875, 0.977, 0.946, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.971, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1101
Averaged Test Accurancy: 0.9522
Averaged Test AUC: 0.9900
Averaged Test F1_score: 0.9485
Averaged Test Recal score: 0.9571
Std Test Accurancy: 0.0496
Std Test AUC: 0.0069
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8802
Epoch: 0|  Loss:  1.0444 |Global loss: 5.72| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.6793
Epoch: 1|  Loss:  0.8513 |Global loss: 4.3968| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.6308
Epoch: 2|  Loss:  0.8165 |Global loss: 4.1856| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.6368
Epoch: 3|  Loss:  0.8108 |Global loss: 4.0419| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.9411
Epoch: 0|  Loss:  1.1926 |Global loss: 5.598| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.8023
Epoch: 1|  Loss:  1.0565 |Global loss: 4.6928| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.8445
Epoch: 2|  Loss:  1.1075 |Global loss: 4.5701| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.6982
Epoch: 3|  Loss:  0.9273 |Global loss: 4.3671| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.8114
Epoch: 0|  Loss:  0.9604 |Global loss: 5.2987| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.6892
Epoch: 1|  Loss:  0.8511 |Global loss: 4.4774| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.6899
Epoch: 2|  Loss:  0.8536 |Global loss: 4.3614| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.7403
Epoch: 3|  Loss:  0.9322 |Global loss: 4.4263| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.7856
Epoch: 0|  Loss:  0.9714 |Global loss: 5.335| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.6767
Epoch: 1|  Loss:  0.8454 |Global loss: 4.6639| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.7688
Epoch: 2|  Loss:  0.9934 |Global loss: 4.5407| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.6819
Epoch: 3|  Loss:  0.8437 |Global loss: 4.4295| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.7459
Epoch: 0|  Loss:  0.9761 |Global loss: 5.1749| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.6459
Epoch: 1|  Loss:  0.8802 |Global loss: 4.0981| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 0.6223
Epoch: 2|  Loss:  0.8836 |Global loss: 4.115| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.6227
Epoch: 3|  Loss:  0.8511 |Global loss: 4.0804| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 0|  NKD Loss: 0.8014
Epoch: 0|  Loss:  0.9677 |Global loss: 5.2319| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.74
Epoch: 1|  Loss:  0.9354 |Global loss: 4.5047| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.6984
Epoch: 2|  Loss:  0.9129 |Global loss: 4.277| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.7243
Epoch: 3|  Loss:  0.9065 |Global loss: 4.2117| Local H loss: 0.0363  | Global H loss: 0.0363
------------------------- time cost ------------------------- 4.865020751953125
Chosen Clients:  [13, 5, 11, 7, 2, 4]

-------------Round number: 111-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.875, 0.983, 0.95, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.817, 0.975]
AUC in each clients:  [118.717, 119.305, 117.794, 119.3, 118.536, 118.551, 119.298, 119.508, 119.02, 119.549, 119.287, 119.642, 119.223, 116.476, 119.183]
F1 Score:  [0.983, 0.992, 0.849, 0.984, 0.941, 0.973, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.965, 0.803, 0.973]
Recall Score:  [0.986, 0.993, 0.875, 0.986, 0.946, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.971, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0828
Averaged Test Accurancy: 0.9589
Averaged Test AUC: 0.9908
Averaged Test F1_score: 0.9545
Averaged Test Recal score: 0.9617
Std Test Accurancy: 0.0465
Std Test AUC: 0.0067
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9592
Epoch: 0|  Loss:  1.4379 |Global loss: 5.3895| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.811
Epoch: 1|  Loss:  1.268 |Global loss: 4.5301| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.8565
Epoch: 2|  Loss:  1.3353 |Global loss: 4.4138| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.9086
Epoch: 3|  Loss:  1.3693 |Global loss: 4.3471| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 0|  NKD Loss: 0.8912
Epoch: 0|  Loss:  1.181 |Global loss: 5.5225| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.7463
Epoch: 1|  Loss:  0.9784 |Global loss: 4.3908| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.8145
Epoch: 2|  Loss:  1.0845 |Global loss: 4.5303| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.7369
Epoch: 3|  Loss:  0.9786 |Global loss: 4.2074| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.8237
Epoch: 0|  Loss:  0.9867 |Global loss: 5.1279| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.733
Epoch: 1|  Loss:  0.9118 |Global loss: 4.2532| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 2|  NKD Loss: 0.6641
Epoch: 2|  Loss:  0.8318 |Global loss: 4.1117| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 3|  NKD Loss: 0.6945
Epoch: 3|  Loss:  0.8694 |Global loss: 4.1382| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 0|  NKD Loss: 0.8252
Epoch: 0|  Loss:  1.0125 |Global loss: 5.1307| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.6963
Epoch: 1|  Loss:  0.8756 |Global loss: 4.1879| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.6572
Epoch: 2|  Loss:  0.8592 |Global loss: 4.0756| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.6498
Epoch: 3|  Loss:  0.8928 |Global loss: 3.9794| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9683
Epoch: 0|  Loss:  1.4831 |Global loss: 5.274| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.8206
Epoch: 1|  Loss:  1.2529 |Global loss: 4.473| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.7552
Epoch: 2|  Loss:  1.1597 |Global loss: 4.2025| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.8588
Epoch: 3|  Loss:  1.412 |Global loss: 4.2469| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 0|  NKD Loss: 0.8386
Epoch: 0|  Loss:  1.096 |Global loss: 5.1799| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.7944
Epoch: 1|  Loss:  1.1597 |Global loss: 4.491| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.7843
Epoch: 2|  Loss:  1.0957 |Global loss: 4.3183| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.7699
Epoch: 3|  Loss:  1.0904 |Global loss: 4.2055| Local H loss: 0.0349  | Global H loss: 0.0349
------------------------- time cost ------------------------- 4.82103967666626
Chosen Clients:  [11, 14, 4, 6, 1, 7]

-------------Round number: 112-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.917, 0.983, 0.917, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.967, 0.817, 0.975]
AUC in each clients:  [118.717, 119.305, 118.765, 119.3, 118.667, 118.504, 119.298, 119.343, 119.02, 119.549, 119.287, 119.779, 119.223, 116.702, 119.183]
F1 Score:  [0.983, 0.992, 0.9, 0.984, 0.883, 0.973, 0.974, 0.981, 0.973, 0.981, 0.973, 0.982, 0.965, 0.807, 0.973]
Recall Score:  [0.986, 0.993, 0.917, 0.986, 0.904, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.971, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0195
Averaged Test Accurancy: 0.9600
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9549
Averaged Test Recal score: 0.9621
Std Test Accurancy: 0.0441
Std Test AUC: 0.0058
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8923
Epoch: 0|  Loss:  1.0557 |Global loss: 5.1696| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.7209
Epoch: 1|  Loss:  0.8914 |Global loss: 4.3141| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.6604
Epoch: 2|  Loss:  0.8302 |Global loss: 4.1531| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 3|  NKD Loss: 0.6421
Epoch: 3|  Loss:  0.8154 |Global loss: 4.0995| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 0|  NKD Loss: 0.8068
Epoch: 0|  Loss:  0.9772 |Global loss: 5.1855| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.7156
Epoch: 1|  Loss:  0.9027 |Global loss: 4.2677| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.7876
Epoch: 2|  Loss:  1.0238 |Global loss: 4.434| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.7636
Epoch: 3|  Loss:  0.9734 |Global loss: 4.3389| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.8287
Epoch: 0|  Loss:  1.1191 |Global loss: 5.2655| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.719
Epoch: 1|  Loss:  1.0393 |Global loss: 4.1634| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.7534
Epoch: 2|  Loss:  1.0599 |Global loss: 4.133| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.71
Epoch: 3|  Loss:  1.039 |Global loss: 4.1419| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.8377
Epoch: 0|  Loss:  1.0587 |Global loss: 5.2649| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.7193
Epoch: 1|  Loss:  0.9263 |Global loss: 4.4087| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.7373
Epoch: 2|  Loss:  0.9553 |Global loss: 4.3848| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.7091
Epoch: 3|  Loss:  0.911 |Global loss: 4.2395| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 0|  NKD Loss: 0.8076
Epoch: 0|  Loss:  0.9538 |Global loss: 5.3205| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 0.816
Epoch: 1|  Loss:  1.0642 |Global loss: 4.8065| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.718
Epoch: 2|  Loss:  0.8912 |Global loss: 4.4352| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.6945
Epoch: 3|  Loss:  0.8842 |Global loss: 4.5934| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8162
Epoch: 0|  Loss:  0.9975 |Global loss: 5.2973| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.6926
Epoch: 1|  Loss:  0.9267 |Global loss: 4.198| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.6678
Epoch: 2|  Loss:  0.8545 |Global loss: 4.0194| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.6687
Epoch: 3|  Loss:  0.898 |Global loss: 4.0252| Local H loss: 0.0368  | Global H loss: 0.0368
------------------------- time cost ------------------------- 4.961593151092529
Chosen Clients:  [13, 9, 10, 14, 2, 12]

-------------Round number: 113-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.95, 0.917, 0.983, 0.908, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.967, 0.817, 0.975]
AUC in each clients:  [118.717, 119.155, 118.765, 119.3, 118.311, 118.504, 118.705, 119.305, 119.02, 119.549, 119.287, 119.714, 119.223, 116.702, 119.208]
F1 Score:  [0.983, 0.929, 0.9, 0.984, 0.859, 0.973, 0.974, 0.981, 0.973, 0.981, 0.973, 0.982, 0.965, 0.807, 0.973]
Recall Score:  [0.986, 0.934, 0.917, 0.986, 0.894, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.971, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0780
Averaged Test Accurancy: 0.9567
Averaged Test AUC: 0.9908
Averaged Test F1_score: 0.9491
Averaged Test Recal score: 0.9575
Std Test Accurancy: 0.0439
Std Test AUC: 0.0058
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.9047
Epoch: 0|  Loss:  1.3905 |Global loss: 5.2559| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.8135
Epoch: 1|  Loss:  1.2669 |Global loss: 4.5163| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.8276
Epoch: 2|  Loss:  1.2682 |Global loss: 4.1741| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 3|  NKD Loss: 0.818
Epoch: 3|  Loss:  1.3 |Global loss: 4.4095| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.8172
Epoch: 0|  Loss:  0.9728 |Global loss: 5.2789| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.6855
Epoch: 1|  Loss:  0.8556 |Global loss: 4.3881| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.6936
Epoch: 2|  Loss:  0.8619 |Global loss: 4.3402| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.6918
Epoch: 3|  Loss:  0.863 |Global loss: 4.3058| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8371
Epoch: 0|  Loss:  1.0 |Global loss: 5.4063| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 0.7295
Epoch: 1|  Loss:  0.9077 |Global loss: 4.5092| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.6921
Epoch: 2|  Loss:  0.8638 |Global loss: 4.2527| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.7088
Epoch: 3|  Loss:  0.9022 |Global loss: 4.2539| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.77
Epoch: 0|  Loss:  0.9355 |Global loss: 4.905| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 0.8233
Epoch: 1|  Loss:  1.0657 |Global loss: 4.5524| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.7803
Epoch: 2|  Loss:  0.9732 |Global loss: 4.4072| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.6977
Epoch: 3|  Loss:  0.8775 |Global loss: 4.1383| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 1.0579
Epoch: 0|  Loss:  1.6525 |Global loss: 5.516| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.8521
Epoch: 1|  Loss:  1.358 |Global loss: 4.4279| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.8204
Epoch: 2|  Loss:  1.2505 |Global loss: 4.2952| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.7922
Epoch: 3|  Loss:  1.3401 |Global loss: 4.1894| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9031
Epoch: 0|  Loss:  1.1217 |Global loss: 4.7388| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.78
Epoch: 1|  Loss:  1.0263 |Global loss: 4.1131| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.7293
Epoch: 2|  Loss:  0.9839 |Global loss: 3.9225| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.7473
Epoch: 3|  Loss:  1.0268 |Global loss: 3.9043| Local H loss: 0.0352  | Global H loss: 0.0352
------------------------- time cost ------------------------- 4.827949285507202
Chosen Clients:  [3, 14, 6, 11, 10, 7]

-------------Round number: 114-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.95, 0.933, 0.983, 0.908, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.967, 0.833, 0.975]
AUC in each clients:  [118.717, 119.155, 118.927, 119.3, 118.311, 118.504, 118.705, 119.305, 119.02, 119.552, 119.259, 119.714, 118.852, 116.22, 119.158]
F1 Score:  [0.983, 0.929, 0.925, 0.984, 0.859, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.982, 0.966, 0.832, 0.973]
Recall Score:  [0.986, 0.934, 0.934, 0.986, 0.894, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.973, 0.861, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1589
Averaged Test Accurancy: 0.9589
Averaged Test AUC: 0.9904
Averaged Test F1_score: 0.9526
Averaged Test Recal score: 0.9603
Std Test Accurancy: 0.0395
Std Test AUC: 0.0066
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8936
Epoch: 0|  Loss:  1.0473 |Global loss: 5.3423| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 0.6295
Epoch: 1|  Loss:  0.8005 |Global loss: 4.1476| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.6163
Epoch: 2|  Loss:  0.7883 |Global loss: 4.0756| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.6177
Epoch: 3|  Loss:  0.7962 |Global loss: 4.0192| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 0|  NKD Loss: 0.8679
Epoch: 0|  Loss:  1.0429 |Global loss: 5.2739| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.6767
Epoch: 1|  Loss:  0.8541 |Global loss: 4.1828| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.6784
Epoch: 2|  Loss:  0.8623 |Global loss: 4.137| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.6446
Epoch: 3|  Loss:  0.8234 |Global loss: 3.9551| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.8735
Epoch: 0|  Loss:  1.0917 |Global loss: 5.4112| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.6521
Epoch: 1|  Loss:  0.8366 |Global loss: 4.3061| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.7177
Epoch: 2|  Loss:  0.9384 |Global loss: 4.2599| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.7145
Epoch: 3|  Loss:  0.917 |Global loss: 4.2587| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 0|  NKD Loss: 0.9038
Epoch: 0|  Loss:  1.0695 |Global loss: 5.3457| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.7243
Epoch: 1|  Loss:  0.8917 |Global loss: 4.3169| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 0.7131
Epoch: 2|  Loss:  0.8788 |Global loss: 4.2506| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 3|  NKD Loss: 0.7215
Epoch: 3|  Loss:  0.8922 |Global loss: 4.3847| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.8703
Epoch: 0|  Loss:  1.0223 |Global loss: 5.5064| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.7102
Epoch: 1|  Loss:  0.8846 |Global loss: 4.3289| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.6917
Epoch: 2|  Loss:  0.8712 |Global loss: 4.2085| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.6896
Epoch: 3|  Loss:  0.8689 |Global loss: 4.1635| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9113
Epoch: 0|  Loss:  1.1004 |Global loss: 5.2307| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.6506
Epoch: 1|  Loss:  0.8222 |Global loss: 4.0492| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.6594
Epoch: 2|  Loss:  0.8854 |Global loss: 3.9301| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.616
Epoch: 3|  Loss:  0.8171 |Global loss: 3.8693| Local H loss: 0.0374  | Global H loss: 0.0374
------------------------- time cost ------------------------- 5.0654380321502686
Chosen Clients:  [4, 0, 10, 1, 2, 3]

-------------Round number: 115-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.95, 0.933, 0.983, 0.908, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.967, 0.833, 0.975]
AUC in each clients:  [118.717, 119.155, 118.927, 119.394, 118.311, 118.504, 119.135, 119.424, 119.02, 119.552, 119.261, 119.751, 118.852, 116.22, 119.02]
F1 Score:  [0.983, 0.929, 0.925, 0.983, 0.859, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.982, 0.966, 0.832, 0.973]
Recall Score:  [0.986, 0.934, 0.934, 0.986, 0.894, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.973, 0.861, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2181
Averaged Test Accurancy: 0.9589
Averaged Test AUC: 0.9907
Averaged Test F1_score: 0.9525
Averaged Test Recal score: 0.9603
Std Test Accurancy: 0.0395
Std Test AUC: 0.0067
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8903
Epoch: 0|  Loss:  1.2268 |Global loss: 5.1937| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.7486
Epoch: 1|  Loss:  1.0347 |Global loss: 4.1638| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.6984
Epoch: 2|  Loss:  0.9512 |Global loss: 3.9793| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.6814
Epoch: 3|  Loss:  0.9828 |Global loss: 3.9487| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.7447
Epoch: 0|  Loss:  0.9837 |Global loss: 4.8713| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.6391
Epoch: 1|  Loss:  0.8687 |Global loss: 4.06| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.6359
Epoch: 2|  Loss:  0.8864 |Global loss: 4.0619| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.6618
Epoch: 3|  Loss:  0.9266 |Global loss: 4.0849| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.8973
Epoch: 0|  Loss:  1.0664 |Global loss: 5.393| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.728
Epoch: 1|  Loss:  0.8896 |Global loss: 4.4851| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.6885
Epoch: 2|  Loss:  0.8561 |Global loss: 4.2498| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.6696
Epoch: 3|  Loss:  0.8365 |Global loss: 4.0684| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.8056
Epoch: 0|  Loss:  0.9818 |Global loss: 5.303| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.6863
Epoch: 1|  Loss:  0.8564 |Global loss: 4.4456| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.7814
Epoch: 2|  Loss:  1.0156 |Global loss: 4.5001| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.7173
Epoch: 3|  Loss:  0.8767 |Global loss: 4.3648| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 1.0874
Epoch: 0|  Loss:  1.5912 |Global loss: 5.3626| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.8603
Epoch: 1|  Loss:  1.3875 |Global loss: 4.5188| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.7675
Epoch: 2|  Loss:  1.2111 |Global loss: 4.1896| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.748
Epoch: 3|  Loss:  1.1633 |Global loss: 4.1269| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.9743
Epoch: 0|  Loss:  1.1489 |Global loss: 5.5818| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.7235
Epoch: 1|  Loss:  0.8927 |Global loss: 4.2981| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.6475
Epoch: 2|  Loss:  0.821 |Global loss: 4.2461| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.6091
Epoch: 3|  Loss:  0.7754 |Global loss: 3.9942| Local H loss: 0.0408  | Global H loss: 0.0408
------------------------- time cost ------------------------- 4.773003816604614
Chosen Clients:  [7, 9, 10, 2, 12, 0]

-------------Round number: 116-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.933, 0.975, 0.942, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.967, 0.833, 0.975]
AUC in each clients:  [118.777, 119.415, 118.895, 119.364, 118.533, 118.504, 119.135, 119.424, 119.02, 119.552, 119.37, 119.751, 118.852, 116.22, 119.02]
F1 Score:  [0.983, 0.982, 0.93, 0.973, 0.928, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.982, 0.966, 0.832, 0.973]
Recall Score:  [0.986, 0.984, 0.942, 0.977, 0.935, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.973, 0.861, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0378
Averaged Test Accurancy: 0.9628
Averaged Test AUC: 0.9910
Averaged Test F1_score: 0.9603
Averaged Test Recal score: 0.9663
Std Test Accurancy: 0.0375
Std Test AUC: 0.0067
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8508
Epoch: 0|  Loss:  1.0392 |Global loss: 5.4774| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.6948
Epoch: 1|  Loss:  0.8808 |Global loss: 4.1707| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.6853
Epoch: 2|  Loss:  0.9026 |Global loss: 4.1583| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.6694
Epoch: 3|  Loss:  0.9189 |Global loss: 4.0476| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.8238
Epoch: 0|  Loss:  0.9658 |Global loss: 5.2616| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.7463
Epoch: 1|  Loss:  0.9043 |Global loss: 4.6076| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.7195
Epoch: 2|  Loss:  0.8801 |Global loss: 4.497| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.6873
Epoch: 3|  Loss:  0.8489 |Global loss: 4.2176| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8223
Epoch: 0|  Loss:  0.9747 |Global loss: 5.559| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.7177
Epoch: 1|  Loss:  0.9163 |Global loss: 4.4573| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.6767
Epoch: 2|  Loss:  0.8431 |Global loss: 4.195| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.692
Epoch: 3|  Loss:  0.8638 |Global loss: 4.1801| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 1.0024
Epoch: 0|  Loss:  1.5585 |Global loss: 5.8501| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.9342
Epoch: 1|  Loss:  1.5926 |Global loss: 4.8701| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.7847
Epoch: 2|  Loss:  1.1872 |Global loss: 4.1854| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.7137
Epoch: 3|  Loss:  1.088 |Global loss: 4.0746| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.8773
Epoch: 0|  Loss:  1.1521 |Global loss: 4.998| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.8264
Epoch: 1|  Loss:  1.0911 |Global loss: 4.1177| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.8061
Epoch: 2|  Loss:  1.1722 |Global loss: 4.2342| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.7242
Epoch: 3|  Loss:  0.948 |Global loss: 3.7799| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.8857
Epoch: 0|  Loss:  1.1196 |Global loss: 5.5947| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.6368
Epoch: 1|  Loss:  0.8788 |Global loss: 4.1545| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.6376
Epoch: 2|  Loss:  0.8818 |Global loss: 4.05| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.5767
Epoch: 3|  Loss:  0.7855 |Global loss: 3.9005| Local H loss: 0.0408  | Global H loss: 0.0408
------------------------- time cost ------------------------- 4.883714914321899
Chosen Clients:  [6, 9, 11, 7, 2, 1]

-------------Round number: 117-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.975, 0.942, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.833, 0.975]
AUC in each clients:  [118.564, 119.415, 119.134, 119.364, 118.533, 118.504, 119.135, 119.4, 119.02, 119.497, 119.352, 119.751, 118.898, 116.22, 119.02]
F1 Score:  [0.97, 0.982, 0.981, 0.973, 0.928, 0.973, 0.974, 0.981, 0.973, 0.981, 0.973, 0.982, 0.975, 0.832, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.977, 0.935, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.981, 0.861, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0270
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9910
Averaged Test F1_score: 0.9634
Averaged Test Recal score: 0.9689
Std Test Accurancy: 0.0368
Std Test AUC: 0.0067
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8722
Epoch: 0|  Loss:  1.0609 |Global loss: 5.1783| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.6973
Epoch: 1|  Loss:  0.8863 |Global loss: 4.3524| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.6772
Epoch: 2|  Loss:  0.8888 |Global loss: 4.342| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.6926
Epoch: 3|  Loss:  0.873 |Global loss: 4.2023| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 0|  NKD Loss: 0.8511
Epoch: 0|  Loss:  0.9951 |Global loss: 5.1034| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.6665
Epoch: 1|  Loss:  0.8242 |Global loss: 4.327| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.6522
Epoch: 2|  Loss:  0.808 |Global loss: 4.2002| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.7174
Epoch: 3|  Loss:  0.9035 |Global loss: 4.398| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 0.8228
Epoch: 0|  Loss:  0.9797 |Global loss: 4.9478| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.7748
Epoch: 1|  Loss:  0.9388 |Global loss: 4.2996| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 2|  NKD Loss: 0.7375
Epoch: 2|  Loss:  0.9019 |Global loss: 4.4595| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.7011
Epoch: 3|  Loss:  0.8721 |Global loss: 4.2509| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 0|  NKD Loss: 0.7971
Epoch: 0|  Loss:  0.9486 |Global loss: 5.5765| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.6991
Epoch: 1|  Loss:  0.8851 |Global loss: 4.1756| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.6775
Epoch: 2|  Loss:  0.865 |Global loss: 4.0355| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6994
Epoch: 3|  Loss:  0.9778 |Global loss: 4.0558| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.9988
Epoch: 0|  Loss:  1.4089 |Global loss: 5.4145| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.7451
Epoch: 1|  Loss:  1.0822 |Global loss: 4.3394| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.8022
Epoch: 2|  Loss:  1.2915 |Global loss: 4.4214| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.7082
Epoch: 3|  Loss:  1.006 |Global loss: 4.0762| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 0|  NKD Loss: 0.9016
Epoch: 0|  Loss:  1.0733 |Global loss: 5.4482| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.7798
Epoch: 1|  Loss:  0.9566 |Global loss: 4.6097| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.7462
Epoch: 2|  Loss:  0.9155 |Global loss: 4.6435| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.6677
Epoch: 3|  Loss:  0.8234 |Global loss: 4.3801| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 4.857088088989258
Chosen Clients:  [12, 14, 3, 8, 5, 13]

-------------Round number: 118-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.975, 0.942, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.833, 0.975]
AUC in each clients:  [118.564, 119.423, 119.13, 119.364, 118.533, 118.504, 119.302, 119.393, 119.02, 119.571, 119.352, 119.666, 118.898, 116.22, 119.02]
F1 Score:  [0.97, 0.982, 0.981, 0.973, 0.928, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.975, 0.832, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.977, 0.935, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.861, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9982
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9629
Averaged Test Recal score: 0.9685
Std Test Accurancy: 0.0365
Std Test AUC: 0.0067
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8789
Epoch: 0|  Loss:  1.184 |Global loss: 4.8466| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.7107
Epoch: 1|  Loss:  0.942 |Global loss: 3.9263| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.7444
Epoch: 2|  Loss:  1.0084 |Global loss: 3.9779| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.7129
Epoch: 3|  Loss:  0.94 |Global loss: 3.8536| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.8145
Epoch: 0|  Loss:  0.9808 |Global loss: 5.1699| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.7976
Epoch: 1|  Loss:  1.0076 |Global loss: 4.5021| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.7167
Epoch: 2|  Loss:  0.8976 |Global loss: 4.224| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.7317
Epoch: 3|  Loss:  0.899 |Global loss: 4.2723| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.9255
Epoch: 0|  Loss:  1.0792 |Global loss: 5.2421| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.6924
Epoch: 1|  Loss:  0.8716 |Global loss: 4.0234| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 0.6342
Epoch: 2|  Loss:  0.8086 |Global loss: 3.8516| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.6209
Epoch: 3|  Loss:  0.7947 |Global loss: 3.8741| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 0|  NKD Loss: 0.7663
Epoch: 0|  Loss:  0.9348 |Global loss: 4.6884| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.6953
Epoch: 1|  Loss:  0.9253 |Global loss: 3.9868| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.6911
Epoch: 2|  Loss:  0.9094 |Global loss: 3.8111| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.6389
Epoch: 3|  Loss:  0.8349 |Global loss: 3.6829| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 0|  NKD Loss: 0.9566
Epoch: 0|  Loss:  1.2562 |Global loss: 5.5128| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.7891
Epoch: 1|  Loss:  1.0357 |Global loss: 4.6547| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.7525
Epoch: 2|  Loss:  0.9774 |Global loss: 4.4893| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 0.7121
Epoch: 3|  Loss:  0.9115 |Global loss: 4.2054| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9008
Epoch: 0|  Loss:  1.3528 |Global loss: 5.2419| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.8653
Epoch: 1|  Loss:  1.3126 |Global loss: 4.4534| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.7968
Epoch: 2|  Loss:  1.2211 |Global loss: 4.379| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.8167
Epoch: 3|  Loss:  1.2506 |Global loss: 4.4028| Local H loss: 0.0408  | Global H loss: 0.0408
------------------------- time cost ------------------------- 4.921981573104858
Chosen Clients:  [11, 8, 14, 3, 7, 5]

-------------Round number: 119-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.983, 0.942, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.842, 0.975]
AUC in each clients:  [118.564, 119.423, 119.13, 119.261, 118.533, 118.33, 119.302, 119.393, 119.068, 119.571, 119.352, 119.666, 118.525, 116.79, 119.112]
F1 Score:  [0.97, 0.982, 0.981, 0.983, 0.928, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.954, 0.844, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.986, 0.935, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.965, 0.88, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2476
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9629
Averaged Test Recal score: 0.9693
Std Test Accurancy: 0.0349
Std Test AUC: 0.0058
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8915
Epoch: 0|  Loss:  1.045 |Global loss: 5.2586| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.7295
Epoch: 1|  Loss:  0.8908 |Global loss: 4.2242| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 0.7008
Epoch: 2|  Loss:  0.881 |Global loss: 4.2796| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.709
Epoch: 3|  Loss:  0.8735 |Global loss: 4.1686| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 0|  NKD Loss: 0.8904
Epoch: 0|  Loss:  1.0844 |Global loss: 4.9548| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.7354
Epoch: 1|  Loss:  0.9202 |Global loss: 4.0227| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.7613
Epoch: 2|  Loss:  1.0128 |Global loss: 3.9326| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.6937
Epoch: 3|  Loss:  0.9166 |Global loss: 3.7766| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.7921
Epoch: 0|  Loss:  0.9453 |Global loss: 5.172| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.7013
Epoch: 1|  Loss:  0.8743 |Global loss: 4.2245| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.6767
Epoch: 2|  Loss:  0.8441 |Global loss: 4.0535| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.6533
Epoch: 3|  Loss:  0.8207 |Global loss: 3.9298| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.892
Epoch: 0|  Loss:  1.0554 |Global loss: 5.2025| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 0.6498
Epoch: 1|  Loss:  0.8304 |Global loss: 4.0051| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.7164
Epoch: 2|  Loss:  0.9805 |Global loss: 4.0176| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.6111
Epoch: 3|  Loss:  0.7827 |Global loss: 3.8478| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.8527
Epoch: 0|  Loss:  1.0523 |Global loss: 5.1522| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.631
Epoch: 1|  Loss:  0.7906 |Global loss: 4.0331| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.6278
Epoch: 2|  Loss:  0.7921 |Global loss: 3.8818| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.6394
Epoch: 3|  Loss:  0.8321 |Global loss: 3.9216| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.8284
Epoch: 0|  Loss:  1.0689 |Global loss: 5.2397| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.7373
Epoch: 1|  Loss:  0.9697 |Global loss: 4.5167| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.6952
Epoch: 2|  Loss:  0.9384 |Global loss: 4.3964| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.7505
Epoch: 3|  Loss:  1.0121 |Global loss: 4.3606| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 5.281354188919067
Chosen Clients:  [1, 12, 5, 10, 8, 11]

-------------Round number: 120-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.975, 0.942, 0.958, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.842, 0.975]
AUC in each clients:  [118.564, 119.423, 119.13, 119.32, 118.533, 118.185, 119.302, 119.512, 119.044, 119.571, 119.352, 119.599, 118.525, 116.79, 119.139]
F1 Score:  [0.97, 0.982, 0.981, 0.973, 0.928, 0.954, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.954, 0.844, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.977, 0.935, 0.96, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.965, 0.88, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0423
Averaged Test Accurancy: 0.9628
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9610
Averaged Test Recal score: 0.9675
Std Test Accurancy: 0.0345
Std Test AUC: 0.0059
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8195
Epoch: 0|  Loss:  0.9944 |Global loss: 5.4156| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.7686
Epoch: 1|  Loss:  0.9585 |Global loss: 4.6224| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.7146
Epoch: 2|  Loss:  0.8903 |Global loss: 4.5505| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.7396
Epoch: 3|  Loss:  0.9427 |Global loss: 4.4432| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.8513
Epoch: 0|  Loss:  1.082 |Global loss: 4.7383| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.7865
Epoch: 1|  Loss:  1.0453 |Global loss: 4.2029| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.795
Epoch: 2|  Loss:  1.0164 |Global loss: 3.9761| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.687
Epoch: 3|  Loss:  0.8988 |Global loss: 3.7799| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.8004
Epoch: 0|  Loss:  1.0318 |Global loss: 5.2535| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.723
Epoch: 1|  Loss:  0.9438 |Global loss: 4.4053| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.7304
Epoch: 2|  Loss:  0.9693 |Global loss: 4.3709| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.729
Epoch: 3|  Loss:  0.9935 |Global loss: 4.4813| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9133
Epoch: 0|  Loss:  1.1515 |Global loss: 5.571| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.7039
Epoch: 1|  Loss:  0.8651 |Global loss: 4.542| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.7195
Epoch: 2|  Loss:  0.9243 |Global loss: 4.3121| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.7846
Epoch: 3|  Loss:  1.0746 |Global loss: 4.2372| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9101
Epoch: 0|  Loss:  1.1293 |Global loss: 4.7042| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.6641
Epoch: 1|  Loss:  0.873 |Global loss: 3.7864| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.664
Epoch: 2|  Loss:  0.8417 |Global loss: 3.7352| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.6496
Epoch: 3|  Loss:  0.8779 |Global loss: 3.7044| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.878
Epoch: 0|  Loss:  1.0305 |Global loss: 5.2555| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.7232
Epoch: 1|  Loss:  0.8808 |Global loss: 4.3363| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.7038
Epoch: 2|  Loss:  0.8693 |Global loss: 4.1461| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.6417
Epoch: 3|  Loss:  0.8045 |Global loss: 3.9761| Local H loss: 0.0441  | Global H loss: 0.0441
------------------------- time cost ------------------------- 5.112316846847534
Chosen Clients:  [10, 6, 13, 12, 1, 8]

-------------Round number: 121-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.975, 0.942, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.95, 0.842, 0.975]
AUC in each clients:  [118.564, 119.443, 119.13, 119.32, 118.533, 118.249, 119.302, 119.512, 118.904, 119.571, 119.409, 119.685, 118.639, 116.79, 119.139]
F1 Score:  [0.97, 0.982, 0.981, 0.973, 0.928, 0.982, 0.974, 0.981, 0.974, 0.982, 0.982, 0.973, 0.954, 0.844, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.977, 0.935, 0.984, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.965, 0.88, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9992
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9912
Averaged Test F1_score: 0.9635
Averaged Test Recal score: 0.9696
Std Test Accurancy: 0.0351
Std Test AUC: 0.0059
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.9132
Epoch: 0|  Loss:  1.1181 |Global loss: 5.5091| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.684
Epoch: 1|  Loss:  0.8422 |Global loss: 4.3847| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.7278
Epoch: 2|  Loss:  0.9316 |Global loss: 4.3423| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.6917
Epoch: 3|  Loss:  0.8626 |Global loss: 4.0823| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.8189
Epoch: 0|  Loss:  0.9964 |Global loss: 5.0916| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.7772
Epoch: 1|  Loss:  0.9967 |Global loss: 4.5879| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.7132
Epoch: 2|  Loss:  0.8968 |Global loss: 4.2882| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.6125
Epoch: 3|  Loss:  0.7871 |Global loss: 4.0777| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 0|  NKD Loss: 1.0807
Epoch: 0|  Loss:  1.4985 |Global loss: 5.307| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.9137
Epoch: 1|  Loss:  1.3591 |Global loss: 4.7053| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.775
Epoch: 2|  Loss:  1.2024 |Global loss: 4.406| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 3|  NKD Loss: 0.8397
Epoch: 3|  Loss:  1.2507 |Global loss: 4.3913| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.9072
Epoch: 0|  Loss:  1.2306 |Global loss: 5.0023| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.8117
Epoch: 1|  Loss:  1.0346 |Global loss: 4.2688| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.7595
Epoch: 2|  Loss:  0.9783 |Global loss: 3.9835| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.7335
Epoch: 3|  Loss:  0.9754 |Global loss: 3.9495| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.7785
Epoch: 0|  Loss:  0.9342 |Global loss: 5.0866| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 0.6918
Epoch: 1|  Loss:  0.8447 |Global loss: 4.5716| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.7797
Epoch: 2|  Loss:  0.9858 |Global loss: 4.6817| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.7085
Epoch: 3|  Loss:  0.8821 |Global loss: 4.4666| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8134
Epoch: 0|  Loss:  1.012 |Global loss: 4.8707| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.6979
Epoch: 1|  Loss:  0.9237 |Global loss: 3.8751| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.6413
Epoch: 2|  Loss:  0.8108 |Global loss: 3.7112| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.6547
Epoch: 3|  Loss:  0.8277 |Global loss: 3.6805| Local H loss: 0.0372  | Global H loss: 0.0372
------------------------- time cost ------------------------- 4.780979156494141
Chosen Clients:  [3, 1, 5, 12, 6, 13]

-------------Round number: 122-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.975, 0.942, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.825, 0.975]
AUC in each clients:  [118.564, 119.461, 119.13, 119.32, 118.533, 118.249, 119.264, 119.512, 118.988, 119.571, 119.339, 119.685, 118.894, 116.967, 119.139]
F1 Score:  [0.97, 0.981, 0.981, 0.973, 0.928, 0.982, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.967, 0.822, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.977, 0.935, 0.984, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.973, 0.852, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8821
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9622
Averaged Test Recal score: 0.9678
Std Test Accurancy: 0.0387
Std Test AUC: 0.0056
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.9222
Epoch: 0|  Loss:  1.0685 |Global loss: 5.639| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.6494
Epoch: 1|  Loss:  0.8038 |Global loss: 4.3249| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.6085
Epoch: 2|  Loss:  0.7719 |Global loss: 4.2157| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.6753
Epoch: 3|  Loss:  0.841 |Global loss: 4.1833| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.8444
Epoch: 0|  Loss:  1.0037 |Global loss: 5.6177| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.7012
Epoch: 1|  Loss:  0.8783 |Global loss: 4.5553| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.6714
Epoch: 2|  Loss:  0.8374 |Global loss: 4.4025| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.6825
Epoch: 3|  Loss:  0.8537 |Global loss: 4.2879| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8428
Epoch: 0|  Loss:  1.0755 |Global loss: 5.1518| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.7921
Epoch: 1|  Loss:  1.0222 |Global loss: 4.5772| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6835
Epoch: 2|  Loss:  0.9164 |Global loss: 4.3342| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6895
Epoch: 3|  Loss:  0.9589 |Global loss: 4.4339| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.9309
Epoch: 0|  Loss:  1.1902 |Global loss: 5.3563| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.7719
Epoch: 1|  Loss:  0.9773 |Global loss: 4.0898| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.7619
Epoch: 2|  Loss:  1.0025 |Global loss: 4.0416| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.7698
Epoch: 3|  Loss:  1.0169 |Global loss: 4.1658| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.7504
Epoch: 0|  Loss:  0.9093 |Global loss: 5.2049| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.6877
Epoch: 1|  Loss:  0.8687 |Global loss: 4.2968| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.6451
Epoch: 2|  Loss:  0.8194 |Global loss: 4.1652| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.6839
Epoch: 3|  Loss:  0.8657 |Global loss: 4.1786| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.8901
Epoch: 0|  Loss:  1.3283 |Global loss: 5.2118| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.838
Epoch: 1|  Loss:  1.2703 |Global loss: 4.5295| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.7795
Epoch: 2|  Loss:  1.175 |Global loss: 4.1944| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.8464
Epoch: 3|  Loss:  1.2986 |Global loss: 4.1835| Local H loss: 0.0415  | Global H loss: 0.0415
------------------------- time cost ------------------------- 4.774624347686768
Chosen Clients:  [14, 1, 11, 2, 4, 3]

-------------Round number: 123-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.983, 0.983, 0.983, 0.942, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.564, 119.389, 119.13, 119.208, 118.533, 118.265, 119.195, 119.512, 118.988, 119.571, 119.339, 119.685, 118.999, 116.823, 119.139]
F1 Score:  [0.97, 0.982, 0.981, 0.984, 0.928, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.983, 0.853, 0.973]
Recall Score:  [0.975, 0.984, 0.984, 0.986, 0.935, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9968
Averaged Test Accurancy: 0.9672
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9655
Averaged Test Recal score: 0.9717
Std Test Accurancy: 0.0330
Std Test AUC: 0.0057
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7232
Epoch: 0|  Loss:  0.8788 |Global loss: 4.888| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.6575
Epoch: 1|  Loss:  0.838 |Global loss: 4.1946| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6852
Epoch: 2|  Loss:  0.8536 |Global loss: 4.1752| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.6811
Epoch: 3|  Loss:  0.8503 |Global loss: 3.9634| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.787
Epoch: 0|  Loss:  0.9317 |Global loss: 5.4967| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.6847
Epoch: 1|  Loss:  0.8538 |Global loss: 4.5272| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.6778
Epoch: 2|  Loss:  0.8512 |Global loss: 4.4543| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6833
Epoch: 3|  Loss:  0.8446 |Global loss: 4.3354| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.8262
Epoch: 0|  Loss:  0.9797 |Global loss: 5.4845| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.721
Epoch: 1|  Loss:  0.8919 |Global loss: 4.4891| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.6947
Epoch: 2|  Loss:  0.8532 |Global loss: 4.3984| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.6773
Epoch: 3|  Loss:  0.8402 |Global loss: 4.1475| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.932
Epoch: 0|  Loss:  1.3801 |Global loss: 5.7281| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.8796
Epoch: 1|  Loss:  1.2693 |Global loss: 4.6326| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.7929
Epoch: 2|  Loss:  1.2098 |Global loss: 4.4235| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.7148
Epoch: 3|  Loss:  1.0737 |Global loss: 4.1464| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.8296
Epoch: 0|  Loss:  1.1279 |Global loss: 5.1766| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.7464
Epoch: 1|  Loss:  1.0562 |Global loss: 4.2931| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.7725
Epoch: 2|  Loss:  1.1039 |Global loss: 4.3224| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.738
Epoch: 3|  Loss:  1.0307 |Global loss: 4.1578| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.8258
Epoch: 0|  Loss:  0.9662 |Global loss: 5.3578| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.6653
Epoch: 1|  Loss:  0.816 |Global loss: 4.2989| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.6863
Epoch: 2|  Loss:  0.8537 |Global loss: 4.2277| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.6075
Epoch: 3|  Loss:  0.7839 |Global loss: 4.0108| Local H loss: 0.0372  | Global H loss: 0.0372
------------------------- time cost ------------------------- 4.77218770980835
Chosen Clients:  [9, 5, 13, 0, 1, 12]

-------------Round number: 124-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.967, 0.975, 0.983, 0.925, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.983]
AUC in each clients:  [118.564, 119.439, 119.316, 119.321, 118.666, 118.265, 119.195, 119.512, 118.988, 119.571, 119.339, 119.674, 118.999, 116.823, 119.137]
F1 Score:  [0.97, 0.961, 0.973, 0.983, 0.901, 0.973, 0.974, 0.981, 0.973, 0.982, 0.973, 0.973, 0.983, 0.853, 0.983]
Recall Score:  [0.975, 0.965, 0.975, 0.986, 0.914, 0.977, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.894, 0.986]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1470
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9916
Averaged Test F1_score: 0.9624
Averaged Test Recal score: 0.9690
Std Test Accurancy: 0.0338
Std Test AUC: 0.0058
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7479
Epoch: 0|  Loss:  0.9022 |Global loss: 4.9455| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.709
Epoch: 1|  Loss:  0.8652 |Global loss: 4.407| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.6941
Epoch: 2|  Loss:  0.8484 |Global loss: 4.2684| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.6585
Epoch: 3|  Loss:  0.8127 |Global loss: 4.1252| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.8418
Epoch: 0|  Loss:  1.0445 |Global loss: 5.2802| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.6864
Epoch: 1|  Loss:  0.8915 |Global loss: 4.346| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.7566
Epoch: 2|  Loss:  1.0212 |Global loss: 4.4279| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.6787
Epoch: 3|  Loss:  0.913 |Global loss: 4.1532| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9346
Epoch: 0|  Loss:  1.3459 |Global loss: 5.4607| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.8084
Epoch: 1|  Loss:  1.2368 |Global loss: 4.635| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.8573
Epoch: 2|  Loss:  1.2596 |Global loss: 4.4518| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.8503
Epoch: 3|  Loss:  1.2611 |Global loss: 4.423| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.8003
Epoch: 0|  Loss:  1.0195 |Global loss: 5.2093| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.6564
Epoch: 1|  Loss:  0.8828 |Global loss: 4.1673| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.6632
Epoch: 2|  Loss:  0.8736 |Global loss: 4.1247| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.6226
Epoch: 3|  Loss:  0.8382 |Global loss: 3.9753| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.7857
Epoch: 0|  Loss:  0.927 |Global loss: 5.3711| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.7246
Epoch: 1|  Loss:  0.8909 |Global loss: 4.5759| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6876
Epoch: 2|  Loss:  0.8385 |Global loss: 4.2682| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.6819
Epoch: 3|  Loss:  0.8329 |Global loss: 4.3116| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.8445
Epoch: 0|  Loss:  1.0713 |Global loss: 4.8468| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.7036
Epoch: 1|  Loss:  0.9403 |Global loss: 3.8612| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.7121
Epoch: 2|  Loss:  0.9276 |Global loss: 3.8709| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6645
Epoch: 3|  Loss:  0.8921 |Global loss: 3.7211| Local H loss: 0.0341  | Global H loss: 0.0341
------------------------- time cost ------------------------- 4.746389627456665
Chosen Clients:  [2, 4, 14, 9, 13, 6]

-------------Round number: 125-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.983, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.983]
AUC in each clients:  [118.733, 119.389, 119.316, 119.321, 118.666, 118.252, 119.195, 119.512, 118.988, 119.471, 119.339, 119.674, 118.784, 117.22, 119.137]
F1 Score:  [0.983, 0.981, 0.973, 0.983, 0.901, 0.983, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.983, 0.853, 0.983]
Recall Score:  [0.986, 0.984, 0.975, 0.986, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.894, 0.986]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1161
Averaged Test Accurancy: 0.9678
Averaged Test AUC: 0.9917
Averaged Test F1_score: 0.9652
Averaged Test Recal score: 0.9716
Std Test Accurancy: 0.0345
Std Test AUC: 0.0050
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8728
Epoch: 0|  Loss:  1.1465 |Global loss: 5.638| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.8274
Epoch: 1|  Loss:  1.1869 |Global loss: 4.5686| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.8753
Epoch: 2|  Loss:  1.3421 |Global loss: 4.5268| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.7299
Epoch: 3|  Loss:  1.1149 |Global loss: 4.1714| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.7616
Epoch: 0|  Loss:  1.0532 |Global loss: 5.0959| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.7177
Epoch: 1|  Loss:  1.0102 |Global loss: 4.2828| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.68
Epoch: 2|  Loss:  0.9644 |Global loss: 4.1744| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.6733
Epoch: 3|  Loss:  1.0131 |Global loss: 4.0234| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8289
Epoch: 0|  Loss:  1.0048 |Global loss: 5.0826| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.7328
Epoch: 1|  Loss:  0.8963 |Global loss: 4.3404| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.7389
Epoch: 2|  Loss:  0.907 |Global loss: 4.092| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.744
Epoch: 3|  Loss:  0.914 |Global loss: 4.1949| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.8304
Epoch: 0|  Loss:  0.9741 |Global loss: 5.3959| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.661
Epoch: 1|  Loss:  0.8143 |Global loss: 4.2679| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.6632
Epoch: 2|  Loss:  0.817 |Global loss: 4.1797| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.6331
Epoch: 3|  Loss:  0.8006 |Global loss: 4.0416| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9677
Epoch: 0|  Loss:  1.3554 |Global loss: 5.8853| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.8164
Epoch: 1|  Loss:  1.2211 |Global loss: 4.3897| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.8045
Epoch: 2|  Loss:  1.2047 |Global loss: 4.3186| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.8291
Epoch: 3|  Loss:  1.2504 |Global loss: 4.3704| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.8172
Epoch: 0|  Loss:  0.9862 |Global loss: 5.1869| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.6696
Epoch: 1|  Loss:  0.8341 |Global loss: 4.244| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.652
Epoch: 2|  Loss:  0.8137 |Global loss: 4.0867| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.6351
Epoch: 3|  Loss:  0.8009 |Global loss: 3.9781| Local H loss: 0.043  | Global H loss: 0.043
------------------------- time cost ------------------------- 5.042000770568848
Chosen Clients:  [3, 12, 0, 4, 9, 13]

-------------Round number: 126-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.933, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.8, 0.975]
AUC in each clients:  [118.733, 119.389, 119.171, 119.321, 118.779, 118.252, 119.121, 119.512, 118.988, 119.523, 119.339, 119.674, 118.784, 116.741, 119.191]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.925, 0.983, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.983, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.928, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0450
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9914
Averaged Test F1_score: 0.9607
Averaged Test Recal score: 0.9669
Std Test Accurancy: 0.0458
Std Test AUC: 0.0058
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.0547
Epoch: 0|  Loss:  1.2746 |Global loss: 5.9653| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.6603
Epoch: 1|  Loss:  0.8362 |Global loss: 3.9646| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.6182
Epoch: 2|  Loss:  0.8241 |Global loss: 3.9274| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.5894
Epoch: 3|  Loss:  0.7581 |Global loss: 3.6782| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.8873
Epoch: 0|  Loss:  1.0815 |Global loss: 4.8205| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.7791
Epoch: 1|  Loss:  1.001 |Global loss: 4.1198| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.799
Epoch: 2|  Loss:  1.0727 |Global loss: 4.0706| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.6959
Epoch: 3|  Loss:  0.9295 |Global loss: 3.794| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 0.8854
Epoch: 0|  Loss:  1.1553 |Global loss: 5.5741| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.6606
Epoch: 1|  Loss:  0.9041 |Global loss: 4.2011| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.6382
Epoch: 2|  Loss:  0.884 |Global loss: 4.1394| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.6307
Epoch: 3|  Loss:  0.8323 |Global loss: 3.9034| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.8501
Epoch: 0|  Loss:  1.1389 |Global loss: 5.3407| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.7521
Epoch: 1|  Loss:  1.0407 |Global loss: 4.2622| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.7475
Epoch: 2|  Loss:  1.0284 |Global loss: 4.2086| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.7343
Epoch: 3|  Loss:  1.0542 |Global loss: 3.9938| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.7756
Epoch: 0|  Loss:  0.9148 |Global loss: 5.1347| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.6388
Epoch: 1|  Loss:  0.7896 |Global loss: 4.216| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.642
Epoch: 2|  Loss:  0.7974 |Global loss: 4.1655| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 0.5951
Epoch: 3|  Loss:  0.7463 |Global loss: 3.977| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.8153
Epoch: 0|  Loss:  1.2143 |Global loss: 5.3418| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.7917
Epoch: 1|  Loss:  1.208 |Global loss: 4.4602| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.795
Epoch: 2|  Loss:  1.2 |Global loss: 4.4815| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.784
Epoch: 3|  Loss:  1.1591 |Global loss: 4.1625| Local H loss: 0.0401  | Global H loss: 0.0401
------------------------- time cost ------------------------- 4.781062364578247
Chosen Clients:  [8, 7, 4, 10, 9, 2]

-------------Round number: 127-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.908, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.825, 0.975]
AUC in each clients:  [118.769, 119.389, 119.171, 119.192, 118.508, 118.252, 119.121, 119.512, 118.988, 119.533, 119.339, 119.674, 118.922, 117.119, 119.191]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.876, 0.983, 0.974, 0.981, 0.973, 0.981, 0.973, 0.973, 0.973, 0.822, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.895, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.979, 0.852, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1146
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9601
Averaged Test Recal score: 0.9664
Std Test Accurancy: 0.0412
Std Test AUC: 0.0052
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8283
Epoch: 0|  Loss:  1.0073 |Global loss: 4.7737| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.6508
Epoch: 1|  Loss:  0.8202 |Global loss: 3.7862| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.6381
Epoch: 2|  Loss:  0.8271 |Global loss: 3.6911| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.603
Epoch: 3|  Loss:  0.772 |Global loss: 3.6367| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8986
Epoch: 0|  Loss:  1.1227 |Global loss: 5.2166| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.6254
Epoch: 1|  Loss:  0.7869 |Global loss: 4.0872| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.6121
Epoch: 2|  Loss:  0.7682 |Global loss: 3.8874| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.6121
Epoch: 3|  Loss:  0.7897 |Global loss: 3.8705| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.86
Epoch: 0|  Loss:  1.1616 |Global loss: 5.2607| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.7121
Epoch: 1|  Loss:  1.0204 |Global loss: 4.2684| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.6744
Epoch: 2|  Loss:  1.0018 |Global loss: 4.1491| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.7
Epoch: 3|  Loss:  0.9834 |Global loss: 4.0525| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9164
Epoch: 0|  Loss:  1.1726 |Global loss: 5.8168| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.7211
Epoch: 1|  Loss:  0.8829 |Global loss: 4.3016| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.7045
Epoch: 2|  Loss:  0.8711 |Global loss: 4.2187| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.7007
Epoch: 3|  Loss:  0.8988 |Global loss: 4.1114| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.8066
Epoch: 0|  Loss:  0.9433 |Global loss: 5.3425| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.6455
Epoch: 1|  Loss:  0.7952 |Global loss: 4.2295| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6506
Epoch: 2|  Loss:  0.8005 |Global loss: 4.096| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6047
Epoch: 3|  Loss:  0.7561 |Global loss: 3.9737| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.9091
Epoch: 0|  Loss:  1.2231 |Global loss: 5.8101| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.7874
Epoch: 1|  Loss:  1.099 |Global loss: 4.5182| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.7793
Epoch: 2|  Loss:  1.1748 |Global loss: 4.3573| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.7008
Epoch: 3|  Loss:  0.9812 |Global loss: 4.0846| Local H loss: 0.0377  | Global H loss: 0.0377
------------------------- time cost ------------------------- 5.129992246627808
Chosen Clients:  [7, 12, 3, 2, 4, 8]

-------------Round number: 128-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.942, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.825, 0.975]
AUC in each clients:  [118.769, 119.389, 119.44, 119.192, 118.552, 118.252, 119.121, 119.522, 118.939, 119.469, 119.238, 119.674, 118.922, 117.119, 119.191]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.933, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.973, 0.822, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.936, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.979, 0.852, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1739
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9639
Averaged Test Recal score: 0.9691
Std Test Accurancy: 0.0390
Std Test AUC: 0.0052
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.7892
Epoch: 0|  Loss:  0.9274 |Global loss: 5.1238| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.6094
Epoch: 1|  Loss:  0.765 |Global loss: 4.0189| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6422
Epoch: 2|  Loss:  0.8199 |Global loss: 3.8936| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6552
Epoch: 3|  Loss:  0.8484 |Global loss: 3.9544| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8451
Epoch: 0|  Loss:  1.0877 |Global loss: 4.9158| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6651
Epoch: 1|  Loss:  0.8974 |Global loss: 3.8975| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.7071
Epoch: 2|  Loss:  0.9409 |Global loss: 3.9424| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.6812
Epoch: 3|  Loss:  0.8979 |Global loss: 3.8769| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9036
Epoch: 0|  Loss:  1.0586 |Global loss: 5.3805| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.7443
Epoch: 1|  Loss:  0.9449 |Global loss: 4.4353| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.6979
Epoch: 2|  Loss:  0.8732 |Global loss: 4.0851| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.7029
Epoch: 3|  Loss:  0.8843 |Global loss: 3.9712| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8773
Epoch: 0|  Loss:  1.1889 |Global loss: 5.5534| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.9002
Epoch: 1|  Loss:  1.4433 |Global loss: 4.7459| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.7039
Epoch: 2|  Loss:  0.9933 |Global loss: 4.1284| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.6972
Epoch: 3|  Loss:  0.9875 |Global loss: 4.1255| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8945
Epoch: 0|  Loss:  1.155 |Global loss: 5.2342| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.7525
Epoch: 1|  Loss:  1.0683 |Global loss: 4.2225| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.6678
Epoch: 2|  Loss:  0.9801 |Global loss: 4.0507| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6351
Epoch: 3|  Loss:  0.8686 |Global loss: 3.9257| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9199
Epoch: 0|  Loss:  1.0769 |Global loss: 4.7349| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.604
Epoch: 1|  Loss:  0.7861 |Global loss: 3.6702| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.6691
Epoch: 2|  Loss:  0.9272 |Global loss: 3.8994| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.6033
Epoch: 3|  Loss:  0.7753 |Global loss: 3.7156| Local H loss: 0.0345  | Global H loss: 0.0345
------------------------- time cost ------------------------- 5.075468063354492
Chosen Clients:  [14, 3, 4, 0, 1, 12]

-------------Round number: 129-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.825, 0.975]
AUC in each clients:  [118.769, 119.389, 119.336, 119.132, 118.952, 118.252, 119.121, 119.483, 118.872, 119.469, 119.238, 119.674, 118.667, 117.119, 119.191]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.944, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.947, 0.822, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.949, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.958, 0.852, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2748
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9636
Averaged Test Recal score: 0.9692
Std Test Accurancy: 0.0391
Std Test AUC: 0.0051
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8847
Epoch: 0|  Loss:  1.037 |Global loss: 5.1916| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.6565
Epoch: 1|  Loss:  0.8174 |Global loss: 4.1466| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.7178
Epoch: 2|  Loss:  0.8937 |Global loss: 4.183| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.7154
Epoch: 3|  Loss:  0.9145 |Global loss: 4.1871| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8326
Epoch: 0|  Loss:  0.9907 |Global loss: 5.2212| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.6302
Epoch: 1|  Loss:  0.8027 |Global loss: 3.8666| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.6293
Epoch: 2|  Loss:  0.8165 |Global loss: 3.8409| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.5802
Epoch: 3|  Loss:  0.7636 |Global loss: 3.7549| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.893
Epoch: 0|  Loss:  1.1539 |Global loss: 5.4227| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.7403
Epoch: 1|  Loss:  1.0019 |Global loss: 4.1389| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.7377
Epoch: 2|  Loss:  1.055 |Global loss: 4.2748| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.6903
Epoch: 3|  Loss:  0.9637 |Global loss: 4.0227| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.8139
Epoch: 0|  Loss:  1.0527 |Global loss: 5.2996| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 0.6657
Epoch: 1|  Loss:  0.9004 |Global loss: 3.9796| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.6263
Epoch: 2|  Loss:  0.8395 |Global loss: 3.9579| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.7097
Epoch: 3|  Loss:  0.9411 |Global loss: 3.9316| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.8871
Epoch: 0|  Loss:  1.0241 |Global loss: 5.5738| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.7817
Epoch: 1|  Loss:  0.99 |Global loss: 4.6192| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6355
Epoch: 2|  Loss:  0.7822 |Global loss: 4.4363| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.6559
Epoch: 3|  Loss:  0.8096 |Global loss: 4.2971| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 1.009
Epoch: 0|  Loss:  1.3043 |Global loss: 5.3797| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.765
Epoch: 1|  Loss:  1.0076 |Global loss: 3.9011| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.6875
Epoch: 2|  Loss:  0.9179 |Global loss: 3.6904| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6817
Epoch: 3|  Loss:  0.8983 |Global loss: 3.7341| Local H loss: 0.0331  | Global H loss: 0.0331
------------------------- time cost ------------------------- 4.989404916763306
Chosen Clients:  [9, 5, 10, 13, 11, 6]

-------------Round number: 130-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.958, 0.825, 0.983]
AUC in each clients:  [118.715, 119.405, 119.336, 119.103, 118.607, 118.252, 119.121, 119.483, 118.872, 119.469, 119.238, 119.674, 118.759, 117.119, 119.297]
F1 Score:  [0.983, 0.983, 0.982, 0.983, 0.941, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.959, 0.822, 0.983]
Recall Score:  [0.986, 0.986, 0.984, 0.986, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.967, 0.852, 0.986]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2774
Averaged Test Accurancy: 0.9667
Averaged Test AUC: 0.9914
Averaged Test F1_score: 0.9650
Averaged Test Recal score: 0.9703
Std Test Accurancy: 0.0391
Std Test AUC: 0.0052
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8635
Epoch: 0|  Loss:  0.9957 |Global loss: 5.3845| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.728
Epoch: 1|  Loss:  0.8817 |Global loss: 4.6972| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.6581
Epoch: 2|  Loss:  0.8112 |Global loss: 4.0908| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6492
Epoch: 3|  Loss:  0.8338 |Global loss: 4.1348| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9034
Epoch: 0|  Loss:  1.1535 |Global loss: 5.304| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.7333
Epoch: 1|  Loss:  0.9627 |Global loss: 4.5878| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.6549
Epoch: 2|  Loss:  0.8647 |Global loss: 4.1574| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.6413
Epoch: 3|  Loss:  0.8405 |Global loss: 4.1478| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 1.004
Epoch: 0|  Loss:  1.1491 |Global loss: 5.7391| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.738
Epoch: 1|  Loss:  0.8972 |Global loss: 4.3479| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.6802
Epoch: 2|  Loss:  0.8378 |Global loss: 4.1344| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.6933
Epoch: 3|  Loss:  0.8765 |Global loss: 4.1137| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.9272
Epoch: 0|  Loss:  1.285 |Global loss: 5.3921| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.7483
Epoch: 1|  Loss:  1.1172 |Global loss: 4.2649| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.7626
Epoch: 2|  Loss:  1.1354 |Global loss: 4.124| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.82
Epoch: 3|  Loss:  1.1911 |Global loss: 4.3431| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.0746 |Global loss: 5.2857| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.69
Epoch: 1|  Loss:  0.8505 |Global loss: 4.1439| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.725
Epoch: 2|  Loss:  0.892 |Global loss: 4.2679| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.6899
Epoch: 3|  Loss:  0.8592 |Global loss: 4.1334| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.8115
Epoch: 0|  Loss:  0.9717 |Global loss: 5.2507| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.6851
Epoch: 1|  Loss:  0.8683 |Global loss: 4.4341| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.7037
Epoch: 2|  Loss:  0.8685 |Global loss: 4.2906| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.6316
Epoch: 3|  Loss:  0.7983 |Global loss: 4.0155| Local H loss: 0.0422  | Global H loss: 0.0422
------------------------- time cost ------------------------- 5.190354824066162
Chosen Clients:  [14, 0, 3, 7, 11, 12]

-------------Round number: 131-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.958, 0.8, 0.983]
AUC in each clients:  [118.715, 119.405, 119.336, 119.103, 118.607, 118.24, 119.231, 119.483, 118.872, 119.535, 119.267, 119.643, 118.759, 116.892, 119.297]
F1 Score:  [0.983, 0.983, 0.982, 0.983, 0.941, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.959, 0.763, 0.983]
Recall Score:  [0.986, 0.986, 0.984, 0.986, 0.946, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.967, 0.81, 0.986]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9386
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9617
Averaged Test Recal score: 0.9680
Std Test Accurancy: 0.0454
Std Test AUC: 0.0056
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.7446
Epoch: 0|  Loss:  0.8982 |Global loss: 5.0995| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.6833
Epoch: 1|  Loss:  0.8447 |Global loss: 4.1143| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.6786
Epoch: 2|  Loss:  0.85 |Global loss: 4.1835| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6869
Epoch: 3|  Loss:  0.8769 |Global loss: 4.0018| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 0.6873
Epoch: 0|  Loss:  0.8813 |Global loss: 4.9719| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.5937
Epoch: 1|  Loss:  0.7932 |Global loss: 3.9614| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.6533
Epoch: 2|  Loss:  0.8534 |Global loss: 4.063| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.6174
Epoch: 3|  Loss:  0.8169 |Global loss: 3.8944| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.8583
Epoch: 0|  Loss:  0.999 |Global loss: 5.2468| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.5988
Epoch: 1|  Loss:  0.7547 |Global loss: 3.8519| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.5774
Epoch: 2|  Loss:  0.7403 |Global loss: 3.7591| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.575
Epoch: 3|  Loss:  0.7299 |Global loss: 3.6339| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.8889
Epoch: 0|  Loss:  1.1598 |Global loss: 5.6215| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.6492
Epoch: 1|  Loss:  0.8468 |Global loss: 4.0923| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.6095
Epoch: 2|  Loss:  0.7759 |Global loss: 3.8784| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.5987
Epoch: 3|  Loss:  0.7618 |Global loss: 3.7429| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.8792
Epoch: 0|  Loss:  1.0245 |Global loss: 5.3431| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.7122
Epoch: 1|  Loss:  0.874 |Global loss: 4.2614| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.6971
Epoch: 2|  Loss:  0.8589 |Global loss: 4.0372| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.7043
Epoch: 3|  Loss:  0.8696 |Global loss: 4.0267| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.8871
Epoch: 0|  Loss:  1.1639 |Global loss: 5.2167| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.755
Epoch: 1|  Loss:  1.0146 |Global loss: 4.0635| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.6827
Epoch: 2|  Loss:  0.9067 |Global loss: 3.8983| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.7212
Epoch: 3|  Loss:  0.9666 |Global loss: 3.8351| Local H loss: 0.0314  | Global H loss: 0.0314
------------------------- time cost ------------------------- 5.079004526138306
Chosen Clients:  [6, 11, 1, 10, 9, 12]

-------------Round number: 132-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.933, 0.8, 0.975]
AUC in each clients:  [118.504, 119.405, 119.336, 119.129, 118.607, 118.24, 119.231, 119.561, 118.872, 119.535, 119.267, 119.614, 118.761, 116.892, 119.155]
F1 Score:  [0.956, 0.983, 0.982, 0.973, 0.941, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.938, 0.763, 0.973]
Recall Score:  [0.964, 0.986, 0.984, 0.977, 0.946, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1945
Averaged Test Accurancy: 0.9606
Averaged Test AUC: 0.9912
Averaged Test F1_score: 0.9571
Averaged Test Recal score: 0.9641
Std Test Accurancy: 0.0455
Std Test AUC: 0.0056
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9082
Epoch: 0|  Loss:  1.0788 |Global loss: 5.3315| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 0.648
Epoch: 1|  Loss:  0.8208 |Global loss: 4.1319| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 2|  NKD Loss: 0.6487
Epoch: 2|  Loss:  0.8127 |Global loss: 4.031| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.6216
Epoch: 3|  Loss:  0.7945 |Global loss: 4.0071| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.8812
Epoch: 0|  Loss:  1.033 |Global loss: 5.2764| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.714
Epoch: 1|  Loss:  0.8732 |Global loss: 4.2737| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.7369
Epoch: 2|  Loss:  0.8957 |Global loss: 4.1587| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.6728
Epoch: 3|  Loss:  0.8338 |Global loss: 4.111| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.8076
Epoch: 0|  Loss:  0.9524 |Global loss: 5.4853| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.7595
Epoch: 1|  Loss:  0.9282 |Global loss: 4.6847| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.7462
Epoch: 2|  Loss:  0.9247 |Global loss: 4.4754| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.7096
Epoch: 3|  Loss:  0.8586 |Global loss: 4.3526| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.8913
Epoch: 0|  Loss:  1.0307 |Global loss: 5.5131| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.7733
Epoch: 1|  Loss:  0.9427 |Global loss: 4.4216| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.7467
Epoch: 2|  Loss:  0.9483 |Global loss: 4.1743| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.6935
Epoch: 3|  Loss:  0.8879 |Global loss: 4.1065| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.7422
Epoch: 0|  Loss:  0.8762 |Global loss: 5.1945| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.7149
Epoch: 1|  Loss:  0.8695 |Global loss: 4.4804| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.6428
Epoch: 2|  Loss:  0.7978 |Global loss: 4.1841| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.5993
Epoch: 3|  Loss:  0.7477 |Global loss: 4.0362| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8625
Epoch: 0|  Loss:  1.0639 |Global loss: 4.8321| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.7802
Epoch: 1|  Loss:  1.0403 |Global loss: 4.0508| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.7433
Epoch: 2|  Loss:  0.9541 |Global loss: 3.9576| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.668
Epoch: 3|  Loss:  0.8977 |Global loss: 3.7499| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 5.153857707977295
Chosen Clients:  [11, 1, 10, 13, 4, 3]

-------------Round number: 133-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.942, 0.8, 0.975]
AUC in each clients:  [118.504, 119.487, 119.336, 119.129, 118.607, 118.24, 119.22, 119.561, 118.872, 119.487, 118.918, 119.59, 118.824, 116.892, 119.155]
F1 Score:  [0.956, 0.981, 0.982, 0.973, 0.941, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.974, 0.938, 0.763, 0.973]
Recall Score:  [0.964, 0.984, 0.984, 0.977, 0.946, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.949, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0991
Averaged Test Accurancy: 0.9611
Averaged Test AUC: 0.9910
Averaged Test F1_score: 0.9571
Averaged Test Recal score: 0.9640
Std Test Accurancy: 0.0452
Std Test AUC: 0.0056
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.7811
Epoch: 0|  Loss:  0.9248 |Global loss: 5.276| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.6664
Epoch: 1|  Loss:  0.8242 |Global loss: 4.22| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.6912
Epoch: 2|  Loss:  0.8505 |Global loss: 4.1211| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.6309
Epoch: 3|  Loss:  0.7875 |Global loss: 4.013| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 0|  NKD Loss: 0.8851
Epoch: 0|  Loss:  1.0297 |Global loss: 5.8064| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6693
Epoch: 1|  Loss:  0.8157 |Global loss: 4.4466| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.6421
Epoch: 2|  Loss:  0.7913 |Global loss: 4.3651| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.7394
Epoch: 3|  Loss:  0.9863 |Global loss: 4.4366| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9397
Epoch: 0|  Loss:  1.1374 |Global loss: 5.1944| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.7407
Epoch: 1|  Loss:  0.9354 |Global loss: 4.3803| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.6888
Epoch: 2|  Loss:  0.8517 |Global loss: 4.0966| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.6654
Epoch: 3|  Loss:  0.8448 |Global loss: 4.0552| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9675
Epoch: 0|  Loss:  1.365 |Global loss: 5.7775| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.8484
Epoch: 1|  Loss:  1.2168 |Global loss: 4.6877| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.8344
Epoch: 2|  Loss:  1.175 |Global loss: 4.4262| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.8107
Epoch: 3|  Loss:  1.1781 |Global loss: 4.3864| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8737
Epoch: 0|  Loss:  1.1762 |Global loss: 5.3273| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.7173
Epoch: 1|  Loss:  0.9893 |Global loss: 4.1863| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.746
Epoch: 2|  Loss:  1.0537 |Global loss: 4.0714| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.7082
Epoch: 3|  Loss:  0.9734 |Global loss: 4.1317| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.8931
Epoch: 0|  Loss:  1.0434 |Global loss: 5.1945| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.5654
Epoch: 1|  Loss:  0.7229 |Global loss: 3.8208| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.6053
Epoch: 2|  Loss:  0.7638 |Global loss: 3.7634| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.5703
Epoch: 3|  Loss:  0.7276 |Global loss: 3.6889| Local H loss: 0.0372  | Global H loss: 0.0372
------------------------- time cost ------------------------- 4.69986629486084
Chosen Clients:  [0, 12, 10, 3, 7, 13]

-------------Round number: 134-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.942, 0.85, 0.975]
AUC in each clients:  [118.504, 119.428, 119.336, 119.148, 118.95, 118.24, 119.22, 119.561, 118.872, 119.487, 118.792, 119.63, 118.824, 117.389, 119.155]
F1 Score:  [0.956, 0.981, 0.982, 0.973, 0.944, 0.992, 0.974, 0.981, 0.974, 0.981, 0.982, 0.973, 0.938, 0.853, 0.973]
Recall Score:  [0.964, 0.984, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.949, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9683
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9914
Averaged Test F1_score: 0.9638
Averaged Test Recal score: 0.9701
Std Test Accurancy: 0.0338
Std Test AUC: 0.0047
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7389
Epoch: 0|  Loss:  0.9499 |Global loss: 5.2392| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.6427
Epoch: 1|  Loss:  0.8583 |Global loss: 4.0341| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.6292
Epoch: 2|  Loss:  0.8263 |Global loss: 3.943| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.61
Epoch: 3|  Loss:  0.818 |Global loss: 3.9253| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.8495
Epoch: 0|  Loss:  1.0406 |Global loss: 4.9749| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.7489
Epoch: 1|  Loss:  0.9708 |Global loss: 4.0101| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.7123
Epoch: 2|  Loss:  0.9673 |Global loss: 3.8733| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.6913
Epoch: 3|  Loss:  0.938 |Global loss: 3.9196| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.927
Epoch: 0|  Loss:  1.098 |Global loss: 5.4024| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 0.6969
Epoch: 1|  Loss:  0.858 |Global loss: 4.2945| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.718
Epoch: 2|  Loss:  0.906 |Global loss: 4.2199| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.693
Epoch: 3|  Loss:  0.8786 |Global loss: 4.0149| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.7704
Epoch: 0|  Loss:  0.9097 |Global loss: 5.0203| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.5744
Epoch: 1|  Loss:  0.7269 |Global loss: 3.7793| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.6821
Epoch: 2|  Loss:  0.9023 |Global loss: 3.9051| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.5782
Epoch: 3|  Loss:  0.7377 |Global loss: 3.6507| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.7103
Epoch: 0|  Loss:  0.8656 |Global loss: 4.8048| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.6314
Epoch: 1|  Loss:  0.7877 |Global loss: 4.0622| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.6559
Epoch: 2|  Loss:  0.873 |Global loss: 4.1165| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5868
Epoch: 3|  Loss:  0.7454 |Global loss: 3.8273| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9254
Epoch: 0|  Loss:  1.2752 |Global loss: 5.1997| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.8536
Epoch: 1|  Loss:  1.2085 |Global loss: 4.5631| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.7557
Epoch: 2|  Loss:  1.0934 |Global loss: 4.2641| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.8381
Epoch: 3|  Loss:  1.1611 |Global loss: 4.2536| Local H loss: 0.0381  | Global H loss: 0.0381
------------------------- time cost ------------------------- 4.702257394790649
Chosen Clients:  [11, 0, 1, 4, 14, 8]

-------------Round number: 135-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.983, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.833, 0.975]
AUC in each clients:  [118.814, 119.428, 119.336, 119.15, 118.95, 118.24, 119.22, 119.432, 118.872, 119.487, 118.945, 119.63, 118.998, 117.211, 119.155]
F1 Score:  [0.973, 0.981, 0.982, 0.983, 0.944, 0.992, 0.974, 0.981, 0.974, 0.981, 0.982, 0.973, 0.966, 0.834, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.986, 0.947, 0.993, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.971, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1473
Averaged Test Accurancy: 0.9678
Averaged Test AUC: 0.9916
Averaged Test F1_score: 0.9662
Averaged Test Recal score: 0.9712
Std Test Accurancy: 0.0371
Std Test AUC: 0.0048
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8366
Epoch: 0|  Loss:  0.9696 |Global loss: 5.5636| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.7652
Epoch: 1|  Loss:  0.9166 |Global loss: 4.4669| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.7517
Epoch: 2|  Loss:  0.9082 |Global loss: 4.3785| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.7275
Epoch: 3|  Loss:  0.8848 |Global loss: 4.0955| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 1.0146
Epoch: 0|  Loss:  1.2402 |Global loss: 5.6038| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.6594
Epoch: 1|  Loss:  0.8715 |Global loss: 4.1213| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.6227
Epoch: 2|  Loss:  0.8328 |Global loss: 3.9017| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.6387
Epoch: 3|  Loss:  0.8554 |Global loss: 3.9285| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.791
Epoch: 0|  Loss:  0.9225 |Global loss: 5.4895| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.7191
Epoch: 1|  Loss:  0.9332 |Global loss: 4.5281| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6986
Epoch: 2|  Loss:  0.8507 |Global loss: 4.4191| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.7028
Epoch: 3|  Loss:  0.8601 |Global loss: 4.4011| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8863
Epoch: 0|  Loss:  1.2061 |Global loss: 5.1983| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.716
Epoch: 1|  Loss:  1.0206 |Global loss: 4.3712| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.65
Epoch: 2|  Loss:  0.9178 |Global loss: 4.007| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6354
Epoch: 3|  Loss:  0.9271 |Global loss: 3.8874| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8746
Epoch: 0|  Loss:  1.0259 |Global loss: 5.2671| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6909
Epoch: 1|  Loss:  0.8592 |Global loss: 4.172| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.672
Epoch: 2|  Loss:  0.8367 |Global loss: 3.8738| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6519
Epoch: 3|  Loss:  0.8131 |Global loss: 3.9317| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.7894
Epoch: 0|  Loss:  0.977 |Global loss: 4.9087| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.6252
Epoch: 1|  Loss:  0.8524 |Global loss: 3.6672| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.6458
Epoch: 2|  Loss:  0.8509 |Global loss: 3.6273| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.6778
Epoch: 3|  Loss:  0.916 |Global loss: 3.6629| Local H loss: 0.0347  | Global H loss: 0.0347
------------------------- time cost ------------------------- 4.906989336013794
Chosen Clients:  [12, 3, 7, 0, 9, 14]

-------------Round number: 136-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.942, 0.992, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.833, 0.975]
AUC in each clients:  [118.817, 119.402, 119.336, 119.15, 118.756, 118.24, 119.22, 119.432, 118.848, 119.487, 118.945, 119.586, 118.998, 117.211, 118.973]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.933, 0.992, 0.974, 0.981, 0.974, 0.981, 0.982, 0.974, 0.966, 0.834, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.936, 0.993, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.971, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2474
Averaged Test Accurancy: 0.9678
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9662
Averaged Test Recal score: 0.9711
Std Test Accurancy: 0.0376
Std Test AUC: 0.0048
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.9106
Epoch: 0|  Loss:  1.1428 |Global loss: 5.2225| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.7191
Epoch: 1|  Loss:  0.9297 |Global loss: 4.0101| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.6799
Epoch: 2|  Loss:  0.9038 |Global loss: 3.7501| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.6765
Epoch: 3|  Loss:  0.9011 |Global loss: 3.6742| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.9402
Epoch: 0|  Loss:  1.0803 |Global loss: 5.6324| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.7173
Epoch: 1|  Loss:  0.8664 |Global loss: 4.3257| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6317
Epoch: 2|  Loss:  0.7864 |Global loss: 4.0816| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6215
Epoch: 3|  Loss:  0.7728 |Global loss: 3.9834| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8767
Epoch: 0|  Loss:  1.0251 |Global loss: 5.1629| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6722
Epoch: 1|  Loss:  0.8358 |Global loss: 4.0491| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.638
Epoch: 2|  Loss:  0.7994 |Global loss: 3.7556| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.5944
Epoch: 3|  Loss:  0.7503 |Global loss: 3.7024| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.9183
Epoch: 0|  Loss:  1.1256 |Global loss: 5.205| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.6627
Epoch: 1|  Loss:  0.8669 |Global loss: 3.9716| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.5955
Epoch: 2|  Loss:  0.8071 |Global loss: 3.9034| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.6228
Epoch: 3|  Loss:  0.884 |Global loss: 3.8243| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.8001
Epoch: 0|  Loss:  0.9357 |Global loss: 5.3635| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.7025
Epoch: 1|  Loss:  0.849 |Global loss: 4.3611| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.7873
Epoch: 2|  Loss:  0.9374 |Global loss: 4.6242| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.6795
Epoch: 3|  Loss:  0.8352 |Global loss: 4.3278| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.8216
Epoch: 0|  Loss:  0.9724 |Global loss: 5.1735| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.7015
Epoch: 1|  Loss:  0.9111 |Global loss: 4.1706| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.6788
Epoch: 2|  Loss:  0.8517 |Global loss: 4.0715| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6515
Epoch: 3|  Loss:  0.8146 |Global loss: 3.9367| Local H loss: 0.0334  | Global H loss: 0.0334
------------------------- time cost ------------------------- 4.809444904327393
Chosen Clients:  [1, 7, 8, 0, 6, 12]

-------------Round number: 137-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.942, 0.992, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.833, 0.975]
AUC in each clients:  [118.798, 119.402, 119.336, 119.156, 118.756, 118.24, 119.22, 119.449, 118.848, 119.585, 118.945, 119.586, 118.752, 117.211, 119.078]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.933, 0.992, 0.974, 0.981, 0.974, 0.981, 0.982, 0.974, 0.966, 0.834, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.936, 0.993, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.973, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2892
Averaged Test Accurancy: 0.9678
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9662
Averaged Test Recal score: 0.9712
Std Test Accurancy: 0.0376
Std Test AUC: 0.0049
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8419
Epoch: 0|  Loss:  1.0018 |Global loss: 5.6733| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.7002
Epoch: 1|  Loss:  0.8727 |Global loss: 4.4822| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.6781
Epoch: 2|  Loss:  0.8293 |Global loss: 4.2491| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.6341
Epoch: 3|  Loss:  0.7843 |Global loss: 4.1426| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.8543
Epoch: 0|  Loss:  0.9982 |Global loss: 5.3061| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6193
Epoch: 1|  Loss:  0.7724 |Global loss: 3.8787| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6064
Epoch: 2|  Loss:  0.7667 |Global loss: 3.7671| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.6475
Epoch: 3|  Loss:  0.866 |Global loss: 3.7728| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.7772
Epoch: 0|  Loss:  0.9623 |Global loss: 4.6691| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.6011
Epoch: 1|  Loss:  0.77 |Global loss: 3.6542| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.6985
Epoch: 2|  Loss:  0.9772 |Global loss: 3.8078| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.641
Epoch: 3|  Loss:  0.8783 |Global loss: 3.6817| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9199
Epoch: 0|  Loss:  1.145 |Global loss: 5.5204| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 0.6781
Epoch: 1|  Loss:  0.9031 |Global loss: 4.2045| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.6593
Epoch: 2|  Loss:  0.9333 |Global loss: 4.1888| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 0.6482
Epoch: 3|  Loss:  0.8786 |Global loss: 3.9719| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.944
Epoch: 0|  Loss:  1.1111 |Global loss: 5.3315| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.6564
Epoch: 1|  Loss:  0.8157 |Global loss: 4.439| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.678
Epoch: 2|  Loss:  0.8449 |Global loss: 4.3823| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.6593
Epoch: 3|  Loss:  0.8164 |Global loss: 4.1883| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9756
Epoch: 0|  Loss:  1.2305 |Global loss: 5.0982| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.6896
Epoch: 1|  Loss:  0.9254 |Global loss: 3.8717| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.6764
Epoch: 2|  Loss:  0.8896 |Global loss: 3.7636| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.6683
Epoch: 3|  Loss:  0.8889 |Global loss: 3.7115| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 4.872199296951294
Chosen Clients:  [10, 6, 1, 13, 4, 8]

-------------Round number: 138-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.983, 0.983, 0.942, 0.992, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.975, 0.833, 0.975]
AUC in each clients:  [118.755, 119.44, 119.336, 119.156, 118.756, 118.24, 119.306, 119.245, 118.854, 119.585, 118.945, 119.586, 118.791, 117.211, 119.078]
F1 Score:  [0.991, 0.981, 0.982, 0.983, 0.933, 0.992, 0.974, 0.981, 0.973, 0.981, 0.982, 0.974, 0.976, 0.834, 0.973]
Recall Score:  [0.993, 0.984, 0.984, 0.986, 0.936, 0.993, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.982, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2885
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9673
Averaged Test Recal score: 0.9723
Std Test Accurancy: 0.0379
Std Test AUC: 0.0049
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8901
Epoch: 0|  Loss:  1.0568 |Global loss: 5.4914| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.7331
Epoch: 1|  Loss:  0.9431 |Global loss: 4.4551| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.6969
Epoch: 2|  Loss:  0.8555 |Global loss: 4.1582| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.6843
Epoch: 3|  Loss:  0.8848 |Global loss: 4.0243| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8653
Epoch: 0|  Loss:  1.0317 |Global loss: 5.2345| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.6645
Epoch: 1|  Loss:  0.8267 |Global loss: 4.2333| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.7037
Epoch: 2|  Loss:  0.8875 |Global loss: 4.3811| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.7714
Epoch: 3|  Loss:  0.9382 |Global loss: 4.2266| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.7914
Epoch: 0|  Loss:  0.9347 |Global loss: 5.355| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.7072
Epoch: 1|  Loss:  0.8557 |Global loss: 4.4836| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.667
Epoch: 2|  Loss:  0.8188 |Global loss: 4.2989| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6895
Epoch: 3|  Loss:  0.8804 |Global loss: 4.3019| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.9145
Epoch: 0|  Loss:  1.2639 |Global loss: 5.363| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.732
Epoch: 1|  Loss:  1.074 |Global loss: 4.1369| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.717
Epoch: 2|  Loss:  1.0598 |Global loss: 4.1522| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.7456
Epoch: 3|  Loss:  1.1197 |Global loss: 4.0971| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.9314
Epoch: 0|  Loss:  1.1853 |Global loss: 5.647| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.7195
Epoch: 1|  Loss:  1.0345 |Global loss: 4.1868| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.6827
Epoch: 2|  Loss:  0.9866 |Global loss: 4.1273| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.7234
Epoch: 3|  Loss:  0.9957 |Global loss: 4.2144| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 0.8274
Epoch: 0|  Loss:  1.0169 |Global loss: 4.7623| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.7274
Epoch: 1|  Loss:  0.9858 |Global loss: 3.8596| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6179
Epoch: 2|  Loss:  0.7989 |Global loss: 3.7251| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.6083
Epoch: 3|  Loss:  0.8175 |Global loss: 3.564| Local H loss: 0.0342  | Global H loss: 0.0342
------------------------- time cost ------------------------- 4.8962225914001465
Chosen Clients:  [14, 2, 7, 10, 6, 9]

-------------Round number: 139-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.983, 0.983, 0.925, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.817, 0.975]
AUC in each clients:  [118.755, 119.418, 119.336, 119.156, 118.698, 118.24, 119.305, 119.245, 118.841, 119.585, 118.897, 119.586, 118.791, 117.107, 119.078]
F1 Score:  [0.991, 0.992, 0.982, 0.983, 0.901, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.974, 0.976, 0.807, 0.973]
Recall Score:  [0.993, 0.993, 0.984, 0.986, 0.914, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.982, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2203
Averaged Test Accurancy: 0.9667
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9636
Averaged Test Recal score: 0.9691
Std Test Accurancy: 0.0429
Std Test AUC: 0.0050
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.7918
Epoch: 0|  Loss:  0.9505 |Global loss: 4.9938| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.7369
Epoch: 1|  Loss:  0.8994 |Global loss: 4.0954| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.717
Epoch: 2|  Loss:  0.8898 |Global loss: 4.0285| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.7538
Epoch: 3|  Loss:  0.9066 |Global loss: 3.9877| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0712
Epoch: 0|  Loss:  1.6356 |Global loss: 5.9427| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.8812
Epoch: 1|  Loss:  1.3735 |Global loss: 5.1147| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.7782
Epoch: 2|  Loss:  1.0727 |Global loss: 4.2397| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.7785
Epoch: 3|  Loss:  1.1804 |Global loss: 4.1643| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 0.8456
Epoch: 0|  Loss:  1.0476 |Global loss: 5.5283| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.6527
Epoch: 1|  Loss:  0.8858 |Global loss: 4.1039| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.6283
Epoch: 2|  Loss:  0.8244 |Global loss: 3.9044| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.5901
Epoch: 3|  Loss:  0.7472 |Global loss: 3.6943| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8578
Epoch: 0|  Loss:  0.995 |Global loss: 5.4653| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.7172
Epoch: 1|  Loss:  0.8895 |Global loss: 4.2402| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.6831
Epoch: 2|  Loss:  0.8393 |Global loss: 4.0913| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.6297
Epoch: 3|  Loss:  0.7883 |Global loss: 3.9489| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8199
Epoch: 0|  Loss:  0.9677 |Global loss: 5.3273| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 0.6653
Epoch: 1|  Loss:  0.8231 |Global loss: 4.2766| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.7152
Epoch: 2|  Loss:  0.8771 |Global loss: 4.3462| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.7183
Epoch: 3|  Loss:  0.8893 |Global loss: 4.3556| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.8067
Epoch: 0|  Loss:  0.939 |Global loss: 5.3362| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.6406
Epoch: 1|  Loss:  0.7877 |Global loss: 4.1228| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.6073
Epoch: 2|  Loss:  0.7552 |Global loss: 3.9607| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6245
Epoch: 3|  Loss:  0.777 |Global loss: 4.1012| Local H loss: 0.0324  | Global H loss: 0.0324
------------------------- time cost ------------------------- 5.020901679992676
Chosen Clients:  [14, 10, 9, 6, 8, 7]

-------------Round number: 140-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.967, 0.983, 0.925, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.817, 0.975]
AUC in each clients:  [118.755, 119.418, 119.366, 119.156, 118.698, 118.24, 119.315, 119.36, 118.841, 119.416, 118.842, 119.586, 118.791, 117.107, 119.418]
F1 Score:  [0.991, 0.992, 0.963, 0.983, 0.901, 0.992, 0.974, 0.981, 0.974, 0.981, 0.973, 0.974, 0.976, 0.807, 0.975]
Recall Score:  [0.993, 0.993, 0.967, 0.986, 0.914, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.982, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1534
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9625
Averaged Test Recal score: 0.9679
Std Test Accurancy: 0.0427
Std Test AUC: 0.0051
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8574
Epoch: 0|  Loss:  1.014 |Global loss: 5.2426| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6557
Epoch: 1|  Loss:  0.8158 |Global loss: 3.9625| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.6836
Epoch: 2|  Loss:  0.8764 |Global loss: 4.1079| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.684
Epoch: 3|  Loss:  0.8513 |Global loss: 4.0974| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.8662
Epoch: 0|  Loss:  1.0406 |Global loss: 5.3454| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.6893
Epoch: 1|  Loss:  0.8457 |Global loss: 4.2173| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.6621
Epoch: 2|  Loss:  0.8215 |Global loss: 4.0406| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.6626
Epoch: 3|  Loss:  0.82 |Global loss: 4.0021| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.7546
Epoch: 0|  Loss:  0.8884 |Global loss: 5.1226| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.6743
Epoch: 1|  Loss:  0.8441 |Global loss: 4.2713| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6232
Epoch: 2|  Loss:  0.7763 |Global loss: 4.0381| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.5784
Epoch: 3|  Loss:  0.7282 |Global loss: 3.9768| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8943
Epoch: 0|  Loss:  1.05 |Global loss: 5.4481| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.7039
Epoch: 1|  Loss:  0.8619 |Global loss: 4.2667| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.6759
Epoch: 2|  Loss:  0.8363 |Global loss: 4.1413| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.7251
Epoch: 3|  Loss:  0.8851 |Global loss: 4.263| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.8132
Epoch: 0|  Loss:  0.9652 |Global loss: 4.8043| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.6533
Epoch: 1|  Loss:  0.8425 |Global loss: 3.8038| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.5941
Epoch: 2|  Loss:  0.755 |Global loss: 3.5249| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.5829
Epoch: 3|  Loss:  0.7508 |Global loss: 3.5096| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 0.832
Epoch: 0|  Loss:  0.994 |Global loss: 5.2817| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.6456
Epoch: 1|  Loss:  0.843 |Global loss: 4.1213| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.6048
Epoch: 2|  Loss:  0.7596 |Global loss: 3.8096| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.5879
Epoch: 3|  Loss:  0.7403 |Global loss: 3.8108| Local H loss: 0.0317  | Global H loss: 0.0317
------------------------- time cost ------------------------- 4.827470779418945
Chosen Clients:  [9, 7, 8, 5, 11, 10]

-------------Round number: 141-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.967, 0.983, 0.925, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.817, 0.975]
AUC in each clients:  [118.755, 119.418, 119.366, 119.156, 118.698, 118.24, 119.355, 119.427, 118.868, 119.465, 118.934, 119.586, 118.791, 117.107, 119.151]
F1 Score:  [0.991, 0.992, 0.963, 0.983, 0.901, 0.992, 0.974, 0.981, 0.973, 0.981, 0.973, 0.974, 0.976, 0.807, 0.973]
Recall Score:  [0.993, 0.993, 0.967, 0.986, 0.914, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.982, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1976
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9623
Averaged Test Recal score: 0.9679
Std Test Accurancy: 0.0427
Std Test AUC: 0.0051
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8519
Epoch: 0|  Loss:  0.9868 |Global loss: 5.6408| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.6083
Epoch: 1|  Loss:  0.7449 |Global loss: 4.0951| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.6426
Epoch: 2|  Loss:  0.7968 |Global loss: 4.1565| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.5869
Epoch: 3|  Loss:  0.7342 |Global loss: 4.0136| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.84
Epoch: 0|  Loss:  1.0332 |Global loss: 5.442| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.634
Epoch: 1|  Loss:  0.8151 |Global loss: 4.0179| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.6021
Epoch: 2|  Loss:  0.7659 |Global loss: 3.9097| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.6249
Epoch: 3|  Loss:  0.8064 |Global loss: 3.7235| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.7264
Epoch: 0|  Loss:  0.8904 |Global loss: 4.6786| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.606
Epoch: 1|  Loss:  0.7639 |Global loss: 3.6556| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.6005
Epoch: 2|  Loss:  0.7633 |Global loss: 3.5749| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.642
Epoch: 3|  Loss:  0.8776 |Global loss: 3.6693| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8975
Epoch: 0|  Loss:  1.0829 |Global loss: 5.3137| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.6624
Epoch: 1|  Loss:  0.8996 |Global loss: 4.3968| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.6798
Epoch: 2|  Loss:  0.9147 |Global loss: 4.2183| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.7079
Epoch: 3|  Loss:  1.023 |Global loss: 4.2882| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.8621
Epoch: 0|  Loss:  0.9984 |Global loss: 5.5612| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.657
Epoch: 1|  Loss:  0.8029 |Global loss: 4.1849| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.6598
Epoch: 2|  Loss:  0.8223 |Global loss: 4.1572| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.6349
Epoch: 3|  Loss:  0.7909 |Global loss: 3.9926| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.8827
Epoch: 0|  Loss:  1.0257 |Global loss: 5.8557| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.7293
Epoch: 1|  Loss:  0.8828 |Global loss: 4.3044| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6671
Epoch: 2|  Loss:  0.8244 |Global loss: 4.0179| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.6528
Epoch: 3|  Loss:  0.8086 |Global loss: 3.9055| Local H loss: 0.0363  | Global H loss: 0.0363
------------------------- time cost ------------------------- 4.838265895843506
Chosen Clients:  [12, 3, 9, 7, 11, 8]

-------------Round number: 142-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.967, 0.983, 0.925, 0.983, 0.975, 0.992, 0.975, 0.983, 0.983, 0.975, 0.975, 0.817, 0.975]
AUC in each clients:  [118.755, 119.418, 119.366, 119.156, 118.698, 118.214, 119.355, 119.425, 118.901, 119.48, 118.961, 119.595, 118.791, 117.107, 119.151]
F1 Score:  [0.991, 0.992, 0.963, 0.983, 0.901, 0.983, 0.974, 0.992, 0.974, 0.981, 0.982, 0.973, 0.976, 0.807, 0.973]
Recall Score:  [0.993, 0.993, 0.967, 0.986, 0.914, 0.986, 0.977, 0.993, 0.977, 0.984, 0.984, 0.977, 0.982, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0040
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9630
Averaged Test Recal score: 0.9685
Std Test Accurancy: 0.0429
Std Test AUC: 0.0051
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.8654
Epoch: 0|  Loss:  1.0642 |Global loss: 5.2128| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.7585
Epoch: 1|  Loss:  1.007 |Global loss: 4.2031| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.6608
Epoch: 2|  Loss:  0.88 |Global loss: 3.8503| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.6724
Epoch: 3|  Loss:  0.8895 |Global loss: 3.7565| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 0.8588
Epoch: 0|  Loss:  0.9984 |Global loss: 5.3037| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6022
Epoch: 1|  Loss:  0.7594 |Global loss: 3.84| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.589
Epoch: 2|  Loss:  0.7475 |Global loss: 3.7325| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.5712
Epoch: 3|  Loss:  0.728 |Global loss: 3.5913| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.7306
Epoch: 0|  Loss:  0.8623 |Global loss: 5.2296| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.6082
Epoch: 1|  Loss:  0.7529 |Global loss: 3.9758| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6029
Epoch: 2|  Loss:  0.7493 |Global loss: 3.9792| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6029
Epoch: 3|  Loss:  0.7558 |Global loss: 3.9562| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.7889
Epoch: 0|  Loss:  0.9537 |Global loss: 5.3201| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.6376
Epoch: 1|  Loss:  0.8026 |Global loss: 4.0494| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.5959
Epoch: 2|  Loss:  0.7515 |Global loss: 3.8235| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6353
Epoch: 3|  Loss:  0.8648 |Global loss: 3.8306| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.8599
Epoch: 0|  Loss:  0.9959 |Global loss: 5.3032| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 0.6956
Epoch: 1|  Loss:  0.8461 |Global loss: 4.224| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.6359
Epoch: 2|  Loss:  0.7846 |Global loss: 4.0847| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.6188
Epoch: 3|  Loss:  0.775 |Global loss: 3.8415| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.8942
Epoch: 0|  Loss:  1.0642 |Global loss: 5.0861| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6875
Epoch: 1|  Loss:  0.8759 |Global loss: 3.9857| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.7384
Epoch: 2|  Loss:  0.9147 |Global loss: 3.8138| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.634
Epoch: 3|  Loss:  0.8144 |Global loss: 3.7101| Local H loss: 0.0307  | Global H loss: 0.0307
------------------------- time cost ------------------------- 4.824167728424072
Chosen Clients:  [5, 9, 7, 12, 13, 8]

-------------Round number: 143-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.967, 0.975, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.817, 0.975]
AUC in each clients:  [118.755, 119.418, 119.366, 119.078, 118.698, 118.214, 119.355, 119.43, 119.014, 119.404, 118.961, 119.614, 119.098, 117.107, 119.151]
F1 Score:  [0.991, 0.992, 0.963, 0.973, 0.901, 0.983, 0.974, 0.981, 0.974, 0.981, 0.982, 0.973, 0.965, 0.807, 0.973]
Recall Score:  [0.993, 0.993, 0.967, 0.977, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.971, 0.838, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0331
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9915
Averaged Test F1_score: 0.9609
Averaged Test Recal score: 0.9666
Std Test Accurancy: 0.0423
Std Test AUC: 0.0051
Std Test F1: 0.0004
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.7255
Epoch: 0|  Loss:  0.9622 |Global loss: 5.4062| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.6405
Epoch: 1|  Loss:  0.8622 |Global loss: 4.3029| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6361
Epoch: 2|  Loss:  0.8787 |Global loss: 4.1983| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.5966
Epoch: 3|  Loss:  0.8147 |Global loss: 4.0197| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8236
Epoch: 0|  Loss:  0.964 |Global loss: 5.3182| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6058
Epoch: 1|  Loss:  0.7529 |Global loss: 4.0317| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6226
Epoch: 2|  Loss:  0.7671 |Global loss: 4.0416| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.6349
Epoch: 3|  Loss:  0.7837 |Global loss: 4.0628| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.8321
Epoch: 0|  Loss:  0.9916 |Global loss: 5.001| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6025
Epoch: 1|  Loss:  0.772 |Global loss: 3.8399| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.6095
Epoch: 2|  Loss:  0.7697 |Global loss: 3.746| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.6015
Epoch: 3|  Loss:  0.7648 |Global loss: 3.7324| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.8462
Epoch: 0|  Loss:  1.0439 |Global loss: 5.0898| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.7386
Epoch: 1|  Loss:  0.9522 |Global loss: 3.9331| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.6682
Epoch: 2|  Loss:  0.9153 |Global loss: 3.7887| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.7169
Epoch: 3|  Loss:  0.9637 |Global loss: 3.8548| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0146
Epoch: 0|  Loss:  1.3582 |Global loss: 5.7603| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.7635
Epoch: 1|  Loss:  1.0921 |Global loss: 4.3929| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.741
Epoch: 2|  Loss:  1.0921 |Global loss: 4.2671| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.7976
Epoch: 3|  Loss:  1.1737 |Global loss: 4.3353| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.7508
Epoch: 0|  Loss:  0.8976 |Global loss: 4.9094| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.6637
Epoch: 1|  Loss:  0.882 |Global loss: 3.7156| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.5991
Epoch: 2|  Loss:  0.7788 |Global loss: 3.6293| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6202
Epoch: 3|  Loss:  0.7864 |Global loss: 3.5179| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.845101833343506
Chosen Clients:  [5, 3, 1, 10, 0, 6]

-------------Round number: 144-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.967, 0.975, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.967, 0.8, 0.975]
AUC in each clients:  [118.755, 119.418, 119.366, 119.078, 118.698, 118.252, 119.355, 119.526, 118.711, 119.539, 118.961, 119.614, 118.711, 116.231, 119.151]
F1 Score:  [0.991, 0.992, 0.963, 0.973, 0.901, 0.983, 0.974, 0.981, 0.974, 0.982, 0.982, 0.973, 0.969, 0.763, 0.973]
Recall Score:  [0.993, 0.993, 0.967, 0.977, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.974, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2818
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9908
Averaged Test F1_score: 0.9583
Averaged Test Recal score: 0.9649
Std Test Accurancy: 0.0462
Std Test AUC: 0.0067
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8908
Epoch: 0|  Loss:  1.1219 |Global loss: 6.0515| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.6162
Epoch: 1|  Loss:  0.8086 |Global loss: 4.1317| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.7384
Epoch: 2|  Loss:  1.0055 |Global loss: 4.4265| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.732
Epoch: 3|  Loss:  1.0331 |Global loss: 4.3619| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.7997
Epoch: 0|  Loss:  0.9386 |Global loss: 5.3974| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.6202
Epoch: 1|  Loss:  0.7729 |Global loss: 3.7622| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.5885
Epoch: 2|  Loss:  0.7482 |Global loss: 3.7273| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.5878
Epoch: 3|  Loss:  0.7579 |Global loss: 3.7377| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.8653
Epoch: 0|  Loss:  1.0013 |Global loss: 5.3195| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.6943
Epoch: 1|  Loss:  0.8988 |Global loss: 4.422| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.6479
Epoch: 2|  Loss:  0.8285 |Global loss: 4.345| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6806
Epoch: 3|  Loss:  0.8398 |Global loss: 4.2453| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.8667
Epoch: 0|  Loss:  1.0337 |Global loss: 5.6767| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.6658
Epoch: 1|  Loss:  0.8158 |Global loss: 4.2439| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.6696
Epoch: 2|  Loss:  0.8217 |Global loss: 4.1039| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.6081
Epoch: 3|  Loss:  0.764 |Global loss: 3.8908| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.8625
Epoch: 0|  Loss:  1.1105 |Global loss: 4.9504| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.6398
Epoch: 1|  Loss:  0.8713 |Global loss: 4.0689| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.7724
Epoch: 2|  Loss:  1.0466 |Global loss: 4.3711| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.6887
Epoch: 3|  Loss:  0.9185 |Global loss: 4.005| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.8309
Epoch: 0|  Loss:  0.9784 |Global loss: 5.6617| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.6823
Epoch: 1|  Loss:  0.8394 |Global loss: 4.2196| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.6879
Epoch: 2|  Loss:  0.8662 |Global loss: 4.376| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6852
Epoch: 3|  Loss:  0.866 |Global loss: 4.1711| Local H loss: 0.0377  | Global H loss: 0.0377
------------------------- time cost ------------------------- 5.14385199546814
Chosen Clients:  [14, 8, 3, 1, 7, 5]

-------------Round number: 145-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.967, 0.975, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.8, 0.975]
AUC in each clients:  [118.756, 119.402, 119.366, 119.079, 118.698, 118.284, 119.33, 119.526, 118.711, 119.539, 118.786, 119.614, 118.711, 116.231, 119.151]
F1 Score:  [0.991, 0.981, 0.963, 0.973, 0.901, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.969, 0.763, 0.973]
Recall Score:  [0.993, 0.984, 0.967, 0.977, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.974, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1077
Averaged Test Accurancy: 0.9622
Averaged Test AUC: 0.9907
Averaged Test F1_score: 0.9569
Averaged Test Recal score: 0.9639
Std Test Accurancy: 0.0457
Std Test AUC: 0.0067
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9432
Epoch: 0|  Loss:  1.1116 |Global loss: 5.698| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.7271
Epoch: 1|  Loss:  0.9411 |Global loss: 4.3181| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.7227
Epoch: 2|  Loss:  0.8767 |Global loss: 4.1871| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.735
Epoch: 3|  Loss:  0.8896 |Global loss: 4.1116| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 0.7608
Epoch: 0|  Loss:  0.9354 |Global loss: 4.9446| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.6476
Epoch: 1|  Loss:  0.8751 |Global loss: 3.7561| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.6578
Epoch: 2|  Loss:  0.8477 |Global loss: 3.6126| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6269
Epoch: 3|  Loss:  0.8396 |Global loss: 3.6801| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.88
Epoch: 0|  Loss:  1.0435 |Global loss: 5.4674| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6127
Epoch: 1|  Loss:  0.7669 |Global loss: 3.8989| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6009
Epoch: 2|  Loss:  0.7545 |Global loss: 3.7195| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6291
Epoch: 3|  Loss:  0.8182 |Global loss: 3.8096| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.7774
Epoch: 0|  Loss:  0.9239 |Global loss: 5.6705| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6793
Epoch: 1|  Loss:  0.8243 |Global loss: 4.6954| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.6964
Epoch: 2|  Loss:  0.8444 |Global loss: 4.6956| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.7015
Epoch: 3|  Loss:  0.8627 |Global loss: 4.5721| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 0.7055
Epoch: 0|  Loss:  0.8456 |Global loss: 5.2463| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.6074
Epoch: 1|  Loss:  0.7558 |Global loss: 3.8476| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.6087
Epoch: 2|  Loss:  0.7792 |Global loss: 3.8903| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.5814
Epoch: 3|  Loss:  0.7427 |Global loss: 3.7255| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.7693
Epoch: 0|  Loss:  0.9513 |Global loss: 5.1013| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.6671
Epoch: 1|  Loss:  0.8878 |Global loss: 4.2587| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6249
Epoch: 2|  Loss:  0.8186 |Global loss: 4.0626| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.6154
Epoch: 3|  Loss:  0.8214 |Global loss: 4.0585| Local H loss: 0.0336  | Global H loss: 0.0336
------------------------- time cost ------------------------- 4.924768686294556
Chosen Clients:  [6, 13, 12, 7, 0, 5]

-------------Round number: 146-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.933, 0.967, 0.983, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.8, 0.975]
AUC in each clients:  [118.756, 118.499, 119.366, 119.054, 118.698, 118.372, 119.33, 119.395, 118.77, 119.539, 118.786, 119.614, 118.711, 116.231, 119.386]
F1 Score:  [0.991, 0.887, 0.963, 0.983, 0.901, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.969, 0.763, 0.973]
Recall Score:  [0.993, 0.91, 0.967, 0.986, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.974, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2223
Averaged Test Accurancy: 0.9594
Averaged Test AUC: 0.9903
Averaged Test F1_score: 0.9513
Averaged Test Recal score: 0.9595
Std Test Accurancy: 0.0461
Std Test AUC: 0.0066
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.768
Epoch: 0|  Loss:  0.9104 |Global loss: 5.2223| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.6461
Epoch: 1|  Loss:  0.7982 |Global loss: 4.0437| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.6242
Epoch: 2|  Loss:  0.783 |Global loss: 3.8364| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.6463
Epoch: 3|  Loss:  0.8148 |Global loss: 3.9264| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.8429
Epoch: 0|  Loss:  1.1773 |Global loss: 5.4092| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.7775
Epoch: 1|  Loss:  1.104 |Global loss: 4.2368| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.7542
Epoch: 2|  Loss:  1.0884 |Global loss: 4.1296| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.7439
Epoch: 3|  Loss:  1.0512 |Global loss: 4.1133| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.986
Epoch: 0|  Loss:  1.2352 |Global loss: 5.6556| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.6882
Epoch: 1|  Loss:  0.8958 |Global loss: 4.0387| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.669
Epoch: 2|  Loss:  0.8737 |Global loss: 3.7495| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.6446
Epoch: 3|  Loss:  0.8678 |Global loss: 3.6732| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 0.8948
Epoch: 0|  Loss:  1.0243 |Global loss: 5.6269| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.6159
Epoch: 1|  Loss:  0.7628 |Global loss: 3.9246| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.6128
Epoch: 2|  Loss:  0.7889 |Global loss: 3.8116| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.5973
Epoch: 3|  Loss:  0.7697 |Global loss: 3.6755| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.9362
Epoch: 0|  Loss:  1.1475 |Global loss: 5.5435| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.6429
Epoch: 1|  Loss:  0.8411 |Global loss: 4.1399| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.6113
Epoch: 2|  Loss:  0.8213 |Global loss: 4.0182| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.5885
Epoch: 3|  Loss:  0.8128 |Global loss: 4.0759| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.907
Epoch: 0|  Loss:  1.1293 |Global loss: 5.8911| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.7411
Epoch: 1|  Loss:  0.9809 |Global loss: 4.5316| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.5988
Epoch: 2|  Loss:  0.7874 |Global loss: 3.9872| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 0.5904
Epoch: 3|  Loss:  0.7777 |Global loss: 3.9176| Local H loss: 0.0346  | Global H loss: 0.0346
------------------------- time cost ------------------------- 4.755500078201294
Chosen Clients:  [0, 14, 4, 9, 7, 11]

-------------Round number: 147-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.933, 0.967, 0.983, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.8, 0.975]
AUC in each clients:  [118.691, 118.499, 119.366, 119.054, 118.698, 118.24, 119.313, 119.362, 118.77, 119.539, 118.786, 119.614, 118.692, 115.539, 119.386]
F1 Score:  [0.983, 0.887, 0.963, 0.983, 0.901, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.954, 0.75, 0.973]
Recall Score:  [0.986, 0.91, 0.967, 0.986, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.965, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3033
Averaged Test Accurancy: 0.9578
Averaged Test AUC: 0.9897
Averaged Test F1_score: 0.9489
Averaged Test Recal score: 0.9585
Std Test Accurancy: 0.0458
Std Test AUC: 0.0079
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9094
Epoch: 0|  Loss:  1.0985 |Global loss: 5.0299| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.6504
Epoch: 1|  Loss:  0.8638 |Global loss: 4.1519| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.6292
Epoch: 2|  Loss:  0.8298 |Global loss: 3.7721| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.6113
Epoch: 3|  Loss:  0.848 |Global loss: 3.933| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.8168
Epoch: 0|  Loss:  0.968 |Global loss: 5.1748| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.6888
Epoch: 1|  Loss:  0.8875 |Global loss: 4.1533| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.6512
Epoch: 2|  Loss:  0.8217 |Global loss: 3.9325| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.611
Epoch: 3|  Loss:  0.7677 |Global loss: 3.7956| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.8352
Epoch: 0|  Loss:  1.0645 |Global loss: 5.5258| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.7149
Epoch: 1|  Loss:  0.9396 |Global loss: 4.2882| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.6989
Epoch: 2|  Loss:  0.949 |Global loss: 4.0166| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.7365
Epoch: 3|  Loss:  0.9984 |Global loss: 4.1077| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.8367
Epoch: 0|  Loss:  0.9701 |Global loss: 5.3464| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6712
Epoch: 1|  Loss:  0.8246 |Global loss: 4.3317| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.5584
Epoch: 2|  Loss:  0.7052 |Global loss: 3.7315| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.5946
Epoch: 3|  Loss:  0.7488 |Global loss: 3.8937| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.7457
Epoch: 0|  Loss:  0.9561 |Global loss: 4.8274| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.6286
Epoch: 1|  Loss:  0.8433 |Global loss: 3.9027| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.5872
Epoch: 2|  Loss:  0.7538 |Global loss: 3.6741| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.5847
Epoch: 3|  Loss:  0.7341 |Global loss: 3.6553| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.8128
Epoch: 0|  Loss:  0.9498 |Global loss: 5.5639| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 0.6242
Epoch: 1|  Loss:  0.7657 |Global loss: 4.1182| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.6516
Epoch: 2|  Loss:  0.8171 |Global loss: 4.1496| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.6162
Epoch: 3|  Loss:  0.7678 |Global loss: 3.8976| Local H loss: 0.0394  | Global H loss: 0.0394
------------------------- time cost ------------------------- 4.829607009887695
Chosen Clients:  [13, 5, 3, 6, 12, 10]

-------------Round number: 148-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.933, 0.967, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.95, 0.8, 0.975]
AUC in each clients:  [118.778, 118.499, 119.366, 119.054, 119.147, 118.24, 119.313, 119.414, 118.77, 119.43, 118.786, 119.62, 118.692, 115.539, 119.072]
F1 Score:  [0.983, 0.887, 0.963, 0.983, 0.944, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.954, 0.75, 0.973]
Recall Score:  [0.986, 0.91, 0.967, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.965, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4606
Averaged Test Accurancy: 0.9594
Averaged Test AUC: 0.9898
Averaged Test F1_score: 0.9518
Averaged Test Recal score: 0.9607
Std Test Accurancy: 0.0450
Std Test AUC: 0.0079
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.1549
Epoch: 0|  Loss:  1.5016 |Global loss: 5.7034| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.7144
Epoch: 1|  Loss:  1.0358 |Global loss: 3.9901| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.7721
Epoch: 2|  Loss:  1.0735 |Global loss: 4.0141| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.7159
Epoch: 3|  Loss:  1.0418 |Global loss: 3.9089| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.7852
Epoch: 0|  Loss:  0.9696 |Global loss: 4.8922| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.6183
Epoch: 1|  Loss:  0.809 |Global loss: 4.0697| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6459
Epoch: 2|  Loss:  0.8424 |Global loss: 4.0589| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.5843
Epoch: 3|  Loss:  0.7986 |Global loss: 3.9431| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.8361
Epoch: 0|  Loss:  0.9751 |Global loss: 5.5567| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.5937
Epoch: 1|  Loss:  0.75 |Global loss: 3.8138| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.5898
Epoch: 2|  Loss:  0.741 |Global loss: 3.6475| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.5974
Epoch: 3|  Loss:  0.7549 |Global loss: 3.6569| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.804
Epoch: 0|  Loss:  0.9465 |Global loss: 5.3719| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.6796
Epoch: 1|  Loss:  0.8291 |Global loss: 4.2726| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.6184
Epoch: 2|  Loss:  0.7715 |Global loss: 3.9623| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.6147
Epoch: 3|  Loss:  0.7717 |Global loss: 3.9238| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.9705
Epoch: 0|  Loss:  1.1636 |Global loss: 5.2427| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6005
Epoch: 1|  Loss:  0.804 |Global loss: 3.6906| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.6736
Epoch: 2|  Loss:  0.8746 |Global loss: 3.7892| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.6443
Epoch: 3|  Loss:  0.8504 |Global loss: 3.593| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9389
Epoch: 0|  Loss:  1.1596 |Global loss: 5.4889| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.6953
Epoch: 1|  Loss:  0.8575 |Global loss: 4.3268| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6326
Epoch: 2|  Loss:  0.7834 |Global loss: 4.0238| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.6124
Epoch: 3|  Loss:  0.766 |Global loss: 3.828| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 4.77991795539856
Chosen Clients:  [0, 13, 7, 11, 4, 5]

-------------Round number: 149-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.933, 0.967, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.833, 0.975]
AUC in each clients:  [118.778, 118.499, 119.366, 119.028, 119.147, 118.286, 119.215, 119.414, 118.77, 119.43, 118.845, 119.62, 118.934, 117.576, 119.072]
F1 Score:  [0.983, 0.887, 0.963, 0.983, 0.944, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.982, 0.834, 0.973]
Recall Score:  [0.986, 0.91, 0.967, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.986, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3241
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9593
Averaged Test Recal score: 0.9658
Std Test Accurancy: 0.0375
Std Test AUC: 0.0042
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.1487 |Global loss: 5.8373| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6528
Epoch: 1|  Loss:  0.8575 |Global loss: 4.0321| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.6545
Epoch: 2|  Loss:  0.8771 |Global loss: 3.9679| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6019
Epoch: 3|  Loss:  0.7812 |Global loss: 3.8792| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8291
Epoch: 0|  Loss:  1.117 |Global loss: 5.1258| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.7223
Epoch: 1|  Loss:  1.0049 |Global loss: 4.0813| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.6902
Epoch: 2|  Loss:  0.9856 |Global loss: 3.9945| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.7272
Epoch: 3|  Loss:  1.0344 |Global loss: 4.0652| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.8259
Epoch: 0|  Loss:  0.9761 |Global loss: 5.0256| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6998
Epoch: 1|  Loss:  0.8578 |Global loss: 4.1285| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.6366
Epoch: 2|  Loss:  0.8339 |Global loss: 3.91| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.6094
Epoch: 3|  Loss:  0.7627 |Global loss: 3.6509| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.8689
Epoch: 0|  Loss:  1.0001 |Global loss: 5.4354| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.6951
Epoch: 1|  Loss:  0.847 |Global loss: 4.4169| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.6417
Epoch: 2|  Loss:  0.7905 |Global loss: 4.1164| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.6161
Epoch: 3|  Loss:  0.7707 |Global loss: 4.017| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.8429
Epoch: 0|  Loss:  1.0662 |Global loss: 5.6667| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6959
Epoch: 1|  Loss:  0.9714 |Global loss: 4.3338| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.7143
Epoch: 2|  Loss:  0.9453 |Global loss: 4.2593| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.6583
Epoch: 3|  Loss:  0.9006 |Global loss: 4.0532| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.8765
Epoch: 0|  Loss:  1.0857 |Global loss: 5.9179| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.6825
Epoch: 1|  Loss:  0.896 |Global loss: 4.2659| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.6253
Epoch: 2|  Loss:  0.8524 |Global loss: 4.0665| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.5893
Epoch: 3|  Loss:  0.7717 |Global loss: 3.8536| Local H loss: 0.0351  | Global H loss: 0.0351
------------------------- time cost ------------------------- 5.049638032913208
Chosen Clients:  [6, 3, 9, 10, 2, 1]

-------------Round number: 150-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.933, 0.967, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.8, 0.975]
AUC in each clients:  [118.871, 118.499, 119.366, 119.028, 119.02, 118.389, 119.215, 119.338, 118.77, 119.43, 118.845, 119.635, 118.934, 116.977, 119.072]
F1 Score:  [0.983, 0.887, 0.963, 0.983, 0.944, 0.983, 0.974, 0.982, 0.974, 0.982, 0.973, 0.973, 0.982, 0.763, 0.973]
Recall Score:  [0.986, 0.91, 0.967, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.986, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1955
Averaged Test Accurancy: 0.9617
Averaged Test AUC: 0.9908
Averaged Test F1_score: 0.9546
Averaged Test Recal score: 0.9621
Std Test Accurancy: 0.0453
Std Test AUC: 0.0051
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8354
Epoch: 0|  Loss:  0.9776 |Global loss: 5.7096| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.7062
Epoch: 1|  Loss:  0.8561 |Global loss: 4.4489| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.6594
Epoch: 2|  Loss:  0.8186 |Global loss: 3.9257| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.6248
Epoch: 3|  Loss:  0.7783 |Global loss: 3.9417| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8054
Epoch: 0|  Loss:  0.9393 |Global loss: 5.465| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.5962
Epoch: 1|  Loss:  0.7469 |Global loss: 3.6698| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.5681
Epoch: 2|  Loss:  0.7187 |Global loss: 3.5688| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.5964
Epoch: 3|  Loss:  0.756 |Global loss: 3.6732| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.7884
Epoch: 0|  Loss:  0.9159 |Global loss: 4.9694| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.6197
Epoch: 1|  Loss:  0.7646 |Global loss: 4.0904| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.5916
Epoch: 2|  Loss:  0.7479 |Global loss: 3.9049| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5477
Epoch: 3|  Loss:  0.6911 |Global loss: 3.6641| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8499
Epoch: 0|  Loss:  0.9838 |Global loss: 5.5118| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6915
Epoch: 1|  Loss:  0.8535 |Global loss: 4.2711| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.6593
Epoch: 2|  Loss:  0.8198 |Global loss: 4.0337| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.604
Epoch: 3|  Loss:  0.759 |Global loss: 3.8279| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 1.1179
Epoch: 0|  Loss:  1.4631 |Global loss: 5.9207| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.773
Epoch: 1|  Loss:  1.0625 |Global loss: 4.5351| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.7838
Epoch: 2|  Loss:  1.0506 |Global loss: 4.1715| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.7319
Epoch: 3|  Loss:  1.0756 |Global loss: 4.1487| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.8863
Epoch: 0|  Loss:  1.0498 |Global loss: 5.8174| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.7426
Epoch: 1|  Loss:  0.9074 |Global loss: 4.8225| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.644
Epoch: 2|  Loss:  0.7879 |Global loss: 4.2514| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6457
Epoch: 3|  Loss:  0.8081 |Global loss: 4.1477| Local H loss: 0.0316  | Global H loss: 0.0316
------------------------- time cost ------------------------- 4.795624494552612
Chosen Clients:  [14, 7, 9, 12, 11, 2]

-------------Round number: 151-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.8, 0.975]
AUC in each clients:  [118.871, 119.414, 119.222, 118.964, 119.02, 118.389, 119.303, 119.338, 118.77, 119.352, 118.897, 119.635, 118.934, 116.977, 119.072]
F1 Score:  [0.983, 0.981, 0.981, 0.984, 0.944, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.982, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.986, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9612
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9912
Averaged Test F1_score: 0.9621
Averaged Test Recal score: 0.9681
Std Test Accurancy: 0.0452
Std Test AUC: 0.0050
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.8541
Epoch: 0|  Loss:  1.0068 |Global loss: 5.3759| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.6402
Epoch: 1|  Loss:  0.7969 |Global loss: 3.8072| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6237
Epoch: 2|  Loss:  0.7912 |Global loss: 3.8921| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.6354
Epoch: 3|  Loss:  0.8006 |Global loss: 3.8446| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.7454
Epoch: 0|  Loss:  0.9017 |Global loss: 5.1249| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.6292
Epoch: 1|  Loss:  0.8017 |Global loss: 3.9971| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.5848
Epoch: 2|  Loss:  0.7302 |Global loss: 3.6783| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.625
Epoch: 3|  Loss:  0.8177 |Global loss: 3.7826| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.7521
Epoch: 0|  Loss:  0.8841 |Global loss: 5.1157| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.6737
Epoch: 1|  Loss:  0.8182 |Global loss: 4.2298| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.6011
Epoch: 2|  Loss:  0.7536 |Global loss: 3.9236| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.6268
Epoch: 3|  Loss:  0.7757 |Global loss: 4.0326| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0163
Epoch: 0|  Loss:  1.196 |Global loss: 5.6563| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.6774
Epoch: 1|  Loss:  0.8622 |Global loss: 4.014| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.7097
Epoch: 2|  Loss:  0.9272 |Global loss: 3.8457| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.6495
Epoch: 3|  Loss:  0.8682 |Global loss: 3.6118| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8111
Epoch: 0|  Loss:  0.9426 |Global loss: 6.0931| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.63
Epoch: 1|  Loss:  0.7769 |Global loss: 4.0464| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.6101
Epoch: 2|  Loss:  0.7579 |Global loss: 3.8979| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.5894
Epoch: 3|  Loss:  0.7397 |Global loss: 3.849| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 1.021
Epoch: 0|  Loss:  1.412 |Global loss: 6.1634| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8262
Epoch: 1|  Loss:  1.1588 |Global loss: 4.6296| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.7258
Epoch: 2|  Loss:  1.023 |Global loss: 4.2346| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.8092
Epoch: 3|  Loss:  1.2007 |Global loss: 4.1381| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 5.117722034454346
Chosen Clients:  [14, 5, 8, 12, 6, 4]

-------------Round number: 152-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.8, 0.975]
AUC in each clients:  [118.871, 119.414, 119.305, 118.964, 119.02, 118.389, 119.303, 119.445, 118.77, 119.385, 118.897, 119.63, 118.948, 116.977, 119.083]
F1 Score:  [0.983, 0.981, 0.982, 0.984, 0.944, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.972, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.977, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0613
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9614
Averaged Test Recal score: 0.9675
Std Test Accurancy: 0.0450
Std Test AUC: 0.0051
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 1.091
Epoch: 0|  Loss:  1.3291 |Global loss: 6.6701| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.7763
Epoch: 1|  Loss:  0.935 |Global loss: 4.4245| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.7086
Epoch: 2|  Loss:  0.8643 |Global loss: 4.1833| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.6596
Epoch: 3|  Loss:  0.8175 |Global loss: 4.0166| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.7688
Epoch: 0|  Loss:  0.9511 |Global loss: 5.1256| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.6881
Epoch: 1|  Loss:  0.9069 |Global loss: 4.1644| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.6033
Epoch: 2|  Loss:  0.822 |Global loss: 3.9843| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6518
Epoch: 3|  Loss:  0.8775 |Global loss: 4.0753| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8312
Epoch: 0|  Loss:  0.9847 |Global loss: 4.872| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.6461
Epoch: 1|  Loss:  0.8415 |Global loss: 3.6951| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.5847
Epoch: 2|  Loss:  0.7413 |Global loss: 3.5611| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.6449
Epoch: 3|  Loss:  0.8437 |Global loss: 3.6445| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0757
Epoch: 0|  Loss:  1.2478 |Global loss: 6.4669| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 0.6901
Epoch: 1|  Loss:  0.8774 |Global loss: 3.7128| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.7429
Epoch: 2|  Loss:  0.988 |Global loss: 3.9139| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.7129
Epoch: 3|  Loss:  0.9492 |Global loss: 3.7674| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9331
Epoch: 0|  Loss:  1.096 |Global loss: 5.5776| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.5916
Epoch: 1|  Loss:  0.7443 |Global loss: 3.9705| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.6019
Epoch: 2|  Loss:  0.7566 |Global loss: 3.9215| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.6883
Epoch: 3|  Loss:  0.8553 |Global loss: 3.938| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.8644
Epoch: 0|  Loss:  1.1215 |Global loss: 5.4578| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.647
Epoch: 1|  Loss:  0.8944 |Global loss: 4.0449| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.7062
Epoch: 2|  Loss:  0.9657 |Global loss: 4.1547| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.6963
Epoch: 3|  Loss:  0.9959 |Global loss: 3.9456| Local H loss: 0.0301  | Global H loss: 0.0301
------------------------- time cost ------------------------- 4.787140846252441
Chosen Clients:  [3, 9, 6, 4, 14, 7]

-------------Round number: 153-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.925, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.8, 0.975]
AUC in each clients:  [118.871, 119.414, 119.305, 118.964, 118.612, 118.214, 119.317, 119.445, 118.819, 119.385, 118.897, 119.63, 118.839, 116.977, 119.292]
F1 Score:  [0.983, 0.981, 0.982, 0.984, 0.899, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.983, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.914, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3590
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9911
Averaged Test F1_score: 0.9591
Averaged Test Recal score: 0.9660
Std Test Accurancy: 0.0462
Std Test AUC: 0.0053
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.9948
Epoch: 0|  Loss:  1.161 |Global loss: 5.4531| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.5963
Epoch: 1|  Loss:  0.7712 |Global loss: 3.6921| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.5873
Epoch: 2|  Loss:  0.7545 |Global loss: 3.6169| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.5907
Epoch: 3|  Loss:  0.7548 |Global loss: 3.5498| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.7854
Epoch: 0|  Loss:  0.9117 |Global loss: 5.3538| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.5968
Epoch: 1|  Loss:  0.7398 |Global loss: 3.9399| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.5929
Epoch: 2|  Loss:  0.7379 |Global loss: 3.9175| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5884
Epoch: 3|  Loss:  0.7377 |Global loss: 3.7563| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.8431
Epoch: 0|  Loss:  0.9862 |Global loss: 5.3168| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.6389
Epoch: 1|  Loss:  0.7904 |Global loss: 4.0058| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.6438
Epoch: 2|  Loss:  0.7998 |Global loss: 3.8479| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.6102
Epoch: 3|  Loss:  0.7705 |Global loss: 3.7772| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8022
Epoch: 0|  Loss:  1.0729 |Global loss: 5.2011| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6329
Epoch: 1|  Loss:  0.869 |Global loss: 3.9556| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.65
Epoch: 2|  Loss:  0.9402 |Global loss: 4.0535| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.6383
Epoch: 3|  Loss:  0.9253 |Global loss: 3.881| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 0.8385
Epoch: 0|  Loss:  0.9822 |Global loss: 5.0006| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.6835
Epoch: 1|  Loss:  0.8464 |Global loss: 3.9122| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.6817
Epoch: 2|  Loss:  0.8557 |Global loss: 3.9178| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6582
Epoch: 3|  Loss:  0.8202 |Global loss: 3.7607| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9993
Epoch: 0|  Loss:  1.1532 |Global loss: 6.7996| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 1|  NKD Loss: 0.7968
Epoch: 1|  Loss:  0.967 |Global loss: 5.1435| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 2|  NKD Loss: 0.7397
Epoch: 2|  Loss:  0.9284 |Global loss: 4.476| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.6561
Epoch: 3|  Loss:  0.8011 |Global loss: 4.0893| Local H loss: 0.0273  | Global H loss: 0.0273
------------------------- time cost ------------------------- 4.96476149559021
Chosen Clients:  [11, 13, 0, 4, 10, 3]

-------------Round number: 154-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.8, 0.975]
AUC in each clients:  [118.871, 119.414, 119.305, 118.92, 119.066, 118.214, 119.333, 119.494, 118.819, 119.408, 118.897, 119.63, 118.839, 116.977, 119.232]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.945, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.763, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.948, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.81, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2840
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9913
Averaged Test F1_score: 0.9622
Averaged Test Recal score: 0.9683
Std Test Accurancy: 0.0452
Std Test AUC: 0.0053
Std Test F1: 0.0005
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 0.7822
Epoch: 0|  Loss:  0.9169 |Global loss: 4.9941| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.6169
Epoch: 1|  Loss:  0.7645 |Global loss: 4.0725| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.6358
Epoch: 2|  Loss:  0.7878 |Global loss: 3.9682| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.5857
Epoch: 3|  Loss:  0.7375 |Global loss: 3.7884| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 1.058
Epoch: 0|  Loss:  1.4241 |Global loss: 5.7914| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.8079
Epoch: 1|  Loss:  1.1392 |Global loss: 4.2983| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.7956
Epoch: 2|  Loss:  1.1242 |Global loss: 4.1016| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6821
Epoch: 3|  Loss:  1.0016 |Global loss: 3.8163| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.8762
Epoch: 0|  Loss:  1.1025 |Global loss: 5.5433| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6323
Epoch: 1|  Loss:  0.8266 |Global loss: 4.2264| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6177
Epoch: 2|  Loss:  0.8145 |Global loss: 3.9753| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.5887
Epoch: 3|  Loss:  0.7823 |Global loss: 3.8074| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.773
Epoch: 0|  Loss:  0.9969 |Global loss: 5.2325| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6273
Epoch: 1|  Loss:  0.9045 |Global loss: 3.8524| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.612
Epoch: 2|  Loss:  0.8474 |Global loss: 3.7712| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6267
Epoch: 3|  Loss:  0.8803 |Global loss: 3.7217| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.8596
Epoch: 0|  Loss:  1.0056 |Global loss: 5.4189| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.7124
Epoch: 1|  Loss:  0.8833 |Global loss: 4.2347| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6199
Epoch: 2|  Loss:  0.7752 |Global loss: 3.9138| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.6303
Epoch: 3|  Loss:  0.7872 |Global loss: 3.9348| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.7682
Epoch: 0|  Loss:  0.9066 |Global loss: 4.913| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.6353
Epoch: 1|  Loss:  0.7906 |Global loss: 3.7316| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.5824
Epoch: 2|  Loss:  0.737 |Global loss: 3.5661| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.5812
Epoch: 3|  Loss:  0.7361 |Global loss: 3.5988| Local H loss: 0.033  | Global H loss: 0.033
------------------------- time cost ------------------------- 4.7471466064453125
Chosen Clients:  [13, 2, 5, 7, 10, 8]

-------------Round number: 155-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.983, 0.833, 0.975]
AUC in each clients:  [118.823, 119.414, 119.305, 119.002, 118.881, 118.214, 119.333, 119.494, 118.819, 119.408, 118.978, 119.617, 118.839, 117.435, 119.232]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.944, 0.983, 0.974, 0.982, 0.974, 0.981, 0.982, 0.973, 0.983, 0.834, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.987, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3477
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9916
Averaged Test F1_score: 0.9675
Averaged Test Recal score: 0.9724
Std Test Accurancy: 0.0372
Std Test AUC: 0.0045
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.0213
Epoch: 0|  Loss:  1.2999 |Global loss: 5.5143| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.7729
Epoch: 1|  Loss:  1.0969 |Global loss: 4.2602| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.8095
Epoch: 2|  Loss:  1.1488 |Global loss: 4.1264| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 0.7911
Epoch: 3|  Loss:  1.0958 |Global loss: 4.1394| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 1.0249
Epoch: 0|  Loss:  1.3546 |Global loss: 5.644| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.7939
Epoch: 1|  Loss:  1.0335 |Global loss: 4.343| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.8046
Epoch: 2|  Loss:  1.1118 |Global loss: 4.1829| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.7752
Epoch: 3|  Loss:  1.1572 |Global loss: 4.39| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8188
Epoch: 0|  Loss:  0.9886 |Global loss: 5.2399| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.6061
Epoch: 1|  Loss:  0.7937 |Global loss: 4.0094| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.6646
Epoch: 2|  Loss:  0.8631 |Global loss: 4.0075| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6691
Epoch: 3|  Loss:  0.9494 |Global loss: 4.1242| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8864
Epoch: 0|  Loss:  1.0686 |Global loss: 5.4292| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.664
Epoch: 1|  Loss:  0.8904 |Global loss: 4.0416| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.6056
Epoch: 2|  Loss:  0.7608 |Global loss: 3.6974| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.61
Epoch: 3|  Loss:  0.7683 |Global loss: 3.6574| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.8805
Epoch: 0|  Loss:  1.0194 |Global loss: 5.4565| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.6652
Epoch: 1|  Loss:  0.8326 |Global loss: 4.1272| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6524
Epoch: 2|  Loss:  0.8066 |Global loss: 3.9602| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.6245
Epoch: 3|  Loss:  0.7889 |Global loss: 3.9125| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.8397
Epoch: 0|  Loss:  1.0834 |Global loss: 4.6389| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.6217
Epoch: 1|  Loss:  0.8363 |Global loss: 3.667| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.5706
Epoch: 2|  Loss:  0.7257 |Global loss: 3.5523| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.5938
Epoch: 3|  Loss:  0.7507 |Global loss: 3.446| Local H loss: 0.0334  | Global H loss: 0.0334
------------------------- time cost ------------------------- 4.943928003311157
Chosen Clients:  [3, 2, 12, 6, 10, 11]

-------------Round number: 156-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.823, 119.414, 119.329, 119.002, 118.881, 118.373, 119.333, 119.383, 118.926, 119.408, 118.902, 119.617, 118.839, 117.642, 119.232]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.944, 0.984, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.853, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4805
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9917
Averaged Test F1_score: 0.9682
Averaged Test Recal score: 0.9738
Std Test Accurancy: 0.0330
Std Test AUC: 0.0040
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.0726
Epoch: 0|  Loss:  1.2014 |Global loss: 5.9147| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6042
Epoch: 1|  Loss:  0.7574 |Global loss: 3.7149| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.575
Epoch: 2|  Loss:  0.7242 |Global loss: 3.5606| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.5539
Epoch: 3|  Loss:  0.7033 |Global loss: 3.513| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 1.1262
Epoch: 0|  Loss:  1.5074 |Global loss: 6.1262| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.862
Epoch: 1|  Loss:  1.2605 |Global loss: 4.6185| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.743
Epoch: 2|  Loss:  1.0406 |Global loss: 4.0037| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.7477
Epoch: 3|  Loss:  1.0794 |Global loss: 3.9821| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 1.0627
Epoch: 0|  Loss:  1.2825 |Global loss: 5.5895| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 0.7043
Epoch: 1|  Loss:  0.9083 |Global loss: 3.8634| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.6403
Epoch: 2|  Loss:  0.86 |Global loss: 3.6359| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.628
Epoch: 3|  Loss:  0.8421 |Global loss: 3.6083| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.9562
Epoch: 0|  Loss:  1.0993 |Global loss: 5.7905| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.6573
Epoch: 1|  Loss:  0.8145 |Global loss: 4.0956| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.643
Epoch: 2|  Loss:  0.8023 |Global loss: 3.9593| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.6767
Epoch: 3|  Loss:  0.8349 |Global loss: 3.8875| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.963
Epoch: 0|  Loss:  1.0889 |Global loss: 5.9853| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.7172
Epoch: 1|  Loss:  0.8571 |Global loss: 4.6243| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.7335
Epoch: 2|  Loss:  0.8844 |Global loss: 4.2843| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.6828
Epoch: 3|  Loss:  0.8374 |Global loss: 3.988| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8434
Epoch: 0|  Loss:  0.9716 |Global loss: 5.8465| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.7439
Epoch: 1|  Loss:  0.8863 |Global loss: 4.4281| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6345
Epoch: 2|  Loss:  0.7812 |Global loss: 4.1038| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.6976
Epoch: 3|  Loss:  0.8498 |Global loss: 4.3213| Local H loss: 0.0348  | Global H loss: 0.0348
------------------------- time cost ------------------------- 4.993701457977295
Chosen Clients:  [0, 6, 10, 8, 14, 4]

-------------Round number: 157-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.823, 119.414, 119.15, 118.98, 118.881, 118.373, 119.356, 119.383, 118.926, 119.408, 119.161, 119.638, 118.958, 117.642, 119.232]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.944, 0.984, 0.974, 0.982, 0.974, 0.981, 0.982, 0.973, 0.982, 0.853, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.986, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1600
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9918
Averaged Test F1_score: 0.9681
Averaged Test Recal score: 0.9736
Std Test Accurancy: 0.0330
Std Test AUC: 0.0040
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.9803
Epoch: 0|  Loss:  1.1854 |Global loss: 5.3923| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.6071
Epoch: 1|  Loss:  0.8139 |Global loss: 4.1421| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6474
Epoch: 2|  Loss:  0.8626 |Global loss: 3.9879| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.6076
Epoch: 3|  Loss:  0.8344 |Global loss: 3.9536| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8275
Epoch: 0|  Loss:  0.9728 |Global loss: 5.2259| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.6879
Epoch: 1|  Loss:  0.8466 |Global loss: 4.1006| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.6604
Epoch: 2|  Loss:  0.8138 |Global loss: 3.8973| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.7167
Epoch: 3|  Loss:  0.8847 |Global loss: 4.0219| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.89
Epoch: 0|  Loss:  1.0345 |Global loss: 5.5713| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.6587
Epoch: 1|  Loss:  0.805 |Global loss: 4.0637| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6302
Epoch: 2|  Loss:  0.7802 |Global loss: 3.8149| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.5883
Epoch: 3|  Loss:  0.7383 |Global loss: 3.7042| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.7675
Epoch: 0|  Loss:  0.9137 |Global loss: 4.9663| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.6345
Epoch: 1|  Loss:  0.7938 |Global loss: 3.6692| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.6036
Epoch: 2|  Loss:  0.7678 |Global loss: 3.5434| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.6182
Epoch: 3|  Loss:  0.7991 |Global loss: 3.5064| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.9581
Epoch: 0|  Loss:  1.101 |Global loss: 5.7397| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.7377
Epoch: 1|  Loss:  0.8872 |Global loss: 4.2233| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.6326
Epoch: 2|  Loss:  0.787 |Global loss: 3.8892| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.6808
Epoch: 3|  Loss:  0.8314 |Global loss: 4.0084| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.9312
Epoch: 0|  Loss:  1.2134 |Global loss: 5.5545| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6299
Epoch: 1|  Loss:  0.8473 |Global loss: 3.8143| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6413
Epoch: 2|  Loss:  0.923 |Global loss: 3.9792| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.6843
Epoch: 3|  Loss:  0.9552 |Global loss: 3.9352| Local H loss: 0.0298  | Global H loss: 0.0298
------------------------- time cost ------------------------- 4.943500995635986
Chosen Clients:  [14, 8, 12, 0, 1, 11]

-------------Round number: 158-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.987, 119.414, 119.15, 118.98, 118.704, 118.373, 119.337, 119.383, 118.975, 119.408, 118.915, 119.638, 118.958, 117.642, 119.343]
F1 Score:  [0.991, 0.981, 0.982, 0.973, 0.942, 0.984, 0.974, 0.982, 0.973, 0.981, 0.982, 0.973, 0.982, 0.853, 0.973]
Recall Score:  [0.993, 0.984, 0.984, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.986, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2936
Averaged Test Accurancy: 0.9700
Averaged Test AUC: 0.9918
Averaged Test F1_score: 0.9684
Averaged Test Recal score: 0.9740
Std Test Accurancy: 0.0333
Std Test AUC: 0.0040
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.9556
Epoch: 0|  Loss:  1.0914 |Global loss: 5.7791| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6442
Epoch: 1|  Loss:  0.793 |Global loss: 3.9942| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.7623
Epoch: 2|  Loss:  0.9536 |Global loss: 4.4258| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.6625
Epoch: 3|  Loss:  0.8267 |Global loss: 4.0687| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 0.841
Epoch: 0|  Loss:  0.9906 |Global loss: 4.7181| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6332
Epoch: 1|  Loss:  0.7843 |Global loss: 3.651| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.6743
Epoch: 2|  Loss:  0.8365 |Global loss: 3.6218| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.6621
Epoch: 3|  Loss:  0.921 |Global loss: 3.7183| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9414
Epoch: 0|  Loss:  1.1277 |Global loss: 5.4228| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.6813
Epoch: 1|  Loss:  0.8998 |Global loss: 3.8856| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.7118
Epoch: 2|  Loss:  0.9147 |Global loss: 3.8777| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6884
Epoch: 3|  Loss:  0.9124 |Global loss: 3.6864| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.8677
Epoch: 0|  Loss:  1.0814 |Global loss: 5.4933| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6118
Epoch: 1|  Loss:  0.793 |Global loss: 4.0563| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.5962
Epoch: 2|  Loss:  0.7772 |Global loss: 3.8738| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.6079
Epoch: 3|  Loss:  0.8094 |Global loss: 3.8813| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.8414
Epoch: 0|  Loss:  0.9783 |Global loss: 6.0159| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.7955
Epoch: 1|  Loss:  0.9629 |Global loss: 4.772| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6727
Epoch: 2|  Loss:  0.8206 |Global loss: 4.2622| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.7286
Epoch: 3|  Loss:  0.9398 |Global loss: 4.3798| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.8045
Epoch: 0|  Loss:  0.9495 |Global loss: 5.4842| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.6577
Epoch: 1|  Loss:  0.8032 |Global loss: 3.9791| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.6662
Epoch: 2|  Loss:  0.8143 |Global loss: 3.9981| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.6447
Epoch: 3|  Loss:  0.7955 |Global loss: 4.0167| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 4.768595218658447
Chosen Clients:  [0, 12, 4, 11, 7, 2]

-------------Round number: 159-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.975, 0.85, 0.975]
AUC in each clients:  [118.977, 119.349, 119.15, 118.98, 118.704, 118.373, 119.337, 119.383, 119.091, 119.408, 118.915, 119.635, 119.037, 117.642, 119.275]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.942, 0.984, 0.974, 0.982, 0.974, 0.981, 0.982, 0.973, 0.972, 0.853, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2535
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9918
Averaged Test F1_score: 0.9673
Averaged Test Recal score: 0.9729
Std Test Accurancy: 0.0328
Std Test AUC: 0.0040
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.893
Epoch: 0|  Loss:  1.1213 |Global loss: 5.5209| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.6182
Epoch: 1|  Loss:  0.8107 |Global loss: 4.0613| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.7117
Epoch: 2|  Loss:  0.9491 |Global loss: 4.0532| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.6184
Epoch: 3|  Loss:  0.8131 |Global loss: 3.8672| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 1.0722
Epoch: 0|  Loss:  1.2704 |Global loss: 5.7944| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 0.6795
Epoch: 1|  Loss:  0.8778 |Global loss: 3.8848| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.6757
Epoch: 2|  Loss:  0.8988 |Global loss: 3.8142| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.6169
Epoch: 3|  Loss:  0.813 |Global loss: 3.5242| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.792
Epoch: 0|  Loss:  1.0585 |Global loss: 5.5802| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.6413
Epoch: 1|  Loss:  0.9342 |Global loss: 3.9128| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.6141
Epoch: 2|  Loss:  0.9461 |Global loss: 3.7993| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.617
Epoch: 3|  Loss:  0.8942 |Global loss: 3.7945| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.7615
Epoch: 0|  Loss:  0.8929 |Global loss: 5.0343| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.6152
Epoch: 1|  Loss:  0.7619 |Global loss: 3.8882| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.6577
Epoch: 2|  Loss:  0.8063 |Global loss: 3.876| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.6718
Epoch: 3|  Loss:  0.8213 |Global loss: 3.9585| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9141
Epoch: 0|  Loss:  1.0997 |Global loss: 5.5061| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 0.6159
Epoch: 1|  Loss:  0.7806 |Global loss: 4.0214| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.601
Epoch: 2|  Loss:  0.75 |Global loss: 3.7333| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.6111
Epoch: 3|  Loss:  0.7731 |Global loss: 3.6375| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.877
Epoch: 0|  Loss:  1.1458 |Global loss: 5.2243| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.8105
Epoch: 1|  Loss:  1.1894 |Global loss: 4.407| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.7803
Epoch: 2|  Loss:  1.0816 |Global loss: 4.134| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.6941
Epoch: 3|  Loss:  0.9837 |Global loss: 4.0407| Local H loss: 0.0333  | Global H loss: 0.0333
------------------------- time cost ------------------------- 4.79051399230957
Chosen Clients:  [6, 4, 7, 10, 14, 8]

-------------Round number: 160-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.975, 0.85, 0.975]
AUC in each clients:  [118.909, 119.349, 119.236, 118.98, 118.93, 118.373, 119.337, 119.382, 119.091, 119.408, 118.915, 119.64, 118.98, 117.642, 119.275]
F1 Score:  [0.991, 0.981, 0.982, 0.973, 0.944, 0.984, 0.974, 0.981, 0.974, 0.981, 0.982, 0.973, 0.973, 0.853, 0.973]
Recall Score:  [0.993, 0.984, 0.984, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4643
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9679
Averaged Test Recal score: 0.9735
Std Test Accurancy: 0.0331
Std Test AUC: 0.0039
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8422
Epoch: 0|  Loss:  0.9815 |Global loss: 5.4588| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6517
Epoch: 1|  Loss:  0.8072 |Global loss: 4.1536| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6409
Epoch: 2|  Loss:  0.7941 |Global loss: 3.86| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.6204
Epoch: 3|  Loss:  0.7723 |Global loss: 3.7694| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9385
Epoch: 0|  Loss:  1.1458 |Global loss: 5.5616| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6738
Epoch: 1|  Loss:  0.9476 |Global loss: 3.8986| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.6062
Epoch: 2|  Loss:  0.8389 |Global loss: 3.7604| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.6278
Epoch: 3|  Loss:  0.8953 |Global loss: 3.6338| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.7537
Epoch: 0|  Loss:  0.885 |Global loss: 5.0895| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6707
Epoch: 1|  Loss:  0.879 |Global loss: 3.94| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.6139
Epoch: 2|  Loss:  0.7815 |Global loss: 3.6748| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.5846
Epoch: 3|  Loss:  0.7377 |Global loss: 3.6024| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.8494
Epoch: 0|  Loss:  0.9829 |Global loss: 5.4272| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.7781
Epoch: 1|  Loss:  0.9185 |Global loss: 4.4551| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.7186
Epoch: 2|  Loss:  0.8686 |Global loss: 4.1321| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.6196
Epoch: 3|  Loss:  0.7706 |Global loss: 3.7662| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.867
Epoch: 0|  Loss:  1.0103 |Global loss: 5.0144| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6235
Epoch: 1|  Loss:  0.7718 |Global loss: 3.9908| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.6204
Epoch: 2|  Loss:  0.7806 |Global loss: 3.7298| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6322
Epoch: 3|  Loss:  0.7963 |Global loss: 3.8596| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9752
Epoch: 0|  Loss:  1.2228 |Global loss: 5.3533| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.6231
Epoch: 1|  Loss:  0.7745 |Global loss: 3.6686| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.7986
Epoch: 2|  Loss:  1.1015 |Global loss: 3.985| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.6867
Epoch: 3|  Loss:  0.8849 |Global loss: 3.6194| Local H loss: 0.0288  | Global H loss: 0.0288
------------------------- time cost ------------------------- 4.788532972335815
Chosen Clients:  [2, 12, 4, 11, 3, 13]

-------------Round number: 161-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.975, 0.85, 0.975]
AUC in each clients:  [118.909, 119.349, 119.236, 118.98, 118.952, 118.373, 119.205, 119.285, 119.002, 119.408, 119.123, 119.64, 118.98, 117.642, 119.41]
F1 Score:  [0.991, 0.981, 0.982, 0.973, 0.941, 0.984, 0.974, 0.981, 0.973, 0.981, 0.982, 0.973, 0.973, 0.853, 0.973]
Recall Score:  [0.993, 0.984, 0.984, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6378
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9677
Averaged Test Recal score: 0.9735
Std Test Accurancy: 0.0331
Std Test AUC: 0.0039
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.1058
Epoch: 0|  Loss:  1.3703 |Global loss: 6.127| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.7882
Epoch: 1|  Loss:  0.9933 |Global loss: 4.337| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.7442
Epoch: 2|  Loss:  1.0983 |Global loss: 4.2229| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.6898
Epoch: 3|  Loss:  0.98 |Global loss: 4.0039| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.0201
Epoch: 0|  Loss:  1.2273 |Global loss: 5.906| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.6613
Epoch: 1|  Loss:  0.8744 |Global loss: 3.7639| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.6104
Epoch: 2|  Loss:  0.8099 |Global loss: 3.5385| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.7133
Epoch: 3|  Loss:  0.948 |Global loss: 3.6686| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.8449
Epoch: 0|  Loss:  1.0803 |Global loss: 5.2899| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6773
Epoch: 1|  Loss:  0.9659 |Global loss: 4.1468| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.6461
Epoch: 2|  Loss:  0.9011 |Global loss: 3.8973| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.6275
Epoch: 3|  Loss:  0.8675 |Global loss: 3.7251| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.9055
Epoch: 0|  Loss:  1.0391 |Global loss: 5.4495| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.6673
Epoch: 1|  Loss:  0.8184 |Global loss: 3.8896| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.5999
Epoch: 2|  Loss:  0.7467 |Global loss: 3.8132| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.6572
Epoch: 3|  Loss:  0.8107 |Global loss: 3.9532| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9592
Epoch: 0|  Loss:  1.0928 |Global loss: 5.5929| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6059
Epoch: 1|  Loss:  0.7549 |Global loss: 3.6568| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.562
Epoch: 2|  Loss:  0.7131 |Global loss: 3.5407| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.5733
Epoch: 3|  Loss:  0.7276 |Global loss: 3.4623| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 1.117
Epoch: 0|  Loss:  1.4011 |Global loss: 5.6296| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.7446
Epoch: 1|  Loss:  1.0519 |Global loss: 4.0365| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.703
Epoch: 2|  Loss:  0.9728 |Global loss: 3.9138| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.7083
Epoch: 3|  Loss:  1.0189 |Global loss: 3.7691| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 4.77489709854126
Chosen Clients:  [10, 12, 2, 8, 3, 5]

-------------Round number: 162-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.967, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.975, 0.975, 0.925, 0.975]
AUC in each clients:  [118.909, 119.349, 119.079, 118.997, 118.92, 118.373, 119.205, 119.285, 119.002, 119.408, 119.123, 119.62, 118.979, 118.116, 119.41]
F1 Score:  [0.991, 0.981, 0.966, 0.973, 0.942, 0.984, 0.974, 0.981, 0.973, 0.981, 0.982, 0.973, 0.972, 0.932, 0.973]
Recall Score:  [0.993, 0.984, 0.973, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.984, 0.977, 0.977, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3344
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9719
Averaged Test Recal score: 0.9760
Std Test Accurancy: 0.0159
Std Test AUC: 0.0031
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8919
Epoch: 0|  Loss:  1.0258 |Global loss: 5.4399| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6367
Epoch: 1|  Loss:  0.7782 |Global loss: 4.1427| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.6664
Epoch: 2|  Loss:  0.8292 |Global loss: 4.0133| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.6218
Epoch: 3|  Loss:  0.7793 |Global loss: 3.8469| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.8846
Epoch: 0|  Loss:  1.0806 |Global loss: 5.2951| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.6791
Epoch: 1|  Loss:  0.8685 |Global loss: 3.7138| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.7968
Epoch: 2|  Loss:  1.1123 |Global loss: 3.9547| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.6701
Epoch: 3|  Loss:  0.8921 |Global loss: 3.6073| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.9905
Epoch: 0|  Loss:  1.2339 |Global loss: 5.5293| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.794
Epoch: 1|  Loss:  1.1856 |Global loss: 4.2858| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6991
Epoch: 2|  Loss:  0.9906 |Global loss: 3.9824| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.7216
Epoch: 3|  Loss:  1.0565 |Global loss: 3.9971| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8173
Epoch: 0|  Loss:  1.0061 |Global loss: 4.7985| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6218
Epoch: 1|  Loss:  0.795 |Global loss: 3.6348| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.6424
Epoch: 2|  Loss:  0.8472 |Global loss: 3.6603| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.6983
Epoch: 3|  Loss:  0.9463 |Global loss: 3.7839| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 1.0407
Epoch: 0|  Loss:  1.168 |Global loss: 5.7798| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.6853
Epoch: 1|  Loss:  0.8515 |Global loss: 4.1593| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.6389
Epoch: 2|  Loss:  0.7992 |Global loss: 3.8899| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6181
Epoch: 3|  Loss:  0.7811 |Global loss: 3.7782| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.9163
Epoch: 0|  Loss:  1.1458 |Global loss: 5.5904| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6544
Epoch: 1|  Loss:  0.8594 |Global loss: 4.0839| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.6463
Epoch: 2|  Loss:  0.8918 |Global loss: 3.9024| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6229
Epoch: 3|  Loss:  0.8256 |Global loss: 3.9231| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 4.8444318771362305
Chosen Clients:  [12, 0, 13, 9, 8, 4]

-------------Round number: 163-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.925, 0.975]
AUC in each clients:  [118.909, 119.349, 119.186, 119.128, 118.92, 118.421, 119.205, 119.285, 118.935, 119.408, 119.049, 119.62, 119.016, 118.116, 119.41]
F1 Score:  [0.991, 0.981, 0.974, 0.973, 0.942, 0.983, 0.974, 0.981, 0.974, 0.981, 0.973, 0.973, 0.966, 0.932, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.973, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2415
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.9714
Averaged Test Recal score: 0.9756
Std Test Accurancy: 0.0157
Std Test AUC: 0.0031
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8867
Epoch: 0|  Loss:  1.071 |Global loss: 5.0584| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.6607
Epoch: 1|  Loss:  0.8604 |Global loss: 3.7415| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.7436
Epoch: 2|  Loss:  0.9395 |Global loss: 3.8661| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.6554
Epoch: 3|  Loss:  0.8562 |Global loss: 3.5883| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.8551
Epoch: 0|  Loss:  1.0404 |Global loss: 5.3953| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.6255
Epoch: 1|  Loss:  0.8144 |Global loss: 4.0687| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6712
Epoch: 2|  Loss:  0.872 |Global loss: 4.0092| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.7252
Epoch: 3|  Loss:  0.996 |Global loss: 4.213| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9312
Epoch: 0|  Loss:  1.2099 |Global loss: 5.3399| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.7765
Epoch: 1|  Loss:  1.0696 |Global loss: 3.9962| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.7135
Epoch: 2|  Loss:  1.0365 |Global loss: 3.8229| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.7188
Epoch: 3|  Loss:  1.0392 |Global loss: 4.0389| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.8487
Epoch: 0|  Loss:  0.9782 |Global loss: 5.2722| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.6031
Epoch: 1|  Loss:  0.7463 |Global loss: 3.9572| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.6949
Epoch: 2|  Loss:  0.8403 |Global loss: 3.9948| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.6123
Epoch: 3|  Loss:  0.7581 |Global loss: 3.7447| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.8528
Epoch: 0|  Loss:  1.048 |Global loss: 4.7575| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.6981
Epoch: 1|  Loss:  0.9048 |Global loss: 3.7685| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.6578
Epoch: 2|  Loss:  0.8491 |Global loss: 3.5817| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.6226
Epoch: 3|  Loss:  0.8461 |Global loss: 3.4791| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.7446
Epoch: 0|  Loss:  1.0341 |Global loss: 4.8329| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6275
Epoch: 1|  Loss:  0.8543 |Global loss: 3.8769| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.6481
Epoch: 2|  Loss:  0.9297 |Global loss: 3.8991| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.6251
Epoch: 3|  Loss:  0.8649 |Global loss: 3.7751| Local H loss: 0.0297  | Global H loss: 0.0297
------------------------- time cost ------------------------- 4.922512769699097
Chosen Clients:  [13, 2, 7, 0, 9, 6]

-------------Round number: 164-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.983, 0.975, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.842, 0.975]
AUC in each clients:  [118.748, 119.349, 119.186, 119.128, 118.949, 118.421, 119.205, 119.285, 118.877, 119.494, 119.049, 119.62, 118.966, 117.706, 119.41]
F1 Score:  [0.956, 0.981, 0.974, 0.973, 0.944, 0.983, 0.974, 0.981, 0.974, 0.982, 0.973, 0.973, 0.983, 0.844, 0.973]
Recall Score:  [0.964, 0.984, 0.978, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.88, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5764
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9645
Averaged Test Recal score: 0.9704
Std Test Accurancy: 0.0347
Std Test AUC: 0.0038
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.9358
Epoch: 0|  Loss:  1.2163 |Global loss: 5.0353| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.7564
Epoch: 1|  Loss:  1.0553 |Global loss: 4.2468| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.7326
Epoch: 2|  Loss:  1.0006 |Global loss: 3.846| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.7379
Epoch: 3|  Loss:  1.0184 |Global loss: 4.0085| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.0075
Epoch: 0|  Loss:  1.2683 |Global loss: 6.344| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.7442
Epoch: 1|  Loss:  1.0361 |Global loss: 4.2834| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.7522
Epoch: 2|  Loss:  0.9621 |Global loss: 3.9953| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.854
Epoch: 3|  Loss:  1.2493 |Global loss: 4.2312| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.8964
Epoch: 0|  Loss:  1.0722 |Global loss: 5.0777| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.6203
Epoch: 1|  Loss:  0.7701 |Global loss: 3.8993| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.6178
Epoch: 2|  Loss:  0.8007 |Global loss: 3.7122| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.6162
Epoch: 3|  Loss:  0.7822 |Global loss: 3.5708| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.9222
Epoch: 0|  Loss:  1.1527 |Global loss: 5.571| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6771
Epoch: 1|  Loss:  0.8637 |Global loss: 3.8841| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.6229
Epoch: 2|  Loss:  0.8113 |Global loss: 4.1173| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.6585
Epoch: 3|  Loss:  0.8767 |Global loss: 4.0844| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.7778
Epoch: 0|  Loss:  0.9149 |Global loss: 4.8493| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.5973
Epoch: 1|  Loss:  0.7441 |Global loss: 3.944| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.5581
Epoch: 2|  Loss:  0.7158 |Global loss: 3.7139| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.5846
Epoch: 3|  Loss:  0.7358 |Global loss: 3.6277| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8757
Epoch: 0|  Loss:  1.0096 |Global loss: 5.5047| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.6931
Epoch: 1|  Loss:  0.8429 |Global loss: 4.2188| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6623
Epoch: 2|  Loss:  0.816 |Global loss: 3.9033| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.6976
Epoch: 3|  Loss:  0.8514 |Global loss: 4.0061| Local H loss: 0.0348  | Global H loss: 0.0348
------------------------- time cost ------------------------- 4.804856538772583
Chosen Clients:  [9, 11, 4, 2, 0, 14]

-------------Round number: 165-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.858, 0.975]
AUC in each clients:  [118.823, 119.349, 119.417, 119.128, 118.949, 118.421, 119.298, 119.474, 118.877, 119.398, 119.049, 119.62, 118.966, 117.444, 119.41]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.944, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.862, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.874, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3517
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9920
Averaged Test F1_score: 0.9681
Averaged Test Recal score: 0.9719
Std Test Accurancy: 0.0308
Std Test AUC: 0.0044
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7184
Epoch: 0|  Loss:  0.8559 |Global loss: 4.5584| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.5773
Epoch: 1|  Loss:  0.7264 |Global loss: 3.6871| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.5611
Epoch: 2|  Loss:  0.7091 |Global loss: 3.6233| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.549
Epoch: 3|  Loss:  0.7016 |Global loss: 3.6825| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.8438
Epoch: 0|  Loss:  0.9741 |Global loss: 5.6211| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.601
Epoch: 1|  Loss:  0.753 |Global loss: 3.833| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.6358
Epoch: 2|  Loss:  0.7844 |Global loss: 3.8748| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.5947
Epoch: 3|  Loss:  0.7443 |Global loss: 3.7065| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.911
Epoch: 0|  Loss:  1.1911 |Global loss: 5.4377| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.6151
Epoch: 1|  Loss:  0.8677 |Global loss: 3.7181| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6444
Epoch: 2|  Loss:  0.9444 |Global loss: 3.7747| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.6326
Epoch: 3|  Loss:  0.9101 |Global loss: 3.6721| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0469
Epoch: 0|  Loss:  1.3887 |Global loss: 5.6812| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.7394
Epoch: 1|  Loss:  1.0005 |Global loss: 4.2159| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.7521
Epoch: 2|  Loss:  1.0618 |Global loss: 4.1316| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.8159
Epoch: 3|  Loss:  1.1689 |Global loss: 4.0529| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8628
Epoch: 0|  Loss:  1.0541 |Global loss: 5.4495| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.643
Epoch: 1|  Loss:  0.8324 |Global loss: 4.0803| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.5763
Epoch: 2|  Loss:  0.7677 |Global loss: 3.8578| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.5632
Epoch: 3|  Loss:  0.7463 |Global loss: 3.6485| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.848
Epoch: 0|  Loss:  0.9811 |Global loss: 5.5583| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6203
Epoch: 1|  Loss:  0.785 |Global loss: 3.9104| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5732
Epoch: 2|  Loss:  0.7338 |Global loss: 3.6405| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.5919
Epoch: 3|  Loss:  0.7532 |Global loss: 3.6565| Local H loss: 0.0322  | Global H loss: 0.0322
------------------------- time cost ------------------------- 4.931427240371704
Chosen Clients:  [12, 14, 7, 3, 2, 6]

-------------Round number: 166-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.858, 0.975]
AUC in each clients:  [118.873, 119.349, 119.183, 119.128, 118.852, 118.421, 119.298, 119.474, 118.877, 119.375, 119.049, 119.633, 118.966, 117.444, 119.348]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.862, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.874, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9525
Averaged Test Accurancy: 0.9700
Averaged Test AUC: 0.9918
Averaged Test F1_score: 0.9686
Averaged Test Recal score: 0.9725
Std Test Accurancy: 0.0306
Std Test AUC: 0.0043
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.1669
Epoch: 0|  Loss:  1.3323 |Global loss: 6.2892| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 0.7092
Epoch: 1|  Loss:  0.9012 |Global loss: 3.7538| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.709
Epoch: 2|  Loss:  0.9483 |Global loss: 3.8716| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.6562
Epoch: 3|  Loss:  0.8679 |Global loss: 3.7059| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 1.0316
Epoch: 0|  Loss:  1.1659 |Global loss: 5.6877| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5958
Epoch: 1|  Loss:  0.7499 |Global loss: 3.8376| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.5988
Epoch: 2|  Loss:  0.7685 |Global loss: 3.7851| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.5719
Epoch: 3|  Loss:  0.7242 |Global loss: 3.5529| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.0219
Epoch: 0|  Loss:  1.1488 |Global loss: 5.8763| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.6411
Epoch: 1|  Loss:  0.7828 |Global loss: 3.7164| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6199
Epoch: 2|  Loss:  0.7685 |Global loss: 3.6132| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.6292
Epoch: 3|  Loss:  0.7798 |Global loss: 3.5698| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0239
Epoch: 0|  Loss:  1.1857 |Global loss: 5.949| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 0.615
Epoch: 1|  Loss:  0.7706 |Global loss: 3.7466| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.5652
Epoch: 2|  Loss:  0.7217 |Global loss: 3.567| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.5725
Epoch: 3|  Loss:  0.7266 |Global loss: 3.4517| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9865
Epoch: 0|  Loss:  1.2515 |Global loss: 5.4985| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.7347
Epoch: 1|  Loss:  0.9426 |Global loss: 4.0394| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6652
Epoch: 2|  Loss:  0.8627 |Global loss: 3.7718| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.7365
Epoch: 3|  Loss:  0.9816 |Global loss: 3.9128| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9564
Epoch: 0|  Loss:  1.0973 |Global loss: 5.7669| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.7322
Epoch: 1|  Loss:  0.8835 |Global loss: 4.2198| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.7015
Epoch: 2|  Loss:  0.8573 |Global loss: 4.0116| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.674
Epoch: 3|  Loss:  0.8313 |Global loss: 3.9239| Local H loss: 0.0346  | Global H loss: 0.0346
------------------------- time cost ------------------------- 4.813728332519531
Chosen Clients:  [2, 14, 7, 9, 8, 3]

-------------Round number: 167-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.858, 0.975]
AUC in each clients:  [118.873, 119.349, 119.423, 119.075, 118.852, 118.421, 119.317, 119.439, 118.877, 119.375, 119.049, 119.633, 118.957, 117.444, 119.354]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.862, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.874, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6866
Averaged Test Accurancy: 0.9700
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9686
Averaged Test Recal score: 0.9725
Std Test Accurancy: 0.0306
Std Test AUC: 0.0043
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.0433
Epoch: 0|  Loss:  1.2753 |Global loss: 5.6983| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.7635
Epoch: 1|  Loss:  1.0558 |Global loss: 4.0682| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.7189
Epoch: 2|  Loss:  0.9741 |Global loss: 3.8883| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.7981
Epoch: 3|  Loss:  1.1411 |Global loss: 4.0191| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.8538
Epoch: 0|  Loss:  1.0021 |Global loss: 5.4716| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6538
Epoch: 1|  Loss:  0.8222 |Global loss: 3.9871| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.6771
Epoch: 2|  Loss:  0.8387 |Global loss: 3.9877| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.6512
Epoch: 3|  Loss:  0.8103 |Global loss: 3.7921| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.8851
Epoch: 0|  Loss:  1.0197 |Global loss: 5.6348| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 0.6129
Epoch: 1|  Loss:  0.7587 |Global loss: 3.7292| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.6041
Epoch: 2|  Loss:  0.7515 |Global loss: 3.5189| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.6047
Epoch: 3|  Loss:  0.7563 |Global loss: 3.5597| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.9449
Epoch: 0|  Loss:  1.0712 |Global loss: 5.4137| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6083
Epoch: 1|  Loss:  0.7529 |Global loss: 3.7401| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.5909
Epoch: 2|  Loss:  0.739 |Global loss: 3.7257| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.607
Epoch: 3|  Loss:  0.7707 |Global loss: 3.7619| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.8943
Epoch: 0|  Loss:  1.056 |Global loss: 4.8462| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.7233
Epoch: 1|  Loss:  0.8784 |Global loss: 3.7914| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.678
Epoch: 2|  Loss:  0.8394 |Global loss: 3.5712| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.6371
Epoch: 3|  Loss:  0.837 |Global loss: 3.56| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9767
Epoch: 0|  Loss:  1.1262 |Global loss: 5.6853| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.5952
Epoch: 1|  Loss:  0.7428 |Global loss: 3.6549| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.6595
Epoch: 2|  Loss:  0.8334 |Global loss: 3.9331| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.5844
Epoch: 3|  Loss:  0.7406 |Global loss: 3.6142| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 4.932766437530518
Chosen Clients:  [9, 5, 4, 2, 13, 8]

-------------Round number: 168-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.958, 0.983, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.858, 0.975]
AUC in each clients:  [118.873, 119.349, 119.159, 119.049, 118.852, 118.421, 119.317, 119.432, 118.968, 119.429, 119.049, 119.633, 118.957, 117.444, 119.476]
F1 Score:  [0.983, 0.981, 0.956, 0.983, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.862, 0.973]
Recall Score:  [0.986, 0.984, 0.959, 0.986, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.874, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4962
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9675
Averaged Test Recal score: 0.9714
Std Test Accurancy: 0.0307
Std Test AUC: 0.0043
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7623
Epoch: 0|  Loss:  0.8965 |Global loss: 4.9592| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6143
Epoch: 1|  Loss:  0.7606 |Global loss: 3.8575| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.6292
Epoch: 2|  Loss:  0.7884 |Global loss: 3.6954| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.5877
Epoch: 3|  Loss:  0.7389 |Global loss: 3.5777| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.8682
Epoch: 0|  Loss:  1.0819 |Global loss: 5.4253| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.5968
Epoch: 1|  Loss:  0.7919 |Global loss: 3.8103| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.5943
Epoch: 2|  Loss:  0.792 |Global loss: 3.7495| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.6316
Epoch: 3|  Loss:  0.8202 |Global loss: 3.708| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.8269
Epoch: 0|  Loss:  1.063 |Global loss: 5.3526| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.6452
Epoch: 1|  Loss:  0.8709 |Global loss: 4.0214| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.658
Epoch: 2|  Loss:  0.8987 |Global loss: 4.0204| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.6576
Epoch: 3|  Loss:  0.9106 |Global loss: 3.8919| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9993
Epoch: 0|  Loss:  1.2697 |Global loss: 5.5742| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.7706
Epoch: 1|  Loss:  1.0776 |Global loss: 4.2423| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.8176
Epoch: 2|  Loss:  1.2723 |Global loss: 4.1466| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.8116
Epoch: 3|  Loss:  1.2534 |Global loss: 3.9381| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.9656
Epoch: 0|  Loss:  1.2214 |Global loss: 5.7187| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.7032
Epoch: 1|  Loss:  0.9741 |Global loss: 3.9363| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.7403
Epoch: 2|  Loss:  1.0442 |Global loss: 4.0163| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.7158
Epoch: 3|  Loss:  0.9833 |Global loss: 3.8936| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.8046
Epoch: 0|  Loss:  1.0064 |Global loss: 4.5769| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.6108
Epoch: 1|  Loss:  0.7615 |Global loss: 3.4976| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.6597
Epoch: 2|  Loss:  0.899 |Global loss: 3.546| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6678
Epoch: 3|  Loss:  0.8699 |Global loss: 3.6107| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 4.857412815093994
Chosen Clients:  [7, 11, 1, 0, 9, 12]

-------------Round number: 169-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.873, 119.349, 119.186, 119.049, 118.998, 118.449, 119.317, 119.432, 118.921, 119.398, 119.049, 119.633, 118.957, 117.931, 119.476]
F1 Score:  [0.983, 0.981, 0.982, 0.983, 0.944, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.853, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9889
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.9681
Averaged Test Recal score: 0.9738
Std Test Accurancy: 0.0330
Std Test AUC: 0.0035
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8271
Epoch: 0|  Loss:  0.9617 |Global loss: 4.9667| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.6476
Epoch: 1|  Loss:  0.8123 |Global loss: 3.7216| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.6575
Epoch: 2|  Loss:  0.8304 |Global loss: 3.6136| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.5801
Epoch: 3|  Loss:  0.7353 |Global loss: 3.408| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.901
Epoch: 0|  Loss:  1.0319 |Global loss: 5.3739| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.6093
Epoch: 1|  Loss:  0.754 |Global loss: 3.9095| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.5977
Epoch: 2|  Loss:  0.7466 |Global loss: 3.7631| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.6016
Epoch: 3|  Loss:  0.7531 |Global loss: 3.7192| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9166
Epoch: 0|  Loss:  1.0599 |Global loss: 5.6281| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6642
Epoch: 1|  Loss:  0.8178 |Global loss: 4.3423| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.6971
Epoch: 2|  Loss:  0.8523 |Global loss: 4.3817| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.622
Epoch: 3|  Loss:  0.7738 |Global loss: 3.8499| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9306
Epoch: 0|  Loss:  1.1052 |Global loss: 5.379| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.6215
Epoch: 1|  Loss:  0.8163 |Global loss: 4.0323| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6367
Epoch: 2|  Loss:  0.8433 |Global loss: 3.8097| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6422
Epoch: 3|  Loss:  0.8419 |Global loss: 3.6393| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.8213
Epoch: 0|  Loss:  0.9501 |Global loss: 4.9584| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.5793
Epoch: 1|  Loss:  0.7219 |Global loss: 3.7406| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.6155
Epoch: 2|  Loss:  0.7666 |Global loss: 3.8731| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.5402
Epoch: 3|  Loss:  0.6912 |Global loss: 3.5923| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.0875
Epoch: 0|  Loss:  1.276 |Global loss: 5.3231| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.7248
Epoch: 1|  Loss:  0.9644 |Global loss: 3.9248| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.6668
Epoch: 2|  Loss:  0.8543 |Global loss: 3.7245| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.7053
Epoch: 3|  Loss:  0.9277 |Global loss: 3.9128| Local H loss: 0.0262  | Global H loss: 0.0262
------------------------- time cost ------------------------- 5.154207944869995
Chosen Clients:  [5, 12, 8, 13, 10, 9]

-------------Round number: 170-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.983, 0.95, 0.983, 0.975, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.85, 0.975]
AUC in each clients:  [118.948, 119.361, 119.186, 119.049, 118.998, 118.449, 119.317, 119.427, 118.921, 119.308, 119.049, 119.62, 118.995, 117.931, 119.476]
F1 Score:  [0.983, 0.992, 0.982, 0.983, 0.944, 0.983, 0.974, 0.992, 0.974, 0.981, 0.973, 0.973, 0.984, 0.853, 0.973]
Recall Score:  [0.986, 0.993, 0.984, 0.986, 0.947, 0.986, 0.977, 0.993, 0.977, 0.984, 0.977, 0.977, 0.986, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7243
Averaged Test Accurancy: 0.9706
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.9696
Averaged Test Recal score: 0.9749
Std Test Accurancy: 0.0336
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7628
Epoch: 0|  Loss:  0.9415 |Global loss: 5.0492| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.5522
Epoch: 1|  Loss:  0.7264 |Global loss: 3.7208| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.5932
Epoch: 2|  Loss:  0.7842 |Global loss: 3.7051| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6091
Epoch: 3|  Loss:  0.7823 |Global loss: 3.6204| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9894
Epoch: 0|  Loss:  1.1848 |Global loss: 5.0931| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.6681
Epoch: 1|  Loss:  0.8474 |Global loss: 3.6528| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.662
Epoch: 2|  Loss:  0.8404 |Global loss: 3.499| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6521
Epoch: 3|  Loss:  0.8415 |Global loss: 3.479| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.8455
Epoch: 0|  Loss:  1.0159 |Global loss: 4.8233| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5874
Epoch: 1|  Loss:  0.7752 |Global loss: 3.6725| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.6839
Epoch: 2|  Loss:  0.8934 |Global loss: 3.5174| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6918
Epoch: 3|  Loss:  0.8588 |Global loss: 3.5045| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9844
Epoch: 0|  Loss:  1.2746 |Global loss: 5.1865| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.7636
Epoch: 1|  Loss:  1.0265 |Global loss: 4.1451| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.7309
Epoch: 2|  Loss:  1.0361 |Global loss: 3.9303| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.7561
Epoch: 3|  Loss:  1.092 |Global loss: 3.9823| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.005
Epoch: 0|  Loss:  1.1602 |Global loss: 6.0203| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.7246
Epoch: 1|  Loss:  0.8935 |Global loss: 4.3453| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.6603
Epoch: 2|  Loss:  0.8073 |Global loss: 3.9047| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.5806
Epoch: 3|  Loss:  0.7308 |Global loss: 3.7242| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 0.7985
Epoch: 0|  Loss:  0.9365 |Global loss: 4.8296| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.6028
Epoch: 1|  Loss:  0.7495 |Global loss: 3.7456| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.5674
Epoch: 2|  Loss:  0.7178 |Global loss: 3.4657| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.5756
Epoch: 3|  Loss:  0.7279 |Global loss: 3.5084| Local H loss: 0.0321  | Global H loss: 0.0321
------------------------- time cost ------------------------- 4.788414001464844
Chosen Clients:  [2, 0, 13, 4, 10, 12]

-------------Round number: 171-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.983, 0.95, 0.983, 0.975, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.825, 0.975]
AUC in each clients:  [118.948, 119.361, 119.186, 119.049, 118.998, 118.47, 119.317, 119.427, 118.87, 119.274, 118.907, 119.62, 118.931, 117.404, 119.476]
F1 Score:  [0.983, 0.992, 0.982, 0.983, 0.944, 0.983, 0.974, 0.992, 0.974, 0.981, 0.973, 0.973, 0.976, 0.822, 0.973]
Recall Score:  [0.986, 0.993, 0.984, 0.986, 0.947, 0.986, 0.977, 0.993, 0.977, 0.984, 0.977, 0.977, 0.982, 0.852, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7759
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9918
Averaged Test F1_score: 0.9670
Averaged Test Recal score: 0.9719
Std Test Accurancy: 0.0395
Std Test AUC: 0.0043
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.052
Epoch: 0|  Loss:  1.4287 |Global loss: 5.5191| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.776
Epoch: 1|  Loss:  0.9909 |Global loss: 4.1458| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.7544
Epoch: 2|  Loss:  0.9847 |Global loss: 4.0192| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.8117
Epoch: 3|  Loss:  1.1828 |Global loss: 4.0027| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0547
Epoch: 0|  Loss:  1.2211 |Global loss: 5.8452| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.618
Epoch: 1|  Loss:  0.7946 |Global loss: 3.798| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.6138
Epoch: 2|  Loss:  0.8252 |Global loss: 3.8759| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6643
Epoch: 3|  Loss:  0.8542 |Global loss: 3.6835| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9339
Epoch: 0|  Loss:  1.2083 |Global loss: 5.1416| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.8039
Epoch: 1|  Loss:  1.092 |Global loss: 4.1762| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.6811
Epoch: 2|  Loss:  0.9561 |Global loss: 3.6315| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.686
Epoch: 3|  Loss:  0.9643 |Global loss: 3.7079| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.8726
Epoch: 0|  Loss:  1.1031 |Global loss: 4.8245| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.6418
Epoch: 1|  Loss:  0.869 |Global loss: 3.6834| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6685
Epoch: 2|  Loss:  0.9159 |Global loss: 3.7269| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.6327
Epoch: 3|  Loss:  0.8727 |Global loss: 3.6729| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 1.109
Epoch: 0|  Loss:  1.2378 |Global loss: 6.5252| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.7615
Epoch: 1|  Loss:  0.9066 |Global loss: 4.7205| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6807
Epoch: 2|  Loss:  0.8449 |Global loss: 4.2566| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6826
Epoch: 3|  Loss:  0.8267 |Global loss: 4.1207| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.9735
Epoch: 0|  Loss:  1.1793 |Global loss: 5.2871| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 0.7191
Epoch: 1|  Loss:  0.9772 |Global loss: 3.8612| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.67
Epoch: 2|  Loss:  0.8696 |Global loss: 3.6106| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.68
Epoch: 3|  Loss:  0.9003 |Global loss: 3.6085| Local H loss: 0.0288  | Global H loss: 0.0288
------------------------- time cost ------------------------- 5.146813631057739
Chosen Clients:  [0, 7, 4, 13, 14, 8]

-------------Round number: 172-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.983, 0.958, 0.983, 0.975, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.883, 0.975]
AUC in each clients:  [118.919, 119.361, 119.232, 119.049, 119.039, 118.47, 119.317, 119.427, 118.87, 119.274, 119.091, 119.62, 119.127, 117.895, 119.476]
F1 Score:  [0.983, 0.992, 0.982, 0.983, 0.952, 0.983, 0.974, 0.992, 0.974, 0.981, 0.973, 0.973, 0.974, 0.894, 0.973]
Recall Score:  [0.986, 0.993, 0.984, 0.986, 0.956, 0.986, 0.977, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.916, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4369
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9722
Averaged Test Recal score: 0.9764
Std Test Accurancy: 0.0252
Std Test AUC: 0.0035
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8564
Epoch: 0|  Loss:  1.0367 |Global loss: 5.3674| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.6245
Epoch: 1|  Loss:  0.8085 |Global loss: 4.0236| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.619
Epoch: 2|  Loss:  0.7914 |Global loss: 3.7106| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.5742
Epoch: 3|  Loss:  0.7481 |Global loss: 3.6318| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.7884
Epoch: 0|  Loss:  0.9329 |Global loss: 5.4687| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.6304
Epoch: 1|  Loss:  0.7707 |Global loss: 3.7888| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.5838
Epoch: 2|  Loss:  0.7344 |Global loss: 3.5566| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.5437
Epoch: 3|  Loss:  0.6968 |Global loss: 3.476| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.7762
Epoch: 0|  Loss:  1.025 |Global loss: 4.8577| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.7116
Epoch: 1|  Loss:  1.0532 |Global loss: 3.7199| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.7005
Epoch: 2|  Loss:  1.0006 |Global loss: 3.6276| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6548
Epoch: 3|  Loss:  0.8883 |Global loss: 3.5217| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.9082
Epoch: 0|  Loss:  1.1393 |Global loss: 5.1653| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.6885
Epoch: 1|  Loss:  0.9461 |Global loss: 3.9532| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.7351
Epoch: 2|  Loss:  1.0146 |Global loss: 3.8442| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.6652
Epoch: 3|  Loss:  0.9694 |Global loss: 3.7574| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.843
Epoch: 0|  Loss:  0.9759 |Global loss: 5.3669| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.6038
Epoch: 1|  Loss:  0.7549 |Global loss: 3.7212| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6238
Epoch: 2|  Loss:  0.7859 |Global loss: 3.7403| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.5917
Epoch: 3|  Loss:  0.744 |Global loss: 3.6161| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.8422
Epoch: 0|  Loss:  1.0388 |Global loss: 4.7893| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.6033
Epoch: 1|  Loss:  0.7613 |Global loss: 3.564| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.6024
Epoch: 2|  Loss:  0.7629 |Global loss: 3.4212| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.6678
Epoch: 3|  Loss:  0.8378 |Global loss: 3.4651| Local H loss: 0.0296  | Global H loss: 0.0296
------------------------- time cost ------------------------- 4.685335159301758
Chosen Clients:  [3, 12, 13, 8, 7, 9]

-------------Round number: 173-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.983, 0.983, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.875, 0.975]
AUC in each clients:  [118.992, 119.361, 119.232, 119.049, 118.981, 118.47, 119.317, 119.233, 118.873, 119.274, 119.091, 119.62, 119.127, 117.807, 119.385]
F1 Score:  [0.991, 0.992, 0.982, 0.983, 0.944, 0.983, 0.974, 0.982, 0.973, 0.981, 0.973, 0.973, 0.974, 0.882, 0.973]
Recall Score:  [0.993, 0.993, 0.984, 0.986, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9079
Averaged Test Accurancy: 0.9717
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9707
Averaged Test Recal score: 0.9742
Std Test Accurancy: 0.0275
Std Test AUC: 0.0035
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.9017
Epoch: 0|  Loss:  1.0349 |Global loss: 5.0844| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.636
Epoch: 1|  Loss:  0.8053 |Global loss: 3.6553| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.5788
Epoch: 2|  Loss:  0.7437 |Global loss: 3.4823| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6009
Epoch: 3|  Loss:  0.7569 |Global loss: 3.4301| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.0332
Epoch: 0|  Loss:  1.2336 |Global loss: 5.7407| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 0.793
Epoch: 1|  Loss:  1.0582 |Global loss: 4.1259| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.6647
Epoch: 2|  Loss:  0.9237 |Global loss: 3.6933| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.6474
Epoch: 3|  Loss:  0.8364 |Global loss: 3.4749| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 1.0971
Epoch: 0|  Loss:  1.3423 |Global loss: 5.7239| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.7318
Epoch: 1|  Loss:  1.0088 |Global loss: 3.9448| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.7546
Epoch: 2|  Loss:  1.0463 |Global loss: 3.9467| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.6682
Epoch: 3|  Loss:  0.9575 |Global loss: 3.5878| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.9859
Epoch: 0|  Loss:  1.1386 |Global loss: 5.0941| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.6389
Epoch: 1|  Loss:  0.7915 |Global loss: 3.4111| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.6962
Epoch: 2|  Loss:  0.8837 |Global loss: 3.7303| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.6633
Epoch: 3|  Loss:  0.9237 |Global loss: 3.5681| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9304
Epoch: 0|  Loss:  1.0645 |Global loss: 5.2671| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.665
Epoch: 1|  Loss:  0.8249 |Global loss: 3.6501| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.5913
Epoch: 2|  Loss:  0.7665 |Global loss: 3.4849| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.5556
Epoch: 3|  Loss:  0.7185 |Global loss: 3.3247| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.7644
Epoch: 0|  Loss:  0.9019 |Global loss: 4.5564| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.604
Epoch: 1|  Loss:  0.7511 |Global loss: 3.7242| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5862
Epoch: 2|  Loss:  0.7338 |Global loss: 3.7006| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.636
Epoch: 3|  Loss:  0.7894 |Global loss: 3.7079| Local H loss: 0.0307  | Global H loss: 0.0307
------------------------- time cost ------------------------- 4.895962715148926
Chosen Clients:  [6, 5, 11, 1, 2, 0]

-------------Round number: 174-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.992, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [118.992, 119.361, 119.232, 118.972, 118.981, 118.47, 119.317, 119.134, 119.03, 119.355, 119.091, 119.62, 119.01, 118.26, 119.385]
F1 Score:  [0.991, 0.992, 0.982, 0.973, 0.944, 0.983, 0.974, 0.982, 0.973, 0.981, 0.973, 0.973, 0.975, 0.915, 0.973]
Recall Score:  [0.993, 0.993, 0.984, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.924, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5959
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9723
Averaged Test Recal score: 0.9759
Std Test Accurancy: 0.0198
Std Test AUC: 0.0028
Std Test F1: 0.0002
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.0575 |Global loss: 5.3642| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.7001
Epoch: 1|  Loss:  0.8555 |Global loss: 4.1274| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.6422
Epoch: 2|  Loss:  0.7964 |Global loss: 3.7795| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.6737
Epoch: 3|  Loss:  0.8327 |Global loss: 3.8618| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.8235
Epoch: 0|  Loss:  0.9979 |Global loss: 4.9385| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.5799
Epoch: 1|  Loss:  0.7707 |Global loss: 3.6858| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.568
Epoch: 2|  Loss:  0.7516 |Global loss: 3.5535| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.6783
Epoch: 3|  Loss:  0.9531 |Global loss: 3.7418| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.7492
Epoch: 0|  Loss:  0.8768 |Global loss: 5.4611| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.5983
Epoch: 1|  Loss:  0.7486 |Global loss: 3.6754| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.6272
Epoch: 2|  Loss:  0.7755 |Global loss: 3.8279| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.6083
Epoch: 3|  Loss:  0.7613 |Global loss: 3.597| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.913
Epoch: 0|  Loss:  1.0828 |Global loss: 5.4557| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.671
Epoch: 1|  Loss:  0.8173 |Global loss: 4.4596| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.6968
Epoch: 2|  Loss:  0.8528 |Global loss: 4.2168| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.6448
Epoch: 3|  Loss:  0.8013 |Global loss: 3.9877| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.9721
Epoch: 0|  Loss:  1.2346 |Global loss: 5.5258| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.8041
Epoch: 1|  Loss:  1.039 |Global loss: 4.1568| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.737
Epoch: 2|  Loss:  0.9999 |Global loss: 3.8802| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6789
Epoch: 3|  Loss:  0.9108 |Global loss: 3.688| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8899
Epoch: 0|  Loss:  1.0839 |Global loss: 5.1291| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6494
Epoch: 1|  Loss:  0.844 |Global loss: 3.9013| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.657
Epoch: 2|  Loss:  0.8527 |Global loss: 3.6741| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.6321
Epoch: 3|  Loss:  0.8269 |Global loss: 3.811| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.7305748462677
Chosen Clients:  [14, 13, 1, 3, 8, 0]

-------------Round number: 175-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.967, 0.992, 0.975, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [118.75, 119.314, 119.01, 118.972, 118.981, 118.465, 119.316, 119.134, 119.03, 119.355, 119.091, 119.658, 119.01, 118.26, 119.385]
F1 Score:  [0.968, 0.992, 0.974, 0.973, 0.944, 0.983, 0.974, 0.982, 0.973, 0.981, 0.973, 0.973, 0.975, 0.915, 0.973]
Recall Score:  [0.972, 0.993, 0.978, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.924, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7175
Averaged Test Accurancy: 0.9711
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9702
Averaged Test Recal score: 0.9741
Std Test Accurancy: 0.0190
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.7476
Epoch: 0|  Loss:  0.8879 |Global loss: 4.9826| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6108
Epoch: 1|  Loss:  0.763 |Global loss: 3.7006| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.6003
Epoch: 2|  Loss:  0.7724 |Global loss: 3.6119| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.657
Epoch: 3|  Loss:  0.848 |Global loss: 3.7352| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9631
Epoch: 0|  Loss:  1.244 |Global loss: 5.5237| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6989
Epoch: 1|  Loss:  0.9503 |Global loss: 3.7575| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.6872
Epoch: 2|  Loss:  0.9788 |Global loss: 3.8365| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.6488
Epoch: 3|  Loss:  0.8944 |Global loss: 3.6957| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.8085
Epoch: 0|  Loss:  0.9548 |Global loss: 5.7732| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.6823
Epoch: 1|  Loss:  0.8362 |Global loss: 4.5488| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.7158
Epoch: 2|  Loss:  0.8682 |Global loss: 4.1991| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.655
Epoch: 3|  Loss:  0.81 |Global loss: 4.2358| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.8309
Epoch: 0|  Loss:  1.0066 |Global loss: 4.7694| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.6072
Epoch: 1|  Loss:  0.756 |Global loss: 3.6982| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.5791
Epoch: 2|  Loss:  0.7326 |Global loss: 3.5145| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.625
Epoch: 3|  Loss:  0.7773 |Global loss: 3.4554| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 0.9746
Epoch: 0|  Loss:  1.1722 |Global loss: 5.0739| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.6854
Epoch: 1|  Loss:  0.927 |Global loss: 3.7119| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.6119
Epoch: 2|  Loss:  0.775 |Global loss: 3.3333| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.6099
Epoch: 3|  Loss:  0.7713 |Global loss: 3.3409| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 0.9451
Epoch: 0|  Loss:  1.1556 |Global loss: 5.6515| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.6631
Epoch: 1|  Loss:  0.8667 |Global loss: 4.0179| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.6956
Epoch: 2|  Loss:  0.8746 |Global loss: 4.0474| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.651
Epoch: 3|  Loss:  0.8561 |Global loss: 3.73| Local H loss: 0.0339  | Global H loss: 0.0339
------------------------- time cost ------------------------- 5.0426857471466064
Chosen Clients:  [13, 8, 14, 4, 11, 12]

-------------Round number: 176-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.992, 0.975, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.883, 0.975]
AUC in each clients:  [118.735, 119.408, 119.01, 118.929, 118.981, 118.465, 119.316, 119.134, 118.918, 119.355, 119.091, 119.658, 119.01, 118.155, 119.43]
F1 Score:  [0.964, 0.992, 0.974, 0.973, 0.944, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.975, 0.894, 0.973]
Recall Score:  [0.971, 0.993, 0.978, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.981, 0.916, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9491
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9920
Averaged Test F1_score: 0.9686
Averaged Test Recal score: 0.9735
Std Test Accurancy: 0.0248
Std Test AUC: 0.0031
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.0597
Epoch: 0|  Loss:  1.2789 |Global loss: 5.5901| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.6605
Epoch: 1|  Loss:  0.9651 |Global loss: 3.808| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.6622
Epoch: 2|  Loss:  0.953 |Global loss: 3.6459| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6869
Epoch: 3|  Loss:  0.9236 |Global loss: 3.6933| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9052
Epoch: 0|  Loss:  1.0853 |Global loss: 5.0079| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.5761
Epoch: 1|  Loss:  0.7268 |Global loss: 3.4782| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.704
Epoch: 2|  Loss:  0.8643 |Global loss: 3.4892| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.59
Epoch: 3|  Loss:  0.7455 |Global loss: 3.2405| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.8714
Epoch: 0|  Loss:  1.0099 |Global loss: 5.2795| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.6097
Epoch: 1|  Loss:  0.767 |Global loss: 3.4754| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.5715
Epoch: 2|  Loss:  0.727 |Global loss: 3.5251| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.544
Epoch: 3|  Loss:  0.7008 |Global loss: 3.37| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8509
Epoch: 0|  Loss:  1.0913 |Global loss: 4.9287| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.699
Epoch: 1|  Loss:  0.9398 |Global loss: 3.5762| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.731
Epoch: 2|  Loss:  0.9661 |Global loss: 3.6343| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6799
Epoch: 3|  Loss:  0.9707 |Global loss: 3.6157| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.8939
Epoch: 0|  Loss:  1.024 |Global loss: 5.4814| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6729
Epoch: 1|  Loss:  0.815 |Global loss: 4.1033| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.619
Epoch: 2|  Loss:  0.7677 |Global loss: 3.7174| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.5854
Epoch: 3|  Loss:  0.7367 |Global loss: 3.578| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 1.0603
Epoch: 0|  Loss:  1.2419 |Global loss: 5.7076| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.6704
Epoch: 1|  Loss:  0.8659 |Global loss: 3.785| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.6675
Epoch: 2|  Loss:  0.8632 |Global loss: 3.5674| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.5957
Epoch: 3|  Loss:  0.7888 |Global loss: 3.4302| Local H loss: 0.0299  | Global H loss: 0.0299
------------------------- time cost ------------------------- 4.73984956741333
Chosen Clients:  [11, 9, 3, 1, 6, 5]

-------------Round number: 177-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.992, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.958, 0.975]
AUC in each clients:  [118.735, 119.408, 119.01, 118.929, 119.011, 118.465, 119.316, 119.134, 118.884, 119.355, 119.091, 119.717, 118.968, 118.36, 119.425]
F1 Score:  [0.964, 0.992, 0.974, 0.973, 0.953, 0.983, 0.974, 0.982, 0.973, 0.981, 0.973, 0.982, 0.973, 0.958, 0.973]
Recall Score:  [0.971, 0.993, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.978, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1495
Averaged Test Accurancy: 0.9750
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9739
Averaged Test Recal score: 0.9773
Std Test Accurancy: 0.0096
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.816
Epoch: 0|  Loss:  0.9558 |Global loss: 4.9105| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.6444
Epoch: 1|  Loss:  0.7931 |Global loss: 3.7772| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.6019
Epoch: 2|  Loss:  0.7518 |Global loss: 3.5947| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.6427
Epoch: 3|  Loss:  0.7915 |Global loss: 3.7353| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.8186
Epoch: 0|  Loss:  0.9571 |Global loss: 4.5609| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.5732
Epoch: 1|  Loss:  0.7209 |Global loss: 3.5265| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.5883
Epoch: 2|  Loss:  0.7389 |Global loss: 3.6015| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.566
Epoch: 3|  Loss:  0.7178 |Global loss: 3.4892| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9465
Epoch: 0|  Loss:  1.1506 |Global loss: 4.8243| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6262
Epoch: 1|  Loss:  0.8013 |Global loss: 3.5994| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.616
Epoch: 2|  Loss:  0.7679 |Global loss: 3.5575| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6072
Epoch: 3|  Loss:  0.7583 |Global loss: 3.4784| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 0.936
Epoch: 0|  Loss:  1.0733 |Global loss: 5.951| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6514
Epoch: 1|  Loss:  0.7923 |Global loss: 4.3223| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.7285
Epoch: 2|  Loss:  0.9371 |Global loss: 4.0891| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.8372
Epoch: 3|  Loss:  1.0349 |Global loss: 4.3915| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.9342
Epoch: 0|  Loss:  1.0715 |Global loss: 5.2495| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.7377
Epoch: 1|  Loss:  0.8893 |Global loss: 3.9582| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.7081
Epoch: 2|  Loss:  0.8652 |Global loss: 4.0233| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6532
Epoch: 3|  Loss:  0.8079 |Global loss: 3.7455| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9701
Epoch: 0|  Loss:  1.147 |Global loss: 5.0355| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.6172
Epoch: 1|  Loss:  0.8517 |Global loss: 3.8468| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.602
Epoch: 2|  Loss:  0.7772 |Global loss: 3.5017| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.6227
Epoch: 3|  Loss:  0.7981 |Global loss: 3.4985| Local H loss: 0.0364  | Global H loss: 0.0364
------------------------- time cost ------------------------- 4.677156448364258
Chosen Clients:  [7, 0, 8, 5, 12, 1]

-------------Round number: 178-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.992, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.958, 0.975]
AUC in each clients:  [118.735, 119.347, 119.01, 118.938, 119.011, 118.486, 119.3, 119.134, 118.884, 119.309, 119.091, 119.639, 118.968, 118.36, 119.425]
F1 Score:  [0.964, 0.992, 0.974, 0.973, 0.953, 0.983, 0.974, 0.982, 0.973, 0.981, 0.973, 0.973, 0.973, 0.958, 0.973]
Recall Score:  [0.971, 0.993, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.978, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4459
Averaged Test Accurancy: 0.9744
Averaged Test AUC: 0.9920
Averaged Test F1_score: 0.9733
Averaged Test Recal score: 0.9769
Std Test Accurancy: 0.0094
Std Test AUC: 0.0028
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9243
Epoch: 0|  Loss:  1.0649 |Global loss: 5.0896| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 0.6552
Epoch: 1|  Loss:  0.8307 |Global loss: 3.8407| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.6965
Epoch: 2|  Loss:  0.8838 |Global loss: 3.7394| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.5646
Epoch: 3|  Loss:  0.7153 |Global loss: 3.3905| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 1.0205
Epoch: 0|  Loss:  1.1715 |Global loss: 6.1124| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6693
Epoch: 1|  Loss:  0.8809 |Global loss: 4.1459| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.5836
Epoch: 2|  Loss:  0.7745 |Global loss: 3.6877| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.6615
Epoch: 3|  Loss:  0.8886 |Global loss: 3.8468| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9069
Epoch: 0|  Loss:  1.0508 |Global loss: 4.7415| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.6998
Epoch: 1|  Loss:  0.8937 |Global loss: 3.5873| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.6393
Epoch: 2|  Loss:  0.8333 |Global loss: 3.4692| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.6345
Epoch: 3|  Loss:  0.8592 |Global loss: 3.3537| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.8926
Epoch: 0|  Loss:  1.0991 |Global loss: 4.717| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.6262
Epoch: 1|  Loss:  0.8463 |Global loss: 3.6853| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.6355
Epoch: 2|  Loss:  0.8147 |Global loss: 3.4643| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.6692
Epoch: 3|  Loss:  0.8877 |Global loss: 3.5534| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 1.1261
Epoch: 0|  Loss:  1.3225 |Global loss: 5.9682| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 0.7454
Epoch: 1|  Loss:  0.9544 |Global loss: 3.9751| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.6791
Epoch: 2|  Loss:  0.8951 |Global loss: 3.6835| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.5989
Epoch: 3|  Loss:  0.8039 |Global loss: 3.5057| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9385
Epoch: 0|  Loss:  1.0825 |Global loss: 5.3146| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6212
Epoch: 1|  Loss:  0.7665 |Global loss: 4.1028| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.6724
Epoch: 2|  Loss:  0.8367 |Global loss: 4.1817| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.6709
Epoch: 3|  Loss:  0.8423 |Global loss: 3.8398| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 4.880112648010254
Chosen Clients:  [5, 9, 10, 11, 14, 4]

-------------Round number: 179-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.958, 0.975]
AUC in each clients:  [118.975, 119.436, 119.01, 118.938, 119.011, 118.492, 119.3, 119.517, 118.948, 119.309, 119.091, 119.639, 118.908, 118.36, 119.425]
F1 Score:  [0.991, 0.982, 0.974, 0.973, 0.953, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.966, 0.958, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.973, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3822
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9740
Averaged Test Recal score: 0.9774
Std Test Accurancy: 0.0089
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9222
Epoch: 0|  Loss:  1.0897 |Global loss: 5.2155| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.6079
Epoch: 1|  Loss:  0.8072 |Global loss: 3.6159| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.5773
Epoch: 2|  Loss:  0.7661 |Global loss: 3.469| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.589
Epoch: 3|  Loss:  0.7612 |Global loss: 3.4097| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.8208
Epoch: 0|  Loss:  0.9576 |Global loss: 4.6801| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6456
Epoch: 1|  Loss:  0.7899 |Global loss: 3.9068| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.6007
Epoch: 2|  Loss:  0.7482 |Global loss: 3.5946| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.5876
Epoch: 3|  Loss:  0.7327 |Global loss: 3.5707| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9344
Epoch: 0|  Loss:  1.0597 |Global loss: 5.6194| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6459
Epoch: 1|  Loss:  0.7867 |Global loss: 4.0131| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6536
Epoch: 2|  Loss:  0.8875 |Global loss: 4.0434| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6887
Epoch: 3|  Loss:  0.8469 |Global loss: 3.8784| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9034
Epoch: 0|  Loss:  1.0376 |Global loss: 5.2528| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.6937
Epoch: 1|  Loss:  0.8368 |Global loss: 4.1569| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6251
Epoch: 2|  Loss:  0.7737 |Global loss: 3.8092| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6273
Epoch: 3|  Loss:  0.7732 |Global loss: 3.7561| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9439
Epoch: 0|  Loss:  1.1141 |Global loss: 5.3044| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6339
Epoch: 1|  Loss:  0.7982 |Global loss: 3.789| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6026
Epoch: 2|  Loss:  0.7717 |Global loss: 3.6185| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.5776
Epoch: 3|  Loss:  0.7296 |Global loss: 3.5072| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.9254
Epoch: 0|  Loss:  1.1864 |Global loss: 5.2135| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 0.6484
Epoch: 1|  Loss:  0.9059 |Global loss: 3.8247| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.6897
Epoch: 2|  Loss:  0.9128 |Global loss: 3.9243| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.6657
Epoch: 3|  Loss:  0.9119 |Global loss: 3.8337| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 4.8584511280059814
Chosen Clients:  [8, 11, 12, 7, 0, 3]

-------------Round number: 180-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.967, 0.958, 0.975]
AUC in each clients:  [118.975, 119.436, 119.01, 118.938, 118.982, 118.456, 119.3, 119.517, 118.948, 119.311, 118.919, 119.6, 118.908, 118.36, 119.402]
F1 Score:  [0.991, 0.982, 0.974, 0.973, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.966, 0.958, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.973, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9482
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9739
Averaged Test Recal score: 0.9774
Std Test Accurancy: 0.0089
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8511
Epoch: 0|  Loss:  0.9939 |Global loss: 4.7819| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.6591
Epoch: 1|  Loss:  0.8716 |Global loss: 3.632| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.7033
Epoch: 2|  Loss:  0.867 |Global loss: 3.5051| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.6378
Epoch: 3|  Loss:  0.8161 |Global loss: 3.287| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9232
Epoch: 0|  Loss:  1.0528 |Global loss: 5.181| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.6716
Epoch: 1|  Loss:  0.8195 |Global loss: 4.0092| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.6272
Epoch: 2|  Loss:  0.7795 |Global loss: 3.6699| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.6721
Epoch: 3|  Loss:  0.8203 |Global loss: 3.6859| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9634
Epoch: 0|  Loss:  1.1861 |Global loss: 5.6494| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 0.6405
Epoch: 1|  Loss:  0.8274 |Global loss: 3.7172| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.783
Epoch: 2|  Loss:  1.0347 |Global loss: 4.0256| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.7049
Epoch: 3|  Loss:  0.902 |Global loss: 3.6914| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8422
Epoch: 0|  Loss:  0.9868 |Global loss: 5.3746| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 0.6788
Epoch: 1|  Loss:  0.8671 |Global loss: 3.7631| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.6042
Epoch: 2|  Loss:  0.7667 |Global loss: 3.4408| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.5491
Epoch: 3|  Loss:  0.7541 |Global loss: 3.4044| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9303
Epoch: 0|  Loss:  1.107 |Global loss: 5.3126| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.7026
Epoch: 1|  Loss:  0.9234 |Global loss: 3.8994| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6673
Epoch: 2|  Loss:  0.8556 |Global loss: 3.7369| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.6612
Epoch: 3|  Loss:  0.8452 |Global loss: 3.6177| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9745
Epoch: 0|  Loss:  1.1074 |Global loss: 5.4559| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.6676
Epoch: 1|  Loss:  0.8241 |Global loss: 3.5352| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.584
Epoch: 2|  Loss:  0.7375 |Global loss: 3.4231| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.5756
Epoch: 3|  Loss:  0.7268 |Global loss: 3.3587| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 4.901298999786377
Chosen Clients:  [8, 9, 11, 1, 10, 3]

-------------Round number: 181-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.958, 0.975]
AUC in each clients:  [119.074, 119.436, 119.01, 118.979, 118.982, 118.456, 119.3, 119.357, 118.994, 119.311, 118.919, 119.655, 118.999, 118.36, 119.402]
F1 Score:  [0.991, 0.982, 0.974, 0.973, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.958, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6569
Averaged Test Accurancy: 0.9767
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9751
Averaged Test Recal score: 0.9783
Std Test Accurancy: 0.0087
Std Test AUC: 0.0028
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8633
Epoch: 0|  Loss:  1.0061 |Global loss: 4.6885| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.6219
Epoch: 1|  Loss:  0.8003 |Global loss: 3.4067| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.6371
Epoch: 2|  Loss:  0.8154 |Global loss: 3.349| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.6411
Epoch: 3|  Loss:  0.8051 |Global loss: 3.2523| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 0.8875
Epoch: 0|  Loss:  1.0232 |Global loss: 5.0361| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.5882
Epoch: 1|  Loss:  0.7379 |Global loss: 3.5426| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.5951
Epoch: 2|  Loss:  0.7537 |Global loss: 3.5393| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.6203
Epoch: 3|  Loss:  0.7874 |Global loss: 3.4907| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.8208
Epoch: 0|  Loss:  0.9539 |Global loss: 5.2622| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.633
Epoch: 1|  Loss:  0.7806 |Global loss: 3.7073| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.6281
Epoch: 2|  Loss:  0.7733 |Global loss: 3.6789| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.6635
Epoch: 3|  Loss:  0.8125 |Global loss: 4.0055| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.9134
Epoch: 0|  Loss:  1.0528 |Global loss: 6.0729| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.6745
Epoch: 1|  Loss:  0.8443 |Global loss: 4.329| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.722
Epoch: 2|  Loss:  0.9018 |Global loss: 4.1582| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.7172
Epoch: 3|  Loss:  0.8736 |Global loss: 4.0794| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9927
Epoch: 0|  Loss:  1.1787 |Global loss: 5.875| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.7137
Epoch: 1|  Loss:  0.8543 |Global loss: 4.2911| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.7094
Epoch: 2|  Loss:  0.9239 |Global loss: 4.1398| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.7206
Epoch: 3|  Loss:  0.8669 |Global loss: 4.0289| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9418
Epoch: 0|  Loss:  1.0845 |Global loss: 4.9353| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.6393
Epoch: 1|  Loss:  0.7961 |Global loss: 3.5612| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.6194
Epoch: 2|  Loss:  0.7799 |Global loss: 3.419| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.5867
Epoch: 3|  Loss:  0.7379 |Global loss: 3.3422| Local H loss: 0.0332  | Global H loss: 0.0332
------------------------- time cost ------------------------- 5.158569097518921
Chosen Clients:  [14, 8, 5, 12, 13, 9]

-------------Round number: 182-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.983, 0.983, 0.958, 0.975]
AUC in each clients:  [119.074, 119.472, 119.01, 118.956, 118.982, 118.456, 119.3, 119.357, 118.97, 119.323, 119.065, 119.71, 118.999, 118.36, 119.402]
F1 Score:  [0.991, 0.981, 0.974, 0.973, 0.952, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.982, 0.983, 0.958, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.984, 0.987, 0.961, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0045
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9756
Averaged Test Recal score: 0.9788
Std Test Accurancy: 0.0089
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8926
Epoch: 0|  Loss:  1.0409 |Global loss: 5.187| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.5844
Epoch: 1|  Loss:  0.7378 |Global loss: 3.5714| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.6319
Epoch: 2|  Loss:  0.7882 |Global loss: 3.7045| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.6203
Epoch: 3|  Loss:  0.7783 |Global loss: 3.5575| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.976
Epoch: 0|  Loss:  1.1552 |Global loss: 5.1901| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 0.6833
Epoch: 1|  Loss:  0.8848 |Global loss: 3.5339| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.6119
Epoch: 2|  Loss:  0.7649 |Global loss: 3.2386| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.5714
Epoch: 3|  Loss:  0.7262 |Global loss: 3.1906| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.9779
Epoch: 0|  Loss:  1.1654 |Global loss: 5.589| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.5967
Epoch: 1|  Loss:  0.7764 |Global loss: 3.4073| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.6131
Epoch: 2|  Loss:  0.7968 |Global loss: 3.4317| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.5913
Epoch: 3|  Loss:  0.7722 |Global loss: 3.3498| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 1.1317
Epoch: 0|  Loss:  1.2951 |Global loss: 5.6133| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 1|  NKD Loss: 0.7891
Epoch: 1|  Loss:  0.9845 |Global loss: 4.0662| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.709
Epoch: 2|  Loss:  0.8982 |Global loss: 3.8783| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.7178
Epoch: 3|  Loss:  0.928 |Global loss: 3.6675| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 1.0812
Epoch: 0|  Loss:  1.3417 |Global loss: 5.6632| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.7069
Epoch: 1|  Loss:  1.0015 |Global loss: 3.7726| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.6465
Epoch: 2|  Loss:  0.915 |Global loss: 3.6427| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6194
Epoch: 3|  Loss:  0.8468 |Global loss: 3.6025| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.8736
Epoch: 0|  Loss:  1.013 |Global loss: 4.9058| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.6032
Epoch: 1|  Loss:  0.7485 |Global loss: 3.6206| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.537
Epoch: 2|  Loss:  0.6892 |Global loss: 3.3587| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.574
Epoch: 3|  Loss:  0.728 |Global loss: 3.2798| Local H loss: 0.0326  | Global H loss: 0.0326
------------------------- time cost ------------------------- 4.6957221031188965
Chosen Clients:  [5, 4, 10, 8, 12, 7]

-------------Round number: 183-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.95, 0.95, 0.975]
AUC in each clients:  [119.074, 119.472, 119.01, 118.956, 118.982, 118.495, 119.3, 119.357, 118.929, 119.223, 119.065, 119.71, 118.83, 118.565, 119.359]
F1 Score:  [0.991, 0.981, 0.974, 0.973, 0.952, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.982, 0.954, 0.942, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.965, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3398
Averaged Test Accurancy: 0.9744
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9727
Averaged Test Recal score: 0.9762
Std Test Accurancy: 0.0123
Std Test AUC: 0.0026
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9115
Epoch: 0|  Loss:  1.082 |Global loss: 4.8349| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.65
Epoch: 1|  Loss:  0.8529 |Global loss: 3.5551| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.661
Epoch: 2|  Loss:  0.8859 |Global loss: 3.4714| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.6361
Epoch: 3|  Loss:  0.8222 |Global loss: 3.4219| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9138
Epoch: 0|  Loss:  1.149 |Global loss: 5.413| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 0.6409
Epoch: 1|  Loss:  0.9037 |Global loss: 3.9072| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.6351
Epoch: 2|  Loss:  0.8665 |Global loss: 3.786| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6312
Epoch: 3|  Loss:  0.8592 |Global loss: 3.67| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.0962
Epoch: 0|  Loss:  1.2892 |Global loss: 6.988| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 1|  NKD Loss: 0.7375
Epoch: 1|  Loss:  0.8631 |Global loss: 5.1004| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.7158
Epoch: 2|  Loss:  0.84 |Global loss: 4.7394| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8031
Epoch: 3|  Loss:  1.0322 |Global loss: 4.709| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9754
Epoch: 0|  Loss:  1.1324 |Global loss: 4.9032| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.6128
Epoch: 1|  Loss:  0.768 |Global loss: 3.322| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.6827
Epoch: 2|  Loss:  0.8635 |Global loss: 3.3337| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6446
Epoch: 3|  Loss:  0.8153 |Global loss: 3.3817| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9128
Epoch: 0|  Loss:  1.0865 |Global loss: 5.2186| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.7309
Epoch: 1|  Loss:  0.9957 |Global loss: 4.0257| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 0.6557
Epoch: 2|  Loss:  0.8437 |Global loss: 3.7083| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.656
Epoch: 3|  Loss:  0.863 |Global loss: 3.5665| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9137
Epoch: 0|  Loss:  1.0437 |Global loss: 5.5128| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.638
Epoch: 1|  Loss:  0.7812 |Global loss: 3.7286| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.7061
Epoch: 2|  Loss:  0.9832 |Global loss: 3.7345| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.616
Epoch: 3|  Loss:  0.7816 |Global loss: 3.4471| Local H loss: 0.0289  | Global H loss: 0.0289
------------------------- time cost ------------------------- 4.833293914794922
Chosen Clients:  [0, 14, 5, 9, 7, 4]

-------------Round number: 184-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.992, 0.983, 0.975, 0.975, 0.958, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.983, 0.983, 0.95, 0.975]
AUC in each clients:  [119.074, 119.472, 119.01, 118.956, 119.117, 118.364, 119.3, 119.193, 118.967, 119.223, 119.175, 119.71, 118.958, 118.565, 119.359]
F1 Score:  [0.991, 0.981, 0.974, 0.973, 0.952, 0.992, 0.974, 0.991, 0.974, 0.973, 0.982, 0.982, 0.983, 0.942, 0.973]
Recall Score:  [0.993, 0.984, 0.978, 0.977, 0.956, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.984, 0.987, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9807
Averaged Test Accurancy: 0.9778
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9758
Averaged Test Recal score: 0.9787
Std Test Accurancy: 0.0112
Std Test AUC: 0.0027
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9189
Epoch: 0|  Loss:  1.0836 |Global loss: 5.3483| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.6718
Epoch: 1|  Loss:  0.8849 |Global loss: 3.917| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6908
Epoch: 2|  Loss:  0.9207 |Global loss: 3.6648| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.6019
Epoch: 3|  Loss:  0.8121 |Global loss: 3.6255| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9157
Epoch: 0|  Loss:  1.0526 |Global loss: 5.6859| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.5867
Epoch: 1|  Loss:  0.7417 |Global loss: 3.552| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6072
Epoch: 2|  Loss:  0.7618 |Global loss: 3.4954| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.5786
Epoch: 3|  Loss:  0.7349 |Global loss: 3.3595| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.894
Epoch: 0|  Loss:  1.1016 |Global loss: 4.7385| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.6596
Epoch: 1|  Loss:  0.8546 |Global loss: 3.8002| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.647
Epoch: 2|  Loss:  0.8653 |Global loss: 3.9094| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.6494
Epoch: 3|  Loss:  0.8499 |Global loss: 3.6049| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8147
Epoch: 0|  Loss:  0.953 |Global loss: 4.7778| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.5726
Epoch: 1|  Loss:  0.7182 |Global loss: 3.4628| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5691
Epoch: 2|  Loss:  0.7175 |Global loss: 3.4607| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.5877
Epoch: 3|  Loss:  0.7391 |Global loss: 3.2683| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.1511
Epoch: 0|  Loss:  1.378 |Global loss: 6.2115| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 0.6594
Epoch: 1|  Loss:  0.8031 |Global loss: 3.8016| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.6499
Epoch: 2|  Loss:  0.8065 |Global loss: 3.6417| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.6265
Epoch: 3|  Loss:  0.7879 |Global loss: 3.4687| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.8996
Epoch: 0|  Loss:  1.114 |Global loss: 5.4185| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.6559
Epoch: 1|  Loss:  0.8871 |Global loss: 3.4653| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.6646
Epoch: 2|  Loss:  0.8939 |Global loss: 3.5547| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6968
Epoch: 3|  Loss:  0.9242 |Global loss: 3.5181| Local H loss: 0.0318  | Global H loss: 0.0318
------------------------- time cost ------------------------- 4.919103384017944
Chosen Clients:  [7, 4, 3, 0, 5, 14]

-------------Round number: 185-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.983, 0.983, 0.95, 0.975]
AUC in each clients:  [118.983, 119.472, 119.01, 118.956, 119.122, 118.526, 119.3, 119.49, 118.967, 119.202, 119.175, 119.71, 118.958, 118.565, 119.33]
F1 Score:  [0.983, 0.981, 0.974, 0.973, 0.964, 0.992, 0.974, 0.981, 0.974, 0.973, 0.982, 0.982, 0.983, 0.942, 0.973]
Recall Score:  [0.986, 0.984, 0.978, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.984, 0.987, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2224
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9926
Averaged Test F1_score: 0.9754
Averaged Test Recal score: 0.9785
Std Test Accurancy: 0.0094
Std Test AUC: 0.0026
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8269
Epoch: 0|  Loss:  0.977 |Global loss: 5.0116| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.6363
Epoch: 1|  Loss:  0.7812 |Global loss: 3.6908| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.6019
Epoch: 2|  Loss:  0.7611 |Global loss: 3.4868| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.5632
Epoch: 3|  Loss:  0.7227 |Global loss: 3.3153| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.9345
Epoch: 0|  Loss:  1.2274 |Global loss: 4.8582| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6744
Epoch: 1|  Loss:  0.9161 |Global loss: 3.5344| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.7432
Epoch: 2|  Loss:  0.9972 |Global loss: 3.4751| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.6236
Epoch: 3|  Loss:  0.8601 |Global loss: 3.2884| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 1.0922
Epoch: 0|  Loss:  1.261 |Global loss: 6.257| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 0.6221
Epoch: 1|  Loss:  0.7778 |Global loss: 3.5409| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.6038
Epoch: 2|  Loss:  0.7567 |Global loss: 3.411| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.5912
Epoch: 3|  Loss:  0.7459 |Global loss: 3.4055| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9015
Epoch: 0|  Loss:  1.0565 |Global loss: 5.3383| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.6269
Epoch: 1|  Loss:  0.7924 |Global loss: 3.8501| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.6384
Epoch: 2|  Loss:  0.8175 |Global loss: 3.6642| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.6304
Epoch: 3|  Loss:  0.8194 |Global loss: 3.591| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9064
Epoch: 0|  Loss:  1.0988 |Global loss: 4.8924| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.6356
Epoch: 1|  Loss:  0.8384 |Global loss: 3.5238| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.5507
Epoch: 2|  Loss:  0.7681 |Global loss: 3.484| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.64
Epoch: 3|  Loss:  0.8181 |Global loss: 3.3547| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 0.9017
Epoch: 0|  Loss:  1.0405 |Global loss: 5.2825| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.6178
Epoch: 1|  Loss:  0.7781 |Global loss: 3.8121| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.5616
Epoch: 2|  Loss:  0.7165 |Global loss: 3.4433| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.5929
Epoch: 3|  Loss:  0.7541 |Global loss: 3.6755| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 4.796574831008911
Chosen Clients:  [14, 5, 3, 9, 11, 12]

-------------Round number: 186-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.958, 0.983, 0.975, 0.992, 0.975, 0.975, 0.983, 0.983, 0.983, 0.95, 0.975]
AUC in each clients:  [118.99, 119.472, 119.01, 118.963, 119.076, 118.584, 119.3, 119.404, 118.967, 119.202, 119.175, 119.71, 118.958, 118.565, 119.409]
F1 Score:  [0.983, 0.981, 0.974, 0.973, 0.952, 0.983, 0.974, 0.992, 0.974, 0.973, 0.982, 0.982, 0.983, 0.942, 0.973]
Recall Score:  [0.986, 0.984, 0.978, 0.977, 0.956, 0.986, 0.977, 0.993, 0.977, 0.977, 0.984, 0.984, 0.987, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1352
Averaged Test Accurancy: 0.9767
Averaged Test AUC: 0.9927
Averaged Test F1_score: 0.9747
Averaged Test Recal score: 0.9778
Std Test Accurancy: 0.0102
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8873
Epoch: 0|  Loss:  1.0224 |Global loss: 5.4989| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.6038
Epoch: 1|  Loss:  0.7704 |Global loss: 3.5777| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.6182
Epoch: 2|  Loss:  0.7792 |Global loss: 3.4763| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.5842
Epoch: 3|  Loss:  0.7423 |Global loss: 3.3362| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9122
Epoch: 0|  Loss:  1.0839 |Global loss: 4.7463| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.6038
Epoch: 1|  Loss:  0.8055 |Global loss: 3.4566| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.6708
Epoch: 2|  Loss:  0.8467 |Global loss: 3.3515| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.6885
Epoch: 3|  Loss:  0.868 |Global loss: 3.3637| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.0616
Epoch: 0|  Loss:  1.1951 |Global loss: 5.1233| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.6109
Epoch: 1|  Loss:  0.7621 |Global loss: 3.4734| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.6296
Epoch: 2|  Loss:  0.8404 |Global loss: 3.6102| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.5816
Epoch: 3|  Loss:  0.735 |Global loss: 3.2921| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.889
Epoch: 0|  Loss:  1.0305 |Global loss: 5.2273| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.592
Epoch: 1|  Loss:  0.7459 |Global loss: 3.5751| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.6259
Epoch: 2|  Loss:  0.7785 |Global loss: 3.4577| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6241
Epoch: 3|  Loss:  0.7804 |Global loss: 3.5469| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.8928
Epoch: 0|  Loss:  1.014 |Global loss: 5.7331| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.6616
Epoch: 1|  Loss:  0.8104 |Global loss: 3.8778| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6136
Epoch: 2|  Loss:  0.7609 |Global loss: 3.7843| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6398
Epoch: 3|  Loss:  0.7917 |Global loss: 3.6566| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 1.0415
Epoch: 0|  Loss:  1.1933 |Global loss: 5.707| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 0.7243
Epoch: 1|  Loss:  0.9199 |Global loss: 3.9998| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.793
Epoch: 2|  Loss:  0.9771 |Global loss: 4.132| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.7266
Epoch: 3|  Loss:  0.9137 |Global loss: 3.834| Local H loss: 0.0281  | Global H loss: 0.0281
------------------------- time cost ------------------------- 4.860310077667236
Chosen Clients:  [10, 7, 13, 5, 4, 1]

-------------Round number: 187-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.958, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.975, 0.975, 0.95, 0.975]
AUC in each clients:  [118.99, 119.472, 119.01, 118.973, 119.076, 118.532, 119.3, 119.404, 118.967, 119.272, 119.175, 119.647, 119.387, 118.565, 119.397]
F1 Score:  [0.983, 0.981, 0.974, 0.973, 0.952, 0.992, 0.974, 0.992, 0.974, 0.973, 0.982, 0.973, 0.973, 0.942, 0.973]
Recall Score:  [0.986, 0.984, 0.978, 0.977, 0.956, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.977, 0.978, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2967
Averaged Test Accurancy: 0.9761
Averaged Test AUC: 0.9929
Averaged Test F1_score: 0.9741
Averaged Test Recal score: 0.9772
Std Test Accurancy: 0.0105
Std Test AUC: 0.0026
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.0586
Epoch: 0|  Loss:  1.1869 |Global loss: 6.1703| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.7045
Epoch: 1|  Loss:  0.9092 |Global loss: 4.3542| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.6842
Epoch: 2|  Loss:  0.8356 |Global loss: 3.9755| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.7239
Epoch: 3|  Loss:  0.9211 |Global loss: 4.0213| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9543
Epoch: 0|  Loss:  1.0839 |Global loss: 5.1386| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.6293
Epoch: 1|  Loss:  0.7716 |Global loss: 3.6413| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.6639
Epoch: 2|  Loss:  0.8555 |Global loss: 3.6107| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.5531
Epoch: 3|  Loss:  0.7066 |Global loss: 3.3509| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0468
Epoch: 0|  Loss:  1.2994 |Global loss: 5.3376| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.7363
Epoch: 1|  Loss:  1.0198 |Global loss: 3.5965| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6722
Epoch: 2|  Loss:  0.9042 |Global loss: 3.5329| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.6487
Epoch: 3|  Loss:  0.883 |Global loss: 3.5055| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.8774
Epoch: 0|  Loss:  1.0375 |Global loss: 4.9882| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6462
Epoch: 1|  Loss:  0.825 |Global loss: 3.6202| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.5768
Epoch: 2|  Loss:  0.7463 |Global loss: 3.2557| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.6418
Epoch: 3|  Loss:  0.845 |Global loss: 3.4059| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.9091
Epoch: 0|  Loss:  1.1193 |Global loss: 4.9913| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6985
Epoch: 1|  Loss:  0.9225 |Global loss: 3.4389| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.6518
Epoch: 2|  Loss:  0.9117 |Global loss: 3.4406| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.5873
Epoch: 3|  Loss:  0.8258 |Global loss: 3.4077| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.952
Epoch: 0|  Loss:  1.1031 |Global loss: 6.204| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 0.8165
Epoch: 1|  Loss:  0.9703 |Global loss: 4.8106| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.7338
Epoch: 2|  Loss:  0.9126 |Global loss: 4.6585| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.6748
Epoch: 3|  Loss:  0.851 |Global loss: 3.8794| Local H loss: 0.0328  | Global H loss: 0.0328
------------------------- time cost ------------------------- 4.775745868682861
Chosen Clients:  [5, 10, 1, 14, 3, 2]

-------------Round number: 188-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.975, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [118.99, 119.417, 119.01, 118.973, 119.174, 118.505, 119.3, 119.237, 118.967, 119.272, 119.064, 119.647, 119.387, 118.112, 119.397]
F1 Score:  [0.983, 0.992, 0.974, 0.973, 0.944, 0.983, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.903, 0.973]
Recall Score:  [0.986, 0.993, 0.978, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.907, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8725
Averaged Test Accurancy: 0.9717
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9698
Averaged Test Recal score: 0.9732
Std Test Accurancy: 0.0190
Std Test AUC: 0.0031
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8716
Epoch: 0|  Loss:  1.0808 |Global loss: 4.8114| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.6781
Epoch: 1|  Loss:  0.8847 |Global loss: 3.5763| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.648
Epoch: 2|  Loss:  0.8191 |Global loss: 3.2413| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.7037
Epoch: 3|  Loss:  0.9193 |Global loss: 3.5778| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.8969
Epoch: 0|  Loss:  1.0318 |Global loss: 5.6029| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.674
Epoch: 1|  Loss:  0.8203 |Global loss: 4.0697| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6493
Epoch: 2|  Loss:  0.8185 |Global loss: 3.8248| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.641
Epoch: 3|  Loss:  0.797 |Global loss: 3.7855| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9802
Epoch: 0|  Loss:  1.1624 |Global loss: 5.8825| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.7047
Epoch: 1|  Loss:  0.8676 |Global loss: 4.3832| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6493
Epoch: 2|  Loss:  0.8032 |Global loss: 3.9569| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.7052
Epoch: 3|  Loss:  0.8652 |Global loss: 3.8744| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 0.8658
Epoch: 0|  Loss:  1.0013 |Global loss: 5.1531| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.619
Epoch: 1|  Loss:  0.7876 |Global loss: 3.5753| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.5957
Epoch: 2|  Loss:  0.7464 |Global loss: 3.3528| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.5757
Epoch: 3|  Loss:  0.7368 |Global loss: 3.3706| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.1294
Epoch: 0|  Loss:  1.2449 |Global loss: 6.6943| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 0.6905
Epoch: 1|  Loss:  0.8275 |Global loss: 4.2235| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.6236
Epoch: 2|  Loss:  0.7656 |Global loss: 3.751| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.595
Epoch: 3|  Loss:  0.7403 |Global loss: 3.5901| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.148
Epoch: 0|  Loss:  1.6203 |Global loss: 5.9842| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.7665
Epoch: 1|  Loss:  0.9719 |Global loss: 3.8626| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.7255
Epoch: 2|  Loss:  0.968 |Global loss: 3.8058| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.732
Epoch: 3|  Loss:  1.0193 |Global loss: 3.683| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 5.021880149841309
Chosen Clients:  [9, 0, 3, 13, 6, 12]

-------------Round number: 189-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [118.99, 119.449, 119.083, 118.986, 119.174, 118.651, 119.3, 119.237, 118.967, 119.272, 119.01, 119.648, 119.387, 118.112, 119.377]
F1 Score:  [0.983, 0.982, 0.982, 0.973, 0.944, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.903, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.907, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8198
Averaged Test Accurancy: 0.9722
Averaged Test AUC: 0.9926
Averaged Test F1_score: 0.9703
Averaged Test Recal score: 0.9735
Std Test Accurancy: 0.0192
Std Test AUC: 0.0030
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.7574
Epoch: 0|  Loss:  0.8988 |Global loss: 4.5512| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.597
Epoch: 1|  Loss:  0.7467 |Global loss: 3.4043| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.5879
Epoch: 2|  Loss:  0.7421 |Global loss: 3.2672| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.5955
Epoch: 3|  Loss:  0.7526 |Global loss: 3.4564| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9267
Epoch: 0|  Loss:  1.0841 |Global loss: 5.6316| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6791
Epoch: 1|  Loss:  0.8572 |Global loss: 3.6725| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.7084
Epoch: 2|  Loss:  0.945 |Global loss: 3.727| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6318
Epoch: 3|  Loss:  0.8224 |Global loss: 3.5128| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.0289
Epoch: 0|  Loss:  1.1963 |Global loss: 5.6895| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.6223
Epoch: 1|  Loss:  0.7689 |Global loss: 3.6728| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.6516
Epoch: 2|  Loss:  0.7981 |Global loss: 3.7222| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.6014
Epoch: 3|  Loss:  0.7476 |Global loss: 3.4883| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9746
Epoch: 0|  Loss:  1.2342 |Global loss: 5.6248| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.7667
Epoch: 1|  Loss:  1.02 |Global loss: 3.8422| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.6989
Epoch: 2|  Loss:  0.9646 |Global loss: 3.8549| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.6795
Epoch: 3|  Loss:  0.9279 |Global loss: 3.5707| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.8936
Epoch: 0|  Loss:  1.0288 |Global loss: 5.5053| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.6263
Epoch: 1|  Loss:  0.7786 |Global loss: 3.8359| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.6383
Epoch: 2|  Loss:  0.7966 |Global loss: 3.6936| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.6375
Epoch: 3|  Loss:  0.7943 |Global loss: 3.7086| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9967
Epoch: 0|  Loss:  1.1884 |Global loss: 5.7537| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 0.773
Epoch: 1|  Loss:  1.0258 |Global loss: 4.139| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 0.7053
Epoch: 2|  Loss:  0.9182 |Global loss: 3.9786| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.7126
Epoch: 3|  Loss:  0.915 |Global loss: 3.7501| Local H loss: 0.0255  | Global H loss: 0.0255
------------------------- time cost ------------------------- 4.895866870880127
Chosen Clients:  [2, 5, 14, 13, 4, 3]

-------------Round number: 190-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.925, 0.975]
AUC in each clients:  [119.064, 119.449, 119.083, 119.069, 119.174, 118.651, 119.268, 119.237, 118.967, 119.222, 119.01, 119.647, 118.751, 118.352, 119.377]
F1 Score:  [0.975, 0.982, 0.982, 0.973, 0.944, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.945, 0.932, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8782
Averaged Test Accurancy: 0.9706
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9698
Averaged Test Recal score: 0.9739
Std Test Accurancy: 0.0172
Std Test AUC: 0.0026
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.0096
Epoch: 0|  Loss:  1.254 |Global loss: 5.8076| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.7419
Epoch: 1|  Loss:  0.9672 |Global loss: 4.0312| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.62
Epoch: 2|  Loss:  0.847 |Global loss: 3.6273| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.6867
Epoch: 3|  Loss:  0.9404 |Global loss: 3.5715| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9801
Epoch: 0|  Loss:  1.167 |Global loss: 5.3549| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.6416
Epoch: 1|  Loss:  0.8308 |Global loss: 3.5014| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6507
Epoch: 2|  Loss:  0.8228 |Global loss: 3.2753| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.6604
Epoch: 3|  Loss:  0.8591 |Global loss: 3.3102| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9532
Epoch: 0|  Loss:  1.1041 |Global loss: 5.0148| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6435
Epoch: 1|  Loss:  0.7994 |Global loss: 3.8874| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.6016
Epoch: 2|  Loss:  0.7576 |Global loss: 3.4332| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.6009
Epoch: 3|  Loss:  0.764 |Global loss: 3.5828| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 1.0067
Epoch: 0|  Loss:  1.2539 |Global loss: 4.9266| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.7476
Epoch: 1|  Loss:  1.0109 |Global loss: 3.8233| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.687
Epoch: 2|  Loss:  0.952 |Global loss: 3.6647| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.7029
Epoch: 3|  Loss:  0.9532 |Global loss: 3.4667| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9768
Epoch: 0|  Loss:  1.1707 |Global loss: 5.2602| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.6455
Epoch: 1|  Loss:  0.8801 |Global loss: 3.4668| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.6202
Epoch: 2|  Loss:  0.9172 |Global loss: 3.3676| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.5927
Epoch: 3|  Loss:  0.8146 |Global loss: 3.2244| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.8971
Epoch: 0|  Loss:  1.0371 |Global loss: 5.1213| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6325
Epoch: 1|  Loss:  0.7905 |Global loss: 3.476| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.6317
Epoch: 2|  Loss:  0.7984 |Global loss: 3.49| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.6727
Epoch: 3|  Loss:  0.8955 |Global loss: 3.5526| Local H loss: 0.0291  | Global H loss: 0.0291
------------------------- time cost ------------------------- 4.770249128341675
Chosen Clients:  [9, 11, 2, 1, 13, 8]

-------------Round number: 191-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.967, 0.975]
AUC in each clients:  [119.064, 119.449, 119.051, 118.957, 118.814, 118.545, 119.268, 119.237, 118.967, 119.222, 119.01, 119.647, 118.751, 118.62, 119.278]
F1 Score:  [0.975, 0.982, 0.982, 0.973, 0.953, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.945, 0.961, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.956, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.963, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6406
Averaged Test Accurancy: 0.9739
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.9723
Averaged Test Recal score: 0.9757
Std Test Accurancy: 0.0113
Std Test AUC: 0.0024
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.789
Epoch: 0|  Loss:  0.9316 |Global loss: 4.7433| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.5852
Epoch: 1|  Loss:  0.7338 |Global loss: 3.3634| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.5802
Epoch: 2|  Loss:  0.7323 |Global loss: 3.3005| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.5889
Epoch: 3|  Loss:  0.7437 |Global loss: 3.1426| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8478
Epoch: 0|  Loss:  0.9798 |Global loss: 5.7463| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6536
Epoch: 1|  Loss:  0.8016 |Global loss: 3.9347| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.6574
Epoch: 2|  Loss:  0.8107 |Global loss: 3.5423| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.6611
Epoch: 3|  Loss:  0.8123 |Global loss: 3.6131| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9639
Epoch: 0|  Loss:  1.2721 |Global loss: 5.3866| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.7186
Epoch: 1|  Loss:  0.9549 |Global loss: 3.7822| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6921
Epoch: 2|  Loss:  0.9415 |Global loss: 3.7301| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.6364
Epoch: 3|  Loss:  0.8669 |Global loss: 3.4942| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 0.9834
Epoch: 0|  Loss:  1.1373 |Global loss: 5.6559| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6963
Epoch: 1|  Loss:  0.8482 |Global loss: 4.3502| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.6851
Epoch: 2|  Loss:  0.8348 |Global loss: 4.0258| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.7132
Epoch: 3|  Loss:  0.8685 |Global loss: 3.9009| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9327
Epoch: 0|  Loss:  1.1351 |Global loss: 5.4013| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.7018
Epoch: 1|  Loss:  0.9418 |Global loss: 3.6024| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.687
Epoch: 2|  Loss:  0.9158 |Global loss: 3.8046| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.7086
Epoch: 3|  Loss:  0.9473 |Global loss: 3.9242| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.8291
Epoch: 0|  Loss:  0.9793 |Global loss: 4.5462| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.7167
Epoch: 1|  Loss:  0.8969 |Global loss: 3.6026| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.5926
Epoch: 2|  Loss:  0.7559 |Global loss: 3.1026| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.6601
Epoch: 3|  Loss:  0.9277 |Global loss: 3.2182| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 4.73302698135376
Chosen Clients:  [0, 4, 9, 13, 6, 11]

-------------Round number: 192-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.942, 0.917, 0.975]
AUC in each clients:  [119.064, 119.503, 119.117, 118.957, 118.814, 118.545, 119.268, 119.237, 119.0, 119.167, 119.01, 119.697, 118.751, 118.374, 119.278]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.953, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.982, 0.945, 0.925, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.956, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.956, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8941
Averaged Test Accurancy: 0.9711
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9705
Averaged Test Recal score: 0.9745
Std Test Accurancy: 0.0185
Std Test AUC: 0.0028
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9978
Epoch: 0|  Loss:  1.1844 |Global loss: 5.6027| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.6905
Epoch: 1|  Loss:  0.874 |Global loss: 3.6012| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.6132
Epoch: 2|  Loss:  0.7988 |Global loss: 3.574| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.6302
Epoch: 3|  Loss:  0.8154 |Global loss: 3.6153| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.8764
Epoch: 0|  Loss:  1.1112 |Global loss: 5.4825| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.7207
Epoch: 1|  Loss:  1.0022 |Global loss: 3.9161| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.6147
Epoch: 2|  Loss:  0.9311 |Global loss: 3.5247| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.6232
Epoch: 3|  Loss:  0.9083 |Global loss: 3.2369| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.8515
Epoch: 0|  Loss:  0.988 |Global loss: 4.6806| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6192
Epoch: 1|  Loss:  0.7716 |Global loss: 3.4628| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.6499
Epoch: 2|  Loss:  0.8063 |Global loss: 3.4368| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.618
Epoch: 3|  Loss:  0.7737 |Global loss: 3.1144| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 1.1975
Epoch: 0|  Loss:  1.4192 |Global loss: 6.5297| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 1|  NKD Loss: 0.9449
Epoch: 1|  Loss:  1.2092 |Global loss: 4.465| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9056
Epoch: 2|  Loss:  1.1819 |Global loss: 4.5095| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.8775
Epoch: 3|  Loss:  1.1429 |Global loss: 4.5288| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.9868
Epoch: 0|  Loss:  1.1263 |Global loss: 5.7188| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.6808
Epoch: 1|  Loss:  0.834 |Global loss: 3.8289| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.5952
Epoch: 2|  Loss:  0.759 |Global loss: 3.7043| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.5873
Epoch: 3|  Loss:  0.7456 |Global loss: 3.4838| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8373
Epoch: 0|  Loss:  0.9633 |Global loss: 5.4844| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.6643
Epoch: 1|  Loss:  0.8098 |Global loss: 3.9755| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6501
Epoch: 2|  Loss:  0.797 |Global loss: 3.8073| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.6793
Epoch: 3|  Loss:  0.8287 |Global loss: 3.629| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 4.771298170089722
Chosen Clients:  [10, 5, 0, 7, 14, 2]

-------------Round number: 193-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.942, 0.958, 0.975]
AUC in each clients:  [119.079, 119.503, 119.117, 118.957, 118.769, 118.545, 119.3, 119.237, 119.0, 119.268, 119.01, 119.642, 118.751, 119.116, 119.278]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.941, 0.992, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.945, 0.96, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.946, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.956, 0.967, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7650
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9718
Averaged Test Recal score: 0.9758
Std Test Accurancy: 0.0130
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9619
Epoch: 0|  Loss:  1.1001 |Global loss: 5.5068| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.668
Epoch: 1|  Loss:  0.8154 |Global loss: 3.9835| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.7076
Epoch: 2|  Loss:  0.8569 |Global loss: 3.8644| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6024
Epoch: 3|  Loss:  0.7542 |Global loss: 3.6132| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9212
Epoch: 0|  Loss:  1.0755 |Global loss: 4.698| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.5789
Epoch: 1|  Loss:  0.7579 |Global loss: 3.3361| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.5582
Epoch: 2|  Loss:  0.7532 |Global loss: 3.3449| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.612
Epoch: 3|  Loss:  0.8366 |Global loss: 3.3863| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9248
Epoch: 0|  Loss:  1.0901 |Global loss: 5.2474| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.6888
Epoch: 1|  Loss:  0.8682 |Global loss: 3.7158| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.6518
Epoch: 2|  Loss:  0.8256 |Global loss: 3.5851| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.6291
Epoch: 3|  Loss:  0.8149 |Global loss: 3.4631| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.025
Epoch: 0|  Loss:  1.1517 |Global loss: 6.2635| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 0.5963
Epoch: 1|  Loss:  0.7362 |Global loss: 3.7005| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.5502
Epoch: 2|  Loss:  0.6946 |Global loss: 3.4587| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.5081
Epoch: 3|  Loss:  0.653 |Global loss: 3.364| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.8265
Epoch: 0|  Loss:  0.9665 |Global loss: 4.9771| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.5739
Epoch: 1|  Loss:  0.7359 |Global loss: 3.4755| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.5969
Epoch: 2|  Loss:  0.7502 |Global loss: 3.6864| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.6359
Epoch: 3|  Loss:  0.7939 |Global loss: 3.5659| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 1.0489
Epoch: 0|  Loss:  1.292 |Global loss: 5.7609| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.7956
Epoch: 1|  Loss:  1.0598 |Global loss: 4.3237| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.7535
Epoch: 2|  Loss:  1.0601 |Global loss: 4.0116| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.6887
Epoch: 3|  Loss:  0.904 |Global loss: 3.6386| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 5.177410840988159
Chosen Clients:  [5, 8, 12, 6, 2, 7]

-------------Round number: 194-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.942, 0.958, 0.975]
AUC in each clients:  [119.026, 119.503, 118.894, 118.957, 118.769, 118.561, 119.3, 119.203, 119.0, 119.268, 118.983, 119.642, 118.751, 119.116, 119.443]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.941, 0.992, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.945, 0.96, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.946, 0.993, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.956, 0.967, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7802
Averaged Test Accurancy: 0.9739
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9725
Averaged Test Recal score: 0.9764
Std Test Accurancy: 0.0132
Std Test AUC: 0.0024
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8477
Epoch: 0|  Loss:  1.0275 |Global loss: 4.8315| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.6069
Epoch: 1|  Loss:  0.8023 |Global loss: 3.2449| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.6787
Epoch: 2|  Loss:  0.8753 |Global loss: 3.1527| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.5758
Epoch: 3|  Loss:  0.7533 |Global loss: 3.1454| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.8219
Epoch: 0|  Loss:  0.9705 |Global loss: 4.5756| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.5749
Epoch: 1|  Loss:  0.7282 |Global loss: 3.3395| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.5701
Epoch: 2|  Loss:  0.7372 |Global loss: 3.1069| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.6322
Epoch: 3|  Loss:  0.8298 |Global loss: 3.2168| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9249
Epoch: 0|  Loss:  1.0828 |Global loss: 5.8846| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 0.6557
Epoch: 1|  Loss:  0.8276 |Global loss: 3.8848| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.6403
Epoch: 2|  Loss:  0.8137 |Global loss: 3.7263| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.6643
Epoch: 3|  Loss:  0.8325 |Global loss: 3.5023| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.8593
Epoch: 0|  Loss:  1.0008 |Global loss: 5.2384| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.7123
Epoch: 1|  Loss:  0.8724 |Global loss: 3.8694| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.6187
Epoch: 2|  Loss:  0.7767 |Global loss: 3.5124| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.6412
Epoch: 3|  Loss:  0.8145 |Global loss: 3.5066| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8582
Epoch: 0|  Loss:  1.1692 |Global loss: 5.4451| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.7312
Epoch: 1|  Loss:  0.9958 |Global loss: 4.0287| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.661
Epoch: 2|  Loss:  0.911 |Global loss: 3.7614| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.6589
Epoch: 3|  Loss:  0.8771 |Global loss: 3.5166| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8871
Epoch: 0|  Loss:  1.012 |Global loss: 5.7266| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 1|  NKD Loss: 0.5482
Epoch: 1|  Loss:  0.6938 |Global loss: 3.551| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.5429
Epoch: 2|  Loss:  0.6892 |Global loss: 3.5453| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.6078
Epoch: 3|  Loss:  0.7972 |Global loss: 3.5687| Local H loss: 0.0256  | Global H loss: 0.0256
------------------------- time cost ------------------------- 4.887959241867065
Chosen Clients:  [8, 12, 6, 13, 9, 1]

-------------Round number: 195-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.983, 0.975, 0.975, 0.983, 0.958, 0.975]
AUC in each clients:  [119.026, 119.503, 118.946, 118.957, 118.769, 118.449, 119.188, 119.195, 118.714, 119.268, 118.983, 119.642, 119.067, 119.116, 119.443]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.941, 0.983, 0.974, 0.982, 0.974, 0.981, 0.973, 0.973, 0.983, 0.96, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.984, 0.977, 0.977, 0.987, 0.967, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9306
Averaged Test Accurancy: 0.9761
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9744
Averaged Test Recal score: 0.9780
Std Test Accurancy: 0.0096
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.831
Epoch: 0|  Loss:  0.9781 |Global loss: 4.6668| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.6424
Epoch: 1|  Loss:  0.8163 |Global loss: 3.3023| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.6235
Epoch: 2|  Loss:  0.7966 |Global loss: 3.1745| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.5373
Epoch: 3|  Loss:  0.6918 |Global loss: 2.9611| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.0883
Epoch: 0|  Loss:  1.3081 |Global loss: 5.3731| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 0.6659
Epoch: 1|  Loss:  0.826 |Global loss: 4.0325| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 0.6558
Epoch: 2|  Loss:  0.8544 |Global loss: 3.692| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.6802
Epoch: 3|  Loss:  0.8915 |Global loss: 3.5928| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.0086
Epoch: 0|  Loss:  1.1415 |Global loss: 5.6783| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.76
Epoch: 1|  Loss:  0.9234 |Global loss: 4.0541| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.675
Epoch: 2|  Loss:  0.8293 |Global loss: 3.7101| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.6931
Epoch: 3|  Loss:  0.867 |Global loss: 3.671| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 1.0336
Epoch: 0|  Loss:  1.2897 |Global loss: 5.3511| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.7261
Epoch: 1|  Loss:  0.973 |Global loss: 3.5144| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.7008
Epoch: 2|  Loss:  0.9502 |Global loss: 3.5119| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6568
Epoch: 3|  Loss:  0.8786 |Global loss: 3.4137| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.786
Epoch: 0|  Loss:  0.9288 |Global loss: 4.6533| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.5889
Epoch: 1|  Loss:  0.7421 |Global loss: 3.2681| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.605
Epoch: 2|  Loss:  0.7644 |Global loss: 3.4293| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.5285
Epoch: 3|  Loss:  0.6849 |Global loss: 3.0619| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9317
Epoch: 0|  Loss:  1.0563 |Global loss: 6.0879| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.7324
Epoch: 1|  Loss:  0.8793 |Global loss: 4.6346| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.6329
Epoch: 2|  Loss:  0.7808 |Global loss: 4.1552| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.6118
Epoch: 3|  Loss:  0.7636 |Global loss: 3.8604| Local H loss: 0.0321  | Global H loss: 0.0321
------------------------- time cost ------------------------- 4.695292949676514
Chosen Clients:  [12, 13, 7, 4, 10, 9]

-------------Round number: 196-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.967, 0.95, 0.975]
AUC in each clients:  [119.026, 119.463, 118.946, 118.957, 118.769, 118.449, 119.346, 119.195, 118.718, 119.239, 118.983, 119.642, 118.712, 118.523, 119.443]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.941, 0.983, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.967, 0.942, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.946, 0.986, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.972, 0.944, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7508
Averaged Test Accurancy: 0.9739
Averaged Test AUC: 0.9919
Averaged Test F1_score: 0.9716
Averaged Test Recal score: 0.9750
Std Test Accurancy: 0.0105
Std Test AUC: 0.0029
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8835
Epoch: 0|  Loss:  1.0467 |Global loss: 5.3094| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 0.6779
Epoch: 1|  Loss:  0.8844 |Global loss: 3.8748| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 0.6332
Epoch: 2|  Loss:  0.8161 |Global loss: 3.6369| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.6428
Epoch: 3|  Loss:  0.8283 |Global loss: 3.5569| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9944
Epoch: 0|  Loss:  1.256 |Global loss: 5.7043| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.6975
Epoch: 1|  Loss:  0.962 |Global loss: 3.6297| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.6261
Epoch: 2|  Loss:  0.8691 |Global loss: 3.3693| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.6284
Epoch: 3|  Loss:  0.8476 |Global loss: 3.367| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.7711
Epoch: 0|  Loss:  0.9138 |Global loss: 5.1751| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 0.5906
Epoch: 1|  Loss:  0.7977 |Global loss: 3.5956| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.5323
Epoch: 2|  Loss:  0.6845 |Global loss: 3.2747| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.5078
Epoch: 3|  Loss:  0.6595 |Global loss: 3.1454| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.8912
Epoch: 0|  Loss:  1.1249 |Global loss: 5.2556| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.5755
Epoch: 1|  Loss:  0.8501 |Global loss: 3.2693| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.6496
Epoch: 2|  Loss:  0.9166 |Global loss: 3.3211| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.6008
Epoch: 3|  Loss:  0.8883 |Global loss: 3.19| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 1.0324
Epoch: 0|  Loss:  1.1706 |Global loss: 6.2635| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6743
Epoch: 1|  Loss:  0.8625 |Global loss: 3.8906| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6595
Epoch: 2|  Loss:  0.8155 |Global loss: 3.9181| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.5848
Epoch: 3|  Loss:  0.7344 |Global loss: 3.5462| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.7649
Epoch: 0|  Loss:  0.9032 |Global loss: 4.6079| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5861
Epoch: 1|  Loss:  0.7382 |Global loss: 3.2439| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.5707
Epoch: 2|  Loss:  0.7295 |Global loss: 3.2082| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.5532
Epoch: 3|  Loss:  0.7124 |Global loss: 3.0693| Local H loss: 0.0329  | Global H loss: 0.0329
------------------------- time cost ------------------------- 4.720077753067017
Chosen Clients:  [2, 5, 4, 13, 7, 1]

-------------Round number: 197-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.95, 0.983, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.95, 0.975]
AUC in each clients:  [119.026, 119.463, 118.946, 118.957, 119.021, 118.449, 119.346, 119.141, 118.718, 119.349, 118.954, 119.642, 119.045, 118.586, 119.443]
F1 Score:  [0.983, 0.981, 0.982, 0.973, 0.944, 0.983, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.982, 0.952, 0.973]
Recall Score:  [0.986, 0.984, 0.984, 0.977, 0.947, 0.986, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.986, 0.96, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9870
Averaged Test Accurancy: 0.9750
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9735
Averaged Test Recal score: 0.9771
Std Test Accurancy: 0.0105
Std Test AUC: 0.0027
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.1003
Epoch: 0|  Loss:  1.301 |Global loss: 6.6768| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 0.7222
Epoch: 1|  Loss:  1.0615 |Global loss: 4.078| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.728
Epoch: 2|  Loss:  1.0609 |Global loss: 3.748| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.7679
Epoch: 3|  Loss:  1.087 |Global loss: 3.6815| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9681
Epoch: 0|  Loss:  1.1424 |Global loss: 5.5705| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.6494
Epoch: 1|  Loss:  0.8468 |Global loss: 3.2532| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.5638
Epoch: 2|  Loss:  0.763 |Global loss: 3.179| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.5927
Epoch: 3|  Loss:  0.7658 |Global loss: 3.1466| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.7902
Epoch: 0|  Loss:  1.0073 |Global loss: 4.5643| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.6155
Epoch: 1|  Loss:  0.8999 |Global loss: 3.2131| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.5971
Epoch: 2|  Loss:  0.9049 |Global loss: 3.5105| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.635
Epoch: 3|  Loss:  0.8649 |Global loss: 3.1378| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.9674
Epoch: 0|  Loss:  1.1911 |Global loss: 5.673| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6449
Epoch: 1|  Loss:  0.8604 |Global loss: 3.4653| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.7188
Epoch: 2|  Loss:  0.9682 |Global loss: 3.3634| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.6525
Epoch: 3|  Loss:  0.8861 |Global loss: 3.7771| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.285
Epoch: 0|  Loss:  1.3944 |Global loss: 8.294| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 1|  NKD Loss: 0.6974
Epoch: 1|  Loss:  0.8432 |Global loss: 4.6302| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 0.6721
Epoch: 2|  Loss:  0.8245 |Global loss: 3.9873| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 0.6114
Epoch: 3|  Loss:  0.7533 |Global loss: 3.9033| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.0184
Epoch: 0|  Loss:  1.1519 |Global loss: 6.5374| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 0.675
Epoch: 1|  Loss:  0.8149 |Global loss: 4.6449| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 0.6439
Epoch: 2|  Loss:  0.7905 |Global loss: 4.1621| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.6632
Epoch: 3|  Loss:  0.8154 |Global loss: 3.8222| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.831966876983643
Chosen Clients:  [4, 12, 10, 7, 1, 2]

-------------Round number: 198-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.933, 0.975, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [119.026, 118.991, 118.986, 118.957, 119.176, 118.425, 119.346, 119.464, 118.718, 119.349, 118.954, 119.642, 119.045, 118.98, 119.443]
F1 Score:  [0.983, 0.887, 0.973, 0.973, 0.954, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.982, 0.966, 0.973]
Recall Score:  [0.986, 0.91, 0.975, 0.977, 0.957, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.986, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9607
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9688
Averaged Test Recal score: 0.9734
Std Test Accurancy: 0.0130
Std Test AUC: 0.0025
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 0.8015
Epoch: 0|  Loss:  1.0302 |Global loss: 4.4892| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.6079
Epoch: 1|  Loss:  0.8385 |Global loss: 3.4732| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.551
Epoch: 2|  Loss:  0.7926 |Global loss: 3.298| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.5825
Epoch: 3|  Loss:  0.8293 |Global loss: 3.1806| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.0816 |Global loss: 4.9757| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.666
Epoch: 1|  Loss:  0.8585 |Global loss: 3.7804| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.6392
Epoch: 2|  Loss:  0.8098 |Global loss: 3.6387| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.668
Epoch: 3|  Loss:  0.8745 |Global loss: 3.7165| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.1524
Epoch: 0|  Loss:  1.2697 |Global loss: 7.7737| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 0.7777
Epoch: 1|  Loss:  0.8854 |Global loss: 5.8984| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 0.764
Epoch: 2|  Loss:  0.8834 |Global loss: 5.6709| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.7693
Epoch: 3|  Loss:  0.9034 |Global loss: 5.4528| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 0.8281
Epoch: 0|  Loss:  0.9914 |Global loss: 4.8378| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.5918
Epoch: 1|  Loss:  0.7459 |Global loss: 3.573| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.5476
Epoch: 2|  Loss:  0.7079 |Global loss: 3.3881| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.5101
Epoch: 3|  Loss:  0.6694 |Global loss: 3.2586| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.0211
Epoch: 0|  Loss:  1.1481 |Global loss: 6.2236| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.7212
Epoch: 1|  Loss:  0.9427 |Global loss: 4.7001| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.6218
Epoch: 2|  Loss:  0.7742 |Global loss: 3.8542| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.6601
Epoch: 3|  Loss:  0.8683 |Global loss: 4.186| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.9594
Epoch: 0|  Loss:  1.2174 |Global loss: 6.3447| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 0.7012
Epoch: 1|  Loss:  0.8808 |Global loss: 4.391| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.6953
Epoch: 2|  Loss:  0.9398 |Global loss: 3.7265| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.6556
Epoch: 3|  Loss:  0.8774 |Global loss: 3.3576| Local H loss: 0.0357  | Global H loss: 0.0357
------------------------- time cost ------------------------- 4.645782947540283
Chosen Clients:  [10, 12, 2, 11, 9, 4]

-------------Round number: 199-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [119.026, 119.414, 118.983, 118.957, 119.172, 118.425, 119.346, 119.261, 118.718, 119.349, 119.061, 119.642, 118.983, 118.98, 119.443]
F1 Score:  [0.983, 0.992, 0.982, 0.973, 0.944, 0.992, 0.974, 0.982, 0.974, 0.973, 0.965, 0.973, 0.983, 0.966, 0.973]
Recall Score:  [0.986, 0.993, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.977, 0.966, 0.977, 0.987, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6766
Averaged Test Accurancy: 0.9767
Averaged Test AUC: 0.9926
Averaged Test F1_score: 0.9753
Averaged Test Recal score: 0.9782
Std Test Accurancy: 0.0102
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9924
Epoch: 0|  Loss:  1.1278 |Global loss: 5.507| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.7893
Epoch: 1|  Loss:  0.9306 |Global loss: 4.4324| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.7448
Epoch: 2|  Loss:  0.9132 |Global loss: 4.1776| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.7236
Epoch: 3|  Loss:  0.8724 |Global loss: 4.0063| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9121
Epoch: 0|  Loss:  1.0883 |Global loss: 5.1526| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.7838
Epoch: 1|  Loss:  0.9914 |Global loss: 4.1921| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 0.6878
Epoch: 2|  Loss:  0.8524 |Global loss: 3.7947| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.6833
Epoch: 3|  Loss:  0.8658 |Global loss: 3.588| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.8663
Epoch: 0|  Loss:  1.0966 |Global loss: 5.066| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.7224
Epoch: 1|  Loss:  1.0494 |Global loss: 3.8554| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.671
Epoch: 2|  Loss:  0.929 |Global loss: 3.6359| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.8278
Epoch: 3|  Loss:  1.2704 |Global loss: 4.0386| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 0.878
Epoch: 0|  Loss:  1.0039 |Global loss: 5.3416| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.6731
Epoch: 1|  Loss:  0.8298 |Global loss: 3.5468| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 0.641
Epoch: 2|  Loss:  0.7984 |Global loss: 3.5173| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.6257
Epoch: 3|  Loss:  0.7872 |Global loss: 3.3804| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.9362
Epoch: 0|  Loss:  1.0699 |Global loss: 5.1325| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.5562
Epoch: 1|  Loss:  0.7042 |Global loss: 3.3438| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.5769
Epoch: 2|  Loss:  0.7337 |Global loss: 3.2778| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.5692
Epoch: 3|  Loss:  0.7275 |Global loss: 3.1185| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9374
Epoch: 0|  Loss:  1.1804 |Global loss: 5.0046| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.5785
Epoch: 1|  Loss:  0.7969 |Global loss: 3.4016| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.6036
Epoch: 2|  Loss:  0.8407 |Global loss: 3.2583| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.6177
Epoch: 3|  Loss:  0.8627 |Global loss: 3.2569| Local H loss: 0.0312  | Global H loss: 0.0312
------------------------- time cost ------------------------- 4.801158905029297
Chosen Clients:  [12, 13, 6, 4, 5, 0]

-------------Round number: 200-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [119.026, 119.414, 119.203, 118.957, 119.223, 118.425, 119.346, 119.261, 118.718, 119.188, 119.083, 119.656, 119.061, 118.98, 119.443]
F1 Score:  [0.983, 0.992, 0.982, 0.973, 0.964, 0.992, 0.974, 0.982, 0.974, 0.973, 0.982, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.986, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7144
Averaged Test Accurancy: 0.9783
Averaged Test AUC: 0.9928
Averaged Test F1_score: 0.9771
Averaged Test Recal score: 0.9802
Std Test Accurancy: 0.0073
Std Test AUC: 0.0024
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8832
Epoch: 0|  Loss:  1.0278 |Global loss: 5.4087| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 0.6792
Epoch: 1|  Loss:  0.8642 |Global loss: 3.5737| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.7742
Epoch: 2|  Loss:  1.0414 |Global loss: 3.9851| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.6216
Epoch: 3|  Loss:  0.8076 |Global loss: 3.4559| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 1.1367
Epoch: 0|  Loss:  1.3493 |Global loss: 6.063| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.7407
Epoch: 1|  Loss:  0.998 |Global loss: 3.978| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.7263
Epoch: 2|  Loss:  0.9759 |Global loss: 3.6404| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6157
Epoch: 3|  Loss:  0.8563 |Global loss: 3.6727| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.91
Epoch: 0|  Loss:  1.0472 |Global loss: 5.5154| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6898
Epoch: 1|  Loss:  0.8404 |Global loss: 3.7369| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.6206
Epoch: 2|  Loss:  0.7881 |Global loss: 3.7179| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.5934
Epoch: 3|  Loss:  0.7584 |Global loss: 3.5661| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9059
Epoch: 0|  Loss:  1.1174 |Global loss: 5.2973| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 0.632
Epoch: 1|  Loss:  0.8598 |Global loss: 3.6596| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.6638
Epoch: 2|  Loss:  0.8851 |Global loss: 3.6355| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.6192
Epoch: 3|  Loss:  0.8681 |Global loss: 3.3781| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.8646
Epoch: 0|  Loss:  1.0203 |Global loss: 4.5328| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.5608
Epoch: 1|  Loss:  0.7492 |Global loss: 3.2584| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.5505
Epoch: 2|  Loss:  0.7207 |Global loss: 3.1338| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.5635
Epoch: 3|  Loss:  0.7431 |Global loss: 3.0635| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 0.8212
Epoch: 0|  Loss:  0.998 |Global loss: 5.11| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.648
Epoch: 1|  Loss:  0.8374 |Global loss: 3.9082| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.6148
Epoch: 2|  Loss:  0.8081 |Global loss: 3.707| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.5595
Epoch: 3|  Loss:  0.744 |Global loss: 3.5118| Local H loss: 0.0344  | Global H loss: 0.0344
------------------------- time cost ------------------------- 4.945915699005127
Chosen Clients:  [8, 5, 4, 1, 2, 9]

-------------Round number: 201-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.992, 0.958, 0.975]
AUC in each clients:  [118.962, 119.414, 119.203, 118.957, 119.186, 118.561, 119.158, 119.261, 118.718, 119.188, 119.083, 119.656, 118.911, 119.102, 119.443]
F1 Score:  [0.975, 0.992, 0.982, 0.973, 0.964, 0.992, 0.973, 0.982, 0.974, 0.973, 0.982, 0.973, 0.991, 0.948, 0.973]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.993, 0.949, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5647
Averaged Test Accurancy: 0.9783
Averaged Test AUC: 0.9927
Averaged Test F1_score: 0.9765
Averaged Test Recal score: 0.9791
Std Test Accurancy: 0.0090
Std Test AUC: 0.0022
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8199
Epoch: 0|  Loss:  1.0044 |Global loss: 4.6822| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.6545
Epoch: 1|  Loss:  0.8792 |Global loss: 3.3777| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.5543
Epoch: 2|  Loss:  0.7187 |Global loss: 3.0501| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.5298
Epoch: 3|  Loss:  0.688 |Global loss: 3.1008| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.8491
Epoch: 0|  Loss:  1.0399 |Global loss: 4.9989| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6315
Epoch: 1|  Loss:  0.805 |Global loss: 3.2761| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6228
Epoch: 2|  Loss:  0.7933 |Global loss: 3.0529| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.5245
Epoch: 3|  Loss:  0.6914 |Global loss: 3.1954| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.8018
Epoch: 0|  Loss:  1.0204 |Global loss: 4.3827| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5887
Epoch: 1|  Loss:  0.8582 |Global loss: 3.3176| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.5499
Epoch: 2|  Loss:  0.7939 |Global loss: 3.2205| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.5667
Epoch: 3|  Loss:  0.8075 |Global loss: 3.1559| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8354
Epoch: 0|  Loss:  0.9607 |Global loss: 5.9585| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.7026
Epoch: 1|  Loss:  0.874 |Global loss: 4.6139| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.7371
Epoch: 2|  Loss:  0.9072 |Global loss: 4.3287| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.7054
Epoch: 3|  Loss:  0.862 |Global loss: 4.1051| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.9176
Epoch: 0|  Loss:  1.1338 |Global loss: 5.921| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 0.6878
Epoch: 1|  Loss:  0.9802 |Global loss: 3.9892| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.6722
Epoch: 2|  Loss:  0.8948 |Global loss: 3.7239| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.5976
Epoch: 3|  Loss:  0.7834 |Global loss: 3.2341| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.7981
Epoch: 0|  Loss:  0.9277 |Global loss: 5.2338| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.5267
Epoch: 1|  Loss:  0.6756 |Global loss: 3.2115| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.5055
Epoch: 2|  Loss:  0.6564 |Global loss: 3.0671| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.5497
Epoch: 3|  Loss:  0.7061 |Global loss: 3.0352| Local H loss: 0.033  | Global H loss: 0.033
------------------------- time cost ------------------------- 4.769317388534546
Chosen Clients:  [10, 12, 2, 14, 13, 1]

-------------Round number: 202-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.992, 0.958, 0.975]
AUC in each clients:  [118.962, 119.391, 118.939, 118.957, 119.181, 118.516, 119.158, 119.261, 118.766, 119.158, 119.083, 119.656, 118.911, 119.102, 119.443]
F1 Score:  [0.975, 0.992, 0.982, 0.973, 0.964, 0.992, 0.973, 0.982, 0.973, 0.973, 0.982, 0.973, 0.991, 0.948, 0.973]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.993, 0.949, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1066
Averaged Test Accurancy: 0.9783
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9764
Averaged Test Recal score: 0.9791
Std Test Accurancy: 0.0090
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.1915
Epoch: 0|  Loss:  1.3252 |Global loss: 7.843| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 0.7844
Epoch: 1|  Loss:  0.8984 |Global loss: 5.5897| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 0.7549
Epoch: 2|  Loss:  0.8854 |Global loss: 5.2657| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.7299
Epoch: 3|  Loss:  0.8509 |Global loss: 4.9591| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 1.0647
Epoch: 0|  Loss:  1.303 |Global loss: 5.6611| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 0.6519
Epoch: 1|  Loss:  0.8276 |Global loss: 3.8601| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.6552
Epoch: 2|  Loss:  0.8415 |Global loss: 3.6065| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.6078
Epoch: 3|  Loss:  0.8229 |Global loss: 3.5808| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.9974
Epoch: 0|  Loss:  1.2767 |Global loss: 5.4221| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.6641
Epoch: 1|  Loss:  0.8723 |Global loss: 3.6119| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.6483
Epoch: 2|  Loss:  0.9327 |Global loss: 3.5249| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.7691
Epoch: 3|  Loss:  1.2043 |Global loss: 3.7484| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.8315
Epoch: 0|  Loss:  0.9851 |Global loss: 4.9411| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.5815
Epoch: 1|  Loss:  0.7337 |Global loss: 3.5988| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5604
Epoch: 2|  Loss:  0.7198 |Global loss: 3.4202| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.5646
Epoch: 3|  Loss:  0.7307 |Global loss: 3.4984| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.1316
Epoch: 0|  Loss:  1.357 |Global loss: 5.7326| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.681
Epoch: 1|  Loss:  0.9351 |Global loss: 3.5863| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.611
Epoch: 2|  Loss:  0.8646 |Global loss: 3.4594| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.5791
Epoch: 3|  Loss:  0.8379 |Global loss: 3.2292| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9681
Epoch: 0|  Loss:  1.1099 |Global loss: 6.4217| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.688
Epoch: 1|  Loss:  0.826 |Global loss: 4.5321| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.6413
Epoch: 2|  Loss:  0.7994 |Global loss: 4.035| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.6643
Epoch: 3|  Loss:  0.8364 |Global loss: 3.9928| Local H loss: 0.031  | Global H loss: 0.031
------------------------- time cost ------------------------- 5.2493064403533936
Chosen Clients:  [0, 11, 4, 12, 5, 2]

-------------Round number: 203-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [118.962, 119.488, 118.928, 118.957, 119.181, 118.516, 119.158, 119.261, 118.766, 119.158, 119.144, 119.656, 118.874, 118.724, 119.429]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.964, 0.992, 0.973, 0.982, 0.973, 0.973, 0.982, 0.973, 0.974, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6711
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9757
Averaged Test Recal score: 0.9790
Std Test Accurancy: 0.0064
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0000
Epoch: 0|  NKD Loss: 1.0453
Epoch: 0|  Loss:  1.2144 |Global loss: 5.7377| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.6346
Epoch: 1|  Loss:  0.8233 |Global loss: 3.7133| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.6086
Epoch: 2|  Loss:  0.8163 |Global loss: 3.593| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6285
Epoch: 3|  Loss:  0.8334 |Global loss: 3.5656| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8258
Epoch: 0|  Loss:  0.9591 |Global loss: 4.9961| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.612
Epoch: 1|  Loss:  0.7644 |Global loss: 3.5431| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.6798
Epoch: 2|  Loss:  0.8361 |Global loss: 3.5661| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.5856
Epoch: 3|  Loss:  0.7442 |Global loss: 3.3348| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.7298
Epoch: 0|  Loss:  0.9345 |Global loss: 4.7536| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 0.5803
Epoch: 1|  Loss:  0.8173 |Global loss: 3.3698| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.583
Epoch: 2|  Loss:  0.8582 |Global loss: 3.1816| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.5331
Epoch: 3|  Loss:  0.7773 |Global loss: 3.1231| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9581
Epoch: 0|  Loss:  1.123 |Global loss: 4.8813| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.7541
Epoch: 1|  Loss:  0.9406 |Global loss: 3.9767| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 0.6766
Epoch: 2|  Loss:  0.8649 |Global loss: 3.7021| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.6457
Epoch: 3|  Loss:  0.8285 |Global loss: 3.4228| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8428
Epoch: 0|  Loss:  1.0055 |Global loss: 4.932| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.5853
Epoch: 1|  Loss:  0.7657 |Global loss: 3.2857| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.5347
Epoch: 2|  Loss:  0.7056 |Global loss: 3.1535| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.6077
Epoch: 3|  Loss:  0.8061 |Global loss: 3.0823| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.8861
Epoch: 0|  Loss:  1.0698 |Global loss: 5.1148| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6653
Epoch: 1|  Loss:  0.8443 |Global loss: 3.6653| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.6494
Epoch: 2|  Loss:  0.9674 |Global loss: 3.7061| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.6467
Epoch: 3|  Loss:  0.8562 |Global loss: 3.4151| Local H loss: 0.0321  | Global H loss: 0.0321
------------------------- time cost ------------------------- 5.0175461769104
Chosen Clients:  [4, 10, 14, 7, 0, 9]

-------------Round number: 204-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [118.954, 119.488, 118.848, 118.957, 119.139, 118.629, 119.158, 119.261, 118.766, 119.158, 119.144, 119.673, 118.948, 118.724, 119.429]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.952, 0.992, 0.973, 0.982, 0.973, 0.973, 0.982, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.956, 0.993, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7556
Averaged Test Accurancy: 0.9767
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9749
Averaged Test Recal score: 0.9782
Std Test Accurancy: 0.0076
Std Test AUC: 0.0024
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8543
Epoch: 0|  Loss:  1.0906 |Global loss: 4.9583| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.6529
Epoch: 1|  Loss:  0.8902 |Global loss: 3.4598| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.6019
Epoch: 2|  Loss:  0.8349 |Global loss: 3.1968| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.5834
Epoch: 3|  Loss:  0.8451 |Global loss: 3.1539| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 1.0442
Epoch: 0|  Loss:  1.1664 |Global loss: 7.5549| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 1|  NKD Loss: 0.7546
Epoch: 1|  Loss:  0.9025 |Global loss: 4.203| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.6437
Epoch: 2|  Loss:  0.7877 |Global loss: 3.7534| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.7208
Epoch: 3|  Loss:  0.8687 |Global loss: 3.8175| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 0.8001
Epoch: 0|  Loss:  0.938 |Global loss: 4.9293| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.6609
Epoch: 1|  Loss:  0.8483 |Global loss: 4.0022| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.6102
Epoch: 2|  Loss:  0.7664 |Global loss: 3.5046| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.55
Epoch: 3|  Loss:  0.7051 |Global loss: 3.1143| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.1568 |Global loss: 5.9314| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 0.5725
Epoch: 1|  Loss:  0.7309 |Global loss: 3.6499| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.5575
Epoch: 2|  Loss:  0.7265 |Global loss: 3.2831| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.5372
Epoch: 3|  Loss:  0.6915 |Global loss: 3.1588| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9303
Epoch: 0|  Loss:  1.0983 |Global loss: 5.1498| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.648
Epoch: 1|  Loss:  0.8192 |Global loss: 3.802| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.5829
Epoch: 2|  Loss:  0.7606 |Global loss: 3.5597| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.5937
Epoch: 3|  Loss:  0.7722 |Global loss: 3.3797| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.7741
Epoch: 0|  Loss:  0.9129 |Global loss: 4.4077| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.5882
Epoch: 1|  Loss:  0.738 |Global loss: 3.2811| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.5873
Epoch: 2|  Loss:  0.7424 |Global loss: 3.1195| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.5859
Epoch: 3|  Loss:  0.7459 |Global loss: 3.0136| Local H loss: 0.0333  | Global H loss: 0.0333
------------------------- time cost ------------------------- 5.5782554149627686
Chosen Clients:  [2, 12, 6, 4, 3, 13]

-------------Round number: 205-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [118.937, 119.488, 118.848, 118.957, 119.14, 118.629, 119.158, 119.071, 118.766, 119.188, 119.174, 119.673, 118.948, 118.724, 119.389]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.952, 0.992, 0.973, 0.991, 0.973, 0.973, 0.982, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.956, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8359
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9755
Averaged Test Recal score: 0.9788
Std Test Accurancy: 0.0083
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.912
Epoch: 0|  Loss:  1.117 |Global loss: 5.0629| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.6394
Epoch: 1|  Loss:  0.824 |Global loss: 3.7746| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.6543
Epoch: 2|  Loss:  0.8535 |Global loss: 3.4643| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6606
Epoch: 3|  Loss:  0.8427 |Global loss: 3.3607| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8726
Epoch: 0|  Loss:  1.0271 |Global loss: 5.1386| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 0.6639
Epoch: 1|  Loss:  0.834 |Global loss: 3.8594| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.602
Epoch: 2|  Loss:  0.7712 |Global loss: 3.5587| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.8369
Epoch: 3|  Loss:  1.01 |Global loss: 4.0652| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.9407
Epoch: 0|  Loss:  1.0873 |Global loss: 6.3664| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.6564
Epoch: 1|  Loss:  0.803 |Global loss: 4.0708| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.6178
Epoch: 2|  Loss:  0.7826 |Global loss: 3.8007| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.7263
Epoch: 3|  Loss:  0.893 |Global loss: 3.5867| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.7541
Epoch: 0|  Loss:  0.9561 |Global loss: 4.4111| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.5573
Epoch: 1|  Loss:  0.7752 |Global loss: 3.1381| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.5309
Epoch: 2|  Loss:  0.7507 |Global loss: 3.1395| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.5687
Epoch: 3|  Loss:  0.8211 |Global loss: 3.1564| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.828
Epoch: 0|  Loss:  0.9917 |Global loss: 4.8566| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.6141
Epoch: 1|  Loss:  0.7788 |Global loss: 3.4204| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.5913
Epoch: 2|  Loss:  0.7542 |Global loss: 3.1324| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.543
Epoch: 3|  Loss:  0.7007 |Global loss: 3.1488| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 1.0737
Epoch: 0|  Loss:  1.3142 |Global loss: 5.5996| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 0.6269
Epoch: 1|  Loss:  0.8667 |Global loss: 3.4453| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6885
Epoch: 2|  Loss:  0.9099 |Global loss: 3.3613| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.6439
Epoch: 3|  Loss:  0.8796 |Global loss: 3.4864| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 4.862778663635254
Chosen Clients:  [10, 12, 6, 4, 1, 9]

-------------Round number: 206-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.95, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [118.937, 119.488, 119.002, 118.977, 119.182, 118.629, 119.208, 119.071, 118.766, 119.188, 119.174, 119.673, 118.808, 118.752, 119.389]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.944, 0.992, 0.973, 0.991, 0.973, 0.973, 0.982, 0.973, 0.983, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.947, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.977, 0.987, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5697
Averaged Test Accurancy: 0.9772
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9756
Averaged Test Recal score: 0.9788
Std Test Accurancy: 0.0098
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9231
Epoch: 0|  Loss:  1.0426 |Global loss: 6.1082| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.7372
Epoch: 1|  Loss:  0.8813 |Global loss: 3.9593| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6496
Epoch: 2|  Loss:  0.7966 |Global loss: 3.7442| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.6006
Epoch: 3|  Loss:  0.7452 |Global loss: 3.6549| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9561
Epoch: 0|  Loss:  1.1562 |Global loss: 5.6952| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 0.642
Epoch: 1|  Loss:  0.8164 |Global loss: 3.6885| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.684
Epoch: 2|  Loss:  0.9086 |Global loss: 3.9747| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 0.6927
Epoch: 3|  Loss:  0.9157 |Global loss: 3.5223| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.8819
Epoch: 0|  Loss:  1.0125 |Global loss: 5.5308| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6265
Epoch: 1|  Loss:  0.778 |Global loss: 3.7671| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.5937
Epoch: 2|  Loss:  0.7578 |Global loss: 3.4408| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.6399
Epoch: 3|  Loss:  0.8021 |Global loss: 3.3641| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.8411
Epoch: 0|  Loss:  1.1061 |Global loss: 5.0452| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.5569
Epoch: 1|  Loss:  0.8089 |Global loss: 3.2303| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.5941
Epoch: 2|  Loss:  0.8221 |Global loss: 3.217| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.5934
Epoch: 3|  Loss:  0.8242 |Global loss: 3.1089| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9025
Epoch: 0|  Loss:  1.0168 |Global loss: 6.2468| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 0.714
Epoch: 1|  Loss:  0.8506 |Global loss: 4.4029| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.6779
Epoch: 2|  Loss:  0.8362 |Global loss: 3.9101| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.633
Epoch: 3|  Loss:  0.7829 |Global loss: 3.8118| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.768
Epoch: 0|  Loss:  0.9021 |Global loss: 4.6391| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.5697
Epoch: 1|  Loss:  0.722 |Global loss: 3.1364| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5779
Epoch: 2|  Loss:  0.7323 |Global loss: 3.2061| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.5663
Epoch: 3|  Loss:  0.7167 |Global loss: 3.1862| Local H loss: 0.0307  | Global H loss: 0.0307
------------------------- time cost ------------------------- 4.9748194217681885
Chosen Clients:  [11, 6, 5, 0, 8, 12]

-------------Round number: 207-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.967, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [118.937, 119.462, 119.002, 118.977, 119.208, 118.629, 119.334, 119.071, 118.766, 119.166, 119.063, 119.673, 118.901, 118.752, 119.389]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.963, 0.992, 0.974, 0.991, 0.973, 0.973, 0.982, 0.973, 0.983, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.966, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.977, 0.987, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6607
Averaged Test Accurancy: 0.9783
Averaged Test AUC: 0.9924
Averaged Test F1_score: 0.9769
Averaged Test Recal score: 0.9801
Std Test Accurancy: 0.0073
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9177
Epoch: 0|  Loss:  1.0479 |Global loss: 5.0638| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.698
Epoch: 1|  Loss:  0.85 |Global loss: 3.7896| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.5847
Epoch: 2|  Loss:  0.7446 |Global loss: 3.3482| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.5964
Epoch: 3|  Loss:  0.7537 |Global loss: 3.3638| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9846
Epoch: 0|  Loss:  1.1189 |Global loss: 5.2067| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.6105
Epoch: 1|  Loss:  0.7669 |Global loss: 3.5767| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.6483
Epoch: 2|  Loss:  0.8172 |Global loss: 3.6211| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.5558
Epoch: 3|  Loss:  0.7206 |Global loss: 3.2257| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.784
Epoch: 0|  Loss:  0.9312 |Global loss: 4.9693| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.5559
Epoch: 1|  Loss:  0.7354 |Global loss: 3.1503| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.6052
Epoch: 2|  Loss:  0.7857 |Global loss: 3.2094| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 0.6274
Epoch: 3|  Loss:  0.8062 |Global loss: 3.0412| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.8757
Epoch: 0|  Loss:  1.0644 |Global loss: 5.207| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.6407
Epoch: 1|  Loss:  0.8099 |Global loss: 3.8115| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.6922
Epoch: 2|  Loss:  0.8783 |Global loss: 3.7477| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6577
Epoch: 3|  Loss:  0.8408 |Global loss: 3.4568| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 1.0003
Epoch: 0|  Loss:  1.2291 |Global loss: 4.8132| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 0.6644
Epoch: 1|  Loss:  0.8217 |Global loss: 3.4469| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.5732
Epoch: 2|  Loss:  0.745 |Global loss: 3.0328| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.5477
Epoch: 3|  Loss:  0.7112 |Global loss: 3.0025| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0599
Epoch: 0|  Loss:  1.2382 |Global loss: 5.6748| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 1|  NKD Loss: 0.7041
Epoch: 1|  Loss:  0.8996 |Global loss: 3.9257| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.6854
Epoch: 2|  Loss:  0.8803 |Global loss: 3.8304| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 0.5961
Epoch: 3|  Loss:  0.7722 |Global loss: 3.3604| Local H loss: 0.027  | Global H loss: 0.027
------------------------- time cost ------------------------- 4.80171012878418
Chosen Clients:  [1, 6, 4, 11, 12, 3]

-------------Round number: 208-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.967, 0.992, 0.975, 0.992, 0.975, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [119.011, 119.462, 119.002, 118.977, 119.208, 118.594, 119.331, 119.071, 118.787, 119.166, 119.063, 119.686, 118.953, 118.752, 119.389]
F1 Score:  [0.982, 0.981, 0.982, 0.973, 0.963, 0.992, 0.974, 0.991, 0.974, 0.973, 0.982, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.984, 0.984, 0.984, 0.977, 0.966, 0.993, 0.977, 0.993, 0.977, 0.977, 0.984, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9993
Averaged Test Accurancy: 0.9783
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9768
Averaged Test Recal score: 0.9799
Std Test Accurancy: 0.0073
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9402
Epoch: 0|  Loss:  1.0607 |Global loss: 6.2215| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.6744
Epoch: 1|  Loss:  0.8206 |Global loss: 4.7036| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.7408
Epoch: 2|  Loss:  0.9052 |Global loss: 4.1793| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.7125
Epoch: 3|  Loss:  0.859 |Global loss: 4.1815| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.9691
Epoch: 0|  Loss:  1.0996 |Global loss: 6.282| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.6364
Epoch: 1|  Loss:  0.7875 |Global loss: 3.9172| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.646
Epoch: 2|  Loss:  0.8121 |Global loss: 3.5231| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.6156
Epoch: 3|  Loss:  0.7797 |Global loss: 3.4493| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.799
Epoch: 0|  Loss:  1.0171 |Global loss: 4.829| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.5716
Epoch: 1|  Loss:  0.7761 |Global loss: 3.2709| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.5778
Epoch: 2|  Loss:  0.8323 |Global loss: 3.111| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.5385
Epoch: 3|  Loss:  0.7585 |Global loss: 3.1257| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9195
Epoch: 0|  Loss:  1.0477 |Global loss: 5.4026| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6646
Epoch: 1|  Loss:  0.8108 |Global loss: 3.6764| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6455
Epoch: 2|  Loss:  0.7987 |Global loss: 3.3594| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.5649
Epoch: 3|  Loss:  0.7219 |Global loss: 3.3219| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9283
Epoch: 0|  Loss:  1.087 |Global loss: 5.3536| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 0.6279
Epoch: 1|  Loss:  0.7955 |Global loss: 3.7361| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 0.6536
Epoch: 2|  Loss:  0.8242 |Global loss: 3.5312| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.6632
Epoch: 3|  Loss:  0.8684 |Global loss: 3.6864| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.852
Epoch: 0|  Loss:  0.9948 |Global loss: 4.9388| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5642
Epoch: 1|  Loss:  0.7197 |Global loss: 3.2617| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.5337
Epoch: 2|  Loss:  0.6883 |Global loss: 3.1495| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.5855
Epoch: 3|  Loss:  0.7473 |Global loss: 3.0349| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 4.879910707473755
Chosen Clients:  [5, 8, 1, 2, 9, 14]

-------------Round number: 209-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.983, 0.975, 0.958, 0.992, 0.95, 0.992, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [119.011, 119.461, 119.002, 119.004, 119.027, 118.594, 118.933, 119.071, 118.787, 119.166, 119.063, 119.698, 118.848, 118.752, 119.389]
F1 Score:  [0.982, 0.981, 0.982, 0.973, 0.953, 0.992, 0.941, 0.991, 0.974, 0.973, 0.982, 0.973, 0.982, 0.966, 0.973]
Recall Score:  [0.984, 0.984, 0.984, 0.977, 0.956, 0.993, 0.947, 0.993, 0.977, 0.977, 0.984, 0.977, 0.986, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1885
Averaged Test Accurancy: 0.9767
Averaged Test AUC: 0.9921
Averaged Test F1_score: 0.9745
Averaged Test Recal score: 0.9778
Std Test Accurancy: 0.0111
Std Test AUC: 0.0023
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.0609 |Global loss: 4.9818| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.5916
Epoch: 1|  Loss:  0.7649 |Global loss: 3.1456| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.5892
Epoch: 2|  Loss:  0.7709 |Global loss: 3.1096| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.5419
Epoch: 3|  Loss:  0.709 |Global loss: 3.1422| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9127
Epoch: 0|  Loss:  1.0694 |Global loss: 5.0965| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.6199
Epoch: 1|  Loss:  0.8309 |Global loss: 3.2671| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.5623
Epoch: 2|  Loss:  0.7219 |Global loss: 3.0763| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.5054
Epoch: 3|  Loss:  0.6636 |Global loss: 2.9488| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.0104
Epoch: 0|  Loss:  1.1451 |Global loss: 6.8447| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 1|  NKD Loss: 0.6958
Epoch: 1|  Loss:  0.8588 |Global loss: 4.6845| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.6039
Epoch: 2|  Loss:  0.7473 |Global loss: 3.8944| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.6246
Epoch: 3|  Loss:  0.7791 |Global loss: 3.7067| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 1.0216
Epoch: 0|  Loss:  1.1945 |Global loss: 5.2582| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.7243
Epoch: 1|  Loss:  0.9435 |Global loss: 3.9194| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.5935
Epoch: 2|  Loss:  0.7932 |Global loss: 3.2526| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.6229
Epoch: 3|  Loss:  0.8274 |Global loss: 3.464| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.8587
Epoch: 0|  Loss:  0.9965 |Global loss: 4.8122| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.5479
Epoch: 1|  Loss:  0.7039 |Global loss: 3.1045| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.5451
Epoch: 2|  Loss:  0.6994 |Global loss: 3.0665| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.5346
Epoch: 3|  Loss:  0.6906 |Global loss: 2.9085| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.9499
Epoch: 0|  Loss:  1.086 |Global loss: 5.5028| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6312
Epoch: 1|  Loss:  0.7899 |Global loss: 3.72| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.5153
Epoch: 2|  Loss:  0.6744 |Global loss: 3.1937| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.5146
Epoch: 3|  Loss:  0.6705 |Global loss: 3.2359| Local H loss: 0.0345  | Global H loss: 0.0345
------------------------- time cost ------------------------- 4.7718329429626465
Chosen Clients:  [8, 14, 10, 1, 12, 5]

-------------Round number: 210-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.958, 0.983, 0.95, 0.992, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.975]
AUC in each clients:  [119.011, 119.518, 118.596, 119.004, 119.027, 118.576, 118.933, 119.071, 118.885, 119.174, 119.063, 119.698, 118.848, 118.752, 119.423]
F1 Score:  [0.982, 0.981, 0.974, 0.973, 0.953, 0.983, 0.941, 0.991, 0.974, 0.973, 0.982, 0.973, 0.982, 0.966, 0.973]
Recall Score:  [0.984, 0.984, 0.978, 0.977, 0.956, 0.986, 0.947, 0.993, 0.977, 0.977, 0.984, 0.977, 0.986, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2845
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9920
Averaged Test F1_score: 0.9734
Averaged Test Recal score: 0.9769
Std Test Accurancy: 0.0103
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9267
Epoch: 0|  Loss:  1.0666 |Global loss: 4.3571| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6262
Epoch: 1|  Loss:  0.7808 |Global loss: 3.1675| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.617
Epoch: 2|  Loss:  0.7759 |Global loss: 3.0215| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.7585
Epoch: 3|  Loss:  1.0142 |Global loss: 3.4816| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.861
Epoch: 0|  Loss:  1.0067 |Global loss: 5.1923| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.5734
Epoch: 1|  Loss:  0.7347 |Global loss: 3.3532| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.5514
Epoch: 2|  Loss:  0.7059 |Global loss: 3.4124| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5739
Epoch: 3|  Loss:  0.7345 |Global loss: 3.0297| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 1.0498
Epoch: 0|  Loss:  1.1765 |Global loss: 5.8684| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.8185
Epoch: 1|  Loss:  0.9519 |Global loss: 4.5372| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.815
Epoch: 2|  Loss:  0.9919 |Global loss: 4.4173| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.7389
Epoch: 3|  Loss:  0.8852 |Global loss: 3.9295| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.977
Epoch: 0|  Loss:  1.11 |Global loss: 6.2524| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.6859
Epoch: 1|  Loss:  0.8134 |Global loss: 4.7134| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.6772
Epoch: 2|  Loss:  0.8278 |Global loss: 4.2712| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.6381
Epoch: 3|  Loss:  0.816 |Global loss: 4.2621| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9786
Epoch: 0|  Loss:  1.146 |Global loss: 5.3971| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 0.7464
Epoch: 1|  Loss:  0.9455 |Global loss: 4.1952| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 0.731
Epoch: 2|  Loss:  0.9181 |Global loss: 3.9478| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.7073
Epoch: 3|  Loss:  0.8953 |Global loss: 3.7528| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.8442
Epoch: 0|  Loss:  1.0259 |Global loss: 4.5727| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.5647
Epoch: 1|  Loss:  0.7284 |Global loss: 3.3379| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.574
Epoch: 2|  Loss:  0.7578 |Global loss: 3.2681| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.5556
Epoch: 3|  Loss:  0.721 |Global loss: 3.1477| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 5.008050441741943
Chosen Clients:  [0, 8, 11, 1, 10, 3]

-------------Round number: 211-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.983, 0.975, 0.975, 0.958, 0.992, 0.95, 0.992, 0.975, 0.975, 0.975, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [119.011, 119.542, 118.596, 119.004, 119.027, 118.548, 118.933, 119.071, 119.068, 119.174, 119.044, 119.698, 119.085, 118.752, 119.388]
F1 Score:  [0.982, 0.981, 0.974, 0.973, 0.953, 0.992, 0.941, 0.991, 0.974, 0.973, 0.973, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.984, 0.984, 0.978, 0.977, 0.956, 0.993, 0.947, 0.993, 0.977, 0.977, 0.977, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3322
Averaged Test Accurancy: 0.9750
Averaged Test AUC: 0.9922
Averaged Test F1_score: 0.9728
Averaged Test Recal score: 0.9764
Std Test Accurancy: 0.0105
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9783
Epoch: 0|  Loss:  1.1627 |Global loss: 5.4404| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.6166
Epoch: 1|  Loss:  0.8002 |Global loss: 3.7827| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.5873
Epoch: 2|  Loss:  0.7744 |Global loss: 3.6393| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.5989
Epoch: 3|  Loss:  0.7833 |Global loss: 3.453| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9863
Epoch: 0|  Loss:  1.125 |Global loss: 4.8539| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.5559
Epoch: 1|  Loss:  0.736 |Global loss: 3.0107| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.6028
Epoch: 2|  Loss:  0.8012 |Global loss: 3.1982| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.5208
Epoch: 3|  Loss:  0.7149 |Global loss: 2.9568| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.034
Epoch: 0|  Loss:  1.1665 |Global loss: 5.1161| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.7277
Epoch: 1|  Loss:  0.8757 |Global loss: 3.669| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.6123
Epoch: 2|  Loss:  0.7623 |Global loss: 3.4833| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.6166
Epoch: 3|  Loss:  0.7739 |Global loss: 3.2802| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 1.0779
Epoch: 0|  Loss:  1.2151 |Global loss: 5.7203| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.6321
Epoch: 1|  Loss:  0.7698 |Global loss: 4.3434| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.6261
Epoch: 2|  Loss:  0.7722 |Global loss: 3.8496| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.6526
Epoch: 3|  Loss:  0.7964 |Global loss: 3.9289| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.1316
Epoch: 0|  Loss:  1.2788 |Global loss: 5.6555| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.6987
Epoch: 1|  Loss:  0.8398 |Global loss: 3.87| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.6499
Epoch: 2|  Loss:  0.8268 |Global loss: 3.8317| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.5771
Epoch: 3|  Loss:  0.7247 |Global loss: 3.5138| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 1.1376
Epoch: 0|  Loss:  1.279 |Global loss: 5.599| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.6023
Epoch: 1|  Loss:  0.7633 |Global loss: 3.4294| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.5417
Epoch: 2|  Loss:  0.704 |Global loss: 3.2529| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.5705
Epoch: 3|  Loss:  0.7297 |Global loss: 3.1474| Local H loss: 0.0323  | Global H loss: 0.0323
------------------------- time cost ------------------------- 4.758384943008423
Chosen Clients:  [14, 11, 9, 13, 7, 5]

-------------Round number: 212-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.958, 0.992, 0.95, 0.992, 0.975, 0.975, 0.975, 0.975, 0.975, 0.967, 0.975]
AUC in each clients:  [119.011, 119.559, 118.596, 119.004, 119.027, 118.548, 118.933, 119.071, 118.83, 119.174, 119.018, 119.665, 119.085, 118.752, 119.388]
F1 Score:  [0.975, 0.981, 0.974, 0.973, 0.953, 0.992, 0.941, 0.991, 0.974, 0.973, 0.973, 0.973, 0.973, 0.966, 0.973]
Recall Score:  [0.977, 0.984, 0.978, 0.977, 0.956, 0.993, 0.947, 0.993, 0.977, 0.977, 0.977, 0.977, 0.978, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1556
Averaged Test Accurancy: 0.9744
Averaged Test AUC: 0.9920
Averaged Test F1_score: 0.9723
Averaged Test Recal score: 0.9759
Std Test Accurancy: 0.0103
Std Test AUC: 0.0025
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.7448
Epoch: 0|  Loss:  0.8858 |Global loss: 4.6413| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.5435
Epoch: 1|  Loss:  0.6972 |Global loss: 3.5741| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.5555
Epoch: 2|  Loss:  0.7303 |Global loss: 3.555| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.5337
Epoch: 3|  Loss:  0.6879 |Global loss: 3.1751| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.9258
Epoch: 0|  Loss:  1.0575 |Global loss: 5.1521| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.681
Epoch: 1|  Loss:  0.8319 |Global loss: 3.7156| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.6524
Epoch: 2|  Loss:  0.8043 |Global loss: 3.5352| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.6359
Epoch: 3|  Loss:  0.7909 |Global loss: 3.4507| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9389
Epoch: 0|  Loss:  1.0694 |Global loss: 4.9508| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.6275
Epoch: 1|  Loss:  0.7728 |Global loss: 3.7012| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.5848
Epoch: 2|  Loss:  0.7352 |Global loss: 3.3295| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.5343
Epoch: 3|  Loss:  0.6892 |Global loss: 2.9862| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9486
Epoch: 0|  Loss:  1.1661 |Global loss: 4.8575| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.6896
Epoch: 1|  Loss:  0.8993 |Global loss: 3.7526| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.6224
Epoch: 2|  Loss:  0.8415 |Global loss: 3.412| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.5929
Epoch: 3|  Loss:  0.8146 |Global loss: 3.2852| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 1.2507
Epoch: 0|  Loss:  1.3738 |Global loss: 7.3497| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 0.6319
Epoch: 1|  Loss:  0.758 |Global loss: 4.8646| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 2|  NKD Loss: 0.72
Epoch: 2|  Loss:  0.8536 |Global loss: 4.5015| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 0.6819
Epoch: 3|  Loss:  0.8551 |Global loss: 4.2169| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 0.9904
Epoch: 0|  Loss:  1.1649 |Global loss: 4.8209| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.5592
Epoch: 1|  Loss:  0.7544 |Global loss: 3.1119| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.6153
Epoch: 2|  Loss:  0.7901 |Global loss: 3.04| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 0.5403
Epoch: 3|  Loss:  0.7154 |Global loss: 3.0273| Local H loss: 0.0328  | Global H loss: 0.0328
------------------------- time cost ------------------------- 4.973323822021484
Chosen Clients:  [8, 13, 2, 9, 3, 10]

-------------Round number: 213-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.958, 0.992, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.95, 0.975]
AUC in each clients:  [119.011, 119.559, 118.596, 119.004, 119.027, 118.577, 118.933, 119.51, 118.83, 119.187, 119.018, 119.629, 119.085, 118.717, 119.426]
F1 Score:  [0.975, 0.981, 0.974, 0.973, 0.953, 0.992, 0.941, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.933, 0.973]
Recall Score:  [0.977, 0.984, 0.978, 0.977, 0.956, 0.993, 0.947, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.935, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5760
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9695
Averaged Test Recal score: 0.9729
Std Test Accurancy: 0.0112
Std Test AUC: 0.0027
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9406
Epoch: 0|  Loss:  1.0889 |Global loss: 6.21| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 0.6664
Epoch: 1|  Loss:  0.823 |Global loss: 3.913| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 0.8121
Epoch: 2|  Loss:  1.0676 |Global loss: 4.0781| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.7014
Epoch: 3|  Loss:  0.9343 |Global loss: 3.6911| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.838
Epoch: 0|  Loss:  1.0409 |Global loss: 4.7148| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.6909
Epoch: 1|  Loss:  0.9347 |Global loss: 3.579| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.6981
Epoch: 2|  Loss:  0.9235 |Global loss: 3.392| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.7361
Epoch: 3|  Loss:  1.0041 |Global loss: 3.325| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.9936
Epoch: 0|  Loss:  1.2731 |Global loss: 5.5434| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.8246
Epoch: 1|  Loss:  1.37 |Global loss: 4.276| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.5996
Epoch: 2|  Loss:  0.8202 |Global loss: 3.3749| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.6476
Epoch: 3|  Loss:  0.9227 |Global loss: 3.3898| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.7503
Epoch: 0|  Loss:  0.8868 |Global loss: 4.4748| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.5245
Epoch: 1|  Loss:  0.6785 |Global loss: 2.9734| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.522
Epoch: 2|  Loss:  0.6785 |Global loss: 2.8687| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 0.5489
Epoch: 3|  Loss:  0.7043 |Global loss: 2.9826| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.8381
Epoch: 0|  Loss:  0.9715 |Global loss: 4.8716| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.5651
Epoch: 1|  Loss:  0.719 |Global loss: 3.2515| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.5676
Epoch: 2|  Loss:  0.7226 |Global loss: 3.2201| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.5623
Epoch: 3|  Loss:  0.722 |Global loss: 3.2475| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.1123
Epoch: 0|  Loss:  1.2676 |Global loss: 8.1064| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 0.7164
Epoch: 1|  Loss:  0.8579 |Global loss: 3.99| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.6237
Epoch: 2|  Loss:  0.7671 |Global loss: 3.7913| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.5627
Epoch: 3|  Loss:  0.7092 |Global loss: 3.4872| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 4.701751708984375
Chosen Clients:  [8, 14, 5, 11, 10, 4]

-------------Round number: 214-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [119.011, 119.559, 118.926, 118.92, 119.027, 118.577, 118.933, 119.51, 119.111, 119.127, 119.039, 119.629, 119.085, 118.691, 119.426]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.953, 0.992, 0.941, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.913, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.956, 0.993, 0.947, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4074
Averaged Test Accurancy: 0.9706
Averaged Test AUC: 0.9925
Averaged Test F1_score: 0.9687
Averaged Test Recal score: 0.9731
Std Test Accurancy: 0.0192
Std Test AUC: 0.0025
Std Test F1: 0.0002
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9044
Epoch: 0|  Loss:  1.0865 |Global loss: 4.8812| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 0.5999
Epoch: 1|  Loss:  0.7903 |Global loss: 3.275| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.5905
Epoch: 2|  Loss:  0.841 |Global loss: 3.1989| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.6473
Epoch: 3|  Loss:  0.8348 |Global loss: 3.0426| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.7377
Epoch: 0|  Loss:  0.8779 |Global loss: 5.1156| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.5559
Epoch: 1|  Loss:  0.708 |Global loss: 3.3084| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.6127
Epoch: 2|  Loss:  0.764 |Global loss: 3.3196| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.513
Epoch: 3|  Loss:  0.6649 |Global loss: 3.1485| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.8791
Epoch: 0|  Loss:  1.0481 |Global loss: 5.11| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.4906
Epoch: 1|  Loss:  0.6597 |Global loss: 3.1314| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.5518
Epoch: 2|  Loss:  0.7254 |Global loss: 3.0104| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.5046
Epoch: 3|  Loss:  0.6693 |Global loss: 2.9966| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.8559
Epoch: 0|  Loss:  0.9861 |Global loss: 4.9716| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.6086
Epoch: 1|  Loss:  0.7559 |Global loss: 3.5881| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.5469
Epoch: 2|  Loss:  0.7016 |Global loss: 3.2687| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.5633
Epoch: 3|  Loss:  0.7277 |Global loss: 3.2631| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 1.0344
Epoch: 0|  Loss:  1.1602 |Global loss: 7.2835| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 1|  NKD Loss: 0.716
Epoch: 1|  Loss:  0.833 |Global loss: 5.5544| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 2|  NKD Loss: 0.7715
Epoch: 2|  Loss:  0.9005 |Global loss: 5.1289| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.8023
Epoch: 3|  Loss:  0.944 |Global loss: 4.9964| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.7464
Epoch: 0|  Loss:  0.9536 |Global loss: 4.6288| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.5625
Epoch: 1|  Loss:  0.7752 |Global loss: 3.205| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.5499
Epoch: 2|  Loss:  0.7567 |Global loss: 3.1109| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.5732
Epoch: 3|  Loss:  0.8255 |Global loss: 3.1103| Local H loss: 0.0299  | Global H loss: 0.0299
------------------------- time cost ------------------------- 4.85335898399353
Chosen Clients:  [13, 12, 9, 11, 0, 14]

-------------Round number: 215-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.908, 0.975]
AUC in each clients:  [119.011, 119.559, 118.926, 118.92, 119.226, 118.647, 118.933, 119.51, 118.966, 119.127, 119.138, 119.656, 119.085, 118.691, 119.398]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.954, 0.992, 0.941, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.913, 0.973]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.957, 0.993, 0.947, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.932, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8612
Averaged Test Accurancy: 0.9706
Averaged Test AUC: 0.9927
Averaged Test F1_score: 0.9688
Averaged Test Recal score: 0.9732
Std Test Accurancy: 0.0192
Std Test AUC: 0.0024
Std Test F1: 0.0002
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.0252
Epoch: 0|  Loss:  1.2244 |Global loss: 5.6544| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.6353
Epoch: 1|  Loss:  0.8576 |Global loss: 3.3808| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.6959
Epoch: 2|  Loss:  0.9177 |Global loss: 3.4873| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.6182
Epoch: 3|  Loss:  0.8643 |Global loss: 3.4006| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.8867
Epoch: 0|  Loss:  1.0828 |Global loss: 5.6592| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 0.7751
Epoch: 1|  Loss:  0.9506 |Global loss: 4.3114| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.7273
Epoch: 2|  Loss:  0.9014 |Global loss: 3.8099| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.6733
Epoch: 3|  Loss:  0.8469 |Global loss: 3.7252| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.8325
Epoch: 0|  Loss:  0.9665 |Global loss: 4.6764| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.5081
Epoch: 1|  Loss:  0.6621 |Global loss: 2.9541| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.5632
Epoch: 2|  Loss:  0.72 |Global loss: 2.9667| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5373
Epoch: 3|  Loss:  0.6998 |Global loss: 2.9353| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9074
Epoch: 0|  Loss:  1.0393 |Global loss: 5.6276| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6655
Epoch: 1|  Loss:  0.8153 |Global loss: 3.4525| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.7133
Epoch: 2|  Loss:  0.8701 |Global loss: 3.3336| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.5936
Epoch: 3|  Loss:  0.7444 |Global loss: 3.3837| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.8687
Epoch: 0|  Loss:  1.0436 |Global loss: 5.5985| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.6693
Epoch: 1|  Loss:  0.9224 |Global loss: 3.8488| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.629
Epoch: 2|  Loss:  0.8133 |Global loss: 3.4852| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.6078
Epoch: 3|  Loss:  0.7833 |Global loss: 3.3335| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.8443
Epoch: 0|  Loss:  0.9789 |Global loss: 5.2708| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.5484
Epoch: 1|  Loss:  0.7004 |Global loss: 3.4817| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.5088
Epoch: 2|  Loss:  0.6589 |Global loss: 3.2698| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.5399
Epoch: 3|  Loss:  0.6965 |Global loss: 3.2039| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 4.796913146972656
Chosen Clients:  [10, 9, 1, 5, 6, 0]

-------------Round number: 216-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.958, 0.992, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.942, 0.975]
AUC in each clients:  [119.142, 119.559, 118.926, 118.92, 119.226, 118.647, 118.933, 119.51, 118.966, 119.156, 119.138, 119.656, 119.09, 118.997, 119.387]
F1 Score:  [0.975, 0.981, 0.982, 0.973, 0.954, 0.992, 0.941, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.945, 0.975]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.957, 0.993, 0.947, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.955, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6461
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9929
Averaged Test F1_score: 0.9711
Averaged Test Recal score: 0.9747
Std Test Accurancy: 0.0127
Std Test AUC: 0.0022
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9782
Epoch: 0|  Loss:  1.1078 |Global loss: 5.7029| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.7589
Epoch: 1|  Loss:  0.9171 |Global loss: 3.9631| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.6577
Epoch: 2|  Loss:  0.8101 |Global loss: 3.7098| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.6375
Epoch: 3|  Loss:  0.7842 |Global loss: 3.4866| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 0|  NKD Loss: 0.8688
Epoch: 0|  Loss:  0.9982 |Global loss: 5.2925| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 0.5018
Epoch: 1|  Loss:  0.6564 |Global loss: 3.0825| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.5535
Epoch: 2|  Loss:  0.7105 |Global loss: 2.9546| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.5281
Epoch: 3|  Loss:  0.6891 |Global loss: 2.9578| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9155
Epoch: 0|  Loss:  1.0366 |Global loss: 6.1313| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 1|  NKD Loss: 0.6724
Epoch: 1|  Loss:  0.8347 |Global loss: 4.3211| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.6106
Epoch: 2|  Loss:  0.7537 |Global loss: 4.0202| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.5777
Epoch: 3|  Loss:  0.7378 |Global loss: 3.7176| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.8034
Epoch: 0|  Loss:  0.9638 |Global loss: 4.9536| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.6021
Epoch: 1|  Loss:  0.7899 |Global loss: 3.1761| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.5848
Epoch: 2|  Loss:  0.7649 |Global loss: 3.0448| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.5617
Epoch: 3|  Loss:  0.7609 |Global loss: 3.0189| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 0.9173
Epoch: 0|  Loss:  1.0544 |Global loss: 5.3199| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.689
Epoch: 1|  Loss:  0.8503 |Global loss: 3.7359| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.6182
Epoch: 2|  Loss:  0.7879 |Global loss: 3.3471| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.5866
Epoch: 3|  Loss:  0.7521 |Global loss: 3.2222| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.8598
Epoch: 0|  Loss:  1.1084 |Global loss: 4.818| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.7064
Epoch: 1|  Loss:  0.8865 |Global loss: 3.7205| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.6907
Epoch: 2|  Loss:  0.8736 |Global loss: 3.4731| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.5907
Epoch: 3|  Loss:  0.7854 |Global loss: 3.4317| Local H loss: 0.0345  | Global H loss: 0.0345
------------------------- time cost ------------------------- 4.806180477142334
Chosen Clients:  [11, 3, 6, 0, 8, 4]

-------------Round number: 217-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.983, 0.992, 0.983, 0.975, 0.958, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.942, 0.975]
AUC in each clients:  [119.049, 119.471, 118.926, 118.92, 119.226, 118.721, 119.323, 119.51, 118.966, 119.119, 119.048, 119.656, 119.09, 118.997, 119.387]
F1 Score:  [0.983, 0.991, 0.982, 0.973, 0.954, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.945, 0.975]
Recall Score:  [0.986, 0.993, 0.984, 0.977, 0.957, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.955, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9547
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9930
Averaged Test F1_score: 0.9745
Averaged Test Recal score: 0.9779
Std Test Accurancy: 0.0120
Std Test AUC: 0.0021
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8775
Epoch: 0|  Loss:  1.0059 |Global loss: 5.5666| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.6672
Epoch: 1|  Loss:  0.8126 |Global loss: 3.4983| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.6382
Epoch: 2|  Loss:  0.7873 |Global loss: 3.5274| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.5844
Epoch: 3|  Loss:  0.7373 |Global loss: 3.3301| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9474
Epoch: 0|  Loss:  1.0809 |Global loss: 4.9397| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.5634
Epoch: 1|  Loss:  0.7136 |Global loss: 3.3817| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.5634
Epoch: 2|  Loss:  0.721 |Global loss: 3.1562| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.5747
Epoch: 3|  Loss:  0.7381 |Global loss: 3.129| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.9532
Epoch: 0|  Loss:  1.0879 |Global loss: 5.9583| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.6693
Epoch: 1|  Loss:  0.8265 |Global loss: 3.5673| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.6326
Epoch: 2|  Loss:  0.7954 |Global loss: 3.2489| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.6099
Epoch: 3|  Loss:  0.7744 |Global loss: 3.2058| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.9018
Epoch: 0|  Loss:  1.068 |Global loss: 5.5756| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.6296
Epoch: 1|  Loss:  0.8251 |Global loss: 3.5897| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.6022
Epoch: 2|  Loss:  0.7884 |Global loss: 3.5631| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6022
Epoch: 3|  Loss:  0.7917 |Global loss: 3.3426| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9344
Epoch: 0|  Loss:  1.0814 |Global loss: 5.0728| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 0.5545
Epoch: 1|  Loss:  0.7343 |Global loss: 3.0469| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.586
Epoch: 2|  Loss:  0.7432 |Global loss: 3.1137| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.6566
Epoch: 3|  Loss:  0.8777 |Global loss: 3.0573| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.8445
Epoch: 0|  Loss:  1.0654 |Global loss: 5.3671| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 0.6083
Epoch: 1|  Loss:  0.8678 |Global loss: 3.4641| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.5508
Epoch: 2|  Loss:  0.7862 |Global loss: 3.0647| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.5667
Epoch: 3|  Loss:  0.8086 |Global loss: 3.0604| Local H loss: 0.0306  | Global H loss: 0.0306
------------------------- time cost ------------------------- 4.803781747817993
Chosen Clients:  [11, 9, 13, 14, 10, 6]

-------------Round number: 218-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.942, 0.975]
AUC in each clients:  [119.08, 119.471, 118.926, 118.907, 119.158, 118.721, 119.036, 119.51, 119.026, 119.119, 119.048, 119.646, 119.09, 118.997, 119.387]
F1 Score:  [0.974, 0.991, 0.982, 0.973, 0.944, 0.992, 0.973, 0.982, 0.974, 0.973, 0.973, 0.973, 0.973, 0.945, 0.975]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.978, 0.955, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1605
Averaged Test Accurancy: 0.9744
Averaged Test AUC: 0.9928
Averaged Test F1_score: 0.9731
Averaged Test Recal score: 0.9767
Std Test Accurancy: 0.0127
Std Test AUC: 0.0020
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.9533
Epoch: 0|  Loss:  1.0822 |Global loss: 5.4176| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.6904
Epoch: 1|  Loss:  0.8379 |Global loss: 3.7032| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.6596
Epoch: 2|  Loss:  0.8129 |Global loss: 3.2785| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.5833
Epoch: 3|  Loss:  0.7429 |Global loss: 3.1588| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8379
Epoch: 0|  Loss:  0.9772 |Global loss: 4.82| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.5307
Epoch: 1|  Loss:  0.686 |Global loss: 2.8787| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.5697
Epoch: 2|  Loss:  0.729 |Global loss: 2.9595| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.5101
Epoch: 3|  Loss:  0.6673 |Global loss: 2.9207| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9133
Epoch: 0|  Loss:  1.1187 |Global loss: 5.6045| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.663
Epoch: 1|  Loss:  0.8805 |Global loss: 3.884| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.6773
Epoch: 2|  Loss:  0.9278 |Global loss: 3.6394| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.6456
Epoch: 3|  Loss:  0.8623 |Global loss: 3.6496| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8253
Epoch: 0|  Loss:  0.9593 |Global loss: 4.7969| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.6555
Epoch: 1|  Loss:  0.8229 |Global loss: 3.5556| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.5411
Epoch: 2|  Loss:  0.6928 |Global loss: 3.1475| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.5875
Epoch: 3|  Loss:  0.7411 |Global loss: 3.635| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0716
Epoch: 0|  Loss:  1.2216 |Global loss: 5.7413| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.6316
Epoch: 1|  Loss:  0.7719 |Global loss: 3.7451| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.6511
Epoch: 2|  Loss:  0.815 |Global loss: 3.7096| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.6854
Epoch: 3|  Loss:  0.8413 |Global loss: 3.7417| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.891
Epoch: 0|  Loss:  1.0344 |Global loss: 5.0356| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.6801
Epoch: 1|  Loss:  0.8374 |Global loss: 3.5467| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.5561
Epoch: 2|  Loss:  0.7192 |Global loss: 3.1433| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.562
Epoch: 3|  Loss:  0.7253 |Global loss: 3.207| Local H loss: 0.0374  | Global H loss: 0.0374
------------------------- time cost ------------------------- 5.290865898132324
Chosen Clients:  [4, 1, 14, 9, 6, 8]

-------------Round number: 219-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.95, 0.992, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975, 0.975, 0.942, 0.975]
AUC in each clients:  [119.08, 119.471, 118.926, 118.907, 119.158, 118.721, 119.299, 119.51, 119.026, 119.148, 118.948, 119.633, 119.09, 118.879, 119.427]
F1 Score:  [0.974, 0.991, 0.982, 0.973, 0.944, 0.992, 0.974, 0.982, 0.974, 0.973, 0.965, 0.973, 0.973, 0.937, 0.973]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.947, 0.993, 0.977, 0.984, 0.977, 0.977, 0.966, 0.977, 0.978, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0576
Averaged Test Accurancy: 0.9739
Averaged Test AUC: 0.9929
Averaged Test F1_score: 0.9720
Averaged Test Recal score: 0.9748
Std Test Accurancy: 0.0129
Std Test AUC: 0.0021
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.8486
Epoch: 0|  Loss:  1.0339 |Global loss: 5.7122| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 0.6165
Epoch: 1|  Loss:  0.8647 |Global loss: 3.2852| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.5548
Epoch: 2|  Loss:  0.767 |Global loss: 3.2232| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.5475
Epoch: 3|  Loss:  0.7422 |Global loss: 2.9992| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.0755
Epoch: 0|  Loss:  1.1891 |Global loss: 7.3835| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 0.5718
Epoch: 1|  Loss:  0.7058 |Global loss: 4.1952| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.6966
Epoch: 2|  Loss:  0.842 |Global loss: 4.0836| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.7026
Epoch: 3|  Loss:  0.8565 |Global loss: 3.6933| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8936
Epoch: 0|  Loss:  1.0237 |Global loss: 5.5241| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.5524
Epoch: 1|  Loss:  0.7005 |Global loss: 3.6898| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.5939
Epoch: 2|  Loss:  0.7533 |Global loss: 3.5075| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.5425
Epoch: 3|  Loss:  0.6956 |Global loss: 3.3085| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.7842
Epoch: 0|  Loss:  0.9252 |Global loss: 4.7705| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.5038
Epoch: 1|  Loss:  0.6566 |Global loss: 2.901| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.5221
Epoch: 2|  Loss:  0.6773 |Global loss: 2.9088| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.5504
Epoch: 3|  Loss:  0.7089 |Global loss: 2.7329| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9546
Epoch: 0|  Loss:  1.0905 |Global loss: 5.532| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.5797
Epoch: 1|  Loss:  0.7376 |Global loss: 3.2726| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.6403
Epoch: 2|  Loss:  0.8069 |Global loss: 3.3762| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.6158
Epoch: 3|  Loss:  0.7794 |Global loss: 3.1799| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9911
Epoch: 0|  Loss:  1.1311 |Global loss: 5.3775| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 0.5686
Epoch: 1|  Loss:  0.7225 |Global loss: 3.2845| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.5625
Epoch: 2|  Loss:  0.7309 |Global loss: 3.1957| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.7072
Epoch: 3|  Loss:  0.9314 |Global loss: 3.4709| Local H loss: 0.0241  | Global H loss: 0.0241
------------------------- time cost ------------------------- 4.832933187484741
Chosen Clients:  [12, 8, 13, 9, 3, 5]

-------------Round number: 220-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975, 0.975, 0.942, 0.975]
AUC in each clients:  [119.08, 119.483, 118.926, 118.907, 119.235, 118.721, 119.277, 119.51, 119.002, 119.127, 118.948, 119.633, 119.09, 118.879, 119.442]
F1 Score:  [0.974, 0.991, 0.982, 0.973, 0.964, 0.992, 0.974, 0.982, 0.974, 0.973, 0.965, 0.973, 0.973, 0.937, 0.973]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.966, 0.977, 0.978, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2902
Averaged Test Accurancy: 0.9750
Averaged Test AUC: 0.9929
Averaged Test F1_score: 0.9733
Averaged Test Recal score: 0.9762
Std Test Accurancy: 0.0114
Std Test AUC: 0.0022
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 1.1588
Epoch: 0|  Loss:  1.3202 |Global loss: 6.4315| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 0.6833
Epoch: 1|  Loss:  0.851 |Global loss: 4.1618| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 0.6387
Epoch: 2|  Loss:  0.86 |Global loss: 4.0641| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 0.6018
Epoch: 3|  Loss:  0.7694 |Global loss: 3.7231| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 1.2138
Epoch: 0|  Loss:  1.3414 |Global loss: 6.9523| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 0.64
Epoch: 1|  Loss:  0.7933 |Global loss: 3.8018| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 0.6871
Epoch: 2|  Loss:  0.8524 |Global loss: 3.4946| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.6225
Epoch: 3|  Loss:  0.785 |Global loss: 3.3529| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9558
Epoch: 0|  Loss:  1.1721 |Global loss: 5.374| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.5514
Epoch: 1|  Loss:  0.7702 |Global loss: 3.3423| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.6432
Epoch: 2|  Loss:  0.8678 |Global loss: 3.2781| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.5961
Epoch: 3|  Loss:  0.8415 |Global loss: 3.3071| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 0.8098
Epoch: 0|  Loss:  0.9482 |Global loss: 4.4923| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.6235
Epoch: 1|  Loss:  0.7824 |Global loss: 3.2214| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.5046
Epoch: 2|  Loss:  0.6591 |Global loss: 2.8127| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.5827
Epoch: 3|  Loss:  0.7419 |Global loss: 2.8382| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 1.1025
Epoch: 0|  Loss:  1.2288 |Global loss: 5.9212| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.6388
Epoch: 1|  Loss:  0.795 |Global loss: 4.0437| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.5911
Epoch: 2|  Loss:  0.7506 |Global loss: 3.6502| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.5945
Epoch: 3|  Loss:  0.7491 |Global loss: 3.6994| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8585
Epoch: 0|  Loss:  1.0098 |Global loss: 4.7105| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.5412
Epoch: 1|  Loss:  0.7124 |Global loss: 2.9928| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.5766
Epoch: 2|  Loss:  0.7461 |Global loss: 2.9597| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.5387
Epoch: 3|  Loss:  0.7135 |Global loss: 3.0184| Local H loss: 0.0318  | Global H loss: 0.0318
------------------------- time cost ------------------------- 4.854925632476807
Chosen Clients:  [14, 9, 10, 8, 13, 0]

-------------Round number: 221-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.967, 0.975, 0.958, 0.967, 0.975]
AUC in each clients:  [119.08, 119.483, 118.926, 118.938, 119.235, 118.659, 119.277, 119.51, 119.08, 119.155, 118.948, 119.633, 118.823, 119.112, 119.442]
F1 Score:  [0.974, 0.991, 0.982, 0.973, 0.964, 0.992, 0.974, 0.982, 0.974, 0.973, 0.965, 0.973, 0.957, 0.966, 0.973]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.966, 0.977, 0.963, 0.971, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4489
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9929
Averaged Test F1_score: 0.9742
Averaged Test Recal score: 0.9774
Std Test Accurancy: 0.0089
Std Test AUC: 0.0022
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.744
Epoch: 0|  Loss:  0.8757 |Global loss: 4.7068| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.5632
Epoch: 1|  Loss:  0.7175 |Global loss: 3.5802| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.5986
Epoch: 2|  Loss:  0.752 |Global loss: 3.4066| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.5856
Epoch: 3|  Loss:  0.7354 |Global loss: 3.4782| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.8439
Epoch: 0|  Loss:  0.976 |Global loss: 4.9188| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.5457
Epoch: 1|  Loss:  0.7003 |Global loss: 3.1276| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.5797
Epoch: 2|  Loss:  0.7451 |Global loss: 2.9794| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.4993
Epoch: 3|  Loss:  0.6563 |Global loss: 2.85| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 1.0259
Epoch: 0|  Loss:  1.17 |Global loss: 5.2632| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.7071
Epoch: 1|  Loss:  0.8508 |Global loss: 3.7815| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 0.7092
Epoch: 2|  Loss:  0.8541 |Global loss: 3.7829| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.5949
Epoch: 3|  Loss:  0.7413 |Global loss: 3.5079| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.8428
Epoch: 0|  Loss:  1.0033 |Global loss: 4.5653| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.6099
Epoch: 1|  Loss:  0.7613 |Global loss: 3.1158| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.5658
Epoch: 2|  Loss:  0.7166 |Global loss: 2.9547| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.5718
Epoch: 3|  Loss:  0.7289 |Global loss: 2.8956| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 1.0844
Epoch: 0|  Loss:  1.3398 |Global loss: 6.0827| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 0.6002
Epoch: 1|  Loss:  0.8259 |Global loss: 3.3659| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.6282
Epoch: 2|  Loss:  0.8461 |Global loss: 3.3875| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.6236
Epoch: 3|  Loss:  0.8413 |Global loss: 3.2904| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.9227
Epoch: 0|  Loss:  1.0885 |Global loss: 5.1042| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.6342
Epoch: 1|  Loss:  0.8238 |Global loss: 3.5991| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.6295
Epoch: 2|  Loss:  0.8254 |Global loss: 3.4487| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.5391
Epoch: 3|  Loss:  0.7272 |Global loss: 3.2477| Local H loss: 0.0359  | Global H loss: 0.0359
------------------------- time cost ------------------------- 4.830519676208496
Chosen Clients:  [7, 11, 1, 0, 3, 8]

-------------Round number: 222-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.992, 0.983, 0.975, 0.967, 0.992, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.958, 0.958, 0.975]
AUC in each clients:  [118.968, 119.483, 118.926, 118.938, 119.235, 118.659, 119.277, 119.51, 118.961, 119.127, 119.011, 119.633, 118.823, 119.088, 119.392]
F1 Score:  [0.975, 0.991, 0.982, 0.973, 0.964, 0.992, 0.974, 0.982, 0.974, 0.973, 0.973, 0.973, 0.957, 0.949, 0.975]
Recall Score:  [0.977, 0.993, 0.984, 0.977, 0.968, 0.993, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.963, 0.949, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5488
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9928
Averaged Test F1_score: 0.9738
Averaged Test Recal score: 0.9767
Std Test Accurancy: 0.0094
Std Test AUC: 0.0022
Std Test F1: 0.0001
Std Test Recall: 0.0001
Epoch: 0|  NKD Loss: 0.7814
Epoch: 0|  Loss:  0.9106 |Global loss: 4.8707| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.593
Epoch: 1|  Loss:  0.7365 |Global loss: 3.5677| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.539
Epoch: 2|  Loss:  0.6877 |Global loss: 3.2634| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.5435
Epoch: 3|  Loss:  0.693 |Global loss: 3.1213| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 0.8773
Epoch: 0|  Loss:  1.0027 |Global loss: 5.6236| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.6556
Epoch: 1|  Loss:  0.804 |Global loss: 3.6221| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.6191
Epoch: 2|  Loss:  0.7697 |Global loss: 3.305| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.6451
Epoch: 3|  Loss:  0.7982 |Global loss: 3.3206| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.9679
Epoch: 0|  Loss:  1.0929 |Global loss: 6.9049| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 0.7024
Epoch: 1|  Loss:  0.8367 |Global loss: 4.3832| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.6572
Epoch: 2|  Loss:  0.7962 |Global loss: 4.3782| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.6548
Epoch: 3|  Loss:  0.838 |Global loss: 4.2137| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 1.0039
Epoch: 0|  Loss:  1.2145 |Global loss: 6.0777| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.6618
Epoch: 1|  Loss:  0.8478 |Global loss: 3.6384| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.5737
Epoch: 2|  Loss:  0.7722 |Global loss: 3.2893| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.6135
Epoch: 3|  Loss:  0.8087 |Global loss: 3.4045| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.9669
Epoch: 0|  Loss:  1.091 |Global loss: 5.4819| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.6261
Epoch: 1|  Loss:  0.7859 |Global loss: 3.3135| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.5779
Epoch: 2|  Loss:  0.7316 |Global loss: 3.1256| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.6887
Epoch: 3|  Loss:  0.8524 |Global loss: 3.1477| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: nan
Epoch: 0|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 1|  NKD Loss: nan
Epoch: 1|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 2|  NKD Loss: nan
Epoch: 2|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Epoch: 3|  NKD Loss: nan
Epoch: 3|  Loss:  nan |Global loss: nan| Local H loss: nan  | Global H loss: nan
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 600, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkd.py", line 58, in train
    client.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkd.py", line 133, in train
    self.decomposition()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkd.py", line 228, in decomposition
    u, sigma, v = np.linalg.svd(param_cpu, full_matrices=False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 1681, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/numpy/linalg/linalg.py", line 121, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
