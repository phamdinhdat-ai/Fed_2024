
Join ratio / total clients: 0.4 / 15
Finished creating server and clients.
Chosen Clients:  [8, 11, 3, 7, 2, 9]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [55.643, 56.061, 56.199, 55.794, 55.242, 54.867, 54.586, 56.946, 53.139, 53.533, 54.657, 55.299, 55.6, 55.867, 54.981]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.4367
Averaged Test Accurancy: 0.0667
Averaged Test AUC: 0.4602
Averaged Test F1_score: 0.0100
Averaged Test Recal score: 0.0830
Std Test Accurancy: 0.0000
Std Test AUC: 0.0080
Std Test F1: 0.0000
Std Test Recall: 0.0000
[94mEpoch: 0|  NKD Loss: 2.3163 | CT Loss: 4.2486| [0m
[91mEpoch: 0|  Loss:  8.9845 |Global loss: 9.016| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.314 | CT Loss: 4.2333| [0m
[91mEpoch: 1|  Loss:  8.8183 |Global loss: 8.9042| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.2939 | CT Loss: 4.223| [0m
[91mEpoch: 2|  Loss:  8.6472 |Global loss: 8.7788| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2247 | CT Loss: 4.2135| [0m
[91mEpoch: 3|  Loss:  8.414 |Global loss: 8.6018| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 0|  NKD Loss: 2.3173 | CT Loss: 4.2698| [0m
[91mEpoch: 0|  Loss:  9.0116 |Global loss: 9.0412| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.319 | CT Loss: 4.2541| [0m
[91mEpoch: 1|  Loss:  8.8498 |Global loss: 8.941| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.315 | CT Loss: 4.2452| [0m
[91mEpoch: 2|  Loss:  8.6967 |Global loss: 8.8432| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.3011 | CT Loss: 4.2273| [0m
[91mEpoch: 3|  Loss:  8.499 |Global loss: 8.7064| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 0|  NKD Loss: 2.3158 | CT Loss: 4.2358| [0m
[91mEpoch: 0|  Loss:  8.9763 |Global loss: 9.0076| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3159 | CT Loss: 4.2152| [0m
[91mEpoch: 1|  Loss:  8.8092 |Global loss: 8.8983| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3045 | CT Loss: 4.202| [0m
[91mEpoch: 2|  Loss:  8.6364 |Global loss: 8.7758| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2619 | CT Loss: 4.1869| [0m
[91mEpoch: 3|  Loss:  8.4329 |Global loss: 8.6276| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 0|  NKD Loss: 2.3162 | CT Loss: 4.2491| [0m
[91mEpoch: 0|  Loss:  8.9862 |Global loss: 9.0184| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3166 | CT Loss: 4.2313| [0m
[91mEpoch: 1|  Loss:  8.8162 |Global loss: 8.9038| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.2959 | CT Loss: 4.2146| [0m
[91mEpoch: 2|  Loss:  8.6289 |Global loss: 8.7678| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2264 | CT Loss: 4.2029| [0m
[91mEpoch: 3|  Loss:  8.3811 |Global loss: 8.5851| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 0|  NKD Loss: 2.317 | CT Loss: 4.2535| [0m
[91mEpoch: 0|  Loss:  9.0023 |Global loss: 9.0316| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3192 | CT Loss: 4.236| [0m
[91mEpoch: 1|  Loss:  8.8414 |Global loss: 8.9246| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3124 | CT Loss: 4.2215| [0m
[91mEpoch: 2|  Loss:  8.6901 |Global loss: 8.8175| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.289 | CT Loss: 4.2123| [0m
[91mEpoch: 3|  Loss:  8.5015 |Global loss: 8.6803| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 0|  NKD Loss: 2.3177 | CT Loss: 4.2407| [0m
[91mEpoch: 0|  Loss:  8.9801 |Global loss: 9.0077| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3184 | CT Loss: 4.224| [0m
[91mEpoch: 1|  Loss:  8.8199 |Global loss: 8.9055| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 2|  NKD Loss: 2.3091 | CT Loss: 4.2121| [0m
[91mEpoch: 2|  Loss:  8.6529 |Global loss: 8.7944| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 3|  NKD Loss: 2.2765 | CT Loss: 4.2006| [0m
[91mEpoch: 3|  Loss:  8.44 |Global loss: 8.6452| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
------------------------- time cost ------------------------- 3.2098381519317627
Chosen Clients:  [2, 14, 10, 7, 5, 6]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.217, 0.308, 0.067, 0.067, 0.067, 0.317, 0.242, 0.308, 0.067, 0.358, 0.067, 0.067, 0.067]
AUC in each clients:  [55.643, 56.061, 98.361, 100.451, 55.242, 54.867, 54.586, 95.601, 95.43, 100.16, 54.657, 103.874, 55.6, 55.867, 54.981]
F1 Score:  [0.01, 0.01, 0.162, 0.22, 0.01, 0.01, 0.01, 0.259, 0.178, 0.23, 0.01, 0.302, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.298, 0.407, 0.083, 0.083, 0.083, 0.417, 0.333, 0.407, 0.083, 0.437, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.5899
Averaged Test Accurancy: 0.1567
Averaged Test AUC: 0.6063
Averaged Test F1_score: 0.0961
Averaged Test Recal score: 0.2031
Std Test Accurancy: 0.1143
Std Test AUC: 0.1791
Std Test F1: 0.0009
Std Test Recall: 0.0013
[94mEpoch: 0|  NKD Loss: 2.3286 | CT Loss: 5.2927| [0m
[91mEpoch: 0|  Loss:  9.505 |Global loss: 10.1056| Local H loss: 0.0017  | Global H loss: 0.0018 [0m
[94mEpoch: 1|  NKD Loss: 2.308 | CT Loss: 5.0744| [0m
[91mEpoch: 1|  Loss:  9.1311 |Global loss: 9.8407| Local H loss: 0.0018  | Global H loss: 0.002 [0m
[94mEpoch: 2|  NKD Loss: 2.2996 | CT Loss: 5.0061| [0m
[91mEpoch: 2|  Loss:  8.9291 |Global loss: 9.7323| Local H loss: 0.0023  | Global H loss: 0.0026 [0m
[94mEpoch: 3|  NKD Loss: 2.2918 | CT Loss: 4.9946| [0m
[91mEpoch: 3|  Loss:  8.7851 |Global loss: 9.6858| Local H loss: 0.003  | Global H loss: 0.0034 [0m
[94mEpoch: 0|  NKD Loss: 2.3185 | CT Loss: 5.2828| [0m
[91mEpoch: 0|  Loss:  10.0223 |Global loss: 10.0819| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3088 | CT Loss: 5.056| [0m
[91mEpoch: 1|  Loss:  9.6517 |Global loss: 9.8313| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3034 | CT Loss: 5.0149| [0m
[91mEpoch: 2|  Loss:  9.4845 |Global loss: 9.7659| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 3|  NKD Loss: 2.2975 | CT Loss: 4.9932| [0m
[91mEpoch: 3|  Loss:  9.3263 |Global loss: 9.7143| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 0|  NKD Loss: 2.3196 | CT Loss: 5.2737| [0m
[91mEpoch: 0|  Loss:  10.0296 |Global loss: 10.0779| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3098 | CT Loss: 5.0424| [0m
[91mEpoch: 1|  Loss:  9.653 |Global loss: 9.824| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3045 | CT Loss: 4.9563| [0m
[91mEpoch: 2|  Loss:  9.4408 |Global loss: 9.7254| Local H loss: 0.0002  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.3013 | CT Loss: 4.9194| [0m
[91mEpoch: 3|  Loss:  9.2866 |Global loss: 9.6709| Local H loss: 0.0004  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.3404 | CT Loss: 5.2923| [0m
[91mEpoch: 0|  Loss:  9.476 |Global loss: 10.1142| Local H loss: 0.0023  | Global H loss: 0.0023 [0m
[94mEpoch: 1|  NKD Loss: 2.3006 | CT Loss: 5.0937| [0m
[91mEpoch: 1|  Loss:  9.1352 |Global loss: 9.845| Local H loss: 0.0018  | Global H loss: 0.0019 [0m
[94mEpoch: 2|  NKD Loss: 2.2913 | CT Loss: 5.0107| [0m
[91mEpoch: 2|  Loss:  8.8942 |Global loss: 9.7205| Local H loss: 0.0024  | Global H loss: 0.0027 [0m
[94mEpoch: 3|  NKD Loss: 2.2789 | CT Loss: 4.9774| [0m
[91mEpoch: 3|  Loss:  8.7281 |Global loss: 9.6401| Local H loss: 0.003  | Global H loss: 0.0034 [0m
[94mEpoch: 0|  NKD Loss: 2.3189 | CT Loss: 5.2899| [0m
[91mEpoch: 0|  Loss:  10.0303 |Global loss: 10.0923| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3083 | CT Loss: 5.0381| [0m
[91mEpoch: 1|  Loss:  9.6263 |Global loss: 9.817| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3034 | CT Loss: 4.9712| [0m
[91mEpoch: 2|  Loss:  9.4306 |Global loss: 9.7276| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2997 | CT Loss: 4.9359| [0m
[91mEpoch: 3|  Loss:  9.2603 |Global loss: 9.6685| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
[94mEpoch: 0|  NKD Loss: 2.3199 | CT Loss: 5.2832| [0m
[91mEpoch: 0|  Loss:  10.0328 |Global loss: 10.0832| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3108 | CT Loss: 5.0452| [0m
[91mEpoch: 1|  Loss:  9.6541 |Global loss: 9.8191| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3048 | CT Loss: 4.97| [0m
[91mEpoch: 2|  Loss:  9.4473 |Global loss: 9.7207| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2973 | CT Loss: 4.946| [0m
[91mEpoch: 3|  Loss:  9.2933 |Global loss: 9.6679| Local H loss: 0.0005  | Global H loss: 0.0005 [0m
------------------------- time cost ------------------------- 3.065035104751587
Chosen Clients:  [14, 1, 9, 0, 12, 8]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.767, 0.308, 0.067, 0.183, 0.3, 0.975, 0.242, 0.308, 0.175, 0.358, 0.067, 0.067, 0.383]
AUC in each clients:  [55.643, 56.061, 116.557, 100.451, 55.242, 102.435, 94.407, 116.302, 95.43, 100.16, 101.896, 103.874, 55.6, 55.867, 99.051]
F1 Score:  [0.01, 0.01, 0.737, 0.22, 0.01, 0.105, 0.205, 0.973, 0.178, 0.23, 0.08, 0.302, 0.01, 0.01, 0.307]
Recall Score:  [0.083, 0.083, 0.801, 0.407, 0.083, 0.256, 0.392, 0.977, 0.333, 0.407, 0.24, 0.437, 0.083, 0.083, 0.482]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.5974
Averaged Test Accurancy: 0.2889
Averaged Test AUC: 0.7272
Averaged Test F1_score: 0.2258
Averaged Test Recal score: 0.3431
Std Test Accurancy: 0.2565
Std Test AUC: 0.1925
Std Test F1: 0.0023
Std Test Recall: 0.0022
[94mEpoch: 0|  NKD Loss: 2.2978 | CT Loss: 5.2095| [0m
[91mEpoch: 0|  Loss:  9.4022 |Global loss: 9.9755| Local H loss: 0.0009  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.2894 | CT Loss: 4.9933| [0m
[91mEpoch: 1|  Loss:  9.0402 |Global loss: 9.7127| Local H loss: 0.0012  | Global H loss: 0.0013 [0m
[94mEpoch: 2|  NKD Loss: 2.2829 | CT Loss: 4.9494| [0m
[91mEpoch: 2|  Loss:  8.8441 |Global loss: 9.6336| Local H loss: 0.0017  | Global H loss: 0.002 [0m
[94mEpoch: 3|  NKD Loss: 2.2718 | CT Loss: 4.9334| [0m
[91mEpoch: 3|  Loss:  8.6625 |Global loss: 9.5704| Local H loss: 0.0025  | Global H loss: 0.0029 [0m
[94mEpoch: 0|  NKD Loss: 2.3188 | CT Loss: 5.3014| [0m
[91mEpoch: 0|  Loss:  10.0429 |Global loss: 10.1021| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3085 | CT Loss: 5.0581| [0m
[91mEpoch: 1|  Loss:  9.6602 |Global loss: 9.8326| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3035 | CT Loss: 4.9793| [0m
[91mEpoch: 2|  Loss:  9.4595 |Global loss: 9.7106| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 3|  NKD Loss: 2.294 | CT Loss: 4.9444| [0m
[91mEpoch: 3|  Loss:  9.3007 |Global loss: 9.6416| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 0|  NKD Loss: 2.3188 | CT Loss: 5.2911| [0m
[91mEpoch: 0|  Loss:  9.4209 |Global loss: 10.0896| Local H loss: 0.0018  | Global H loss: 0.0019 [0m
[94mEpoch: 1|  NKD Loss: 2.2866 | CT Loss: 5.039| [0m
[91mEpoch: 1|  Loss:  8.9907 |Global loss: 9.7484| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.2741 | CT Loss: 4.9858| [0m
[91mEpoch: 2|  Loss:  8.7656 |Global loss: 9.6552| Local H loss: 0.0023  | Global H loss: 0.0027 [0m
[94mEpoch: 3|  NKD Loss: 2.2554 | CT Loss: 4.9643| [0m
[91mEpoch: 3|  Loss:  8.5485 |Global loss: 9.5796| Local H loss: 0.0034  | Global H loss: 0.0042 [0m
[94mEpoch: 0|  NKD Loss: 2.3191 | CT Loss: 5.2829| [0m
[91mEpoch: 0|  Loss:  10.0354 |Global loss: 10.0835| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3084 | CT Loss: 5.0681| [0m
[91mEpoch: 1|  Loss:  9.6865 |Global loss: 9.8559| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3032 | CT Loss: 5.0005| [0m
[91mEpoch: 2|  Loss:  9.4937 |Global loss: 9.7669| Local H loss: 0.0002  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.2973 | CT Loss: 4.9465| [0m
[91mEpoch: 3|  Loss:  9.3083 |Global loss: 9.677| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 0|  NKD Loss: 2.3179 | CT Loss: 5.2861| [0m
[91mEpoch: 0|  Loss:  10.0156 |Global loss: 10.0857| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.31 | CT Loss: 5.0958| [0m
[91mEpoch: 1|  Loss:  9.6934 |Global loss: 9.882| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 2|  NKD Loss: 2.3064 | CT Loss: 5.0314| [0m
[91mEpoch: 2|  Loss:  9.5037 |Global loss: 9.7958| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.3047 | CT Loss: 5.004| [0m
[91mEpoch: 3|  Loss:  9.3583 |Global loss: 9.7424| Local H loss: 0.0005  | Global H loss: 0.0006 [0m
[94mEpoch: 0|  NKD Loss: 2.3389 | CT Loss: 5.2979| [0m
[91mEpoch: 0|  Loss:  9.4935 |Global loss: 10.1109| Local H loss: 0.0022  | Global H loss: 0.0022 [0m
[94mEpoch: 1|  NKD Loss: 2.2911 | CT Loss: 5.0726| [0m
[91mEpoch: 1|  Loss:  9.1203 |Global loss: 9.7802| Local H loss: 0.0015  | Global H loss: 0.0017 [0m
[94mEpoch: 2|  NKD Loss: 2.2762 | CT Loss: 5.0075| [0m
[91mEpoch: 2|  Loss:  8.8958 |Global loss: 9.653| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 3|  NKD Loss: 2.2503 | CT Loss: 4.9854| [0m
[91mEpoch: 3|  Loss:  8.6981 |Global loss: 9.5585| Local H loss: 0.0029  | Global H loss: 0.0033 [0m
------------------------- time cost ------------------------- 2.827826976776123
Chosen Clients:  [7, 9, 8, 0, 12, 14]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.183, 0.2, 0.767, 0.308, 0.067, 0.183, 0.3, 0.975, 0.908, 0.975, 0.175, 0.358, 0.183, 0.067, 0.9]
AUC in each clients:  [92.9, 92.993, 116.557, 100.451, 55.242, 102.435, 94.407, 116.302, 116.251, 118.464, 101.896, 103.874, 98.548, 55.867, 118.175]
F1 Score:  [0.117, 0.164, 0.737, 0.22, 0.01, 0.105, 0.205, 0.973, 0.875, 0.973, 0.08, 0.302, 0.1, 0.01, 0.881]
Recall Score:  [0.25, 0.28, 0.801, 0.407, 0.083, 0.256, 0.392, 0.977, 0.9, 0.977, 0.24, 0.437, 0.25, 0.083, 0.914]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.4055
Averaged Test Accurancy: 0.4367
Averaged Test AUC: 0.8246
Averaged Test F1_score: 0.3835
Averaged Test Recal score: 0.4831
Std Test Accurancy: 0.3423
Std Test AUC: 0.1605
Std Test F1: 0.0031
Std Test Recall: 0.0027
[94mEpoch: 0|  NKD Loss: 2.3045 | CT Loss: 5.3358| [0m
[91mEpoch: 0|  Loss:  8.9847 |Global loss: 10.1321| Local H loss: 0.0049  | Global H loss: 0.0058 [0m
[94mEpoch: 1|  NKD Loss: 2.2927 | CT Loss: 5.325| [0m
[91mEpoch: 1|  Loss:  8.8413 |Global loss: 10.11| Local H loss: 0.0058  | Global H loss: 0.0072 [0m
[94mEpoch: 2|  NKD Loss: 2.2968 | CT Loss: 5.317| [0m
[91mEpoch: 2|  Loss:  8.729 |Global loss: 10.1081| Local H loss: 0.0075  | Global H loss: 0.0093 [0m
[94mEpoch: 3|  NKD Loss: 2.2912 | CT Loss: 5.3087| [0m
[91mEpoch: 3|  Loss:  8.6059 |Global loss: 10.0972| Local H loss: 0.0094  | Global H loss: 0.0118 [0m
[94mEpoch: 0|  NKD Loss: 2.2895 | CT Loss: 5.3283| [0m
[91mEpoch: 0|  Loss:  8.7823 |Global loss: 10.1108| Local H loss: 0.0063  | Global H loss: 0.0077 [0m
[94mEpoch: 1|  NKD Loss: 2.275 | CT Loss: 5.312| [0m
[91mEpoch: 1|  Loss:  8.6285 |Global loss: 10.0828| Local H loss: 0.008  | Global H loss: 0.0102 [0m
[94mEpoch: 2|  NKD Loss: 2.271 | CT Loss: 5.301| [0m
[91mEpoch: 2|  Loss:  8.4993 |Global loss: 10.0712| Local H loss: 0.0102  | Global H loss: 0.0131 [0m
[94mEpoch: 3|  NKD Loss: 2.262 | CT Loss: 5.2946| [0m
[91mEpoch: 3|  Loss:  8.3642 |Global loss: 10.058| Local H loss: 0.0131  | Global H loss: 0.0168 [0m
[94mEpoch: 0|  NKD Loss: 2.317 | CT Loss: 5.3418| [0m
[91mEpoch: 0|  Loss:  9.014 |Global loss: 10.1482| Local H loss: 0.0051  | Global H loss: 0.0059 [0m
[94mEpoch: 1|  NKD Loss: 2.3012 | CT Loss: 5.3323| [0m
[91mEpoch: 1|  Loss:  8.8786 |Global loss: 10.1265| Local H loss: 0.006  | Global H loss: 0.0072 [0m
[94mEpoch: 2|  NKD Loss: 2.2994 | CT Loss: 5.3213| [0m
[91mEpoch: 2|  Loss:  8.7572 |Global loss: 10.1146| Local H loss: 0.0074  | Global H loss: 0.009 [0m
[94mEpoch: 3|  NKD Loss: 2.3018 | CT Loss: 5.3118| [0m
[91mEpoch: 3|  Loss:  8.6676 |Global loss: 10.1092| Local H loss: 0.0088  | Global H loss: 0.0107 [0m
[94mEpoch: 0|  NKD Loss: 2.3044 | CT Loss: 5.3074| [0m
[91mEpoch: 0|  Loss:  9.5626 |Global loss: 10.0976| Local H loss: 0.001  | Global H loss: 0.0011 [0m
[94mEpoch: 1|  NKD Loss: 2.2982 | CT Loss: 5.2991| [0m
[91mEpoch: 1|  Loss:  9.4238 |Global loss: 10.0847| Local H loss: 0.0014  | Global H loss: 0.0016 [0m
[94mEpoch: 2|  NKD Loss: 2.2931 | CT Loss: 5.2922| [0m
[91mEpoch: 2|  Loss:  9.2806 |Global loss: 10.0732| Local H loss: 0.002  | Global H loss: 0.0023 [0m
[94mEpoch: 3|  NKD Loss: 2.2875 | CT Loss: 5.2853| [0m
[91mEpoch: 3|  Loss:  9.1386 |Global loss: 10.0619| Local H loss: 0.0026  | Global H loss: 0.0031 [0m
[94mEpoch: 0|  NKD Loss: 2.3063 | CT Loss: 5.332| [0m
[91mEpoch: 0|  Loss:  9.5648 |Global loss: 10.1249| Local H loss: 0.0011  | Global H loss: 0.0012 [0m
[94mEpoch: 1|  NKD Loss: 2.306 | CT Loss: 5.3195| [0m
[91mEpoch: 1|  Loss:  9.4358 |Global loss: 10.1114| Local H loss: 0.0016  | Global H loss: 0.0017 [0m
[94mEpoch: 2|  NKD Loss: 2.3076 | CT Loss: 5.3164| [0m
[91mEpoch: 2|  Loss:  9.3241 |Global loss: 10.1114| Local H loss: 0.0021  | Global H loss: 0.0024 [0m
[94mEpoch: 3|  NKD Loss: 2.3102 | CT Loss: 5.3105| [0m
[91mEpoch: 3|  Loss:  9.1984 |Global loss: 10.1079| Local H loss: 0.0029  | Global H loss: 0.0033 [0m
[94mEpoch: 0|  NKD Loss: 2.3035 | CT Loss: 5.3096| [0m
[91mEpoch: 0|  Loss:  8.9269 |Global loss: 10.1044| Local H loss: 0.0046  | Global H loss: 0.0053 [0m
[94mEpoch: 1|  NKD Loss: 2.2954 | CT Loss: 5.298| [0m
[91mEpoch: 1|  Loss:  8.7845 |Global loss: 10.0848| Local H loss: 0.0056  | Global H loss: 0.0068 [0m
[94mEpoch: 2|  NKD Loss: 2.2925 | CT Loss: 5.2918| [0m
[91mEpoch: 2|  Loss:  8.6511 |Global loss: 10.078| Local H loss: 0.0074  | Global H loss: 0.0092 [0m
[94mEpoch: 3|  NKD Loss: 2.2869 | CT Loss: 5.2834| [0m
[91mEpoch: 3|  Loss:  8.525 |Global loss: 10.0667| Local H loss: 0.0091  | Global H loss: 0.0115 [0m
------------------------- time cost ------------------------- 3.0681962966918945
Chosen Clients:  [11, 12, 0, 10, 7, 3]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.808, 0.2, 0.767, 0.308, 0.067, 0.183, 0.3, 0.975, 0.975, 0.975, 0.175, 0.358, 0.717, 0.067, 0.983]
AUC in each clients:  [116.447, 92.993, 116.557, 100.451, 55.242, 102.435, 94.407, 119.29, 119.504, 119.699, 101.896, 103.874, 117.011, 55.867, 119.686]
F1 Score:  [0.8, 0.164, 0.737, 0.22, 0.01, 0.105, 0.205, 0.973, 0.973, 0.974, 0.08, 0.302, 0.7, 0.01, 0.981]
Recall Score:  [0.857, 0.28, 0.801, 0.407, 0.083, 0.256, 0.392, 0.977, 0.977, 0.977, 0.24, 0.437, 0.78, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 11.1683
Averaged Test Accurancy: 0.5239
Averaged Test AUC: 0.8530
Averaged Test F1_score: 0.4823
Averaged Test Recal score: 0.5687
Std Test Accurancy: 0.3543
Std Test AUC: 0.1713
Std Test F1: 0.0032
Std Test Recall: 0.0028
[94mEpoch: 0|  NKD Loss: 2.3103 | CT Loss: 5.3499| [0m
[91mEpoch: 0|  Loss:  9.4783 |Global loss: 10.1462| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 1|  NKD Loss: 2.301 | CT Loss: 5.3332| [0m
[91mEpoch: 1|  Loss:  9.3213 |Global loss: 10.122| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 2|  NKD Loss: 2.3005 | CT Loss: 5.3238| [0m
[91mEpoch: 2|  Loss:  9.1875 |Global loss: 10.1138| Local H loss: 0.0028  | Global H loss: 0.0032 [0m
[94mEpoch: 3|  NKD Loss: 2.3 | CT Loss: 5.3144| [0m
[91mEpoch: 3|  Loss:  9.0389 |Global loss: 10.1038| Local H loss: 0.0038  | Global H loss: 0.0045 [0m
[94mEpoch: 0|  NKD Loss: 2.3117 | CT Loss: 5.3047| [0m
[91mEpoch: 0|  Loss:  9.0797 |Global loss: 10.1061| Local H loss: 0.0038  | Global H loss: 0.0044 [0m
[94mEpoch: 1|  NKD Loss: 2.3151 | CT Loss: 5.2991| [0m
[91mEpoch: 1|  Loss:  8.9798 |Global loss: 10.1051| Local H loss: 0.0047  | Global H loss: 0.0055 [0m
[94mEpoch: 2|  NKD Loss: 2.3195 | CT Loss: 5.2974| [0m
[91mEpoch: 2|  Loss:  8.9137 |Global loss: 10.1085| Local H loss: 0.0055  | Global H loss: 0.0064 [0m
[94mEpoch: 3|  NKD Loss: 2.3158 | CT Loss: 5.2899| [0m
[91mEpoch: 3|  Loss:  8.7905 |Global loss: 10.0994| Local H loss: 0.0068  | Global H loss: 0.0082 [0m
[94mEpoch: 0|  NKD Loss: 2.2841 | CT Loss: 5.2792| [0m
[91mEpoch: 0|  Loss:  8.9655 |Global loss: 10.0522| Local H loss: 0.0038  | Global H loss: 0.0047 [0m
[94mEpoch: 1|  NKD Loss: 2.2823 | CT Loss: 5.2776| [0m
[91mEpoch: 1|  Loss:  8.8366 |Global loss: 10.0517| Local H loss: 0.0051  | Global H loss: 0.0065 [0m
[94mEpoch: 2|  NKD Loss: 2.2831 | CT Loss: 5.2712| [0m
[91mEpoch: 2|  Loss:  8.7023 |Global loss: 10.049| Local H loss: 0.007  | Global H loss: 0.0089 [0m
[94mEpoch: 3|  NKD Loss: 2.282 | CT Loss: 5.2704| [0m
[91mEpoch: 3|  Loss:  8.5914 |Global loss: 10.0479| Local H loss: 0.0088  | Global H loss: 0.0113 [0m
[94mEpoch: 0|  NKD Loss: 2.3026 | CT Loss: 5.3337| [0m
[91mEpoch: 0|  Loss:  9.5855 |Global loss: 10.1207| Local H loss: 0.0009  | Global H loss: 0.001 [0m
[94mEpoch: 1|  NKD Loss: 2.2987 | CT Loss: 5.3266| [0m
[91mEpoch: 1|  Loss:  9.4536 |Global loss: 10.112| Local H loss: 0.0013  | Global H loss: 0.0015 [0m
[94mEpoch: 2|  NKD Loss: 2.2984 | CT Loss: 5.3207| [0m
[91mEpoch: 2|  Loss:  9.3279 |Global loss: 10.1074| Local H loss: 0.0019  | Global H loss: 0.0022 [0m
[94mEpoch: 3|  NKD Loss: 2.2982 | CT Loss: 5.3144| [0m
[91mEpoch: 3|  Loss:  9.194 |Global loss: 10.1007| Local H loss: 0.0027  | Global H loss: 0.0032 [0m
[94mEpoch: 0|  NKD Loss: 2.2882 | CT Loss: 5.3021| [0m
[91mEpoch: 0|  Loss:  8.5071 |Global loss: 10.0883| Local H loss: 0.0112  | Global H loss: 0.014 [0m
[94mEpoch: 1|  NKD Loss: 2.288 | CT Loss: 5.296| [0m
[91mEpoch: 1|  Loss:  8.4386 |Global loss: 10.0853| Local H loss: 0.013  | Global H loss: 0.0163 [0m
[94mEpoch: 2|  NKD Loss: 2.2842 | CT Loss: 5.2901| [0m
[91mEpoch: 2|  Loss:  8.3597 |Global loss: 10.0779| Local H loss: 0.015  | Global H loss: 0.0186 [0m
[94mEpoch: 3|  NKD Loss: 2.2827 | CT Loss: 5.2864| [0m
[91mEpoch: 3|  Loss:  8.3177 |Global loss: 10.0742| Local H loss: 0.0164  | Global H loss: 0.0202 [0m
[94mEpoch: 0|  NKD Loss: 2.3332 | CT Loss: 5.3744| [0m
[91mEpoch: 0|  Loss:  9.5647 |Global loss: 10.1952| Local H loss: 0.0022  | Global H loss: 0.0023 [0m
[94mEpoch: 1|  NKD Loss: 2.3123 | CT Loss: 5.3515| [0m
[91mEpoch: 1|  Loss:  9.4092 |Global loss: 10.1502| Local H loss: 0.0021  | Global H loss: 0.0023 [0m
[94mEpoch: 2|  NKD Loss: 2.3098 | CT Loss: 5.3398| [0m
[91mEpoch: 2|  Loss:  9.3082 |Global loss: 10.1375| Local H loss: 0.0024  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 2.3104 | CT Loss: 5.3307| [0m
[91mEpoch: 3|  Loss:  9.1429 |Global loss: 10.1298| Local H loss: 0.0034  | Global H loss: 0.004 [0m
------------------------- time cost ------------------------- 3.3145222663879395
Chosen Clients:  [8, 3, 10, 7, 0, 1]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.2, 0.767, 0.817, 0.067, 0.183, 0.3, 0.975, 0.975, 0.975, 0.758, 0.733, 0.842, 0.067, 0.983]
AUC in each clients:  [118.404, 92.993, 116.557, 116.981, 55.242, 102.435, 94.407, 119.412, 119.504, 119.699, 117.169, 117.722, 118.865, 55.867, 119.686]
F1 Score:  [0.898, 0.164, 0.737, 0.8, 0.01, 0.105, 0.205, 0.973, 0.973, 0.974, 0.764, 0.728, 0.852, 0.01, 0.981]
Recall Score:  [0.919, 0.28, 0.801, 0.854, 0.083, 0.256, 0.392, 0.977, 0.977, 0.977, 0.829, 0.817, 0.888, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.9368
Averaged Test Accurancy: 0.6356
Averaged Test AUC: 0.8805
Averaged Test F1_score: 0.6116
Averaged Test Recal score: 0.6745
Std Test Accurancy: 0.3467
Std Test AUC: 0.1794
Std Test F1: 0.0031
Std Test Recall: 0.0028
[94mEpoch: 0|  NKD Loss: 2.2976 | CT Loss: 5.3036| [0m
[91mEpoch: 0|  Loss:  8.5507 |Global loss: 10.0994| Local H loss: 0.0106  | Global H loss: 0.0129 [0m
[94mEpoch: 1|  NKD Loss: 2.3003 | CT Loss: 5.2974| [0m
[91mEpoch: 1|  Loss:  8.4814 |Global loss: 10.0981| Local H loss: 0.0121  | Global H loss: 0.0148 [0m
[94mEpoch: 2|  NKD Loss: 2.296 | CT Loss: 5.2916| [0m
[91mEpoch: 2|  Loss:  8.4083 |Global loss: 10.0892| Local H loss: 0.014  | Global H loss: 0.0171 [0m
[94mEpoch: 3|  NKD Loss: 2.2926 | CT Loss: 5.2878| [0m
[91mEpoch: 3|  Loss:  8.3535 |Global loss: 10.0844| Local H loss: 0.0151  | Global H loss: 0.0184 [0m
[94mEpoch: 0|  NKD Loss: 2.3102 | CT Loss: 5.3232| [0m
[91mEpoch: 0|  Loss:  9.0329 |Global loss: 10.123| Local H loss: 0.0042  | Global H loss: 0.0049 [0m
[94mEpoch: 1|  NKD Loss: 2.3113 | CT Loss: 5.3155| [0m
[91mEpoch: 1|  Loss:  8.9172 |Global loss: 10.1184| Local H loss: 0.0052  | Global H loss: 0.0062 [0m
[94mEpoch: 2|  NKD Loss: 2.3098 | CT Loss: 5.3084| [0m
[91mEpoch: 2|  Loss:  8.7903 |Global loss: 10.1103| Local H loss: 0.0064  | Global H loss: 0.0078 [0m
[94mEpoch: 3|  NKD Loss: 2.3096 | CT Loss: 5.303| [0m
[91mEpoch: 3|  Loss:  8.6817 |Global loss: 10.1082| Local H loss: 0.0079  | Global H loss: 0.0097 [0m
[94mEpoch: 0|  NKD Loss: 2.2969 | CT Loss: 5.3042| [0m
[91mEpoch: 0|  Loss:  9.0523 |Global loss: 10.0897| Local H loss: 0.0037  | Global H loss: 0.0045 [0m
[94mEpoch: 1|  NKD Loss: 2.2981 | CT Loss: 5.2959| [0m
[91mEpoch: 1|  Loss:  8.9509 |Global loss: 10.0853| Local H loss: 0.0048  | Global H loss: 0.0058 [0m
[94mEpoch: 2|  NKD Loss: 2.2981 | CT Loss: 5.289| [0m
[91mEpoch: 2|  Loss:  8.8304 |Global loss: 10.0797| Local H loss: 0.0064  | Global H loss: 0.0078 [0m
[94mEpoch: 3|  NKD Loss: 2.2981 | CT Loss: 5.283| [0m
[91mEpoch: 3|  Loss:  8.7251 |Global loss: 10.0757| Local H loss: 0.0079  | Global H loss: 0.0097 [0m
[94mEpoch: 0|  NKD Loss: 2.2686 | CT Loss: 5.2805| [0m
[91mEpoch: 0|  Loss:  8.2129 |Global loss: 10.0568| Local H loss: 0.0188  | Global H loss: 0.0232 [0m
[94mEpoch: 1|  NKD Loss: 2.2735 | CT Loss: 5.2767| [0m
[91mEpoch: 1|  Loss:  8.2109 |Global loss: 10.0604| Local H loss: 0.0202  | Global H loss: 0.0244 [0m
[94mEpoch: 2|  NKD Loss: 2.2634 | CT Loss: 5.2715| [0m
[91mEpoch: 2|  Loss:  8.1262 |Global loss: 10.0469| Local H loss: 0.0222  | Global H loss: 0.0269 [0m
[94mEpoch: 3|  NKD Loss: 2.2534 | CT Loss: 5.2667| [0m
[91mEpoch: 3|  Loss:  8.0738 |Global loss: 10.0341| Local H loss: 0.0242  | Global H loss: 0.029 [0m
[94mEpoch: 0|  NKD Loss: 2.2801 | CT Loss: 5.2666| [0m
[91mEpoch: 0|  Loss:  8.4739 |Global loss: 10.0463| Local H loss: 0.0113  | Global H loss: 0.0144 [0m
[94mEpoch: 1|  NKD Loss: 2.2803 | CT Loss: 5.2628| [0m
[91mEpoch: 1|  Loss:  8.4048 |Global loss: 10.0453| Local H loss: 0.0133  | Global H loss: 0.0169 [0m
[94mEpoch: 2|  NKD Loss: 2.2793 | CT Loss: 5.2613| [0m
[91mEpoch: 2|  Loss:  8.3365 |Global loss: 10.0455| Local H loss: 0.0156  | Global H loss: 0.0195 [0m
[94mEpoch: 3|  NKD Loss: 2.2757 | CT Loss: 5.257| [0m
[91mEpoch: 3|  Loss:  8.2804 |Global loss: 10.039| Local H loss: 0.0176  | Global H loss: 0.0217 [0m
[94mEpoch: 0|  NKD Loss: 2.3139 | CT Loss: 5.3118| [0m
[91mEpoch: 0|  Loss:  9.5793 |Global loss: 10.112| Local H loss: 0.0012  | Global H loss: 0.0013 [0m
[94mEpoch: 1|  NKD Loss: 2.3067 | CT Loss: 5.299| [0m
[91mEpoch: 1|  Loss:  9.4478 |Global loss: 10.0916| Local H loss: 0.0015  | Global H loss: 0.0016 [0m
[94mEpoch: 2|  NKD Loss: 2.3033 | CT Loss: 5.2905| [0m
[91mEpoch: 2|  Loss:  9.3281 |Global loss: 10.0817| Local H loss: 0.0019  | Global H loss: 0.0021 [0m
[94mEpoch: 3|  NKD Loss: 2.3022 | CT Loss: 5.2862| [0m
[91mEpoch: 3|  Loss:  9.1986 |Global loss: 10.0765| Local H loss: 0.0025  | Global H loss: 0.0029 [0m
------------------------- time cost ------------------------- 3.5990488529205322
Chosen Clients:  [9, 14, 4, 2, 6, 11]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.667, 0.767, 0.85, 0.067, 0.183, 0.3, 0.975, 0.975, 0.975, 0.85, 0.733, 0.842, 0.067, 0.983]
AUC in each clients:  [118.974, 116.367, 116.557, 119.03, 55.242, 102.435, 94.407, 119.438, 119.647, 119.699, 118.474, 117.722, 118.865, 55.867, 119.686]
F1 Score:  [0.958, 0.625, 0.737, 0.844, 0.01, 0.105, 0.205, 0.973, 0.973, 0.974, 0.845, 0.728, 0.852, 0.01, 0.981]
Recall Score:  [0.963, 0.743, 0.801, 0.884, 0.083, 0.256, 0.392, 0.977, 0.977, 0.977, 0.89, 0.817, 0.888, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.7771
Averaged Test Accurancy: 0.6794
Averaged Test AUC: 0.8958
Averaged Test F1_score: 0.6547
Averaged Test Recal score: 0.7143
Std Test Accurancy: 0.3335
Std Test AUC: 0.1795
Std Test F1: 0.0030
Std Test Recall: 0.0027
[94mEpoch: 0|  NKD Loss: 2.2576 | CT Loss: 5.2908| [0m
[91mEpoch: 0|  Loss:  8.2722 |Global loss: 10.0532| Local H loss: 0.0155  | Global H loss: 0.0198 [0m
[94mEpoch: 1|  NKD Loss: 2.2548 | CT Loss: 5.2861| [0m
[91mEpoch: 1|  Loss:  8.2033 |Global loss: 10.0466| Local H loss: 0.0177  | Global H loss: 0.0224 [0m
[94mEpoch: 2|  NKD Loss: 2.2427 | CT Loss: 5.2815| [0m
[91mEpoch: 2|  Loss:  8.1068 |Global loss: 10.0354| Local H loss: 0.0211  | Global H loss: 0.0263 [0m
[94mEpoch: 3|  NKD Loss: 2.2416 | CT Loss: 5.2775| [0m
[91mEpoch: 3|  Loss:  8.0681 |Global loss: 10.0322| Local H loss: 0.0231  | Global H loss: 0.0284 [0m
[94mEpoch: 0|  NKD Loss: 2.2843 | CT Loss: 5.2796| [0m
[91mEpoch: 0|  Loss:  8.4435 |Global loss: 10.0637| Local H loss: 0.0108  | Global H loss: 0.0137 [0m
[94mEpoch: 1|  NKD Loss: 2.2786 | CT Loss: 5.2748| [0m
[91mEpoch: 1|  Loss:  8.3446 |Global loss: 10.0557| Local H loss: 0.013  | Global H loss: 0.0166 [0m
[94mEpoch: 2|  NKD Loss: 2.2736 | CT Loss: 5.2704| [0m
[91mEpoch: 2|  Loss:  8.2637 |Global loss: 10.0486| Local H loss: 0.0151  | Global H loss: 0.0192 [0m
[94mEpoch: 3|  NKD Loss: 2.2656 | CT Loss: 5.2672| [0m
[91mEpoch: 3|  Loss:  8.1864 |Global loss: 10.0393| Local H loss: 0.0173  | Global H loss: 0.022 [0m
[94mEpoch: 0|  NKD Loss: 2.3182 | CT Loss: 5.3546| [0m
[91mEpoch: 0|  Loss:  10.102 |Global loss: 10.157| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 1|  NKD Loss: 2.3085 | CT Loss: 5.3307| [0m
[91mEpoch: 1|  Loss:  9.9308 |Global loss: 10.125| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.3023 | CT Loss: 5.3159| [0m
[91mEpoch: 2|  Loss:  9.783 |Global loss: 10.1037| Local H loss: 0.0003  | Global H loss: 0.0003 [0m
[94mEpoch: 3|  NKD Loss: 2.298 | CT Loss: 5.3067| [0m
[91mEpoch: 3|  Loss:  9.6395 |Global loss: 10.0914| Local H loss: 0.0006  | Global H loss: 0.0006 [0m
[94mEpoch: 0|  NKD Loss: 2.3142 | CT Loss: 5.3441| [0m
[91mEpoch: 0|  Loss:  9.0362 |Global loss: 10.1493| Local H loss: 0.0047  | Global H loss: 0.0055 [0m
[94mEpoch: 1|  NKD Loss: 2.309 | CT Loss: 5.3331| [0m
[91mEpoch: 1|  Loss:  8.9175 |Global loss: 10.1354| Local H loss: 0.0056  | Global H loss: 0.0068 [0m
[94mEpoch: 2|  NKD Loss: 2.3066 | CT Loss: 5.3199| [0m
[91mEpoch: 2|  Loss:  8.7998 |Global loss: 10.1211| Local H loss: 0.0069  | Global H loss: 0.0085 [0m
[94mEpoch: 3|  NKD Loss: 2.3041 | CT Loss: 5.3128| [0m
[91mEpoch: 3|  Loss:  8.6982 |Global loss: 10.1127| Local H loss: 0.0085  | Global H loss: 0.0105 [0m
[94mEpoch: 0|  NKD Loss: 2.3045 | CT Loss: 5.3291| [0m
[91mEpoch: 0|  Loss:  9.5732 |Global loss: 10.1194| Local H loss: 0.0012  | Global H loss: 0.0013 [0m
[94mEpoch: 1|  NKD Loss: 2.2992 | CT Loss: 5.3175| [0m
[91mEpoch: 1|  Loss:  9.4354 |Global loss: 10.1019| Local H loss: 0.0016  | Global H loss: 0.0019 [0m
[94mEpoch: 2|  NKD Loss: 2.2977 | CT Loss: 5.3107| [0m
[91mEpoch: 2|  Loss:  9.3231 |Global loss: 10.096| Local H loss: 0.0022  | Global H loss: 0.0026 [0m
[94mEpoch: 3|  NKD Loss: 2.295 | CT Loss: 5.3014| [0m
[91mEpoch: 3|  Loss:  9.184 |Global loss: 10.0864| Local H loss: 0.0031  | Global H loss: 0.0037 [0m
[94mEpoch: 0|  NKD Loss: 2.3016 | CT Loss: 5.3076| [0m
[91mEpoch: 0|  Loss:  8.9047 |Global loss: 10.1014| Local H loss: 0.005  | Global H loss: 0.0061 [0m
[94mEpoch: 1|  NKD Loss: 2.3017 | CT Loss: 5.302| [0m
[91mEpoch: 1|  Loss:  8.778 |Global loss: 10.0966| Local H loss: 0.0065  | Global H loss: 0.008 [0m
[94mEpoch: 2|  NKD Loss: 2.3 | CT Loss: 5.2977| [0m
[91mEpoch: 2|  Loss:  8.6687 |Global loss: 10.0912| Local H loss: 0.008  | Global H loss: 0.0099 [0m
[94mEpoch: 3|  NKD Loss: 2.298 | CT Loss: 5.2932| [0m
[91mEpoch: 3|  Loss:  8.577 |Global loss: 10.0893| Local H loss: 0.0095  | Global H loss: 0.0119 [0m
------------------------- time cost ------------------------- 7.071523666381836
Chosen Clients:  [10, 0, 7, 8, 1, 12]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.958, 0.667, 0.85, 0.85, 0.45, 0.183, 0.683, 0.975, 0.975, 0.975, 0.85, 0.892, 0.842, 0.067, 0.983]
AUC in each clients:  [118.974, 116.367, 118.504, 119.03, 105.41, 102.435, 115.893, 119.438, 119.647, 119.576, 118.474, 119.242, 118.865, 55.867, 119.751]
F1 Score:  [0.958, 0.625, 0.856, 0.844, 0.358, 0.105, 0.668, 0.973, 0.973, 0.974, 0.845, 0.893, 0.852, 0.01, 0.981]
Recall Score:  [0.963, 0.743, 0.891, 0.884, 0.528, 0.256, 0.764, 0.977, 0.977, 0.977, 0.89, 0.923, 0.888, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.6308
Averaged Test Accurancy: 0.7467
Averaged Test AUC: 0.9375
Averaged Test F1_score: 0.7277
Averaged Test Recal score: 0.7819
Std Test Accurancy: 0.2825
Std Test AUC: 0.1332
Std Test F1: 0.0026
Std Test Recall: 0.0022
[94mEpoch: 0|  NKD Loss: 2.2944 | CT Loss: 5.2747| [0m
[91mEpoch: 0|  Loss:  8.6231 |Global loss: 10.0661| Local H loss: 0.0094  | Global H loss: 0.0116 [0m
[94mEpoch: 1|  NKD Loss: 2.2915 | CT Loss: 5.271| [0m
[91mEpoch: 1|  Loss:  8.5293 |Global loss: 10.0596| Local H loss: 0.0112  | Global H loss: 0.0137 [0m
[94mEpoch: 2|  NKD Loss: 2.2885 | CT Loss: 5.2675| [0m
[91mEpoch: 2|  Loss:  8.4662 |Global loss: 10.0564| Local H loss: 0.0126  | Global H loss: 0.0154 [0m
[94mEpoch: 3|  NKD Loss: 2.2834 | CT Loss: 5.2636| [0m
[91mEpoch: 3|  Loss:  8.3783 |Global loss: 10.0495| Local H loss: 0.0145  | Global H loss: 0.0178 [0m
[94mEpoch: 0|  NKD Loss: 2.2748 | CT Loss: 5.2554| [0m
[91mEpoch: 0|  Loss:  8.227 |Global loss: 10.0392| Local H loss: 0.0197  | Global H loss: 0.024 [0m
[94mEpoch: 1|  NKD Loss: 2.2734 | CT Loss: 5.2529| [0m
[91mEpoch: 1|  Loss:  8.2026 |Global loss: 10.0365| Local H loss: 0.0211  | Global H loss: 0.0253 [0m
[94mEpoch: 2|  NKD Loss: 2.2683 | CT Loss: 5.2494| [0m
[91mEpoch: 2|  Loss:  8.1496 |Global loss: 10.0282| Local H loss: 0.0227  | Global H loss: 0.0271 [0m
[94mEpoch: 3|  NKD Loss: 2.2637 | CT Loss: 5.2466| [0m
[91mEpoch: 3|  Loss:  8.1114 |Global loss: 10.0231| Local H loss: 0.0247  | Global H loss: 0.029 [0m
[94mEpoch: 0|  NKD Loss: 2.2555 | CT Loss: 5.2643| [0m
[91mEpoch: 0|  Loss:  8.0601 |Global loss: 10.0348| Local H loss: 0.0252  | Global H loss: 0.03 [0m
[94mEpoch: 1|  NKD Loss: 2.2426 | CT Loss: 5.2608| [0m
[91mEpoch: 1|  Loss:  8.0093 |Global loss: 10.0196| Local H loss: 0.0273  | Global H loss: 0.032 [0m
[94mEpoch: 2|  NKD Loss: 2.2391 | CT Loss: 5.2575| [0m
[91mEpoch: 2|  Loss:  7.9691 |Global loss: 10.0141| Local H loss: 0.0291  | Global H loss: 0.0341 [0m
[94mEpoch: 3|  NKD Loss: 2.2433 | CT Loss: 5.2543| [0m
[91mEpoch: 3|  Loss:  7.9791 |Global loss: 10.0154| Local H loss: 0.0292  | Global H loss: 0.0339 [0m
[94mEpoch: 0|  NKD Loss: 2.2902 | CT Loss: 5.2842| [0m
[91mEpoch: 0|  Loss:  8.3046 |Global loss: 10.0792| Local H loss: 0.017  | Global H loss: 0.0206 [0m
[94mEpoch: 1|  NKD Loss: 2.2827 | CT Loss: 5.2794| [0m
[91mEpoch: 1|  Loss:  8.247 |Global loss: 10.0671| Local H loss: 0.0183  | Global H loss: 0.0221 [0m
[94mEpoch: 2|  NKD Loss: 2.2783 | CT Loss: 5.2771| [0m
[91mEpoch: 2|  Loss:  8.2019 |Global loss: 10.0632| Local H loss: 0.02  | Global H loss: 0.0239 [0m
[94mEpoch: 3|  NKD Loss: 2.2647 | CT Loss: 5.2725| [0m
[91mEpoch: 3|  Loss:  8.1212 |Global loss: 10.0497| Local H loss: 0.0223  | Global H loss: 0.0267 [0m
[94mEpoch: 0|  NKD Loss: 2.3013 | CT Loss: 5.2822| [0m
[91mEpoch: 0|  Loss:  9.0594 |Global loss: 10.0734| Local H loss: 0.0034  | Global H loss: 0.004 [0m
[94mEpoch: 1|  NKD Loss: 2.3025 | CT Loss: 5.2797| [0m
[91mEpoch: 1|  Loss:  8.9478 |Global loss: 10.0724| Local H loss: 0.0044  | Global H loss: 0.0053 [0m
[94mEpoch: 2|  NKD Loss: 2.2971 | CT Loss: 5.2764| [0m
[91mEpoch: 2|  Loss:  8.8245 |Global loss: 10.0656| Local H loss: 0.0054  | Global H loss: 0.0066 [0m
[94mEpoch: 3|  NKD Loss: 2.2967 | CT Loss: 5.2754| [0m
[91mEpoch: 3|  Loss:  8.726 |Global loss: 10.0645| Local H loss: 0.0066  | Global H loss: 0.0082 [0m
[94mEpoch: 0|  NKD Loss: 2.3185 | CT Loss: 5.2848| [0m
[91mEpoch: 0|  Loss:  8.737 |Global loss: 10.0973| Local H loss: 0.0077  | Global H loss: 0.0093 [0m
[94mEpoch: 1|  NKD Loss: 2.315 | CT Loss: 5.2811| [0m
[91mEpoch: 1|  Loss:  8.6456 |Global loss: 10.0917| Local H loss: 0.0089  | Global H loss: 0.0109 [0m
[94mEpoch: 2|  NKD Loss: 2.3114 | CT Loss: 5.2753| [0m
[91mEpoch: 2|  Loss:  8.5535 |Global loss: 10.0836| Local H loss: 0.0103  | Global H loss: 0.0126 [0m
[94mEpoch: 3|  NKD Loss: 2.3082 | CT Loss: 5.2711| [0m
[91mEpoch: 3|  Loss:  8.5038 |Global loss: 10.0769| Local H loss: 0.0111  | Global H loss: 0.0137 [0m
------------------------- time cost ------------------------- 3.602530002593994
Chosen Clients:  [7, 3, 12, 4, 5, 11]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.925, 0.858, 0.85, 0.85, 0.45, 0.183, 0.683, 0.975, 0.975, 0.975, 0.85, 0.892, 0.942, 0.067, 0.983]
AUC in each clients:  [118.953, 118.945, 118.504, 119.03, 105.41, 102.435, 115.893, 119.627, 119.695, 119.576, 118.848, 119.242, 119.5, 55.867, 119.751]
F1 Score:  [0.933, 0.822, 0.856, 0.844, 0.358, 0.105, 0.668, 0.973, 0.973, 0.974, 0.845, 0.893, 0.948, 0.01, 0.981]
Recall Score:  [0.941, 0.871, 0.891, 0.884, 0.528, 0.256, 0.764, 0.977, 0.977, 0.977, 0.89, 0.923, 0.955, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.5361
Averaged Test Accurancy: 0.7639
Averaged Test AUC: 0.9396
Averaged Test F1_score: 0.7455
Averaged Test Recal score: 0.7934
Std Test Accurancy: 0.2846
Std Test AUC: 0.1339
Std Test F1: 0.0026
Std Test Recall: 0.0023
[94mEpoch: 0|  NKD Loss: 2.2301 | CT Loss: 5.2515| [0m
[91mEpoch: 0|  Loss:  7.9192 |Global loss: 10.0033| Local H loss: 0.0321  | Global H loss: 0.0367 [0m
[94mEpoch: 1|  NKD Loss: 2.2262 | CT Loss: 5.2482| [0m
[91mEpoch: 1|  Loss:  7.8958 |Global loss: 9.9969| Local H loss: 0.0331  | Global H loss: 0.0378 [0m
[94mEpoch: 2|  NKD Loss: 2.2178 | CT Loss: 5.245| [0m
[91mEpoch: 2|  Loss:  7.8603 |Global loss: 9.9871| Local H loss: 0.0355  | Global H loss: 0.0398 [0m
[94mEpoch: 3|  NKD Loss: 2.2084 | CT Loss: 5.2424| [0m
[91mEpoch: 3|  Loss:  7.8141 |Global loss: 9.977| Local H loss: 0.0373  | Global H loss: 0.0418 [0m
[94mEpoch: 0|  NKD Loss: 2.3063 | CT Loss: 5.296| [0m
[91mEpoch: 0|  Loss:  8.5837 |Global loss: 10.0985| Local H loss: 0.0094  | Global H loss: 0.0117 [0m
[94mEpoch: 1|  NKD Loss: 2.3028 | CT Loss: 5.2909| [0m
[91mEpoch: 1|  Loss:  8.5223 |Global loss: 10.0931| Local H loss: 0.0105  | Global H loss: 0.0132 [0m
[94mEpoch: 2|  NKD Loss: 2.3044 | CT Loss: 5.2884| [0m
[91mEpoch: 2|  Loss:  8.4558 |Global loss: 10.0937| Local H loss: 0.0123  | Global H loss: 0.0154 [0m
[94mEpoch: 3|  NKD Loss: 2.2923 | CT Loss: 5.2827| [0m
[91mEpoch: 3|  Loss:  8.3622 |Global loss: 10.0768| Local H loss: 0.014  | Global H loss: 0.0176 [0m
[94mEpoch: 0|  NKD Loss: 2.3028 | CT Loss: 5.2678| [0m
[91mEpoch: 0|  Loss:  8.4407 |Global loss: 10.0719| Local H loss: 0.0124  | Global H loss: 0.0155 [0m
[94mEpoch: 1|  NKD Loss: 2.2982 | CT Loss: 5.2625| [0m
[91mEpoch: 1|  Loss:  8.3839 |Global loss: 10.0625| Local H loss: 0.0137  | Global H loss: 0.0171 [0m
[94mEpoch: 2|  NKD Loss: 2.2974 | CT Loss: 5.26| [0m
[91mEpoch: 2|  Loss:  8.3516 |Global loss: 10.061| Local H loss: 0.0144  | Global H loss: 0.018 [0m
[94mEpoch: 3|  NKD Loss: 2.2904 | CT Loss: 5.2553| [0m
[91mEpoch: 3|  Loss:  8.2783 |Global loss: 10.0503| Local H loss: 0.0165  | Global H loss: 0.0205 [0m
[94mEpoch: 0|  NKD Loss: 2.2946 | CT Loss: 5.3013| [0m
[91mEpoch: 0|  Loss:  9.4911 |Global loss: 10.0814| Local H loss: 0.001  | Global H loss: 0.0011 [0m
[94mEpoch: 1|  NKD Loss: 2.2922 | CT Loss: 5.2973| [0m
[91mEpoch: 1|  Loss:  9.3391 |Global loss: 10.0755| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.2909 | CT Loss: 5.2918| [0m
[91mEpoch: 2|  Loss:  9.1886 |Global loss: 10.0712| Local H loss: 0.0024  | Global H loss: 0.0028 [0m
[94mEpoch: 3|  NKD Loss: 2.291 | CT Loss: 5.2888| [0m
[91mEpoch: 3|  Loss:  9.03 |Global loss: 10.0696| Local H loss: 0.0035  | Global H loss: 0.0041 [0m
[94mEpoch: 0|  NKD Loss: 2.3044 | CT Loss: 5.3161| [0m
[91mEpoch: 0|  Loss:  9.5158 |Global loss: 10.1059| Local H loss: 0.0012  | Global H loss: 0.0013 [0m
[94mEpoch: 1|  NKD Loss: 2.305 | CT Loss: 5.3055| [0m
[91mEpoch: 1|  Loss:  9.3874 |Global loss: 10.0961| Local H loss: 0.0016  | Global H loss: 0.0018 [0m
[94mEpoch: 2|  NKD Loss: 2.3085 | CT Loss: 5.2998| [0m
[91mEpoch: 2|  Loss:  9.268 |Global loss: 10.095| Local H loss: 0.0023  | Global H loss: 0.0026 [0m
[94mEpoch: 3|  NKD Loss: 2.3125 | CT Loss: 5.293| [0m
[91mEpoch: 3|  Loss:  9.1439 |Global loss: 10.0939| Local H loss: 0.0031  | Global H loss: 0.0036 [0m
[94mEpoch: 0|  NKD Loss: 2.2945 | CT Loss: 5.287| [0m
[91mEpoch: 0|  Loss:  8.4662 |Global loss: 10.0808| Local H loss: 0.0116  | Global H loss: 0.0145 [0m
[94mEpoch: 1|  NKD Loss: 2.2906 | CT Loss: 5.284| [0m
[91mEpoch: 1|  Loss:  8.4111 |Global loss: 10.0747| Local H loss: 0.0129  | Global H loss: 0.0161 [0m
[94mEpoch: 2|  NKD Loss: 2.2866 | CT Loss: 5.2806| [0m
[91mEpoch: 2|  Loss:  8.334 |Global loss: 10.0688| Local H loss: 0.0149  | Global H loss: 0.0187 [0m
[94mEpoch: 3|  NKD Loss: 2.2808 | CT Loss: 5.2757| [0m
[91mEpoch: 3|  Loss:  8.2692 |Global loss: 10.061| Local H loss: 0.0167  | Global H loss: 0.0207 [0m
------------------------- time cost ------------------------- 2.9217584133148193
Chosen Clients:  [4, 1, 12, 9, 8, 5]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.925, 0.858, 0.85, 0.992, 0.95, 0.7, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.933, 0.067, 0.983]
AUC in each clients:  [118.953, 118.945, 118.504, 119.616, 118.773, 116.432, 115.893, 119.421, 119.695, 119.576, 118.848, 119.765, 119.57, 55.867, 119.751]
F1 Score:  [0.933, 0.822, 0.856, 0.992, 0.942, 0.665, 0.668, 0.973, 0.973, 0.974, 0.845, 0.981, 0.942, 0.01, 0.981]
Recall Score:  [0.941, 0.871, 0.891, 0.993, 0.95, 0.744, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.949, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.3612
Averaged Test Accurancy: 0.8467
Averaged Test AUC: 0.9553
Averaged Test F1_score: 0.8371
Averaged Test Recal score: 0.8650
Std Test Accurancy: 0.2293
Std Test AUC: 0.1312
Std Test F1: 0.0020
Std Test Recall: 0.0019
[94mEpoch: 0|  NKD Loss: 2.2901 | CT Loss: 5.2859| [0m
[91mEpoch: 0|  Loss:  8.8788 |Global loss: 10.0664| Local H loss: 0.0049  | Global H loss: 0.006 [0m
[94mEpoch: 1|  NKD Loss: 2.2947 | CT Loss: 5.2826| [0m
[91mEpoch: 1|  Loss:  8.7558 |Global loss: 10.0699| Local H loss: 0.0065  | Global H loss: 0.008 [0m
[94mEpoch: 2|  NKD Loss: 2.2927 | CT Loss: 5.2788| [0m
[91mEpoch: 2|  Loss:  8.6328 |Global loss: 10.0675| Local H loss: 0.0083  | Global H loss: 0.0102 [0m
[94mEpoch: 3|  NKD Loss: 2.2948 | CT Loss: 5.2757| [0m
[91mEpoch: 3|  Loss:  8.5445 |Global loss: 10.068| Local H loss: 0.0101  | Global H loss: 0.0124 [0m
[94mEpoch: 0|  NKD Loss: 2.2931 | CT Loss: 5.2718| [0m
[91mEpoch: 0|  Loss:  8.5911 |Global loss: 10.0604| Local H loss: 0.0085  | Global H loss: 0.0107 [0m
[94mEpoch: 1|  NKD Loss: 2.2864 | CT Loss: 5.2693| [0m
[91mEpoch: 1|  Loss:  8.4936 |Global loss: 10.0523| Local H loss: 0.0102  | Global H loss: 0.013 [0m
[94mEpoch: 2|  NKD Loss: 2.281 | CT Loss: 5.2677| [0m
[91mEpoch: 2|  Loss:  8.4081 |Global loss: 10.0477| Local H loss: 0.012  | Global H loss: 0.0154 [0m
[94mEpoch: 3|  NKD Loss: 2.2746 | CT Loss: 5.2634| [0m
[91mEpoch: 3|  Loss:  8.3324 |Global loss: 10.0414| Local H loss: 0.0138  | Global H loss: 0.0177 [0m
[94mEpoch: 0|  NKD Loss: 2.2864 | CT Loss: 5.2527| [0m
[91mEpoch: 0|  Loss:  8.2503 |Global loss: 10.0451| Local H loss: 0.0173  | Global H loss: 0.0214 [0m
[94mEpoch: 1|  NKD Loss: 2.2833 | CT Loss: 5.2513| [0m
[91mEpoch: 1|  Loss:  8.206 |Global loss: 10.0426| Local H loss: 0.0185  | Global H loss: 0.0231 [0m
[94mEpoch: 2|  NKD Loss: 2.2723 | CT Loss: 5.2468| [0m
[91mEpoch: 2|  Loss:  8.1513 |Global loss: 10.0295| Local H loss: 0.02  | Global H loss: 0.0247 [0m
[94mEpoch: 3|  NKD Loss: 2.2684 | CT Loss: 5.2433| [0m
[91mEpoch: 3|  Loss:  8.1237 |Global loss: 10.022| Local H loss: 0.0213  | Global H loss: 0.0263 [0m
[94mEpoch: 0|  NKD Loss: 2.2324 | CT Loss: 5.2737| [0m
[91mEpoch: 0|  Loss:  8.0004 |Global loss: 10.0218| Local H loss: 0.026  | Global H loss: 0.0315 [0m
[94mEpoch: 1|  NKD Loss: 2.2262 | CT Loss: 5.269| [0m
[91mEpoch: 1|  Loss:  7.9486 |Global loss: 10.0129| Local H loss: 0.0286  | Global H loss: 0.0342 [0m
[94mEpoch: 2|  NKD Loss: 2.225 | CT Loss: 5.2669| [0m
[91mEpoch: 2|  Loss:  7.9213 |Global loss: 10.0142| Local H loss: 0.0301  | Global H loss: 0.0359 [0m
[94mEpoch: 3|  NKD Loss: 2.2134 | CT Loss: 5.2632| [0m
[91mEpoch: 3|  Loss:  7.8677 |Global loss: 10.0002| Local H loss: 0.0331  | Global H loss: 0.0388 [0m
[94mEpoch: 0|  NKD Loss: 2.2686 | CT Loss: 5.2698| [0m
[91mEpoch: 0|  Loss:  8.1103 |Global loss: 10.0506| Local H loss: 0.0229  | Global H loss: 0.0274 [0m
[94mEpoch: 1|  NKD Loss: 2.2566 | CT Loss: 5.2672| [0m
[91mEpoch: 1|  Loss:  8.0433 |Global loss: 10.0409| Local H loss: 0.0255  | Global H loss: 0.0302 [0m
[94mEpoch: 2|  NKD Loss: 2.2541 | CT Loss: 5.2632| [0m
[91mEpoch: 2|  Loss:  8.0228 |Global loss: 10.0333| Local H loss: 0.026  | Global H loss: 0.0307 [0m
[94mEpoch: 3|  NKD Loss: 2.2466 | CT Loss: 5.2602| [0m
[91mEpoch: 3|  Loss:  7.9807 |Global loss: 10.0242| Local H loss: 0.0276  | Global H loss: 0.0325 [0m
[94mEpoch: 0|  NKD Loss: 2.315 | CT Loss: 5.2865| [0m
[91mEpoch: 0|  Loss:  9.027 |Global loss: 10.0932| Local H loss: 0.004  | Global H loss: 0.0048 [0m
[94mEpoch: 1|  NKD Loss: 2.32 | CT Loss: 5.2831| [0m
[91mEpoch: 1|  Loss:  8.9305 |Global loss: 10.0942| Local H loss: 0.0049  | Global H loss: 0.0059 [0m
[94mEpoch: 2|  NKD Loss: 2.3229 | CT Loss: 5.2789| [0m
[91mEpoch: 2|  Loss:  8.8342 |Global loss: 10.0935| Local H loss: 0.0061  | Global H loss: 0.0074 [0m
[94mEpoch: 3|  NKD Loss: 2.3227 | CT Loss: 5.2756| [0m
[91mEpoch: 3|  Loss:  8.7449 |Global loss: 10.092| Local H loss: 0.0071  | Global H loss: 0.0088 [0m
------------------------- time cost ------------------------- 2.9355146884918213
Chosen Clients:  [13, 14, 10, 5, 9, 8]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.925, 0.975, 0.85, 0.992, 0.958, 0.858, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.9, 0.067, 0.983]
AUC in each clients:  [118.953, 119.841, 118.504, 119.616, 119.717, 118.623, 115.893, 119.421, 119.442, 119.623, 118.848, 119.765, 119.617, 55.867, 119.751]
F1 Score:  [0.933, 0.974, 0.856, 0.992, 0.953, 0.846, 0.668, 0.973, 0.973, 0.974, 0.845, 0.981, 0.915, 0.01, 0.981]
Recall Score:  [0.941, 0.977, 0.891, 0.993, 0.958, 0.87, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.927, 0.083, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.2534
Averaged Test Accurancy: 0.8633
Averaged Test AUC: 0.9575
Averaged Test F1_score: 0.8583
Averaged Test Recal score: 0.8795
Std Test Accurancy: 0.2276
Std Test AUC: 0.1317
Std Test F1: 0.0020
Std Test Recall: 0.0018
[94mEpoch: 0|  NKD Loss: 2.318 | CT Loss: 5.362| [0m
[91mEpoch: 0|  Loss:  10.1166 |Global loss: 10.1634| Local H loss: 0.0  | Global H loss: 0.0 [0m
[94mEpoch: 1|  NKD Loss: 2.3093 | CT Loss: 5.3432| [0m
[91mEpoch: 1|  Loss:  9.9715 |Global loss: 10.1351| Local H loss: 0.0001  | Global H loss: 0.0001 [0m
[94mEpoch: 2|  NKD Loss: 2.304 | CT Loss: 5.3334| [0m
[91mEpoch: 2|  Loss:  9.8616 |Global loss: 10.1221| Local H loss: 0.0002  | Global H loss: 0.0002 [0m
[94mEpoch: 3|  NKD Loss: 2.3005 | CT Loss: 5.327| [0m
[91mEpoch: 3|  Loss:  9.751 |Global loss: 10.113| Local H loss: 0.0004  | Global H loss: 0.0004 [0m
[94mEpoch: 0|  NKD Loss: 2.2599 | CT Loss: 5.263| [0m
[91mEpoch: 0|  Loss:  8.135 |Global loss: 10.0328| Local H loss: 0.0193  | Global H loss: 0.0243 [0m
[94mEpoch: 1|  NKD Loss: 2.2519 | CT Loss: 5.2594| [0m
[91mEpoch: 1|  Loss:  8.0716 |Global loss: 10.0216| Local H loss: 0.0216  | Global H loss: 0.0269 [0m
[94mEpoch: 2|  NKD Loss: 2.2429 | CT Loss: 5.2563| [0m
[91mEpoch: 2|  Loss:  8.0126 |Global loss: 10.0149| Local H loss: 0.0237  | Global H loss: 0.0294 [0m
[94mEpoch: 3|  NKD Loss: 2.2374 | CT Loss: 5.2527| [0m
[91mEpoch: 3|  Loss:  7.9685 |Global loss: 10.0083| Local H loss: 0.026  | Global H loss: 0.0317 [0m
[94mEpoch: 0|  NKD Loss: 2.2838 | CT Loss: 5.2614| [0m
[91mEpoch: 0|  Loss:  8.3395 |Global loss: 10.0497| Local H loss: 0.016  | Global H loss: 0.0195 [0m
[94mEpoch: 1|  NKD Loss: 2.2748 | CT Loss: 5.2567| [0m
[91mEpoch: 1|  Loss:  8.2563 |Global loss: 10.0388| Local H loss: 0.0183  | Global H loss: 0.0223 [0m
[94mEpoch: 2|  NKD Loss: 2.2761 | CT Loss: 5.2534| [0m
[91mEpoch: 2|  Loss:  8.237 |Global loss: 10.0385| Local H loss: 0.0192  | Global H loss: 0.0232 [0m
[94mEpoch: 3|  NKD Loss: 2.2751 | CT Loss: 5.2516| [0m
[91mEpoch: 3|  Loss:  8.2042 |Global loss: 10.0362| Local H loss: 0.0206  | Global H loss: 0.0248 [0m
[94mEpoch: 0|  NKD Loss: 2.3236 | CT Loss: 5.272| [0m
[91mEpoch: 0|  Loss:  8.6712 |Global loss: 10.0899| Local H loss: 0.0083  | Global H loss: 0.0103 [0m
[94mEpoch: 1|  NKD Loss: 2.3178 | CT Loss: 5.2687| [0m
[91mEpoch: 1|  Loss:  8.5839 |Global loss: 10.0843| Local H loss: 0.0096  | Global H loss: 0.0121 [0m
[94mEpoch: 2|  NKD Loss: 2.3165 | CT Loss: 5.2656| [0m
[91mEpoch: 2|  Loss:  8.5438 |Global loss: 10.0819| Local H loss: 0.0105  | Global H loss: 0.0132 [0m
[94mEpoch: 3|  NKD Loss: 2.3105 | CT Loss: 5.2627| [0m
[91mEpoch: 3|  Loss:  8.4695 |Global loss: 10.0732| Local H loss: 0.0119  | Global H loss: 0.015 [0m
[94mEpoch: 0|  NKD Loss: 2.2064 | CT Loss: 5.2607| [0m
[91mEpoch: 0|  Loss:  7.8286 |Global loss: 9.9942| Local H loss: 0.0355  | Global H loss: 0.041 [0m
[94mEpoch: 1|  NKD Loss: 2.2072 | CT Loss: 5.2584| [0m
[91mEpoch: 1|  Loss:  7.8228 |Global loss: 9.991| Local H loss: 0.0364  | Global H loss: 0.0417 [0m
[94mEpoch: 2|  NKD Loss: 2.2005 | CT Loss: 5.2556| [0m
[91mEpoch: 2|  Loss:  7.7828 |Global loss: 9.9842| Local H loss: 0.0392  | Global H loss: 0.0443 [0m
[94mEpoch: 3|  NKD Loss: 2.194 | CT Loss: 5.2514| [0m
[91mEpoch: 3|  Loss:  7.7526 |Global loss: 9.9758| Local H loss: 0.0411  | Global H loss: 0.0461 [0m
[94mEpoch: 0|  NKD Loss: 2.2405 | CT Loss: 5.2572| [0m
[91mEpoch: 0|  Loss:  7.9375 |Global loss: 10.0175| Local H loss: 0.0299  | Global H loss: 0.035 [0m
[94mEpoch: 1|  NKD Loss: 2.2398 | CT Loss: 5.2531| [0m
[91mEpoch: 1|  Loss:  7.9221 |Global loss: 10.0142| Local H loss: 0.0305  | Global H loss: 0.0355 [0m
[94mEpoch: 2|  NKD Loss: 2.2405 | CT Loss: 5.2507| [0m
[91mEpoch: 2|  Loss:  7.922 |Global loss: 10.0132| Local H loss: 0.0314  | Global H loss: 0.0363 [0m
[94mEpoch: 3|  NKD Loss: 2.2275 | CT Loss: 5.2483| [0m
[91mEpoch: 3|  Loss:  7.8585 |Global loss: 10.002| Local H loss: 0.0331  | Global H loss: 0.0385 [0m
------------------------- time cost ------------------------- 3.060563325881958
Chosen Clients:  [4, 2, 11, 7, 5, 0]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.925, 0.975, 0.85, 0.992, 0.958, 0.967, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.9, 0.4, 0.975]
AUC in each clients:  [118.953, 119.841, 118.504, 119.616, 119.717, 119.395, 115.893, 119.421, 119.189, 119.556, 119.368, 119.765, 119.617, 99.949, 119.703]
F1 Score:  [0.933, 0.974, 0.856, 0.992, 0.953, 0.967, 0.668, 0.973, 0.974, 0.974, 0.845, 0.981, 0.915, 0.332, 0.973]
Recall Score:  [0.941, 0.977, 0.891, 0.993, 0.958, 0.971, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.927, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.1973
Averaged Test Accurancy: 0.8922
Averaged Test AUC: 0.9825
Averaged Test F1_score: 0.8873
Averaged Test Recal score: 0.9136
Std Test Accurancy: 0.1534
Std Test AUC: 0.0407
Std Test F1: 0.0014
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2907 | CT Loss: 5.2727| [0m
[91mEpoch: 0|  Loss:  8.4411 |Global loss: 10.0629| Local H loss: 0.0119  | Global H loss: 0.0147 [0m
[94mEpoch: 1|  NKD Loss: 2.2826 | CT Loss: 5.2693| [0m
[91mEpoch: 1|  Loss:  8.3573 |Global loss: 10.0553| Local H loss: 0.0138  | Global H loss: 0.017 [0m
[94mEpoch: 2|  NKD Loss: 2.2769 | CT Loss: 5.2654| [0m
[91mEpoch: 2|  Loss:  8.2791 |Global loss: 10.0479| Local H loss: 0.0159  | Global H loss: 0.0196 [0m
[94mEpoch: 3|  NKD Loss: 2.2684 | CT Loss: 5.2619| [0m
[91mEpoch: 3|  Loss:  8.2134 |Global loss: 10.0382| Local H loss: 0.0179  | Global H loss: 0.0221 [0m
[94mEpoch: 0|  NKD Loss: 2.3031 | CT Loss: 5.3052| [0m
[91mEpoch: 0|  Loss:  8.6078 |Global loss: 10.1055| Local H loss: 0.0102  | Global H loss: 0.0127 [0m
[94mEpoch: 1|  NKD Loss: 2.3025 | CT Loss: 5.2985| [0m
[91mEpoch: 1|  Loss:  8.5454 |Global loss: 10.0995| Local H loss: 0.0116  | Global H loss: 0.0143 [0m
[94mEpoch: 2|  NKD Loss: 2.2971 | CT Loss: 5.2929| [0m
[91mEpoch: 2|  Loss:  8.475 |Global loss: 10.0904| Local H loss: 0.0132  | Global H loss: 0.0162 [0m
[94mEpoch: 3|  NKD Loss: 2.2948 | CT Loss: 5.2883| [0m
[91mEpoch: 3|  Loss:  8.4256 |Global loss: 10.0839| Local H loss: 0.0146  | Global H loss: 0.0179 [0m
[94mEpoch: 0|  NKD Loss: 2.2737 | CT Loss: 5.2725| [0m
[91mEpoch: 0|  Loss:  8.2031 |Global loss: 10.055| Local H loss: 0.0186  | Global H loss: 0.023 [0m
[94mEpoch: 1|  NKD Loss: 2.2672 | CT Loss: 5.2688| [0m
[91mEpoch: 1|  Loss:  8.1442 |Global loss: 10.0471| Local H loss: 0.021  | Global H loss: 0.0257 [0m
[94mEpoch: 2|  NKD Loss: 2.2635 | CT Loss: 5.2667| [0m
[91mEpoch: 2|  Loss:  8.1193 |Global loss: 10.0415| Local H loss: 0.0217  | Global H loss: 0.0265 [0m
[94mEpoch: 3|  NKD Loss: 2.2556 | CT Loss: 5.2642| [0m
[91mEpoch: 3|  Loss:  8.0647 |Global loss: 10.0336| Local H loss: 0.0236  | Global H loss: 0.0287 [0m
[94mEpoch: 0|  NKD Loss: 2.2055 | CT Loss: 5.2418| [0m
[91mEpoch: 0|  Loss:  7.7976 |Global loss: 9.974| Local H loss: 0.0388  | Global H loss: 0.043 [0m
[94mEpoch: 1|  NKD Loss: 2.2098 | CT Loss: 5.2386| [0m
[91mEpoch: 1|  Loss:  7.8055 |Global loss: 9.9763| Local H loss: 0.0386  | Global H loss: 0.0425 [0m
[94mEpoch: 2|  NKD Loss: 2.2025 | CT Loss: 5.2361| [0m
[91mEpoch: 2|  Loss:  7.7755 |Global loss: 9.9675| Local H loss: 0.0403  | Global H loss: 0.0443 [0m
[94mEpoch: 3|  NKD Loss: 2.2101 | CT Loss: 5.2358| [0m
[91mEpoch: 3|  Loss:  7.8115 |Global loss: 9.9758| Local H loss: 0.0402  | Global H loss: 0.0435 [0m
[94mEpoch: 0|  NKD Loss: 2.3116 | CT Loss: 5.2604| [0m
[91mEpoch: 0|  Loss:  8.4357 |Global loss: 10.0737| Local H loss: 0.0128  | Global H loss: 0.0161 [0m
[94mEpoch: 1|  NKD Loss: 2.3022 | CT Loss: 5.2573| [0m
[91mEpoch: 1|  Loss:  8.36 |Global loss: 10.0636| Local H loss: 0.0142  | Global H loss: 0.0179 [0m
[94mEpoch: 2|  NKD Loss: 2.298 | CT Loss: 5.2551| [0m
[91mEpoch: 2|  Loss:  8.3179 |Global loss: 10.0578| Local H loss: 0.0155  | Global H loss: 0.0194 [0m
[94mEpoch: 3|  NKD Loss: 2.293 | CT Loss: 5.2519| [0m
[91mEpoch: 3|  Loss:  8.2817 |Global loss: 10.0505| Local H loss: 0.0164  | Global H loss: 0.0204 [0m
[94mEpoch: 0|  NKD Loss: 2.2621 | CT Loss: 5.2427| [0m
[91mEpoch: 0|  Loss:  8.0915 |Global loss: 10.0211| Local H loss: 0.026  | Global H loss: 0.0301 [0m
[94mEpoch: 1|  NKD Loss: 2.2591 | CT Loss: 5.2403| [0m
[91mEpoch: 1|  Loss:  8.063 |Global loss: 10.0154| Local H loss: 0.0267  | Global H loss: 0.0309 [0m
[94mEpoch: 2|  NKD Loss: 2.2531 | CT Loss: 5.2367| [0m
[91mEpoch: 2|  Loss:  8.0241 |Global loss: 10.0074| Local H loss: 0.0288  | Global H loss: 0.0328 [0m
[94mEpoch: 3|  NKD Loss: 2.2489 | CT Loss: 5.2357| [0m
[91mEpoch: 3|  Loss:  7.9914 |Global loss: 10.0049| Local H loss: 0.0303  | Global H loss: 0.0343 [0m
------------------------- time cost ------------------------- 3.1129415035247803
Chosen Clients:  [7, 8, 11, 0, 3, 5]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.933, 0.975, 0.892, 0.992, 0.958, 0.967, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.9, 0.4, 0.975]
AUC in each clients:  [119.019, 119.841, 119.236, 119.616, 119.812, 119.566, 115.893, 119.229, 119.189, 119.556, 119.368, 119.692, 119.617, 99.949, 119.703]
F1 Score:  [0.943, 0.974, 0.905, 0.992, 0.954, 0.967, 0.668, 0.974, 0.974, 0.974, 0.845, 0.981, 0.915, 0.332, 0.973]
Recall Score:  [0.949, 0.977, 0.918, 0.993, 0.958, 0.971, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.927, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.1292
Averaged Test Accurancy: 0.8956
Averaged Test AUC: 0.9829
Averaged Test F1_score: 0.8914
Averaged Test Recal score: 0.9159
Std Test Accurancy: 0.1531
Std Test AUC: 0.0408
Std Test F1: 0.0014
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2014 | CT Loss: 5.2328| [0m
[91mEpoch: 0|  Loss:  7.7596 |Global loss: 9.9665| Local H loss: 0.0421  | Global H loss: 0.0455 [0m
[94mEpoch: 1|  NKD Loss: 2.1932 | CT Loss: 5.2321| [0m
[91mEpoch: 1|  Loss:  7.7462 |Global loss: 9.9571| Local H loss: 0.0427  | Global H loss: 0.0459 [0m
[94mEpoch: 2|  NKD Loss: 2.2097 | CT Loss: 5.2286| [0m
[91mEpoch: 2|  Loss:  7.7808 |Global loss: 9.9689| Local H loss: 0.0419  | Global H loss: 0.0452 [0m
[94mEpoch: 3|  NKD Loss: 2.1861 | CT Loss: 5.2245| [0m
[91mEpoch: 3|  Loss:  7.706 |Global loss: 9.9427| Local H loss: 0.0449  | Global H loss: 0.048 [0m
[94mEpoch: 0|  NKD Loss: 2.2336 | CT Loss: 5.2459| [0m
[91mEpoch: 0|  Loss:  7.8791 |Global loss: 10.0049| Local H loss: 0.0336  | Global H loss: 0.0386 [0m
[94mEpoch: 1|  NKD Loss: 2.2367 | CT Loss: 5.2439| [0m
[91mEpoch: 1|  Loss:  7.87 |Global loss: 10.0048| Local H loss: 0.0342  | Global H loss: 0.0392 [0m
[94mEpoch: 2|  NKD Loss: 2.2134 | CT Loss: 5.2397| [0m
[91mEpoch: 2|  Loss:  7.7927 |Global loss: 9.9833| Local H loss: 0.0374  | Global H loss: 0.0425 [0m
[94mEpoch: 3|  NKD Loss: 2.2114 | CT Loss: 5.2368| [0m
[91mEpoch: 3|  Loss:  7.7794 |Global loss: 9.9759| Local H loss: 0.0381  | Global H loss: 0.0433 [0m
[94mEpoch: 0|  NKD Loss: 2.2481 | CT Loss: 5.2607| [0m
[91mEpoch: 0|  Loss:  8.0206 |Global loss: 10.0242| Local H loss: 0.0254  | Global H loss: 0.0306 [0m
[94mEpoch: 1|  NKD Loss: 2.2413 | CT Loss: 5.2583| [0m
[91mEpoch: 1|  Loss:  7.9672 |Global loss: 10.0189| Local H loss: 0.028  | Global H loss: 0.0333 [0m
[94mEpoch: 2|  NKD Loss: 2.2363 | CT Loss: 5.2552| [0m
[91mEpoch: 2|  Loss:  7.9561 |Global loss: 10.0112| Local H loss: 0.0287  | Global H loss: 0.034 [0m
[94mEpoch: 3|  NKD Loss: 2.2285 | CT Loss: 5.2521| [0m
[91mEpoch: 3|  Loss:  7.9109 |Global loss: 10.0015| Local H loss: 0.0305  | Global H loss: 0.036 [0m
[94mEpoch: 0|  NKD Loss: 2.2499 | CT Loss: 5.2318| [0m
[91mEpoch: 0|  Loss:  7.9894 |Global loss: 9.9993| Local H loss: 0.0305  | Global H loss: 0.0343 [0m
[94mEpoch: 1|  NKD Loss: 2.2441 | CT Loss: 5.2298| [0m
[91mEpoch: 1|  Loss:  7.9683 |Global loss: 9.9939| Local H loss: 0.0313  | Global H loss: 0.0351 [0m
[94mEpoch: 2|  NKD Loss: 2.2408 | CT Loss: 5.2263| [0m
[91mEpoch: 2|  Loss:  7.9427 |Global loss: 9.9877| Local H loss: 0.0325  | Global H loss: 0.0363 [0m
[94mEpoch: 3|  NKD Loss: 2.2361 | CT Loss: 5.2241| [0m
[91mEpoch: 3|  Loss:  7.9163 |Global loss: 9.9824| Local H loss: 0.0335  | Global H loss: 0.0374 [0m
[94mEpoch: 0|  NKD Loss: 2.2857 | CT Loss: 5.2802| [0m
[91mEpoch: 0|  Loss:  8.2914 |Global loss: 10.0716| Local H loss: 0.0158  | Global H loss: 0.0199 [0m
[94mEpoch: 1|  NKD Loss: 2.281 | CT Loss: 5.2764| [0m
[91mEpoch: 1|  Loss:  8.2478 |Global loss: 10.0639| Local H loss: 0.0174  | Global H loss: 0.0217 [0m
[94mEpoch: 2|  NKD Loss: 2.2796 | CT Loss: 5.2748| [0m
[91mEpoch: 2|  Loss:  8.2207 |Global loss: 10.0626| Local H loss: 0.0183  | Global H loss: 0.0227 [0m
[94mEpoch: 3|  NKD Loss: 2.2682 | CT Loss: 5.2704| [0m
[91mEpoch: 3|  Loss:  8.1551 |Global loss: 10.049| Local H loss: 0.0202  | Global H loss: 0.0249 [0m
[94mEpoch: 0|  NKD Loss: 2.2834 | CT Loss: 5.2481| [0m
[91mEpoch: 0|  Loss:  8.2178 |Global loss: 10.0386| Local H loss: 0.0183  | Global H loss: 0.0227 [0m
[94mEpoch: 1|  NKD Loss: 2.2803 | CT Loss: 5.2457| [0m
[91mEpoch: 1|  Loss:  8.1899 |Global loss: 10.0341| Local H loss: 0.019  | Global H loss: 0.0235 [0m
[94mEpoch: 2|  NKD Loss: 2.2786 | CT Loss: 5.2433| [0m
[91mEpoch: 2|  Loss:  8.167 |Global loss: 10.031| Local H loss: 0.0202  | Global H loss: 0.0247 [0m
[94mEpoch: 3|  NKD Loss: 2.2729 | CT Loss: 5.2407| [0m
[91mEpoch: 3|  Loss:  8.1273 |Global loss: 10.0263| Local H loss: 0.0219  | Global H loss: 0.0266 [0m
------------------------- time cost ------------------------- 3.650388479232788
Chosen Clients:  [12, 0, 14, 2, 1, 5]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.892, 0.975, 0.958, 0.967, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.9, 0.4, 0.975]
AUC in each clients:  [118.939, 119.841, 119.236, 119.567, 119.812, 119.308, 115.893, 119.142, 119.147, 119.556, 119.368, 119.68, 119.617, 99.949, 119.703]
F1 Score:  [0.974, 0.974, 0.905, 0.974, 0.954, 0.967, 0.668, 0.973, 0.974, 0.974, 0.845, 0.981, 0.915, 0.332, 0.973]
Recall Score:  [0.977, 0.977, 0.918, 0.977, 0.958, 0.971, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.927, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.0789
Averaged Test Accurancy: 0.8972
Averaged Test AUC: 0.9826
Averaged Test F1_score: 0.8922
Averaged Test Recal score: 0.9167
Std Test Accurancy: 0.1535
Std Test AUC: 0.0407
Std Test F1: 0.0014
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2566 | CT Loss: 5.2402| [0m
[91mEpoch: 0|  Loss:  8.0543 |Global loss: 10.0116| Local H loss: 0.0236  | Global H loss: 0.0289 [0m
[94mEpoch: 1|  NKD Loss: 2.2539 | CT Loss: 5.2365| [0m
[91mEpoch: 1|  Loss:  8.0305 |Global loss: 10.0048| Local H loss: 0.0246  | Global H loss: 0.0298 [0m
[94mEpoch: 2|  NKD Loss: 2.2487 | CT Loss: 5.2354| [0m
[91mEpoch: 2|  Loss:  7.999 |Global loss: 10.0019| Local H loss: 0.0258  | Global H loss: 0.0313 [0m
[94mEpoch: 3|  NKD Loss: 2.245 | CT Loss: 5.2333| [0m
[91mEpoch: 3|  Loss:  7.9822 |Global loss: 9.9946| Local H loss: 0.0262  | Global H loss: 0.0317 [0m
[94mEpoch: 0|  NKD Loss: 2.2343 | CT Loss: 5.2211| [0m
[91mEpoch: 0|  Loss:  7.9012 |Global loss: 9.9812| Local H loss: 0.0351  | Global H loss: 0.0384 [0m
[94mEpoch: 1|  NKD Loss: 2.2346 | CT Loss: 5.2186| [0m
[91mEpoch: 1|  Loss:  7.8955 |Global loss: 9.9766| Local H loss: 0.0352  | Global H loss: 0.0386 [0m
[94mEpoch: 2|  NKD Loss: 2.2269 | CT Loss: 5.2161| [0m
[91mEpoch: 2|  Loss:  7.869 |Global loss: 9.967| Local H loss: 0.0364  | Global H loss: 0.0397 [0m
[94mEpoch: 3|  NKD Loss: 2.2227 | CT Loss: 5.212| [0m
[91mEpoch: 3|  Loss:  7.8446 |Global loss: 9.9613| Local H loss: 0.0379  | Global H loss: 0.0409 [0m
[94mEpoch: 0|  NKD Loss: 2.2355 | CT Loss: 5.2508| [0m
[91mEpoch: 0|  Loss:  7.9527 |Global loss: 10.004| Local H loss: 0.027  | Global H loss: 0.0328 [0m
[94mEpoch: 1|  NKD Loss: 2.2239 | CT Loss: 5.2468| [0m
[91mEpoch: 1|  Loss:  7.9003 |Global loss: 9.9909| Local H loss: 0.0291  | Global H loss: 0.0351 [0m
[94mEpoch: 2|  NKD Loss: 2.2175 | CT Loss: 5.2435| [0m
[91mEpoch: 2|  Loss:  7.8615 |Global loss: 9.9842| Local H loss: 0.0311  | Global H loss: 0.0371 [0m
[94mEpoch: 3|  NKD Loss: 2.2097 | CT Loss: 5.2401| [0m
[91mEpoch: 3|  Loss:  7.8205 |Global loss: 9.9749| Local H loss: 0.0336  | Global H loss: 0.0395 [0m
[94mEpoch: 0|  NKD Loss: 2.2906 | CT Loss: 5.2824| [0m
[91mEpoch: 0|  Loss:  8.3755 |Global loss: 10.0767| Local H loss: 0.0159  | Global H loss: 0.0194 [0m
[94mEpoch: 1|  NKD Loss: 2.2893 | CT Loss: 5.2793| [0m
[91mEpoch: 1|  Loss:  8.3336 |Global loss: 10.0748| Local H loss: 0.0172  | Global H loss: 0.0207 [0m
[94mEpoch: 2|  NKD Loss: 2.2827 | CT Loss: 5.2742| [0m
[91mEpoch: 2|  Loss:  8.2773 |Global loss: 10.0639| Local H loss: 0.0187  | Global H loss: 0.0223 [0m
[94mEpoch: 3|  NKD Loss: 2.2789 | CT Loss: 5.2718| [0m
[91mEpoch: 3|  Loss:  8.2424 |Global loss: 10.0597| Local H loss: 0.0199  | Global H loss: 0.0235 [0m
[94mEpoch: 0|  NKD Loss: 2.2671 | CT Loss: 5.2611| [0m
[91mEpoch: 0|  Loss:  8.2564 |Global loss: 10.033| Local H loss: 0.0157  | Global H loss: 0.0201 [0m
[94mEpoch: 1|  NKD Loss: 2.2561 | CT Loss: 5.2576| [0m
[91mEpoch: 1|  Loss:  8.1721 |Global loss: 10.0216| Local H loss: 0.0182  | Global H loss: 0.0231 [0m
[94mEpoch: 2|  NKD Loss: 2.252 | CT Loss: 5.2547| [0m
[91mEpoch: 2|  Loss:  8.1322 |Global loss: 10.0174| Local H loss: 0.0199  | Global H loss: 0.025 [0m
[94mEpoch: 3|  NKD Loss: 2.2448 | CT Loss: 5.2537| [0m
[91mEpoch: 3|  Loss:  8.0903 |Global loss: 10.0105| Local H loss: 0.0217  | Global H loss: 0.0269 [0m
[94mEpoch: 0|  NKD Loss: 2.2676 | CT Loss: 5.2381| [0m
[91mEpoch: 0|  Loss:  8.1022 |Global loss: 10.0176| Local H loss: 0.0223  | Global H loss: 0.0272 [0m
[94mEpoch: 1|  NKD Loss: 2.261 | CT Loss: 5.234| [0m
[91mEpoch: 1|  Loss:  8.0591 |Global loss: 10.0102| Local H loss: 0.024  | Global H loss: 0.0289 [0m
[94mEpoch: 2|  NKD Loss: 2.2554 | CT Loss: 5.2331| [0m
[91mEpoch: 2|  Loss:  8.0256 |Global loss: 10.0019| Local H loss: 0.0252  | Global H loss: 0.0302 [0m
[94mEpoch: 3|  NKD Loss: 2.2511 | CT Loss: 5.2301| [0m
[91mEpoch: 3|  Loss:  7.9999 |Global loss: 9.9981| Local H loss: 0.0263  | Global H loss: 0.0314 [0m
------------------------- time cost ------------------------- 3.0002858638763428
Chosen Clients:  [2, 6, 7, 11, 3, 14]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.908, 0.908, 0.975, 0.958, 0.975, 0.683, 0.975, 0.975, 0.975, 0.85, 0.983, 0.975, 0.4, 0.975]
AUC in each clients:  [118.92, 119.733, 119.461, 119.567, 119.812, 119.193, 115.893, 119.142, 119.147, 119.556, 119.368, 119.68, 119.799, 99.949, 119.59]
F1 Score:  [0.955, 0.87, 0.922, 0.974, 0.954, 0.974, 0.668, 0.973, 0.974, 0.974, 0.845, 0.981, 0.973, 0.332, 0.973]
Recall Score:  [0.96, 0.903, 0.932, 0.977, 0.958, 0.977, 0.764, 0.977, 0.977, 0.977, 0.89, 0.984, 0.977, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 10.0249
Averaged Test Accurancy: 0.8978
Averaged Test AUC: 0.9827
Averaged Test F1_score: 0.8895
Averaged Test Recal score: 0.9153
Std Test Accurancy: 0.1531
Std Test AUC: 0.0408
Std Test F1: 0.0014
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2725 | CT Loss: 5.2672| [0m
[91mEpoch: 0|  Loss:  8.192 |Global loss: 10.0491| Local H loss: 0.0215  | Global H loss: 0.0253 [0m
[94mEpoch: 1|  NKD Loss: 2.2694 | CT Loss: 5.2656| [0m
[91mEpoch: 1|  Loss:  8.1716 |Global loss: 10.0458| Local H loss: 0.0224  | Global H loss: 0.0262 [0m
[94mEpoch: 2|  NKD Loss: 2.2607 | CT Loss: 5.2631| [0m
[91mEpoch: 2|  Loss:  8.1059 |Global loss: 10.0365| Local H loss: 0.0245  | Global H loss: 0.0282 [0m
[94mEpoch: 3|  NKD Loss: 2.2577 | CT Loss: 5.2579| [0m
[91mEpoch: 3|  Loss:  8.0889 |Global loss: 10.0291| Local H loss: 0.0252  | Global H loss: 0.0288 [0m
[94mEpoch: 0|  NKD Loss: 2.296 | CT Loss: 5.296| [0m
[91mEpoch: 0|  Loss:  9.0694 |Global loss: 10.0831| Local H loss: 0.0039  | Global H loss: 0.0047 [0m
[94mEpoch: 1|  NKD Loss: 2.2983 | CT Loss: 5.2905| [0m
[91mEpoch: 1|  Loss:  8.9599 |Global loss: 10.0789| Local H loss: 0.0049  | Global H loss: 0.0059 [0m
[94mEpoch: 2|  NKD Loss: 2.3011 | CT Loss: 5.2851| [0m
[91mEpoch: 2|  Loss:  8.8385 |Global loss: 10.0768| Local H loss: 0.0064  | Global H loss: 0.0077 [0m
[94mEpoch: 3|  NKD Loss: 2.3003 | CT Loss: 5.2816| [0m
[91mEpoch: 3|  Loss:  8.7311 |Global loss: 10.0759| Local H loss: 0.0078  | Global H loss: 0.0093 [0m
[94mEpoch: 0|  NKD Loss: 2.1821 | CT Loss: 5.2234| [0m
[91mEpoch: 0|  Loss:  7.6907 |Global loss: 9.9406| Local H loss: 0.0471  | Global H loss: 0.0495 [0m
[94mEpoch: 1|  NKD Loss: 2.1811 | CT Loss: 5.2204| [0m
[91mEpoch: 1|  Loss:  7.6788 |Global loss: 9.9382| Local H loss: 0.0483  | Global H loss: 0.0505 [0m
[94mEpoch: 2|  NKD Loss: 2.1674 | CT Loss: 5.2178| [0m
[91mEpoch: 2|  Loss:  7.6344 |Global loss: 9.9225| Local H loss: 0.0509  | Global H loss: 0.0527 [0m
[94mEpoch: 3|  NKD Loss: 2.1723 | CT Loss: 5.2163| [0m
[91mEpoch: 3|  Loss:  7.6454 |Global loss: 9.9266| Local H loss: 0.0507  | Global H loss: 0.0524 [0m
[94mEpoch: 0|  NKD Loss: 2.225 | CT Loss: 5.2505| [0m
[91mEpoch: 0|  Loss:  7.8929 |Global loss: 9.9975| Local H loss: 0.0319  | Global H loss: 0.0372 [0m
[94mEpoch: 1|  NKD Loss: 2.2181 | CT Loss: 5.247| [0m
[91mEpoch: 1|  Loss:  7.8545 |Global loss: 9.988| Local H loss: 0.0339  | Global H loss: 0.0393 [0m
[94mEpoch: 2|  NKD Loss: 2.2132 | CT Loss: 5.2464| [0m
[91mEpoch: 2|  Loss:  7.841 |Global loss: 9.9834| Local H loss: 0.0346  | Global H loss: 0.0397 [0m
[94mEpoch: 3|  NKD Loss: 2.2055 | CT Loss: 5.2423| [0m
[91mEpoch: 3|  Loss:  7.8024 |Global loss: 9.974| Local H loss: 0.0369  | Global H loss: 0.042 [0m
[94mEpoch: 0|  NKD Loss: 2.2634 | CT Loss: 5.2672| [0m
[91mEpoch: 0|  Loss:  8.1064 |Global loss: 10.0434| Local H loss: 0.0222  | Global H loss: 0.0271 [0m
[94mEpoch: 1|  NKD Loss: 2.2525 | CT Loss: 5.2639| [0m
[91mEpoch: 1|  Loss:  8.0543 |Global loss: 10.0319| Local H loss: 0.0239  | Global H loss: 0.0291 [0m
[94mEpoch: 2|  NKD Loss: 2.254 | CT Loss: 5.262| [0m
[91mEpoch: 2|  Loss:  8.0482 |Global loss: 10.0304| Local H loss: 0.0249  | Global H loss: 0.03 [0m
[94mEpoch: 3|  NKD Loss: 2.2376 | CT Loss: 5.2589| [0m
[91mEpoch: 3|  Loss:  7.9724 |Global loss: 10.0137| Local H loss: 0.0274  | Global H loss: 0.0327 [0m
[94mEpoch: 0|  NKD Loss: 2.2082 | CT Loss: 5.2388| [0m
[91mEpoch: 0|  Loss:  7.81 |Global loss: 9.972| Local H loss: 0.0347  | Global H loss: 0.0404 [0m
[94mEpoch: 1|  NKD Loss: 2.2009 | CT Loss: 5.2338| [0m
[91mEpoch: 1|  Loss:  7.7751 |Global loss: 9.9615| Local H loss: 0.0364  | Global H loss: 0.0421 [0m
[94mEpoch: 2|  NKD Loss: 2.1944 | CT Loss: 5.2319| [0m
[91mEpoch: 2|  Loss:  7.7389 |Global loss: 9.9558| Local H loss: 0.039  | Global H loss: 0.0444 [0m
[94mEpoch: 3|  NKD Loss: 2.1908 | CT Loss: 5.2287| [0m
[91mEpoch: 3|  Loss:  7.7262 |Global loss: 9.9499| Local H loss: 0.04  | Global H loss: 0.0451 [0m
------------------------- time cost ------------------------- 3.077712297439575
Chosen Clients:  [2, 4, 8, 10, 0, 5]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.95, 0.908, 0.967, 0.975, 0.958, 0.975, 0.833, 0.975, 0.975, 0.975, 0.85, 0.983, 0.975, 0.4, 0.975]
AUC in each clients:  [118.92, 119.733, 119.626, 119.21, 119.812, 119.193, 118.251, 119.079, 119.147, 119.556, 119.368, 119.751, 119.799, 99.949, 119.622]
F1 Score:  [0.955, 0.87, 0.969, 0.973, 0.954, 0.974, 0.825, 0.974, 0.974, 0.974, 0.845, 0.981, 0.973, 0.332, 0.975]
Recall Score:  [0.96, 0.903, 0.973, 0.977, 0.958, 0.977, 0.875, 0.977, 0.977, 0.977, 0.89, 0.984, 0.977, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.9629
Averaged Test Accurancy: 0.9117
Averaged Test AUC: 0.9839
Averaged Test F1_score: 0.9032
Averaged Test Recal score: 0.9255
Std Test Accurancy: 0.1441
Std Test AUC: 0.0405
Std Test F1: 0.0013
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2548 | CT Loss: 5.2547| [0m
[91mEpoch: 0|  Loss:  8.0623 |Global loss: 10.0245| Local H loss: 0.0266  | Global H loss: 0.0304 [0m
[94mEpoch: 1|  NKD Loss: 2.2456 | CT Loss: 5.2527| [0m
[91mEpoch: 1|  Loss:  8.0208 |Global loss: 10.0137| Local H loss: 0.028  | Global H loss: 0.0317 [0m
[94mEpoch: 2|  NKD Loss: 2.2381 | CT Loss: 5.2485| [0m
[91mEpoch: 2|  Loss:  7.9779 |Global loss: 10.0041| Local H loss: 0.0293  | Global H loss: 0.0332 [0m
[94mEpoch: 3|  NKD Loss: 2.2374 | CT Loss: 5.2466| [0m
[91mEpoch: 3|  Loss:  7.9703 |Global loss: 10.0046| Local H loss: 0.0302  | Global H loss: 0.0339 [0m
[94mEpoch: 0|  NKD Loss: 2.2628 | CT Loss: 5.2587| [0m
[91mEpoch: 0|  Loss:  8.1589 |Global loss: 10.0325| Local H loss: 0.0196  | Global H loss: 0.0241 [0m
[94mEpoch: 1|  NKD Loss: 2.2557 | CT Loss: 5.2556| [0m
[91mEpoch: 1|  Loss:  8.1099 |Global loss: 10.0216| Local H loss: 0.0214  | Global H loss: 0.0262 [0m
[94mEpoch: 2|  NKD Loss: 2.2461 | CT Loss: 5.2531| [0m
[91mEpoch: 2|  Loss:  8.0474 |Global loss: 10.0118| Local H loss: 0.024  | Global H loss: 0.0292 [0m
[94mEpoch: 3|  NKD Loss: 2.2356 | CT Loss: 5.2498| [0m
[91mEpoch: 3|  Loss:  7.9947 |Global loss: 10.0026| Local H loss: 0.0265  | Global H loss: 0.0319 [0m
[94mEpoch: 0|  NKD Loss: 2.211 | CT Loss: 5.2348| [0m
[91mEpoch: 0|  Loss:  7.7636 |Global loss: 9.9743| Local H loss: 0.0391  | Global H loss: 0.0443 [0m
[94mEpoch: 1|  NKD Loss: 2.208 | CT Loss: 5.2322| [0m
[91mEpoch: 1|  Loss:  7.7623 |Global loss: 9.9708| Local H loss: 0.0395  | Global H loss: 0.0444 [0m
[94mEpoch: 2|  NKD Loss: 2.1949 | CT Loss: 5.2297| [0m
[91mEpoch: 2|  Loss:  7.7024 |Global loss: 9.9576| Local H loss: 0.0431  | Global H loss: 0.0479 [0m
[94mEpoch: 3|  NKD Loss: 2.1949 | CT Loss: 5.2271| [0m
[91mEpoch: 3|  Loss:  7.7048 |Global loss: 9.955| Local H loss: 0.0432  | Global H loss: 0.0479 [0m
[94mEpoch: 0|  NKD Loss: 2.2652 | CT Loss: 5.248| [0m
[91mEpoch: 0|  Loss:  8.1401 |Global loss: 10.0251| Local H loss: 0.0225  | Global H loss: 0.0269 [0m
[94mEpoch: 1|  NKD Loss: 2.2552 | CT Loss: 5.2438| [0m
[91mEpoch: 1|  Loss:  8.0829 |Global loss: 10.0121| Local H loss: 0.0246  | Global H loss: 0.0291 [0m
[94mEpoch: 2|  NKD Loss: 2.2513 | CT Loss: 5.2409| [0m
[91mEpoch: 2|  Loss:  8.05 |Global loss: 10.0072| Local H loss: 0.0267  | Global H loss: 0.0311 [0m
[94mEpoch: 3|  NKD Loss: 2.2455 | CT Loss: 5.2373| [0m
[91mEpoch: 3|  Loss:  8.0063 |Global loss: 10.0004| Local H loss: 0.0281  | Global H loss: 0.0326 [0m
[94mEpoch: 0|  NKD Loss: 2.2226 | CT Loss: 5.2114| [0m
[91mEpoch: 0|  Loss:  7.8409 |Global loss: 9.9617| Local H loss: 0.0382  | Global H loss: 0.0413 [0m
[94mEpoch: 1|  NKD Loss: 2.2159 | CT Loss: 5.2071| [0m
[91mEpoch: 1|  Loss:  7.8134 |Global loss: 9.9502| Local H loss: 0.0393  | Global H loss: 0.0423 [0m
[94mEpoch: 2|  NKD Loss: 2.2164 | CT Loss: 5.2061| [0m
[91mEpoch: 2|  Loss:  7.8154 |Global loss: 9.9497| Local H loss: 0.0394  | Global H loss: 0.0423 [0m
[94mEpoch: 3|  NKD Loss: 2.2127 | CT Loss: 5.2037| [0m
[91mEpoch: 3|  Loss:  7.7938 |Global loss: 9.9453| Local H loss: 0.0401  | Global H loss: 0.0431 [0m
[94mEpoch: 0|  NKD Loss: 2.2485 | CT Loss: 5.2282| [0m
[91mEpoch: 0|  Loss:  7.973 |Global loss: 9.9939| Local H loss: 0.0279  | Global H loss: 0.0329 [0m
[94mEpoch: 1|  NKD Loss: 2.2451 | CT Loss: 5.2257| [0m
[91mEpoch: 1|  Loss:  7.9558 |Global loss: 9.9906| Local H loss: 0.0291  | Global H loss: 0.034 [0m
[94mEpoch: 2|  NKD Loss: 2.2326 | CT Loss: 5.223| [0m
[91mEpoch: 2|  Loss:  7.9146 |Global loss: 9.9765| Local H loss: 0.03  | Global H loss: 0.0351 [0m
[94mEpoch: 3|  NKD Loss: 2.2309 | CT Loss: 5.2202| [0m
[91mEpoch: 3|  Loss:  7.8917 |Global loss: 9.9739| Local H loss: 0.0313  | Global H loss: 0.0363 [0m
------------------------- time cost ------------------------- 2.8619465827941895
Chosen Clients:  [2, 14, 1, 0, 3, 5]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.908, 0.942, 0.975, 0.967, 0.983, 0.833, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.4, 0.975]
AUC in each clients:  [118.932, 119.733, 119.49, 119.21, 119.802, 119.061, 118.251, 119.079, 119.13, 119.556, 119.491, 119.751, 119.799, 99.949, 119.622]
F1 Score:  [0.974, 0.87, 0.95, 0.973, 0.961, 0.981, 0.825, 0.974, 0.974, 0.974, 0.857, 0.981, 0.973, 0.332, 0.975]
Recall Score:  [0.977, 0.903, 0.956, 0.977, 0.965, 0.984, 0.875, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.9246
Averaged Test Accurancy: 0.9133
Averaged Test AUC: 0.9838
Averaged Test F1_score: 0.9049
Averaged Test Recal score: 0.9271
Std Test Accurancy: 0.1445
Std Test AUC: 0.0405
Std Test F1: 0.0013
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.2419 | CT Loss: 5.2463| [0m
[91mEpoch: 0|  Loss:  7.982 |Global loss: 10.0047| Local H loss: 0.03  | Global H loss: 0.034 [0m
[94mEpoch: 1|  NKD Loss: 2.2262 | CT Loss: 5.2421| [0m
[91mEpoch: 1|  Loss:  7.9091 |Global loss: 9.9905| Local H loss: 0.0328  | Global H loss: 0.0365 [0m
[94mEpoch: 2|  NKD Loss: 2.2219 | CT Loss: 5.2405| [0m
[91mEpoch: 2|  Loss:  7.8849 |Global loss: 9.983| Local H loss: 0.0337  | Global H loss: 0.0375 [0m
[94mEpoch: 3|  NKD Loss: 2.2253 | CT Loss: 5.2378| [0m
[91mEpoch: 3|  Loss:  7.8912 |Global loss: 9.9886| Local H loss: 0.0344  | Global H loss: 0.0382 [0m
[94mEpoch: 0|  NKD Loss: 2.1816 | CT Loss: 5.2265| [0m
[91mEpoch: 0|  Loss:  7.6904 |Global loss: 9.942| Local H loss: 0.0426  | Global H loss: 0.0477 [0m
[94mEpoch: 1|  NKD Loss: 2.1804 | CT Loss: 5.2236| [0m
[91mEpoch: 1|  Loss:  7.6806 |Global loss: 9.9355| Local H loss: 0.0438  | Global H loss: 0.0485 [0m
[94mEpoch: 2|  NKD Loss: 2.18 | CT Loss: 5.2218| [0m
[91mEpoch: 2|  Loss:  7.6737 |Global loss: 9.936| Local H loss: 0.044  | Global H loss: 0.0488 [0m
[94mEpoch: 3|  NKD Loss: 2.1725 | CT Loss: 5.2192| [0m
[91mEpoch: 3|  Loss:  7.6425 |Global loss: 9.9293| Local H loss: 0.0473  | Global H loss: 0.0514 [0m
[94mEpoch: 0|  NKD Loss: 2.237 | CT Loss: 5.2488| [0m
[91mEpoch: 0|  Loss:  8.0218 |Global loss: 10.003| Local H loss: 0.0243  | Global H loss: 0.0299 [0m
[94mEpoch: 1|  NKD Loss: 2.23 | CT Loss: 5.2467| [0m
[91mEpoch: 1|  Loss:  7.9815 |Global loss: 9.9942| Local H loss: 0.0264  | Global H loss: 0.0322 [0m
[94mEpoch: 2|  NKD Loss: 2.2292 | CT Loss: 5.2445| [0m
[91mEpoch: 2|  Loss:  7.9659 |Global loss: 9.9908| Local H loss: 0.0276  | Global H loss: 0.0332 [0m
[94mEpoch: 3|  NKD Loss: 2.2221 | CT Loss: 5.2419| [0m
[91mEpoch: 3|  Loss:  7.9288 |Global loss: 9.9851| Local H loss: 0.03  | Global H loss: 0.0354 [0m
[94mEpoch: 0|  NKD Loss: 2.2084 | CT Loss: 5.2019| [0m
[91mEpoch: 0|  Loss:  7.7688 |Global loss: 9.9382| Local H loss: 0.042  | Global H loss: 0.0445 [0m
[94mEpoch: 1|  NKD Loss: 2.2044 | CT Loss: 5.1985| [0m
[91mEpoch: 1|  Loss:  7.7556 |Global loss: 9.9342| Local H loss: 0.0429  | Global H loss: 0.0452 [0m
[94mEpoch: 2|  NKD Loss: 2.1999 | CT Loss: 5.1963| [0m
[91mEpoch: 2|  Loss:  7.7352 |Global loss: 9.9267| Local H loss: 0.0435  | Global H loss: 0.0459 [0m
[94mEpoch: 3|  NKD Loss: 2.2006 | CT Loss: 5.193| [0m
[91mEpoch: 3|  Loss:  7.7361 |Global loss: 9.925| Local H loss: 0.0444  | Global H loss: 0.0463 [0m
[94mEpoch: 0|  NKD Loss: 2.2279 | CT Loss: 5.2555| [0m
[91mEpoch: 0|  Loss:  7.913 |Global loss: 10.004| Local H loss: 0.0296  | Global H loss: 0.0352 [0m
[94mEpoch: 1|  NKD Loss: 2.224 | CT Loss: 5.2527| [0m
[91mEpoch: 1|  Loss:  7.8927 |Global loss: 9.997| Local H loss: 0.0315  | Global H loss: 0.037 [0m
[94mEpoch: 2|  NKD Loss: 2.2226 | CT Loss: 5.2496| [0m
[91mEpoch: 2|  Loss:  7.8797 |Global loss: 9.9946| Local H loss: 0.0323  | Global H loss: 0.0376 [0m
[94mEpoch: 3|  NKD Loss: 2.2238 | CT Loss: 5.2483| [0m
[91mEpoch: 3|  Loss:  7.8707 |Global loss: 9.995| Local H loss: 0.0329  | Global H loss: 0.0382 [0m
[94mEpoch: 0|  NKD Loss: 2.2273 | CT Loss: 5.2184| [0m
[91mEpoch: 0|  Loss:  7.8743 |Global loss: 9.9671| Local H loss: 0.0323  | Global H loss: 0.0372 [0m
[94mEpoch: 1|  NKD Loss: 2.2205 | CT Loss: 5.2162| [0m
[91mEpoch: 1|  Loss:  7.8398 |Global loss: 9.9617| Local H loss: 0.0341  | Global H loss: 0.0389 [0m
[94mEpoch: 2|  NKD Loss: 2.216 | CT Loss: 5.2139| [0m
[91mEpoch: 2|  Loss:  7.8145 |Global loss: 9.9546| Local H loss: 0.0357  | Global H loss: 0.0405 [0m
[94mEpoch: 3|  NKD Loss: 2.216 | CT Loss: 5.2115| [0m
[91mEpoch: 3|  Loss:  7.8155 |Global loss: 9.9527| Local H loss: 0.0364  | Global H loss: 0.0407 [0m
------------------------- time cost ------------------------- 3.115828037261963
Chosen Clients:  [0, 13, 14, 9, 5, 2]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.908, 0.983, 0.967, 0.967, 0.833, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.4, 0.975]
AUC in each clients:  [118.945, 119.762, 119.695, 118.955, 119.802, 119.114, 118.251, 119.079, 119.13, 119.556, 119.491, 119.751, 119.799, 99.949, 119.267]
F1 Score:  [0.974, 0.974, 0.922, 0.981, 0.961, 0.961, 0.825, 0.974, 0.974, 0.974, 0.857, 0.981, 0.973, 0.332, 0.974]
Recall Score:  [0.977, 0.977, 0.932, 0.984, 0.965, 0.963, 0.875, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.5, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.8881
Averaged Test Accurancy: 0.9150
Averaged Test AUC: 0.9836
Averaged Test F1_score: 0.9091
Averaged Test Recal score: 0.9295
Std Test Accurancy: 0.1449
Std Test AUC: 0.0404
Std Test F1: 0.0013
Std Test Recall: 0.0010
[94mEpoch: 0|  NKD Loss: 2.1976 | CT Loss: 5.1927| [0m
[91mEpoch: 0|  Loss:  7.7238 |Global loss: 9.9235| Local H loss: 0.0447  | Global H loss: 0.0468 [0m
[94mEpoch: 1|  NKD Loss: 2.1957 | CT Loss: 5.1899| [0m
[91mEpoch: 1|  Loss:  7.7099 |Global loss: 9.9197| Local H loss: 0.0453  | Global H loss: 0.0473 [0m
[94mEpoch: 2|  NKD Loss: 2.1909 | CT Loss: 5.188| [0m
[91mEpoch: 2|  Loss:  7.6934 |Global loss: 9.9127| Local H loss: 0.0466  | Global H loss: 0.0482 [0m
[94mEpoch: 3|  NKD Loss: 2.192 | CT Loss: 5.1843| [0m
[91mEpoch: 3|  Loss:  7.6938 |Global loss: 9.9074| Local H loss: 0.0474  | Global H loss: 0.0486 [0m
[94mEpoch: 0|  NKD Loss: 2.2965 | CT Loss: 5.3203| [0m
[91mEpoch: 0|  Loss:  9.6276 |Global loss: 10.103| Local H loss: 0.0007  | Global H loss: 0.0007 [0m
[94mEpoch: 1|  NKD Loss: 2.2954 | CT Loss: 5.3124| [0m
[91mEpoch: 1|  Loss:  9.4985 |Global loss: 10.0962| Local H loss: 0.0011  | Global H loss: 0.0012 [0m
[94mEpoch: 2|  NKD Loss: 2.2957 | CT Loss: 5.3073| [0m
[91mEpoch: 2|  Loss:  9.3687 |Global loss: 10.0894| Local H loss: 0.0016  | Global H loss: 0.0019 [0m
[94mEpoch: 3|  NKD Loss: 2.2965 | CT Loss: 5.303| [0m
[91mEpoch: 3|  Loss:  9.2387 |Global loss: 10.0872| Local H loss: 0.0024  | Global H loss: 0.0028 [0m
[94mEpoch: 0|  NKD Loss: 2.1704 | CT Loss: 5.2168| [0m
[91mEpoch: 0|  Loss:  7.6358 |Global loss: 9.9228| Local H loss: 0.048  | Global H loss: 0.0517 [0m
[94mEpoch: 1|  NKD Loss: 2.1716 | CT Loss: 5.2137| [0m
[91mEpoch: 1|  Loss:  7.6322 |Global loss: 9.9215| Local H loss: 0.0487  | Global H loss: 0.0522 [0m
[94mEpoch: 2|  NKD Loss: 2.1602 | CT Loss: 5.2127| [0m
[91mEpoch: 2|  Loss:  7.5943 |Global loss: 9.9149| Local H loss: 0.0518  | Global H loss: 0.0548 [0m
[94mEpoch: 3|  NKD Loss: 2.1588 | CT Loss: 5.209| [0m
[91mEpoch: 3|  Loss:  7.585 |Global loss: 9.9074| Local H loss: 0.0528  | Global H loss: 0.0554 [0m
[94mEpoch: 0|  NKD Loss: 2.1863 | CT Loss: 5.2499| [0m
[91mEpoch: 0|  Loss:  7.7244 |Global loss: 9.9705| Local H loss: 0.0432  | Global H loss: 0.0479 [0m
[94mEpoch: 1|  NKD Loss: 2.1837 | CT Loss: 5.2468| [0m
[91mEpoch: 1|  Loss:  7.7056 |Global loss: 9.9653| Local H loss: 0.0446  | Global H loss: 0.049 [0m
[94mEpoch: 2|  NKD Loss: 2.1818 | CT Loss: 5.2454| [0m
[91mEpoch: 2|  Loss:  7.6991 |Global loss: 9.9627| Local H loss: 0.0459  | Global H loss: 0.0499 [0m
[94mEpoch: 3|  NKD Loss: 2.1767 | CT Loss: 5.2421| [0m
[91mEpoch: 3|  Loss:  7.675 |Global loss: 9.9557| Local H loss: 0.0477  | Global H loss: 0.0514 [0m
[94mEpoch: 0|  NKD Loss: 2.2122 | CT Loss: 5.2093| [0m
[91mEpoch: 0|  Loss:  7.799 |Global loss: 9.9475| Local H loss: 0.0371  | Global H loss: 0.0414 [0m
[94mEpoch: 1|  NKD Loss: 2.2099 | CT Loss: 5.2071| [0m
[91mEpoch: 1|  Loss:  7.7765 |Global loss: 9.946| Local H loss: 0.0387  | Global H loss: 0.043 [0m
[94mEpoch: 2|  NKD Loss: 2.1995 | CT Loss: 5.2042| [0m
[91mEpoch: 2|  Loss:  7.7447 |Global loss: 9.9335| Local H loss: 0.04  | Global H loss: 0.044 [0m
[94mEpoch: 3|  NKD Loss: 2.1965 | CT Loss: 5.2024| [0m
[91mEpoch: 3|  Loss:  7.7268 |Global loss: 9.9283| Local H loss: 0.0413  | Global H loss: 0.0452 [0m
[94mEpoch: 0|  NKD Loss: 2.2079 | CT Loss: 5.2345| [0m
[91mEpoch: 0|  Loss:  7.8265 |Global loss: 9.9681| Local H loss: 0.0372  | Global H loss: 0.0406 [0m
[94mEpoch: 1|  NKD Loss: 2.2094 | CT Loss: 5.233| [0m
[91mEpoch: 1|  Loss:  7.8253 |Global loss: 9.9693| Local H loss: 0.0373  | Global H loss: 0.0408 [0m
[94mEpoch: 2|  NKD Loss: 2.1931 | CT Loss: 5.2299| [0m
[91mEpoch: 2|  Loss:  7.7589 |Global loss: 9.9537| Local H loss: 0.0396  | Global H loss: 0.0433 [0m
[94mEpoch: 3|  NKD Loss: 2.1962 | CT Loss: 5.2288| [0m
[91mEpoch: 3|  Loss:  7.7576 |Global loss: 9.9514| Local H loss: 0.0409  | Global H loss: 0.0444 [0m
------------------------- time cost ------------------------- 2.7816596031188965
Chosen Clients:  [14, 5, 9, 11, 13, 4]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.925, 0.983, 0.967, 0.983, 0.833, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.65, 0.975]
AUC in each clients:  [118.948, 119.762, 119.801, 118.955, 119.802, 119.178, 118.251, 119.079, 119.13, 119.698, 119.491, 119.751, 119.799, 115.28, 119.202]
F1 Score:  [0.974, 0.974, 0.936, 0.981, 0.961, 0.982, 0.825, 0.974, 0.974, 0.974, 0.857, 0.981, 0.973, 0.645, 0.974]
Recall Score:  [0.977, 0.977, 0.944, 0.984, 0.965, 0.984, 0.875, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.745, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.8116
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9923
Averaged Test F1_score: 0.9323
Averaged Test Recal score: 0.9480
Std Test Accurancy: 0.0882
Std Test AUC: 0.0092
Std Test F1: 0.0007
Std Test Recall: 0.0005
[94mEpoch: 0|  NKD Loss: 2.1614 | CT Loss: 5.2085| [0m
[91mEpoch: 0|  Loss:  7.5878 |Global loss: 9.9113| Local H loss: 0.0537  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.1575 | CT Loss: 5.2057| [0m
[91mEpoch: 1|  Loss:  7.5779 |Global loss: 9.9056| Local H loss: 0.0538  | Global H loss: 0.0561 [0m
[94mEpoch: 2|  NKD Loss: 2.1611 | CT Loss: 5.2023| [0m
[91mEpoch: 2|  Loss:  7.5806 |Global loss: 9.903| Local H loss: 0.0544  | Global H loss: 0.056 [0m
[94mEpoch: 3|  NKD Loss: 2.152 | CT Loss: 5.2012| [0m
[91mEpoch: 3|  Loss:  7.5556 |Global loss: 9.8964| Local H loss: 0.0574  | Global H loss: 0.0581 [0m
[94mEpoch: 0|  NKD Loss: 2.2036 | CT Loss: 5.2008| [0m
[91mEpoch: 0|  Loss:  7.7457 |Global loss: 9.933| Local H loss: 0.0409  | Global H loss: 0.0447 [0m
[94mEpoch: 1|  NKD Loss: 2.1974 | CT Loss: 5.1981| [0m
[91mEpoch: 1|  Loss:  7.7223 |Global loss: 9.9262| Local H loss: 0.0423  | Global H loss: 0.0459 [0m
[94mEpoch: 2|  NKD Loss: 2.186 | CT Loss: 5.1956| [0m
[91mEpoch: 2|  Loss:  7.6805 |Global loss: 9.9137| Local H loss: 0.0441  | Global H loss: 0.0477 [0m
[94mEpoch: 3|  NKD Loss: 2.1902 | CT Loss: 5.1952| [0m
[91mEpoch: 3|  Loss:  7.6885 |Global loss: 9.9197| Local H loss: 0.0445  | Global H loss: 0.048 [0m
[94mEpoch: 0|  NKD Loss: 2.1729 | CT Loss: 5.2404| [0m
[91mEpoch: 0|  Loss:  7.6594 |Global loss: 9.9525| Local H loss: 0.0492  | Global H loss: 0.0526 [0m
[94mEpoch: 1|  NKD Loss: 2.1667 | CT Loss: 5.2364| [0m
[91mEpoch: 1|  Loss:  7.6327 |Global loss: 9.9438| Local H loss: 0.0512  | Global H loss: 0.0541 [0m
[94mEpoch: 2|  NKD Loss: 2.1632 | CT Loss: 5.235| [0m
[91mEpoch: 2|  Loss:  7.6211 |Global loss: 9.9387| Local H loss: 0.0526  | Global H loss: 0.0552 [0m
[94mEpoch: 3|  NKD Loss: 2.1592 | CT Loss: 5.2318| [0m
[91mEpoch: 3|  Loss:  7.6086 |Global loss: 9.9329| Local H loss: 0.054  | Global H loss: 0.0561 [0m
[94mEpoch: 0|  NKD Loss: 2.1991 | CT Loss: 5.24| [0m
[91mEpoch: 0|  Loss:  7.7772 |Global loss: 9.9684| Local H loss: 0.0385  | Global H loss: 0.0434 [0m
[94mEpoch: 1|  NKD Loss: 2.1922 | CT Loss: 5.2373| [0m
[91mEpoch: 1|  Loss:  7.7493 |Global loss: 9.9584| Local H loss: 0.0401  | Global H loss: 0.0449 [0m
[94mEpoch: 2|  NKD Loss: 2.187 | CT Loss: 5.2355| [0m
[91mEpoch: 2|  Loss:  7.725 |Global loss: 9.9551| Local H loss: 0.0414  | Global H loss: 0.0462 [0m
[94mEpoch: 3|  NKD Loss: 2.1824 | CT Loss: 5.2332| [0m
[91mEpoch: 3|  Loss:  7.7013 |Global loss: 9.9496| Local H loss: 0.0434  | Global H loss: 0.048 [0m
[94mEpoch: 0|  NKD Loss: 2.3005 | CT Loss: 5.2973| [0m
[91mEpoch: 0|  Loss:  9.1171 |Global loss: 10.0856| Local H loss: 0.0033  | Global H loss: 0.004 [0m
[94mEpoch: 1|  NKD Loss: 2.3018 | CT Loss: 5.2916| [0m
[91mEpoch: 1|  Loss:  9.0042 |Global loss: 10.0843| Local H loss: 0.0043  | Global H loss: 0.0052 [0m
[94mEpoch: 2|  NKD Loss: 2.3045 | CT Loss: 5.2896| [0m
[91mEpoch: 2|  Loss:  8.8966 |Global loss: 10.0855| Local H loss: 0.0056  | Global H loss: 0.0068 [0m
[94mEpoch: 3|  NKD Loss: 2.3039 | CT Loss: 5.2841| [0m
[91mEpoch: 3|  Loss:  8.7914 |Global loss: 10.0803| Local H loss: 0.007  | Global H loss: 0.0086 [0m
[94mEpoch: 0|  NKD Loss: 2.2353 | CT Loss: 5.2454| [0m
[91mEpoch: 0|  Loss:  7.9818 |Global loss: 9.999| Local H loss: 0.0275  | Global H loss: 0.0328 [0m
[94mEpoch: 1|  NKD Loss: 2.2244 | CT Loss: 5.2436| [0m
[91mEpoch: 1|  Loss:  7.9333 |Global loss: 9.9887| Local H loss: 0.0302  | Global H loss: 0.0357 [0m
[94mEpoch: 2|  NKD Loss: 2.2259 | CT Loss: 5.2422| [0m
[91mEpoch: 2|  Loss:  7.9289 |Global loss: 9.9902| Local H loss: 0.0304  | Global H loss: 0.0358 [0m
[94mEpoch: 3|  NKD Loss: 2.2175 | CT Loss: 5.2379| [0m
[91mEpoch: 3|  Loss:  7.89 |Global loss: 9.9812| Local H loss: 0.0325  | Global H loss: 0.0379 [0m
------------------------- time cost ------------------------- 2.9085423946380615
Chosen Clients:  [8, 11, 2, 14, 6, 7]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.925, 0.983, 0.958, 0.983, 0.833, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.817, 0.975]
AUC in each clients:  [118.948, 119.762, 119.801, 118.955, 119.876, 119.189, 118.251, 119.079, 119.13, 119.621, 119.491, 119.798, 119.799, 118.17, 119.18]
F1 Score:  [0.974, 0.974, 0.936, 0.981, 0.952, 0.982, 0.825, 0.974, 0.974, 0.974, 0.857, 0.981, 0.973, 0.82, 0.974]
Recall Score:  [0.977, 0.977, 0.944, 0.984, 0.956, 0.984, 0.875, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.7633
Averaged Test Accurancy: 0.9444
Averaged Test AUC: 0.9939
Averaged Test F1_score: 0.9434
Averaged Test Recal score: 0.9555
Std Test Accurancy: 0.0564
Std Test AUC: 0.0044
Std Test F1: 0.0005
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.1894 | CT Loss: 5.2249| [0m
[91mEpoch: 0|  Loss:  7.6822 |Global loss: 9.9475| Local H loss: 0.045  | Global H loss: 0.0495 [0m
[94mEpoch: 1|  NKD Loss: 2.2038 | CT Loss: 5.2241| [0m
[91mEpoch: 1|  Loss:  7.71 |Global loss: 9.9631| Local H loss: 0.0446  | Global H loss: 0.0489 [0m
[94mEpoch: 2|  NKD Loss: 2.193 | CT Loss: 5.2202| [0m
[91mEpoch: 2|  Loss:  7.7046 |Global loss: 9.9501| Local H loss: 0.0444  | Global H loss: 0.0487 [0m
[94mEpoch: 3|  NKD Loss: 2.1818 | CT Loss: 5.219| [0m
[91mEpoch: 3|  Loss:  7.6584 |Global loss: 9.937| Local H loss: 0.0472  | Global H loss: 0.051 [0m
[94mEpoch: 0|  NKD Loss: 2.1805 | CT Loss: 5.231| [0m
[91mEpoch: 0|  Loss:  7.6921 |Global loss: 9.9456| Local H loss: 0.0446  | Global H loss: 0.0487 [0m
[94mEpoch: 1|  NKD Loss: 2.1728 | CT Loss: 5.2291| [0m
[91mEpoch: 1|  Loss:  7.6634 |Global loss: 9.9393| Local H loss: 0.0466  | Global H loss: 0.0505 [0m
[94mEpoch: 2|  NKD Loss: 2.1767 | CT Loss: 5.2277| [0m
[91mEpoch: 2|  Loss:  7.6738 |Global loss: 9.9395| Local H loss: 0.0461  | Global H loss: 0.05 [0m
[94mEpoch: 3|  NKD Loss: 2.1668 | CT Loss: 5.2253| [0m
[91mEpoch: 3|  Loss:  7.6382 |Global loss: 9.9294| Local H loss: 0.049  | Global H loss: 0.0524 [0m
[94mEpoch: 0|  NKD Loss: 2.1888 | CT Loss: 5.2259| [0m
[91mEpoch: 0|  Loss:  7.731 |Global loss: 9.9467| Local H loss: 0.0423  | Global H loss: 0.0456 [0m
[94mEpoch: 1|  NKD Loss: 2.1846 | CT Loss: 5.2241| [0m
[91mEpoch: 1|  Loss:  7.7109 |Global loss: 9.942| Local H loss: 0.0439  | Global H loss: 0.0472 [0m
[94mEpoch: 2|  NKD Loss: 2.1803 | CT Loss: 5.2233| [0m
[91mEpoch: 2|  Loss:  7.6912 |Global loss: 9.9368| Local H loss: 0.0449  | Global H loss: 0.048 [0m
[94mEpoch: 3|  NKD Loss: 2.1881 | CT Loss: 5.2229| [0m
[91mEpoch: 3|  Loss:  7.7154 |Global loss: 9.9435| Local H loss: 0.0452  | Global H loss: 0.0481 [0m
[94mEpoch: 0|  NKD Loss: 2.1471 | CT Loss: 5.1968| [0m
[91mEpoch: 0|  Loss:  7.5354 |Global loss: 9.8884| Local H loss: 0.0583  | Global H loss: 0.0593 [0m
[94mEpoch: 1|  NKD Loss: 2.147 | CT Loss: 5.1964| [0m
[91mEpoch: 1|  Loss:  7.5321 |Global loss: 9.8884| Local H loss: 0.0598  | Global H loss: 0.06 [0m
[94mEpoch: 2|  NKD Loss: 2.1483 | CT Loss: 5.1935| [0m
[91mEpoch: 2|  Loss:  7.5311 |Global loss: 9.8843| Local H loss: 0.0599  | Global H loss: 0.0599 [0m
[94mEpoch: 3|  NKD Loss: 2.1451 | CT Loss: 5.1898| [0m
[91mEpoch: 3|  Loss:  7.5189 |Global loss: 9.8787| Local H loss: 0.0611  | Global H loss: 0.0607 [0m
[94mEpoch: 0|  NKD Loss: 2.3022 | CT Loss: 5.2766| [0m
[91mEpoch: 0|  Loss:  8.6459 |Global loss: 10.0759| Local H loss: 0.0093  | Global H loss: 0.0111 [0m
[94mEpoch: 1|  NKD Loss: 2.3056 | CT Loss: 5.2746| [0m
[91mEpoch: 1|  Loss:  8.5797 |Global loss: 10.077| Local H loss: 0.0104  | Global H loss: 0.0125 [0m
[94mEpoch: 2|  NKD Loss: 2.3039 | CT Loss: 5.2704| [0m
[91mEpoch: 2|  Loss:  8.5098 |Global loss: 10.0728| Local H loss: 0.0119  | Global H loss: 0.0142 [0m
[94mEpoch: 3|  NKD Loss: 2.302 | CT Loss: 5.2682| [0m
[91mEpoch: 3|  Loss:  8.4417 |Global loss: 10.0697| Local H loss: 0.0134  | Global H loss: 0.0159 [0m
[94mEpoch: 0|  NKD Loss: 2.1621 | CT Loss: 5.2146| [0m
[91mEpoch: 0|  Loss:  7.6096 |Global loss: 9.9152| Local H loss: 0.0528  | Global H loss: 0.0545 [0m
[94mEpoch: 1|  NKD Loss: 2.1602 | CT Loss: 5.213| [0m
[91mEpoch: 1|  Loss:  7.5945 |Global loss: 9.916| Local H loss: 0.0561  | Global H loss: 0.0562 [0m
[94mEpoch: 2|  NKD Loss: 2.1777 | CT Loss: 5.2117| [0m
[91mEpoch: 2|  Loss:  7.639 |Global loss: 9.9264| Local H loss: 0.052  | Global H loss: 0.053 [0m
[94mEpoch: 3|  NKD Loss: 2.1815 | CT Loss: 5.2087| [0m
[91mEpoch: 3|  Loss:  7.6619 |Global loss: 9.9273| Local H loss: 0.05  | Global H loss: 0.0514 [0m
------------------------- time cost ------------------------- 2.7967631816864014
Chosen Clients:  [10, 12, 14, 9, 6, 2]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.85, 0.983, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.858, 0.983, 0.975, 0.817, 0.975]
AUC in each clients:  [118.948, 119.762, 119.562, 118.955, 119.876, 119.189, 118.967, 119.023, 119.08, 119.621, 119.491, 119.812, 119.799, 118.17, 119.09]
F1 Score:  [0.974, 0.974, 0.858, 0.981, 0.952, 0.982, 0.974, 0.973, 0.974, 0.974, 0.857, 0.981, 0.973, 0.82, 0.974]
Recall Score:  [0.977, 0.977, 0.894, 0.984, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.9, 0.984, 0.977, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.7366
Averaged Test Accurancy: 0.9489
Averaged Test AUC: 0.9941
Averaged Test F1_score: 0.9481
Averaged Test Recal score: 0.9589
Std Test Accurancy: 0.0545
Std Test AUC: 0.0038
Std Test F1: 0.0004
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.2484 | CT Loss: 5.2387| [0m
[91mEpoch: 0|  Loss:  8.0104 |Global loss: 10.0045| Local H loss: 0.0286  | Global H loss: 0.0329 [0m
[94mEpoch: 1|  NKD Loss: 2.2462 | CT Loss: 5.235| [0m
[91mEpoch: 1|  Loss:  7.9923 |Global loss: 10.0011| Local H loss: 0.0297  | Global H loss: 0.0339 [0m
[94mEpoch: 2|  NKD Loss: 2.2481 | CT Loss: 5.2344| [0m
[91mEpoch: 2|  Loss:  7.9991 |Global loss: 10.0009| Local H loss: 0.0297  | Global H loss: 0.0338 [0m
[94mEpoch: 3|  NKD Loss: 2.2329 | CT Loss: 5.2284| [0m
[91mEpoch: 3|  Loss:  7.934 |Global loss: 9.9825| Local H loss: 0.0322  | Global H loss: 0.0363 [0m
[94mEpoch: 0|  NKD Loss: 2.2394 | CT Loss: 5.2302| [0m
[91mEpoch: 0|  Loss:  7.9637 |Global loss: 9.9883| Local H loss: 0.028  | Global H loss: 0.0334 [0m
[94mEpoch: 1|  NKD Loss: 2.239 | CT Loss: 5.2283| [0m
[91mEpoch: 1|  Loss:  7.9415 |Global loss: 9.9882| Local H loss: 0.029  | Global H loss: 0.0343 [0m
[94mEpoch: 2|  NKD Loss: 2.2263 | CT Loss: 5.2232| [0m
[91mEpoch: 2|  Loss:  7.8942 |Global loss: 9.9723| Local H loss: 0.031  | Global H loss: 0.0365 [0m
[94mEpoch: 3|  NKD Loss: 2.23 | CT Loss: 5.2215| [0m
[91mEpoch: 3|  Loss:  7.8934 |Global loss: 9.9761| Local H loss: 0.0317  | Global H loss: 0.0373 [0m
[94mEpoch: 0|  NKD Loss: 2.1448 | CT Loss: 5.1899| [0m
[91mEpoch: 0|  Loss:  7.518 |Global loss: 9.8816| Local H loss: 0.0617  | Global H loss: 0.061 [0m
[94mEpoch: 1|  NKD Loss: 2.1404 | CT Loss: 5.1861| [0m
[91mEpoch: 1|  Loss:  7.5034 |Global loss: 9.876| Local H loss: 0.0635  | Global H loss: 0.0621 [0m
[94mEpoch: 2|  NKD Loss: 2.1411 | CT Loss: 5.1842| [0m
[91mEpoch: 2|  Loss:  7.5029 |Global loss: 9.8737| Local H loss: 0.0634  | Global H loss: 0.062 [0m
[94mEpoch: 3|  NKD Loss: 2.1369 | CT Loss: 5.1816| [0m
[91mEpoch: 3|  Loss:  7.4887 |Global loss: 9.8683| Local H loss: 0.0651  | Global H loss: 0.0632 [0m
[94mEpoch: 0|  NKD Loss: 2.1595 | CT Loss: 5.2302| [0m
[91mEpoch: 0|  Loss:  7.6019 |Global loss: 9.9307| Local H loss: 0.0547  | Global H loss: 0.0567 [0m
[94mEpoch: 1|  NKD Loss: 2.1536 | CT Loss: 5.2275| [0m
[91mEpoch: 1|  Loss:  7.5847 |Global loss: 9.9246| Local H loss: 0.0561  | Global H loss: 0.0578 [0m
[94mEpoch: 2|  NKD Loss: 2.1498 | CT Loss: 5.2253| [0m
[91mEpoch: 2|  Loss:  7.5712 |Global loss: 9.9196| Local H loss: 0.058  | Global H loss: 0.059 [0m
[94mEpoch: 3|  NKD Loss: 2.1521 | CT Loss: 5.2234| [0m
[91mEpoch: 3|  Loss:  7.5703 |Global loss: 9.9193| Local H loss: 0.0586  | Global H loss: 0.0593 [0m
[94mEpoch: 0|  NKD Loss: 2.2953 | CT Loss: 5.2628| [0m
[91mEpoch: 0|  Loss:  8.3672 |Global loss: 10.059| Local H loss: 0.015  | Global H loss: 0.0178 [0m
[94mEpoch: 1|  NKD Loss: 2.2925 | CT Loss: 5.2608| [0m
[91mEpoch: 1|  Loss:  8.3203 |Global loss: 10.0575| Local H loss: 0.0162  | Global H loss: 0.0193 [0m
[94mEpoch: 2|  NKD Loss: 2.2847 | CT Loss: 5.2576| [0m
[91mEpoch: 2|  Loss:  8.2629 |Global loss: 10.0492| Local H loss: 0.0176  | Global H loss: 0.021 [0m
[94mEpoch: 3|  NKD Loss: 2.2825 | CT Loss: 5.2547| [0m
[91mEpoch: 3|  Loss:  8.2182 |Global loss: 10.0461| Local H loss: 0.019  | Global H loss: 0.0226 [0m
[94mEpoch: 0|  NKD Loss: 2.1738 | CT Loss: 5.2184| [0m
[91mEpoch: 0|  Loss:  7.6703 |Global loss: 9.9285| Local H loss: 0.0467  | Global H loss: 0.0495 [0m
[94mEpoch: 1|  NKD Loss: 2.1771 | CT Loss: 5.2164| [0m
[91mEpoch: 1|  Loss:  7.6681 |Global loss: 9.9292| Local H loss: 0.0478  | Global H loss: 0.0502 [0m
[94mEpoch: 2|  NKD Loss: 2.1912 | CT Loss: 5.215| [0m
[91mEpoch: 2|  Loss:  7.7208 |Global loss: 9.9391| Local H loss: 0.047  | Global H loss: 0.0492 [0m
[94mEpoch: 3|  NKD Loss: 2.1869 | CT Loss: 5.2125| [0m
[91mEpoch: 3|  Loss:  7.7044 |Global loss: 9.9349| Local H loss: 0.0479  | Global H loss: 0.0499 [0m
------------------------- time cost ------------------------- 2.794271945953369
Chosen Clients:  [11, 4, 0, 7, 5, 2]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.983, 0.9, 0.817, 0.975]
AUC in each clients:  [118.948, 119.762, 119.93, 118.955, 119.876, 119.189, 118.903, 119.023, 119.08, 119.704, 119.78, 119.812, 119.695, 118.17, 119.076]
F1 Score:  [0.974, 0.974, 0.973, 0.981, 0.952, 0.982, 0.974, 0.973, 0.974, 0.974, 0.945, 0.981, 0.898, 0.82, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.984, 0.914, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6988
Averaged Test Accurancy: 0.9578
Averaged Test AUC: 0.9944
Averaged Test F1_score: 0.9566
Averaged Test Recal score: 0.9640
Std Test Accurancy: 0.0431
Std Test AUC: 0.0041
Std Test F1: 0.0003
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.1674 | CT Loss: 5.2224| [0m
[91mEpoch: 0|  Loss:  7.6351 |Global loss: 9.9286| Local H loss: 0.0496  | Global H loss: 0.0528 [0m
[94mEpoch: 1|  NKD Loss: 2.1633 | CT Loss: 5.2212| [0m
[91mEpoch: 1|  Loss:  7.6243 |Global loss: 9.9228| Local H loss: 0.0513  | Global H loss: 0.0537 [0m
[94mEpoch: 2|  NKD Loss: 2.1583 | CT Loss: 5.2165| [0m
[91mEpoch: 2|  Loss:  7.5977 |Global loss: 9.92| Local H loss: 0.0533  | Global H loss: 0.0555 [0m
[94mEpoch: 3|  NKD Loss: 2.1574 | CT Loss: 5.2164| [0m
[91mEpoch: 3|  Loss:  7.5939 |Global loss: 9.918| Local H loss: 0.0531  | Global H loss: 0.0555 [0m
[94mEpoch: 0|  NKD Loss: 2.2103 | CT Loss: 5.2356| [0m
[91mEpoch: 0|  Loss:  7.8547 |Global loss: 9.9714| Local H loss: 0.0356  | Global H loss: 0.0407 [0m
[94mEpoch: 1|  NKD Loss: 2.2076 | CT Loss: 5.2329| [0m
[91mEpoch: 1|  Loss:  7.8495 |Global loss: 9.9662| Local H loss: 0.0362  | Global H loss: 0.041 [0m
[94mEpoch: 2|  NKD Loss: 2.2008 | CT Loss: 5.2294| [0m
[91mEpoch: 2|  Loss:  7.82 |Global loss: 9.9562| Local H loss: 0.0379  | Global H loss: 0.0425 [0m
[94mEpoch: 3|  NKD Loss: 2.1956 | CT Loss: 5.227| [0m
[91mEpoch: 3|  Loss:  7.786 |Global loss: 9.953| Local H loss: 0.0405  | Global H loss: 0.0446 [0m
[94mEpoch: 0|  NKD Loss: 2.1819 | CT Loss: 5.1827| [0m
[91mEpoch: 0|  Loss:  7.6612 |Global loss: 9.9005| Local H loss: 0.049  | Global H loss: 0.0498 [0m
[94mEpoch: 1|  NKD Loss: 2.1854 | CT Loss: 5.1807| [0m
[91mEpoch: 1|  Loss:  7.6648 |Global loss: 9.9029| Local H loss: 0.0488  | Global H loss: 0.0497 [0m
[94mEpoch: 2|  NKD Loss: 2.1831 | CT Loss: 5.1807| [0m
[91mEpoch: 2|  Loss:  7.6545 |Global loss: 9.8999| Local H loss: 0.05  | Global H loss: 0.0507 [0m
[94mEpoch: 3|  NKD Loss: 2.1765 | CT Loss: 5.1765| [0m
[91mEpoch: 3|  Loss:  7.6298 |Global loss: 9.8903| Local H loss: 0.0514  | Global H loss: 0.0519 [0m
[94mEpoch: 0|  NKD Loss: 2.157 | CT Loss: 5.2067| [0m
[91mEpoch: 0|  Loss:  7.5898 |Global loss: 9.9034| Local H loss: 0.0546  | Global H loss: 0.0554 [0m
[94mEpoch: 1|  NKD Loss: 2.159 | CT Loss: 5.2032| [0m
[91mEpoch: 1|  Loss:  7.5923 |Global loss: 9.9033| Local H loss: 0.0553  | Global H loss: 0.0555 [0m
[94mEpoch: 2|  NKD Loss: 2.1524 | CT Loss: 5.2016| [0m
[91mEpoch: 2|  Loss:  7.566 |Global loss: 9.8963| Local H loss: 0.0579  | Global H loss: 0.0576 [0m
[94mEpoch: 3|  NKD Loss: 2.1558 | CT Loss: 5.2001| [0m
[91mEpoch: 3|  Loss:  7.5674 |Global loss: 9.9006| Local H loss: 0.0574  | Global H loss: 0.0574 [0m
[94mEpoch: 0|  NKD Loss: 2.1798 | CT Loss: 5.1927| [0m
[91mEpoch: 0|  Loss:  7.6586 |Global loss: 9.9093| Local H loss: 0.0463  | Global H loss: 0.0494 [0m
[94mEpoch: 1|  NKD Loss: 2.1788 | CT Loss: 5.1893| [0m
[91mEpoch: 1|  Loss:  7.6507 |Global loss: 9.9033| Local H loss: 0.0477  | Global H loss: 0.0503 [0m
[94mEpoch: 2|  NKD Loss: 2.1743 | CT Loss: 5.1901| [0m
[91mEpoch: 2|  Loss:  7.6297 |Global loss: 9.9006| Local H loss: 0.0492  | Global H loss: 0.0517 [0m
[94mEpoch: 3|  NKD Loss: 2.1745 | CT Loss: 5.1854| [0m
[91mEpoch: 3|  Loss:  7.6295 |Global loss: 9.8987| Local H loss: 0.049  | Global H loss: 0.0511 [0m
[94mEpoch: 0|  NKD Loss: 2.1625 | CT Loss: 5.2086| [0m
[91mEpoch: 0|  Loss:  7.623 |Global loss: 9.9078| Local H loss: 0.0504  | Global H loss: 0.0522 [0m
[94mEpoch: 1|  NKD Loss: 2.1617 | CT Loss: 5.2084| [0m
[91mEpoch: 1|  Loss:  7.6129 |Global loss: 9.9112| Local H loss: 0.0522  | Global H loss: 0.0535 [0m
[94mEpoch: 2|  NKD Loss: 2.1685 | CT Loss: 5.2056| [0m
[91mEpoch: 2|  Loss:  7.6263 |Global loss: 9.9137| Local H loss: 0.0522  | Global H loss: 0.0535 [0m
[94mEpoch: 3|  NKD Loss: 2.1576 | CT Loss: 5.2036| [0m
[91mEpoch: 3|  Loss:  7.5929 |Global loss: 9.9003| Local H loss: 0.0542  | Global H loss: 0.0549 [0m
------------------------- time cost ------------------------- 2.881021022796631
Chosen Clients:  [9, 2, 12, 0, 8, 1]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.983, 0.967, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.983, 0.9, 0.817, 0.975]
AUC in each clients:  [118.964, 119.762, 119.91, 118.955, 119.909, 119.107, 118.903, 118.999, 119.08, 119.704, 119.78, 119.692, 119.695, 118.17, 119.076]
F1 Score:  [0.974, 0.974, 0.974, 0.981, 0.962, 0.982, 0.974, 0.973, 0.974, 0.974, 0.945, 0.981, 0.898, 0.82, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.984, 0.965, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.984, 0.914, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6851
Averaged Test Accurancy: 0.9583
Averaged Test AUC: 0.9943
Averaged Test F1_score: 0.9573
Averaged Test Recal score: 0.9646
Std Test Accurancy: 0.0431
Std Test AUC: 0.0041
Std Test F1: 0.0004
Std Test Recall: 0.0003
[94mEpoch: 0|  NKD Loss: 2.1461 | CT Loss: 5.2207| [0m
[91mEpoch: 0|  Loss:  7.5566 |Global loss: 9.9141| Local H loss: 0.0598  | Global H loss: 0.0601 [0m
[94mEpoch: 1|  NKD Loss: 2.142 | CT Loss: 5.2195| [0m
[91mEpoch: 1|  Loss:  7.5403 |Global loss: 9.908| Local H loss: 0.062  | Global H loss: 0.0614 [0m
[94mEpoch: 2|  NKD Loss: 2.1453 | CT Loss: 5.2168| [0m
[91mEpoch: 2|  Loss:  7.5469 |Global loss: 9.9081| Local H loss: 0.0612  | Global H loss: 0.061 [0m
[94mEpoch: 3|  NKD Loss: 2.144 | CT Loss: 5.2143| [0m
[91mEpoch: 3|  Loss:  7.5436 |Global loss: 9.9063| Local H loss: 0.0615  | Global H loss: 0.061 [0m
[94mEpoch: 0|  NKD Loss: 2.1573 | CT Loss: 5.2019| [0m
[91mEpoch: 0|  Loss:  7.5839 |Global loss: 9.9005| Local H loss: 0.0554  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.1632 | CT Loss: 5.2003| [0m
[91mEpoch: 1|  Loss:  7.6026 |Global loss: 9.9038| Local H loss: 0.0544  | Global H loss: 0.0549 [0m
[94mEpoch: 2|  NKD Loss: 2.1587 | CT Loss: 5.1988| [0m
[91mEpoch: 2|  Loss:  7.5875 |Global loss: 9.9002| Local H loss: 0.0558  | Global H loss: 0.0559 [0m
[94mEpoch: 3|  NKD Loss: 2.1618 | CT Loss: 5.1961| [0m
[91mEpoch: 3|  Loss:  7.5889 |Global loss: 9.8989| Local H loss: 0.0559  | Global H loss: 0.056 [0m
[94mEpoch: 0|  NKD Loss: 2.2169 | CT Loss: 5.2173| [0m
[91mEpoch: 0|  Loss:  7.8514 |Global loss: 9.9588| Local H loss: 0.0337  | Global H loss: 0.0389 [0m
[94mEpoch: 1|  NKD Loss: 2.2103 | CT Loss: 5.2154| [0m
[91mEpoch: 1|  Loss:  7.8174 |Global loss: 9.953| Local H loss: 0.0355  | Global H loss: 0.0408 [0m
[94mEpoch: 2|  NKD Loss: 2.2174 | CT Loss: 5.2134| [0m
[91mEpoch: 2|  Loss:  7.8324 |Global loss: 9.9548| Local H loss: 0.0357  | Global H loss: 0.0405 [0m
[94mEpoch: 3|  NKD Loss: 2.213 | CT Loss: 5.2118| [0m
[91mEpoch: 3|  Loss:  7.8255 |Global loss: 9.9499| Local H loss: 0.0351  | Global H loss: 0.0403 [0m
[94mEpoch: 0|  NKD Loss: 2.175 | CT Loss: 5.1759| [0m
[91mEpoch: 0|  Loss:  7.6254 |Global loss: 9.8873| Local H loss: 0.052  | Global H loss: 0.052 [0m
[94mEpoch: 1|  NKD Loss: 2.1753 | CT Loss: 5.1723| [0m
[91mEpoch: 1|  Loss:  7.6225 |Global loss: 9.887| Local H loss: 0.0525  | Global H loss: 0.0525 [0m
[94mEpoch: 2|  NKD Loss: 2.1747 | CT Loss: 5.1711| [0m
[91mEpoch: 2|  Loss:  7.6153 |Global loss: 9.8861| Local H loss: 0.0522  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.177 | CT Loss: 5.1697| [0m
[91mEpoch: 3|  Loss:  7.6208 |Global loss: 9.8865| Local H loss: 0.0533  | Global H loss: 0.0528 [0m
[94mEpoch: 0|  NKD Loss: 2.17 | CT Loss: 5.2156| [0m
[91mEpoch: 0|  Loss:  7.6165 |Global loss: 9.9245| Local H loss: 0.0493  | Global H loss: 0.0533 [0m
[94mEpoch: 1|  NKD Loss: 2.1734 | CT Loss: 5.2163| [0m
[91mEpoch: 1|  Loss:  7.6208 |Global loss: 9.9286| Local H loss: 0.0501  | Global H loss: 0.0536 [0m
[94mEpoch: 2|  NKD Loss: 2.1669 | CT Loss: 5.2122| [0m
[91mEpoch: 2|  Loss:  7.6026 |Global loss: 9.9191| Local H loss: 0.0516  | Global H loss: 0.0548 [0m
[94mEpoch: 3|  NKD Loss: 2.1653 | CT Loss: 5.209| [0m
[91mEpoch: 3|  Loss:  7.5891 |Global loss: 9.9172| Local H loss: 0.0524  | Global H loss: 0.0555 [0m
[94mEpoch: 0|  NKD Loss: 2.2146 | CT Loss: 5.2394| [0m
[91mEpoch: 0|  Loss:  7.8962 |Global loss: 9.9801| Local H loss: 0.0317  | Global H loss: 0.0371 [0m
[94mEpoch: 1|  NKD Loss: 2.2097 | CT Loss: 5.2365| [0m
[91mEpoch: 1|  Loss:  7.8582 |Global loss: 9.9709| Local H loss: 0.0339  | Global H loss: 0.0392 [0m
[94mEpoch: 2|  NKD Loss: 2.2074 | CT Loss: 5.2339| [0m
[91mEpoch: 2|  Loss:  7.8447 |Global loss: 9.9671| Local H loss: 0.0354  | Global H loss: 0.0403 [0m
[94mEpoch: 3|  NKD Loss: 2.2018 | CT Loss: 5.2306| [0m
[91mEpoch: 3|  Loss:  7.82 |Global loss: 9.9591| Local H loss: 0.0371  | Global H loss: 0.0418 [0m
------------------------- time cost ------------------------- 3.000962018966675
Chosen Clients:  [4, 1, 10, 13, 8, 2]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.942, 0.975, 0.983, 0.967, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.983, 0.958, 0.817, 0.975]
AUC in each clients:  [118.962, 119.816, 119.971, 118.955, 119.909, 119.107, 118.903, 118.999, 119.078, 119.808, 119.78, 119.692, 119.886, 118.17, 119.076]
F1 Score:  [0.974, 0.931, 0.974, 0.981, 0.962, 0.982, 0.974, 0.973, 0.974, 0.974, 0.945, 0.981, 0.961, 0.82, 0.974]
Recall Score:  [0.977, 0.94, 0.977, 0.984, 0.965, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.984, 0.966, 0.866, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6570
Averaged Test Accurancy: 0.9600
Averaged Test AUC: 0.9945
Averaged Test F1_score: 0.9587
Averaged Test Recal score: 0.9656
Std Test Accurancy: 0.0404
Std Test AUC: 0.0043
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1952 | CT Loss: 5.2241| [0m
[91mEpoch: 0|  Loss:  7.7914 |Global loss: 9.951| Local H loss: 0.04  | Global H loss: 0.044 [0m
[94mEpoch: 1|  NKD Loss: 2.1903 | CT Loss: 5.2228| [0m
[91mEpoch: 1|  Loss:  7.7676 |Global loss: 9.9433| Local H loss: 0.042  | Global H loss: 0.0456 [0m
[94mEpoch: 2|  NKD Loss: 2.1876 | CT Loss: 5.2198| [0m
[91mEpoch: 2|  Loss:  7.7548 |Global loss: 9.9391| Local H loss: 0.044  | Global H loss: 0.0469 [0m
[94mEpoch: 3|  NKD Loss: 2.1838 | CT Loss: 5.2167| [0m
[91mEpoch: 3|  Loss:  7.739 |Global loss: 9.9327| Local H loss: 0.045  | Global H loss: 0.0477 [0m
[94mEpoch: 0|  NKD Loss: 2.1971 | CT Loss: 5.2279| [0m
[91mEpoch: 0|  Loss:  7.7928 |Global loss: 9.9547| Local H loss: 0.0389  | Global H loss: 0.0432 [0m
[94mEpoch: 1|  NKD Loss: 2.1955 | CT Loss: 5.2258| [0m
[91mEpoch: 1|  Loss:  7.7861 |Global loss: 9.9515| Local H loss: 0.0399  | Global H loss: 0.044 [0m
[94mEpoch: 2|  NKD Loss: 2.1906 | CT Loss: 5.2224| [0m
[91mEpoch: 2|  Loss:  7.7674 |Global loss: 9.944| Local H loss: 0.0414  | Global H loss: 0.0451 [0m
[94mEpoch: 3|  NKD Loss: 2.1877 | CT Loss: 5.2204| [0m
[91mEpoch: 3|  Loss:  7.7411 |Global loss: 9.9404| Local H loss: 0.0433  | Global H loss: 0.0466 [0m
[94mEpoch: 0|  NKD Loss: 2.2279 | CT Loss: 5.2254| [0m
[91mEpoch: 0|  Loss:  7.8908 |Global loss: 9.9776| Local H loss: 0.0348  | Global H loss: 0.0387 [0m
[94mEpoch: 1|  NKD Loss: 2.2226 | CT Loss: 5.2234| [0m
[91mEpoch: 1|  Loss:  7.8674 |Global loss: 9.9707| Local H loss: 0.0357  | Global H loss: 0.0395 [0m
[94mEpoch: 2|  NKD Loss: 2.226 | CT Loss: 5.2225| [0m
[91mEpoch: 2|  Loss:  7.8829 |Global loss: 9.9751| Local H loss: 0.0359  | Global H loss: 0.0394 [0m
[94mEpoch: 3|  NKD Loss: 2.2151 | CT Loss: 5.2187| [0m
[91mEpoch: 3|  Loss:  7.8365 |Global loss: 9.9599| Local H loss: 0.038  | Global H loss: 0.0414 [0m
[94mEpoch: 0|  NKD Loss: 2.303 | CT Loss: 5.2815| [0m
[91mEpoch: 0|  Loss:  8.7079 |Global loss: 10.0809| Local H loss: 0.0083  | Global H loss: 0.0102 [0m
[94mEpoch: 1|  NKD Loss: 2.3004 | CT Loss: 5.2772| [0m
[91mEpoch: 1|  Loss:  8.6288 |Global loss: 10.0767| Local H loss: 0.0097  | Global H loss: 0.012 [0m
[94mEpoch: 2|  NKD Loss: 2.3017 | CT Loss: 5.2742| [0m
[91mEpoch: 2|  Loss:  8.5881 |Global loss: 10.0757| Local H loss: 0.0106  | Global H loss: 0.0131 [0m
[94mEpoch: 3|  NKD Loss: 2.296 | CT Loss: 5.2716| [0m
[91mEpoch: 3|  Loss:  8.5087 |Global loss: 10.071| Local H loss: 0.012  | Global H loss: 0.0148 [0m
[94mEpoch: 0|  NKD Loss: 2.1654 | CT Loss: 5.2069| [0m
[91mEpoch: 0|  Loss:  7.5912 |Global loss: 9.9147| Local H loss: 0.0527  | Global H loss: 0.0556 [0m
[94mEpoch: 1|  NKD Loss: 2.1636 | CT Loss: 5.2043| [0m
[91mEpoch: 1|  Loss:  7.5855 |Global loss: 9.9117| Local H loss: 0.0536  | Global H loss: 0.056 [0m
[94mEpoch: 2|  NKD Loss: 2.1551 | CT Loss: 5.2022| [0m
[91mEpoch: 2|  Loss:  7.5594 |Global loss: 9.9014| Local H loss: 0.0554  | Global H loss: 0.0575 [0m
[94mEpoch: 3|  NKD Loss: 2.1531 | CT Loss: 5.1996| [0m
[91mEpoch: 3|  Loss:  7.5487 |Global loss: 9.8992| Local H loss: 0.0566  | Global H loss: 0.0584 [0m
[94mEpoch: 0|  NKD Loss: 2.1843 | CT Loss: 5.1962| [0m
[91mEpoch: 0|  Loss:  7.6713 |Global loss: 9.9209| Local H loss: 0.0537  | Global H loss: 0.0534 [0m
[94mEpoch: 1|  NKD Loss: 2.1567 | CT Loss: 5.1938| [0m
[91mEpoch: 1|  Loss:  7.5749 |Global loss: 9.8939| Local H loss: 0.0572  | Global H loss: 0.057 [0m
[94mEpoch: 2|  NKD Loss: 2.1661 | CT Loss: 5.1902| [0m
[91mEpoch: 2|  Loss:  7.6013 |Global loss: 9.9| Local H loss: 0.0565  | Global H loss: 0.0562 [0m
[94mEpoch: 3|  NKD Loss: 2.1595 | CT Loss: 5.1898| [0m
[91mEpoch: 3|  Loss:  7.5839 |Global loss: 9.8936| Local H loss: 0.0591  | Global H loss: 0.058 [0m
------------------------- time cost ------------------------- 2.8610033988952637
Chosen Clients:  [10, 4, 9, 13, 5, 0]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.967, 0.983, 0.983, 0.983, 0.975, 0.975, 0.975, 0.975, 0.942, 0.983, 0.958, 0.833, 0.975]
AUC in each clients:  [118.962, 119.722, 119.87, 118.955, 119.945, 119.107, 118.903, 118.999, 119.031, 119.808, 119.805, 119.692, 119.886, 118.917, 119.076]
F1 Score:  [0.974, 0.974, 0.968, 0.981, 0.982, 0.982, 0.974, 0.973, 0.974, 0.974, 0.945, 0.981, 0.961, 0.833, 0.974]
Recall Score:  [0.977, 0.977, 0.971, 0.984, 0.984, 0.984, 0.977, 0.977, 0.977, 0.977, 0.956, 0.984, 0.966, 0.88, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6333
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9948
Averaged Test F1_score: 0.9633
Averaged Test Recal score: 0.9699
Std Test Accurancy: 0.0365
Std Test AUC: 0.0035
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.212 | CT Loss: 5.2169| [0m
[91mEpoch: 0|  Loss:  7.8195 |Global loss: 9.9568| Local H loss: 0.0389  | Global H loss: 0.0421 [0m
[94mEpoch: 1|  NKD Loss: 2.2094 | CT Loss: 5.2149| [0m
[91mEpoch: 1|  Loss:  7.8078 |Global loss: 9.9523| Local H loss: 0.0399  | Global H loss: 0.043 [0m
[94mEpoch: 2|  NKD Loss: 2.2027 | CT Loss: 5.2112| [0m
[91mEpoch: 2|  Loss:  7.7685 |Global loss: 9.9451| Local H loss: 0.0418  | Global H loss: 0.0448 [0m
[94mEpoch: 3|  NKD Loss: 2.203 | CT Loss: 5.2091| [0m
[91mEpoch: 3|  Loss:  7.7751 |Global loss: 9.9456| Local H loss: 0.0425  | Global H loss: 0.0451 [0m
[94mEpoch: 0|  NKD Loss: 2.1817 | CT Loss: 5.2137| [0m
[91mEpoch: 0|  Loss:  7.7251 |Global loss: 9.931| Local H loss: 0.0459  | Global H loss: 0.0485 [0m
[94mEpoch: 1|  NKD Loss: 2.1798 | CT Loss: 5.2115| [0m
[91mEpoch: 1|  Loss:  7.7169 |Global loss: 9.9276| Local H loss: 0.0469  | Global H loss: 0.049 [0m
[94mEpoch: 2|  NKD Loss: 2.1774 | CT Loss: 5.2099| [0m
[91mEpoch: 2|  Loss:  7.6968 |Global loss: 9.9262| Local H loss: 0.0491  | Global H loss: 0.0506 [0m
[94mEpoch: 3|  NKD Loss: 2.1758 | CT Loss: 5.2083| [0m
[91mEpoch: 3|  Loss:  7.6978 |Global loss: 9.9211| Local H loss: 0.0492  | Global H loss: 0.0506 [0m
[94mEpoch: 0|  NKD Loss: 2.14 | CT Loss: 5.2119| [0m
[91mEpoch: 0|  Loss:  7.5266 |Global loss: 9.8993| Local H loss: 0.0629  | Global H loss: 0.062 [0m
[94mEpoch: 1|  NKD Loss: 2.1399 | CT Loss: 5.2098| [0m
[91mEpoch: 1|  Loss:  7.5234 |Global loss: 9.8989| Local H loss: 0.064  | Global H loss: 0.0626 [0m
[94mEpoch: 2|  NKD Loss: 2.1354 | CT Loss: 5.2068| [0m
[91mEpoch: 2|  Loss:  7.5108 |Global loss: 9.8925| Local H loss: 0.0658  | Global H loss: 0.0637 [0m
[94mEpoch: 3|  NKD Loss: 2.1328 | CT Loss: 5.2043| [0m
[91mEpoch: 3|  Loss:  7.5015 |Global loss: 9.8876| Local H loss: 0.0669  | Global H loss: 0.0643 [0m
[94mEpoch: 0|  NKD Loss: 2.2916 | CT Loss: 5.2675| [0m
[91mEpoch: 0|  Loss:  8.4395 |Global loss: 10.0618| Local H loss: 0.0138  | Global H loss: 0.0169 [0m
[94mEpoch: 1|  NKD Loss: 2.2874 | CT Loss: 5.2641| [0m
[91mEpoch: 1|  Loss:  8.3814 |Global loss: 10.0597| Local H loss: 0.0153  | Global H loss: 0.0187 [0m
[94mEpoch: 2|  NKD Loss: 2.2857 | CT Loss: 5.2632| [0m
[91mEpoch: 2|  Loss:  8.3556 |Global loss: 10.0548| Local H loss: 0.0159  | Global H loss: 0.0193 [0m
[94mEpoch: 3|  NKD Loss: 2.2789 | CT Loss: 5.2592| [0m
[91mEpoch: 3|  Loss:  8.2743 |Global loss: 10.0463| Local H loss: 0.0182  | Global H loss: 0.022 [0m
[94mEpoch: 0|  NKD Loss: 2.1726 | CT Loss: 5.185| [0m
[91mEpoch: 0|  Loss:  7.6172 |Global loss: 9.8963| Local H loss: 0.0503  | Global H loss: 0.0525 [0m
[94mEpoch: 1|  NKD Loss: 2.1662 | CT Loss: 5.181| [0m
[91mEpoch: 1|  Loss:  7.5979 |Global loss: 9.8852| Local H loss: 0.0517  | Global H loss: 0.0532 [0m
[94mEpoch: 2|  NKD Loss: 2.1746 | CT Loss: 5.1817| [0m
[91mEpoch: 2|  Loss:  7.6191 |Global loss: 9.8967| Local H loss: 0.0512  | Global H loss: 0.0527 [0m
[94mEpoch: 3|  NKD Loss: 2.1686 | CT Loss: 5.1773| [0m
[91mEpoch: 3|  Loss:  7.595 |Global loss: 9.8856| Local H loss: 0.0522  | Global H loss: 0.0537 [0m
[94mEpoch: 0|  NKD Loss: 2.172 | CT Loss: 5.1653| [0m
[91mEpoch: 0|  Loss:  7.6053 |Global loss: 9.877| Local H loss: 0.054  | Global H loss: 0.0534 [0m
[94mEpoch: 1|  NKD Loss: 2.1679 | CT Loss: 5.1653| [0m
[91mEpoch: 1|  Loss:  7.5883 |Global loss: 9.874| Local H loss: 0.0544  | Global H loss: 0.0539 [0m
[94mEpoch: 2|  NKD Loss: 2.174 | CT Loss: 5.1642| [0m
[91mEpoch: 2|  Loss:  7.6039 |Global loss: 9.8779| Local H loss: 0.0534  | Global H loss: 0.0532 [0m
[94mEpoch: 3|  NKD Loss: 2.1716 | CT Loss: 5.1621| [0m
[91mEpoch: 3|  Loss:  7.5953 |Global loss: 9.8752| Local H loss: 0.0547  | Global H loss: 0.054 [0m
------------------------- time cost ------------------------- 3.0646629333496094
Chosen Clients:  [7, 13, 11, 8, 4, 0]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.967, 0.983, 0.983, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.975, 119.722, 119.87, 118.955, 119.949, 119.179, 118.903, 118.999, 119.031, 119.752, 119.874, 119.692, 119.886, 119.191, 119.076]
F1 Score:  [0.974, 0.974, 0.968, 0.981, 0.982, 0.982, 0.974, 0.973, 0.974, 0.974, 0.974, 0.981, 0.961, 0.843, 0.974]
Recall Score:  [0.977, 0.977, 0.971, 0.984, 0.984, 0.984, 0.977, 0.977, 0.977, 0.977, 0.98, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.6018
Averaged Test Accurancy: 0.9672
Averaged Test AUC: 0.9950
Averaged Test F1_score: 0.9659
Averaged Test Recal score: 0.9724
Std Test Accurancy: 0.0320
Std Test AUC: 0.0033
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1469 | CT Loss: 5.1998| [0m
[91mEpoch: 0|  Loss:  7.5419 |Global loss: 9.8898| Local H loss: 0.0607  | Global H loss: 0.0596 [0m
[94mEpoch: 1|  NKD Loss: 2.1478 | CT Loss: 5.1965| [0m
[91mEpoch: 1|  Loss:  7.5462 |Global loss: 9.8913| Local H loss: 0.0597  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1468 | CT Loss: 5.1942| [0m
[91mEpoch: 2|  Loss:  7.5362 |Global loss: 9.8876| Local H loss: 0.0607  | Global H loss: 0.0598 [0m
[94mEpoch: 3|  NKD Loss: 2.146 | CT Loss: 5.1925| [0m
[91mEpoch: 3|  Loss:  7.532 |Global loss: 9.8856| Local H loss: 0.0617  | Global H loss: 0.0603 [0m
[94mEpoch: 0|  NKD Loss: 2.2732 | CT Loss: 5.2558| [0m
[91mEpoch: 0|  Loss:  8.24 |Global loss: 10.0406| Local H loss: 0.0193  | Global H loss: 0.0234 [0m
[94mEpoch: 1|  NKD Loss: 2.2692 | CT Loss: 5.2544| [0m
[91mEpoch: 1|  Loss:  8.2011 |Global loss: 10.0355| Local H loss: 0.0205  | Global H loss: 0.0247 [0m
[94mEpoch: 2|  NKD Loss: 2.2669 | CT Loss: 5.2518| [0m
[91mEpoch: 2|  Loss:  8.1679 |Global loss: 10.0319| Local H loss: 0.0218  | Global H loss: 0.026 [0m
[94mEpoch: 3|  NKD Loss: 2.2572 | CT Loss: 5.2489| [0m
[91mEpoch: 3|  Loss:  8.1247 |Global loss: 10.0192| Local H loss: 0.0235  | Global H loss: 0.028 [0m
[94mEpoch: 0|  NKD Loss: 2.1524 | CT Loss: 5.2132| [0m
[91mEpoch: 0|  Loss:  7.5755 |Global loss: 9.9089| Local H loss: 0.0553  | Global H loss: 0.057 [0m
[94mEpoch: 1|  NKD Loss: 2.1511 | CT Loss: 5.2117| [0m
[91mEpoch: 1|  Loss:  7.5698 |Global loss: 9.9076| Local H loss: 0.0556  | Global H loss: 0.0572 [0m
[94mEpoch: 2|  NKD Loss: 2.1484 | CT Loss: 5.2094| [0m
[91mEpoch: 2|  Loss:  7.5588 |Global loss: 9.9033| Local H loss: 0.0576  | Global H loss: 0.0585 [0m
[94mEpoch: 3|  NKD Loss: 2.1473 | CT Loss: 5.2068| [0m
[91mEpoch: 3|  Loss:  7.551 |Global loss: 9.8971| Local H loss: 0.059  | Global H loss: 0.0593 [0m
[94mEpoch: 0|  NKD Loss: 2.1529 | CT Loss: 5.1983| [0m
[91mEpoch: 0|  Loss:  7.5463 |Global loss: 9.8989| Local H loss: 0.057  | Global H loss: 0.0587 [0m
[94mEpoch: 1|  NKD Loss: 2.1962 | CT Loss: 5.1976| [0m
[91mEpoch: 1|  Loss:  7.6849 |Global loss: 9.9347| Local H loss: 0.0502  | Global H loss: 0.0524 [0m
[94mEpoch: 2|  NKD Loss: 2.1498 | CT Loss: 5.1937| [0m
[91mEpoch: 2|  Loss:  7.5416 |Global loss: 9.8898| Local H loss: 0.0558  | Global H loss: 0.0581 [0m
[94mEpoch: 3|  NKD Loss: 2.1465 | CT Loss: 5.1931| [0m
[91mEpoch: 3|  Loss:  7.5263 |Global loss: 9.8866| Local H loss: 0.0593  | Global H loss: 0.06 [0m
[94mEpoch: 0|  NKD Loss: 2.1718 | CT Loss: 5.2053| [0m
[91mEpoch: 0|  Loss:  7.6754 |Global loss: 9.9104| Local H loss: 0.0515  | Global H loss: 0.0521 [0m
[94mEpoch: 1|  NKD Loss: 2.1705 | CT Loss: 5.203| [0m
[91mEpoch: 1|  Loss:  7.6689 |Global loss: 9.9111| Local H loss: 0.0515  | Global H loss: 0.0521 [0m
[94mEpoch: 2|  NKD Loss: 2.1736 | CT Loss: 5.2005| [0m
[91mEpoch: 2|  Loss:  7.6712 |Global loss: 9.9134| Local H loss: 0.0507  | Global H loss: 0.0515 [0m
[94mEpoch: 3|  NKD Loss: 2.1746 | CT Loss: 5.1986| [0m
[91mEpoch: 3|  Loss:  7.6703 |Global loss: 9.9123| Local H loss: 0.0518  | Global H loss: 0.0521 [0m
[94mEpoch: 0|  NKD Loss: 2.1617 | CT Loss: 5.1608| [0m
[91mEpoch: 0|  Loss:  7.5577 |Global loss: 9.8649| Local H loss: 0.0574  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.1648 | CT Loss: 5.1583| [0m
[91mEpoch: 1|  Loss:  7.569 |Global loss: 9.8638| Local H loss: 0.056  | Global H loss: 0.0552 [0m
[94mEpoch: 2|  NKD Loss: 2.1627 | CT Loss: 5.1554| [0m
[91mEpoch: 2|  Loss:  7.5607 |Global loss: 9.8603| Local H loss: 0.0579  | Global H loss: 0.0561 [0m
[94mEpoch: 3|  NKD Loss: 2.1592 | CT Loss: 5.1535| [0m
[91mEpoch: 3|  Loss:  7.5449 |Global loss: 9.8542| Local H loss: 0.0584  | Global H loss: 0.0566 [0m
------------------------- time cost ------------------------- 2.7484564781188965
Chosen Clients:  [6, 11, 14, 1, 13, 10]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.967, 0.983, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.98, 119.722, 119.87, 118.955, 119.911, 119.179, 118.903, 118.995, 119.007, 119.752, 119.874, 119.823, 119.886, 119.282, 119.076]
F1 Score:  [0.974, 0.974, 0.968, 0.981, 0.953, 0.982, 0.974, 0.973, 0.974, 0.974, 0.974, 0.981, 0.961, 0.843, 0.974]
Recall Score:  [0.977, 0.977, 0.971, 0.984, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.98, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5812
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9951
Averaged Test F1_score: 0.9640
Averaged Test Recal score: 0.9705
Std Test Accurancy: 0.0317
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.2705 | CT Loss: 5.2508| [0m
[91mEpoch: 0|  Loss:  8.1541 |Global loss: 10.0325| Local H loss: 0.0208  | Global H loss: 0.0248 [0m
[94mEpoch: 1|  NKD Loss: 2.2714 | CT Loss: 5.249| [0m
[91mEpoch: 1|  Loss:  8.1353 |Global loss: 10.0335| Local H loss: 0.0214  | Global H loss: 0.0256 [0m
[94mEpoch: 2|  NKD Loss: 2.262 | CT Loss: 5.2462| [0m
[91mEpoch: 2|  Loss:  8.0745 |Global loss: 10.0214| Local H loss: 0.0239  | Global H loss: 0.0279 [0m
[94mEpoch: 3|  NKD Loss: 2.2514 | CT Loss: 5.243| [0m
[91mEpoch: 3|  Loss:  8.0266 |Global loss: 10.011| Local H loss: 0.0254  | Global H loss: 0.0298 [0m
[94mEpoch: 0|  NKD Loss: 2.1417 | CT Loss: 5.2039| [0m
[91mEpoch: 0|  Loss:  7.5315 |Global loss: 9.89| Local H loss: 0.0609  | Global H loss: 0.0605 [0m
[94mEpoch: 1|  NKD Loss: 2.1395 | CT Loss: 5.2014| [0m
[91mEpoch: 1|  Loss:  7.5225 |Global loss: 9.8885| Local H loss: 0.0618  | Global H loss: 0.0612 [0m
[94mEpoch: 2|  NKD Loss: 2.1448 | CT Loss: 5.1996| [0m
[91mEpoch: 2|  Loss:  7.5354 |Global loss: 9.8906| Local H loss: 0.0607  | Global H loss: 0.0601 [0m
[94mEpoch: 3|  NKD Loss: 2.1371 | CT Loss: 5.1983| [0m
[91mEpoch: 3|  Loss:  7.5092 |Global loss: 9.8882| Local H loss: 0.0641  | Global H loss: 0.0626 [0m
[94mEpoch: 0|  NKD Loss: 2.1411 | CT Loss: 5.1804| [0m
[91mEpoch: 0|  Loss:  7.4972 |Global loss: 9.8732| Local H loss: 0.0637  | Global H loss: 0.0621 [0m
[94mEpoch: 1|  NKD Loss: 2.1381 | CT Loss: 5.178| [0m
[91mEpoch: 1|  Loss:  7.4873 |Global loss: 9.866| Local H loss: 0.0651  | Global H loss: 0.063 [0m
[94mEpoch: 2|  NKD Loss: 2.1323 | CT Loss: 5.1748| [0m
[91mEpoch: 2|  Loss:  7.4709 |Global loss: 9.8586| Local H loss: 0.0673  | Global H loss: 0.0644 [0m
[94mEpoch: 3|  NKD Loss: 2.1397 | CT Loss: 5.1739| [0m
[91mEpoch: 3|  Loss:  7.4863 |Global loss: 9.8646| Local H loss: 0.0663  | Global H loss: 0.0633 [0m
[94mEpoch: 0|  NKD Loss: 2.1897 | CT Loss: 5.2174| [0m
[91mEpoch: 0|  Loss:  7.7495 |Global loss: 9.9408| Local H loss: 0.0432  | Global H loss: 0.0465 [0m
[94mEpoch: 1|  NKD Loss: 2.1808 | CT Loss: 5.2147| [0m
[91mEpoch: 1|  Loss:  7.7146 |Global loss: 9.9326| Local H loss: 0.0448  | Global H loss: 0.0477 [0m
[94mEpoch: 2|  NKD Loss: 2.184 | CT Loss: 5.2129| [0m
[91mEpoch: 2|  Loss:  7.7171 |Global loss: 9.9327| Local H loss: 0.0456  | Global H loss: 0.0483 [0m
[94mEpoch: 3|  NKD Loss: 2.1741 | CT Loss: 5.2102| [0m
[91mEpoch: 3|  Loss:  7.6823 |Global loss: 9.9206| Local H loss: 0.0474  | Global H loss: 0.0496 [0m
[94mEpoch: 0|  NKD Loss: 2.2541 | CT Loss: 5.2466| [0m
[91mEpoch: 0|  Loss:  8.0913 |Global loss: 10.0169| Local H loss: 0.0247  | Global H loss: 0.0293 [0m
[94mEpoch: 1|  NKD Loss: 2.2482 | CT Loss: 5.2449| [0m
[91mEpoch: 1|  Loss:  8.0693 |Global loss: 10.0125| Local H loss: 0.0259  | Global H loss: 0.0306 [0m
[94mEpoch: 2|  NKD Loss: 2.2453 | CT Loss: 5.2424| [0m
[91mEpoch: 2|  Loss:  8.0431 |Global loss: 10.0044| Local H loss: 0.0271  | Global H loss: 0.0317 [0m
[94mEpoch: 3|  NKD Loss: 2.2349 | CT Loss: 5.2388| [0m
[91mEpoch: 3|  Loss:  7.9953 |Global loss: 9.9956| Local H loss: 0.0289  | Global H loss: 0.0338 [0m
[94mEpoch: 0|  NKD Loss: 2.199 | CT Loss: 5.2059| [0m
[91mEpoch: 0|  Loss:  7.7499 |Global loss: 9.9396| Local H loss: 0.043  | Global H loss: 0.0458 [0m
[94mEpoch: 1|  NKD Loss: 2.196 | CT Loss: 5.2032| [0m
[91mEpoch: 1|  Loss:  7.7435 |Global loss: 9.9339| Local H loss: 0.0441  | Global H loss: 0.0463 [0m
[94mEpoch: 2|  NKD Loss: 2.1943 | CT Loss: 5.2013| [0m
[91mEpoch: 2|  Loss:  7.7269 |Global loss: 9.9315| Local H loss: 0.0452  | Global H loss: 0.0473 [0m
[94mEpoch: 3|  NKD Loss: 2.1931 | CT Loss: 5.1986| [0m
[91mEpoch: 3|  Loss:  7.7175 |Global loss: 9.9253| Local H loss: 0.0453  | Global H loss: 0.0477 [0m
------------------------- time cost ------------------------- 3.0262765884399414
Chosen Clients:  [2, 9, 8, 6, 7, 1]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.967, 0.983, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.98, 119.852, 119.87, 118.955, 119.911, 119.179, 119.137, 118.995, 119.007, 119.752, 119.936, 119.844, 119.886, 119.373, 119.083]
F1 Score:  [0.974, 0.974, 0.968, 0.981, 0.953, 0.982, 0.974, 0.973, 0.974, 0.974, 0.981, 0.981, 0.961, 0.838, 0.974]
Recall Score:  [0.977, 0.977, 0.971, 0.984, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5493
Averaged Test Accurancy: 0.9661
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9641
Averaged Test Recal score: 0.9708
Std Test Accurancy: 0.0320
Std Test AUC: 0.0033
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1511 | CT Loss: 5.1868| [0m
[91mEpoch: 0|  Loss:  7.5493 |Global loss: 9.8796| Local H loss: 0.06  | Global H loss: 0.0586 [0m
[94mEpoch: 1|  NKD Loss: 2.142 | CT Loss: 5.1842| [0m
[91mEpoch: 1|  Loss:  7.5193 |Global loss: 9.8744| Local H loss: 0.0627  | Global H loss: 0.0606 [0m
[94mEpoch: 2|  NKD Loss: 2.1478 | CT Loss: 5.1832| [0m
[91mEpoch: 2|  Loss:  7.5343 |Global loss: 9.8768| Local H loss: 0.0619  | Global H loss: 0.06 [0m
[94mEpoch: 3|  NKD Loss: 2.1729 | CT Loss: 5.1811| [0m
[91mEpoch: 3|  Loss:  7.6163 |Global loss: 9.8976| Local H loss: 0.059  | Global H loss: 0.057 [0m
[94mEpoch: 0|  NKD Loss: 2.1395 | CT Loss: 5.2049| [0m
[91mEpoch: 0|  Loss:  7.5166 |Global loss: 9.8939| Local H loss: 0.0657  | Global H loss: 0.0634 [0m
[94mEpoch: 1|  NKD Loss: 2.1337 | CT Loss: 5.2009| [0m
[91mEpoch: 1|  Loss:  7.4997 |Global loss: 9.8861| Local H loss: 0.0672  | Global H loss: 0.0643 [0m
[94mEpoch: 2|  NKD Loss: 2.134 | CT Loss: 5.1994| [0m
[91mEpoch: 2|  Loss:  7.4976 |Global loss: 9.8847| Local H loss: 0.0679  | Global H loss: 0.0647 [0m
[94mEpoch: 3|  NKD Loss: 2.1317 | CT Loss: 5.1972| [0m
[91mEpoch: 3|  Loss:  7.4911 |Global loss: 9.8827| Local H loss: 0.0682  | Global H loss: 0.0649 [0m
[94mEpoch: 0|  NKD Loss: 2.1423 | CT Loss: 5.1896| [0m
[91mEpoch: 0|  Loss:  7.5117 |Global loss: 9.8801| Local H loss: 0.061  | Global H loss: 0.0612 [0m
[94mEpoch: 1|  NKD Loss: 2.1435 | CT Loss: 5.1867| [0m
[91mEpoch: 1|  Loss:  7.5149 |Global loss: 9.8785| Local H loss: 0.0606  | Global H loss: 0.0608 [0m
[94mEpoch: 2|  NKD Loss: 2.1538 | CT Loss: 5.1865| [0m
[91mEpoch: 2|  Loss:  7.5375 |Global loss: 9.8895| Local H loss: 0.0602  | Global H loss: 0.0599 [0m
[94mEpoch: 3|  NKD Loss: 2.1373 | CT Loss: 5.1838| [0m
[91mEpoch: 3|  Loss:  7.4982 |Global loss: 9.8696| Local H loss: 0.0624  | Global H loss: 0.0618 [0m
[94mEpoch: 0|  NKD Loss: 2.2462 | CT Loss: 5.2394| [0m
[91mEpoch: 0|  Loss:  7.9869 |Global loss: 10.0053| Local H loss: 0.0265  | Global H loss: 0.0311 [0m
[94mEpoch: 1|  NKD Loss: 2.2411 | CT Loss: 5.2376| [0m
[91mEpoch: 1|  Loss:  7.9609 |Global loss: 9.9976| Local H loss: 0.0279  | Global H loss: 0.0324 [0m
[94mEpoch: 2|  NKD Loss: 2.2371 | CT Loss: 5.235| [0m
[91mEpoch: 2|  Loss:  7.93 |Global loss: 9.9918| Local H loss: 0.0292  | Global H loss: 0.0339 [0m
[94mEpoch: 3|  NKD Loss: 2.2346 | CT Loss: 5.2322| [0m
[91mEpoch: 3|  Loss:  7.913 |Global loss: 9.988| Local H loss: 0.0302  | Global H loss: 0.0348 [0m
[94mEpoch: 0|  NKD Loss: 2.1696 | CT Loss: 5.1914| [0m
[91mEpoch: 0|  Loss:  7.602 |Global loss: 9.9053| Local H loss: 0.0574  | Global H loss: 0.0564 [0m
[94mEpoch: 1|  NKD Loss: 2.1499 | CT Loss: 5.19| [0m
[91mEpoch: 1|  Loss:  7.544 |Global loss: 9.8873| Local H loss: 0.0589  | Global H loss: 0.0585 [0m
[94mEpoch: 2|  NKD Loss: 2.1402 | CT Loss: 5.1874| [0m
[91mEpoch: 2|  Loss:  7.5127 |Global loss: 9.8772| Local H loss: 0.063  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1516 | CT Loss: 5.1862| [0m
[91mEpoch: 3|  Loss:  7.5414 |Global loss: 9.8833| Local H loss: 0.0613  | Global H loss: 0.0595 [0m
[94mEpoch: 0|  NKD Loss: 2.1898 | CT Loss: 5.2088| [0m
[91mEpoch: 0|  Loss:  7.7192 |Global loss: 9.9319| Local H loss: 0.0458  | Global H loss: 0.0482 [0m
[94mEpoch: 1|  NKD Loss: 2.1769 | CT Loss: 5.2049| [0m
[91mEpoch: 1|  Loss:  7.6782 |Global loss: 9.9172| Local H loss: 0.0489  | Global H loss: 0.0508 [0m
[94mEpoch: 2|  NKD Loss: 2.1695 | CT Loss: 5.2017| [0m
[91mEpoch: 2|  Loss:  7.6493 |Global loss: 9.9099| Local H loss: 0.0505  | Global H loss: 0.0519 [0m
[94mEpoch: 3|  NKD Loss: 2.1642 | CT Loss: 5.1992| [0m
[91mEpoch: 3|  Loss:  7.6256 |Global loss: 9.9031| Local H loss: 0.0518  | Global H loss: 0.0528 [0m
------------------------- time cost ------------------------- 2.9640207290649414
Chosen Clients:  [6, 3, 13, 4, 14, 1]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.983, 0.983, 0.958, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.98, 119.801, 119.677, 118.955, 119.911, 119.179, 119.276, 118.994, 119.01, 119.785, 119.936, 119.844, 119.886, 119.373, 119.083]
F1 Score:  [0.974, 0.974, 0.981, 0.981, 0.953, 0.982, 0.974, 0.973, 0.974, 0.974, 0.981, 0.981, 0.961, 0.838, 0.974]
Recall Score:  [0.977, 0.977, 0.984, 0.984, 0.956, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5334
Averaged Test Accurancy: 0.9672
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9650
Averaged Test Recal score: 0.9717
Std Test Accurancy: 0.0323
Std Test AUC: 0.0032
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.2287 | CT Loss: 5.2303| [0m
[91mEpoch: 0|  Loss:  7.8865 |Global loss: 9.9805| Local H loss: 0.031  | Global H loss: 0.0359 [0m
[94mEpoch: 1|  NKD Loss: 2.2188 | CT Loss: 5.2259| [0m
[91mEpoch: 1|  Loss:  7.8327 |Global loss: 9.9686| Local H loss: 0.0339  | Global H loss: 0.0386 [0m
[94mEpoch: 2|  NKD Loss: 2.2112 | CT Loss: 5.2231| [0m
[91mEpoch: 2|  Loss:  7.8075 |Global loss: 9.9623| Local H loss: 0.0352  | Global H loss: 0.0399 [0m
[94mEpoch: 3|  NKD Loss: 2.2131 | CT Loss: 5.2224| [0m
[91mEpoch: 3|  Loss:  7.7992 |Global loss: 9.9654| Local H loss: 0.0358  | Global H loss: 0.0405 [0m
[94mEpoch: 0|  NKD Loss: 2.2087 | CT Loss: 5.2463| [0m
[91mEpoch: 0|  Loss:  7.832 |Global loss: 9.9815| Local H loss: 0.0348  | Global H loss: 0.0399 [0m
[94mEpoch: 1|  NKD Loss: 2.2101 | CT Loss: 5.2434| [0m
[91mEpoch: 1|  Loss:  7.8173 |Global loss: 9.9821| Local H loss: 0.0353  | Global H loss: 0.0407 [0m
[94mEpoch: 2|  NKD Loss: 2.1967 | CT Loss: 5.24| [0m
[91mEpoch: 2|  Loss:  7.7706 |Global loss: 9.9667| Local H loss: 0.0386  | Global H loss: 0.0436 [0m
[94mEpoch: 3|  NKD Loss: 2.2035 | CT Loss: 5.2374| [0m
[91mEpoch: 3|  Loss:  7.7775 |Global loss: 9.97| Local H loss: 0.0386  | Global H loss: 0.0433 [0m
[94mEpoch: 0|  NKD Loss: 2.2315 | CT Loss: 5.2371| [0m
[91mEpoch: 0|  Loss:  7.9778 |Global loss: 9.9932| Local H loss: 0.0305  | Global H loss: 0.0351 [0m
[94mEpoch: 1|  NKD Loss: 2.2275 | CT Loss: 5.2352| [0m
[91mEpoch: 1|  Loss:  7.9475 |Global loss: 9.9858| Local H loss: 0.0317  | Global H loss: 0.0365 [0m
[94mEpoch: 2|  NKD Loss: 2.2218 | CT Loss: 5.2334| [0m
[91mEpoch: 2|  Loss:  7.9273 |Global loss: 9.98| Local H loss: 0.0326  | Global H loss: 0.0372 [0m
[94mEpoch: 3|  NKD Loss: 2.2188 | CT Loss: 5.2298| [0m
[91mEpoch: 3|  Loss:  7.9107 |Global loss: 9.9735| Local H loss: 0.0338  | Global H loss: 0.0383 [0m
[94mEpoch: 0|  NKD Loss: 2.1729 | CT Loss: 5.1967| [0m
[91mEpoch: 0|  Loss:  7.661 |Global loss: 9.9101| Local H loss: 0.0515  | Global H loss: 0.0521 [0m
[94mEpoch: 1|  NKD Loss: 2.1697 | CT Loss: 5.1932| [0m
[91mEpoch: 1|  Loss:  7.6574 |Global loss: 9.9032| Local H loss: 0.0534  | Global H loss: 0.0531 [0m
[94mEpoch: 2|  NKD Loss: 2.1667 | CT Loss: 5.1924| [0m
[91mEpoch: 2|  Loss:  7.6367 |Global loss: 9.8998| Local H loss: 0.0537  | Global H loss: 0.0537 [0m
[94mEpoch: 3|  NKD Loss: 2.16 | CT Loss: 5.1882| [0m
[91mEpoch: 3|  Loss:  7.6163 |Global loss: 9.8872| Local H loss: 0.0564  | Global H loss: 0.0552 [0m
[94mEpoch: 0|  NKD Loss: 2.1314 | CT Loss: 5.1697| [0m
[91mEpoch: 0|  Loss:  7.4636 |Global loss: 9.8537| Local H loss: 0.0674  | Global H loss: 0.0644 [0m
[94mEpoch: 1|  NKD Loss: 2.137 | CT Loss: 5.1694| [0m
[91mEpoch: 1|  Loss:  7.4758 |Global loss: 9.8558| Local H loss: 0.0665  | Global H loss: 0.0636 [0m
[94mEpoch: 2|  NKD Loss: 2.1286 | CT Loss: 5.1659| [0m
[91mEpoch: 2|  Loss:  7.4509 |Global loss: 9.8508| Local H loss: 0.07  | Global H loss: 0.0658 [0m
[94mEpoch: 3|  NKD Loss: 2.1307 | CT Loss: 5.1654| [0m
[91mEpoch: 3|  Loss:  7.4559 |Global loss: 9.8482| Local H loss: 0.0698  | Global H loss: 0.0653 [0m
[94mEpoch: 0|  NKD Loss: 2.1747 | CT Loss: 5.1987| [0m
[91mEpoch: 0|  Loss:  7.6608 |Global loss: 9.91| Local H loss: 0.0506  | Global H loss: 0.0518 [0m
[94mEpoch: 1|  NKD Loss: 2.1682 | CT Loss: 5.1942| [0m
[91mEpoch: 1|  Loss:  7.6409 |Global loss: 9.904| Local H loss: 0.053  | Global H loss: 0.0534 [0m
[94mEpoch: 2|  NKD Loss: 2.1663 | CT Loss: 5.1937| [0m
[91mEpoch: 2|  Loss:  7.6237 |Global loss: 9.9007| Local H loss: 0.0528  | Global H loss: 0.0534 [0m
[94mEpoch: 3|  NKD Loss: 2.1708 | CT Loss: 5.1908| [0m
[91mEpoch: 3|  Loss:  7.6341 |Global loss: 9.903| Local H loss: 0.0525  | Global H loss: 0.0532 [0m
------------------------- time cost ------------------------- 2.8594822883605957
Chosen Clients:  [14, 3, 11, 10, 5, 13]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.917, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.98, 119.862, 119.677, 119.124, 119.957, 119.179, 119.351, 118.994, 119.01, 119.785, 119.936, 119.844, 119.886, 119.345, 119.034]
F1 Score:  [0.974, 0.878, 0.981, 0.974, 0.974, 0.982, 0.974, 0.973, 0.974, 0.974, 0.981, 0.981, 0.961, 0.839, 0.974]
Recall Score:  [0.977, 0.91, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.5127
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9955
Averaged Test F1_score: 0.9596
Averaged Test Recal score: 0.9681
Std Test Accurancy: 0.0344
Std Test AUC: 0.0032
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1327 | CT Loss: 5.163| [0m
[91mEpoch: 0|  Loss:  7.4571 |Global loss: 9.8488| Local H loss: 0.0685  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1287 | CT Loss: 5.1615| [0m
[91mEpoch: 1|  Loss:  7.446 |Global loss: 9.8429| Local H loss: 0.0706  | Global H loss: 0.066 [0m
[94mEpoch: 2|  NKD Loss: 2.1313 | CT Loss: 5.1583| [0m
[91mEpoch: 2|  Loss:  7.4512 |Global loss: 9.8408| Local H loss: 0.0699  | Global H loss: 0.0652 [0m
[94mEpoch: 3|  NKD Loss: 2.128 | CT Loss: 5.1574| [0m
[91mEpoch: 3|  Loss:  7.4406 |Global loss: 9.8429| Local H loss: 0.0708  | Global H loss: 0.0661 [0m
[94mEpoch: 0|  NKD Loss: 2.1923 | CT Loss: 5.2355| [0m
[91mEpoch: 0|  Loss:  7.7385 |Global loss: 9.9622| Local H loss: 0.0409  | Global H loss: 0.0456 [0m
[94mEpoch: 1|  NKD Loss: 2.1966 | CT Loss: 5.2349| [0m
[91mEpoch: 1|  Loss:  7.7481 |Global loss: 9.9646| Local H loss: 0.0411  | Global H loss: 0.0454 [0m
[94mEpoch: 2|  NKD Loss: 2.1965 | CT Loss: 5.2321| [0m
[91mEpoch: 2|  Loss:  7.7347 |Global loss: 9.9608| Local H loss: 0.0413  | Global H loss: 0.0457 [0m
[94mEpoch: 3|  NKD Loss: 2.1847 | CT Loss: 5.2291| [0m
[91mEpoch: 3|  Loss:  7.6998 |Global loss: 9.9505| Local H loss: 0.0433  | Global H loss: 0.0477 [0m
[94mEpoch: 0|  NKD Loss: 2.1363 | CT Loss: 5.1958| [0m
[91mEpoch: 0|  Loss:  7.5081 |Global loss: 9.8805| Local H loss: 0.0638  | Global H loss: 0.0622 [0m
[94mEpoch: 1|  NKD Loss: 2.1355 | CT Loss: 5.1927| [0m
[91mEpoch: 1|  Loss:  7.5041 |Global loss: 9.8776| Local H loss: 0.0642  | Global H loss: 0.0624 [0m
[94mEpoch: 2|  NKD Loss: 2.1329 | CT Loss: 5.1916| [0m
[91mEpoch: 2|  Loss:  7.4917 |Global loss: 9.8747| Local H loss: 0.0656  | Global H loss: 0.0635 [0m
[94mEpoch: 3|  NKD Loss: 2.1455 | CT Loss: 5.1903| [0m
[91mEpoch: 3|  Loss:  7.5284 |Global loss: 9.8812| Local H loss: 0.0624  | Global H loss: 0.0606 [0m
[94mEpoch: 0|  NKD Loss: 2.1926 | CT Loss: 5.1969| [0m
[91mEpoch: 0|  Loss:  7.7197 |Global loss: 9.924| Local H loss: 0.0463  | Global H loss: 0.0479 [0m
[94mEpoch: 1|  NKD Loss: 2.1915 | CT Loss: 5.1957| [0m
[91mEpoch: 1|  Loss:  7.7088 |Global loss: 9.9201| Local H loss: 0.0463  | Global H loss: 0.0482 [0m
[94mEpoch: 2|  NKD Loss: 2.1825 | CT Loss: 5.1915| [0m
[91mEpoch: 2|  Loss:  7.6749 |Global loss: 9.9127| Local H loss: 0.0486  | Global H loss: 0.0501 [0m
[94mEpoch: 3|  NKD Loss: 2.1816 | CT Loss: 5.1908| [0m
[91mEpoch: 3|  Loss:  7.6696 |Global loss: 9.91| Local H loss: 0.0496  | Global H loss: 0.0507 [0m
[94mEpoch: 0|  NKD Loss: 2.1587 | CT Loss: 5.1756| [0m
[91mEpoch: 0|  Loss:  7.5696 |Global loss: 9.8742| Local H loss: 0.0542  | Global H loss: 0.055 [0m
[94mEpoch: 1|  NKD Loss: 2.1558 | CT Loss: 5.1734| [0m
[91mEpoch: 1|  Loss:  7.555 |Global loss: 9.8721| Local H loss: 0.0552  | Global H loss: 0.0559 [0m
[94mEpoch: 2|  NKD Loss: 2.1593 | CT Loss: 5.1722| [0m
[91mEpoch: 2|  Loss:  7.5648 |Global loss: 9.877| Local H loss: 0.0558  | Global H loss: 0.0559 [0m
[94mEpoch: 3|  NKD Loss: 2.1571 | CT Loss: 5.1709| [0m
[91mEpoch: 3|  Loss:  7.553 |Global loss: 9.8717| Local H loss: 0.0561  | Global H loss: 0.0564 [0m
[94mEpoch: 0|  NKD Loss: 2.2145 | CT Loss: 5.2285| [0m
[91mEpoch: 0|  Loss:  7.8984 |Global loss: 9.9672| Local H loss: 0.035  | Global H loss: 0.0392 [0m
[94mEpoch: 1|  NKD Loss: 2.2141 | CT Loss: 5.2268| [0m
[91mEpoch: 1|  Loss:  7.8958 |Global loss: 9.9675| Local H loss: 0.0351  | Global H loss: 0.0394 [0m
[94mEpoch: 2|  NKD Loss: 2.2084 | CT Loss: 5.2248| [0m
[91mEpoch: 2|  Loss:  7.864 |Global loss: 9.9619| Local H loss: 0.0373  | Global H loss: 0.0413 [0m
[94mEpoch: 3|  NKD Loss: 2.1998 | CT Loss: 5.2214| [0m
[91mEpoch: 3|  Loss:  7.8326 |Global loss: 9.9523| Local H loss: 0.0391  | Global H loss: 0.0428 [0m
------------------------- time cost ------------------------- 2.940521717071533
Chosen Clients:  [14, 7, 13, 10, 4, 12]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.917, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [118.98, 119.862, 119.677, 119.002, 119.957, 119.265, 119.351, 118.994, 119.01, 119.785, 119.957, 119.757, 119.886, 119.32, 119.002]
F1 Score:  [0.974, 0.878, 0.981, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.974, 0.982, 0.981, 0.961, 0.838, 0.974]
Recall Score:  [0.977, 0.91, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.966, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4953
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9595
Averaged Test Recal score: 0.9681
Std Test Accurancy: 0.0344
Std Test AUC: 0.0032
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1264 | CT Loss: 5.1528| [0m
[91mEpoch: 0|  Loss:  7.4346 |Global loss: 9.8338| Local H loss: 0.0717  | Global H loss: 0.0663 [0m
[94mEpoch: 1|  NKD Loss: 2.1248 | CT Loss: 5.153| [0m
[91mEpoch: 1|  Loss:  7.4261 |Global loss: 9.8347| Local H loss: 0.0725  | Global H loss: 0.0671 [0m
[94mEpoch: 2|  NKD Loss: 2.1285 | CT Loss: 5.1506| [0m
[91mEpoch: 2|  Loss:  7.4352 |Global loss: 9.8357| Local H loss: 0.071  | Global H loss: 0.0661 [0m
[94mEpoch: 3|  NKD Loss: 2.1296 | CT Loss: 5.1489| [0m
[91mEpoch: 3|  Loss:  7.4352 |Global loss: 9.8329| Local H loss: 0.0712  | Global H loss: 0.066 [0m
[94mEpoch: 0|  NKD Loss: 2.1539 | CT Loss: 5.1841| [0m
[91mEpoch: 0|  Loss:  7.5464 |Global loss: 9.8824| Local H loss: 0.0605  | Global H loss: 0.0588 [0m
[94mEpoch: 1|  NKD Loss: 2.1336 | CT Loss: 5.182| [0m
[91mEpoch: 1|  Loss:  7.4934 |Global loss: 9.8677| Local H loss: 0.0659  | Global H loss: 0.0627 [0m
[94mEpoch: 2|  NKD Loss: 2.1403 | CT Loss: 5.1796| [0m
[91mEpoch: 2|  Loss:  7.5035 |Global loss: 9.8702| Local H loss: 0.0642  | Global H loss: 0.0616 [0m
[94mEpoch: 3|  NKD Loss: 2.143 | CT Loss: 5.1795| [0m
[91mEpoch: 3|  Loss:  7.5054 |Global loss: 9.8705| Local H loss: 0.0655  | Global H loss: 0.0623 [0m
[94mEpoch: 0|  NKD Loss: 2.1971 | CT Loss: 5.2186| [0m
[91mEpoch: 0|  Loss:  7.8169 |Global loss: 9.9475| Local H loss: 0.04  | Global H loss: 0.0437 [0m
[94mEpoch: 1|  NKD Loss: 2.1986 | CT Loss: 5.2178| [0m
[91mEpoch: 1|  Loss:  7.8089 |Global loss: 9.9451| Local H loss: 0.0408  | Global H loss: 0.044 [0m
[94mEpoch: 2|  NKD Loss: 2.1954 | CT Loss: 5.2164| [0m
[91mEpoch: 2|  Loss:  7.8063 |Global loss: 9.9455| Local H loss: 0.0408  | Global H loss: 0.0441 [0m
[94mEpoch: 3|  NKD Loss: 2.1944 | CT Loss: 5.2126| [0m
[91mEpoch: 3|  Loss:  7.799 |Global loss: 9.9402| Local H loss: 0.0423  | Global H loss: 0.045 [0m
[94mEpoch: 0|  NKD Loss: 2.1869 | CT Loss: 5.1883| [0m
[91mEpoch: 0|  Loss:  7.6841 |Global loss: 9.9128| Local H loss: 0.0481  | Global H loss: 0.0493 [0m
[94mEpoch: 1|  NKD Loss: 2.1796 | CT Loss: 5.1847| [0m
[91mEpoch: 1|  Loss:  7.6539 |Global loss: 9.9012| Local H loss: 0.05  | Global H loss: 0.0509 [0m
[94mEpoch: 2|  NKD Loss: 2.1757 | CT Loss: 5.1816| [0m
[91mEpoch: 2|  Loss:  7.6376 |Global loss: 9.8971| Local H loss: 0.0514  | Global H loss: 0.052 [0m
[94mEpoch: 3|  NKD Loss: 2.1749 | CT Loss: 5.1799| [0m
[91mEpoch: 3|  Loss:  7.6274 |Global loss: 9.8941| Local H loss: 0.0523  | Global H loss: 0.0528 [0m
[94mEpoch: 0|  NKD Loss: 2.1584 | CT Loss: 5.1871| [0m
[91mEpoch: 0|  Loss:  7.6075 |Global loss: 9.885| Local H loss: 0.056  | Global H loss: 0.0551 [0m
[94mEpoch: 1|  NKD Loss: 2.1605 | CT Loss: 5.1842| [0m
[91mEpoch: 1|  Loss:  7.6079 |Global loss: 9.8861| Local H loss: 0.0571  | Global H loss: 0.0557 [0m
[94mEpoch: 2|  NKD Loss: 2.157 | CT Loss: 5.1831| [0m
[91mEpoch: 2|  Loss:  7.5895 |Global loss: 9.8879| Local H loss: 0.0584  | Global H loss: 0.0569 [0m
[94mEpoch: 3|  NKD Loss: 2.163 | CT Loss: 5.1813| [0m
[91mEpoch: 3|  Loss:  7.6144 |Global loss: 9.886| Local H loss: 0.058  | Global H loss: 0.056 [0m
[94mEpoch: 0|  NKD Loss: 2.2012 | CT Loss: 5.2079| [0m
[91mEpoch: 0|  Loss:  7.7794 |Global loss: 9.9367| Local H loss: 0.0379  | Global H loss: 0.0427 [0m
[94mEpoch: 1|  NKD Loss: 2.2083 | CT Loss: 5.2064| [0m
[91mEpoch: 1|  Loss:  7.8044 |Global loss: 9.9451| Local H loss: 0.0371  | Global H loss: 0.0418 [0m
[94mEpoch: 2|  NKD Loss: 2.1914 | CT Loss: 5.2025| [0m
[91mEpoch: 2|  Loss:  7.7399 |Global loss: 9.9257| Local H loss: 0.0409  | Global H loss: 0.0451 [0m
[94mEpoch: 3|  NKD Loss: 2.1949 | CT Loss: 5.2013| [0m
[91mEpoch: 3|  Loss:  7.7443 |Global loss: 9.9292| Local H loss: 0.0415  | Global H loss: 0.0456 [0m
------------------------- time cost ------------------------- 2.8783318996429443
Chosen Clients:  [9, 10, 3, 7, 6, 13]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.917, 0.983, 0.975, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.98, 119.862, 119.677, 119.002, 119.929, 119.265, 119.351, 118.995, 119.01, 119.785, 119.945, 119.757, 119.913, 119.145, 119.02]
F1 Score:  [0.974, 0.878, 0.981, 0.973, 0.944, 0.982, 0.974, 0.973, 0.974, 0.974, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.91, 0.984, 0.977, 0.949, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4780
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9587
Averaged Test Recal score: 0.9670
Std Test Accurancy: 0.0345
Std Test AUC: 0.0032
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1296 | CT Loss: 5.1964| [0m
[91mEpoch: 0|  Loss:  7.4839 |Global loss: 9.8787| Local H loss: 0.0699  | Global H loss: 0.0657 [0m
[94mEpoch: 1|  NKD Loss: 2.1302 | CT Loss: 5.194| [0m
[91mEpoch: 1|  Loss:  7.4821 |Global loss: 9.879| Local H loss: 0.07  | Global H loss: 0.0657 [0m
[94mEpoch: 2|  NKD Loss: 2.1268 | CT Loss: 5.1923| [0m
[91mEpoch: 2|  Loss:  7.4713 |Global loss: 9.8704| Local H loss: 0.0714  | Global H loss: 0.0665 [0m
[94mEpoch: 3|  NKD Loss: 2.127 | CT Loss: 5.1902| [0m
[91mEpoch: 3|  Loss:  7.4695 |Global loss: 9.8717| Local H loss: 0.0713  | Global H loss: 0.0665 [0m
[94mEpoch: 0|  NKD Loss: 2.1672 | CT Loss: 5.1774| [0m
[91mEpoch: 0|  Loss:  7.6049 |Global loss: 9.8868| Local H loss: 0.0534  | Global H loss: 0.0536 [0m
[94mEpoch: 1|  NKD Loss: 2.1788 | CT Loss: 5.1777| [0m
[91mEpoch: 1|  Loss:  7.6356 |Global loss: 9.8964| Local H loss: 0.051  | Global H loss: 0.0518 [0m
[94mEpoch: 2|  NKD Loss: 2.1676 | CT Loss: 5.1741| [0m
[91mEpoch: 2|  Loss:  7.5976 |Global loss: 9.8819| Local H loss: 0.0534  | Global H loss: 0.0539 [0m
[94mEpoch: 3|  NKD Loss: 2.1647 | CT Loss: 5.1695| [0m
[91mEpoch: 3|  Loss:  7.5863 |Global loss: 9.8782| Local H loss: 0.0549  | Global H loss: 0.0546 [0m
[94mEpoch: 0|  NKD Loss: 2.1739 | CT Loss: 5.2261| [0m
[91mEpoch: 0|  Loss:  7.6576 |Global loss: 9.9388| Local H loss: 0.0468  | Global H loss: 0.0507 [0m
[94mEpoch: 1|  NKD Loss: 2.1757 | CT Loss: 5.2236| [0m
[91mEpoch: 1|  Loss:  7.655 |Global loss: 9.936| Local H loss: 0.047  | Global H loss: 0.0507 [0m
[94mEpoch: 2|  NKD Loss: 2.169 | CT Loss: 5.2225| [0m
[91mEpoch: 2|  Loss:  7.6308 |Global loss: 9.9307| Local H loss: 0.0491  | Global H loss: 0.0525 [0m
[94mEpoch: 3|  NKD Loss: 2.1841 | CT Loss: 5.2209| [0m
[91mEpoch: 3|  Loss:  7.6765 |Global loss: 9.9417| Local H loss: 0.0476  | Global H loss: 0.0507 [0m
[94mEpoch: 0|  NKD Loss: 2.1292 | CT Loss: 5.1756| [0m
[91mEpoch: 0|  Loss:  7.472 |Global loss: 9.8571| Local H loss: 0.0678  | Global H loss: 0.0642 [0m
[94mEpoch: 1|  NKD Loss: 2.185 | CT Loss: 5.1769| [0m
[91mEpoch: 1|  Loss:  7.6183 |Global loss: 9.9041| Local H loss: 0.0589  | Global H loss: 0.0567 [0m
[94mEpoch: 2|  NKD Loss: 2.1405 | CT Loss: 5.1738| [0m
[91mEpoch: 2|  Loss:  7.5034 |Global loss: 9.8628| Local H loss: 0.0641  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1531 | CT Loss: 5.1718| [0m
[91mEpoch: 3|  Loss:  7.5344 |Global loss: 9.8726| Local H loss: 0.0614  | Global H loss: 0.0592 [0m
[94mEpoch: 0|  NKD Loss: 2.2071 | CT Loss: 5.2175| [0m
[91mEpoch: 0|  Loss:  7.7703 |Global loss: 9.9558| Local H loss: 0.0372  | Global H loss: 0.042 [0m
[94mEpoch: 1|  NKD Loss: 2.2021 | CT Loss: 5.2164| [0m
[91mEpoch: 1|  Loss:  7.7613 |Global loss: 9.9505| Local H loss: 0.0382  | Global H loss: 0.0428 [0m
[94mEpoch: 2|  NKD Loss: 2.192 | CT Loss: 5.2134| [0m
[91mEpoch: 2|  Loss:  7.7132 |Global loss: 9.9415| Local H loss: 0.0406  | Global H loss: 0.0451 [0m
[94mEpoch: 3|  NKD Loss: 2.1906 | CT Loss: 5.2117| [0m
[91mEpoch: 3|  Loss:  7.7038 |Global loss: 9.9374| Local H loss: 0.0418  | Global H loss: 0.0461 [0m
[94mEpoch: 0|  NKD Loss: 2.1895 | CT Loss: 5.2116| [0m
[91mEpoch: 0|  Loss:  7.7774 |Global loss: 9.9372| Local H loss: 0.0434  | Global H loss: 0.046 [0m
[94mEpoch: 1|  NKD Loss: 2.1853 | CT Loss: 5.2075| [0m
[91mEpoch: 1|  Loss:  7.7598 |Global loss: 9.9281| Local H loss: 0.0451  | Global H loss: 0.0473 [0m
[94mEpoch: 2|  NKD Loss: 2.1877 | CT Loss: 5.2069| [0m
[91mEpoch: 2|  Loss:  7.7628 |Global loss: 9.9282| Local H loss: 0.0444  | Global H loss: 0.0466 [0m
[94mEpoch: 3|  NKD Loss: 2.1836 | CT Loss: 5.2054| [0m
[91mEpoch: 3|  Loss:  7.7473 |Global loss: 9.9235| Local H loss: 0.0463  | Global H loss: 0.0481 [0m
------------------------- time cost ------------------------- 2.9241104125976562
Chosen Clients:  [4, 1, 7, 11, 9, 0]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.917, 0.983, 0.975, 0.95, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.98, 119.862, 119.677, 118.959, 119.929, 119.265, 119.378, 118.995, 119.01, 119.874, 119.962, 119.757, 119.913, 119.205, 119.02]
F1 Score:  [0.974, 0.878, 0.981, 0.973, 0.944, 0.982, 0.974, 0.973, 0.974, 0.974, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.91, 0.984, 0.977, 0.949, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4666
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9954
Averaged Test F1_score: 0.9587
Averaged Test Recal score: 0.9670
Std Test Accurancy: 0.0345
Std Test AUC: 0.0033
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1518 | CT Loss: 5.1773| [0m
[91mEpoch: 0|  Loss:  7.5792 |Global loss: 9.878| Local H loss: 0.0593  | Global H loss: 0.057 [0m
[94mEpoch: 1|  NKD Loss: 2.1605 | CT Loss: 5.1781| [0m
[91mEpoch: 1|  Loss:  7.5939 |Global loss: 9.8849| Local H loss: 0.0593  | Global H loss: 0.0569 [0m
[94mEpoch: 2|  NKD Loss: 2.1513 | CT Loss: 5.1744| [0m
[91mEpoch: 2|  Loss:  7.5678 |Global loss: 9.8712| Local H loss: 0.0603  | Global H loss: 0.0577 [0m
[94mEpoch: 3|  NKD Loss: 2.1592 | CT Loss: 5.1726| [0m
[91mEpoch: 3|  Loss:  7.5907 |Global loss: 9.8765| Local H loss: 0.059  | Global H loss: 0.0565 [0m
[94mEpoch: 0|  NKD Loss: 2.1641 | CT Loss: 5.1876| [0m
[91mEpoch: 0|  Loss:  7.618 |Global loss: 9.896| Local H loss: 0.054  | Global H loss: 0.0541 [0m
[94mEpoch: 1|  NKD Loss: 2.1536 | CT Loss: 5.1849| [0m
[91mEpoch: 1|  Loss:  7.5687 |Global loss: 9.8825| Local H loss: 0.0564  | Global H loss: 0.0563 [0m
[94mEpoch: 2|  NKD Loss: 2.1634 | CT Loss: 5.1825| [0m
[91mEpoch: 2|  Loss:  7.5998 |Global loss: 9.8906| Local H loss: 0.056  | Global H loss: 0.0559 [0m
[94mEpoch: 3|  NKD Loss: 2.1537 | CT Loss: 5.18| [0m
[91mEpoch: 3|  Loss:  7.5691 |Global loss: 9.8792| Local H loss: 0.0566  | Global H loss: 0.0561 [0m
[94mEpoch: 0|  NKD Loss: 2.128 | CT Loss: 5.1686| [0m
[91mEpoch: 0|  Loss:  7.4652 |Global loss: 9.8494| Local H loss: 0.0682  | Global H loss: 0.0642 [0m
[94mEpoch: 1|  NKD Loss: 2.1333 | CT Loss: 5.1684| [0m
[91mEpoch: 1|  Loss:  7.4738 |Global loss: 9.8547| Local H loss: 0.0682  | Global H loss: 0.0638 [0m
[94mEpoch: 2|  NKD Loss: 2.1292 | CT Loss: 5.1654| [0m
[91mEpoch: 2|  Loss:  7.457 |Global loss: 9.8469| Local H loss: 0.0696  | Global H loss: 0.0651 [0m
[94mEpoch: 3|  NKD Loss: 2.1253 | CT Loss: 5.1629| [0m
[91mEpoch: 3|  Loss:  7.447 |Global loss: 9.8445| Local H loss: 0.0715  | Global H loss: 0.066 [0m
[94mEpoch: 0|  NKD Loss: 2.1328 | CT Loss: 5.1887| [0m
[91mEpoch: 0|  Loss:  7.4906 |Global loss: 9.8735| Local H loss: 0.0658  | Global H loss: 0.0633 [0m
[94mEpoch: 1|  NKD Loss: 2.1293 | CT Loss: 5.186| [0m
[91mEpoch: 1|  Loss:  7.478 |Global loss: 9.8665| Local H loss: 0.0676  | Global H loss: 0.0645 [0m
[94mEpoch: 2|  NKD Loss: 2.1307 | CT Loss: 5.1858| [0m
[91mEpoch: 2|  Loss:  7.4831 |Global loss: 9.8691| Local H loss: 0.0675  | Global H loss: 0.0641 [0m
[94mEpoch: 3|  NKD Loss: 2.1298 | CT Loss: 5.1818| [0m
[91mEpoch: 3|  Loss:  7.4736 |Global loss: 9.8652| Local H loss: 0.0684  | Global H loss: 0.0648 [0m
[94mEpoch: 0|  NKD Loss: 2.126 | CT Loss: 5.188| [0m
[91mEpoch: 0|  Loss:  7.467 |Global loss: 9.8687| Local H loss: 0.0722  | Global H loss: 0.0668 [0m
[94mEpoch: 1|  NKD Loss: 2.1261 | CT Loss: 5.1858| [0m
[91mEpoch: 1|  Loss:  7.4649 |Global loss: 9.8657| Local H loss: 0.0723  | Global H loss: 0.0669 [0m
[94mEpoch: 2|  NKD Loss: 2.1232 | CT Loss: 5.1833| [0m
[91mEpoch: 2|  Loss:  7.4558 |Global loss: 9.8634| Local H loss: 0.0739  | Global H loss: 0.0677 [0m
[94mEpoch: 3|  NKD Loss: 2.1257 | CT Loss: 5.1817| [0m
[91mEpoch: 3|  Loss:  7.4603 |Global loss: 9.8644| Local H loss: 0.0727  | Global H loss: 0.067 [0m
[94mEpoch: 0|  NKD Loss: 2.1646 | CT Loss: 5.154| [0m
[91mEpoch: 0|  Loss:  7.5668 |Global loss: 9.8585| Local H loss: 0.0568  | Global H loss: 0.0553 [0m
[94mEpoch: 1|  NKD Loss: 2.1605 | CT Loss: 5.1516| [0m
[91mEpoch: 1|  Loss:  7.5507 |Global loss: 9.8584| Local H loss: 0.0582  | Global H loss: 0.0563 [0m
[94mEpoch: 2|  NKD Loss: 2.1563 | CT Loss: 5.1493| [0m
[91mEpoch: 2|  Loss:  7.5391 |Global loss: 9.8506| Local H loss: 0.0587  | Global H loss: 0.0567 [0m
[94mEpoch: 3|  NKD Loss: 2.1692 | CT Loss: 5.1471| [0m
[91mEpoch: 3|  Loss:  7.5785 |Global loss: 9.8578| Local H loss: 0.0582  | Global H loss: 0.0559 [0m
------------------------- time cost ------------------------- 2.8846333026885986
Chosen Clients:  [6, 7, 1, 3, 10, 4]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.973, 119.946, 119.677, 118.959, 119.96, 119.265, 119.378, 118.995, 119.01, 119.937, 119.962, 119.803, 119.913, 119.205, 119.02]
F1 Score:  [0.974, 0.981, 0.981, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4448
Averaged Test Accurancy: 0.9700
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9681
Averaged Test Recal score: 0.9743
Std Test Accurancy: 0.0323
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1842 | CT Loss: 5.208| [0m
[91mEpoch: 0|  Loss:  7.6797 |Global loss: 9.9281| Local H loss: 0.043  | Global H loss: 0.0473 [0m
[94mEpoch: 1|  NKD Loss: 2.1869 | CT Loss: 5.2072| [0m
[91mEpoch: 1|  Loss:  7.6779 |Global loss: 9.9271| Local H loss: 0.0441  | Global H loss: 0.048 [0m
[94mEpoch: 2|  NKD Loss: 2.1772 | CT Loss: 5.2041| [0m
[91mEpoch: 2|  Loss:  7.6512 |Global loss: 9.9131| Local H loss: 0.0451  | Global H loss: 0.049 [0m
[94mEpoch: 3|  NKD Loss: 2.1722 | CT Loss: 5.2018| [0m
[91mEpoch: 3|  Loss:  7.6233 |Global loss: 9.9126| Local H loss: 0.0482  | Global H loss: 0.0515 [0m
[94mEpoch: 0|  NKD Loss: 2.1279 | CT Loss: 5.1618| [0m
[91mEpoch: 0|  Loss:  7.4501 |Global loss: 9.8448| Local H loss: 0.0705  | Global H loss: 0.0655 [0m
[94mEpoch: 1|  NKD Loss: 2.1344 | CT Loss: 5.1626| [0m
[91mEpoch: 1|  Loss:  7.4649 |Global loss: 9.8462| Local H loss: 0.0688  | Global H loss: 0.0643 [0m
[94mEpoch: 2|  NKD Loss: 2.1258 | CT Loss: 5.158| [0m
[91mEpoch: 2|  Loss:  7.4396 |Global loss: 9.8406| Local H loss: 0.0715  | Global H loss: 0.0662 [0m
[94mEpoch: 3|  NKD Loss: 2.1366 | CT Loss: 5.1568| [0m
[91mEpoch: 3|  Loss:  7.4641 |Global loss: 9.8448| Local H loss: 0.0688  | Global H loss: 0.0641 [0m
[94mEpoch: 0|  NKD Loss: 2.1585 | CT Loss: 5.1784| [0m
[91mEpoch: 0|  Loss:  7.5732 |Global loss: 9.881| Local H loss: 0.0568  | Global H loss: 0.0565 [0m
[94mEpoch: 1|  NKD Loss: 2.1728 | CT Loss: 5.1764| [0m
[91mEpoch: 1|  Loss:  7.6344 |Global loss: 9.8914| Local H loss: 0.0559  | Global H loss: 0.0551 [0m
[94mEpoch: 2|  NKD Loss: 2.1587 | CT Loss: 5.1754| [0m
[91mEpoch: 2|  Loss:  7.5916 |Global loss: 9.8758| Local H loss: 0.0558  | Global H loss: 0.0554 [0m
[94mEpoch: 3|  NKD Loss: 2.1455 | CT Loss: 5.1713| [0m
[91mEpoch: 3|  Loss:  7.5314 |Global loss: 9.8627| Local H loss: 0.0594  | Global H loss: 0.0583 [0m
[94mEpoch: 0|  NKD Loss: 2.17 | CT Loss: 5.2181| [0m
[91mEpoch: 0|  Loss:  7.6377 |Global loss: 9.9314| Local H loss: 0.0487  | Global H loss: 0.052 [0m
[94mEpoch: 1|  NKD Loss: 2.1599 | CT Loss: 5.2154| [0m
[91mEpoch: 1|  Loss:  7.5991 |Global loss: 9.9163| Local H loss: 0.0525  | Global H loss: 0.0549 [0m
[94mEpoch: 2|  NKD Loss: 2.1595 | CT Loss: 5.215| [0m
[91mEpoch: 2|  Loss:  7.5879 |Global loss: 9.9191| Local H loss: 0.0541  | Global H loss: 0.0561 [0m
[94mEpoch: 3|  NKD Loss: 2.1529 | CT Loss: 5.2107| [0m
[91mEpoch: 3|  Loss:  7.573 |Global loss: 9.9103| Local H loss: 0.055  | Global H loss: 0.0568 [0m
[94mEpoch: 0|  NKD Loss: 2.163 | CT Loss: 5.1698| [0m
[91mEpoch: 0|  Loss:  7.5802 |Global loss: 9.876| Local H loss: 0.0555  | Global H loss: 0.0551 [0m
[94mEpoch: 1|  NKD Loss: 2.1731 | CT Loss: 5.1699| [0m
[91mEpoch: 1|  Loss:  7.6075 |Global loss: 9.8854| Local H loss: 0.0532  | Global H loss: 0.0534 [0m
[94mEpoch: 2|  NKD Loss: 2.163 | CT Loss: 5.1667| [0m
[91mEpoch: 2|  Loss:  7.5768 |Global loss: 9.8715| Local H loss: 0.055  | Global H loss: 0.0547 [0m
[94mEpoch: 3|  NKD Loss: 2.1565 | CT Loss: 5.1663| [0m
[91mEpoch: 3|  Loss:  7.547 |Global loss: 9.8668| Local H loss: 0.0594  | Global H loss: 0.0578 [0m
[94mEpoch: 0|  NKD Loss: 2.1536 | CT Loss: 5.1694| [0m
[91mEpoch: 0|  Loss:  7.5656 |Global loss: 9.869| Local H loss: 0.0606  | Global H loss: 0.058 [0m
[94mEpoch: 1|  NKD Loss: 2.1498 | CT Loss: 5.1695| [0m
[91mEpoch: 1|  Loss:  7.5474 |Global loss: 9.8646| Local H loss: 0.0617  | Global H loss: 0.0586 [0m
[94mEpoch: 2|  NKD Loss: 2.1602 | CT Loss: 5.1661| [0m
[91mEpoch: 2|  Loss:  7.595 |Global loss: 9.8727| Local H loss: 0.0606  | Global H loss: 0.0573 [0m
[94mEpoch: 3|  NKD Loss: 2.1495 | CT Loss: 5.1639| [0m
[91mEpoch: 3|  Loss:  7.5438 |Global loss: 9.8607| Local H loss: 0.0613  | Global H loss: 0.0586 [0m
------------------------- time cost ------------------------- 2.8209311962127686
Chosen Clients:  [5, 7, 3, 9, 4, 1]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.983, 0.975, 0.967, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.973, 119.952, 119.677, 118.997, 119.958, 119.265, 119.492, 118.996, 119.01, 119.937, 119.963, 119.803, 119.913, 119.205, 119.02]
F1 Score:  [0.974, 0.974, 0.981, 0.973, 0.964, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.984, 0.977, 0.968, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4253
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9670
Averaged Test Recal score: 0.9732
Std Test Accurancy: 0.0321
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1553 | CT Loss: 5.169| [0m
[91mEpoch: 0|  Loss:  7.5484 |Global loss: 9.8739| Local H loss: 0.0574  | Global H loss: 0.0571 [0m
[94mEpoch: 1|  NKD Loss: 2.1482 | CT Loss: 5.1673| [0m
[91mEpoch: 1|  Loss:  7.5273 |Global loss: 9.8609| Local H loss: 0.0583  | Global H loss: 0.0579 [0m
[94mEpoch: 2|  NKD Loss: 2.1571 | CT Loss: 5.1644| [0m
[91mEpoch: 2|  Loss:  7.5451 |Global loss: 9.8678| Local H loss: 0.057  | Global H loss: 0.057 [0m
[94mEpoch: 3|  NKD Loss: 2.1525 | CT Loss: 5.1648| [0m
[91mEpoch: 3|  Loss:  7.5326 |Global loss: 9.866| Local H loss: 0.0577  | Global H loss: 0.0574 [0m
[94mEpoch: 0|  NKD Loss: 2.1318 | CT Loss: 5.1553| [0m
[91mEpoch: 0|  Loss:  7.4544 |Global loss: 9.8402| Local H loss: 0.0702  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1319 | CT Loss: 5.1536| [0m
[91mEpoch: 1|  Loss:  7.4529 |Global loss: 9.8401| Local H loss: 0.0701  | Global H loss: 0.0648 [0m
[94mEpoch: 2|  NKD Loss: 2.1249 | CT Loss: 5.1533| [0m
[91mEpoch: 2|  Loss:  7.4325 |Global loss: 9.8327| Local H loss: 0.0729  | Global H loss: 0.0667 [0m
[94mEpoch: 3|  NKD Loss: 2.1315 | CT Loss: 5.1503| [0m
[91mEpoch: 3|  Loss:  7.4441 |Global loss: 9.8364| Local H loss: 0.0705  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.1531 | CT Loss: 5.2094| [0m
[91mEpoch: 0|  Loss:  7.5661 |Global loss: 9.9078| Local H loss: 0.0562  | Global H loss: 0.0575 [0m
[94mEpoch: 1|  NKD Loss: 2.1596 | CT Loss: 5.2077| [0m
[91mEpoch: 1|  Loss:  7.5839 |Global loss: 9.9129| Local H loss: 0.0536  | Global H loss: 0.0556 [0m
[94mEpoch: 2|  NKD Loss: 2.157 | CT Loss: 5.2059| [0m
[91mEpoch: 2|  Loss:  7.5752 |Global loss: 9.9095| Local H loss: 0.0548  | Global H loss: 0.0565 [0m
[94mEpoch: 3|  NKD Loss: 2.1504 | CT Loss: 5.2037| [0m
[91mEpoch: 3|  Loss:  7.5578 |Global loss: 9.8999| Local H loss: 0.0568  | Global H loss: 0.0578 [0m
[94mEpoch: 0|  NKD Loss: 2.1256 | CT Loss: 5.1803| [0m
[91mEpoch: 0|  Loss:  7.4583 |Global loss: 9.863| Local H loss: 0.0735  | Global H loss: 0.0673 [0m
[94mEpoch: 1|  NKD Loss: 2.1227 | CT Loss: 5.1779| [0m
[91mEpoch: 1|  Loss:  7.4495 |Global loss: 9.8554| Local H loss: 0.0746  | Global H loss: 0.0679 [0m
[94mEpoch: 2|  NKD Loss: 2.1234 | CT Loss: 5.1772| [0m
[91mEpoch: 2|  Loss:  7.4496 |Global loss: 9.8574| Local H loss: 0.0746  | Global H loss: 0.0678 [0m
[94mEpoch: 3|  NKD Loss: 2.1244 | CT Loss: 5.1745| [0m
[91mEpoch: 3|  Loss:  7.4495 |Global loss: 9.8573| Local H loss: 0.075  | Global H loss: 0.0679 [0m
[94mEpoch: 0|  NKD Loss: 2.1501 | CT Loss: 5.1634| [0m
[91mEpoch: 0|  Loss:  7.544 |Global loss: 9.8595| Local H loss: 0.0626  | Global H loss: 0.0588 [0m
[94mEpoch: 1|  NKD Loss: 2.1502 | CT Loss: 5.1602| [0m
[91mEpoch: 1|  Loss:  7.5415 |Global loss: 9.8607| Local H loss: 0.0618  | Global H loss: 0.0587 [0m
[94mEpoch: 2|  NKD Loss: 2.1486 | CT Loss: 5.1573| [0m
[91mEpoch: 2|  Loss:  7.5389 |Global loss: 9.8529| Local H loss: 0.064  | Global H loss: 0.0597 [0m
[94mEpoch: 3|  NKD Loss: 2.1413 | CT Loss: 5.1554| [0m
[91mEpoch: 3|  Loss:  7.5108 |Global loss: 9.8446| Local H loss: 0.0649  | Global H loss: 0.0605 [0m
[94mEpoch: 0|  NKD Loss: 2.1445 | CT Loss: 5.1688| [0m
[91mEpoch: 0|  Loss:  7.5249 |Global loss: 9.8641| Local H loss: 0.0598  | Global H loss: 0.0585 [0m
[94mEpoch: 1|  NKD Loss: 2.1549 | CT Loss: 5.1687| [0m
[91mEpoch: 1|  Loss:  7.5552 |Global loss: 9.8694| Local H loss: 0.0593  | Global H loss: 0.058 [0m
[94mEpoch: 2|  NKD Loss: 2.152 | CT Loss: 5.1649| [0m
[91mEpoch: 2|  Loss:  7.5359 |Global loss: 9.8651| Local H loss: 0.0608  | Global H loss: 0.0592 [0m
[94mEpoch: 3|  NKD Loss: 2.1403 | CT Loss: 5.1651| [0m
[91mEpoch: 3|  Loss:  7.5054 |Global loss: 9.8534| Local H loss: 0.0618  | Global H loss: 0.0599 [0m
------------------------- time cost ------------------------- 2.8135406970977783
Chosen Clients:  [7, 0, 6, 4, 9, 3]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.967, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.973, 119.977, 119.677, 118.992, 119.97, 119.298, 119.492, 118.995, 119.01, 119.87, 119.963, 119.803, 119.913, 119.205, 119.02]
F1 Score:  [0.974, 0.981, 0.981, 0.973, 0.964, 0.982, 0.974, 0.973, 0.974, 0.974, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.968, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4182
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9956
Averaged Test F1_score: 0.9669
Averaged Test Recal score: 0.9732
Std Test Accurancy: 0.0321
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.136 | CT Loss: 5.1491| [0m
[91mEpoch: 0|  Loss:  7.4609 |Global loss: 9.8389| Local H loss: 0.0692  | Global H loss: 0.0639 [0m
[94mEpoch: 1|  NKD Loss: 2.1323 | CT Loss: 5.1474| [0m
[91mEpoch: 1|  Loss:  7.4459 |Global loss: 9.8339| Local H loss: 0.0702  | Global H loss: 0.0649 [0m
[94mEpoch: 2|  NKD Loss: 2.1278 | CT Loss: 5.1466| [0m
[91mEpoch: 2|  Loss:  7.4332 |Global loss: 9.8284| Local H loss: 0.0715  | Global H loss: 0.0659 [0m
[94mEpoch: 3|  NKD Loss: 2.122 | CT Loss: 5.1439| [0m
[91mEpoch: 3|  Loss:  7.4163 |Global loss: 9.8202| Local H loss: 0.0745  | Global H loss: 0.0675 [0m
[94mEpoch: 0|  NKD Loss: 2.1473 | CT Loss: 5.1454| [0m
[91mEpoch: 0|  Loss:  7.5132 |Global loss: 9.8392| Local H loss: 0.0601  | Global H loss: 0.0577 [0m
[94mEpoch: 1|  NKD Loss: 2.1473 | CT Loss: 5.1435| [0m
[91mEpoch: 1|  Loss:  7.5051 |Global loss: 9.8402| Local H loss: 0.0616  | Global H loss: 0.0586 [0m
[94mEpoch: 2|  NKD Loss: 2.148 | CT Loss: 5.143| [0m
[91mEpoch: 2|  Loss:  7.5037 |Global loss: 9.8403| Local H loss: 0.0612  | Global H loss: 0.0587 [0m
[94mEpoch: 3|  NKD Loss: 2.1477 | CT Loss: 5.1401| [0m
[91mEpoch: 3|  Loss:  7.5015 |Global loss: 9.8346| Local H loss: 0.0625  | Global H loss: 0.0591 [0m
[94mEpoch: 0|  NKD Loss: 2.1709 | CT Loss: 5.1989| [0m
[91mEpoch: 0|  Loss:  7.614 |Global loss: 9.9071| Local H loss: 0.0481  | Global H loss: 0.0517 [0m
[94mEpoch: 1|  NKD Loss: 2.1736 | CT Loss: 5.1962| [0m
[91mEpoch: 1|  Loss:  7.6276 |Global loss: 9.9142| Local H loss: 0.0475  | Global H loss: 0.0508 [0m
[94mEpoch: 2|  NKD Loss: 2.163 | CT Loss: 5.1946| [0m
[91mEpoch: 2|  Loss:  7.5865 |Global loss: 9.9032| Local H loss: 0.0506  | Global H loss: 0.0537 [0m
[94mEpoch: 3|  NKD Loss: 2.1635 | CT Loss: 5.1925| [0m
[91mEpoch: 3|  Loss:  7.5858 |Global loss: 9.897| Local H loss: 0.0507  | Global H loss: 0.0537 [0m
[94mEpoch: 0|  NKD Loss: 2.1427 | CT Loss: 5.1535| [0m
[91mEpoch: 0|  Loss:  7.5084 |Global loss: 9.8445| Local H loss: 0.0655  | Global H loss: 0.061 [0m
[94mEpoch: 1|  NKD Loss: 2.1489 | CT Loss: 5.1532| [0m
[91mEpoch: 1|  Loss:  7.5273 |Global loss: 9.8503| Local H loss: 0.064  | Global H loss: 0.0599 [0m
[94mEpoch: 2|  NKD Loss: 2.1523 | CT Loss: 5.1495| [0m
[91mEpoch: 2|  Loss:  7.5471 |Global loss: 9.8489| Local H loss: 0.0637  | Global H loss: 0.0592 [0m
[94mEpoch: 3|  NKD Loss: 2.1459 | CT Loss: 5.1471| [0m
[91mEpoch: 3|  Loss:  7.5247 |Global loss: 9.843| Local H loss: 0.0639  | Global H loss: 0.0596 [0m
[94mEpoch: 0|  NKD Loss: 2.1262 | CT Loss: 5.1739| [0m
[91mEpoch: 0|  Loss:  7.45 |Global loss: 9.8556| Local H loss: 0.0738  | Global H loss: 0.0675 [0m
[94mEpoch: 1|  NKD Loss: 2.1242 | CT Loss: 5.1707| [0m
[91mEpoch: 1|  Loss:  7.4441 |Global loss: 9.8516| Local H loss: 0.0745  | Global H loss: 0.0678 [0m
[94mEpoch: 2|  NKD Loss: 2.122 | CT Loss: 5.1691| [0m
[91mEpoch: 2|  Loss:  7.4386 |Global loss: 9.8473| Local H loss: 0.0761  | Global H loss: 0.0684 [0m
[94mEpoch: 3|  NKD Loss: 2.1226 | CT Loss: 5.1677| [0m
[91mEpoch: 3|  Loss:  7.4382 |Global loss: 9.8497| Local H loss: 0.0754  | Global H loss: 0.0682 [0m
[94mEpoch: 0|  NKD Loss: 2.1511 | CT Loss: 5.2017| [0m
[91mEpoch: 0|  Loss:  7.5567 |Global loss: 9.8964| Local H loss: 0.0567  | Global H loss: 0.0577 [0m
[94mEpoch: 1|  NKD Loss: 2.1458 | CT Loss: 5.1987| [0m
[91mEpoch: 1|  Loss:  7.5382 |Global loss: 9.8909| Local H loss: 0.0591  | Global H loss: 0.0593 [0m
[94mEpoch: 2|  NKD Loss: 2.1411 | CT Loss: 5.1972| [0m
[91mEpoch: 2|  Loss:  7.5216 |Global loss: 9.8884| Local H loss: 0.0607  | Global H loss: 0.0605 [0m
[94mEpoch: 3|  NKD Loss: 2.139 | CT Loss: 5.1944| [0m
[91mEpoch: 3|  Loss:  7.5111 |Global loss: 9.8803| Local H loss: 0.062  | Global H loss: 0.0613 [0m
------------------------- time cost ------------------------- 2.8986051082611084
Chosen Clients:  [2, 11, 10, 4, 9, 13]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.994, 119.977, 119.677, 118.993, 119.971, 119.298, 119.68, 118.995, 119.01, 119.896, 119.963, 119.803, 119.913, 119.205, 119.02]
F1 Score:  [0.973, 0.981, 0.981, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.974, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.977, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.4051
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9675
Averaged Test Recal score: 0.9738
Std Test Accurancy: 0.0322
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1348 | CT Loss: 5.1797| [0m
[91mEpoch: 0|  Loss:  7.5046 |Global loss: 9.8658| Local H loss: 0.0617  | Global H loss: 0.0602 [0m
[94mEpoch: 1|  NKD Loss: 2.1608 | CT Loss: 5.1792| [0m
[91mEpoch: 1|  Loss:  7.5799 |Global loss: 9.8854| Local H loss: 0.0581  | Global H loss: 0.0566 [0m
[94mEpoch: 2|  NKD Loss: 2.1374 | CT Loss: 5.1752| [0m
[91mEpoch: 2|  Loss:  7.5055 |Global loss: 9.8613| Local H loss: 0.0633  | Global H loss: 0.0606 [0m
[94mEpoch: 3|  NKD Loss: 2.1374 | CT Loss: 5.1738| [0m
[91mEpoch: 3|  Loss:  7.498 |Global loss: 9.8656| Local H loss: 0.0646  | Global H loss: 0.0615 [0m
[94mEpoch: 0|  NKD Loss: 2.1248 | CT Loss: 5.1798| [0m
[91mEpoch: 0|  Loss:  7.4616 |Global loss: 9.8564| Local H loss: 0.0697  | Global H loss: 0.0656 [0m
[94mEpoch: 1|  NKD Loss: 2.1297 | CT Loss: 5.1782| [0m
[91mEpoch: 1|  Loss:  7.4724 |Global loss: 9.8635| Local H loss: 0.0684  | Global H loss: 0.0647 [0m
[94mEpoch: 2|  NKD Loss: 2.1274 | CT Loss: 5.176| [0m
[91mEpoch: 2|  Loss:  7.4649 |Global loss: 9.8569| Local H loss: 0.0684  | Global H loss: 0.0648 [0m
[94mEpoch: 3|  NKD Loss: 2.1218 | CT Loss: 5.1735| [0m
[91mEpoch: 3|  Loss:  7.4474 |Global loss: 9.8529| Local H loss: 0.0723  | Global H loss: 0.0668 [0m
[94mEpoch: 0|  NKD Loss: 2.1594 | CT Loss: 5.1621| [0m
[91mEpoch: 0|  Loss:  7.5634 |Global loss: 9.8678| Local H loss: 0.0559  | Global H loss: 0.0553 [0m
[94mEpoch: 1|  NKD Loss: 2.1594 | CT Loss: 5.1597| [0m
[91mEpoch: 1|  Loss:  7.5585 |Global loss: 9.861| Local H loss: 0.0556  | Global H loss: 0.0552 [0m
[94mEpoch: 2|  NKD Loss: 2.1506 | CT Loss: 5.1564| [0m
[91mEpoch: 2|  Loss:  7.5309 |Global loss: 9.8542| Local H loss: 0.0588  | Global H loss: 0.0574 [0m
[94mEpoch: 3|  NKD Loss: 2.15 | CT Loss: 5.1554| [0m
[91mEpoch: 3|  Loss:  7.5243 |Global loss: 9.8525| Local H loss: 0.0589  | Global H loss: 0.0577 [0m
[94mEpoch: 0|  NKD Loss: 2.141 | CT Loss: 5.1449| [0m
[91mEpoch: 0|  Loss:  7.5011 |Global loss: 9.8377| Local H loss: 0.0662  | Global H loss: 0.061 [0m
[94mEpoch: 1|  NKD Loss: 2.1435 | CT Loss: 5.1435| [0m
[91mEpoch: 1|  Loss:  7.5057 |Global loss: 9.8387| Local H loss: 0.0661  | Global H loss: 0.061 [0m
[94mEpoch: 2|  NKD Loss: 2.1391 | CT Loss: 5.1416| [0m
[91mEpoch: 2|  Loss:  7.489 |Global loss: 9.8299| Local H loss: 0.0671  | Global H loss: 0.0618 [0m
[94mEpoch: 3|  NKD Loss: 2.149 | CT Loss: 5.1392| [0m
[91mEpoch: 3|  Loss:  7.526 |Global loss: 9.8402| Local H loss: 0.0665  | Global H loss: 0.0608 [0m
[94mEpoch: 0|  NKD Loss: 2.1195 | CT Loss: 5.1656| [0m
[91mEpoch: 0|  Loss:  7.4275 |Global loss: 9.8418| Local H loss: 0.0769  | Global H loss: 0.069 [0m
[94mEpoch: 1|  NKD Loss: 2.1226 | CT Loss: 5.1647| [0m
[91mEpoch: 1|  Loss:  7.4352 |Global loss: 9.8455| Local H loss: 0.0763  | Global H loss: 0.0684 [0m
[94mEpoch: 2|  NKD Loss: 2.1205 | CT Loss: 5.1627| [0m
[91mEpoch: 2|  Loss:  7.4267 |Global loss: 9.8386| Local H loss: 0.0768  | Global H loss: 0.0689 [0m
[94mEpoch: 3|  NKD Loss: 2.1194 | CT Loss: 5.1611| [0m
[91mEpoch: 3|  Loss:  7.4244 |Global loss: 9.8392| Local H loss: 0.0771  | Global H loss: 0.069 [0m
[94mEpoch: 0|  NKD Loss: 2.1766 | CT Loss: 5.2011| [0m
[91mEpoch: 0|  Loss:  7.7251 |Global loss: 9.9148| Local H loss: 0.0479  | Global H loss: 0.049 [0m
[94mEpoch: 1|  NKD Loss: 2.1769 | CT Loss: 5.2009| [0m
[91mEpoch: 1|  Loss:  7.7274 |Global loss: 9.918| Local H loss: 0.0476  | Global H loss: 0.0488 [0m
[94mEpoch: 2|  NKD Loss: 2.1777 | CT Loss: 5.1981| [0m
[91mEpoch: 2|  Loss:  7.7152 |Global loss: 9.9179| Local H loss: 0.0494  | Global H loss: 0.0502 [0m
[94mEpoch: 3|  NKD Loss: 2.1727 | CT Loss: 5.1952| [0m
[91mEpoch: 3|  Loss:  7.7088 |Global loss: 9.9113| Local H loss: 0.0501  | Global H loss: 0.0503 [0m
------------------------- time cost ------------------------- 2.8037679195404053
Chosen Clients:  [3, 4, 10, 13, 0, 2]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.994, 119.977, 119.986, 118.993, 119.976, 119.298, 119.68, 118.995, 119.01, 119.905, 119.966, 119.845, 119.913, 119.094, 119.02]
F1 Score:  [0.973, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3845
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9676
Averaged Test Recal score: 0.9738
Std Test Accurancy: 0.0322
Std Test AUC: 0.0036
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1422 | CT Loss: 5.1936| [0m
[91mEpoch: 0|  Loss:  7.5247 |Global loss: 9.8835| Local H loss: 0.0606  | Global H loss: 0.0601 [0m
[94mEpoch: 1|  NKD Loss: 2.1356 | CT Loss: 5.1905| [0m
[91mEpoch: 1|  Loss:  7.5045 |Global loss: 9.8789| Local H loss: 0.0627  | Global H loss: 0.0616 [0m
[94mEpoch: 2|  NKD Loss: 2.1396 | CT Loss: 5.1889| [0m
[91mEpoch: 2|  Loss:  7.5112 |Global loss: 9.8826| Local H loss: 0.062  | Global H loss: 0.061 [0m
[94mEpoch: 3|  NKD Loss: 2.1308 | CT Loss: 5.1853| [0m
[91mEpoch: 3|  Loss:  7.4864 |Global loss: 9.8685| Local H loss: 0.065  | Global H loss: 0.063 [0m
[94mEpoch: 0|  NKD Loss: 2.1383 | CT Loss: 5.1397| [0m
[91mEpoch: 0|  Loss:  7.48 |Global loss: 9.8304| Local H loss: 0.0671  | Global H loss: 0.062 [0m
[94mEpoch: 1|  NKD Loss: 2.1386 | CT Loss: 5.1356| [0m
[91mEpoch: 1|  Loss:  7.4772 |Global loss: 9.8286| Local H loss: 0.0668  | Global H loss: 0.0621 [0m
[94mEpoch: 2|  NKD Loss: 2.1346 | CT Loss: 5.1362| [0m
[91mEpoch: 2|  Loss:  7.4643 |Global loss: 9.824| Local H loss: 0.0694  | Global H loss: 0.0632 [0m
[94mEpoch: 3|  NKD Loss: 2.1359 | CT Loss: 5.1328| [0m
[91mEpoch: 3|  Loss:  7.4686 |Global loss: 9.8193| Local H loss: 0.0679  | Global H loss: 0.0624 [0m
[94mEpoch: 0|  NKD Loss: 2.1496 | CT Loss: 5.1532| [0m
[91mEpoch: 0|  Loss:  7.5223 |Global loss: 9.8483| Local H loss: 0.0593  | Global H loss: 0.0579 [0m
[94mEpoch: 1|  NKD Loss: 2.1502 | CT Loss: 5.1526| [0m
[91mEpoch: 1|  Loss:  7.5151 |Global loss: 9.8477| Local H loss: 0.0597  | Global H loss: 0.0582 [0m
[94mEpoch: 2|  NKD Loss: 2.1485 | CT Loss: 5.1483| [0m
[91mEpoch: 2|  Loss:  7.5115 |Global loss: 9.8476| Local H loss: 0.0607  | Global H loss: 0.0585 [0m
[94mEpoch: 3|  NKD Loss: 2.1482 | CT Loss: 5.146| [0m
[91mEpoch: 3|  Loss:  7.5075 |Global loss: 9.8417| Local H loss: 0.0599  | Global H loss: 0.0582 [0m
[94mEpoch: 0|  NKD Loss: 2.1778 | CT Loss: 5.1943| [0m
[91mEpoch: 0|  Loss:  7.7079 |Global loss: 9.91| Local H loss: 0.05  | Global H loss: 0.0503 [0m
[94mEpoch: 1|  NKD Loss: 2.1718 | CT Loss: 5.1929| [0m
[91mEpoch: 1|  Loss:  7.6981 |Global loss: 9.9072| Local H loss: 0.0498  | Global H loss: 0.0503 [0m
[94mEpoch: 2|  NKD Loss: 2.1691 | CT Loss: 5.189| [0m
[91mEpoch: 2|  Loss:  7.6788 |Global loss: 9.9| Local H loss: 0.0525  | Global H loss: 0.0518 [0m
[94mEpoch: 3|  NKD Loss: 2.1716 | CT Loss: 5.1876| [0m
[91mEpoch: 3|  Loss:  7.6846 |Global loss: 9.8997| Local H loss: 0.0526  | Global H loss: 0.0518 [0m
[94mEpoch: 0|  NKD Loss: 2.1429 | CT Loss: 5.1381| [0m
[91mEpoch: 0|  Loss:  7.4881 |Global loss: 9.8327| Local H loss: 0.0631  | Global H loss: 0.0597 [0m
[94mEpoch: 1|  NKD Loss: 2.1517 | CT Loss: 5.1372| [0m
[91mEpoch: 1|  Loss:  7.5037 |Global loss: 9.84| Local H loss: 0.0619  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1439 | CT Loss: 5.1346| [0m
[91mEpoch: 2|  Loss:  7.4854 |Global loss: 9.827| Local H loss: 0.0632  | Global H loss: 0.0598 [0m
[94mEpoch: 3|  NKD Loss: 2.1431 | CT Loss: 5.1337| [0m
[91mEpoch: 3|  Loss:  7.4813 |Global loss: 9.8247| Local H loss: 0.063  | Global H loss: 0.0597 [0m
[94mEpoch: 0|  NKD Loss: 2.1424 | CT Loss: 5.1721| [0m
[91mEpoch: 0|  Loss:  7.5111 |Global loss: 9.8646| Local H loss: 0.0649  | Global H loss: 0.0611 [0m
[94mEpoch: 1|  NKD Loss: 2.1339 | CT Loss: 5.1692| [0m
[91mEpoch: 1|  Loss:  7.4856 |Global loss: 9.8562| Local H loss: 0.0672  | Global H loss: 0.0631 [0m
[94mEpoch: 2|  NKD Loss: 2.1272 | CT Loss: 5.1682| [0m
[91mEpoch: 2|  Loss:  7.4612 |Global loss: 9.8498| Local H loss: 0.0687  | Global H loss: 0.0643 [0m
[94mEpoch: 3|  NKD Loss: 2.1288 | CT Loss: 5.1661| [0m
[91mEpoch: 3|  Loss:  7.4618 |Global loss: 9.847| Local H loss: 0.07  | Global H loss: 0.0648 [0m
------------------------- time cost ------------------------- 2.8783340454101562
Chosen Clients:  [14, 1, 2, 3, 6, 10]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.982, 119.977, 119.984, 118.992, 119.98, 119.298, 119.68, 118.995, 119.01, 119.905, 119.968, 119.845, 119.913, 118.971, 119.02]
F1 Score:  [0.974, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3762
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9671
Averaged Test Recal score: 0.9731
Std Test Accurancy: 0.0320
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1202 | CT Loss: 5.1473| [0m
[91mEpoch: 0|  Loss:  7.4166 |Global loss: 9.8247| Local H loss: 0.0743  | Global H loss: 0.0676 [0m
[94mEpoch: 1|  NKD Loss: 2.1226 | CT Loss: 5.1439| [0m
[91mEpoch: 1|  Loss:  7.4184 |Global loss: 9.8259| Local H loss: 0.0724  | Global H loss: 0.0668 [0m
[94mEpoch: 2|  NKD Loss: 2.12 | CT Loss: 5.1429| [0m
[91mEpoch: 2|  Loss:  7.4103 |Global loss: 9.8173| Local H loss: 0.0736  | Global H loss: 0.0675 [0m
[94mEpoch: 3|  NKD Loss: 2.1307 | CT Loss: 5.1406| [0m
[91mEpoch: 3|  Loss:  7.4389 |Global loss: 9.8245| Local H loss: 0.0713  | Global H loss: 0.0654 [0m
[94mEpoch: 0|  NKD Loss: 2.1657 | CT Loss: 5.1623| [0m
[91mEpoch: 0|  Loss:  7.5909 |Global loss: 9.8766| Local H loss: 0.06  | Global H loss: 0.0581 [0m
[94mEpoch: 1|  NKD Loss: 2.1512 | CT Loss: 5.1601| [0m
[91mEpoch: 1|  Loss:  7.5374 |Global loss: 9.8573| Local H loss: 0.0607  | Global H loss: 0.0589 [0m
[94mEpoch: 2|  NKD Loss: 2.1374 | CT Loss: 5.1579| [0m
[91mEpoch: 2|  Loss:  7.4874 |Global loss: 9.8492| Local H loss: 0.0634  | Global H loss: 0.0611 [0m
[94mEpoch: 3|  NKD Loss: 2.1319 | CT Loss: 5.1549| [0m
[91mEpoch: 3|  Loss:  7.4737 |Global loss: 9.8378| Local H loss: 0.0638  | Global H loss: 0.0615 [0m
[94mEpoch: 0|  NKD Loss: 2.1404 | CT Loss: 5.1649| [0m
[91mEpoch: 0|  Loss:  7.4942 |Global loss: 9.8549| Local H loss: 0.0667  | Global H loss: 0.0624 [0m
[94mEpoch: 1|  NKD Loss: 2.1332 | CT Loss: 5.1632| [0m
[91mEpoch: 1|  Loss:  7.47 |Global loss: 9.8504| Local H loss: 0.0687  | Global H loss: 0.0639 [0m
[94mEpoch: 2|  NKD Loss: 2.1288 | CT Loss: 5.161| [0m
[91mEpoch: 2|  Loss:  7.4575 |Global loss: 9.841| Local H loss: 0.0698  | Global H loss: 0.0645 [0m
[94mEpoch: 3|  NKD Loss: 2.1392 | CT Loss: 5.1594| [0m
[91mEpoch: 3|  Loss:  7.4856 |Global loss: 9.8525| Local H loss: 0.0673  | Global H loss: 0.0626 [0m
[94mEpoch: 0|  NKD Loss: 2.1315 | CT Loss: 5.1842| [0m
[91mEpoch: 0|  Loss:  7.4847 |Global loss: 9.8708| Local H loss: 0.065  | Global H loss: 0.0631 [0m
[94mEpoch: 1|  NKD Loss: 2.1303 | CT Loss: 5.1828| [0m
[91mEpoch: 1|  Loss:  7.4809 |Global loss: 9.8652| Local H loss: 0.0655  | Global H loss: 0.0633 [0m
[94mEpoch: 2|  NKD Loss: 2.1289 | CT Loss: 5.1807| [0m
[91mEpoch: 2|  Loss:  7.4748 |Global loss: 9.8646| Local H loss: 0.0661  | Global H loss: 0.0638 [0m
[94mEpoch: 3|  NKD Loss: 2.1314 | CT Loss: 5.1782| [0m
[91mEpoch: 3|  Loss:  7.4787 |Global loss: 9.8625| Local H loss: 0.0658  | Global H loss: 0.0633 [0m
[94mEpoch: 0|  NKD Loss: 2.1579 | CT Loss: 5.191| [0m
[91mEpoch: 0|  Loss:  7.5632 |Global loss: 9.8935| Local H loss: 0.0534  | Global H loss: 0.0557 [0m
[94mEpoch: 1|  NKD Loss: 2.1545 | CT Loss: 5.1861| [0m
[91mEpoch: 1|  Loss:  7.5605 |Global loss: 9.8861| Local H loss: 0.0527  | Global H loss: 0.0551 [0m
[94mEpoch: 2|  NKD Loss: 2.1567 | CT Loss: 5.1842| [0m
[91mEpoch: 2|  Loss:  7.5555 |Global loss: 9.8825| Local H loss: 0.0537  | Global H loss: 0.0557 [0m
[94mEpoch: 3|  NKD Loss: 2.1614 | CT Loss: 5.1841| [0m
[91mEpoch: 3|  Loss:  7.5638 |Global loss: 9.8925| Local H loss: 0.0532  | Global H loss: 0.0554 [0m
[94mEpoch: 0|  NKD Loss: 2.1454 | CT Loss: 5.1479| [0m
[91mEpoch: 0|  Loss:  7.4977 |Global loss: 9.8405| Local H loss: 0.0627  | Global H loss: 0.0597 [0m
[94mEpoch: 1|  NKD Loss: 2.1455 | CT Loss: 5.1433| [0m
[91mEpoch: 1|  Loss:  7.4998 |Global loss: 9.8383| Local H loss: 0.061  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1406 | CT Loss: 5.1422| [0m
[91mEpoch: 2|  Loss:  7.4811 |Global loss: 9.8352| Local H loss: 0.0631  | Global H loss: 0.0603 [0m
[94mEpoch: 3|  NKD Loss: 2.143 | CT Loss: 5.14| [0m
[91mEpoch: 3|  Loss:  7.4823 |Global loss: 9.8349| Local H loss: 0.0625  | Global H loss: 0.0601 [0m
------------------------- time cost ------------------------- 3.0227248668670654
Chosen Clients:  [10, 13, 0, 7, 6, 8]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [118.982, 119.728, 119.982, 118.992, 119.98, 119.298, 119.884, 118.995, 119.01, 119.905, 119.967, 119.845, 119.913, 118.971, 119.049]
F1 Score:  [0.974, 0.878, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.973, 0.844, 0.974]
Recall Score:  [0.977, 0.903, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3802
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9602
Averaged Test Recal score: 0.9677
Std Test Accurancy: 0.0335
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1565 | CT Loss: 5.1389| [0m
[91mEpoch: 0|  Loss:  7.5161 |Global loss: 9.8424| Local H loss: 0.0576  | Global H loss: 0.0569 [0m
[94mEpoch: 1|  NKD Loss: 2.1431 | CT Loss: 5.1379| [0m
[91mEpoch: 1|  Loss:  7.4852 |Global loss: 9.8322| Local H loss: 0.0625  | Global H loss: 0.0596 [0m
[94mEpoch: 2|  NKD Loss: 2.1378 | CT Loss: 5.134| [0m
[91mEpoch: 2|  Loss:  7.4641 |Global loss: 9.8227| Local H loss: 0.0646  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1365 | CT Loss: 5.1314| [0m
[91mEpoch: 3|  Loss:  7.458 |Global loss: 9.8206| Local H loss: 0.0645  | Global H loss: 0.0613 [0m
[94mEpoch: 0|  NKD Loss: 2.1712 | CT Loss: 5.1851| [0m
[91mEpoch: 0|  Loss:  7.6901 |Global loss: 9.8958| Local H loss: 0.0527  | Global H loss: 0.0518 [0m
[94mEpoch: 1|  NKD Loss: 2.1712 | CT Loss: 5.1827| [0m
[91mEpoch: 1|  Loss:  7.6778 |Global loss: 9.9005| Local H loss: 0.0536  | Global H loss: 0.0523 [0m
[94mEpoch: 2|  NKD Loss: 2.1688 | CT Loss: 5.1812| [0m
[91mEpoch: 2|  Loss:  7.6721 |Global loss: 9.8934| Local H loss: 0.0528  | Global H loss: 0.0519 [0m
[94mEpoch: 3|  NKD Loss: 2.174 | CT Loss: 5.18| [0m
[91mEpoch: 3|  Loss:  7.6815 |Global loss: 9.8988| Local H loss: 0.0535  | Global H loss: 0.052 [0m
[94mEpoch: 0|  NKD Loss: 2.143 | CT Loss: 5.1316| [0m
[91mEpoch: 0|  Loss:  7.4744 |Global loss: 9.8265| Local H loss: 0.0635  | Global H loss: 0.0602 [0m
[94mEpoch: 1|  NKD Loss: 2.1439 | CT Loss: 5.1285| [0m
[91mEpoch: 1|  Loss:  7.472 |Global loss: 9.8237| Local H loss: 0.0631  | Global H loss: 0.0601 [0m
[94mEpoch: 2|  NKD Loss: 2.1372 | CT Loss: 5.1273| [0m
[91mEpoch: 2|  Loss:  7.457 |Global loss: 9.8169| Local H loss: 0.0655  | Global H loss: 0.0613 [0m
[94mEpoch: 3|  NKD Loss: 2.156 | CT Loss: 5.1279| [0m
[91mEpoch: 3|  Loss:  7.5118 |Global loss: 9.8335| Local H loss: 0.0615  | Global H loss: 0.0586 [0m
[94mEpoch: 0|  NKD Loss: 2.1203 | CT Loss: 5.1434| [0m
[91mEpoch: 0|  Loss:  7.4114 |Global loss: 9.8199| Local H loss: 0.075  | Global H loss: 0.0679 [0m
[94mEpoch: 1|  NKD Loss: 2.1214 | CT Loss: 5.1423| [0m
[91mEpoch: 1|  Loss:  7.4135 |Global loss: 9.8217| Local H loss: 0.0745  | Global H loss: 0.0675 [0m
[94mEpoch: 2|  NKD Loss: 2.1261 | CT Loss: 5.1385| [0m
[91mEpoch: 2|  Loss:  7.4237 |Global loss: 9.8214| Local H loss: 0.0725  | Global H loss: 0.0662 [0m
[94mEpoch: 3|  NKD Loss: 2.1173 | CT Loss: 5.1377| [0m
[91mEpoch: 3|  Loss:  7.4046 |Global loss: 9.8113| Local H loss: 0.0755  | Global H loss: 0.068 [0m
[94mEpoch: 0|  NKD Loss: 2.1452 | CT Loss: 5.1794| [0m
[91mEpoch: 0|  Loss:  7.5227 |Global loss: 9.8727| Local H loss: 0.0563  | Global H loss: 0.0579 [0m
[94mEpoch: 1|  NKD Loss: 2.146 | CT Loss: 5.177| [0m
[91mEpoch: 1|  Loss:  7.5185 |Global loss: 9.8741| Local H loss: 0.0577  | Global H loss: 0.0586 [0m
[94mEpoch: 2|  NKD Loss: 2.1501 | CT Loss: 5.1757| [0m
[91mEpoch: 2|  Loss:  7.5278 |Global loss: 9.8767| Local H loss: 0.0563  | Global H loss: 0.0577 [0m
[94mEpoch: 3|  NKD Loss: 2.1445 | CT Loss: 5.1759| [0m
[91mEpoch: 3|  Loss:  7.5116 |Global loss: 9.8724| Local H loss: 0.0593  | Global H loss: 0.0594 [0m
[94mEpoch: 0|  NKD Loss: 2.1365 | CT Loss: 5.1818| [0m
[91mEpoch: 0|  Loss:  7.4952 |Global loss: 9.871| Local H loss: 0.0624  | Global H loss: 0.0619 [0m
[94mEpoch: 1|  NKD Loss: 2.1351 | CT Loss: 5.1799| [0m
[91mEpoch: 1|  Loss:  7.4919 |Global loss: 9.8675| Local H loss: 0.0624  | Global H loss: 0.0618 [0m
[94mEpoch: 2|  NKD Loss: 2.1552 | CT Loss: 5.1787| [0m
[91mEpoch: 2|  Loss:  7.5531 |Global loss: 9.8837| Local H loss: 0.0574  | Global H loss: 0.0578 [0m
[94mEpoch: 3|  NKD Loss: 2.1326 | CT Loss: 5.1754| [0m
[91mEpoch: 3|  Loss:  7.4852 |Global loss: 9.8584| Local H loss: 0.0632  | Global H loss: 0.062 [0m
------------------------- time cost ------------------------- 3.0367541313171387
Chosen Clients:  [7, 14, 13, 12, 0, 11]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.858, 0.975]
AUC in each clients:  [118.996, 119.728, 119.982, 118.992, 119.98, 119.298, 119.934, 118.994, 119.049, 119.905, 119.967, 119.845, 119.913, 119.051, 119.049]
F1 Score:  [0.973, 0.878, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.973, 0.856, 0.974]
Recall Score:  [0.977, 0.903, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.899, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3686
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9609
Averaged Test Recal score: 0.9680
Std Test Accurancy: 0.0316
Std Test AUC: 0.0036
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1276 | CT Loss: 5.1363| [0m
[91mEpoch: 0|  Loss:  7.4211 |Global loss: 9.8231| Local H loss: 0.0733  | Global H loss: 0.0667 [0m
[94mEpoch: 1|  NKD Loss: 2.1233 | CT Loss: 5.1349| [0m
[91mEpoch: 1|  Loss:  7.415 |Global loss: 9.8171| Local H loss: 0.0735  | Global H loss: 0.0667 [0m
[94mEpoch: 2|  NKD Loss: 2.1158 | CT Loss: 5.134| [0m
[91mEpoch: 2|  Loss:  7.3938 |Global loss: 9.8121| Local H loss: 0.0775  | Global H loss: 0.069 [0m
[94mEpoch: 3|  NKD Loss: 2.1735 | CT Loss: 5.1331| [0m
[91mEpoch: 3|  Loss:  7.5504 |Global loss: 9.8558| Local H loss: 0.0638  | Global H loss: 0.0601 [0m
[94mEpoch: 0|  NKD Loss: 2.1239 | CT Loss: 5.1403| [0m
[91mEpoch: 0|  Loss:  7.4178 |Global loss: 9.8231| Local H loss: 0.0716  | Global H loss: 0.0664 [0m
[94mEpoch: 1|  NKD Loss: 2.1189 | CT Loss: 5.137| [0m
[91mEpoch: 1|  Loss:  7.4035 |Global loss: 9.8154| Local H loss: 0.0742  | Global H loss: 0.0678 [0m
[94mEpoch: 2|  NKD Loss: 2.1187 | CT Loss: 5.1346| [0m
[91mEpoch: 2|  Loss:  7.4013 |Global loss: 9.8105| Local H loss: 0.0739  | Global H loss: 0.0677 [0m
[94mEpoch: 3|  NKD Loss: 2.1186 | CT Loss: 5.1325| [0m
[91mEpoch: 3|  Loss:  7.3987 |Global loss: 9.8118| Local H loss: 0.0744  | Global H loss: 0.0678 [0m
[94mEpoch: 0|  NKD Loss: 2.1671 | CT Loss: 5.1773| [0m
[91mEpoch: 0|  Loss:  7.6492 |Global loss: 9.8889| Local H loss: 0.0552  | Global H loss: 0.0534 [0m
[94mEpoch: 1|  NKD Loss: 2.1638 | CT Loss: 5.1749| [0m
[91mEpoch: 1|  Loss:  7.6492 |Global loss: 9.8823| Local H loss: 0.0558  | Global H loss: 0.0535 [0m
[94mEpoch: 2|  NKD Loss: 2.166 | CT Loss: 5.1744| [0m
[91mEpoch: 2|  Loss:  7.6478 |Global loss: 9.8859| Local H loss: 0.056  | Global H loss: 0.054 [0m
[94mEpoch: 3|  NKD Loss: 2.1595 | CT Loss: 5.17| [0m
[91mEpoch: 3|  Loss:  7.6161 |Global loss: 9.8753| Local H loss: 0.0579  | Global H loss: 0.0551 [0m
[94mEpoch: 0|  NKD Loss: 2.1803 | CT Loss: 5.1991| [0m
[91mEpoch: 0|  Loss:  7.7039 |Global loss: 9.9185| Local H loss: 0.0427  | Global H loss: 0.0467 [0m
[94mEpoch: 1|  NKD Loss: 2.1837 | CT Loss: 5.1954| [0m
[91mEpoch: 1|  Loss:  7.7089 |Global loss: 9.9135| Local H loss: 0.0432  | Global H loss: 0.0469 [0m
[94mEpoch: 2|  NKD Loss: 2.1845 | CT Loss: 5.1951| [0m
[91mEpoch: 2|  Loss:  7.7158 |Global loss: 9.9181| Local H loss: 0.0431  | Global H loss: 0.047 [0m
[94mEpoch: 3|  NKD Loss: 2.1864 | CT Loss: 5.1908| [0m
[91mEpoch: 3|  Loss:  7.7154 |Global loss: 9.9148| Local H loss: 0.0426  | Global H loss: 0.0464 [0m
[94mEpoch: 0|  NKD Loss: 2.1393 | CT Loss: 5.1253| [0m
[91mEpoch: 0|  Loss:  7.4634 |Global loss: 9.8161| Local H loss: 0.0641  | Global H loss: 0.0605 [0m
[94mEpoch: 1|  NKD Loss: 2.1491 | CT Loss: 5.1242| [0m
[91mEpoch: 1|  Loss:  7.497 |Global loss: 9.8216| Local H loss: 0.0636  | Global H loss: 0.0594 [0m
[94mEpoch: 2|  NKD Loss: 2.1414 | CT Loss: 5.1233| [0m
[91mEpoch: 2|  Loss:  7.4663 |Global loss: 9.8173| Local H loss: 0.0651  | Global H loss: 0.0606 [0m
[94mEpoch: 3|  NKD Loss: 2.138 | CT Loss: 5.1205| [0m
[91mEpoch: 3|  Loss:  7.4522 |Global loss: 9.8119| Local H loss: 0.0661  | Global H loss: 0.0616 [0m
[94mEpoch: 0|  NKD Loss: 2.1235 | CT Loss: 5.1727| [0m
[91mEpoch: 0|  Loss:  7.4536 |Global loss: 9.8547| Local H loss: 0.071  | Global H loss: 0.066 [0m
[94mEpoch: 1|  NKD Loss: 2.1205 | CT Loss: 5.1709| [0m
[91mEpoch: 1|  Loss:  7.446 |Global loss: 9.8508| Local H loss: 0.0706  | Global H loss: 0.0662 [0m
[94mEpoch: 2|  NKD Loss: 2.1214 | CT Loss: 5.168| [0m
[91mEpoch: 2|  Loss:  7.4444 |Global loss: 9.8458| Local H loss: 0.071  | Global H loss: 0.0661 [0m
[94mEpoch: 3|  NKD Loss: 2.1192 | CT Loss: 5.1669| [0m
[91mEpoch: 3|  Loss:  7.4372 |Global loss: 9.8453| Local H loss: 0.0726  | Global H loss: 0.067 [0m
------------------------- time cost ------------------------- 2.9217848777770996
Chosen Clients:  [13, 4, 2, 6, 1, 14]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.917, 0.975]
AUC in each clients:  [119.059, 119.728, 119.982, 118.992, 119.98, 119.298, 119.934, 118.994, 119.049, 119.905, 119.967, 119.802, 119.924, 119.371, 119.049]
F1 Score:  [0.973, 0.878, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.967, 0.918, 0.974]
Recall Score:  [0.977, 0.903, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.971, 0.938, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3623
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9647
Averaged Test Recal score: 0.9702
Std Test Accurancy: 0.0194
Std Test AUC: 0.0034
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1586 | CT Loss: 5.1674| [0m
[91mEpoch: 0|  Loss:  7.6164 |Global loss: 9.8717| Local H loss: 0.0586  | Global H loss: 0.0552 [0m
[94mEpoch: 1|  NKD Loss: 2.1675 | CT Loss: 5.1663| [0m
[91mEpoch: 1|  Loss:  7.6419 |Global loss: 9.8783| Local H loss: 0.0573  | Global H loss: 0.0542 [0m
[94mEpoch: 2|  NKD Loss: 2.1575 | CT Loss: 5.1641| [0m
[91mEpoch: 2|  Loss:  7.6064 |Global loss: 9.8661| Local H loss: 0.0589  | Global H loss: 0.0554 [0m
[94mEpoch: 3|  NKD Loss: 2.1603 | CT Loss: 5.1621| [0m
[91mEpoch: 3|  Loss:  7.6176 |Global loss: 9.8735| Local H loss: 0.0591  | Global H loss: 0.0553 [0m
[94mEpoch: 0|  NKD Loss: 2.1398 | CT Loss: 5.1324| [0m
[91mEpoch: 0|  Loss:  7.4749 |Global loss: 9.8231| Local H loss: 0.0679  | Global H loss: 0.0624 [0m
[94mEpoch: 1|  NKD Loss: 2.1448 | CT Loss: 5.1301| [0m
[91mEpoch: 1|  Loss:  7.493 |Global loss: 9.8271| Local H loss: 0.065  | Global H loss: 0.0609 [0m
[94mEpoch: 2|  NKD Loss: 2.1407 | CT Loss: 5.1284| [0m
[91mEpoch: 2|  Loss:  7.4846 |Global loss: 9.8191| Local H loss: 0.0668  | Global H loss: 0.0614 [0m
[94mEpoch: 3|  NKD Loss: 2.1312 | CT Loss: 5.126| [0m
[91mEpoch: 3|  Loss:  7.4553 |Global loss: 9.8123| Local H loss: 0.0699  | Global H loss: 0.0632 [0m
[94mEpoch: 0|  NKD Loss: 2.1285 | CT Loss: 5.1577| [0m
[91mEpoch: 0|  Loss:  7.453 |Global loss: 9.8405| Local H loss: 0.0698  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1267 | CT Loss: 5.1564| [0m
[91mEpoch: 1|  Loss:  7.4476 |Global loss: 9.8399| Local H loss: 0.0708  | Global H loss: 0.0652 [0m
[94mEpoch: 2|  NKD Loss: 2.1222 | CT Loss: 5.1543| [0m
[91mEpoch: 2|  Loss:  7.4332 |Global loss: 9.8314| Local H loss: 0.0722  | Global H loss: 0.0663 [0m
[94mEpoch: 3|  NKD Loss: 2.1291 | CT Loss: 5.1528| [0m
[91mEpoch: 3|  Loss:  7.4496 |Global loss: 9.8415| Local H loss: 0.071  | Global H loss: 0.065 [0m
[94mEpoch: 0|  NKD Loss: 2.1402 | CT Loss: 5.1708| [0m
[91mEpoch: 0|  Loss:  7.5002 |Global loss: 9.8593| Local H loss: 0.0589  | Global H loss: 0.0594 [0m
[94mEpoch: 1|  NKD Loss: 2.1389 | CT Loss: 5.1681| [0m
[91mEpoch: 1|  Loss:  7.4937 |Global loss: 9.8619| Local H loss: 0.0595  | Global H loss: 0.0599 [0m
[94mEpoch: 2|  NKD Loss: 2.1409 | CT Loss: 5.1671| [0m
[91mEpoch: 2|  Loss:  7.4959 |Global loss: 9.8585| Local H loss: 0.0599  | Global H loss: 0.0599 [0m
[94mEpoch: 3|  NKD Loss: 2.1394 | CT Loss: 5.1655| [0m
[91mEpoch: 3|  Loss:  7.4921 |Global loss: 9.8564| Local H loss: 0.0603  | Global H loss: 0.06 [0m
[94mEpoch: 0|  NKD Loss: 2.139 | CT Loss: 5.1533| [0m
[91mEpoch: 0|  Loss:  7.4921 |Global loss: 9.8412| Local H loss: 0.0625  | Global H loss: 0.0605 [0m
[94mEpoch: 1|  NKD Loss: 2.1409 | CT Loss: 5.1523| [0m
[91mEpoch: 1|  Loss:  7.4941 |Global loss: 9.8437| Local H loss: 0.0622  | Global H loss: 0.0603 [0m
[94mEpoch: 2|  NKD Loss: 2.1311 | CT Loss: 5.1494| [0m
[91mEpoch: 2|  Loss:  7.4602 |Global loss: 9.832| Local H loss: 0.0648  | Global H loss: 0.0622 [0m
[94mEpoch: 3|  NKD Loss: 2.1315 | CT Loss: 5.1472| [0m
[91mEpoch: 3|  Loss:  7.4609 |Global loss: 9.8335| Local H loss: 0.065  | Global H loss: 0.0622 [0m
[94mEpoch: 0|  NKD Loss: 2.1206 | CT Loss: 5.1314| [0m
[91mEpoch: 0|  Loss:  7.4027 |Global loss: 9.8133| Local H loss: 0.0734  | Global H loss: 0.0671 [0m
[94mEpoch: 1|  NKD Loss: 2.1193 | CT Loss: 5.1304| [0m
[91mEpoch: 1|  Loss:  7.398 |Global loss: 9.8105| Local H loss: 0.0741  | Global H loss: 0.0677 [0m
[94mEpoch: 2|  NKD Loss: 2.1165 | CT Loss: 5.1281| [0m
[91mEpoch: 2|  Loss:  7.3899 |Global loss: 9.8027| Local H loss: 0.0753  | Global H loss: 0.0683 [0m
[94mEpoch: 3|  NKD Loss: 2.123 | CT Loss: 5.1267| [0m
[91mEpoch: 3|  Loss:  7.4042 |Global loss: 9.8072| Local H loss: 0.0726  | Global H loss: 0.0666 [0m
------------------------- time cost ------------------------- 2.8469254970550537
Chosen Clients:  [2, 10, 9, 3, 0, 14]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.85, 0.975]
AUC in each clients:  [119.059, 119.963, 119.98, 118.992, 119.979, 119.298, 119.956, 118.994, 119.049, 119.905, 119.967, 119.802, 119.924, 119.024, 118.971]
F1 Score:  [0.973, 0.973, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.967, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.971, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3387
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9666
Averaged Test Recal score: 0.9727
Std Test Accurancy: 0.0319
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1326 | CT Loss: 5.1522| [0m
[91mEpoch: 0|  Loss:  7.4592 |Global loss: 9.8389| Local H loss: 0.0698  | Global H loss: 0.0641 [0m
[94mEpoch: 1|  NKD Loss: 2.1566 | CT Loss: 5.1505| [0m
[91mEpoch: 1|  Loss:  7.5329 |Global loss: 9.8631| Local H loss: 0.0656  | Global H loss: 0.0609 [0m
[94mEpoch: 2|  NKD Loss: 2.1248 | CT Loss: 5.1487| [0m
[91mEpoch: 2|  Loss:  7.4396 |Global loss: 9.8288| Local H loss: 0.0697  | Global H loss: 0.0646 [0m
[94mEpoch: 3|  NKD Loss: 2.1198 | CT Loss: 5.1454| [0m
[91mEpoch: 3|  Loss:  7.4206 |Global loss: 9.8245| Local H loss: 0.0728  | Global H loss: 0.0665 [0m
[94mEpoch: 0|  NKD Loss: 2.1363 | CT Loss: 5.1294| [0m
[91mEpoch: 0|  Loss:  7.4602 |Global loss: 9.8216| Local H loss: 0.0644  | Global H loss: 0.061 [0m
[94mEpoch: 1|  NKD Loss: 2.1311 | CT Loss: 5.1279| [0m
[91mEpoch: 1|  Loss:  7.4411 |Global loss: 9.8125| Local H loss: 0.0664  | Global H loss: 0.0624 [0m
[94mEpoch: 2|  NKD Loss: 2.1317 | CT Loss: 5.1262| [0m
[91mEpoch: 2|  Loss:  7.4441 |Global loss: 9.8126| Local H loss: 0.066  | Global H loss: 0.0622 [0m
[94mEpoch: 3|  NKD Loss: 2.13 | CT Loss: 5.1231| [0m
[91mEpoch: 3|  Loss:  7.4349 |Global loss: 9.8096| Local H loss: 0.0666  | Global H loss: 0.0624 [0m
[94mEpoch: 0|  NKD Loss: 2.1148 | CT Loss: 5.159| [0m
[91mEpoch: 0|  Loss:  7.4163 |Global loss: 9.8349| Local H loss: 0.0781  | Global H loss: 0.0694 [0m
[94mEpoch: 1|  NKD Loss: 2.1167 | CT Loss: 5.157| [0m
[91mEpoch: 1|  Loss:  7.4171 |Global loss: 9.8345| Local H loss: 0.0769  | Global H loss: 0.069 [0m
[94mEpoch: 2|  NKD Loss: 2.1137 | CT Loss: 5.1554| [0m
[91mEpoch: 2|  Loss:  7.4104 |Global loss: 9.8267| Local H loss: 0.079  | Global H loss: 0.0697 [0m
[94mEpoch: 3|  NKD Loss: 2.115 | CT Loss: 5.1536| [0m
[91mEpoch: 3|  Loss:  7.4096 |Global loss: 9.8305| Local H loss: 0.0784  | Global H loss: 0.0696 [0m
[94mEpoch: 0|  NKD Loss: 2.1275 | CT Loss: 5.1772| [0m
[91mEpoch: 0|  Loss:  7.4703 |Global loss: 9.8634| Local H loss: 0.0662  | Global H loss: 0.0638 [0m
[94mEpoch: 1|  NKD Loss: 2.1263 | CT Loss: 5.1753| [0m
[91mEpoch: 1|  Loss:  7.4651 |Global loss: 9.8566| Local H loss: 0.0667  | Global H loss: 0.0641 [0m
[94mEpoch: 2|  NKD Loss: 2.1213 | CT Loss: 5.1726| [0m
[91mEpoch: 2|  Loss:  7.451 |Global loss: 9.8484| Local H loss: 0.0691  | Global H loss: 0.0654 [0m
[94mEpoch: 3|  NKD Loss: 2.138 | CT Loss: 5.173| [0m
[91mEpoch: 3|  Loss:  7.4892 |Global loss: 9.8619| Local H loss: 0.0634  | Global H loss: 0.0617 [0m
[94mEpoch: 0|  NKD Loss: 2.1425 | CT Loss: 5.1187| [0m
[91mEpoch: 0|  Loss:  7.4695 |Global loss: 9.8166| Local H loss: 0.0644  | Global H loss: 0.0604 [0m
[94mEpoch: 1|  NKD Loss: 2.1329 | CT Loss: 5.1159| [0m
[91mEpoch: 1|  Loss:  7.4383 |Global loss: 9.8034| Local H loss: 0.067  | Global H loss: 0.062 [0m
[94mEpoch: 2|  NKD Loss: 2.1317 | CT Loss: 5.1146| [0m
[91mEpoch: 2|  Loss:  7.4322 |Global loss: 9.8044| Local H loss: 0.0668  | Global H loss: 0.0622 [0m
[94mEpoch: 3|  NKD Loss: 2.1393 | CT Loss: 5.1134| [0m
[91mEpoch: 3|  Loss:  7.4534 |Global loss: 9.8039| Local H loss: 0.0657  | Global H loss: 0.0611 [0m
[94mEpoch: 0|  NKD Loss: 2.1167 | CT Loss: 5.1244| [0m
[91mEpoch: 0|  Loss:  7.389 |Global loss: 9.7995| Local H loss: 0.0749  | Global H loss: 0.068 [0m
[94mEpoch: 1|  NKD Loss: 2.1151 | CT Loss: 5.1223| [0m
[91mEpoch: 1|  Loss:  7.3815 |Global loss: 9.8013| Local H loss: 0.0761  | Global H loss: 0.0686 [0m
[94mEpoch: 2|  NKD Loss: 2.1187 | CT Loss: 5.121| [0m
[91mEpoch: 2|  Loss:  7.389 |Global loss: 9.802| Local H loss: 0.0738  | Global H loss: 0.0675 [0m
[94mEpoch: 3|  NKD Loss: 2.1207 | CT Loss: 5.1197| [0m
[91mEpoch: 3|  Loss:  7.3913 |Global loss: 9.7978| Local H loss: 0.0746  | Global H loss: 0.0674 [0m
------------------------- time cost ------------------------- 2.77801513671875
Chosen Clients:  [5, 8, 14, 12, 9, 0]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.967, 0.85, 0.975]
AUC in each clients:  [119.025, 119.963, 119.982, 118.994, 119.979, 119.298, 119.956, 118.994, 119.049, 119.818, 119.967, 119.802, 119.924, 119.024, 119.038]
F1 Score:  [0.973, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.967, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.971, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3347
Averaged Test Accurancy: 0.9678
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9661
Averaged Test Recal score: 0.9722
Std Test Accurancy: 0.0317
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1485 | CT Loss: 5.1607| [0m
[91mEpoch: 0|  Loss:  7.5338 |Global loss: 9.8631| Local H loss: 0.0579  | Global H loss: 0.0573 [0m
[94mEpoch: 1|  NKD Loss: 2.1396 | CT Loss: 5.158| [0m
[91mEpoch: 1|  Loss:  7.5036 |Global loss: 9.8496| Local H loss: 0.0602  | Global H loss: 0.059 [0m
[94mEpoch: 2|  NKD Loss: 2.1417 | CT Loss: 5.1557| [0m
[91mEpoch: 2|  Loss:  7.5051 |Global loss: 9.8474| Local H loss: 0.0606  | Global H loss: 0.0592 [0m
[94mEpoch: 3|  NKD Loss: 2.137 | CT Loss: 5.1554| [0m
[91mEpoch: 3|  Loss:  7.4876 |Global loss: 9.8465| Local H loss: 0.0618  | Global H loss: 0.0602 [0m
[94mEpoch: 0|  NKD Loss: 2.1295 | CT Loss: 5.1751| [0m
[91mEpoch: 0|  Loss:  7.4742 |Global loss: 9.8623| Local H loss: 0.0644  | Global H loss: 0.0631 [0m
[94mEpoch: 1|  NKD Loss: 2.1338 | CT Loss: 5.1711| [0m
[91mEpoch: 1|  Loss:  7.4852 |Global loss: 9.8578| Local H loss: 0.0638  | Global H loss: 0.0622 [0m
[94mEpoch: 2|  NKD Loss: 2.1277 | CT Loss: 5.1696| [0m
[91mEpoch: 2|  Loss:  7.4659 |Global loss: 9.8546| Local H loss: 0.065  | Global H loss: 0.0632 [0m
[94mEpoch: 3|  NKD Loss: 2.13 | CT Loss: 5.1682| [0m
[91mEpoch: 3|  Loss:  7.4715 |Global loss: 9.8517| Local H loss: 0.0654  | Global H loss: 0.0633 [0m
[94mEpoch: 0|  NKD Loss: 2.1149 | CT Loss: 5.1174| [0m
[91mEpoch: 0|  Loss:  7.3764 |Global loss: 9.7937| Local H loss: 0.0762  | Global H loss: 0.0686 [0m
[94mEpoch: 1|  NKD Loss: 2.1147 | CT Loss: 5.1141| [0m
[91mEpoch: 1|  Loss:  7.373 |Global loss: 9.7902| Local H loss: 0.0753  | Global H loss: 0.0684 [0m
[94mEpoch: 2|  NKD Loss: 2.1259 | CT Loss: 5.1161| [0m
[91mEpoch: 2|  Loss:  7.4038 |Global loss: 9.8009| Local H loss: 0.0715  | Global H loss: 0.0657 [0m
[94mEpoch: 3|  NKD Loss: 2.1174 | CT Loss: 5.1126| [0m
[91mEpoch: 3|  Loss:  7.379 |Global loss: 9.7921| Local H loss: 0.075  | Global H loss: 0.0678 [0m
[94mEpoch: 0|  NKD Loss: 2.1737 | CT Loss: 5.1884| [0m
[91mEpoch: 0|  Loss:  7.677 |Global loss: 9.9009| Local H loss: 0.0453  | Global H loss: 0.0486 [0m
[94mEpoch: 1|  NKD Loss: 2.1656 | CT Loss: 5.1882| [0m
[91mEpoch: 1|  Loss:  7.6523 |Global loss: 9.8972| Local H loss: 0.0482  | Global H loss: 0.0504 [0m
[94mEpoch: 2|  NKD Loss: 2.1732 | CT Loss: 5.1839| [0m
[91mEpoch: 2|  Loss:  7.6583 |Global loss: 9.9038| Local H loss: 0.047  | Global H loss: 0.0499 [0m
[94mEpoch: 3|  NKD Loss: 2.1644 | CT Loss: 5.1815| [0m
[91mEpoch: 3|  Loss:  7.6293 |Global loss: 9.8912| Local H loss: 0.0482  | Global H loss: 0.0508 [0m
[94mEpoch: 0|  NKD Loss: 2.1151 | CT Loss: 5.1533| [0m
[91mEpoch: 0|  Loss:  7.4114 |Global loss: 9.8327| Local H loss: 0.0781  | Global H loss: 0.0693 [0m
[94mEpoch: 1|  NKD Loss: 2.1133 | CT Loss: 5.1507| [0m
[91mEpoch: 1|  Loss:  7.4045 |Global loss: 9.8263| Local H loss: 0.0791  | Global H loss: 0.0699 [0m
[94mEpoch: 2|  NKD Loss: 2.1147 | CT Loss: 5.151| [0m
[91mEpoch: 2|  Loss:  7.4074 |Global loss: 9.8269| Local H loss: 0.0779  | Global H loss: 0.0693 [0m
[94mEpoch: 3|  NKD Loss: 2.1135 | CT Loss: 5.1482| [0m
[91mEpoch: 3|  Loss:  7.4018 |Global loss: 9.8277| Local H loss: 0.0794  | Global H loss: 0.07 [0m
[94mEpoch: 0|  NKD Loss: 2.1286 | CT Loss: 5.1112| [0m
[91mEpoch: 0|  Loss:  7.4195 |Global loss: 9.7995| Local H loss: 0.0682  | Global H loss: 0.0631 [0m
[94mEpoch: 1|  NKD Loss: 2.1344 | CT Loss: 5.111| [0m
[91mEpoch: 1|  Loss:  7.4346 |Global loss: 9.796| Local H loss: 0.0671  | Global H loss: 0.0623 [0m
[94mEpoch: 2|  NKD Loss: 2.1414 | CT Loss: 5.1096| [0m
[91mEpoch: 2|  Loss:  7.4477 |Global loss: 9.8101| Local H loss: 0.0659  | Global H loss: 0.0616 [0m
[94mEpoch: 3|  NKD Loss: 2.1303 | CT Loss: 5.1055| [0m
[91mEpoch: 3|  Loss:  7.4173 |Global loss: 9.7994| Local H loss: 0.0681  | Global H loss: 0.063 [0m
------------------------- time cost ------------------------- 2.8211941719055176
Chosen Clients:  [4, 8, 6, 0, 1, 12]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.958, 0.85, 0.975]
AUC in each clients:  [119.087, 119.963, 119.982, 118.994, 119.979, 119.309, 119.956, 118.994, 119.007, 119.91, 119.967, 119.802, 119.899, 119.024, 119.025]
F1 Score:  [0.973, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.96, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.963, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3273
Averaged Test Accurancy: 0.9672
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9656
Averaged Test Recal score: 0.9717
Std Test Accurancy: 0.0318
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1388 | CT Loss: 5.1245| [0m
[91mEpoch: 0|  Loss:  7.4747 |Global loss: 9.8218| Local H loss: 0.0675  | Global H loss: 0.0622 [0m
[94mEpoch: 1|  NKD Loss: 2.1292 | CT Loss: 5.1224| [0m
[91mEpoch: 1|  Loss:  7.4392 |Global loss: 9.8082| Local H loss: 0.068  | Global H loss: 0.0629 [0m
[94mEpoch: 2|  NKD Loss: 2.1337 | CT Loss: 5.1214| [0m
[91mEpoch: 2|  Loss:  7.4566 |Global loss: 9.8082| Local H loss: 0.0679  | Global H loss: 0.0623 [0m
[94mEpoch: 3|  NKD Loss: 2.1316 | CT Loss: 5.118| [0m
[91mEpoch: 3|  Loss:  7.4415 |Global loss: 9.8051| Local H loss: 0.0683  | Global H loss: 0.0629 [0m
[94mEpoch: 0|  NKD Loss: 2.1219 | CT Loss: 5.1654| [0m
[91mEpoch: 0|  Loss:  7.4473 |Global loss: 9.847| Local H loss: 0.0682  | Global H loss: 0.0651 [0m
[94mEpoch: 1|  NKD Loss: 2.1181 | CT Loss: 5.1628| [0m
[91mEpoch: 1|  Loss:  7.4353 |Global loss: 9.841| Local H loss: 0.07  | Global H loss: 0.0661 [0m
[94mEpoch: 2|  NKD Loss: 2.1281 | CT Loss: 5.163| [0m
[91mEpoch: 2|  Loss:  7.457 |Global loss: 9.8455| Local H loss: 0.0669  | Global H loss: 0.0642 [0m
[94mEpoch: 3|  NKD Loss: 2.1218 | CT Loss: 5.159| [0m
[91mEpoch: 3|  Loss:  7.4395 |Global loss: 9.8392| Local H loss: 0.0689  | Global H loss: 0.0653 [0m
[94mEpoch: 0|  NKD Loss: 2.1343 | CT Loss: 5.1621| [0m
[91mEpoch: 0|  Loss:  7.4759 |Global loss: 9.8483| Local H loss: 0.0626  | Global H loss: 0.0614 [0m
[94mEpoch: 1|  NKD Loss: 2.1347 | CT Loss: 5.1599| [0m
[91mEpoch: 1|  Loss:  7.4755 |Global loss: 9.8476| Local H loss: 0.0617  | Global H loss: 0.061 [0m
[94mEpoch: 2|  NKD Loss: 2.1295 | CT Loss: 5.1582| [0m
[91mEpoch: 2|  Loss:  7.4578 |Global loss: 9.8426| Local H loss: 0.0644  | Global H loss: 0.0626 [0m
[94mEpoch: 3|  NKD Loss: 2.1317 | CT Loss: 5.1556| [0m
[91mEpoch: 3|  Loss:  7.4631 |Global loss: 9.8445| Local H loss: 0.0621  | Global H loss: 0.0615 [0m
[94mEpoch: 0|  NKD Loss: 2.1292 | CT Loss: 5.1066| [0m
[91mEpoch: 0|  Loss:  7.4114 |Global loss: 9.7935| Local H loss: 0.0679  | Global H loss: 0.0633 [0m
[94mEpoch: 1|  NKD Loss: 2.129 | CT Loss: 5.1045| [0m
[91mEpoch: 1|  Loss:  7.412 |Global loss: 9.7882| Local H loss: 0.0683  | Global H loss: 0.0634 [0m
[94mEpoch: 2|  NKD Loss: 2.1348 | CT Loss: 5.1034| [0m
[91mEpoch: 2|  Loss:  7.4278 |Global loss: 9.7951| Local H loss: 0.0692  | Global H loss: 0.0632 [0m
[94mEpoch: 3|  NKD Loss: 2.1364 | CT Loss: 5.1007| [0m
[91mEpoch: 3|  Loss:  7.4337 |Global loss: 9.789| Local H loss: 0.0664  | Global H loss: 0.0617 [0m
[94mEpoch: 0|  NKD Loss: 2.1384 | CT Loss: 5.1447| [0m
[91mEpoch: 0|  Loss:  7.4804 |Global loss: 9.8402| Local H loss: 0.0638  | Global H loss: 0.0613 [0m
[94mEpoch: 1|  NKD Loss: 2.1536 | CT Loss: 5.1435| [0m
[91mEpoch: 1|  Loss:  7.5305 |Global loss: 9.852| Local H loss: 0.0624  | Global H loss: 0.0599 [0m
[94mEpoch: 2|  NKD Loss: 2.125 | CT Loss: 5.1424| [0m
[91mEpoch: 2|  Loss:  7.4433 |Global loss: 9.8226| Local H loss: 0.0656  | Global H loss: 0.0628 [0m
[94mEpoch: 3|  NKD Loss: 2.1211 | CT Loss: 5.1398| [0m
[91mEpoch: 3|  Loss:  7.4268 |Global loss: 9.8176| Local H loss: 0.0663  | Global H loss: 0.0637 [0m
[94mEpoch: 0|  NKD Loss: 2.162 | CT Loss: 5.1807| [0m
[91mEpoch: 0|  Loss:  7.6254 |Global loss: 9.8898| Local H loss: 0.05  | Global H loss: 0.0517 [0m
[94mEpoch: 1|  NKD Loss: 2.1634 | CT Loss: 5.1781| [0m
[91mEpoch: 1|  Loss:  7.6276 |Global loss: 9.8864| Local H loss: 0.05  | Global H loss: 0.0517 [0m
[94mEpoch: 2|  NKD Loss: 2.1569 | CT Loss: 5.1743| [0m
[91mEpoch: 2|  Loss:  7.5933 |Global loss: 9.8754| Local H loss: 0.0524  | Global H loss: 0.0537 [0m
[94mEpoch: 3|  NKD Loss: 2.1553 | CT Loss: 5.1716| [0m
[91mEpoch: 3|  Loss:  7.5888 |Global loss: 9.8766| Local H loss: 0.0525  | Global H loss: 0.0535 [0m
------------------------- time cost ------------------------- 2.8525779247283936
Chosen Clients:  [1, 0, 5, 9, 8, 12]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.858, 0.85, 0.975]
AUC in each clients:  [119.043, 119.969, 119.982, 118.994, 119.971, 119.309, 119.913, 118.994, 118.996, 119.91, 119.967, 119.802, 119.716, 119.024, 119.025]
F1 Score:  [0.973, 0.973, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.866, 0.844, 0.974]
Recall Score:  [0.977, 0.977, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.9, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3237
Averaged Test Accurancy: 0.9606
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9593
Averaged Test Recal score: 0.9675
Std Test Accurancy: 0.0419
Std Test AUC: 0.0036
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1267 | CT Loss: 5.1395| [0m
[91mEpoch: 0|  Loss:  7.4362 |Global loss: 9.8241| Local H loss: 0.0673  | Global H loss: 0.0637 [0m
[94mEpoch: 1|  NKD Loss: 2.1255 | CT Loss: 5.137| [0m
[91mEpoch: 1|  Loss:  7.435 |Global loss: 9.8206| Local H loss: 0.0672  | Global H loss: 0.0638 [0m
[94mEpoch: 2|  NKD Loss: 2.1333 | CT Loss: 5.1342| [0m
[91mEpoch: 2|  Loss:  7.4545 |Global loss: 9.8242| Local H loss: 0.0666  | Global H loss: 0.0627 [0m
[94mEpoch: 3|  NKD Loss: 2.1233 | CT Loss: 5.1334| [0m
[91mEpoch: 3|  Loss:  7.4271 |Global loss: 9.8166| Local H loss: 0.068  | Global H loss: 0.0641 [0m
[94mEpoch: 0|  NKD Loss: 2.1359 | CT Loss: 5.1009| [0m
[91mEpoch: 0|  Loss:  7.4311 |Global loss: 9.7913| Local H loss: 0.0669  | Global H loss: 0.0621 [0m
[94mEpoch: 1|  NKD Loss: 2.1276 | CT Loss: 5.098| [0m
[91mEpoch: 1|  Loss:  7.4066 |Global loss: 9.7795| Local H loss: 0.0692  | Global H loss: 0.0633 [0m
[94mEpoch: 2|  NKD Loss: 2.1265 | CT Loss: 5.0977| [0m
[91mEpoch: 2|  Loss:  7.4003 |Global loss: 9.7833| Local H loss: 0.0699  | Global H loss: 0.0639 [0m
[94mEpoch: 3|  NKD Loss: 2.1318 | CT Loss: 5.0954| [0m
[91mEpoch: 3|  Loss:  7.4179 |Global loss: 9.7823| Local H loss: 0.0681  | Global H loss: 0.0627 [0m
[94mEpoch: 0|  NKD Loss: 2.1499 | CT Loss: 5.1526| [0m
[91mEpoch: 0|  Loss:  7.5256 |Global loss: 9.8546| Local H loss: 0.0615  | Global H loss: 0.0595 [0m
[94mEpoch: 1|  NKD Loss: 2.1344 | CT Loss: 5.1508| [0m
[91mEpoch: 1|  Loss:  7.4837 |Global loss: 9.8343| Local H loss: 0.0621  | Global H loss: 0.0601 [0m
[94mEpoch: 2|  NKD Loss: 2.1336 | CT Loss: 5.1496| [0m
[91mEpoch: 2|  Loss:  7.4751 |Global loss: 9.8353| Local H loss: 0.0633  | Global H loss: 0.0609 [0m
[94mEpoch: 3|  NKD Loss: 2.1521 | CT Loss: 5.1471| [0m
[91mEpoch: 3|  Loss:  7.5304 |Global loss: 9.8529| Local H loss: 0.0609  | Global H loss: 0.0588 [0m
[94mEpoch: 0|  NKD Loss: 2.1141 | CT Loss: 5.1463| [0m
[91mEpoch: 0|  Loss:  7.4017 |Global loss: 9.8224| Local H loss: 0.0792  | Global H loss: 0.0697 [0m
[94mEpoch: 1|  NKD Loss: 2.1125 | CT Loss: 5.1437| [0m
[91mEpoch: 1|  Loss:  7.3972 |Global loss: 9.8163| Local H loss: 0.0793  | Global H loss: 0.0698 [0m
[94mEpoch: 2|  NKD Loss: 2.1118 | CT Loss: 5.144| [0m
[91mEpoch: 2|  Loss:  7.3959 |Global loss: 9.8189| Local H loss: 0.0798  | Global H loss: 0.07 [0m
[94mEpoch: 3|  NKD Loss: 2.1109 | CT Loss: 5.1413| [0m
[91mEpoch: 3|  Loss:  7.3907 |Global loss: 9.8133| Local H loss: 0.0803  | Global H loss: 0.0703 [0m
[94mEpoch: 0|  NKD Loss: 2.1199 | CT Loss: 5.1574| [0m
[91mEpoch: 0|  Loss:  7.4374 |Global loss: 9.8339| Local H loss: 0.0688  | Global H loss: 0.0651 [0m
[94mEpoch: 1|  NKD Loss: 2.1208 | CT Loss: 5.1561| [0m
[91mEpoch: 1|  Loss:  7.4337 |Global loss: 9.8359| Local H loss: 0.0692  | Global H loss: 0.0655 [0m
[94mEpoch: 2|  NKD Loss: 2.1294 | CT Loss: 5.1547| [0m
[91mEpoch: 2|  Loss:  7.4532 |Global loss: 9.8435| Local H loss: 0.0669  | Global H loss: 0.0638 [0m
[94mEpoch: 3|  NKD Loss: 2.1186 | CT Loss: 5.1519| [0m
[91mEpoch: 3|  Loss:  7.4257 |Global loss: 9.8298| Local H loss: 0.0698  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 2.1584 | CT Loss: 5.1709| [0m
[91mEpoch: 0|  Loss:  7.5955 |Global loss: 9.8771| Local H loss: 0.0517  | Global H loss: 0.0532 [0m
[94mEpoch: 1|  NKD Loss: 2.1622 | CT Loss: 5.1685| [0m
[91mEpoch: 1|  Loss:  7.6144 |Global loss: 9.8761| Local H loss: 0.0517  | Global H loss: 0.0527 [0m
[94mEpoch: 2|  NKD Loss: 2.1468 | CT Loss: 5.1651| [0m
[91mEpoch: 2|  Loss:  7.5543 |Global loss: 9.8593| Local H loss: 0.0563  | Global H loss: 0.0562 [0m
[94mEpoch: 3|  NKD Loss: 2.1426 | CT Loss: 5.1606| [0m
[91mEpoch: 3|  Loss:  7.5336 |Global loss: 9.855| Local H loss: 0.057  | Global H loss: 0.0568 [0m
------------------------- time cost ------------------------- 2.907336711883545
Chosen Clients:  [7, 2, 8, 3, 0, 11]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [119.098, 119.945, 119.982, 118.994, 119.971, 119.183, 119.913, 118.994, 118.995, 119.777, 119.967, 119.802, 119.971, 119.024, 119.025]
F1 Score:  [0.973, 0.983, 0.974, 0.973, 0.974, 0.972, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.844, 0.974]
Recall Score:  [0.977, 0.986, 0.977, 0.977, 0.977, 0.973, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3084
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9666
Averaged Test Recal score: 0.9725
Std Test Accurancy: 0.0318
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1147 | CT Loss: 5.131| [0m
[91mEpoch: 0|  Loss:  7.397 |Global loss: 9.808| Local H loss: 0.074  | Global H loss: 0.0674 [0m
[94mEpoch: 1|  NKD Loss: 2.1144 | CT Loss: 5.1289| [0m
[91mEpoch: 1|  Loss:  7.3923 |Global loss: 9.8055| Local H loss: 0.075  | Global H loss: 0.0677 [0m
[94mEpoch: 2|  NKD Loss: 2.1113 | CT Loss: 5.1272| [0m
[91mEpoch: 2|  Loss:  7.3841 |Global loss: 9.802| Local H loss: 0.077  | Global H loss: 0.0687 [0m
[94mEpoch: 3|  NKD Loss: 2.1298 | CT Loss: 5.1259| [0m
[91mEpoch: 3|  Loss:  7.421 |Global loss: 9.8125| Local H loss: 0.0715  | Global H loss: 0.0653 [0m
[94mEpoch: 0|  NKD Loss: 2.1184 | CT Loss: 5.1455| [0m
[91mEpoch: 0|  Loss:  7.4176 |Global loss: 9.8198| Local H loss: 0.0738  | Global H loss: 0.0669 [0m
[94mEpoch: 1|  NKD Loss: 2.12 | CT Loss: 5.1426| [0m
[91mEpoch: 1|  Loss:  7.421 |Global loss: 9.8203| Local H loss: 0.0729  | Global H loss: 0.0662 [0m
[94mEpoch: 2|  NKD Loss: 2.1373 | CT Loss: 5.142| [0m
[91mEpoch: 2|  Loss:  7.4713 |Global loss: 9.8412| Local H loss: 0.0692  | Global H loss: 0.0634 [0m
[94mEpoch: 3|  NKD Loss: 2.1148 | CT Loss: 5.1406| [0m
[91mEpoch: 3|  Loss:  7.406 |Global loss: 9.8143| Local H loss: 0.0737  | Global H loss: 0.0672 [0m
[94mEpoch: 0|  NKD Loss: 2.1151 | CT Loss: 5.1487| [0m
[91mEpoch: 0|  Loss:  7.4155 |Global loss: 9.8289| Local H loss: 0.0718  | Global H loss: 0.0668 [0m
[94mEpoch: 1|  NKD Loss: 2.1193 | CT Loss: 5.1483| [0m
[91mEpoch: 1|  Loss:  7.4241 |Global loss: 9.828| Local H loss: 0.0703  | Global H loss: 0.0659 [0m
[94mEpoch: 2|  NKD Loss: 2.12 | CT Loss: 5.1474| [0m
[91mEpoch: 2|  Loss:  7.4212 |Global loss: 9.8326| Local H loss: 0.0717  | Global H loss: 0.0666 [0m
[94mEpoch: 3|  NKD Loss: 2.1127 | CT Loss: 5.1448| [0m
[91mEpoch: 3|  Loss:  7.4045 |Global loss: 9.821| Local H loss: 0.0731  | Global H loss: 0.0676 [0m
[94mEpoch: 0|  NKD Loss: 2.1184 | CT Loss: 5.1688| [0m
[91mEpoch: 0|  Loss:  7.4452 |Global loss: 9.8493| Local H loss: 0.0687  | Global H loss: 0.0652 [0m
[94mEpoch: 1|  NKD Loss: 2.1227 | CT Loss: 5.1671| [0m
[91mEpoch: 1|  Loss:  7.4541 |Global loss: 9.8435| Local H loss: 0.0679  | Global H loss: 0.0644 [0m
[94mEpoch: 2|  NKD Loss: 2.1149 | CT Loss: 5.1632| [0m
[91mEpoch: 2|  Loss:  7.4303 |Global loss: 9.8402| Local H loss: 0.0709  | Global H loss: 0.0664 [0m
[94mEpoch: 3|  NKD Loss: 2.1148 | CT Loss: 5.1621| [0m
[91mEpoch: 3|  Loss:  7.4292 |Global loss: 9.8371| Local H loss: 0.0711  | Global H loss: 0.0664 [0m
[94mEpoch: 0|  NKD Loss: 2.1397 | CT Loss: 5.0955| [0m
[91mEpoch: 0|  Loss:  7.4413 |Global loss: 9.7904| Local H loss: 0.0669  | Global H loss: 0.0618 [0m
[94mEpoch: 1|  NKD Loss: 2.1215 | CT Loss: 5.093| [0m
[91mEpoch: 1|  Loss:  7.384 |Global loss: 9.7713| Local H loss: 0.071  | Global H loss: 0.0646 [0m
[94mEpoch: 2|  NKD Loss: 2.1219 | CT Loss: 5.0904| [0m
[91mEpoch: 2|  Loss:  7.3836 |Global loss: 9.7702| Local H loss: 0.0707  | Global H loss: 0.0645 [0m
[94mEpoch: 3|  NKD Loss: 2.1277 | CT Loss: 5.0928| [0m
[91mEpoch: 3|  Loss:  7.3989 |Global loss: 9.7784| Local H loss: 0.0707  | Global H loss: 0.0642 [0m
[94mEpoch: 0|  NKD Loss: 2.1141 | CT Loss: 5.1635| [0m
[91mEpoch: 0|  Loss:  7.4284 |Global loss: 9.8392| Local H loss: 0.0725  | Global H loss: 0.067 [0m
[94mEpoch: 1|  NKD Loss: 2.1136 | CT Loss: 5.1625| [0m
[91mEpoch: 1|  Loss:  7.4258 |Global loss: 9.8414| Local H loss: 0.0732  | Global H loss: 0.0673 [0m
[94mEpoch: 2|  NKD Loss: 2.113 | CT Loss: 5.1606| [0m
[91mEpoch: 2|  Loss:  7.4219 |Global loss: 9.8382| Local H loss: 0.0728  | Global H loss: 0.0674 [0m
[94mEpoch: 3|  NKD Loss: 2.1122 | CT Loss: 5.1581| [0m
[91mEpoch: 3|  Loss:  7.4184 |Global loss: 9.8267| Local H loss: 0.0743  | Global H loss: 0.0676 [0m
------------------------- time cost ------------------------- 2.9405436515808105
Chosen Clients:  [3, 6, 2, 12, 9, 10]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [119.138, 119.945, 119.981, 118.994, 119.971, 119.183, 119.913, 118.994, 118.997, 119.777, 119.967, 119.893, 119.971, 119.024, 119.025]
F1 Score:  [0.973, 0.983, 0.974, 0.973, 0.974, 0.972, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.844, 0.974]
Recall Score:  [0.977, 0.986, 0.977, 0.977, 0.977, 0.973, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.3000
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9666
Averaged Test Recal score: 0.9725
Std Test Accurancy: 0.0318
Std Test AUC: 0.0037
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1176 | CT Loss: 5.1611| [0m
[91mEpoch: 0|  Loss:  7.4359 |Global loss: 9.8372| Local H loss: 0.07  | Global H loss: 0.0656 [0m
[94mEpoch: 1|  NKD Loss: 2.1254 | CT Loss: 5.162| [0m
[91mEpoch: 1|  Loss:  7.4509 |Global loss: 9.8486| Local H loss: 0.0686  | Global H loss: 0.0649 [0m
[94mEpoch: 2|  NKD Loss: 2.1127 | CT Loss: 5.1579| [0m
[91mEpoch: 2|  Loss:  7.4199 |Global loss: 9.8369| Local H loss: 0.0723  | Global H loss: 0.0671 [0m
[94mEpoch: 3|  NKD Loss: 2.1139 | CT Loss: 5.1568| [0m
[91mEpoch: 3|  Loss:  7.422 |Global loss: 9.8328| Local H loss: 0.0723  | Global H loss: 0.0668 [0m
[94mEpoch: 0|  NKD Loss: 2.1369 | CT Loss: 5.1566| [0m
[91mEpoch: 0|  Loss:  7.4807 |Global loss: 9.8518| Local H loss: 0.0635  | Global H loss: 0.0613 [0m
[94mEpoch: 1|  NKD Loss: 2.126 | CT Loss: 5.1529| [0m
[91mEpoch: 1|  Loss:  7.4463 |Global loss: 9.8365| Local H loss: 0.066  | Global H loss: 0.0634 [0m
[94mEpoch: 2|  NKD Loss: 2.1246 | CT Loss: 5.1494| [0m
[91mEpoch: 2|  Loss:  7.4417 |Global loss: 9.8343| Local H loss: 0.0644  | Global H loss: 0.063 [0m
[94mEpoch: 3|  NKD Loss: 2.1234 | CT Loss: 5.1465| [0m
[91mEpoch: 3|  Loss:  7.4355 |Global loss: 9.8293| Local H loss: 0.0656  | Global H loss: 0.0635 [0m
[94mEpoch: 0|  NKD Loss: 2.1231 | CT Loss: 5.1384| [0m
[91mEpoch: 0|  Loss:  7.4278 |Global loss: 9.8195| Local H loss: 0.0721  | Global H loss: 0.0654 [0m
[94mEpoch: 1|  NKD Loss: 2.1542 | CT Loss: 5.1395| [0m
[91mEpoch: 1|  Loss:  7.5274 |Global loss: 9.8508| Local H loss: 0.0658  | Global H loss: 0.0618 [0m
[94mEpoch: 2|  NKD Loss: 2.1299 | CT Loss: 5.1378| [0m
[91mEpoch: 2|  Loss:  7.4477 |Global loss: 9.8235| Local H loss: 0.068  | Global H loss: 0.0632 [0m
[94mEpoch: 3|  NKD Loss: 2.1168 | CT Loss: 5.1354| [0m
[91mEpoch: 3|  Loss:  7.4068 |Global loss: 9.8192| Local H loss: 0.0729  | Global H loss: 0.0666 [0m
[94mEpoch: 0|  NKD Loss: 2.1478 | CT Loss: 5.1607| [0m
[91mEpoch: 0|  Loss:  7.5497 |Global loss: 9.8589| Local H loss: 0.0558  | Global H loss: 0.0559 [0m
[94mEpoch: 1|  NKD Loss: 2.1447 | CT Loss: 5.1578| [0m
[91mEpoch: 1|  Loss:  7.543 |Global loss: 9.854| Local H loss: 0.057  | Global H loss: 0.0565 [0m
[94mEpoch: 2|  NKD Loss: 2.1435 | CT Loss: 5.1565| [0m
[91mEpoch: 2|  Loss:  7.5342 |Global loss: 9.8506| Local H loss: 0.0569  | Global H loss: 0.0565 [0m
[94mEpoch: 3|  NKD Loss: 2.1387 | CT Loss: 5.1538| [0m
[91mEpoch: 3|  Loss:  7.5151 |Global loss: 9.8433| Local H loss: 0.0597  | Global H loss: 0.0581 [0m
[94mEpoch: 0|  NKD Loss: 2.1084 | CT Loss: 5.1421| [0m
[91mEpoch: 0|  Loss:  7.388 |Global loss: 9.8167| Local H loss: 0.0809  | Global H loss: 0.0706 [0m
[94mEpoch: 1|  NKD Loss: 2.1104 | CT Loss: 5.1394| [0m
[91mEpoch: 1|  Loss:  7.3888 |Global loss: 9.8182| Local H loss: 0.0796  | Global H loss: 0.0701 [0m
[94mEpoch: 2|  NKD Loss: 2.1079 | CT Loss: 5.1375| [0m
[91mEpoch: 2|  Loss:  7.3833 |Global loss: 9.8152| Local H loss: 0.0801  | Global H loss: 0.0703 [0m
[94mEpoch: 3|  NKD Loss: 2.1092 | CT Loss: 5.1357| [0m
[91mEpoch: 3|  Loss:  7.3841 |Global loss: 9.8093| Local H loss: 0.0794  | Global H loss: 0.07 [0m
[94mEpoch: 0|  NKD Loss: 2.1292 | CT Loss: 5.1222| [0m
[91mEpoch: 0|  Loss:  7.4355 |Global loss: 9.8118| Local H loss: 0.0659  | Global H loss: 0.0623 [0m
[94mEpoch: 1|  NKD Loss: 2.1337 | CT Loss: 5.1211| [0m
[91mEpoch: 1|  Loss:  7.4486 |Global loss: 9.8087| Local H loss: 0.0637  | Global H loss: 0.0608 [0m
[94mEpoch: 2|  NKD Loss: 2.1226 | CT Loss: 5.1192| [0m
[91mEpoch: 2|  Loss:  7.414 |Global loss: 9.7975| Local H loss: 0.0678  | Global H loss: 0.0637 [0m
[94mEpoch: 3|  NKD Loss: 2.1342 | CT Loss: 5.1209| [0m
[91mEpoch: 3|  Loss:  7.4492 |Global loss: 9.8115| Local H loss: 0.0646  | Global H loss: 0.0611 [0m
------------------------- time cost ------------------------- 2.84108829498291
Chosen Clients:  [2, 5, 6, 1, 14, 4]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.975, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [119.138, 119.945, 119.988, 118.993, 119.971, 119.183, 119.822, 118.994, 118.997, 119.726, 119.91, 119.893, 119.972, 119.024, 119.025]
F1 Score:  [0.973, 0.983, 0.982, 0.973, 0.974, 0.972, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.844, 0.974]
Recall Score:  [0.977, 0.986, 0.984, 0.977, 0.977, 0.973, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2973
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9671
Averaged Test Recal score: 0.9730
Std Test Accurancy: 0.0320
Std Test AUC: 0.0036
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1151 | CT Loss: 5.1337| [0m
[91mEpoch: 0|  Loss:  7.4012 |Global loss: 9.8156| Local H loss: 0.0748  | Global H loss: 0.0675 [0m
[94mEpoch: 1|  NKD Loss: 2.1194 | CT Loss: 5.1318| [0m
[91mEpoch: 1|  Loss:  7.4095 |Global loss: 9.8167| Local H loss: 0.0734  | Global H loss: 0.0664 [0m
[94mEpoch: 2|  NKD Loss: 2.1244 | CT Loss: 5.1297| [0m
[91mEpoch: 2|  Loss:  7.4228 |Global loss: 9.8188| Local H loss: 0.0725  | Global H loss: 0.0658 [0m
[94mEpoch: 3|  NKD Loss: 2.1176 | CT Loss: 5.1297| [0m
[91mEpoch: 3|  Loss:  7.4038 |Global loss: 9.8068| Local H loss: 0.0738  | Global H loss: 0.0666 [0m
[94mEpoch: 0|  NKD Loss: 2.128 | CT Loss: 5.1446| [0m
[91mEpoch: 0|  Loss:  7.4593 |Global loss: 9.8336| Local H loss: 0.0634  | Global H loss: 0.0614 [0m
[94mEpoch: 1|  NKD Loss: 2.1297 | CT Loss: 5.1433| [0m
[91mEpoch: 1|  Loss:  7.4632 |Global loss: 9.8311| Local H loss: 0.0639  | Global H loss: 0.0615 [0m
[94mEpoch: 2|  NKD Loss: 2.1343 | CT Loss: 5.1418| [0m
[91mEpoch: 2|  Loss:  7.4725 |Global loss: 9.8343| Local H loss: 0.0638  | Global H loss: 0.0612 [0m
[94mEpoch: 3|  NKD Loss: 2.1305 | CT Loss: 5.1404| [0m
[91mEpoch: 3|  Loss:  7.4631 |Global loss: 9.8324| Local H loss: 0.0636  | Global H loss: 0.0609 [0m
[94mEpoch: 0|  NKD Loss: 2.1246 | CT Loss: 5.1455| [0m
[91mEpoch: 0|  Loss:  7.4349 |Global loss: 9.8277| Local H loss: 0.0662  | Global H loss: 0.0637 [0m
[94mEpoch: 1|  NKD Loss: 2.1258 | CT Loss: 5.1435| [0m
[91mEpoch: 1|  Loss:  7.4374 |Global loss: 9.8299| Local H loss: 0.0656  | Global H loss: 0.0633 [0m
[94mEpoch: 2|  NKD Loss: 2.1297 | CT Loss: 5.1416| [0m
[91mEpoch: 2|  Loss:  7.4488 |Global loss: 9.8311| Local H loss: 0.0643  | Global H loss: 0.0621 [0m
[94mEpoch: 3|  NKD Loss: 2.1173 | CT Loss: 5.1417| [0m
[91mEpoch: 3|  Loss:  7.4142 |Global loss: 9.8237| Local H loss: 0.0691  | Global H loss: 0.0655 [0m
[94mEpoch: 0|  NKD Loss: 2.1171 | CT Loss: 5.1302| [0m
[91mEpoch: 0|  Loss:  7.4058 |Global loss: 9.8059| Local H loss: 0.0691  | Global H loss: 0.0653 [0m
[94mEpoch: 1|  NKD Loss: 2.1266 | CT Loss: 5.1289| [0m
[91mEpoch: 1|  Loss:  7.4254 |Global loss: 9.8164| Local H loss: 0.0683  | Global H loss: 0.0643 [0m
[94mEpoch: 2|  NKD Loss: 2.1152 | CT Loss: 5.1257| [0m
[91mEpoch: 2|  Loss:  7.3979 |Global loss: 9.8042| Local H loss: 0.0688  | Global H loss: 0.0653 [0m
[94mEpoch: 3|  NKD Loss: 2.1169 | CT Loss: 5.1251| [0m
[91mEpoch: 3|  Loss:  7.4003 |Global loss: 9.8057| Local H loss: 0.07  | Global H loss: 0.0655 [0m
[94mEpoch: 0|  NKD Loss: 2.1164 | CT Loss: 5.1116| [0m
[91mEpoch: 0|  Loss:  7.3799 |Global loss: 9.7914| Local H loss: 0.0736  | Global H loss: 0.0671 [0m
[94mEpoch: 1|  NKD Loss: 2.1093 | CT Loss: 5.1096| [0m
[91mEpoch: 1|  Loss:  7.3602 |Global loss: 9.7869| Local H loss: 0.0768  | Global H loss: 0.0691 [0m
[94mEpoch: 2|  NKD Loss: 2.1108 | CT Loss: 5.1082| [0m
[91mEpoch: 2|  Loss:  7.3632 |Global loss: 9.7831| Local H loss: 0.0758  | Global H loss: 0.0685 [0m
[94mEpoch: 3|  NKD Loss: 2.1222 | CT Loss: 5.1076| [0m
[91mEpoch: 3|  Loss:  7.3892 |Global loss: 9.7916| Local H loss: 0.0729  | Global H loss: 0.0663 [0m
[94mEpoch: 0|  NKD Loss: 2.1278 | CT Loss: 5.1172| [0m
[91mEpoch: 0|  Loss:  7.4352 |Global loss: 9.8014| Local H loss: 0.0691  | Global H loss: 0.0633 [0m
[94mEpoch: 1|  NKD Loss: 2.1346 | CT Loss: 5.1162| [0m
[91mEpoch: 1|  Loss:  7.4574 |Global loss: 9.8129| Local H loss: 0.0685  | Global H loss: 0.0627 [0m
[94mEpoch: 2|  NKD Loss: 2.1282 | CT Loss: 5.1161| [0m
[91mEpoch: 2|  Loss:  7.4392 |Global loss: 9.8055| Local H loss: 0.0687  | Global H loss: 0.063 [0m
[94mEpoch: 3|  NKD Loss: 2.1245 | CT Loss: 5.1128| [0m
[91mEpoch: 3|  Loss:  7.422 |Global loss: 9.799| Local H loss: 0.0687  | Global H loss: 0.0635 [0m
------------------------- time cost ------------------------- 2.8701653480529785
Chosen Clients:  [6, 13, 0, 7, 5, 12]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.85, 0.975]
AUC in each clients:  [119.138, 119.967, 119.988, 118.993, 119.978, 119.412, 119.973, 118.994, 118.997, 119.726, 119.91, 119.893, 119.972, 119.024, 119.024]
F1 Score:  [0.973, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.844, 0.974]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.978, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2884
Averaged Test Accurancy: 0.9689
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9671
Averaged Test Recal score: 0.9731
Std Test Accurancy: 0.0320
Std Test AUC: 0.0036
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1199 | CT Loss: 5.1367| [0m
[91mEpoch: 0|  Loss:  7.4189 |Global loss: 9.8195| Local H loss: 0.0675  | Global H loss: 0.0644 [0m
[94mEpoch: 1|  NKD Loss: 2.1229 | CT Loss: 5.134| [0m
[91mEpoch: 1|  Loss:  7.4224 |Global loss: 9.8178| Local H loss: 0.0657  | Global H loss: 0.0635 [0m
[94mEpoch: 2|  NKD Loss: 2.118 | CT Loss: 5.1323| [0m
[91mEpoch: 2|  Loss:  7.4113 |Global loss: 9.8134| Local H loss: 0.0681  | Global H loss: 0.0646 [0m
[94mEpoch: 3|  NKD Loss: 2.1163 | CT Loss: 5.1306| [0m
[91mEpoch: 3|  Loss:  7.4055 |Global loss: 9.8112| Local H loss: 0.0686  | Global H loss: 0.0651 [0m
[94mEpoch: 0|  NKD Loss: 2.1566 | CT Loss: 5.1617| [0m
[91mEpoch: 0|  Loss:  7.6186 |Global loss: 9.8703| Local H loss: 0.0586  | Global H loss: 0.0549 [0m
[94mEpoch: 1|  NKD Loss: 2.1567 | CT Loss: 5.1585| [0m
[91mEpoch: 1|  Loss:  7.6181 |Global loss: 9.8639| Local H loss: 0.0588  | Global H loss: 0.0549 [0m
[94mEpoch: 2|  NKD Loss: 2.1518 | CT Loss: 5.1567| [0m
[91mEpoch: 2|  Loss:  7.5934 |Global loss: 9.8635| Local H loss: 0.06  | Global H loss: 0.0559 [0m
[94mEpoch: 3|  NKD Loss: 2.1534 | CT Loss: 5.1539| [0m
[91mEpoch: 3|  Loss:  7.5952 |Global loss: 9.8618| Local H loss: 0.0601  | Global H loss: 0.0558 [0m
[94mEpoch: 0|  NKD Loss: 2.1189 | CT Loss: 5.0882| [0m
[91mEpoch: 0|  Loss:  7.373 |Global loss: 9.7703| Local H loss: 0.0713  | Global H loss: 0.0651 [0m
[94mEpoch: 1|  NKD Loss: 2.1203 | CT Loss: 5.0879| [0m
[91mEpoch: 1|  Loss:  7.3777 |Global loss: 9.769| Local H loss: 0.071  | Global H loss: 0.0648 [0m
[94mEpoch: 2|  NKD Loss: 2.121 | CT Loss: 5.0867| [0m
[91mEpoch: 2|  Loss:  7.3767 |Global loss: 9.7716| Local H loss: 0.0708  | Global H loss: 0.0647 [0m
[94mEpoch: 3|  NKD Loss: 2.1195 | CT Loss: 5.0864| [0m
[91mEpoch: 3|  Loss:  7.3748 |Global loss: 9.7659| Local H loss: 0.0712  | Global H loss: 0.0647 [0m
[94mEpoch: 0|  NKD Loss: 2.1181 | CT Loss: 5.1253| [0m
[91mEpoch: 0|  Loss:  7.4018 |Global loss: 9.8107| Local H loss: 0.0737  | Global H loss: 0.0666 [0m
[94mEpoch: 1|  NKD Loss: 2.1077 | CT Loss: 5.1235| [0m
[91mEpoch: 1|  Loss:  7.3733 |Global loss: 9.7981| Local H loss: 0.0785  | Global H loss: 0.0694 [0m
[94mEpoch: 2|  NKD Loss: 2.1077 | CT Loss: 5.1213| [0m
[91mEpoch: 2|  Loss:  7.3726 |Global loss: 9.7998| Local H loss: 0.0778  | Global H loss: 0.0691 [0m
[94mEpoch: 3|  NKD Loss: 2.1078 | CT Loss: 5.1202| [0m
[91mEpoch: 3|  Loss:  7.3716 |Global loss: 9.7978| Local H loss: 0.0771  | Global H loss: 0.0689 [0m
[94mEpoch: 0|  NKD Loss: 2.1308 | CT Loss: 5.1384| [0m
[91mEpoch: 0|  Loss:  7.4625 |Global loss: 9.8274| Local H loss: 0.0645  | Global H loss: 0.0615 [0m
[94mEpoch: 1|  NKD Loss: 2.1231 | CT Loss: 5.1366| [0m
[91mEpoch: 1|  Loss:  7.4357 |Global loss: 9.8201| Local H loss: 0.0666  | Global H loss: 0.0631 [0m
[94mEpoch: 2|  NKD Loss: 2.1421 | CT Loss: 5.1347| [0m
[91mEpoch: 2|  Loss:  7.4919 |Global loss: 9.8358| Local H loss: 0.0642  | Global H loss: 0.0605 [0m
[94mEpoch: 3|  NKD Loss: 2.124 | CT Loss: 5.1333| [0m
[91mEpoch: 3|  Loss:  7.4377 |Global loss: 9.8207| Local H loss: 0.0669  | Global H loss: 0.0628 [0m
[94mEpoch: 0|  NKD Loss: 2.1451 | CT Loss: 5.1523| [0m
[91mEpoch: 0|  Loss:  7.5384 |Global loss: 9.85| Local H loss: 0.0579  | Global H loss: 0.0571 [0m
[94mEpoch: 1|  NKD Loss: 2.1463 | CT Loss: 5.1526| [0m
[91mEpoch: 1|  Loss:  7.5538 |Global loss: 9.8598| Local H loss: 0.0579  | Global H loss: 0.0564 [0m
[94mEpoch: 2|  NKD Loss: 2.1354 | CT Loss: 5.1486| [0m
[91mEpoch: 2|  Loss:  7.5109 |Global loss: 9.8385| Local H loss: 0.0593  | Global H loss: 0.0579 [0m
[94mEpoch: 3|  NKD Loss: 2.1493 | CT Loss: 5.1453| [0m
[91mEpoch: 3|  Loss:  7.5471 |Global loss: 9.8504| Local H loss: 0.0576  | Global H loss: 0.0568 [0m
------------------------- time cost ------------------------- 2.866593837738037
Chosen Clients:  [9, 0, 2, 7, 4, 6]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.867, 0.892, 0.975]
AUC in each clients:  [119.174, 119.967, 119.988, 118.993, 119.978, 119.358, 119.932, 118.992, 118.997, 119.726, 119.91, 119.893, 119.696, 119.14, 119.024]
F1 Score:  [0.973, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.878, 0.894, 0.974]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.906, 0.921, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2863
Averaged Test Accurancy: 0.9644
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9640
Averaged Test Recal score: 0.9701
Std Test Accurancy: 0.0339
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1078 | CT Loss: 5.1347| [0m
[91mEpoch: 0|  Loss:  7.3821 |Global loss: 9.808| Local H loss: 0.08  | Global H loss: 0.0701 [0m
[94mEpoch: 1|  NKD Loss: 2.1076 | CT Loss: 5.1333| [0m
[91mEpoch: 1|  Loss:  7.3808 |Global loss: 9.8119| Local H loss: 0.0789  | Global H loss: 0.0698 [0m
[94mEpoch: 2|  NKD Loss: 2.1067 | CT Loss: 5.1309| [0m
[91mEpoch: 2|  Loss:  7.3776 |Global loss: 9.8047| Local H loss: 0.0797  | Global H loss: 0.07 [0m
[94mEpoch: 3|  NKD Loss: 2.1062 | CT Loss: 5.1314| [0m
[91mEpoch: 3|  Loss:  7.3763 |Global loss: 9.8075| Local H loss: 0.0805  | Global H loss: 0.0704 [0m
[94mEpoch: 0|  NKD Loss: 2.1203 | CT Loss: 5.0824| [0m
[91mEpoch: 0|  Loss:  7.3754 |Global loss: 9.7676| Local H loss: 0.0711  | Global H loss: 0.0646 [0m
[94mEpoch: 1|  NKD Loss: 2.1235 | CT Loss: 5.0828| [0m
[91mEpoch: 1|  Loss:  7.3857 |Global loss: 9.772| Local H loss: 0.0706  | Global H loss: 0.0642 [0m
[94mEpoch: 2|  NKD Loss: 2.1178 | CT Loss: 5.0807| [0m
[91mEpoch: 2|  Loss:  7.3645 |Global loss: 9.7638| Local H loss: 0.0714  | Global H loss: 0.0652 [0m
[94mEpoch: 3|  NKD Loss: 2.1187 | CT Loss: 5.0819| [0m
[91mEpoch: 3|  Loss:  7.366 |Global loss: 9.7667| Local H loss: 0.073  | Global H loss: 0.0657 [0m
[94mEpoch: 0|  NKD Loss: 2.1181 | CT Loss: 5.1282| [0m
[91mEpoch: 0|  Loss:  7.4038 |Global loss: 9.8115| Local H loss: 0.0739  | Global H loss: 0.0666 [0m
[94mEpoch: 1|  NKD Loss: 2.1283 | CT Loss: 5.1275| [0m
[91mEpoch: 1|  Loss:  7.4356 |Global loss: 9.8191| Local H loss: 0.0702  | Global H loss: 0.064 [0m
[94mEpoch: 2|  NKD Loss: 2.1395 | CT Loss: 5.1276| [0m
[91mEpoch: 2|  Loss:  7.4724 |Global loss: 9.8295| Local H loss: 0.0669  | Global H loss: 0.0617 [0m
[94mEpoch: 3|  NKD Loss: 2.1263 | CT Loss: 5.1269| [0m
[91mEpoch: 3|  Loss:  7.4348 |Global loss: 9.8156| Local H loss: 0.0693  | Global H loss: 0.0637 [0m
[94mEpoch: 0|  NKD Loss: 2.114 | CT Loss: 5.1183| [0m
[91mEpoch: 0|  Loss:  7.3843 |Global loss: 9.7976| Local H loss: 0.074  | Global H loss: 0.0672 [0m
[94mEpoch: 1|  NKD Loss: 2.1092 | CT Loss: 5.1177| [0m
[91mEpoch: 1|  Loss:  7.3722 |Global loss: 9.7929| Local H loss: 0.0767  | Global H loss: 0.0686 [0m
[94mEpoch: 2|  NKD Loss: 2.1066 | CT Loss: 5.1153| [0m
[91mEpoch: 2|  Loss:  7.3641 |Global loss: 9.7903| Local H loss: 0.0776  | Global H loss: 0.0692 [0m
[94mEpoch: 3|  NKD Loss: 2.1209 | CT Loss: 5.1167| [0m
[91mEpoch: 3|  Loss:  7.3961 |Global loss: 9.8021| Local H loss: 0.0736  | Global H loss: 0.0666 [0m
[94mEpoch: 0|  NKD Loss: 2.1215 | CT Loss: 5.1122| [0m
[91mEpoch: 0|  Loss:  7.4124 |Global loss: 9.8004| Local H loss: 0.07  | Global H loss: 0.0643 [0m
[94mEpoch: 1|  NKD Loss: 2.1267 | CT Loss: 5.1107| [0m
[91mEpoch: 1|  Loss:  7.4312 |Global loss: 9.7945| Local H loss: 0.0687  | Global H loss: 0.0632 [0m
[94mEpoch: 2|  NKD Loss: 2.1243 | CT Loss: 5.1078| [0m
[91mEpoch: 2|  Loss:  7.4206 |Global loss: 9.7951| Local H loss: 0.0703  | Global H loss: 0.0641 [0m
[94mEpoch: 3|  NKD Loss: 2.1203 | CT Loss: 5.1058| [0m
[91mEpoch: 3|  Loss:  7.4136 |Global loss: 9.7894| Local H loss: 0.0716  | Global H loss: 0.0644 [0m
[94mEpoch: 0|  NKD Loss: 2.1134 | CT Loss: 5.1264| [0m
[91mEpoch: 0|  Loss:  7.3957 |Global loss: 9.8044| Local H loss: 0.0696  | Global H loss: 0.0656 [0m
[94mEpoch: 1|  NKD Loss: 2.1192 | CT Loss: 5.126| [0m
[91mEpoch: 1|  Loss:  7.4123 |Global loss: 9.8085| Local H loss: 0.0681  | Global H loss: 0.0641 [0m
[94mEpoch: 2|  NKD Loss: 2.1189 | CT Loss: 5.1241| [0m
[91mEpoch: 2|  Loss:  7.4032 |Global loss: 9.8057| Local H loss: 0.0681  | Global H loss: 0.0647 [0m
[94mEpoch: 3|  NKD Loss: 2.1132 | CT Loss: 5.1226| [0m
[91mEpoch: 3|  Loss:  7.3898 |Global loss: 9.8007| Local H loss: 0.0706  | Global H loss: 0.066 [0m
------------------------- time cost ------------------------- 2.903085470199585
Chosen Clients:  [3, 7, 12, 11, 13, 1]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.867, 0.892, 0.975]
AUC in each clients:  [119.345, 119.967, 119.976, 118.993, 119.983, 119.358, 119.939, 118.993, 118.997, 119.707, 119.91, 119.893, 119.696, 119.14, 119.024]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.878, 0.894, 0.974]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.906, 0.921, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2827
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9645
Averaged Test Recal score: 0.9706
Std Test Accurancy: 0.0342
Std Test AUC: 0.0034
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.11 | CT Loss: 5.1532| [0m
[91mEpoch: 0|  Loss:  7.4135 |Global loss: 9.8301| Local H loss: 0.072  | Global H loss: 0.0669 [0m
[94mEpoch: 1|  NKD Loss: 2.1081 | CT Loss: 5.1513| [0m
[91mEpoch: 1|  Loss:  7.4074 |Global loss: 9.8285| Local H loss: 0.0729  | Global H loss: 0.0674 [0m
[94mEpoch: 2|  NKD Loss: 2.1092 | CT Loss: 5.149| [0m
[91mEpoch: 2|  Loss:  7.4087 |Global loss: 9.8225| Local H loss: 0.072  | Global H loss: 0.0669 [0m
[94mEpoch: 3|  NKD Loss: 2.1059 | CT Loss: 5.1468| [0m
[91mEpoch: 3|  Loss:  7.4008 |Global loss: 9.8214| Local H loss: 0.0737  | Global H loss: 0.0676 [0m
[94mEpoch: 0|  NKD Loss: 2.1086 | CT Loss: 5.1136| [0m
[91mEpoch: 0|  Loss:  7.3667 |Global loss: 9.7888| Local H loss: 0.0773  | Global H loss: 0.0689 [0m
[94mEpoch: 1|  NKD Loss: 2.1089 | CT Loss: 5.1108| [0m
[91mEpoch: 1|  Loss:  7.3652 |Global loss: 9.7891| Local H loss: 0.0763  | Global H loss: 0.0685 [0m
[94mEpoch: 2|  NKD Loss: 2.1096 | CT Loss: 5.1112| [0m
[91mEpoch: 2|  Loss:  7.3698 |Global loss: 9.7873| Local H loss: 0.0762  | Global H loss: 0.0681 [0m
[94mEpoch: 3|  NKD Loss: 2.104 | CT Loss: 5.1085| [0m
[91mEpoch: 3|  Loss:  7.3534 |Global loss: 9.781| Local H loss: 0.0786  | Global H loss: 0.0696 [0m
[94mEpoch: 0|  NKD Loss: 2.1403 | CT Loss: 5.1433| [0m
[91mEpoch: 0|  Loss:  7.5291 |Global loss: 9.8412| Local H loss: 0.058  | Global H loss: 0.057 [0m
[94mEpoch: 1|  NKD Loss: 2.1353 | CT Loss: 5.1431| [0m
[91mEpoch: 1|  Loss:  7.5067 |Global loss: 9.8331| Local H loss: 0.0593  | Global H loss: 0.058 [0m
[94mEpoch: 2|  NKD Loss: 2.1372 | CT Loss: 5.1407| [0m
[91mEpoch: 2|  Loss:  7.5054 |Global loss: 9.8368| Local H loss: 0.0599  | Global H loss: 0.0585 [0m
[94mEpoch: 3|  NKD Loss: 2.1672 | CT Loss: 5.1406| [0m
[91mEpoch: 3|  Loss:  7.6134 |Global loss: 9.8587| Local H loss: 0.0537  | Global H loss: 0.0535 [0m
[94mEpoch: 0|  NKD Loss: 2.1095 | CT Loss: 5.1569| [0m
[91mEpoch: 0|  Loss:  7.415 |Global loss: 9.836| Local H loss: 0.073  | Global H loss: 0.0674 [0m
[94mEpoch: 1|  NKD Loss: 2.1059 | CT Loss: 5.1548| [0m
[91mEpoch: 1|  Loss:  7.4048 |Global loss: 9.8253| Local H loss: 0.0748  | Global H loss: 0.0683 [0m
[94mEpoch: 2|  NKD Loss: 2.1089 | CT Loss: 5.1529| [0m
[91mEpoch: 2|  Loss:  7.4096 |Global loss: 9.8322| Local H loss: 0.0742  | Global H loss: 0.0679 [0m
[94mEpoch: 3|  NKD Loss: 2.1066 | CT Loss: 5.1514| [0m
[91mEpoch: 3|  Loss:  7.4038 |Global loss: 9.8263| Local H loss: 0.0743  | Global H loss: 0.068 [0m
[94mEpoch: 0|  NKD Loss: 2.1562 | CT Loss: 5.1523| [0m
[91mEpoch: 0|  Loss:  7.6069 |Global loss: 9.8641| Local H loss: 0.0598  | Global H loss: 0.0557 [0m
[94mEpoch: 1|  NKD Loss: 2.1441 | CT Loss: 5.1503| [0m
[91mEpoch: 1|  Loss:  7.5706 |Global loss: 9.8491| Local H loss: 0.0613  | Global H loss: 0.0568 [0m
[94mEpoch: 2|  NKD Loss: 2.1469 | CT Loss: 5.1483| [0m
[91mEpoch: 2|  Loss:  7.5688 |Global loss: 9.8494| Local H loss: 0.0616  | Global H loss: 0.0568 [0m
[94mEpoch: 3|  NKD Loss: 2.1508 | CT Loss: 5.1466| [0m
[91mEpoch: 3|  Loss:  7.5855 |Global loss: 9.8488| Local H loss: 0.0603  | Global H loss: 0.0561 [0m
[94mEpoch: 0|  NKD Loss: 2.1121 | CT Loss: 5.1224| [0m
[91mEpoch: 0|  Loss:  7.3893 |Global loss: 9.8022| Local H loss: 0.0705  | Global H loss: 0.066 [0m
[94mEpoch: 1|  NKD Loss: 2.11 | CT Loss: 5.1203| [0m
[91mEpoch: 1|  Loss:  7.3821 |Global loss: 9.7964| Local H loss: 0.0712  | Global H loss: 0.0665 [0m
[94mEpoch: 2|  NKD Loss: 2.1127 | CT Loss: 5.1185| [0m
[91mEpoch: 2|  Loss:  7.3843 |Global loss: 9.793| Local H loss: 0.0715  | Global H loss: 0.0664 [0m
[94mEpoch: 3|  NKD Loss: 2.1079 | CT Loss: 5.1182| [0m
[91mEpoch: 3|  Loss:  7.3748 |Global loss: 9.7912| Local H loss: 0.0719  | Global H loss: 0.067 [0m
------------------------- time cost ------------------------- 2.987774133682251
Chosen Clients:  [4, 1, 2, 13, 6, 5]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.975, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.917, 0.883, 0.975]
AUC in each clients:  [119.345, 119.939, 119.976, 118.993, 119.983, 119.358, 119.939, 118.992, 118.997, 119.707, 119.91, 119.77, 119.768, 119.069, 119.024]
F1 Score:  [0.973, 0.973, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.92, 0.895, 0.974]
Recall Score:  [0.977, 0.977, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.93, 0.899, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2792
Averaged Test Accurancy: 0.9672
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9669
Averaged Test Recal score: 0.9703
Std Test Accurancy: 0.0273
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1201 | CT Loss: 5.1033| [0m
[91mEpoch: 0|  Loss:  7.4114 |Global loss: 9.7842| Local H loss: 0.0704  | Global H loss: 0.0641 [0m
[94mEpoch: 1|  NKD Loss: 2.115 | CT Loss: 5.1024| [0m
[91mEpoch: 1|  Loss:  7.3901 |Global loss: 9.7809| Local H loss: 0.0719  | Global H loss: 0.0652 [0m
[94mEpoch: 2|  NKD Loss: 2.1166 | CT Loss: 5.1008| [0m
[91mEpoch: 2|  Loss:  7.3906 |Global loss: 9.7829| Local H loss: 0.0711  | Global H loss: 0.0649 [0m
[94mEpoch: 3|  NKD Loss: 2.1148 | CT Loss: 5.1024| [0m
[91mEpoch: 3|  Loss:  7.3879 |Global loss: 9.7874| Local H loss: 0.0725  | Global H loss: 0.0656 [0m
[94mEpoch: 0|  NKD Loss: 2.1143 | CT Loss: 5.1166| [0m
[91mEpoch: 0|  Loss:  7.3877 |Global loss: 9.8003| Local H loss: 0.0718  | Global H loss: 0.0664 [0m
[94mEpoch: 1|  NKD Loss: 2.1348 | CT Loss: 5.1144| [0m
[91mEpoch: 1|  Loss:  7.4445 |Global loss: 9.8155| Local H loss: 0.0684  | Global H loss: 0.0637 [0m
[94mEpoch: 2|  NKD Loss: 2.1095 | CT Loss: 5.1133| [0m
[91mEpoch: 2|  Loss:  7.375 |Global loss: 9.7913| Local H loss: 0.0703  | Global H loss: 0.0662 [0m
[94mEpoch: 3|  NKD Loss: 2.1372 | CT Loss: 5.1133| [0m
[91mEpoch: 3|  Loss:  7.458 |Global loss: 9.8091| Local H loss: 0.0675  | Global H loss: 0.0625 [0m
[94mEpoch: 0|  NKD Loss: 2.1136 | CT Loss: 5.1249| [0m
[91mEpoch: 0|  Loss:  7.394 |Global loss: 9.808| Local H loss: 0.0731  | Global H loss: 0.0667 [0m
[94mEpoch: 1|  NKD Loss: 2.1179 | CT Loss: 5.1215| [0m
[91mEpoch: 1|  Loss:  7.4028 |Global loss: 9.7988| Local H loss: 0.0718  | Global H loss: 0.0654 [0m
[94mEpoch: 2|  NKD Loss: 2.1171 | CT Loss: 5.1205| [0m
[91mEpoch: 2|  Loss:  7.3996 |Global loss: 9.8072| Local H loss: 0.0746  | Global H loss: 0.067 [0m
[94mEpoch: 3|  NKD Loss: 2.1082 | CT Loss: 5.1189| [0m
[91mEpoch: 3|  Loss:  7.3755 |Global loss: 9.7976| Local H loss: 0.0759  | Global H loss: 0.0681 [0m
[94mEpoch: 0|  NKD Loss: 2.1542 | CT Loss: 5.1456| [0m
[91mEpoch: 0|  Loss:  7.593 |Global loss: 9.8525| Local H loss: 0.0601  | Global H loss: 0.056 [0m
[94mEpoch: 1|  NKD Loss: 2.1438 | CT Loss: 5.143| [0m
[91mEpoch: 1|  Loss:  7.5616 |Global loss: 9.8444| Local H loss: 0.0614  | Global H loss: 0.0569 [0m
[94mEpoch: 2|  NKD Loss: 2.1445 | CT Loss: 5.141| [0m
[91mEpoch: 2|  Loss:  7.5537 |Global loss: 9.841| Local H loss: 0.0621  | Global H loss: 0.0572 [0m
[94mEpoch: 3|  NKD Loss: 2.1452 | CT Loss: 5.1395| [0m
[91mEpoch: 3|  Loss:  7.5596 |Global loss: 9.845| Local H loss: 0.0627  | Global H loss: 0.0574 [0m
[94mEpoch: 0|  NKD Loss: 2.1101 | CT Loss: 5.1201| [0m
[91mEpoch: 0|  Loss:  7.3839 |Global loss: 9.7995| Local H loss: 0.0709  | Global H loss: 0.0661 [0m
[94mEpoch: 1|  NKD Loss: 2.1151 | CT Loss: 5.1179| [0m
[91mEpoch: 1|  Loss:  7.3955 |Global loss: 9.7958| Local H loss: 0.069  | Global H loss: 0.0647 [0m
[94mEpoch: 2|  NKD Loss: 2.1159 | CT Loss: 5.1165| [0m
[91mEpoch: 2|  Loss:  7.3898 |Global loss: 9.8038| Local H loss: 0.0691  | Global H loss: 0.0653 [0m
[94mEpoch: 3|  NKD Loss: 2.1097 | CT Loss: 5.1127| [0m
[91mEpoch: 3|  Loss:  7.3756 |Global loss: 9.7881| Local H loss: 0.0703  | Global H loss: 0.066 [0m
[94mEpoch: 0|  NKD Loss: 2.1251 | CT Loss: 5.1319| [0m
[91mEpoch: 0|  Loss:  7.44 |Global loss: 9.8189| Local H loss: 0.0667  | Global H loss: 0.0627 [0m
[94mEpoch: 1|  NKD Loss: 2.124 | CT Loss: 5.1305| [0m
[91mEpoch: 1|  Loss:  7.434 |Global loss: 9.8165| Local H loss: 0.0664  | Global H loss: 0.0628 [0m
[94mEpoch: 2|  NKD Loss: 2.1194 | CT Loss: 5.1283| [0m
[91mEpoch: 2|  Loss:  7.421 |Global loss: 9.8129| Local H loss: 0.0675  | Global H loss: 0.0637 [0m
[94mEpoch: 3|  NKD Loss: 2.126 | CT Loss: 5.1281| [0m
[91mEpoch: 3|  Loss:  7.4366 |Global loss: 9.8224| Local H loss: 0.0666  | Global H loss: 0.0627 [0m
------------------------- time cost ------------------------- 2.8191208839416504
Chosen Clients:  [11, 13, 9, 2, 0, 10]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.917, 0.883, 0.975]
AUC in each clients:  [119.345, 119.786, 119.983, 118.993, 119.984, 119.25, 119.926, 118.992, 118.997, 119.707, 119.91, 119.77, 119.768, 119.043, 119.024]
F1 Score:  [0.973, 0.878, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.92, 0.886, 0.974]
Recall Score:  [0.977, 0.903, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.93, 0.916, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2928
Averaged Test Accurancy: 0.9639
Averaged Test AUC: 0.9958
Averaged Test F1_score: 0.9599
Averaged Test Recal score: 0.9665
Std Test Accurancy: 0.0291
Std Test AUC: 0.0033
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.109 | CT Loss: 5.1505| [0m
[91mEpoch: 0|  Loss:  7.4102 |Global loss: 9.8267| Local H loss: 0.0728  | Global H loss: 0.0672 [0m
[94mEpoch: 1|  NKD Loss: 2.1055 | CT Loss: 5.1475| [0m
[91mEpoch: 1|  Loss:  7.4001 |Global loss: 9.8212| Local H loss: 0.0746  | Global H loss: 0.068 [0m
[94mEpoch: 2|  NKD Loss: 2.1027 | CT Loss: 5.1451| [0m
[91mEpoch: 2|  Loss:  7.3911 |Global loss: 9.8167| Local H loss: 0.0757  | Global H loss: 0.0687 [0m
[94mEpoch: 3|  NKD Loss: 2.1017 | CT Loss: 5.1431| [0m
[91mEpoch: 3|  Loss:  7.3874 |Global loss: 9.8154| Local H loss: 0.0762  | Global H loss: 0.0688 [0m
[94mEpoch: 0|  NKD Loss: 2.1462 | CT Loss: 5.1378| [0m
[91mEpoch: 0|  Loss:  7.5711 |Global loss: 9.8441| Local H loss: 0.0623  | Global H loss: 0.0566 [0m
[94mEpoch: 1|  NKD Loss: 2.1437 | CT Loss: 5.1367| [0m
[91mEpoch: 1|  Loss:  7.5465 |Global loss: 9.8392| Local H loss: 0.0624  | Global H loss: 0.0573 [0m
[94mEpoch: 2|  NKD Loss: 2.1628 | CT Loss: 5.1341| [0m
[91mEpoch: 2|  Loss:  7.6094 |Global loss: 9.8526| Local H loss: 0.0597  | Global H loss: 0.0554 [0m
[94mEpoch: 3|  NKD Loss: 2.1374 | CT Loss: 5.131| [0m
[91mEpoch: 3|  Loss:  7.5326 |Global loss: 9.8296| Local H loss: 0.0628  | Global H loss: 0.0576 [0m
[94mEpoch: 0|  NKD Loss: 2.1057 | CT Loss: 5.13| [0m
[91mEpoch: 0|  Loss:  7.3746 |Global loss: 9.8092| Local H loss: 0.0788  | Global H loss: 0.0699 [0m
[94mEpoch: 1|  NKD Loss: 2.1037 | CT Loss: 5.1274| [0m
[91mEpoch: 1|  Loss:  7.3697 |Global loss: 9.806| Local H loss: 0.0798  | Global H loss: 0.0702 [0m
[94mEpoch: 2|  NKD Loss: 2.102 | CT Loss: 5.1272| [0m
[91mEpoch: 2|  Loss:  7.3668 |Global loss: 9.8019| Local H loss: 0.0807  | Global H loss: 0.0706 [0m
[94mEpoch: 3|  NKD Loss: 2.1017 | CT Loss: 5.1241| [0m
[91mEpoch: 3|  Loss:  7.3627 |Global loss: 9.7956| Local H loss: 0.0804  | Global H loss: 0.0705 [0m
[94mEpoch: 0|  NKD Loss: 2.1128 | CT Loss: 5.1177| [0m
[91mEpoch: 0|  Loss:  7.3851 |Global loss: 9.7961| Local H loss: 0.0751  | Global H loss: 0.0673 [0m
[94mEpoch: 1|  NKD Loss: 2.1074 | CT Loss: 5.1164| [0m
[91mEpoch: 1|  Loss:  7.3698 |Global loss: 9.7924| Local H loss: 0.076  | Global H loss: 0.0683 [0m
[94mEpoch: 2|  NKD Loss: 2.1104 | CT Loss: 5.1143| [0m
[91mEpoch: 2|  Loss:  7.3772 |Global loss: 9.7988| Local H loss: 0.0757  | Global H loss: 0.0678 [0m
[94mEpoch: 3|  NKD Loss: 2.1071 | CT Loss: 5.1134| [0m
[91mEpoch: 3|  Loss:  7.3684 |Global loss: 9.7937| Local H loss: 0.0767  | Global H loss: 0.0683 [0m
[94mEpoch: 0|  NKD Loss: 2.1176 | CT Loss: 5.0805| [0m
[91mEpoch: 0|  Loss:  7.3682 |Global loss: 9.7645| Local H loss: 0.0717  | Global H loss: 0.0651 [0m
[94mEpoch: 1|  NKD Loss: 2.1138 | CT Loss: 5.0774| [0m
[91mEpoch: 1|  Loss:  7.3569 |Global loss: 9.757| Local H loss: 0.0728  | Global H loss: 0.0656 [0m
[94mEpoch: 2|  NKD Loss: 2.1161 | CT Loss: 5.0773| [0m
[91mEpoch: 2|  Loss:  7.3602 |Global loss: 9.7607| Local H loss: 0.0719  | Global H loss: 0.0653 [0m
[94mEpoch: 3|  NKD Loss: 2.1158 | CT Loss: 5.0758| [0m
[91mEpoch: 3|  Loss:  7.3585 |Global loss: 9.7563| Local H loss: 0.0714  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.1161 | CT Loss: 5.1166| [0m
[91mEpoch: 0|  Loss:  7.4018 |Global loss: 9.793| Local H loss: 0.0691  | Global H loss: 0.0642 [0m
[94mEpoch: 1|  NKD Loss: 2.1179 | CT Loss: 5.1143| [0m
[91mEpoch: 1|  Loss:  7.4087 |Global loss: 9.7998| Local H loss: 0.0676  | Global H loss: 0.0633 [0m
[94mEpoch: 2|  NKD Loss: 2.1159 | CT Loss: 5.1139| [0m
[91mEpoch: 2|  Loss:  7.4029 |Global loss: 9.7971| Local H loss: 0.0692  | Global H loss: 0.064 [0m
[94mEpoch: 3|  NKD Loss: 2.1181 | CT Loss: 5.1117| [0m
[91mEpoch: 3|  Loss:  7.4092 |Global loss: 9.7957| Local H loss: 0.0673  | Global H loss: 0.0632 [0m
------------------------- time cost ------------------------- 3.0050458908081055
Chosen Clients:  [5, 3, 4, 2, 7, 13]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.917, 0.942, 0.975]
AUC in each clients:  [119.265, 119.786, 119.986, 118.993, 119.984, 119.25, 119.926, 118.992, 118.997, 119.67, 119.967, 119.808, 119.768, 119.257, 119.024]
F1 Score:  [0.973, 0.878, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.92, 0.945, 0.974]
Recall Score:  [0.977, 0.903, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.93, 0.946, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2865
Averaged Test Accurancy: 0.9683
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9645
Averaged Test Recal score: 0.9692
Std Test Accurancy: 0.0211
Std Test AUC: 0.0033
Std Test F1: 0.0002
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1157 | CT Loss: 5.1235| [0m
[91mEpoch: 0|  Loss:  7.4099 |Global loss: 9.8065| Local H loss: 0.069  | Global H loss: 0.0643 [0m
[94mEpoch: 1|  NKD Loss: 2.1168 | CT Loss: 5.1225| [0m
[91mEpoch: 1|  Loss:  7.409 |Global loss: 9.8135| Local H loss: 0.0682  | Global H loss: 0.0642 [0m
[94mEpoch: 2|  NKD Loss: 2.1137 | CT Loss: 5.1222| [0m
[91mEpoch: 2|  Loss:  7.4016 |Global loss: 9.8026| Local H loss: 0.0702  | Global H loss: 0.0651 [0m
[94mEpoch: 3|  NKD Loss: 2.1125 | CT Loss: 5.1189| [0m
[91mEpoch: 3|  Loss:  7.3969 |Global loss: 9.8011| Local H loss: 0.071  | Global H loss: 0.0653 [0m
[94mEpoch: 0|  NKD Loss: 2.1117 | CT Loss: 5.1473| [0m
[91mEpoch: 0|  Loss:  7.4128 |Global loss: 9.8238| Local H loss: 0.0714  | Global H loss: 0.0663 [0m
[94mEpoch: 1|  NKD Loss: 2.1063 | CT Loss: 5.1449| [0m
[91mEpoch: 1|  Loss:  7.4003 |Global loss: 9.8182| Local H loss: 0.0724  | Global H loss: 0.0671 [0m
[94mEpoch: 2|  NKD Loss: 2.1082 | CT Loss: 5.1443| [0m
[91mEpoch: 2|  Loss:  7.4038 |Global loss: 9.8237| Local H loss: 0.0723  | Global H loss: 0.0668 [0m
[94mEpoch: 3|  NKD Loss: 2.108 | CT Loss: 5.1408| [0m
[91mEpoch: 3|  Loss:  7.4026 |Global loss: 9.8208| Local H loss: 0.0711  | Global H loss: 0.0662 [0m
[94mEpoch: 0|  NKD Loss: 2.1208 | CT Loss: 5.0995| [0m
[91mEpoch: 0|  Loss:  7.4116 |Global loss: 9.7838| Local H loss: 0.0723  | Global H loss: 0.0648 [0m
[94mEpoch: 1|  NKD Loss: 2.1141 | CT Loss: 5.098| [0m
[91mEpoch: 1|  Loss:  7.3847 |Global loss: 9.7767| Local H loss: 0.0712  | Global H loss: 0.0651 [0m
[94mEpoch: 2|  NKD Loss: 2.1186 | CT Loss: 5.0971| [0m
[91mEpoch: 2|  Loss:  7.4033 |Global loss: 9.7833| Local H loss: 0.0728  | Global H loss: 0.065 [0m
[94mEpoch: 3|  NKD Loss: 2.1175 | CT Loss: 5.0941| [0m
[91mEpoch: 3|  Loss:  7.3939 |Global loss: 9.7792| Local H loss: 0.0701  | Global H loss: 0.0642 [0m
[94mEpoch: 0|  NKD Loss: 2.1084 | CT Loss: 5.1126| [0m
[91mEpoch: 0|  Loss:  7.3679 |Global loss: 9.7945| Local H loss: 0.0767  | Global H loss: 0.0685 [0m
[94mEpoch: 1|  NKD Loss: 2.1095 | CT Loss: 5.111| [0m
[91mEpoch: 1|  Loss:  7.372 |Global loss: 9.7884| Local H loss: 0.0761  | Global H loss: 0.0679 [0m
[94mEpoch: 2|  NKD Loss: 2.1144 | CT Loss: 5.11| [0m
[91mEpoch: 2|  Loss:  7.3846 |Global loss: 9.7939| Local H loss: 0.0742  | Global H loss: 0.0665 [0m
[94mEpoch: 3|  NKD Loss: 2.1219 | CT Loss: 5.1094| [0m
[91mEpoch: 3|  Loss:  7.4069 |Global loss: 9.7985| Local H loss: 0.0716  | Global H loss: 0.0648 [0m
[94mEpoch: 0|  NKD Loss: 2.1026 | CT Loss: 5.1083| [0m
[91mEpoch: 0|  Loss:  7.3522 |Global loss: 9.7811| Local H loss: 0.0782  | Global H loss: 0.0694 [0m
[94mEpoch: 1|  NKD Loss: 2.1163 | CT Loss: 5.1068| [0m
[91mEpoch: 1|  Loss:  7.3804 |Global loss: 9.7943| Local H loss: 0.0729  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1062 | CT Loss: 5.106| [0m
[91mEpoch: 2|  Loss:  7.3592 |Global loss: 9.7822| Local H loss: 0.0765  | Global H loss: 0.0684 [0m
[94mEpoch: 3|  NKD Loss: 2.1065 | CT Loss: 5.105| [0m
[91mEpoch: 3|  Loss:  7.3588 |Global loss: 9.7844| Local H loss: 0.0768  | Global H loss: 0.0686 [0m
[94mEpoch: 0|  NKD Loss: 2.1502 | CT Loss: 5.1313| [0m
[91mEpoch: 0|  Loss:  7.5741 |Global loss: 9.8388| Local H loss: 0.0624  | Global H loss: 0.0568 [0m
[94mEpoch: 1|  NKD Loss: 2.1333 | CT Loss: 5.1278| [0m
[91mEpoch: 1|  Loss:  7.5184 |Global loss: 9.8267| Local H loss: 0.064  | Global H loss: 0.0584 [0m
[94mEpoch: 2|  NKD Loss: 2.1418 | CT Loss: 5.1288| [0m
[91mEpoch: 2|  Loss:  7.5355 |Global loss: 9.835| Local H loss: 0.0645  | Global H loss: 0.0583 [0m
[94mEpoch: 3|  NKD Loss: 2.1474 | CT Loss: 5.1251| [0m
[91mEpoch: 3|  Loss:  7.5521 |Global loss: 9.8328| Local H loss: 0.0619  | Global H loss: 0.057 [0m
------------------------- time cost ------------------------- 2.981799364089966
Chosen Clients:  [6, 5, 4, 3, 9, 1]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.925, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.917, 0.9, 0.975]
AUC in each clients:  [119.265, 119.786, 119.989, 118.993, 119.983, 119.342, 119.926, 118.992, 118.997, 119.67, 119.967, 119.808, 119.768, 119.117, 119.024]
F1 Score:  [0.973, 0.878, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.92, 0.903, 0.974]
Recall Score:  [0.977, 0.903, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.93, 0.927, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2797
Averaged Test Accurancy: 0.9656
Averaged Test AUC: 0.9959
Averaged Test F1_score: 0.9617
Averaged Test Recal score: 0.9679
Std Test Accurancy: 0.0265
Std Test AUC: 0.0033
Std Test F1: 0.0003
Std Test Recall: 0.0002
[94mEpoch: 0|  NKD Loss: 2.1047 | CT Loss: 5.1102| [0m
[91mEpoch: 0|  Loss:  7.3644 |Global loss: 9.7852| Local H loss: 0.0715  | Global H loss: 0.0667 [0m
[94mEpoch: 1|  NKD Loss: 2.1043 | CT Loss: 5.1078| [0m
[91mEpoch: 1|  Loss:  7.3635 |Global loss: 9.7829| Local H loss: 0.0716  | Global H loss: 0.0666 [0m
[94mEpoch: 2|  NKD Loss: 2.1076 | CT Loss: 5.1071| [0m
[91mEpoch: 2|  Loss:  7.3673 |Global loss: 9.7903| Local H loss: 0.0715  | Global H loss: 0.0664 [0m
[94mEpoch: 3|  NKD Loss: 2.11 | CT Loss: 5.1084| [0m
[91mEpoch: 3|  Loss:  7.3736 |Global loss: 9.7913| Local H loss: 0.0705  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 2.1178 | CT Loss: 5.1173| [0m
[91mEpoch: 0|  Loss:  7.4079 |Global loss: 9.8003| Local H loss: 0.068  | Global H loss: 0.0639 [0m
[94mEpoch: 1|  NKD Loss: 2.1194 | CT Loss: 5.1176| [0m
[91mEpoch: 1|  Loss:  7.4136 |Global loss: 9.8027| Local H loss: 0.0688  | Global H loss: 0.064 [0m
[94mEpoch: 2|  NKD Loss: 2.1159 | CT Loss: 5.1151| [0m
[91mEpoch: 2|  Loss:  7.4016 |Global loss: 9.7997| Local H loss: 0.0693  | Global H loss: 0.0645 [0m
[94mEpoch: 3|  NKD Loss: 2.1109 | CT Loss: 5.1129| [0m
[91mEpoch: 3|  Loss:  7.3882 |Global loss: 9.7885| Local H loss: 0.0705  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.1162 | CT Loss: 5.0943| [0m
[91mEpoch: 0|  Loss:  7.3891 |Global loss: 9.7798| Local H loss: 0.0723  | Global H loss: 0.0654 [0m
[94mEpoch: 1|  NKD Loss: 2.1165 | CT Loss: 5.0927| [0m
[91mEpoch: 1|  Loss:  7.3917 |Global loss: 9.7767| Local H loss: 0.0723  | Global H loss: 0.0652 [0m
[94mEpoch: 2|  NKD Loss: 2.11 | CT Loss: 5.0897| [0m
[91mEpoch: 2|  Loss:  7.3706 |Global loss: 9.7642| Local H loss: 0.0712  | Global H loss: 0.065 [0m
[94mEpoch: 3|  NKD Loss: 2.1154 | CT Loss: 5.0889| [0m
[91mEpoch: 3|  Loss:  7.3862 |Global loss: 9.7752| Local H loss: 0.0726  | Global H loss: 0.0655 [0m
[94mEpoch: 0|  NKD Loss: 2.1029 | CT Loss: 5.1403| [0m
[91mEpoch: 0|  Loss:  7.3898 |Global loss: 9.8173| Local H loss: 0.0734  | Global H loss: 0.0677 [0m
[94mEpoch: 1|  NKD Loss: 2.1022 | CT Loss: 5.1375| [0m
[91mEpoch: 1|  Loss:  7.3863 |Global loss: 9.8104| Local H loss: 0.0736  | Global H loss: 0.0677 [0m
[94mEpoch: 2|  NKD Loss: 2.1061 | CT Loss: 5.137| [0m
[91mEpoch: 2|  Loss:  7.3925 |Global loss: 9.8173| Local H loss: 0.0732  | Global H loss: 0.0673 [0m
[94mEpoch: 3|  NKD Loss: 2.1173 | CT Loss: 5.135| [0m
[91mEpoch: 3|  Loss:  7.4223 |Global loss: 9.8217| Local H loss: 0.07  | Global H loss: 0.0649 [0m
[94mEpoch: 0|  NKD Loss: 2.0997 | CT Loss: 5.1228| [0m
[91mEpoch: 0|  Loss:  7.3595 |Global loss: 9.7902| Local H loss: 0.0807  | Global H loss: 0.0706 [0m
[94mEpoch: 1|  NKD Loss: 2.1002 | CT Loss: 5.1229| [0m
[91mEpoch: 1|  Loss:  7.3612 |Global loss: 9.7973| Local H loss: 0.0806  | Global H loss: 0.0705 [0m
[94mEpoch: 2|  NKD Loss: 2.0988 | CT Loss: 5.1205| [0m
[91mEpoch: 2|  Loss:  7.3558 |Global loss: 9.7985| Local H loss: 0.08  | Global H loss: 0.0705 [0m
[94mEpoch: 3|  NKD Loss: 2.0991 | CT Loss: 5.119| [0m
[91mEpoch: 3|  Loss:  7.356 |Global loss: 9.7946| Local H loss: 0.0809  | Global H loss: 0.0706 [0m
[94mEpoch: 0|  NKD Loss: 2.1199 | CT Loss: 5.1132| [0m
[91mEpoch: 0|  Loss:  7.4095 |Global loss: 9.8034| Local H loss: 0.0686  | Global H loss: 0.0642 [0m
[94mEpoch: 1|  NKD Loss: 2.1017 | CT Loss: 5.1079| [0m
[91mEpoch: 1|  Loss:  7.357 |Global loss: 9.7869| Local H loss: 0.0729  | Global H loss: 0.0675 [0m
[94mEpoch: 2|  NKD Loss: 2.102 | CT Loss: 5.1055| [0m
[91mEpoch: 2|  Loss:  7.3551 |Global loss: 9.7829| Local H loss: 0.0724  | Global H loss: 0.0673 [0m
[94mEpoch: 3|  NKD Loss: 2.1019 | CT Loss: 5.1046| [0m
[91mEpoch: 3|  Loss:  7.354 |Global loss: 9.7777| Local H loss: 0.073  | Global H loss: 0.0675 [0m
------------------------- time cost ------------------------- 3.072326421737671
Chosen Clients:  [9, 7, 12, 10, 0, 14]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.917, 0.9, 0.975]
AUC in each clients:  [119.265, 119.98, 119.989, 118.994, 119.985, 119.357, 119.977, 118.992, 118.997, 119.598, 119.967, 119.808, 119.768, 119.117, 119.024]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.92, 0.903, 0.974]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.93, 0.927, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2489
Averaged Test Accurancy: 0.9694
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9685
Averaged Test Recal score: 0.9733
Std Test Accurancy: 0.0245
Std Test AUC: 0.0034
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.0969 | CT Loss: 5.119| [0m
[91mEpoch: 0|  Loss:  7.3515 |Global loss: 9.7879| Local H loss: 0.0823  | Global H loss: 0.0712 [0m
[94mEpoch: 1|  NKD Loss: 2.0992 | CT Loss: 5.1192| [0m
[91mEpoch: 1|  Loss:  7.3558 |Global loss: 9.7918| Local H loss: 0.0805  | Global H loss: 0.0705 [0m
[94mEpoch: 2|  NKD Loss: 2.1003 | CT Loss: 5.1162| [0m
[91mEpoch: 2|  Loss:  7.3558 |Global loss: 9.7941| Local H loss: 0.0792  | Global H loss: 0.07 [0m
[94mEpoch: 3|  NKD Loss: 2.1002 | CT Loss: 5.1149| [0m
[91mEpoch: 3|  Loss:  7.3546 |Global loss: 9.7926| Local H loss: 0.0796  | Global H loss: 0.0701 [0m
[94mEpoch: 0|  NKD Loss: 2.0982 | CT Loss: 5.1034| [0m
[91mEpoch: 0|  Loss:  7.34 |Global loss: 9.7797| Local H loss: 0.0793  | Global H loss: 0.0701 [0m
[94mEpoch: 1|  NKD Loss: 2.1011 | CT Loss: 5.1018| [0m
[91mEpoch: 1|  Loss:  7.3434 |Global loss: 9.7778| Local H loss: 0.0783  | Global H loss: 0.0696 [0m
[94mEpoch: 2|  NKD Loss: 2.0987 | CT Loss: 5.1003| [0m
[91mEpoch: 2|  Loss:  7.3407 |Global loss: 9.7763| Local H loss: 0.0787  | Global H loss: 0.0696 [0m
[94mEpoch: 3|  NKD Loss: 2.1097 | CT Loss: 5.0996| [0m
[91mEpoch: 3|  Loss:  7.3641 |Global loss: 9.781| Local H loss: 0.0746  | Global H loss: 0.0671 [0m
[94mEpoch: 0|  NKD Loss: 2.1236 | CT Loss: 5.1376| [0m
[91mEpoch: 0|  Loss:  7.4878 |Global loss: 9.8181| Local H loss: 0.0612  | Global H loss: 0.0585 [0m
[94mEpoch: 1|  NKD Loss: 2.1306 | CT Loss: 5.1353| [0m
[91mEpoch: 1|  Loss:  7.5128 |Global loss: 9.8335| Local H loss: 0.0602  | Global H loss: 0.0582 [0m
[94mEpoch: 2|  NKD Loss: 2.1285 | CT Loss: 5.131| [0m
[91mEpoch: 2|  Loss:  7.494 |Global loss: 9.8212| Local H loss: 0.0621  | Global H loss: 0.0594 [0m
[94mEpoch: 3|  NKD Loss: 2.1354 | CT Loss: 5.1335| [0m
[91mEpoch: 3|  Loss:  7.5263 |Global loss: 9.8338| Local H loss: 0.059  | Global H loss: 0.0574 [0m
[94mEpoch: 0|  NKD Loss: 2.1175 | CT Loss: 5.1098| [0m
[91mEpoch: 0|  Loss:  7.4019 |Global loss: 9.7931| Local H loss: 0.0677  | Global H loss: 0.0636 [0m
[94mEpoch: 1|  NKD Loss: 2.1159 | CT Loss: 5.1071| [0m
[91mEpoch: 1|  Loss:  7.4012 |Global loss: 9.7929| Local H loss: 0.0666  | Global H loss: 0.0629 [0m
[94mEpoch: 2|  NKD Loss: 2.1087 | CT Loss: 5.1066| [0m
[91mEpoch: 2|  Loss:  7.3846 |Global loss: 9.7842| Local H loss: 0.07  | Global H loss: 0.0646 [0m
[94mEpoch: 3|  NKD Loss: 2.1071 | CT Loss: 5.1057| [0m
[91mEpoch: 3|  Loss:  7.3741 |Global loss: 9.7845| Local H loss: 0.0714  | Global H loss: 0.0654 [0m
[94mEpoch: 0|  NKD Loss: 2.11 | CT Loss: 5.0738| [0m
[91mEpoch: 0|  Loss:  7.3504 |Global loss: 9.7599| Local H loss: 0.0708  | Global H loss: 0.065 [0m
[94mEpoch: 1|  NKD Loss: 2.1099 | CT Loss: 5.0755| [0m
[91mEpoch: 1|  Loss:  7.3494 |Global loss: 9.7556| Local H loss: 0.0722  | Global H loss: 0.0656 [0m
[94mEpoch: 2|  NKD Loss: 2.1099 | CT Loss: 5.0716| [0m
[91mEpoch: 2|  Loss:  7.3456 |Global loss: 9.7623| Local H loss: 0.0721  | Global H loss: 0.0656 [0m
[94mEpoch: 3|  NKD Loss: 2.1087 | CT Loss: 5.0695| [0m
[91mEpoch: 3|  Loss:  7.3417 |Global loss: 9.7558| Local H loss: 0.0725  | Global H loss: 0.0659 [0m
[94mEpoch: 0|  NKD Loss: 2.0993 | CT Loss: 5.103| [0m
[91mEpoch: 0|  Loss:  7.343 |Global loss: 9.7745| Local H loss: 0.0765  | Global H loss: 0.0692 [0m
[94mEpoch: 1|  NKD Loss: 2.0991 | CT Loss: 5.1019| [0m
[91mEpoch: 1|  Loss:  7.3439 |Global loss: 9.7779| Local H loss: 0.0758  | Global H loss: 0.0687 [0m
[94mEpoch: 2|  NKD Loss: 2.1002 | CT Loss: 5.1005| [0m
[91mEpoch: 2|  Loss:  7.3444 |Global loss: 9.7704| Local H loss: 0.0758  | Global H loss: 0.0686 [0m
[94mEpoch: 3|  NKD Loss: 2.1004 | CT Loss: 5.0993| [0m
[91mEpoch: 3|  Loss:  7.344 |Global loss: 9.774| Local H loss: 0.0756  | Global H loss: 0.0685 [0m
------------------------- time cost ------------------------- 2.937211513519287
Chosen Clients:  [0, 5, 9, 8, 14, 13]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.9, 0.983]
AUC in each clients:  [119.252, 119.98, 119.989, 118.994, 119.985, 119.357, 119.977, 118.992, 118.997, 119.592, 119.967, 119.808, 119.974, 119.117, 118.898]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.903, 0.982]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2290
Averaged Test Accurancy: 0.9733
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9721
Averaged Test Recal score: 0.9762
Std Test Accurancy: 0.0200
Std Test AUC: 0.0036
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1108 | CT Loss: 5.069| [0m
[91mEpoch: 0|  Loss:  7.349 |Global loss: 9.7554| Local H loss: 0.0715  | Global H loss: 0.0652 [0m
[94mEpoch: 1|  NKD Loss: 2.1205 | CT Loss: 5.0694| [0m
[91mEpoch: 1|  Loss:  7.3783 |Global loss: 9.7592| Local H loss: 0.0701  | Global H loss: 0.0639 [0m
[94mEpoch: 2|  NKD Loss: 2.111 | CT Loss: 5.0661| [0m
[91mEpoch: 2|  Loss:  7.3469 |Global loss: 9.7491| Local H loss: 0.0713  | Global H loss: 0.065 [0m
[94mEpoch: 3|  NKD Loss: 2.1058 | CT Loss: 5.0655| [0m
[91mEpoch: 3|  Loss:  7.3354 |Global loss: 9.7434| Local H loss: 0.0727  | Global H loss: 0.0658 [0m
[94mEpoch: 0|  NKD Loss: 2.1118 | CT Loss: 5.1117| [0m
[91mEpoch: 0|  Loss:  7.3882 |Global loss: 9.797| Local H loss: 0.0702  | Global H loss: 0.065 [0m
[94mEpoch: 1|  NKD Loss: 2.1195 | CT Loss: 5.113| [0m
[91mEpoch: 1|  Loss:  7.413 |Global loss: 9.8017| Local H loss: 0.0703  | Global H loss: 0.0646 [0m
[94mEpoch: 2|  NKD Loss: 2.1155 | CT Loss: 5.1097| [0m
[91mEpoch: 2|  Loss:  7.4057 |Global loss: 9.7937| Local H loss: 0.0691  | Global H loss: 0.064 [0m
[94mEpoch: 3|  NKD Loss: 2.1104 | CT Loss: 5.1076| [0m
[91mEpoch: 3|  Loss:  7.3843 |Global loss: 9.7931| Local H loss: 0.0709  | Global H loss: 0.0653 [0m
[94mEpoch: 0|  NKD Loss: 2.0974 | CT Loss: 5.1143| [0m
[91mEpoch: 0|  Loss:  7.3477 |Global loss: 9.7931| Local H loss: 0.0808  | Global H loss: 0.0708 [0m
[94mEpoch: 1|  NKD Loss: 2.0988 | CT Loss: 5.1124| [0m
[91mEpoch: 1|  Loss:  7.3501 |Global loss: 9.7865| Local H loss: 0.0793  | Global H loss: 0.0701 [0m
[94mEpoch: 2|  NKD Loss: 2.0958 | CT Loss: 5.1107| [0m
[91mEpoch: 2|  Loss:  7.3427 |Global loss: 9.7855| Local H loss: 0.081  | Global H loss: 0.0708 [0m
[94mEpoch: 3|  NKD Loss: 2.0984 | CT Loss: 5.111| [0m
[91mEpoch: 3|  Loss:  7.3476 |Global loss: 9.793| Local H loss: 0.0804  | Global H loss: 0.0706 [0m
[94mEpoch: 0|  NKD Loss: 2.1178 | CT Loss: 5.1435| [0m
[91mEpoch: 0|  Loss:  7.4367 |Global loss: 9.8291| Local H loss: 0.0687  | Global H loss: 0.0644 [0m
[94mEpoch: 1|  NKD Loss: 2.1067 | CT Loss: 5.1418| [0m
[91mEpoch: 1|  Loss:  7.4032 |Global loss: 9.8203| Local H loss: 0.0701  | Global H loss: 0.0661 [0m
[94mEpoch: 2|  NKD Loss: 2.098 | CT Loss: 5.1381| [0m
[91mEpoch: 2|  Loss:  7.3813 |Global loss: 9.8066| Local H loss: 0.0741  | Global H loss: 0.0681 [0m
[94mEpoch: 3|  NKD Loss: 2.1001 | CT Loss: 5.137| [0m
[91mEpoch: 3|  Loss:  7.383 |Global loss: 9.8135| Local H loss: 0.0734  | Global H loss: 0.0679 [0m
[94mEpoch: 0|  NKD Loss: 2.1075 | CT Loss: 5.099| [0m
[91mEpoch: 0|  Loss:  7.3616 |Global loss: 9.7783| Local H loss: 0.0738  | Global H loss: 0.0671 [0m
[94mEpoch: 1|  NKD Loss: 2.0998 | CT Loss: 5.097| [0m
[91mEpoch: 1|  Loss:  7.3397 |Global loss: 9.7676| Local H loss: 0.0761  | Global H loss: 0.0687 [0m
[94mEpoch: 2|  NKD Loss: 2.0978 | CT Loss: 5.0943| [0m
[91mEpoch: 2|  Loss:  7.335 |Global loss: 9.7709| Local H loss: 0.0761  | Global H loss: 0.0688 [0m
[94mEpoch: 3|  NKD Loss: 2.0972 | CT Loss: 5.0934| [0m
[91mEpoch: 3|  Loss:  7.3334 |Global loss: 9.7689| Local H loss: 0.0775  | Global H loss: 0.0691 [0m
[94mEpoch: 0|  NKD Loss: 2.1367 | CT Loss: 5.1244| [0m
[91mEpoch: 0|  Loss:  7.526 |Global loss: 9.8246| Local H loss: 0.0636  | Global H loss: 0.058 [0m
[94mEpoch: 1|  NKD Loss: 2.1345 | CT Loss: 5.1224| [0m
[91mEpoch: 1|  Loss:  7.5206 |Global loss: 9.817| Local H loss: 0.0631  | Global H loss: 0.0578 [0m
[94mEpoch: 2|  NKD Loss: 2.1364 | CT Loss: 5.1215| [0m
[91mEpoch: 2|  Loss:  7.5171 |Global loss: 9.8175| Local H loss: 0.0628  | Global H loss: 0.0578 [0m
[94mEpoch: 3|  NKD Loss: 2.1302 | CT Loss: 5.1204| [0m
[91mEpoch: 3|  Loss:  7.5007 |Global loss: 9.8176| Local H loss: 0.0633  | Global H loss: 0.0585 [0m
------------------------- time cost ------------------------- 2.903299570083618
Chosen Clients:  [3, 9, 8, 12, 1, 0]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.933, 0.983]
AUC in each clients:  [119.317, 119.98, 119.989, 118.994, 119.985, 119.314, 119.977, 118.992, 118.996, 119.598, 119.967, 119.808, 119.974, 119.114, 118.914]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.933, 0.982]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.949, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2207
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9741
Averaged Test Recal score: 0.9777
Std Test Accurancy: 0.0120
Std Test AUC: 0.0036
Std Test F1: 0.0001
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.099 | CT Loss: 5.1325| [0m
[91mEpoch: 0|  Loss:  7.3803 |Global loss: 9.8034| Local H loss: 0.0732  | Global H loss: 0.0673 [0m
[94mEpoch: 1|  NKD Loss: 2.0961 | CT Loss: 5.1293| [0m
[91mEpoch: 1|  Loss:  7.3697 |Global loss: 9.8041| Local H loss: 0.0744  | Global H loss: 0.0682 [0m
[94mEpoch: 2|  NKD Loss: 2.094 | CT Loss: 5.1273| [0m
[91mEpoch: 2|  Loss:  7.3636 |Global loss: 9.8009| Local H loss: 0.0758  | Global H loss: 0.0688 [0m
[94mEpoch: 3|  NKD Loss: 2.0982 | CT Loss: 5.1279| [0m
[91mEpoch: 3|  Loss:  7.3737 |Global loss: 9.8016| Local H loss: 0.0744  | Global H loss: 0.0678 [0m
[94mEpoch: 0|  NKD Loss: 2.0945 | CT Loss: 5.1086| [0m
[91mEpoch: 0|  Loss:  7.3394 |Global loss: 9.7833| Local H loss: 0.0805  | Global H loss: 0.0707 [0m
[94mEpoch: 1|  NKD Loss: 2.094 | CT Loss: 5.1065| [0m
[91mEpoch: 1|  Loss:  7.3359 |Global loss: 9.7813| Local H loss: 0.0812  | Global H loss: 0.071 [0m
[94mEpoch: 2|  NKD Loss: 2.0938 | CT Loss: 5.1064| [0m
[91mEpoch: 2|  Loss:  7.3368 |Global loss: 9.7821| Local H loss: 0.081  | Global H loss: 0.0708 [0m
[94mEpoch: 3|  NKD Loss: 2.0923 | CT Loss: 5.1043| [0m
[91mEpoch: 3|  Loss:  7.3327 |Global loss: 9.7759| Local H loss: 0.0817  | Global H loss: 0.071 [0m
[94mEpoch: 0|  NKD Loss: 2.0978 | CT Loss: 5.134| [0m
[91mEpoch: 0|  Loss:  7.3764 |Global loss: 9.8065| Local H loss: 0.0747  | Global H loss: 0.0683 [0m
[94mEpoch: 1|  NKD Loss: 2.102 | CT Loss: 5.133| [0m
[91mEpoch: 1|  Loss:  7.3847 |Global loss: 9.8116| Local H loss: 0.0729  | Global H loss: 0.0673 [0m
[94mEpoch: 2|  NKD Loss: 2.1096 | CT Loss: 5.1328| [0m
[91mEpoch: 2|  Loss:  7.4081 |Global loss: 9.8118| Local H loss: 0.0711  | Global H loss: 0.0657 [0m
[94mEpoch: 3|  NKD Loss: 2.1128 | CT Loss: 5.1317| [0m
[91mEpoch: 3|  Loss:  7.409 |Global loss: 9.8242| Local H loss: 0.0693  | Global H loss: 0.065 [0m
[94mEpoch: 0|  NKD Loss: 2.1127 | CT Loss: 5.1286| [0m
[91mEpoch: 0|  Loss:  7.442 |Global loss: 9.8097| Local H loss: 0.0631  | Global H loss: 0.0606 [0m
[94mEpoch: 1|  NKD Loss: 2.1315 | CT Loss: 5.1258| [0m
[91mEpoch: 1|  Loss:  7.5005 |Global loss: 9.8206| Local H loss: 0.0616  | Global H loss: 0.0592 [0m
[94mEpoch: 2|  NKD Loss: 2.1275 | CT Loss: 5.1286| [0m
[91mEpoch: 2|  Loss:  7.5002 |Global loss: 9.8214| Local H loss: 0.0601  | Global H loss: 0.0581 [0m
[94mEpoch: 3|  NKD Loss: 2.1191 | CT Loss: 5.1227| [0m
[91mEpoch: 3|  Loss:  7.4623 |Global loss: 9.8155| Local H loss: 0.0621  | Global H loss: 0.0597 [0m
[94mEpoch: 0|  NKD Loss: 2.0979 | CT Loss: 5.1034| [0m
[91mEpoch: 0|  Loss:  7.3479 |Global loss: 9.7806| Local H loss: 0.0733  | Global H loss: 0.0677 [0m
[94mEpoch: 1|  NKD Loss: 2.1017 | CT Loss: 5.1025| [0m
[91mEpoch: 1|  Loss:  7.3584 |Global loss: 9.7749| Local H loss: 0.0711  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1086 | CT Loss: 5.1012| [0m
[91mEpoch: 2|  Loss:  7.3675 |Global loss: 9.7844| Local H loss: 0.0715  | Global H loss: 0.0662 [0m
[94mEpoch: 3|  NKD Loss: 2.0977 | CT Loss: 5.0998| [0m
[91mEpoch: 3|  Loss:  7.3452 |Global loss: 9.7701| Local H loss: 0.0726  | Global H loss: 0.0673 [0m
[94mEpoch: 0|  NKD Loss: 2.1039 | CT Loss: 5.0643| [0m
[91mEpoch: 0|  Loss:  7.3277 |Global loss: 9.7446| Local H loss: 0.0726  | Global H loss: 0.0661 [0m
[94mEpoch: 1|  NKD Loss: 2.1061 | CT Loss: 5.0628| [0m
[91mEpoch: 1|  Loss:  7.331 |Global loss: 9.7479| Local H loss: 0.0722  | Global H loss: 0.0658 [0m
[94mEpoch: 2|  NKD Loss: 2.1096 | CT Loss: 5.0628| [0m
[91mEpoch: 2|  Loss:  7.3428 |Global loss: 9.7391| Local H loss: 0.0717  | Global H loss: 0.0652 [0m
[94mEpoch: 3|  NKD Loss: 2.1096 | CT Loss: 5.0621| [0m
[91mEpoch: 3|  Loss:  7.345 |Global loss: 9.7448| Local H loss: 0.0724  | Global H loss: 0.0654 [0m
------------------------- time cost ------------------------- 2.816342353820801
Chosen Clients:  [10, 1, 0, 3, 5, 7]

-------------Round number: 59-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.933, 0.983]
AUC in each clients:  [119.357, 119.983, 119.989, 118.981, 119.985, 119.314, 119.977, 118.992, 118.995, 119.518, 119.967, 119.808, 119.978, 119.114, 118.914]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.933, 0.982]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.949, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2130
Averaged Test Accurancy: 0.9756
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9741
Averaged Test Recal score: 0.9777
Std Test Accurancy: 0.0120
Std Test AUC: 0.0036
Std Test F1: 0.0001
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1036 | CT Loss: 5.102| [0m
[91mEpoch: 0|  Loss:  7.3705 |Global loss: 9.7787| Local H loss: 0.0702  | Global H loss: 0.0652 [0m
[94mEpoch: 1|  NKD Loss: 2.1116 | CT Loss: 5.1043| [0m
[91mEpoch: 1|  Loss:  7.3883 |Global loss: 9.7846| Local H loss: 0.0684  | Global H loss: 0.0639 [0m
[94mEpoch: 2|  NKD Loss: 2.1012 | CT Loss: 5.1014| [0m
[91mEpoch: 2|  Loss:  7.3621 |Global loss: 9.7797| Local H loss: 0.0719  | Global H loss: 0.066 [0m
[94mEpoch: 3|  NKD Loss: 2.103 | CT Loss: 5.0978| [0m
[91mEpoch: 3|  Loss:  7.3639 |Global loss: 9.776| Local H loss: 0.0705  | Global H loss: 0.0652 [0m
[94mEpoch: 0|  NKD Loss: 2.0995 | CT Loss: 5.0974| [0m
[91mEpoch: 0|  Loss:  7.3445 |Global loss: 9.7787| Local H loss: 0.0725  | Global H loss: 0.0673 [0m
[94mEpoch: 1|  NKD Loss: 2.1048 | CT Loss: 5.0955| [0m
[91mEpoch: 1|  Loss:  7.3526 |Global loss: 9.7805| Local H loss: 0.0726  | Global H loss: 0.0672 [0m
[94mEpoch: 2|  NKD Loss: 2.1099 | CT Loss: 5.0958| [0m
[91mEpoch: 2|  Loss:  7.3766 |Global loss: 9.7843| Local H loss: 0.0707  | Global H loss: 0.066 [0m
[94mEpoch: 3|  NKD Loss: 2.0993 | CT Loss: 5.0939| [0m
[91mEpoch: 3|  Loss:  7.3447 |Global loss: 9.7729| Local H loss: 0.072  | Global H loss: 0.0668 [0m
[94mEpoch: 0|  NKD Loss: 2.1017 | CT Loss: 5.0582| [0m
[91mEpoch: 0|  Loss:  7.32 |Global loss: 9.7412| Local H loss: 0.0727  | Global H loss: 0.0662 [0m
[94mEpoch: 1|  NKD Loss: 2.1021 | CT Loss: 5.0588| [0m
[91mEpoch: 1|  Loss:  7.3216 |Global loss: 9.7339| Local H loss: 0.0734  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1028 | CT Loss: 5.0579| [0m
[91mEpoch: 2|  Loss:  7.3201 |Global loss: 9.7342| Local H loss: 0.0734  | Global H loss: 0.0665 [0m
[94mEpoch: 3|  NKD Loss: 2.101 | CT Loss: 5.0576| [0m
[91mEpoch: 3|  Loss:  7.3184 |Global loss: 9.7363| Local H loss: 0.0743  | Global H loss: 0.0667 [0m
[94mEpoch: 0|  NKD Loss: 2.1032 | CT Loss: 5.1272| [0m
[91mEpoch: 0|  Loss:  7.3859 |Global loss: 9.8003| Local H loss: 0.0705  | Global H loss: 0.0658 [0m
[94mEpoch: 1|  NKD Loss: 2.0971 | CT Loss: 5.1251| [0m
[91mEpoch: 1|  Loss:  7.3662 |Global loss: 9.8055| Local H loss: 0.0746  | Global H loss: 0.0683 [0m
[94mEpoch: 2|  NKD Loss: 2.0984 | CT Loss: 5.1242| [0m
[91mEpoch: 2|  Loss:  7.3723 |Global loss: 9.7962| Local H loss: 0.0735  | Global H loss: 0.0673 [0m
[94mEpoch: 3|  NKD Loss: 2.0924 | CT Loss: 5.119| [0m
[91mEpoch: 3|  Loss:  7.3555 |Global loss: 9.7868| Local H loss: 0.0759  | Global H loss: 0.0685 [0m
[94mEpoch: 0|  NKD Loss: 2.1055 | CT Loss: 5.1056| [0m
[91mEpoch: 0|  Loss:  7.3742 |Global loss: 9.7817| Local H loss: 0.0716  | Global H loss: 0.0658 [0m
[94mEpoch: 1|  NKD Loss: 2.1149 | CT Loss: 5.1062| [0m
[91mEpoch: 1|  Loss:  7.4018 |Global loss: 9.795| Local H loss: 0.0705  | Global H loss: 0.0645 [0m
[94mEpoch: 2|  NKD Loss: 2.1127 | CT Loss: 5.1042| [0m
[91mEpoch: 2|  Loss:  7.3888 |Global loss: 9.7918| Local H loss: 0.0698  | Global H loss: 0.0646 [0m
[94mEpoch: 3|  NKD Loss: 2.1123 | CT Loss: 5.1036| [0m
[91mEpoch: 3|  Loss:  7.3922 |Global loss: 9.783| Local H loss: 0.0706  | Global H loss: 0.0646 [0m
[94mEpoch: 0|  NKD Loss: 2.1071 | CT Loss: 5.0995| [0m
[91mEpoch: 0|  Loss:  7.3638 |Global loss: 9.7837| Local H loss: 0.0735  | Global H loss: 0.0665 [0m
[94mEpoch: 1|  NKD Loss: 2.1001 | CT Loss: 5.0969| [0m
[91mEpoch: 1|  Loss:  7.3427 |Global loss: 9.7712| Local H loss: 0.0757  | Global H loss: 0.0684 [0m
[94mEpoch: 2|  NKD Loss: 2.1021 | CT Loss: 5.0968| [0m
[91mEpoch: 2|  Loss:  7.3482 |Global loss: 9.7742| Local H loss: 0.0768  | Global H loss: 0.0682 [0m
[94mEpoch: 3|  NKD Loss: 2.1268 | CT Loss: 5.0967| [0m
[91mEpoch: 3|  Loss:  7.4118 |Global loss: 9.7926| Local H loss: 0.0676  | Global H loss: 0.0629 [0m
------------------------- time cost ------------------------- 2.8778834342956543
Chosen Clients:  [4, 2, 10, 8, 13, 0]

-------------Round number: 60-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.983, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.983, 0.983, 0.975, 0.933, 0.983]
AUC in each clients:  [119.219, 119.987, 119.989, 118.993, 119.985, 119.438, 119.977, 118.993, 118.995, 119.518, 119.967, 119.808, 119.978, 119.114, 118.914]
F1 Score:  [0.973, 0.981, 0.982, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.982, 0.981, 0.975, 0.933, 0.982]
Recall Score:  [0.977, 0.984, 0.984, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.984, 0.984, 0.977, 0.949, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2033
Averaged Test Accurancy: 0.9761
Averaged Test AUC: 0.9960
Averaged Test F1_score: 0.9747
Averaged Test Recal score: 0.9784
Std Test Accurancy: 0.0121
Std Test AUC: 0.0036
Std Test F1: 0.0001
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.1037 | CT Loss: 5.0865| [0m
[91mEpoch: 0|  Loss:  7.3628 |Global loss: 9.7677| Local H loss: 0.0724  | Global H loss: 0.0657 [0m
[94mEpoch: 1|  NKD Loss: 2.104 | CT Loss: 5.088| [0m
[91mEpoch: 1|  Loss:  7.3614 |Global loss: 9.7728| Local H loss: 0.0729  | Global H loss: 0.0659 [0m
[94mEpoch: 2|  NKD Loss: 2.1126 | CT Loss: 5.0864| [0m
[91mEpoch: 2|  Loss:  7.3925 |Global loss: 9.767| Local H loss: 0.0702  | Global H loss: 0.0639 [0m
[94mEpoch: 3|  NKD Loss: 2.1137 | CT Loss: 5.0824| [0m
[91mEpoch: 3|  Loss:  7.3938 |Global loss: 9.7744| Local H loss: 0.0696  | Global H loss: 0.0637 [0m
[94mEpoch: 0|  NKD Loss: 2.0996 | CT Loss: 5.1073| [0m
[91mEpoch: 0|  Loss:  7.3567 |Global loss: 9.7822| Local H loss: 0.076  | Global H loss: 0.0682 [0m
[94mEpoch: 1|  NKD Loss: 2.0957 | CT Loss: 5.1084| [0m
[91mEpoch: 1|  Loss:  7.347 |Global loss: 9.7805| Local H loss: 0.0784  | Global H loss: 0.0693 [0m
[94mEpoch: 2|  NKD Loss: 2.0967 | CT Loss: 5.1054| [0m
[91mEpoch: 2|  Loss:  7.3484 |Global loss: 9.7907| Local H loss: 0.0762  | Global H loss: 0.0685 [0m
[94mEpoch: 3|  NKD Loss: 2.1026 | CT Loss: 5.103| [0m
[91mEpoch: 3|  Loss:  7.3614 |Global loss: 9.7853| Local H loss: 0.0745  | Global H loss: 0.0672 [0m
[94mEpoch: 0|  NKD Loss: 2.0998 | CT Loss: 5.0964| [0m
[91mEpoch: 0|  Loss:  7.3572 |Global loss: 9.7676| Local H loss: 0.0719  | Global H loss: 0.0659 [0m
[94mEpoch: 1|  NKD Loss: 2.0994 | CT Loss: 5.0948| [0m
[91mEpoch: 1|  Loss:  7.3526 |Global loss: 9.7758| Local H loss: 0.0721  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1018 | CT Loss: 5.0937| [0m
[91mEpoch: 2|  Loss:  7.3581 |Global loss: 9.7707| Local H loss: 0.0696  | Global H loss: 0.065 [0m
[94mEpoch: 3|  NKD Loss: 2.1028 | CT Loss: 5.0937| [0m
[91mEpoch: 3|  Loss:  7.361 |Global loss: 9.7682| Local H loss: 0.0703  | Global H loss: 0.065 [0m
[94mEpoch: 0|  NKD Loss: 2.0994 | CT Loss: 5.1295| [0m
[91mEpoch: 0|  Loss:  7.3776 |Global loss: 9.8015| Local H loss: 0.0722  | Global H loss: 0.0672 [0m
[94mEpoch: 1|  NKD Loss: 2.0985 | CT Loss: 5.1274| [0m
[91mEpoch: 1|  Loss:  7.3776 |Global loss: 9.808| Local H loss: 0.0727  | Global H loss: 0.0671 [0m
[94mEpoch: 2|  NKD Loss: 2.1017 | CT Loss: 5.1253| [0m
[91mEpoch: 2|  Loss:  7.3859 |Global loss: 9.8041| Local H loss: 0.073  | Global H loss: 0.0669 [0m
[94mEpoch: 3|  NKD Loss: 2.0975 | CT Loss: 5.1248| [0m
[91mEpoch: 3|  Loss:  7.3717 |Global loss: 9.7976| Local H loss: 0.0728  | Global H loss: 0.0673 [0m
[94mEpoch: 0|  NKD Loss: 2.1249 | CT Loss: 5.1176| [0m
[91mEpoch: 0|  Loss:  7.487 |Global loss: 9.8123| Local H loss: 0.066  | Global H loss: 0.0597 [0m
[94mEpoch: 1|  NKD Loss: 2.1265 | CT Loss: 5.1163| [0m
[91mEpoch: 1|  Loss:  7.495 |Global loss: 9.8107| Local H loss: 0.0655  | Global H loss: 0.0593 [0m
[94mEpoch: 2|  NKD Loss: 2.1206 | CT Loss: 5.1149| [0m
[91mEpoch: 2|  Loss:  7.4684 |Global loss: 9.8079| Local H loss: 0.0668  | Global H loss: 0.0602 [0m
[94mEpoch: 3|  NKD Loss: 2.1301 | CT Loss: 5.1138| [0m
[91mEpoch: 3|  Loss:  7.4987 |Global loss: 9.8095| Local H loss: 0.0643  | Global H loss: 0.0588 [0m
[94mEpoch: 0|  NKD Loss: 2.0998 | CT Loss: 5.0559| [0m
[91mEpoch: 0|  Loss:  7.3127 |Global loss: 9.7391| Local H loss: 0.0734  | Global H loss: 0.0666 [0m
[94mEpoch: 1|  NKD Loss: 2.1017 | CT Loss: 5.0538| [0m
[91mEpoch: 1|  Loss:  7.3147 |Global loss: 9.7343| Local H loss: 0.073  | Global H loss: 0.0663 [0m
[94mEpoch: 2|  NKD Loss: 2.1005 | CT Loss: 5.0529| [0m
[91mEpoch: 2|  Loss:  7.3151 |Global loss: 9.7368| Local H loss: 0.0729  | Global H loss: 0.0661 [0m
[94mEpoch: 3|  NKD Loss: 2.098 | CT Loss: 5.0507| [0m
[91mEpoch: 3|  Loss:  7.3057 |Global loss: 9.7269| Local H loss: 0.0738  | Global H loss: 0.0668 [0m
------------------------- time cost ------------------------- 2.7924296855926514
Chosen Clients:  [14, 12, 7, 1, 9, 4]

-------------Round number: 61-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.975, 0.9, 0.983]
AUC in each clients:  [119.467, 119.987, 119.984, 118.993, 119.984, 119.438, 119.977, 118.993, 118.965, 119.518, 119.962, 119.808, 119.978, 119.008, 118.914]
F1 Score:  [0.973, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.975, 0.903, 0.982]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.977, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 9.2019
Averaged Test Accurancy: 0.9728
Averaged Test AUC: 0.9961
Averaged Test F1_score: 0.9716
Averaged Test Recal score: 0.9757
Std Test Accurancy: 0.0198
Std Test AUC: 0.0036
Std Test F1: 0.0002
Std Test Recall: 0.0001
[94mEpoch: 0|  NKD Loss: 2.0932 | CT Loss: 5.0935| [0m
[91mEpoch: 0|  Loss:  7.3297 |Global loss: 9.7623| Local H loss: 0.0763  | Global H loss: 0.0688 [0m
[94mEpoch: 1|  NKD Loss: 2.0931 | CT Loss: 5.0903| [0m
[91mEpoch: 1|  Loss:  7.3267 |Global loss: 9.7672| Local H loss: 0.0761  | Global H loss: 0.0688 [0m
[94mEpoch: 2|  NKD Loss: 2.0941 | CT Loss: 5.0897| [0m
[91mEpoch: 2|  Loss:  7.3274 |Global loss: 9.7628| Local H loss: 0.076  | Global H loss: 0.0686 [0m
[94mEpoch: 3|  NKD Loss: 2.0897 | CT Loss: 5.0888| [0m
[91mEpoch: 3|  Loss:  7.3196 |Global loss: 9.758| Local H loss: 0.0767  | Global H loss: 0.0692 [0m
[94mEpoch: 0|  NKD Loss: 2.1277 | CT Loss: 5.1217| [0m
[91mEpoch: 0|  Loss:  7.4872 |Global loss: 9.8213| Local H loss: 0.0602  | Global H loss: 0.058 [0m
[94mEpoch: 1|  NKD Loss: 2.1203 | CT Loss: 5.1186| [0m
[91mEpoch: 1|  Loss:  7.4736 |Global loss: 9.8068| Local H loss: 0.0622  | Global H loss: 0.0596 [0m
[94mEpoch: 2|  NKD Loss: 2.12 | CT Loss: 5.1214| [0m
[91mEpoch: 2|  Loss:  7.4718 |Global loss: 9.8185| Local H loss: 0.0612  | Global H loss: 0.0592 [0m
[94mEpoch: 3|  NKD Loss: 2.1092 | CT Loss: 5.1178| [0m
[91mEpoch: 3|  Loss:  7.4325 |Global loss: 9.7998| Local H loss: 0.0641  | Global H loss: 0.0607 [0m
[94mEpoch: 0|  NKD Loss: 2.0958 | CT Loss: 5.0952| [0m
[91mEpoch: 0|  Loss:  7.3383 |Global loss: 9.7799| Local H loss: 0.074  | Global H loss: 0.0678 [0m
[94mEpoch: 1|  NKD Loss: 2.0903 | CT Loss: 5.0932| [0m
[91mEpoch: 1|  Loss:  7.3235 |Global loss: 9.7612| Local H loss: 0.0791  | Global H loss: 0.0698 [0m
[94mEpoch: 2|  NKD Loss: 2.0902 | CT Loss: 5.091| [0m
[91mEpoch: 2|  Loss:  7.3223 |Global loss: 9.7707| Local H loss: 0.0778  | Global H loss: 0.0695 [0m
[94mEpoch: 3|  NKD Loss: 2.0906 | CT Loss: 5.0914| [0m
[91mEpoch: 3|  Loss:  7.3218 |Global loss: 9.7667| Local H loss: 0.0782  | Global H loss: 0.0697 [0m
[94mEpoch: 0|  NKD Loss: 2.0904 | CT Loss: 5.0912| [0m
[91mEpoch: 0|  Loss:  7.3239 |Global loss: 9.7607| Local H loss: 0.0747  | Global H loss: 0.0685 [0m
[94mEpoch: 1|  NKD Loss: 2.0963 | CT Loss: 5.0905| [0m
[91mEpoch: 1|  Loss:  7.3373 |Global loss: 9.768| Local H loss: 0.0729  | Global H loss: 0.0672 [0m
[94mEpoch: 2|  NKD Loss: 2.095 | CT Loss: 5.0887| [0m
[91mEpoch: 2|  Loss:  7.3308 |Global loss: 9.7607| Local H loss: 0.074  | Global H loss: 0.0678 [0m
[94mEpoch: 3|  NKD Loss: 2.0915 | CT Loss: 5.0873| [0m
[91mEpoch: 3|  Loss:  7.3212 |Global loss: 9.7626| Local H loss: 0.0754  | Global H loss: 0.0687 [0m
[94mEpoch: 0|  NKD Loss: 2.0915 | CT Loss: 5.1043| [0m
[91mEpoch: 0|  Loss:  7.3335 |Global loss: 9.7805| Local H loss: 0.0807  | Global H loss: 0.0706 [0m
[94mEpoch: 1|  NKD Loss: 2.0873 | CT Loss: 5.1015| [0m
[91mEpoch: 1|  Loss:  7.3233 |Global loss: 9.7763| Local H loss: 0.0824  | Global H loss: 0.0714 [0m
[94mEpoch: 2|  NKD Loss: 2.0911 | CT Loss: 5.1012| [0m
[91mEpoch: 2|  Loss:  7.3301 |Global loss: 9.7748| Local H loss: 0.0802  | Global H loss: 0.0704 [0m
[94mEpoch: 3|  NKD Loss: 2.0908 | CT Loss: 5.0991| [0m
[91mEpoch: 3|  Loss:  7.3285 |Global loss: 9.7709| Local H loss: 0.0799  | Global H loss: 0.0703 [0m
[94mEpoch: 0|  NKD Loss: 2.1072 | CT Loss: 5.0814| [0m
[91mEpoch: 0|  Loss:  7.3776 |Global loss: 9.7718| Local H loss: 0.0717  | Global H loss: 0.0647 [0m
[94mEpoch: 1|  NKD Loss: 2.1079 | CT Loss: 5.0825| [0m
[91mEpoch: 1|  Loss:  7.3721 |Global loss: 9.7692| Local H loss: 0.0699  | Global H loss: 0.0644 [0m
[94mEpoch: 2|  NKD Loss: 2.1003 | CT Loss: 5.0802| [0m
[91mEpoch: 2|  Loss:  7.3489 |Global loss: 9.7602| Local H loss: 0.0727  | Global H loss: 0.0658 [0m
[94mEpoch: 3|  NKD Loss: 2.1016 | CT Loss: 5.0779| [0m
[91mEpoch: 3|  Loss:  7.3557 |Global loss: 9.7561| Local H loss: 0.0731  | Global H loss: 0.0658 [0m
------------------------- time cost ------------------------- 2.926924467086792
Chosen Clients:  [14, 6, 13, 0, 2, 3]

-------------Round number: 62-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.975, 0.975, 0.983, 0.975, 0.983, 0.942, 0.9, 0.983]
AUC in each clients:  [119.467, 119.971, 119.984, 118.993, 119.964, 119.438, 119.977, 118.992, 118.965, 119.537, 119.962, 119.808, 119.896, 119.008, 118.787]
F1 Score:  [0.973, 0.981, 0.974, 0.973, 0.974, 0.982, 0.974, 0.973, 0.974, 0.982, 0.973, 0.981, 0.95, 0.903, 0.982]
Recall Score:  [0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.977, 0.977, 0.977, 0.984, 0.973, 0.984, 0.956, 0.927, 0.984]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Traceback (most recent call last):
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 599, in <module>
    run(args)
  File "/home/datpd1/datpd/capstone/Fed_2024/system/main.py", line 422, in run
    server.train()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverkdx.py", line 41, in train
    self.evaluate()
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 306, in evaluate
    stats_train = self.train_metrics()
                  ^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/servers/serverbase.py", line 295, in train_metrics
    cl, ns = c.train_metrics()
             ^^^^^^^^^^^^^^^^^
  File "/home/datpd1/datpd/capstone/Fed_2024/system/flcore/clients/clientkdx.py", line 237, in train_metrics
    loss_ct = self.contras_loss(rep, rep_g)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/datpd1/miniconda3/envs/datpd1/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1732, in _wrapped_call_impl
    def _wrapped_call_impl(self, *args, **kwargs):

KeyboardInterrupt
