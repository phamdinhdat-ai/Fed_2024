
Join ratio / total clients: 0.4 / 15
Finished creating server and clients.
Chosen Clients:  [12, 3, 10, 8, 0, 11]

-------------Round number: 0-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [55.643, 56.061, 56.199, 55.793, 55.244, 54.868, 54.586, 56.947, 53.139, 53.533, 54.657, 55.298, 55.599, 55.867, 54.981]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2917
Averaged Test Accurancy: 0.0667
Averaged Test AUC: 0.4602
Averaged Test F1_score: 0.0100
Averaged Test Recal score: 0.0830
Std Test Accurancy: 0.0000
Std Test AUC: 0.0080
Std Test F1: 0.0000
Std Test Recall: 0.0000
Epoch: 0|  NKD Loss: 3.8016
Epoch: 0|  Loss:  6.2909 |Global loss: 6.2911| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.8014
Epoch: 1|  Loss:  6.2902 |Global loss: 6.2909| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.8013
Epoch: 2|  Loss:  6.29 |Global loss: 6.291| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.2891 |Global loss: 6.2903| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.8017
Epoch: 0|  Loss:  6.2901 |Global loss: 6.2903| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.8016
Epoch: 1|  Loss:  6.2891 |Global loss: 6.2898| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.8015
Epoch: 2|  Loss:  6.2882 |Global loss: 6.2892| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.8015
Epoch: 3|  Loss:  6.2864 |Global loss: 6.2879| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.8016
Epoch: 0|  Loss:  6.2902 |Global loss: 6.2904| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.8015
Epoch: 1|  Loss:  6.2893 |Global loss: 6.2901| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.8015
Epoch: 2|  Loss:  6.2878 |Global loss: 6.2891| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.288 |Global loss: 6.2897| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.8015
Epoch: 0|  Loss:  6.2913 |Global loss: 6.2914| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.8015
Epoch: 1|  Loss:  6.2897 |Global loss: 6.2904| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.8013
Epoch: 2|  Loss:  6.2896 |Global loss: 6.2907| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.2888 |Global loss: 6.2903| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.8017
Epoch: 0|  Loss:  6.2906 |Global loss: 6.2907| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.8016
Epoch: 1|  Loss:  6.2894 |Global loss: 6.2899| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.8015
Epoch: 2|  Loss:  6.2889 |Global loss: 6.2897| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.8015
Epoch: 3|  Loss:  6.2877 |Global loss: 6.2887| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.8016
Epoch: 0|  Loss:  6.2911 |Global loss: 6.2912| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 1|  NKD Loss: 3.8013
Epoch: 1|  Loss:  6.2913 |Global loss: 6.2919| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 2|  NKD Loss: 3.8013
Epoch: 2|  Loss:  6.2905 |Global loss: 6.2912| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.289 |Global loss: 6.2898| Local H loss: 0.0045  | Global H loss: 0.0045
------------------------- time cost ------------------------- 3.407057523727417
Chosen Clients:  [2, 4, 11, 1, 14, 5]

-------------Round number: 1-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.117, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [58.144, 56.061, 56.199, 58.924, 55.244, 54.868, 54.586, 56.947, 56.286, 53.533, 58.038, 58.456, 57.371, 55.867, 54.981]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.064, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2893
Averaged Test Accurancy: 0.0700
Averaged Test AUC: 0.4697
Averaged Test F1_score: 0.0136
Averaged Test Recal score: 0.0886
Std Test Accurancy: 0.0125
Std Test AUC: 0.0128
Std Test F1: 0.0001
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 3.802
Epoch: 0|  Loss:  6.2906 |Global loss: 6.2903| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8019
Epoch: 1|  Loss:  6.2886 |Global loss: 6.2896| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.8016
Epoch: 2|  Loss:  6.2879 |Global loss: 6.2899| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8015
Epoch: 3|  Loss:  6.2874 |Global loss: 6.2898| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.802
Epoch: 0|  Loss:  6.2907 |Global loss: 6.2902| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.8019
Epoch: 1|  Loss:  6.2899 |Global loss: 6.2902| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 2|  NKD Loss: 3.8017
Epoch: 2|  Loss:  6.289 |Global loss: 6.29| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.8016
Epoch: 3|  Loss:  6.2883 |Global loss: 6.2898| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.8018
Epoch: 0|  Loss:  6.2885 |Global loss: 6.2903| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.8017
Epoch: 1|  Loss:  6.2874 |Global loss: 6.2898| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.8016
Epoch: 2|  Loss:  6.2865 |Global loss: 6.2895| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.8014
Epoch: 3|  Loss:  6.2865 |Global loss: 6.2901| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.8018
Epoch: 0|  Loss:  6.2901 |Global loss: 6.2906| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.8017
Epoch: 1|  Loss:  6.2895 |Global loss: 6.2905| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8016
Epoch: 2|  Loss:  6.2886 |Global loss: 6.29| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.8016
Epoch: 3|  Loss:  6.2876 |Global loss: 6.2897| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.802
Epoch: 0|  Loss:  6.2908 |Global loss: 6.2902| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8019
Epoch: 1|  Loss:  6.2896 |Global loss: 6.2899| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.8017
Epoch: 2|  Loss:  6.2892 |Global loss: 6.2903| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8015
Epoch: 3|  Loss:  6.2886 |Global loss: 6.2902| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.8021
Epoch: 0|  Loss:  6.2897 |Global loss: 6.2895| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8017
Epoch: 1|  Loss:  6.2899 |Global loss: 6.2907| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8016
Epoch: 2|  Loss:  6.2887 |Global loss: 6.2904| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8015
Epoch: 3|  Loss:  6.2881 |Global loss: 6.2902| Local H loss: 0.0031  | Global H loss: 0.0031
------------------------- time cost ------------------------- 2.8106422424316406
Chosen Clients:  [10, 2, 4, 3, 6, 14]

-------------Round number: 2-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.117, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [58.144, 59.21, 58.64, 58.924, 57.808, 57.631, 54.586, 56.947, 56.286, 53.533, 58.038, 58.805, 57.371, 55.867, 57.884]
F1 Score:  [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.064, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2880
Averaged Test Accurancy: 0.0700
Averaged Test AUC: 0.4776
Averaged Test F1_score: 0.0136
Averaged Test Recal score: 0.0886
Std Test Accurancy: 0.0125
Std Test AUC: 0.0131
Std Test F1: 0.0001
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2853 |Global loss: 6.2893| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.8013
Epoch: 1|  Loss:  6.2841 |Global loss: 6.2886| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.8011
Epoch: 2|  Loss:  6.2837 |Global loss: 6.2889| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.8009
Epoch: 3|  Loss:  6.2831 |Global loss: 6.289| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.8014
Epoch: 0|  Loss:  6.2866 |Global loss: 6.2898| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.8013
Epoch: 1|  Loss:  6.2857 |Global loss: 6.2896| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.8012
Epoch: 2|  Loss:  6.2848 |Global loss: 6.2892| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.801
Epoch: 3|  Loss:  6.2849 |Global loss: 6.2899| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8015
Epoch: 0|  Loss:  6.2877 |Global loss: 6.2895| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8013
Epoch: 1|  Loss:  6.287 |Global loss: 6.2897| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8012
Epoch: 2|  Loss:  6.2866 |Global loss: 6.2896| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.2854 |Global loss: 6.2887| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2853 |Global loss: 6.2894| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8011
Epoch: 1|  Loss:  6.2853 |Global loss: 6.2903| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.801
Epoch: 2|  Loss:  6.284 |Global loss: 6.2897| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.801
Epoch: 3|  Loss:  6.282 |Global loss: 6.2886| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.8018
Epoch: 0|  Loss:  6.2901 |Global loss: 6.2894| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8016
Epoch: 1|  Loss:  6.2896 |Global loss: 6.2897| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8013
Epoch: 2|  Loss:  6.2895 |Global loss: 6.2904| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8014
Epoch: 3|  Loss:  6.2874 |Global loss: 6.2889| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8014
Epoch: 0|  Loss:  6.2877 |Global loss: 6.29| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.8012
Epoch: 1|  Loss:  6.2879 |Global loss: 6.2907| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.8014
Epoch: 2|  Loss:  6.2857 |Global loss: 6.2888| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.8012
Epoch: 3|  Loss:  6.2855 |Global loss: 6.2892| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.7516164779663086
Chosen Clients:  [14, 8, 3, 6, 4, 0]

-------------Round number: 3-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.067, 0.117, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [58.144, 59.21, 58.633, 60.712, 58.29, 57.631, 57.269, 56.947, 56.286, 53.533, 58.73, 58.805, 57.371, 55.867, 59.098]
F1 Score:  [0.01, 0.01, 0.014, 0.014, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.044, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2869
Averaged Test Accurancy: 0.0700
Averaged Test AUC: 0.4814
Averaged Test F1_score: 0.0128
Averaged Test Recal score: 0.0886
Std Test Accurancy: 0.0125
Std Test AUC: 0.0137
Std Test F1: 0.0001
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 3.801
Epoch: 0|  Loss:  6.2859 |Global loss: 6.2901| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8011
Epoch: 1|  Loss:  6.2845 |Global loss: 6.2888| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  6.2841 |Global loss: 6.2891| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8008
Epoch: 3|  Loss:  6.2838 |Global loss: 6.2892| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2868 |Global loss: 6.289| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.801
Epoch: 1|  Loss:  6.2867 |Global loss: 6.2896| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.8008
Epoch: 2|  Loss:  6.2861 |Global loss: 6.2899| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.801
Epoch: 3|  Loss:  6.2842 |Global loss: 6.2884| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.8011
Epoch: 0|  Loss:  6.2808 |Global loss: 6.2876| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8007
Epoch: 1|  Loss:  6.2817 |Global loss: 6.2894| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8007
Epoch: 2|  Loss:  6.2804 |Global loss: 6.2886| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8006
Epoch: 3|  Loss:  6.2794 |Global loss: 6.2882| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2872 |Global loss: 6.2891| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.801
Epoch: 1|  Loss:  6.2875 |Global loss: 6.2901| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  6.2866 |Global loss: 6.29| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8008
Epoch: 3|  Loss:  6.2862 |Global loss: 6.2898| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.801
Epoch: 0|  Loss:  6.2862 |Global loss: 6.2899| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.8011
Epoch: 1|  Loss:  6.2846 |Global loss: 6.2885| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.8009
Epoch: 2|  Loss:  6.2845 |Global loss: 6.289| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8009
Epoch: 3|  Loss:  6.2834 |Global loss: 6.2881| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.8011
Epoch: 0|  Loss:  6.2876 |Global loss: 6.29| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.8012
Epoch: 1|  Loss:  6.286 |Global loss: 6.2889| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8011
Epoch: 2|  Loss:  6.2855 |Global loss: 6.2887| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8009
Epoch: 3|  Loss:  6.2853 |Global loss: 6.2893| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.9873554706573486
Chosen Clients:  [9, 8, 13, 0, 4, 14]

-------------Round number: 4-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.133, 0.067, 0.067, 0.067, 0.067, 0.133, 0.067, 0.117, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [58.923, 59.21, 58.633, 61.947, 59.048, 57.631, 58.388, 56.947, 58.486, 53.533, 58.73, 58.805, 57.371, 55.867, 59.869]
F1 Score:  [0.01, 0.01, 0.014, 0.043, 0.01, 0.01, 0.01, 0.01, 0.045, 0.01, 0.044, 0.01, 0.01, 0.01, 0.01]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2852
Averaged Test Accurancy: 0.0789
Averaged Test AUC: 0.4852
Averaged Test F1_score: 0.0171
Averaged Test Recal score: 0.0998
Std Test Accurancy: 0.0247
Std Test AUC: 0.0152
Std Test F1: 0.0001
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2902 |Global loss: 6.2893| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.801
Epoch: 1|  Loss:  6.2894 |Global loss: 6.2898| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8008
Epoch: 2|  Loss:  6.2894 |Global loss: 6.2905| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.8009
Epoch: 3|  Loss:  6.2874 |Global loss: 6.2889| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.2842 |Global loss: 6.289| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.8007
Epoch: 1|  Loss:  6.2835 |Global loss: 6.289| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.8006
Epoch: 2|  Loss:  6.2828 |Global loss: 6.2886| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.8004
Epoch: 3|  Loss:  6.2826 |Global loss: 6.2891| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.8013
Epoch: 0|  Loss:  6.2881 |Global loss: 6.2886| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.8009
Epoch: 1|  Loss:  6.2877 |Global loss: 6.2899| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8008
Epoch: 2|  Loss:  6.2866 |Global loss: 6.2895| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.8008
Epoch: 3|  Loss:  6.2847 |Global loss: 6.2884| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8011
Epoch: 0|  Loss:  6.2839 |Global loss: 6.2876| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8008
Epoch: 1|  Loss:  6.2843 |Global loss: 6.2887| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8005
Epoch: 2|  Loss:  6.2846 |Global loss: 6.2899| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8007
Epoch: 3|  Loss:  6.2832 |Global loss: 6.2881| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.2829 |Global loss: 6.2881| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8005
Epoch: 1|  Loss:  6.2832 |Global loss: 6.2891| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8005
Epoch: 2|  Loss:  6.2828 |Global loss: 6.2889| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8005
Epoch: 3|  Loss:  6.2817 |Global loss: 6.2882| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.8007
Epoch: 0|  Loss:  6.2832 |Global loss: 6.289| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.8007
Epoch: 1|  Loss:  6.2821 |Global loss: 6.2884| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8006
Epoch: 2|  Loss:  6.282 |Global loss: 6.2884| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.8005
Epoch: 3|  Loss:  6.2813 |Global loss: 6.2884| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 2.962329387664795
Chosen Clients:  [10, 3, 14, 8, 5, 12]

-------------Round number: 5-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.133, 0.067, 0.067, 0.067, 0.067, 0.133, 0.067, 0.117, 0.067, 0.067, 0.067, 0.067]
AUC in each clients:  [60.303, 59.21, 58.633, 61.947, 60.018, 57.631, 58.388, 56.947, 59.598, 57.364, 58.73, 58.805, 57.371, 58.501, 60.227]
F1 Score:  [0.01, 0.01, 0.014, 0.043, 0.01, 0.01, 0.01, 0.01, 0.045, 0.01, 0.044, 0.01, 0.01, 0.01, 0.011]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2842
Averaged Test Accurancy: 0.0789
Averaged Test AUC: 0.4909
Averaged Test F1_score: 0.0171
Averaged Test Recal score: 0.0998
Std Test Accurancy: 0.0247
Std Test AUC: 0.0109
Std Test F1: 0.0001
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.8003
Epoch: 0|  Loss:  6.282 |Global loss: 6.289| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.8002
Epoch: 1|  Loss:  6.2815 |Global loss: 6.2888| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.8003
Epoch: 2|  Loss:  6.2798 |Global loss: 6.2876| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.8
Epoch: 3|  Loss:  6.28 |Global loss: 6.2886| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.8002
Epoch: 0|  Loss:  6.2786 |Global loss: 6.2882| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.8
Epoch: 1|  Loss:  6.2784 |Global loss: 6.2886| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2767 |Global loss: 6.2876| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7997
Epoch: 3|  Loss:  6.2769 |Global loss: 6.2886| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.8006
Epoch: 0|  Loss:  6.2803 |Global loss: 6.2874| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.8003
Epoch: 1|  Loss:  6.2809 |Global loss: 6.2887| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2799 |Global loss: 6.2885| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.8002
Epoch: 3|  Loss:  6.2794 |Global loss: 6.2881| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.8005
Epoch: 0|  Loss:  6.281 |Global loss: 6.2877| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.8002
Epoch: 1|  Loss:  6.2813 |Global loss: 6.289| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.8002
Epoch: 2|  Loss:  6.2804 |Global loss: 6.2882| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.8002
Epoch: 3|  Loss:  6.2797 |Global loss: 6.2878| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.8007
Epoch: 0|  Loss:  6.2868 |Global loss: 6.2894| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.8006
Epoch: 1|  Loss:  6.2863 |Global loss: 6.2892| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8005
Epoch: 2|  Loss:  6.2862 |Global loss: 6.2895| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8005
Epoch: 3|  Loss:  6.2847 |Global loss: 6.2883| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.8008
Epoch: 0|  Loss:  6.2863 |Global loss: 6.2889| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.8008
Epoch: 1|  Loss:  6.2853 |Global loss: 6.2881| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.8006
Epoch: 2|  Loss:  6.2854 |Global loss: 6.2887| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.8005
Epoch: 3|  Loss:  6.2845 |Global loss: 6.2884| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 3.0254201889038086
Chosen Clients:  [9, 1, 10, 6, 2, 5]

-------------Round number: 6-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.067, 0.183, 0.067, 0.067, 0.067, 0.067, 0.133, 0.067, 0.117, 0.067, 0.067, 0.067, 0.1]
AUC in each clients:  [60.303, 59.21, 58.633, 63.673, 60.018, 59.068, 58.388, 56.947, 60.394, 57.364, 59.913, 58.805, 58.111, 58.501, 60.617]
F1 Score:  [0.01, 0.01, 0.014, 0.079, 0.01, 0.01, 0.01, 0.01, 0.048, 0.01, 0.044, 0.01, 0.01, 0.01, 0.031]
Recall Score:  [0.083, 0.083, 0.083, 0.25, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2830
Averaged Test Accurancy: 0.0844
Averaged Test AUC: 0.4944
Averaged Test F1_score: 0.0211
Averaged Test Recal score: 0.1091
Std Test Accurancy: 0.0336
Std Test AUC: 0.0131
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.8005
Epoch: 0|  Loss:  6.2867 |Global loss: 6.289| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8006
Epoch: 1|  Loss:  6.2848 |Global loss: 6.2873| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8003
Epoch: 2|  Loss:  6.2851 |Global loss: 6.2882| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8002
Epoch: 3|  Loss:  6.2844 |Global loss: 6.2882| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.8004
Epoch: 0|  Loss:  6.2866 |Global loss: 6.2895| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8004
Epoch: 1|  Loss:  6.2854 |Global loss: 6.2886| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2854 |Global loss: 6.2897| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.8003
Epoch: 3|  Loss:  6.2838 |Global loss: 6.2879| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.8001
Epoch: 0|  Loss:  6.2782 |Global loss: 6.2871| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  6.2785 |Global loss: 6.288| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7998
Epoch: 2|  Loss:  6.2775 |Global loss: 6.2877| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7996
Epoch: 3|  Loss:  6.2774 |Global loss: 6.2882| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.8003
Epoch: 0|  Loss:  6.2848 |Global loss: 6.289| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.8001
Epoch: 1|  Loss:  6.2845 |Global loss: 6.2894| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2837 |Global loss: 6.2889| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8
Epoch: 3|  Loss:  6.2829 |Global loss: 6.2888| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.8004
Epoch: 0|  Loss:  6.2827 |Global loss: 6.288| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.8004
Epoch: 1|  Loss:  6.2815 |Global loss: 6.2872| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2819 |Global loss: 6.2882| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7998
Epoch: 3|  Loss:  6.2819 |Global loss: 6.289| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.8002
Epoch: 0|  Loss:  6.2856 |Global loss: 6.2898| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.8005
Epoch: 1|  Loss:  6.2837 |Global loss: 6.2876| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.8004
Epoch: 2|  Loss:  6.2829 |Global loss: 6.2872| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.8
Epoch: 3|  Loss:  6.284 |Global loss: 6.289| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 3.0681304931640625
Chosen Clients:  [11, 6, 7, 3, 10, 2]

-------------Round number: 7-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.117, 0.183, 0.067, 0.067, 0.067, 0.067, 0.133, 0.067, 0.117, 0.067, 0.067, 0.067, 0.1]
AUC in each clients:  [60.303, 59.7, 59.289, 63.673, 60.018, 59.515, 59.878, 56.947, 60.394, 58.145, 60.717, 58.805, 58.111, 58.501, 60.617]
F1 Score:  [0.01, 0.01, 0.063, 0.079, 0.01, 0.01, 0.01, 0.01, 0.048, 0.01, 0.053, 0.01, 0.01, 0.01, 0.031]
Recall Score:  [0.083, 0.083, 0.167, 0.25, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2819
Averaged Test Accurancy: 0.0878
Averaged Test AUC: 0.4970
Averaged Test F1_score: 0.0249
Averaged Test Recal score: 0.1147
Std Test Accurancy: 0.0341
Std Test AUC: 0.0125
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.8002
Epoch: 0|  Loss:  6.2848 |Global loss: 6.2887| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.8002
Epoch: 1|  Loss:  6.2834 |Global loss: 6.2877| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.8
Epoch: 2|  Loss:  6.2833 |Global loss: 6.2882| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7999
Epoch: 3|  Loss:  6.2826 |Global loss: 6.2877| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.8
Epoch: 0|  Loss:  6.282 |Global loss: 6.2883| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.8
Epoch: 1|  Loss:  6.2818 |Global loss: 6.2881| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.8001
Epoch: 2|  Loss:  6.2802 |Global loss: 6.2865| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7999
Epoch: 3|  Loss:  6.2799 |Global loss: 6.2867| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.8005
Epoch: 0|  Loss:  6.288 |Global loss: 6.2887| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.8004
Epoch: 1|  Loss:  6.2861 |Global loss: 6.2881| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.8003
Epoch: 2|  Loss:  6.2841 |Global loss: 6.2871| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.8002
Epoch: 3|  Loss:  6.2833 |Global loss: 6.2871| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7997
Epoch: 0|  Loss:  6.2747 |Global loss: 6.2868| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7996
Epoch: 1|  Loss:  6.2732 |Global loss: 6.286| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7995
Epoch: 2|  Loss:  6.2731 |Global loss: 6.2861| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7989
Epoch: 3|  Loss:  6.2737 |Global loss: 6.2884| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7995
Epoch: 0|  Loss:  6.277 |Global loss: 6.2886| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7997
Epoch: 1|  Loss:  6.2755 |Global loss: 6.2868| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7993
Epoch: 2|  Loss:  6.2756 |Global loss: 6.2878| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7995
Epoch: 3|  Loss:  6.2738 |Global loss: 6.2861| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7999
Epoch: 0|  Loss:  6.2808 |Global loss: 6.2883| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  6.2796 |Global loss: 6.2875| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7998
Epoch: 2|  Loss:  6.279 |Global loss: 6.2874| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7997
Epoch: 3|  Loss:  6.2781 |Global loss: 6.2869| Local H loss: 0.0029  | Global H loss: 0.0029
------------------------- time cost ------------------------- 3.002270460128784
Chosen Clients:  [8, 6, 12, 5, 4, 10]

-------------Round number: 8-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.05, 0.117, 0.067, 0.067, 0.067, 0.067, 0.133, 0.067, 0.117, 0.067, 0.067, 0.067, 0.1]
AUC in each clients:  [60.303, 59.7, 60.295, 64.504, 60.018, 59.515, 60.948, 60.114, 60.394, 58.145, 61.677, 58.852, 58.111, 58.501, 60.617]
F1 Score:  [0.01, 0.01, 0.008, 0.037, 0.01, 0.01, 0.012, 0.01, 0.048, 0.01, 0.053, 0.011, 0.01, 0.01, 0.031]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2807
Averaged Test Accurancy: 0.0789
Averaged Test AUC: 0.5009
Averaged Test F1_score: 0.0187
Averaged Test Recal score: 0.1035
Std Test Accurancy: 0.0239
Std Test AUC: 0.0128
Std Test F1: 0.0001
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7997
Epoch: 0|  Loss:  6.2784 |Global loss: 6.2871| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7995
Epoch: 1|  Loss:  6.2778 |Global loss: 6.2876| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7994
Epoch: 2|  Loss:  6.2771 |Global loss: 6.2874| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7994
Epoch: 3|  Loss:  6.2763 |Global loss: 6.2865| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7997
Epoch: 0|  Loss:  6.28 |Global loss: 6.2874| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7994
Epoch: 1|  Loss:  6.2807 |Global loss: 6.2886| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7994
Epoch: 2|  Loss:  6.2795 |Global loss: 6.2878| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7995
Epoch: 3|  Loss:  6.2784 |Global loss: 6.2866| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7999
Epoch: 0|  Loss:  6.2838 |Global loss: 6.2884| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  6.2826 |Global loss: 6.2874| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7997
Epoch: 2|  Loss:  6.2829 |Global loss: 6.2881| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7999
Epoch: 3|  Loss:  6.2811 |Global loss: 6.2864| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7999
Epoch: 0|  Loss:  6.2823 |Global loss: 6.2874| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7999
Epoch: 1|  Loss:  6.2812 |Global loss: 6.2864| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7994
Epoch: 2|  Loss:  6.2823 |Global loss: 6.2885| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7994
Epoch: 3|  Loss:  6.2814 |Global loss: 6.288| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7998
Epoch: 0|  Loss:  6.2802 |Global loss: 6.2869| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7997
Epoch: 1|  Loss:  6.2795 |Global loss: 6.2865| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7995
Epoch: 2|  Loss:  6.2793 |Global loss: 6.2867| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7993
Epoch: 3|  Loss:  6.279 |Global loss: 6.2871| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7993
Epoch: 0|  Loss:  6.2732 |Global loss: 6.2867| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7992
Epoch: 1|  Loss:  6.2724 |Global loss: 6.2861| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7993
Epoch: 2|  Loss:  6.2711 |Global loss: 6.2851| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7989
Epoch: 3|  Loss:  6.2709 |Global loss: 6.2858| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 2.9232380390167236
Chosen Clients:  [5, 1, 8, 13, 12, 9]

-------------Round number: 9-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.05, 0.117, 0.067, 0.067, 0.067, 0.067, 0.183, 0.067, 0.117, 0.067, 0.067, 0.067, 0.1]
AUC in each clients:  [60.303, 59.7, 60.295, 64.504, 60.111, 60.456, 61.633, 60.114, 61.701, 58.145, 62.113, 58.852, 59.144, 58.501, 60.617]
F1 Score:  [0.01, 0.01, 0.008, 0.037, 0.01, 0.01, 0.014, 0.01, 0.122, 0.01, 0.053, 0.011, 0.02, 0.01, 0.031]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.25, 0.083, 0.167, 0.083, 0.083, 0.083, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2796
Averaged Test Accurancy: 0.0822
Averaged Test AUC: 0.5034
Averaged Test F1_score: 0.0244
Averaged Test Recal score: 0.1091
Std Test Accurancy: 0.0330
Std Test AUC: 0.0130
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7994
Epoch: 0|  Loss:  6.2804 |Global loss: 6.2872| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7993
Epoch: 1|  Loss:  6.2801 |Global loss: 6.287| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7991
Epoch: 2|  Loss:  6.2801 |Global loss: 6.2875| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7991
Epoch: 3|  Loss:  6.2793 |Global loss: 6.2868| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7996
Epoch: 0|  Loss:  6.2832 |Global loss: 6.2882| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7997
Epoch: 1|  Loss:  6.2818 |Global loss: 6.2867| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7996
Epoch: 2|  Loss:  6.2814 |Global loss: 6.2867| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7992
Epoch: 3|  Loss:  6.2818 |Global loss: 6.2878| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7992
Epoch: 0|  Loss:  6.2755 |Global loss: 6.2865| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.799
Epoch: 1|  Loss:  6.2751 |Global loss: 6.2869| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.799
Epoch: 2|  Loss:  6.2747 |Global loss: 6.2867| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7989
Epoch: 3|  Loss:  6.2728 |Global loss: 6.2856| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7998
Epoch: 0|  Loss:  6.2831 |Global loss: 6.2876| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7998
Epoch: 1|  Loss:  6.2817 |Global loss: 6.2868| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7993
Epoch: 2|  Loss:  6.2822 |Global loss: 6.2887| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7993
Epoch: 3|  Loss:  6.2809 |Global loss: 6.2879| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7996
Epoch: 0|  Loss:  6.281 |Global loss: 6.2871| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7991
Epoch: 1|  Loss:  6.2816 |Global loss: 6.2889| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7991
Epoch: 2|  Loss:  6.2802 |Global loss: 6.288| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7992
Epoch: 3|  Loss:  6.2794 |Global loss: 6.2871| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7994
Epoch: 0|  Loss:  6.2847 |Global loss: 6.2895| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7995
Epoch: 1|  Loss:  6.2831 |Global loss: 6.2879| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7995
Epoch: 2|  Loss:  6.2823 |Global loss: 6.2872| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7993
Epoch: 3|  Loss:  6.2817 |Global loss: 6.2874| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 2.9602842330932617
Chosen Clients:  [1, 13, 2, 6, 8, 12]

-------------Round number: 10-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.05, 0.117, 0.067, 0.067, 0.067, 0.067, 0.183, 0.067, 0.117, 0.067, 0.117, 0.133, 0.1]
AUC in each clients:  [60.303, 60.234, 60.295, 64.504, 60.111, 60.77, 61.633, 60.114, 63.121, 59.433, 62.113, 58.852, 59.775, 60.107, 60.617]
F1 Score:  [0.01, 0.01, 0.008, 0.037, 0.01, 0.01, 0.014, 0.01, 0.126, 0.01, 0.053, 0.011, 0.063, 0.04, 0.031]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.25, 0.083, 0.167, 0.083, 0.167, 0.167, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2784
Averaged Test Accurancy: 0.0900
Averaged Test AUC: 0.5067
Averaged Test F1_score: 0.0295
Averaged Test Recal score: 0.1203
Std Test Accurancy: 0.0354
Std Test AUC: 0.0119
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7995
Epoch: 0|  Loss:  6.2802 |Global loss: 6.2857| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7994
Epoch: 1|  Loss:  6.2791 |Global loss: 6.2852| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.799
Epoch: 2|  Loss:  6.2797 |Global loss: 6.2865| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7988
Epoch: 3|  Loss:  6.2795 |Global loss: 6.2866| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7991
Epoch: 0|  Loss:  6.2808 |Global loss: 6.2884| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7993
Epoch: 1|  Loss:  6.2784 |Global loss: 6.2862| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7988
Epoch: 2|  Loss:  6.2795 |Global loss: 6.2881| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7986
Epoch: 3|  Loss:  6.279 |Global loss: 6.2885| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7988
Epoch: 0|  Loss:  6.2779 |Global loss: 6.2879| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7988
Epoch: 1|  Loss:  6.2769 |Global loss: 6.2872| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7985
Epoch: 2|  Loss:  6.277 |Global loss: 6.288| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7986
Epoch: 3|  Loss:  6.2757 |Global loss: 6.287| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7992
Epoch: 0|  Loss:  6.2772 |Global loss: 6.2857| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7987
Epoch: 1|  Loss:  6.2779 |Global loss: 6.2877| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7986
Epoch: 2|  Loss:  6.278 |Global loss: 6.288| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7986
Epoch: 3|  Loss:  6.2766 |Global loss: 6.2868| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7986
Epoch: 0|  Loss:  6.2737 |Global loss: 6.2872| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7988
Epoch: 1|  Loss:  6.2716 |Global loss: 6.2852| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7986
Epoch: 2|  Loss:  6.271 |Global loss: 6.2852| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7983
Epoch: 3|  Loss:  6.2704 |Global loss: 6.286| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7992
Epoch: 0|  Loss:  6.2785 |Global loss: 6.2867| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7989
Epoch: 1|  Loss:  6.2786 |Global loss: 6.2873| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7987
Epoch: 2|  Loss:  6.278 |Global loss: 6.2874| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7983
Epoch: 3|  Loss:  6.2787 |Global loss: 6.2892| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 3.1024398803710938
Chosen Clients:  [5, 8, 7, 14, 9, 3]

-------------Round number: 11-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.05, 0.117, 0.067, 0.067, 0.15, 0.067, 0.183, 0.067, 0.117, 0.067, 0.117, 0.183, 0.1]
AUC in each clients:  [60.303, 60.789, 60.515, 64.504, 60.111, 60.77, 61.994, 60.114, 63.439, 59.433, 62.113, 58.852, 60.455, 60.157, 60.617]
F1 Score:  [0.01, 0.01, 0.008, 0.037, 0.01, 0.01, 0.064, 0.01, 0.126, 0.01, 0.053, 0.011, 0.092, 0.093, 0.031]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.194, 0.083, 0.25, 0.083, 0.167, 0.083, 0.167, 0.25, 0.139]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2771
Averaged Test Accurancy: 0.0989
Averaged Test AUC: 0.5079
Averaged Test F1_score: 0.0383
Averaged Test Recal score: 0.1332
Std Test Accurancy: 0.0428
Std Test AUC: 0.0120
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7987
Epoch: 0|  Loss:  6.2786 |Global loss: 6.2868| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7984
Epoch: 1|  Loss:  6.2788 |Global loss: 6.2875| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7983
Epoch: 2|  Loss:  6.2785 |Global loss: 6.2875| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7983
Epoch: 3|  Loss:  6.278 |Global loss: 6.287| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7981
Epoch: 0|  Loss:  6.2699 |Global loss: 6.2863| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7982
Epoch: 1|  Loss:  6.2687 |Global loss: 6.2849| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  6.268 |Global loss: 6.285| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.798
Epoch: 3|  Loss:  6.2664 |Global loss: 6.2837| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7991
Epoch: 0|  Loss:  6.2827 |Global loss: 6.2878| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7988
Epoch: 1|  Loss:  6.2821 |Global loss: 6.2886| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.799
Epoch: 2|  Loss:  6.2806 |Global loss: 6.2869| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7988
Epoch: 3|  Loss:  6.2798 |Global loss: 6.2869| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7991
Epoch: 0|  Loss:  6.2772 |Global loss: 6.286| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7987
Epoch: 1|  Loss:  6.2774 |Global loss: 6.2872| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7986
Epoch: 2|  Loss:  6.2766 |Global loss: 6.2868| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7983
Epoch: 3|  Loss:  6.2769 |Global loss: 6.2879| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7987
Epoch: 0|  Loss:  6.2816 |Global loss: 6.2883| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7986
Epoch: 1|  Loss:  6.2811 |Global loss: 6.2882| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7987
Epoch: 2|  Loss:  6.2798 |Global loss: 6.2869| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7985
Epoch: 3|  Loss:  6.2797 |Global loss: 6.2873| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7982
Epoch: 0|  Loss:  6.2725 |Global loss: 6.2875| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.798
Epoch: 1|  Loss:  6.271 |Global loss: 6.287| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  6.2698 |Global loss: 6.2861| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7977
Epoch: 3|  Loss:  6.2698 |Global loss: 6.2872| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 2.915874719619751
Chosen Clients:  [1, 10, 8, 14, 4, 11]

-------------Round number: 12-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.067, 0.05, 0.117, 0.067, 0.067, 0.15, 0.067, 0.183, 0.067, 0.117, 0.067, 0.117, 0.183, 0.117]
AUC in each clients:  [60.303, 60.789, 60.515, 65.183, 60.111, 60.917, 61.994, 61.507, 64.359, 60.4, 62.113, 58.852, 60.455, 60.157, 61.37]
F1 Score:  [0.01, 0.01, 0.008, 0.037, 0.01, 0.01, 0.064, 0.014, 0.126, 0.01, 0.053, 0.011, 0.092, 0.093, 0.047]
Recall Score:  [0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.194, 0.083, 0.25, 0.083, 0.167, 0.083, 0.167, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2760
Averaged Test Accurancy: 0.1000
Averaged Test AUC: 0.5106
Averaged Test F1_score: 0.0397
Averaged Test Recal score: 0.1351
Std Test Accurancy: 0.0430
Std Test AUC: 0.0132
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7981
Epoch: 0|  Loss:  6.2801 |Global loss: 6.2887| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7983
Epoch: 1|  Loss:  6.2788 |Global loss: 6.2869| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7982
Epoch: 2|  Loss:  6.278 |Global loss: 6.2865| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7982
Epoch: 3|  Loss:  6.2767 |Global loss: 6.2854| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7977
Epoch: 0|  Loss:  6.2715 |Global loss: 6.2873| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 1|  NKD Loss: 3.7978
Epoch: 1|  Loss:  6.2695 |Global loss: 6.2857| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7973
Epoch: 2|  Loss:  6.2702 |Global loss: 6.2875| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 3|  NKD Loss: 3.7975
Epoch: 3|  Loss:  6.2676 |Global loss: 6.2851| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7977
Epoch: 0|  Loss:  6.2668 |Global loss: 6.2852| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7972
Epoch: 1|  Loss:  6.2668 |Global loss: 6.2867| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7973
Epoch: 2|  Loss:  6.266 |Global loss: 6.2858| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.797
Epoch: 3|  Loss:  6.2643 |Global loss: 6.2856| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7986
Epoch: 0|  Loss:  6.2746 |Global loss: 6.285| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7983
Epoch: 1|  Loss:  6.2749 |Global loss: 6.2861| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7981
Epoch: 2|  Loss:  6.2741 |Global loss: 6.286| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7979
Epoch: 3|  Loss:  6.2737 |Global loss: 6.2862| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7983
Epoch: 0|  Loss:  6.2784 |Global loss: 6.2873| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7984
Epoch: 1|  Loss:  6.2772 |Global loss: 6.2862| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7981
Epoch: 2|  Loss:  6.2773 |Global loss: 6.2869| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7979
Epoch: 3|  Loss:  6.2767 |Global loss: 6.2871| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7988
Epoch: 0|  Loss:  6.2809 |Global loss: 6.2869| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7987
Epoch: 1|  Loss:  6.2804 |Global loss: 6.2867| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7985
Epoch: 2|  Loss:  6.28 |Global loss: 6.2867| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7982
Epoch: 3|  Loss:  6.2798 |Global loss: 6.2874| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.8178861141204834
Chosen Clients:  [9, 11, 0, 1, 2, 4]

-------------Round number: 13-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.083, 0.05, 0.117, 0.075, 0.067, 0.15, 0.067, 0.183, 0.067, 0.117, 0.117, 0.117, 0.183, 0.117]
AUC in each clients:  [60.303, 61.247, 60.515, 65.183, 60.845, 60.917, 61.994, 61.507, 65.139, 60.4, 62.519, 59.042, 60.455, 60.157, 61.671]
F1 Score:  [0.01, 0.024, 0.008, 0.037, 0.018, 0.01, 0.064, 0.014, 0.125, 0.01, 0.05, 0.048, 0.092, 0.093, 0.061]
Recall Score:  [0.083, 0.111, 0.083, 0.167, 0.097, 0.083, 0.194, 0.083, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2750
Averaged Test Accurancy: 0.1050
Averaged Test AUC: 0.5122
Averaged Test F1_score: 0.0443
Averaged Test Recal score: 0.1435
Std Test Accurancy: 0.0410
Std Test AUC: 0.0139
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7982
Epoch: 0|  Loss:  6.2787 |Global loss: 6.2867| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7982
Epoch: 1|  Loss:  6.2777 |Global loss: 6.2859| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7977
Epoch: 2|  Loss:  6.2784 |Global loss: 6.2877| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.798
Epoch: 3|  Loss:  6.2767 |Global loss: 6.2857| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7977
Epoch: 0|  Loss:  6.2806 |Global loss: 6.2894| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7981
Epoch: 1|  Loss:  6.2781 |Global loss: 6.2863| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.798
Epoch: 2|  Loss:  6.2776 |Global loss: 6.286| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7977
Epoch: 3|  Loss:  6.2775 |Global loss: 6.2866| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7987
Epoch: 0|  Loss:  6.2808 |Global loss: 6.287| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7985
Epoch: 1|  Loss:  6.2804 |Global loss: 6.2868| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7982
Epoch: 2|  Loss:  6.2804 |Global loss: 6.2876| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7982
Epoch: 3|  Loss:  6.2796 |Global loss: 6.287| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7981
Epoch: 0|  Loss:  6.2764 |Global loss: 6.2855| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7978
Epoch: 1|  Loss:  6.2765 |Global loss: 6.2863| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7978
Epoch: 2|  Loss:  6.275 |Global loss: 6.2849| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7975
Epoch: 3|  Loss:  6.2752 |Global loss: 6.2856| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7979
Epoch: 0|  Loss:  6.2747 |Global loss: 6.2869| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7979
Epoch: 1|  Loss:  6.2736 |Global loss: 6.2856| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7976
Epoch: 2|  Loss:  6.2737 |Global loss: 6.2866| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7975
Epoch: 3|  Loss:  6.2728 |Global loss: 6.286| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.798
Epoch: 0|  Loss:  6.2756 |Global loss: 6.2857| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7976
Epoch: 1|  Loss:  6.2759 |Global loss: 6.287| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7979
Epoch: 2|  Loss:  6.2737 |Global loss: 6.2844| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7974
Epoch: 3|  Loss:  6.2745 |Global loss: 6.2864| Local H loss: 0.0026  | Global H loss: 0.0026
------------------------- time cost ------------------------- 2.952502727508545
Chosen Clients:  [13, 8, 6, 10, 2, 5]

-------------Round number: 14-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.108, 0.05, 0.117, 0.117, 0.067, 0.15, 0.067, 0.183, 0.067, 0.117, 0.117, 0.117, 0.183, 0.117]
AUC in each clients:  [60.046, 61.49, 61.502, 65.183, 61.399, 60.917, 61.994, 61.507, 65.139, 60.984, 62.519, 59.19, 60.455, 60.157, 61.671]
F1 Score:  [0.026, 0.035, 0.008, 0.037, 0.035, 0.01, 0.064, 0.014, 0.125, 0.012, 0.05, 0.061, 0.092, 0.093, 0.061]
Recall Score:  [0.094, 0.156, 0.083, 0.167, 0.167, 0.083, 0.194, 0.083, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2737
Averaged Test Accurancy: 0.1100
Averaged Test AUC: 0.5134
Averaged Test F1_score: 0.0482
Averaged Test Recal score: 0.1519
Std Test Accurancy: 0.0392
Std Test AUC: 0.0134
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7981
Epoch: 0|  Loss:  6.276 |Global loss: 6.286| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7979
Epoch: 1|  Loss:  6.2755 |Global loss: 6.2858| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7978
Epoch: 2|  Loss:  6.2748 |Global loss: 6.2858| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7975
Epoch: 3|  Loss:  6.274 |Global loss: 6.2857| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7965
Epoch: 0|  Loss:  6.2642 |Global loss: 6.2863| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7967
Epoch: 1|  Loss:  6.262 |Global loss: 6.284| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.2597 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7963
Epoch: 3|  Loss:  6.2603 |Global loss: 6.2842| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7976
Epoch: 0|  Loss:  6.2757 |Global loss: 6.2868| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7975
Epoch: 1|  Loss:  6.2754 |Global loss: 6.2869| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7975
Epoch: 2|  Loss:  6.274 |Global loss: 6.2857| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7972
Epoch: 3|  Loss:  6.2741 |Global loss: 6.2866| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7971
Epoch: 0|  Loss:  6.2666 |Global loss: 6.2847| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.265 |Global loss: 6.2837| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.2649 |Global loss: 6.2847| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7966
Epoch: 3|  Loss:  6.2638 |Global loss: 6.2839| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7973
Epoch: 0|  Loss:  6.2721 |Global loss: 6.2861| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7971
Epoch: 1|  Loss:  6.272 |Global loss: 6.2865| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7971
Epoch: 2|  Loss:  6.2704 |Global loss: 6.2852| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.797
Epoch: 3|  Loss:  6.2695 |Global loss: 6.2847| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7979
Epoch: 0|  Loss:  6.2758 |Global loss: 6.2848| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7976
Epoch: 1|  Loss:  6.2757 |Global loss: 6.2855| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7975
Epoch: 2|  Loss:  6.2751 |Global loss: 6.2853| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7972
Epoch: 3|  Loss:  6.2748 |Global loss: 6.2853| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 3.2239584922790527
Chosen Clients:  [8, 6, 1, 3, 4, 14]

-------------Round number: 15-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.108, 0.05, 0.117, 0.117, 0.092, 0.158, 0.067, 0.183, 0.067, 0.117, 0.117, 0.117, 0.183, 0.117]
AUC in each clients:  [60.046, 61.49, 62.171, 65.183, 61.399, 61.446, 62.486, 61.507, 65.662, 60.984, 62.504, 59.19, 60.455, 60.833, 61.671]
F1 Score:  [0.026, 0.035, 0.008, 0.037, 0.035, 0.038, 0.106, 0.014, 0.123, 0.012, 0.044, 0.061, 0.092, 0.093, 0.061]
Recall Score:  [0.094, 0.156, 0.083, 0.167, 0.167, 0.125, 0.219, 0.083, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2723
Averaged Test Accurancy: 0.1122
Averaged Test AUC: 0.5150
Averaged Test F1_score: 0.0523
Averaged Test Recal score: 0.1563
Std Test Accurancy: 0.0385
Std Test AUC: 0.0138
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7961
Epoch: 0|  Loss:  6.2587 |Global loss: 6.2841| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7962
Epoch: 1|  Loss:  6.2577 |Global loss: 6.283| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7959
Epoch: 2|  Loss:  6.2566 |Global loss: 6.2832| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7953
Epoch: 3|  Loss:  6.257 |Global loss: 6.2852| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.797
Epoch: 0|  Loss:  6.274 |Global loss: 6.2869| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7971
Epoch: 1|  Loss:  6.2719 |Global loss: 6.285| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7972
Epoch: 2|  Loss:  6.2705 |Global loss: 6.2833| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7966
Epoch: 3|  Loss:  6.2713 |Global loss: 6.2855| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7972
Epoch: 0|  Loss:  6.274 |Global loss: 6.2848| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7967
Epoch: 1|  Loss:  6.2746 |Global loss: 6.2866| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.2734 |Global loss: 6.2855| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7965
Epoch: 3|  Loss:  6.2727 |Global loss: 6.2856| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7969
Epoch: 0|  Loss:  6.267 |Global loss: 6.2853| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.266 |Global loss: 6.284| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.2652 |Global loss: 6.284| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7964
Epoch: 3|  Loss:  6.2647 |Global loss: 6.2846| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7968
Epoch: 0|  Loss:  6.274 |Global loss: 6.2867| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.2725 |Global loss: 6.285| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7968
Epoch: 2|  Loss:  6.2719 |Global loss: 6.2851| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7965
Epoch: 3|  Loss:  6.272 |Global loss: 6.2858| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7974
Epoch: 0|  Loss:  6.2721 |Global loss: 6.2851| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.2721 |Global loss: 6.2859| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7967
Epoch: 2|  Loss:  6.2719 |Global loss: 6.2868| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7966
Epoch: 3|  Loss:  6.2714 |Global loss: 6.2865| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 3.028160810470581
Chosen Clients:  [12, 8, 0, 11, 9, 1]

-------------Round number: 16-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.05, 0.05, 0.117, 0.117, 0.092, 0.117, 0.067, 0.183, 0.067, 0.117, 0.117, 0.117, 0.183, 0.117]
AUC in each clients:  [60.046, 61.731, 62.171, 65.88, 62.025, 61.446, 62.893, 61.507, 66.242, 60.984, 62.504, 59.19, 60.455, 60.833, 62.208]
F1 Score:  [0.026, 0.009, 0.008, 0.037, 0.048, 0.038, 0.043, 0.014, 0.121, 0.012, 0.044, 0.061, 0.092, 0.093, 0.063]
Recall Score:  [0.094, 0.083, 0.083, 0.167, 0.167, 0.125, 0.167, 0.083, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2714
Averaged Test Accurancy: 0.1056
Averaged Test AUC: 0.5167
Averaged Test F1_score: 0.0473
Averaged Test Recal score: 0.1480
Std Test Accurancy: 0.0394
Std Test AUC: 0.0154
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7977
Epoch: 0|  Loss:  6.2736 |Global loss: 6.2832| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7969
Epoch: 1|  Loss:  6.2746 |Global loss: 6.2862| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7972
Epoch: 2|  Loss:  6.2728 |Global loss: 6.2838| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7963
Epoch: 3|  Loss:  6.2742 |Global loss: 6.2873| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7955
Epoch: 0|  Loss:  6.2561 |Global loss: 6.2842| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7956
Epoch: 1|  Loss:  6.2525 |Global loss: 6.2816| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7951
Epoch: 2|  Loss:  6.2537 |Global loss: 6.2835| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7947
Epoch: 3|  Loss:  6.2528 |Global loss: 6.2848| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7972
Epoch: 0|  Loss:  6.2793 |Global loss: 6.288| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7974
Epoch: 1|  Loss:  6.2779 |Global loss: 6.286| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7973
Epoch: 2|  Loss:  6.277 |Global loss: 6.2854| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.797
Epoch: 3|  Loss:  6.2772 |Global loss: 6.2862| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7973
Epoch: 0|  Loss:  6.2751 |Global loss: 6.2841| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7967
Epoch: 1|  Loss:  6.2761 |Global loss: 6.2863| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7966
Epoch: 2|  Loss:  6.2751 |Global loss: 6.2858| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7965
Epoch: 3|  Loss:  6.2745 |Global loss: 6.2854| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7972
Epoch: 0|  Loss:  6.2756 |Global loss: 6.2852| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7972
Epoch: 1|  Loss:  6.274 |Global loss: 6.2837| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7968
Epoch: 2|  Loss:  6.2743 |Global loss: 6.2851| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7966
Epoch: 3|  Loss:  6.2738 |Global loss: 6.2849| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7967
Epoch: 0|  Loss:  6.2713 |Global loss: 6.2836| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7962
Epoch: 1|  Loss:  6.2721 |Global loss: 6.2857| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7963
Epoch: 2|  Loss:  6.2708 |Global loss: 6.284| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7961
Epoch: 3|  Loss:  6.27 |Global loss: 6.2837| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 3.0697274208068848
Chosen Clients:  [7, 2, 10, 4, 13, 5]

-------------Round number: 17-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.133, 0.05, 0.05, 0.117, 0.117, 0.092, 0.117, 0.067, 0.183, 0.15, 0.117, 0.117, 0.05, 0.183, 0.117]
AUC in each clients:  [60.435, 61.986, 62.171, 65.88, 62.025, 61.446, 62.893, 61.507, 67.002, 61.593, 62.504, 59.373, 60.485, 60.833, 62.208]
F1 Score:  [0.057, 0.009, 0.008, 0.037, 0.048, 0.038, 0.043, 0.014, 0.121, 0.074, 0.044, 0.092, 0.008, 0.093, 0.063]
Recall Score:  [0.167, 0.083, 0.083, 0.167, 0.167, 0.125, 0.167, 0.083, 0.25, 0.194, 0.167, 0.167, 0.083, 0.25, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2702
Averaged Test Accurancy: 0.1106
Averaged Test AUC: 0.5180
Averaged Test F1_score: 0.0499
Averaged Test Recal score: 0.1547
Std Test Accurancy: 0.0418
Std Test AUC: 0.0159
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7971
Epoch: 0|  Loss:  6.2782 |Global loss: 6.2875| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.797
Epoch: 1|  Loss:  6.2776 |Global loss: 6.287| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.797
Epoch: 2|  Loss:  6.2765 |Global loss: 6.2861| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7971
Epoch: 3|  Loss:  6.274 |Global loss: 6.2836| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.796
Epoch: 0|  Loss:  6.2687 |Global loss: 6.2853| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2689 |Global loss: 6.2864| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.796
Epoch: 2|  Loss:  6.2663 |Global loss: 6.2832| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7956
Epoch: 3|  Loss:  6.2663 |Global loss: 6.2844| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7959
Epoch: 0|  Loss:  6.262 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7958
Epoch: 1|  Loss:  6.2609 |Global loss: 6.2825| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.795
Epoch: 2|  Loss:  6.2619 |Global loss: 6.2854| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7953
Epoch: 3|  Loss:  6.2591 |Global loss: 6.2823| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7959
Epoch: 0|  Loss:  6.2714 |Global loss: 6.2859| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7959
Epoch: 1|  Loss:  6.2704 |Global loss: 6.2852| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7958
Epoch: 2|  Loss:  6.2695 |Global loss: 6.2847| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7956
Epoch: 3|  Loss:  6.269 |Global loss: 6.2847| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7969
Epoch: 0|  Loss:  6.2725 |Global loss: 6.2845| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7965
Epoch: 1|  Loss:  6.2726 |Global loss: 6.2856| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7963
Epoch: 2|  Loss:  6.2719 |Global loss: 6.2854| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7963
Epoch: 3|  Loss:  6.2699 |Global loss: 6.2841| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7966
Epoch: 0|  Loss:  6.2737 |Global loss: 6.2847| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7962
Epoch: 1|  Loss:  6.2739 |Global loss: 6.2859| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7957
Epoch: 2|  Loss:  6.274 |Global loss: 6.2872| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7965
Epoch: 3|  Loss:  6.2701 |Global loss: 6.2816| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.9519543647766113
Chosen Clients:  [2, 0, 8, 13, 10, 11]

-------------Round number: 18-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.133, 0.05, 0.05, 0.117, 0.117, 0.183, 0.117, 0.117, 0.183, 0.15, 0.117, 0.117, 0.05, 0.117, 0.117]
AUC in each clients:  [60.435, 61.986, 62.133, 65.88, 62.54, 62.15, 62.893, 61.433, 67.002, 61.593, 63.217, 59.373, 60.485, 61.694, 62.208]
F1 Score:  [0.057, 0.009, 0.008, 0.037, 0.048, 0.104, 0.043, 0.036, 0.121, 0.074, 0.046, 0.092, 0.008, 0.037, 0.063]
Recall Score:  [0.167, 0.083, 0.083, 0.167, 0.167, 0.25, 0.167, 0.167, 0.25, 0.194, 0.167, 0.167, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2685
Averaged Test Accurancy: 0.1156
Averaged Test AUC: 0.5195
Averaged Test F1_score: 0.0522
Averaged Test Recal score: 0.1631
Std Test Accurancy: 0.0397
Std Test AUC: 0.0157
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7955
Epoch: 0|  Loss:  6.2655 |Global loss: 6.2841| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7952
Epoch: 1|  Loss:  6.2651 |Global loss: 6.2844| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7952
Epoch: 2|  Loss:  6.2633 |Global loss: 6.2826| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7948
Epoch: 3|  Loss:  6.2631 |Global loss: 6.2838| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7968
Epoch: 0|  Loss:  6.2755 |Global loss: 6.2839| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7965
Epoch: 1|  Loss:  6.2754 |Global loss: 6.2847| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7964
Epoch: 2|  Loss:  6.2745 |Global loss: 6.2839| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7957
Epoch: 3|  Loss:  6.2751 |Global loss: 6.2862| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7942
Epoch: 0|  Loss:  6.2515 |Global loss: 6.2848| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7938
Epoch: 1|  Loss:  6.2494 |Global loss: 6.2848| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.794
Epoch: 2|  Loss:  6.2476 |Global loss: 6.2831| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7937
Epoch: 3|  Loss:  6.247 |Global loss: 6.2838| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7959
Epoch: 0|  Loss:  6.2703 |Global loss: 6.2855| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7961
Epoch: 1|  Loss:  6.2686 |Global loss: 6.283| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7955
Epoch: 2|  Loss:  6.2688 |Global loss: 6.2852| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7953
Epoch: 3|  Loss:  6.2682 |Global loss: 6.2852| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7951
Epoch: 0|  Loss:  6.258 |Global loss: 6.2823| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7946
Epoch: 1|  Loss:  6.2584 |Global loss: 6.2841| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7946
Epoch: 2|  Loss:  6.2565 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7945
Epoch: 3|  Loss:  6.2544 |Global loss: 6.2815| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.2738 |Global loss: 6.2858| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7959
Epoch: 1|  Loss:  6.2727 |Global loss: 6.2844| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7954
Epoch: 2|  Loss:  6.273 |Global loss: 6.2857| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7951
Epoch: 3|  Loss:  6.2732 |Global loss: 6.2868| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 3.158583164215088
Chosen Clients:  [10, 6, 7, 5, 12, 13]

-------------Round number: 19-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.117, 0.117, 0.183, 0.117, 0.117, 0.183, 0.15, 0.117, 0.117, 0.05, 0.117, 0.117]
AUC in each clients:  [60.27, 61.986, 62.708, 65.88, 62.54, 62.15, 62.893, 61.433, 67.32, 61.593, 63.567, 60.202, 60.485, 62.684, 62.208]
F1 Score:  [0.072, 0.009, 0.008, 0.037, 0.048, 0.104, 0.043, 0.036, 0.121, 0.074, 0.049, 0.092, 0.008, 0.038, 0.063]
Recall Score:  [0.135, 0.083, 0.083, 0.167, 0.167, 0.25, 0.167, 0.167, 0.25, 0.194, 0.167, 0.167, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2673
Averaged Test Accurancy: 0.1128
Averaged Test AUC: 0.5211
Averaged Test F1_score: 0.0535
Averaged Test Recal score: 0.1609
Std Test Accurancy: 0.0398
Std Test AUC: 0.0156
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7944
Epoch: 0|  Loss:  6.2535 |Global loss: 6.2812| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7938
Epoch: 1|  Loss:  6.2541 |Global loss: 6.2834| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7932
Epoch: 2|  Loss:  6.2542 |Global loss: 6.2855| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7934
Epoch: 3|  Loss:  6.251 |Global loss: 6.2828| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7955
Epoch: 0|  Loss:  6.2698 |Global loss: 6.2849| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7952
Epoch: 1|  Loss:  6.2697 |Global loss: 6.2859| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7953
Epoch: 2|  Loss:  6.2683 |Global loss: 6.2842| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7952
Epoch: 3|  Loss:  6.2671 |Global loss: 6.2832| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7961
Epoch: 0|  Loss:  6.2745 |Global loss: 6.2861| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7957
Epoch: 1|  Loss:  6.2734 |Global loss: 6.2865| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7958
Epoch: 2|  Loss:  6.2722 |Global loss: 6.2852| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7958
Epoch: 3|  Loss:  6.2705 |Global loss: 6.2834| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7954
Epoch: 0|  Loss:  6.271 |Global loss: 6.2844| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7954
Epoch: 1|  Loss:  6.2702 |Global loss: 6.2835| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7954
Epoch: 2|  Loss:  6.2684 |Global loss: 6.2816| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7952
Epoch: 3|  Loss:  6.2681 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.272 |Global loss: 6.2854| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7959
Epoch: 1|  Loss:  6.2707 |Global loss: 6.2838| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7958
Epoch: 2|  Loss:  6.27 |Global loss: 6.2833| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7957
Epoch: 3|  Loss:  6.2689 |Global loss: 6.2825| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7954
Epoch: 0|  Loss:  6.2665 |Global loss: 6.2832| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7949
Epoch: 1|  Loss:  6.2666 |Global loss: 6.285| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7951
Epoch: 2|  Loss:  6.2644 |Global loss: 6.2825| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7945
Epoch: 3|  Loss:  6.2648 |Global loss: 6.2846| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 3.252305269241333
Chosen Clients:  [2, 3, 5, 14, 9, 1]

-------------Round number: 20-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.117, 0.117, 0.167, 0.117, 0.117, 0.183, 0.15, 0.117, 0.117, 0.05, 0.117, 0.117]
AUC in each clients:  [60.27, 61.986, 62.708, 65.88, 62.54, 62.412, 63.369, 61.543, 67.32, 61.593, 64.148, 60.202, 60.595, 63.258, 62.208]
F1 Score:  [0.072, 0.009, 0.008, 0.037, 0.048, 0.097, 0.043, 0.036, 0.121, 0.074, 0.043, 0.092, 0.008, 0.036, 0.063]
Recall Score:  [0.135, 0.083, 0.083, 0.167, 0.167, 0.229, 0.167, 0.167, 0.25, 0.194, 0.167, 0.167, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2656
Averaged Test Accurancy: 0.1117
Averaged Test AUC: 0.5222
Averaged Test F1_score: 0.0525
Averaged Test Recal score: 0.1595
Std Test Accurancy: 0.0380
Std Test AUC: 0.0159
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7944
Epoch: 0|  Loss:  6.2613 |Global loss: 6.2826| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7939
Epoch: 1|  Loss:  6.2613 |Global loss: 6.2839| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7939
Epoch: 2|  Loss:  6.2594 |Global loss: 6.2822| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7938
Epoch: 3|  Loss:  6.2589 |Global loss: 6.282| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7951
Epoch: 0|  Loss:  6.2625 |Global loss: 6.2834| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7943
Epoch: 1|  Loss:  6.2618 |Global loss: 6.2853| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7943
Epoch: 2|  Loss:  6.261 |Global loss: 6.2843| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7939
Epoch: 3|  Loss:  6.26 |Global loss: 6.2849| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7947
Epoch: 0|  Loss:  6.2689 |Global loss: 6.2838| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7942
Epoch: 1|  Loss:  6.2691 |Global loss: 6.2852| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7942
Epoch: 2|  Loss:  6.2683 |Global loss: 6.2842| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7941
Epoch: 3|  Loss:  6.2674 |Global loss: 6.2836| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7957
Epoch: 0|  Loss:  6.2683 |Global loss: 6.2832| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7952
Epoch: 1|  Loss:  6.2683 |Global loss: 6.2847| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7951
Epoch: 2|  Loss:  6.2675 |Global loss: 6.2838| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7951
Epoch: 3|  Loss:  6.2662 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7958
Epoch: 0|  Loss:  6.2714 |Global loss: 6.2826| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7953
Epoch: 1|  Loss:  6.2715 |Global loss: 6.2842| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.795
Epoch: 2|  Loss:  6.2712 |Global loss: 6.2843| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7948
Epoch: 3|  Loss:  6.2706 |Global loss: 6.2844| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7946
Epoch: 0|  Loss:  6.2697 |Global loss: 6.2849| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7948
Epoch: 1|  Loss:  6.2682 |Global loss: 6.283| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7948
Epoch: 2|  Loss:  6.2668 |Global loss: 6.2816| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7943
Epoch: 3|  Loss:  6.2668 |Global loss: 6.283| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 2.860382318496704
Chosen Clients:  [7, 3, 14, 5, 8, 2]

-------------Round number: 21-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.117, 0.117, 0.167, 0.117, 0.117, 0.183, 0.183, 0.117, 0.117, 0.05, 0.117, 0.067]
AUC in each clients:  [60.27, 62.445, 63.318, 66.185, 62.54, 62.827, 63.369, 61.543, 67.32, 61.642, 64.148, 60.202, 60.595, 63.258, 62.347]
F1 Score:  [0.072, 0.009, 0.008, 0.037, 0.048, 0.094, 0.043, 0.036, 0.121, 0.078, 0.043, 0.092, 0.008, 0.036, 0.043]
Recall Score:  [0.135, 0.083, 0.083, 0.167, 0.167, 0.229, 0.167, 0.167, 0.25, 0.25, 0.167, 0.167, 0.083, 0.167, 0.104]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2641
Averaged Test Accurancy: 0.1106
Averaged Test AUC: 0.5233
Averaged Test F1_score: 0.0512
Averaged Test Recal score: 0.1591
Std Test Accurancy: 0.0427
Std Test AUC: 0.0161
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7949
Epoch: 0|  Loss:  6.2702 |Global loss: 6.2849| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7948
Epoch: 1|  Loss:  6.2685 |Global loss: 6.2836| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7937
Epoch: 2|  Loss:  6.2699 |Global loss: 6.2879| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7937
Epoch: 3|  Loss:  6.2687 |Global loss: 6.287| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.794
Epoch: 0|  Loss:  6.2578 |Global loss: 6.2827| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7939
Epoch: 1|  Loss:  6.2564 |Global loss: 6.2819| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7936
Epoch: 2|  Loss:  6.2548 |Global loss: 6.2815| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.793
Epoch: 3|  Loss:  6.2549 |Global loss: 6.2835| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7945
Epoch: 0|  Loss:  6.2664 |Global loss: 6.2844| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7941
Epoch: 1|  Loss:  6.2663 |Global loss: 6.2853| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7942
Epoch: 2|  Loss:  6.2645 |Global loss: 6.2833| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7941
Epoch: 3|  Loss:  6.2638 |Global loss: 6.2829| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7942
Epoch: 0|  Loss:  6.2657 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7938
Epoch: 1|  Loss:  6.266 |Global loss: 6.2829| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7937
Epoch: 2|  Loss:  6.2647 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7932
Epoch: 3|  Loss:  6.2657 |Global loss: 6.2837| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 0|  NKD Loss: 3.7926
Epoch: 0|  Loss:  6.2454 |Global loss: 6.2839| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7927
Epoch: 1|  Loss:  6.242 |Global loss: 6.2815| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7925
Epoch: 2|  Loss:  6.2403 |Global loss: 6.2812| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.792
Epoch: 3|  Loss:  6.2412 |Global loss: 6.283| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.2578 |Global loss: 6.2821| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7929
Epoch: 1|  Loss:  6.2587 |Global loss: 6.2844| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.257 |Global loss: 6.2833| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.793
Epoch: 3|  Loss:  6.2541 |Global loss: 6.2803| Local H loss: 0.0026  | Global H loss: 0.0026
------------------------- time cost ------------------------- 2.797325372695923
Chosen Clients:  [3, 12, 13, 11, 5, 9]

-------------Round number: 22-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.142, 0.117, 0.167, 0.117, 0.117, 0.183, 0.183, 0.117, 0.117, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 62.445, 63.966, 66.171, 62.54, 63.345, 63.369, 62.473, 68.24, 61.642, 64.148, 60.202, 60.595, 63.258, 62.705]
F1 Score:  [0.072, 0.009, 0.008, 0.073, 0.048, 0.094, 0.043, 0.036, 0.121, 0.078, 0.043, 0.092, 0.008, 0.036, 0.009]
Recall Score:  [0.135, 0.083, 0.083, 0.202, 0.167, 0.229, 0.167, 0.167, 0.25, 0.25, 0.167, 0.167, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2626
Averaged Test Accurancy: 0.1111
Averaged Test AUC: 0.5252
Averaged Test F1_score: 0.0513
Averaged Test Recal score: 0.1600
Std Test Accurancy: 0.0447
Std Test AUC: 0.0172
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7927
Epoch: 0|  Loss:  6.2543 |Global loss: 6.284| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7928
Epoch: 1|  Loss:  6.2517 |Global loss: 6.2818| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7926
Epoch: 2|  Loss:  6.2504 |Global loss: 6.2812| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.792
Epoch: 3|  Loss:  6.2504 |Global loss: 6.283| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7945
Epoch: 0|  Loss:  6.2683 |Global loss: 6.2837| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7943
Epoch: 1|  Loss:  6.2675 |Global loss: 6.2832| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7939
Epoch: 2|  Loss:  6.2674 |Global loss: 6.2842| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7938
Epoch: 3|  Loss:  6.2659 |Global loss: 6.2829| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.2628 |Global loss: 6.2841| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7932
Epoch: 1|  Loss:  6.2623 |Global loss: 6.2842| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7936
Epoch: 2|  Loss:  6.2597 |Global loss: 6.2807| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7931
Epoch: 3|  Loss:  6.2592 |Global loss: 6.2816| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7944
Epoch: 0|  Loss:  6.2695 |Global loss: 6.2827| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7938
Epoch: 1|  Loss:  6.2699 |Global loss: 6.2846| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7935
Epoch: 2|  Loss:  6.27 |Global loss: 6.2854| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7933
Epoch: 3|  Loss:  6.2692 |Global loss: 6.2848| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.2646 |Global loss: 6.2827| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7931
Epoch: 1|  Loss:  6.2631 |Global loss: 6.2818| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.2626 |Global loss: 6.2816| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 3|  NKD Loss: 3.7924
Epoch: 3|  Loss:  6.2634 |Global loss: 6.2834| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 0|  NKD Loss: 3.7939
Epoch: 0|  Loss:  6.2708 |Global loss: 6.2861| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7941
Epoch: 1|  Loss:  6.2684 |Global loss: 6.2831| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7939
Epoch: 2|  Loss:  6.2678 |Global loss: 6.2831| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7938
Epoch: 3|  Loss:  6.2671 |Global loss: 6.2826| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.982672691345215
Chosen Clients:  [10, 14, 9, 11, 13, 3]

-------------Round number: 23-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.175, 0.117, 0.158, 0.117, 0.117, 0.183, 0.183, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 62.445, 63.966, 66.711, 62.54, 63.606, 63.369, 62.473, 68.24, 61.989, 64.148, 61.284, 60.876, 63.774, 62.705]
F1 Score:  [0.072, 0.009, 0.008, 0.096, 0.048, 0.114, 0.043, 0.036, 0.121, 0.114, 0.043, 0.008, 0.008, 0.037, 0.009]
Recall Score:  [0.135, 0.083, 0.083, 0.25, 0.167, 0.219, 0.167, 0.167, 0.25, 0.25, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2612
Averaged Test Accurancy: 0.1083
Averaged Test AUC: 0.5269
Averaged Test F1_score: 0.0511
Averaged Test Recal score: 0.1569
Std Test Accurancy: 0.0489
Std Test AUC: 0.0168
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7917
Epoch: 0|  Loss:  6.2497 |Global loss: 6.2831| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7919
Epoch: 1|  Loss:  6.246 |Global loss: 6.28| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7917
Epoch: 2|  Loss:  6.2451 |Global loss: 6.2798| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7913
Epoch: 3|  Loss:  6.2432 |Global loss: 6.2796| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7933
Epoch: 0|  Loss:  6.263 |Global loss: 6.2833| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7931
Epoch: 1|  Loss:  6.2623 |Global loss: 6.2833| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.2616 |Global loss: 6.2831| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7928
Epoch: 3|  Loss:  6.26 |Global loss: 6.2818| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7935
Epoch: 0|  Loss:  6.2661 |Global loss: 6.2823| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7935
Epoch: 1|  Loss:  6.2652 |Global loss: 6.2814| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7926
Epoch: 2|  Loss:  6.2658 |Global loss: 6.2838| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7928
Epoch: 3|  Loss:  6.2637 |Global loss: 6.2815| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7932
Epoch: 0|  Loss:  6.2679 |Global loss: 6.2841| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7929
Epoch: 1|  Loss:  6.2676 |Global loss: 6.2843| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.2666 |Global loss: 6.2831| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7922
Epoch: 3|  Loss:  6.2671 |Global loss: 6.2851| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7926
Epoch: 0|  Loss:  6.2598 |Global loss: 6.2837| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7922
Epoch: 1|  Loss:  6.2599 |Global loss: 6.2844| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7922
Epoch: 2|  Loss:  6.2579 |Global loss: 6.2832| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7917
Epoch: 3|  Loss:  6.2576 |Global loss: 6.2842| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7917
Epoch: 0|  Loss:  6.2492 |Global loss: 6.2831| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7916
Epoch: 1|  Loss:  6.2474 |Global loss: 6.2821| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7912
Epoch: 2|  Loss:  6.2462 |Global loss: 6.2826| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7911
Epoch: 3|  Loss:  6.244 |Global loss: 6.2814| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 3.0814647674560547
Chosen Clients:  [12, 3, 1, 9, 10, 6]

-------------Round number: 24-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.05, 0.05, 0.175, 0.117, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 62.445, 63.966, 67.259, 62.54, 63.606, 63.369, 62.473, 68.24, 62.052, 64.596, 61.676, 60.876, 64.242, 63.218]
F1 Score:  [0.072, 0.009, 0.008, 0.095, 0.048, 0.114, 0.043, 0.036, 0.121, 0.042, 0.041, 0.008, 0.008, 0.036, 0.01]
Recall Score:  [0.135, 0.083, 0.083, 0.25, 0.167, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2591
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5282
Averaged Test F1_score: 0.0461
Averaged Test Recal score: 0.1514
Std Test Accurancy: 0.0447
Std Test AUC: 0.0173
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7931
Epoch: 0|  Loss:  6.2647 |Global loss: 6.2824| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.793
Epoch: 1|  Loss:  6.2636 |Global loss: 6.2814| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7924
Epoch: 2|  Loss:  6.2635 |Global loss: 6.2831| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7919
Epoch: 3|  Loss:  6.2636 |Global loss: 6.2846| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7907
Epoch: 0|  Loss:  6.243 |Global loss: 6.2824| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7905
Epoch: 1|  Loss:  6.2419 |Global loss: 6.2818| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7899
Epoch: 2|  Loss:  6.2404 |Global loss: 6.2835| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7899
Epoch: 3|  Loss:  6.2376 |Global loss: 6.2816| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.793
Epoch: 0|  Loss:  6.2648 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7924
Epoch: 1|  Loss:  6.2647 |Global loss: 6.283| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7921
Epoch: 2|  Loss:  6.2643 |Global loss: 6.2834| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7919
Epoch: 3|  Loss:  6.2633 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7924
Epoch: 0|  Loss:  6.2635 |Global loss: 6.2822| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7915
Epoch: 1|  Loss:  6.2649 |Global loss: 6.286| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.792
Epoch: 2|  Loss:  6.2626 |Global loss: 6.2823| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7918
Epoch: 3|  Loss:  6.2612 |Global loss: 6.2818| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.791
Epoch: 0|  Loss:  6.2433 |Global loss: 6.2809| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.791
Epoch: 1|  Loss:  6.2407 |Global loss: 6.2793| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7901
Epoch: 2|  Loss:  6.2414 |Global loss: 6.2823| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.79
Epoch: 3|  Loss:  6.2383 |Global loss: 6.2807| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7934
Epoch: 0|  Loss:  6.2659 |Global loss: 6.2837| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.793
Epoch: 1|  Loss:  6.2654 |Global loss: 6.2839| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7929
Epoch: 2|  Loss:  6.2646 |Global loss: 6.2836| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7923
Epoch: 3|  Loss:  6.2643 |Global loss: 6.2846| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 3.2215752601623535
Chosen Clients:  [7, 11, 4, 10, 2, 3]

-------------Round number: 25-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.117, 0.05, 0.175, 0.117, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 63.192, 63.966, 67.858, 62.54, 63.606, 63.654, 62.473, 68.24, 62.91, 65.489, 61.676, 61.448, 64.242, 63.218]
F1 Score:  [0.072, 0.049, 0.008, 0.097, 0.048, 0.114, 0.043, 0.036, 0.121, 0.042, 0.039, 0.008, 0.008, 0.036, 0.01]
Recall Score:  [0.135, 0.167, 0.083, 0.25, 0.167, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2572
Averaged Test Accurancy: 0.1083
Averaged Test AUC: 0.5304
Averaged Test F1_score: 0.0487
Averaged Test Recal score: 0.1570
Std Test Accurancy: 0.0424
Std Test AUC: 0.0175
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7933
Epoch: 0|  Loss:  6.2639 |Global loss: 6.2811| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7923
Epoch: 1|  Loss:  6.2652 |Global loss: 6.2849| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7921
Epoch: 2|  Loss:  6.2631 |Global loss: 6.2836| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7919
Epoch: 3|  Loss:  6.2623 |Global loss: 6.2835| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7915
Epoch: 0|  Loss:  6.2658 |Global loss: 6.2847| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7916
Epoch: 1|  Loss:  6.2644 |Global loss: 6.2832| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7915
Epoch: 2|  Loss:  6.2636 |Global loss: 6.2824| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7913
Epoch: 3|  Loss:  6.2621 |Global loss: 6.2814| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.793
Epoch: 0|  Loss:  6.2658 |Global loss: 6.2836| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7925
Epoch: 1|  Loss:  6.266 |Global loss: 6.2847| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7924
Epoch: 2|  Loss:  6.2647 |Global loss: 6.2833| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7925
Epoch: 3|  Loss:  6.2625 |Global loss: 6.2805| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7896
Epoch: 0|  Loss:  6.2394 |Global loss: 6.2831| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7895
Epoch: 1|  Loss:  6.2369 |Global loss: 6.2818| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7891
Epoch: 2|  Loss:  6.2352 |Global loss: 6.2818| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7891
Epoch: 3|  Loss:  6.2323 |Global loss: 6.2803| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7921
Epoch: 0|  Loss:  6.2494 |Global loss: 6.276| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.791
Epoch: 1|  Loss:  6.2512 |Global loss: 6.2804| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7905
Epoch: 2|  Loss:  6.2517 |Global loss: 6.2822| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7902
Epoch: 3|  Loss:  6.2499 |Global loss: 6.2816| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7898
Epoch: 0|  Loss:  6.236 |Global loss: 6.2809| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7899
Epoch: 1|  Loss:  6.2333 |Global loss: 6.2788| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7893
Epoch: 2|  Loss:  6.2317 |Global loss: 6.2796| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7891
Epoch: 3|  Loss:  6.2284 |Global loss: 6.2786| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.857409715652466
Chosen Clients:  [9, 10, 7, 14, 11, 3]

-------------Round number: 26-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.117, 0.05, 0.175, 0.05, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 63.192, 64.783, 68.889, 62.387, 63.606, 63.654, 62.925, 68.24, 62.91, 66.446, 61.869, 61.448, 64.242, 63.218]
F1 Score:  [0.072, 0.049, 0.008, 0.097, 0.008, 0.114, 0.043, 0.036, 0.121, 0.042, 0.039, 0.008, 0.008, 0.036, 0.01]
Recall Score:  [0.135, 0.167, 0.083, 0.25, 0.083, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2554
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5323
Averaged Test F1_score: 0.0461
Averaged Test Recal score: 0.1514
Std Test Accurancy: 0.0447
Std Test AUC: 0.0192
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.791
Epoch: 0|  Loss:  6.2602 |Global loss: 6.2819| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7907
Epoch: 1|  Loss:  6.2601 |Global loss: 6.2825| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7907
Epoch: 2|  Loss:  6.2584 |Global loss: 6.2805| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7902
Epoch: 3|  Loss:  6.2577 |Global loss: 6.281| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7894
Epoch: 0|  Loss:  6.2283 |Global loss: 6.2773| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7887
Epoch: 1|  Loss:  6.2278 |Global loss: 6.2795| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7884
Epoch: 2|  Loss:  6.2274 |Global loss: 6.2794| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7875
Epoch: 3|  Loss:  6.2273 |Global loss: 6.2828| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7912
Epoch: 0|  Loss:  6.2625 |Global loss: 6.2854| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7912
Epoch: 1|  Loss:  6.2601 |Global loss: 6.2833| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.791
Epoch: 2|  Loss:  6.2591 |Global loss: 6.2828| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7905
Epoch: 3|  Loss:  6.2582 |Global loss: 6.2836| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7914
Epoch: 0|  Loss:  6.2593 |Global loss: 6.283| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.791
Epoch: 1|  Loss:  6.2593 |Global loss: 6.284| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7906
Epoch: 2|  Loss:  6.2579 |Global loss: 6.2838| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7908
Epoch: 3|  Loss:  6.2559 |Global loss: 6.2813| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.791
Epoch: 0|  Loss:  6.2618 |Global loss: 6.2817| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7903
Epoch: 1|  Loss:  6.2622 |Global loss: 6.2833| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7904
Epoch: 2|  Loss:  6.2599 |Global loss: 6.281| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7898
Epoch: 3|  Loss:  6.2604 |Global loss: 6.2828| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7885
Epoch: 0|  Loss:  6.2301 |Global loss: 6.2818| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7883
Epoch: 1|  Loss:  6.2272 |Global loss: 6.2809| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7878
Epoch: 2|  Loss:  6.2247 |Global loss: 6.2811| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7881
Epoch: 3|  Loss:  6.2205 |Global loss: 6.2777| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.888568878173828
Chosen Clients:  [7, 0, 2, 9, 8, 3]

-------------Round number: 27-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.092, 0.117, 0.05, 0.175, 0.05, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.27, 63.192, 64.783, 69.787, 62.387, 63.606, 63.654, 63.607, 68.24, 63.233, 67.166, 62.245, 61.448, 64.242, 64.317]
F1 Score:  [0.072, 0.049, 0.008, 0.097, 0.008, 0.114, 0.043, 0.036, 0.121, 0.042, 0.039, 0.008, 0.008, 0.036, 0.01]
Recall Score:  [0.135, 0.167, 0.083, 0.25, 0.083, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2530
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5345
Averaged Test F1_score: 0.0461
Averaged Test Recal score: 0.1514
Std Test Accurancy: 0.0447
Std Test AUC: 0.0204
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.791
Epoch: 0|  Loss:  6.2545 |Global loss: 6.2787| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.79
Epoch: 1|  Loss:  6.2556 |Global loss: 6.2823| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7901
Epoch: 2|  Loss:  6.2537 |Global loss: 6.2798| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7896
Epoch: 3|  Loss:  6.2526 |Global loss: 6.2807| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7931
Epoch: 0|  Loss:  6.2712 |Global loss: 6.2839| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7925
Epoch: 1|  Loss:  6.2708 |Global loss: 6.2846| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7923
Epoch: 2|  Loss:  6.2701 |Global loss: 6.2838| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7917
Epoch: 3|  Loss:  6.2701 |Global loss: 6.2852| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7894
Epoch: 0|  Loss:  6.248 |Global loss: 6.2809| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7891
Epoch: 1|  Loss:  6.2469 |Global loss: 6.2808| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7885
Epoch: 2|  Loss:  6.2472 |Global loss: 6.2828| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7885
Epoch: 3|  Loss:  6.2445 |Global loss: 6.2804| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7897
Epoch: 0|  Loss:  6.2583 |Global loss: 6.2829| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7896
Epoch: 1|  Loss:  6.2562 |Global loss: 6.2811| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7897
Epoch: 2|  Loss:  6.2548 |Global loss: 6.2797| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7891
Epoch: 3|  Loss:  6.2545 |Global loss: 6.2808| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7894
Epoch: 0|  Loss:  6.2369 |Global loss: 6.282| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7888
Epoch: 1|  Loss:  6.2356 |Global loss: 6.2831| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7888
Epoch: 2|  Loss:  6.2336 |Global loss: 6.2816| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7887
Epoch: 3|  Loss:  6.2302 |Global loss: 6.2798| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7876
Epoch: 0|  Loss:  6.2171 |Global loss: 6.2781| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7877
Epoch: 1|  Loss:  6.2159 |Global loss: 6.2772| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.787
Epoch: 2|  Loss:  6.2158 |Global loss: 6.2789| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7866
Epoch: 3|  Loss:  6.2126 |Global loss: 6.279| Local H loss: 0.0031  | Global H loss: 0.0031
------------------------- time cost ------------------------- 3.122950553894043
Chosen Clients:  [8, 12, 6, 3, 10, 14]

-------------Round number: 28-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.05, 0.175, 0.05, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.05]
AUC in each clients:  [60.589, 63.192, 65.723, 70.741, 62.387, 63.606, 63.654, 64.187, 68.379, 63.933, 67.166, 62.245, 61.448, 64.242, 64.317]
F1 Score:  [0.027, 0.049, 0.008, 0.097, 0.008, 0.114, 0.043, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.01]
Recall Score:  [0.094, 0.167, 0.083, 0.25, 0.083, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2503
Averaged Test Accurancy: 0.1017
Averaged Test AUC: 0.5366
Averaged Test F1_score: 0.0430
Averaged Test Recal score: 0.1487
Std Test Accurancy: 0.0461
Std Test AUC: 0.0216
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7884
Epoch: 0|  Loss:  6.2277 |Global loss: 6.279| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7882
Epoch: 1|  Loss:  6.2259 |Global loss: 6.279| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7876
Epoch: 2|  Loss:  6.2263 |Global loss: 6.2803| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7872
Epoch: 3|  Loss:  6.2253 |Global loss: 6.2811| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7907
Epoch: 0|  Loss:  6.2602 |Global loss: 6.2814| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7901
Epoch: 1|  Loss:  6.2602 |Global loss: 6.2829| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7901
Epoch: 2|  Loss:  6.2583 |Global loss: 6.2808| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7899
Epoch: 3|  Loss:  6.2574 |Global loss: 6.2802| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 0|  NKD Loss: 3.7905
Epoch: 0|  Loss:  6.2626 |Global loss: 6.2851| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7908
Epoch: 1|  Loss:  6.2602 |Global loss: 6.2818| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7904
Epoch: 2|  Loss:  6.2597 |Global loss: 6.2819| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7902
Epoch: 3|  Loss:  6.2583 |Global loss: 6.2809| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7863
Epoch: 0|  Loss:  6.2103 |Global loss: 6.2798| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7861
Epoch: 1|  Loss:  6.2058 |Global loss: 6.2787| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.786
Epoch: 2|  Loss:  6.2039 |Global loss: 6.2776| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.786
Epoch: 3|  Loss:  6.1979 |Global loss: 6.2747| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.7872
Epoch: 0|  Loss:  6.2229 |Global loss: 6.2801| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7873
Epoch: 1|  Loss:  6.2195 |Global loss: 6.2776| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7863
Epoch: 2|  Loss:  6.2208 |Global loss: 6.2819| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7863
Epoch: 3|  Loss:  6.2163 |Global loss: 6.279| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7903
Epoch: 0|  Loss:  6.2538 |Global loss: 6.2793| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7894
Epoch: 1|  Loss:  6.2545 |Global loss: 6.2822| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7893
Epoch: 2|  Loss:  6.2529 |Global loss: 6.281| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7887
Epoch: 3|  Loss:  6.2524 |Global loss: 6.2824| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 2.8614602088928223
Chosen Clients:  [5, 1, 2, 7, 9, 0]

-------------Round number: 29-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.05, 0.175, 0.05, 0.158, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.075]
AUC in each clients:  [60.589, 63.192, 65.723, 71.629, 62.387, 63.606, 64.113, 64.187, 68.688, 63.933, 67.91, 62.245, 61.783, 64.242, 65.005]
F1 Score:  [0.027, 0.049, 0.008, 0.097, 0.008, 0.114, 0.043, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.024]
Recall Score:  [0.094, 0.167, 0.083, 0.25, 0.083, 0.219, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.115]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2472
Averaged Test Accurancy: 0.1033
Averaged Test AUC: 0.5385
Averaged Test F1_score: 0.0439
Averaged Test Recal score: 0.1508
Std Test Accurancy: 0.0446
Std Test AUC: 0.0233
Std Test F1: 0.0003
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.7892
Epoch: 0|  Loss:  6.2594 |Global loss: 6.2824| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 1|  NKD Loss: 3.7891
Epoch: 1|  Loss:  6.258 |Global loss: 6.2807| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 2|  NKD Loss: 3.789
Epoch: 2|  Loss:  6.2568 |Global loss: 6.2795| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 3|  NKD Loss: 3.7878
Epoch: 3|  Loss:  6.2588 |Global loss: 6.2845| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 0|  NKD Loss: 3.7895
Epoch: 0|  Loss:  6.2614 |Global loss: 6.2832| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7895
Epoch: 1|  Loss:  6.26 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7893
Epoch: 2|  Loss:  6.2588 |Global loss: 6.2806| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7886
Epoch: 3|  Loss:  6.2592 |Global loss: 6.2823| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7879
Epoch: 0|  Loss:  6.2425 |Global loss: 6.2791| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7874
Epoch: 1|  Loss:  6.2411 |Global loss: 6.2793| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.787
Epoch: 2|  Loss:  6.2395 |Global loss: 6.2792| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7871
Epoch: 3|  Loss:  6.2362 |Global loss: 6.276| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7887
Epoch: 0|  Loss:  6.251 |Global loss: 6.2806| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7886
Epoch: 1|  Loss:  6.2483 |Global loss: 6.2782| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7877
Epoch: 2|  Loss:  6.2492 |Global loss: 6.2818| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7877
Epoch: 3|  Loss:  6.2465 |Global loss: 6.2796| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7886
Epoch: 0|  Loss:  6.2519 |Global loss: 6.2787| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.788
Epoch: 1|  Loss:  6.2517 |Global loss: 6.2797| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7874
Epoch: 2|  Loss:  6.2524 |Global loss: 6.2819| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7874
Epoch: 3|  Loss:  6.25 |Global loss: 6.2797| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7916
Epoch: 0|  Loss:  6.2675 |Global loss: 6.2811| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7908
Epoch: 1|  Loss:  6.2677 |Global loss: 6.2831| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7905
Epoch: 2|  Loss:  6.2669 |Global loss: 6.2826| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7899
Epoch: 3|  Loss:  6.2663 |Global loss: 6.2829| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.7928009033203125
Chosen Clients:  [6, 12, 11, 0, 13, 1]

-------------Round number: 30-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.108, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.075]
AUC in each clients:  [60.936, 63.296, 66.584, 71.629, 62.387, 64.07, 64.113, 64.655, 68.688, 64.63, 67.91, 62.245, 61.783, 64.242, 65.005]
F1 Score:  [0.008, 0.043, 0.053, 0.097, 0.008, 0.049, 0.043, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.024]
Recall Score:  [0.083, 0.167, 0.156, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.115]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2455
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5401
Averaged Test F1_score: 0.0409
Averaged Test Recal score: 0.1515
Std Test Accurancy: 0.0408
Std Test AUC: 0.0230
Std Test F1: 0.0003
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7889
Epoch: 0|  Loss:  6.2578 |Global loss: 6.2828| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7884
Epoch: 1|  Loss:  6.258 |Global loss: 6.2836| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7881
Epoch: 2|  Loss:  6.2574 |Global loss: 6.2835| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7881
Epoch: 3|  Loss:  6.2554 |Global loss: 6.2818| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7892
Epoch: 0|  Loss:  6.255 |Global loss: 6.2786| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.788
Epoch: 1|  Loss:  6.2562 |Global loss: 6.2824| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7881
Epoch: 2|  Loss:  6.2543 |Global loss: 6.2804| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7881
Epoch: 3|  Loss:  6.2516 |Global loss: 6.2776| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7883
Epoch: 0|  Loss:  6.2571 |Global loss: 6.2803| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7883
Epoch: 1|  Loss:  6.255 |Global loss: 6.2779| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7871
Epoch: 2|  Loss:  6.2564 |Global loss: 6.282| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7871
Epoch: 3|  Loss:  6.2551 |Global loss: 6.2807| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7896
Epoch: 0|  Loss:  6.2658 |Global loss: 6.2824| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7896
Epoch: 1|  Loss:  6.264 |Global loss: 6.2804| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7889
Epoch: 2|  Loss:  6.2641 |Global loss: 6.2817| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.789
Epoch: 3|  Loss:  6.2623 |Global loss: 6.279| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7895
Epoch: 0|  Loss:  6.2517 |Global loss: 6.2789| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7889
Epoch: 1|  Loss:  6.2501 |Global loss: 6.2786| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7876
Epoch: 2|  Loss:  6.252 |Global loss: 6.2837| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7881
Epoch: 3|  Loss:  6.2481 |Global loss: 6.2788| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7889
Epoch: 0|  Loss:  6.2565 |Global loss: 6.2786| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.788
Epoch: 1|  Loss:  6.2576 |Global loss: 6.2817| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7881
Epoch: 2|  Loss:  6.2552 |Global loss: 6.2787| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7876
Epoch: 3|  Loss:  6.2549 |Global loss: 6.2796| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 2.8672497272491455
Chosen Clients:  [5, 12, 4, 13, 11, 6]

-------------Round number: 31-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.108, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.075]
AUC in each clients:  [61.262, 63.824, 66.584, 71.629, 62.387, 64.07, 64.02, 64.655, 68.688, 64.63, 67.91, 62.768, 62.296, 64.463, 65.005]
F1 Score:  [0.027, 0.043, 0.053, 0.097, 0.008, 0.049, 0.049, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.024]
Recall Score:  [0.094, 0.167, 0.156, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.115]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2438
Averaged Test Accurancy: 0.1044
Averaged Test AUC: 0.5412
Averaged Test F1_score: 0.0426
Averaged Test Recal score: 0.1522
Std Test Accurancy: 0.0401
Std Test AUC: 0.0221
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7877
Epoch: 0|  Loss:  6.2555 |Global loss: 6.2803| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 1|  NKD Loss: 3.7871
Epoch: 1|  Loss:  6.2556 |Global loss: 6.2814| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 2|  NKD Loss: 3.7875
Epoch: 2|  Loss:  6.2523 |Global loss: 6.2771| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7867
Epoch: 3|  Loss:  6.2527 |Global loss: 6.2789| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 0|  NKD Loss: 3.7874
Epoch: 0|  Loss:  6.2521 |Global loss: 6.28| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7872
Epoch: 1|  Loss:  6.251 |Global loss: 6.2795| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7871
Epoch: 2|  Loss:  6.2487 |Global loss: 6.2774| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7861
Epoch: 3|  Loss:  6.2499 |Global loss: 6.2807| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7894
Epoch: 0|  Loss:  6.2609 |Global loss: 6.2827| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7895
Epoch: 1|  Loss:  6.2592 |Global loss: 6.2802| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.789
Epoch: 2|  Loss:  6.2585 |Global loss: 6.2803| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7886
Epoch: 3|  Loss:  6.2574 |Global loss: 6.2797| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7872
Epoch: 0|  Loss:  6.2477 |Global loss: 6.2814| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7876
Epoch: 1|  Loss:  6.2453 |Global loss: 6.2772| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7869
Epoch: 2|  Loss:  6.2452 |Global loss: 6.279| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7861
Epoch: 3|  Loss:  6.2445 |Global loss: 6.2803| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7869
Epoch: 0|  Loss:  6.2546 |Global loss: 6.2806| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7863
Epoch: 1|  Loss:  6.2541 |Global loss: 6.2812| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.786
Epoch: 2|  Loss:  6.2535 |Global loss: 6.2814| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7859
Epoch: 3|  Loss:  6.2513 |Global loss: 6.2792| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7876
Epoch: 0|  Loss:  6.255 |Global loss: 6.282| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7874
Epoch: 1|  Loss:  6.2531 |Global loss: 6.2807| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7873
Epoch: 2|  Loss:  6.2515 |Global loss: 6.2793| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7871
Epoch: 3|  Loss:  6.2496 |Global loss: 6.2778| Local H loss: 0.0024  | Global H loss: 0.0024
------------------------- time cost ------------------------- 2.9563138484954834
Chosen Clients:  [13, 6, 7, 0, 11, 10]

-------------Round number: 32-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.108, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.075]
AUC in each clients:  [61.262, 63.824, 66.584, 71.629, 62.918, 64.653, 64.337, 64.655, 68.688, 64.63, 67.91, 63.208, 62.905, 64.895, 65.005]
F1 Score:  [0.027, 0.043, 0.053, 0.097, 0.008, 0.049, 0.043, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.024]
Recall Score:  [0.094, 0.167, 0.156, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.115]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2415
Averaged Test Accurancy: 0.1044
Averaged Test AUC: 0.5428
Averaged Test F1_score: 0.0422
Averaged Test Recal score: 0.1522
Std Test Accurancy: 0.0401
Std Test AUC: 0.0211
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7855
Epoch: 0|  Loss:  6.2453 |Global loss: 6.2827| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7853
Epoch: 1|  Loss:  6.2425 |Global loss: 6.2808| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7856
Epoch: 2|  Loss:  6.2401 |Global loss: 6.2778| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.785
Epoch: 3|  Loss:  6.2389 |Global loss: 6.2784| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.786
Epoch: 0|  Loss:  6.251 |Global loss: 6.2818| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.786
Epoch: 1|  Loss:  6.2494 |Global loss: 6.2798| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7858
Epoch: 2|  Loss:  6.2481 |Global loss: 6.2789| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7852
Epoch: 3|  Loss:  6.2475 |Global loss: 6.2799| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7864
Epoch: 0|  Loss:  6.2447 |Global loss: 6.2785| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7857
Epoch: 1|  Loss:  6.2437 |Global loss: 6.2799| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7856
Epoch: 2|  Loss:  6.241 |Global loss: 6.2778| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7848
Epoch: 3|  Loss:  6.2413 |Global loss: 6.2802| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7877
Epoch: 0|  Loss:  6.2624 |Global loss: 6.2815| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7877
Epoch: 1|  Loss:  6.2606 |Global loss: 6.279| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7869
Epoch: 2|  Loss:  6.2613 |Global loss: 6.2817| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7867
Epoch: 3|  Loss:  6.2603 |Global loss: 6.2807| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7857
Epoch: 0|  Loss:  6.2504 |Global loss: 6.2787| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7856
Epoch: 1|  Loss:  6.2486 |Global loss: 6.2769| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7849
Epoch: 2|  Loss:  6.2484 |Global loss: 6.2784| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7843
Epoch: 3|  Loss:  6.2481 |Global loss: 6.2793| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7849
Epoch: 0|  Loss:  6.2093 |Global loss: 6.2745| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7837
Epoch: 1|  Loss:  6.2112 |Global loss: 6.2791| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7837
Epoch: 2|  Loss:  6.2069 |Global loss: 6.2765| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7836
Epoch: 3|  Loss:  6.2029 |Global loss: 6.2741| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.773019790649414
Chosen Clients:  [5, 2, 1, 8, 14, 13]

-------------Round number: 33-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.108, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.075]
AUC in each clients:  [62.131, 63.824, 66.584, 71.629, 62.918, 64.653, 64.817, 64.999, 68.688, 64.63, 69.135, 64.528, 62.905, 65.609, 65.005]
F1 Score:  [0.027, 0.043, 0.053, 0.097, 0.008, 0.049, 0.036, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.024]
Recall Score:  [0.094, 0.167, 0.156, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.115]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2394
Averaged Test Accurancy: 0.1044
Averaged Test AUC: 0.5456
Averaged Test F1_score: 0.0417
Averaged Test Recal score: 0.1522
Std Test Accurancy: 0.0401
Std Test AUC: 0.0208
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7857
Epoch: 0|  Loss:  6.2519 |Global loss: 6.2794| Local H loss: 0.0023  | Global H loss: 0.0023
Epoch: 1|  NKD Loss: 3.786
Epoch: 1|  Loss:  6.2489 |Global loss: 6.2754| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7858
Epoch: 2|  Loss:  6.2464 |Global loss: 6.2732| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7847
Epoch: 3|  Loss:  6.248 |Global loss: 6.2771| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7844
Epoch: 0|  Loss:  6.2356 |Global loss: 6.2794| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7847
Epoch: 1|  Loss:  6.2306 |Global loss: 6.274| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7833
Epoch: 2|  Loss:  6.2328 |Global loss: 6.2801| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7835
Epoch: 3|  Loss:  6.229 |Global loss: 6.2766| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7861
Epoch: 0|  Loss:  6.2529 |Global loss: 6.2789| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7858
Epoch: 1|  Loss:  6.2514 |Global loss: 6.278| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7855
Epoch: 2|  Loss:  6.25 |Global loss: 6.2771| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7849
Epoch: 3|  Loss:  6.2496 |Global loss: 6.2777| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7842
Epoch: 0|  Loss:  6.2196 |Global loss: 6.2809| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7849
Epoch: 1|  Loss:  6.2156 |Global loss: 6.2754| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7839
Epoch: 2|  Loss:  6.2137 |Global loss: 6.2781| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7833
Epoch: 3|  Loss:  6.2137 |Global loss: 6.2792| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7869
Epoch: 0|  Loss:  6.2486 |Global loss: 6.2791| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7861
Epoch: 1|  Loss:  6.2481 |Global loss: 6.2802| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7861
Epoch: 2|  Loss:  6.2459 |Global loss: 6.2782| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7858
Epoch: 3|  Loss:  6.2437 |Global loss: 6.2763| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7845
Epoch: 0|  Loss:  6.237 |Global loss: 6.2781| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7842
Epoch: 1|  Loss:  6.2349 |Global loss: 6.2768| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7835
Epoch: 2|  Loss:  6.2347 |Global loss: 6.2784| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7833
Epoch: 3|  Loss:  6.2333 |Global loss: 6.2777| Local H loss: 0.0029  | Global H loss: 0.0029
------------------------- time cost ------------------------- 2.968167543411255
Chosen Clients:  [2, 10, 3, 0, 4, 11]

-------------Round number: 34-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.083]
AUC in each clients:  [62.131, 64.17, 67.589, 71.629, 62.918, 64.687, 64.817, 64.999, 69.789, 64.63, 69.135, 64.528, 62.905, 66.009, 65.359]
F1 Score:  [0.027, 0.043, 0.044, 0.097, 0.008, 0.049, 0.036, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.028]
Recall Score:  [0.094, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.125]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2373
Averaged Test Accurancy: 0.1056
Averaged Test AUC: 0.5474
Averaged Test F1_score: 0.0414
Averaged Test Recal score: 0.1536
Std Test Accurancy: 0.0399
Std Test AUC: 0.0218
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7823
Epoch: 0|  Loss:  6.2305 |Global loss: 6.2808| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7827
Epoch: 1|  Loss:  6.2258 |Global loss: 6.276| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7821
Epoch: 2|  Loss:  6.2256 |Global loss: 6.2774| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7813
Epoch: 3|  Loss:  6.224 |Global loss: 6.2788| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7822
Epoch: 0|  Loss:  6.2013 |Global loss: 6.277| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7815
Epoch: 1|  Loss:  6.2007 |Global loss: 6.2788| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7816
Epoch: 2|  Loss:  6.195 |Global loss: 6.2752| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.781
Epoch: 3|  Loss:  6.1936 |Global loss: 6.277| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.7821
Epoch: 0|  Loss:  6.1937 |Global loss: 6.2754| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7812
Epoch: 1|  Loss:  6.1924 |Global loss: 6.2783| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7808
Epoch: 2|  Loss:  6.1883 |Global loss: 6.2777| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7808
Epoch: 3|  Loss:  6.185 |Global loss: 6.2757| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7854
Epoch: 0|  Loss:  6.2589 |Global loss: 6.2808| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7857
Epoch: 1|  Loss:  6.2568 |Global loss: 6.2778| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7849
Epoch: 2|  Loss:  6.2568 |Global loss: 6.279| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7842
Epoch: 3|  Loss:  6.2567 |Global loss: 6.2802| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7868
Epoch: 0|  Loss:  6.2554 |Global loss: 6.2797| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7859
Epoch: 1|  Loss:  6.2562 |Global loss: 6.2828| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7863
Epoch: 2|  Loss:  6.2534 |Global loss: 6.2781| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7857
Epoch: 3|  Loss:  6.2525 |Global loss: 6.2783| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7828
Epoch: 0|  Loss:  6.2476 |Global loss: 6.2812| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7833
Epoch: 1|  Loss:  6.2442 |Global loss: 6.2768| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7827
Epoch: 2|  Loss:  6.2437 |Global loss: 6.2775| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7825
Epoch: 3|  Loss:  6.2422 |Global loss: 6.2761| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 3.080199718475342
Chosen Clients:  [3, 1, 13, 4, 14, 6]

-------------Round number: 35-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.083]
AUC in each clients:  [62.543, 64.17, 68.354, 73.084, 64.048, 64.687, 64.817, 64.999, 69.789, 64.63, 69.542, 65.154, 62.905, 66.009, 65.359]
F1 Score:  [0.041, 0.043, 0.043, 0.097, 0.008, 0.049, 0.036, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.028]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.125]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2336
Averaged Test Accurancy: 0.1061
Averaged Test AUC: 0.5501
Averaged Test F1_score: 0.0423
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0393
Std Test AUC: 0.0234
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7803
Epoch: 0|  Loss:  6.1819 |Global loss: 6.2772| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.78
Epoch: 1|  Loss:  6.1762 |Global loss: 6.2757| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7799
Epoch: 2|  Loss:  6.1732 |Global loss: 6.2741| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7797
Epoch: 3|  Loss:  6.1675 |Global loss: 6.2724| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.7838
Epoch: 0|  Loss:  6.2489 |Global loss: 6.2782| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7829
Epoch: 1|  Loss:  6.2484 |Global loss: 6.2794| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7826
Epoch: 2|  Loss:  6.2476 |Global loss: 6.2792| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7827
Epoch: 3|  Loss:  6.2446 |Global loss: 6.2751| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7825
Epoch: 0|  Loss:  6.2289 |Global loss: 6.2745| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7808
Epoch: 1|  Loss:  6.2314 |Global loss: 6.2812| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7808
Epoch: 2|  Loss:  6.2287 |Global loss: 6.2792| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7814
Epoch: 3|  Loss:  6.2246 |Global loss: 6.274| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.785
Epoch: 0|  Loss:  6.2514 |Global loss: 6.278| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7845
Epoch: 1|  Loss:  6.2506 |Global loss: 6.2781| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.784
Epoch: 2|  Loss:  6.2497 |Global loss: 6.278| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7834
Epoch: 3|  Loss:  6.2494 |Global loss: 6.2789| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7844
Epoch: 0|  Loss:  6.2426 |Global loss: 6.2775| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7839
Epoch: 1|  Loss:  6.2418 |Global loss: 6.2781| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7835
Epoch: 2|  Loss:  6.2401 |Global loss: 6.2773| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7826
Epoch: 3|  Loss:  6.2403 |Global loss: 6.2795| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7842
Epoch: 0|  Loss:  6.2421 |Global loss: 6.2743| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7834
Epoch: 1|  Loss:  6.242 |Global loss: 6.2759| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7824
Epoch: 2|  Loss:  6.2417 |Global loss: 6.2784| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7828
Epoch: 3|  Loss:  6.2382 |Global loss: 6.2739| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.943270683288574
Chosen Clients:  [8, 4, 2, 9, 14, 6]

-------------Round number: 36-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.183, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.273, 68.354, 74.615, 64.671, 64.687, 64.696, 64.999, 69.789, 64.63, 69.542, 65.154, 62.905, 66.57, 65.338]
F1 Score:  [0.041, 0.043, 0.043, 0.097, 0.008, 0.049, 0.036, 0.036, 0.12, 0.042, 0.039, 0.008, 0.008, 0.036, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2303
Averaged Test Accurancy: 0.1083
Averaged Test AUC: 0.5515
Averaged Test F1_score: 0.0433
Averaged Test Recal score: 0.1571
Std Test Accurancy: 0.0388
Std Test AUC: 0.0255
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7812
Epoch: 0|  Loss:  6.2095 |Global loss: 6.2792| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7815
Epoch: 1|  Loss:  6.2045 |Global loss: 6.2749| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7808
Epoch: 2|  Loss:  6.2012 |Global loss: 6.2745| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7798
Epoch: 3|  Loss:  6.2028 |Global loss: 6.2791| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7833
Epoch: 0|  Loss:  6.2467 |Global loss: 6.276| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7821
Epoch: 1|  Loss:  6.2477 |Global loss: 6.2794| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.782
Epoch: 2|  Loss:  6.2461 |Global loss: 6.2776| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7815
Epoch: 3|  Loss:  6.2454 |Global loss: 6.2776| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7802
Epoch: 0|  Loss:  6.2211 |Global loss: 6.2776| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7805
Epoch: 1|  Loss:  6.2172 |Global loss: 6.2738| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7795
Epoch: 2|  Loss:  6.2162 |Global loss: 6.2756| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.779
Epoch: 3|  Loss:  6.2135 |Global loss: 6.2751| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7831
Epoch: 0|  Loss:  6.2456 |Global loss: 6.2795| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7827
Epoch: 1|  Loss:  6.2447 |Global loss: 6.2793| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7828
Epoch: 2|  Loss:  6.2412 |Global loss: 6.275| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7819
Epoch: 3|  Loss:  6.2426 |Global loss: 6.2782| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7828
Epoch: 0|  Loss:  6.2372 |Global loss: 6.2759| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.782
Epoch: 1|  Loss:  6.2367 |Global loss: 6.2775| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7821
Epoch: 2|  Loss:  6.2336 |Global loss: 6.2738| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7812
Epoch: 3|  Loss:  6.233 |Global loss: 6.2757| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7819
Epoch: 0|  Loss:  6.2386 |Global loss: 6.2757| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.781
Epoch: 1|  Loss:  6.2394 |Global loss: 6.2786| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7805
Epoch: 2|  Loss:  6.2382 |Global loss: 6.2784| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7797
Epoch: 3|  Loss:  6.2381 |Global loss: 6.2803| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.6914424896240234
Chosen Clients:  [2, 6, 5, 11, 12, 1]

-------------Round number: 37-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.15, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.273, 69.239, 74.615, 65.375, 64.687, 64.966, 64.999, 70.545, 64.905, 69.542, 65.154, 62.905, 66.57, 65.345]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.092, 0.042, 0.039, 0.008, 0.008, 0.036, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.208, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2271
Averaged Test Accurancy: 0.1061
Averaged Test AUC: 0.5531
Averaged Test F1_score: 0.0413
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0353
Std Test AUC: 0.0261
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7792
Epoch: 0|  Loss:  6.2105 |Global loss: 6.2727| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7782
Epoch: 1|  Loss:  6.2096 |Global loss: 6.2755| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7774
Epoch: 2|  Loss:  6.2088 |Global loss: 6.2772| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7776
Epoch: 3|  Loss:  6.2034 |Global loss: 6.273| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.78
Epoch: 0|  Loss:  6.2349 |Global loss: 6.2764| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7791
Epoch: 1|  Loss:  6.2345 |Global loss: 6.2786| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7793
Epoch: 2|  Loss:  6.2315 |Global loss: 6.275| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.779
Epoch: 3|  Loss:  6.228 |Global loss: 6.2729| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7822
Epoch: 0|  Loss:  6.2447 |Global loss: 6.2755| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7818
Epoch: 1|  Loss:  6.2435 |Global loss: 6.275| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7804
Epoch: 2|  Loss:  6.245 |Global loss: 6.2792| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 3|  NKD Loss: 3.7806
Epoch: 3|  Loss:  6.2424 |Global loss: 6.2756| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 0|  NKD Loss: 3.7805
Epoch: 0|  Loss:  6.2388 |Global loss: 6.2744| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7794
Epoch: 1|  Loss:  6.2395 |Global loss: 6.2776| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7793
Epoch: 2|  Loss:  6.2378 |Global loss: 6.2767| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7791
Epoch: 3|  Loss:  6.2349 |Global loss: 6.2739| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7822
Epoch: 0|  Loss:  6.2455 |Global loss: 6.2805| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7816
Epoch: 1|  Loss:  6.2443 |Global loss: 6.2806| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7818
Epoch: 2|  Loss:  6.2414 |Global loss: 6.2766| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7815
Epoch: 3|  Loss:  6.2395 |Global loss: 6.2754| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7813
Epoch: 0|  Loss:  6.2433 |Global loss: 6.2759| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7806
Epoch: 1|  Loss:  6.2425 |Global loss: 6.2763| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.78
Epoch: 2|  Loss:  6.2415 |Global loss: 6.2763| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7802
Epoch: 3|  Loss:  6.2387 |Global loss: 6.2732| Local H loss: 0.0025  | Global H loss: 0.0025
------------------------- time cost ------------------------- 2.8395090103149414
Chosen Clients:  [11, 7, 14, 3, 13, 10]

-------------Round number: 38-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.15, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.251, 69.693, 74.615, 65.375, 64.526, 64.937, 64.999, 70.545, 64.905, 69.542, 65.633, 63.148, 66.57, 65.345]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.092, 0.042, 0.039, 0.008, 0.008, 0.036, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.208, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2240
Averaged Test Accurancy: 0.1061
Averaged Test AUC: 0.5537
Averaged Test F1_score: 0.0413
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0353
Std Test AUC: 0.0262
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7783
Epoch: 0|  Loss:  6.2346 |Global loss: 6.2751| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7776
Epoch: 1|  Loss:  6.2345 |Global loss: 6.2767| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7779
Epoch: 2|  Loss:  6.23 |Global loss: 6.2712| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7772
Epoch: 3|  Loss:  6.229 |Global loss: 6.2715| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7809
Epoch: 0|  Loss:  6.2347 |Global loss: 6.2776| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7809
Epoch: 1|  Loss:  6.2311 |Global loss: 6.2743| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7794
Epoch: 2|  Loss:  6.2319 |Global loss: 6.279| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7794
Epoch: 3|  Loss:  6.2288 |Global loss: 6.2756| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7801
Epoch: 0|  Loss:  6.2298 |Global loss: 6.2735| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7792
Epoch: 1|  Loss:  6.2295 |Global loss: 6.2755| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7793
Epoch: 2|  Loss:  6.2262 |Global loss: 6.2729| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7781
Epoch: 3|  Loss:  6.2267 |Global loss: 6.2759| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7771
Epoch: 0|  Loss:  6.1648 |Global loss: 6.2763| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.777
Epoch: 1|  Loss:  6.1575 |Global loss: 6.2738| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7765
Epoch: 2|  Loss:  6.1558 |Global loss: 6.2748| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.7762
Epoch: 3|  Loss:  6.1494 |Global loss: 6.2739| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.779
Epoch: 0|  Loss:  6.2206 |Global loss: 6.2739| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7779
Epoch: 1|  Loss:  6.2205 |Global loss: 6.2768| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7784
Epoch: 2|  Loss:  6.2153 |Global loss: 6.2706| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7768
Epoch: 3|  Loss:  6.2167 |Global loss: 6.2758| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7784
Epoch: 0|  Loss:  6.1857 |Global loss: 6.2731| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7775
Epoch: 1|  Loss:  6.185 |Global loss: 6.2757| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.777
Epoch: 2|  Loss:  6.1831 |Global loss: 6.2762| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7764
Epoch: 3|  Loss:  6.1801 |Global loss: 6.2761| Local H loss: 0.0032  | Global H loss: 0.0032
------------------------- time cost ------------------------- 3.0241382122039795
Chosen Clients:  [3, 14, 2, 1, 4, 13]

-------------Round number: 39-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.15, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.251, 69.693, 76.151, 65.375, 64.526, 64.937, 65.433, 70.545, 64.905, 70.461, 66.263, 63.148, 66.97, 65.471]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.092, 0.042, 0.039, 0.008, 0.008, 0.036, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.208, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2205
Averaged Test Accurancy: 0.1061
Averaged Test AUC: 0.5559
Averaged Test F1_score: 0.0413
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0353
Std Test AUC: 0.0288
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.776
Epoch: 0|  Loss:  6.1452 |Global loss: 6.2744| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.7757
Epoch: 1|  Loss:  6.1421 |Global loss: 6.2752| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.7756
Epoch: 2|  Loss:  6.1354 |Global loss: 6.2733| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.775
Epoch: 3|  Loss:  6.1322 |Global loss: 6.2745| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 0|  NKD Loss: 3.7781
Epoch: 0|  Loss:  6.2231 |Global loss: 6.2719| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7766
Epoch: 1|  Loss:  6.2249 |Global loss: 6.2776| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7764
Epoch: 2|  Loss:  6.2216 |Global loss: 6.2754| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7758
Epoch: 3|  Loss:  6.2204 |Global loss: 6.2755| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7759
Epoch: 0|  Loss:  6.2009 |Global loss: 6.2739| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7753
Epoch: 1|  Loss:  6.1983 |Global loss: 6.2741| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7747
Epoch: 2|  Loss:  6.1949 |Global loss: 6.2738| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7746
Epoch: 3|  Loss:  6.1929 |Global loss: 6.2726| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7785
Epoch: 0|  Loss:  6.2374 |Global loss: 6.2734| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7777
Epoch: 1|  Loss:  6.2373 |Global loss: 6.2754| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.777
Epoch: 2|  Loss:  6.236 |Global loss: 6.2751| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7769
Epoch: 3|  Loss:  6.233 |Global loss: 6.2719| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7794
Epoch: 0|  Loss:  6.2425 |Global loss: 6.2771| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7786
Epoch: 1|  Loss:  6.2422 |Global loss: 6.2779| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7776
Epoch: 2|  Loss:  6.2409 |Global loss: 6.2786| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7776
Epoch: 3|  Loss:  6.2395 |Global loss: 6.2767| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7765
Epoch: 0|  Loss:  6.2145 |Global loss: 6.2745| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7761
Epoch: 1|  Loss:  6.2121 |Global loss: 6.2735| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7754
Epoch: 2|  Loss:  6.2099 |Global loss: 6.2741| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7756
Epoch: 3|  Loss:  6.206 |Global loss: 6.27| Local H loss: 0.0031  | Global H loss: 0.0031
------------------------- time cost ------------------------- 3.050992727279663
Chosen Clients:  [2, 11, 10, 13, 12, 8]

-------------Round number: 40-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.15, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.541, 70.314, 77.869, 65.644, 64.526, 64.937, 65.433, 70.545, 64.905, 70.461, 66.263, 63.148, 67.304, 65.617]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.092, 0.042, 0.039, 0.008, 0.008, 0.035, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.208, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2156
Averaged Test Accurancy: 0.1061
Averaged Test AUC: 0.5578
Averaged Test F1_score: 0.0413
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0353
Std Test AUC: 0.0316
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7735
Epoch: 0|  Loss:  6.1904 |Global loss: 6.275| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7732
Epoch: 1|  Loss:  6.1874 |Global loss: 6.2741| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7729
Epoch: 2|  Loss:  6.185 |Global loss: 6.2742| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.773
Epoch: 3|  Loss:  6.1788 |Global loss: 6.2691| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.775
Epoch: 0|  Loss:  6.2291 |Global loss: 6.2747| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7745
Epoch: 1|  Loss:  6.2272 |Global loss: 6.2737| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7743
Epoch: 2|  Loss:  6.2235 |Global loss: 6.2706| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.773
Epoch: 3|  Loss:  6.2239 |Global loss: 6.2735| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7752
Epoch: 0|  Loss:  6.1752 |Global loss: 6.2752| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.775
Epoch: 1|  Loss:  6.1717 |Global loss: 6.2732| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7743
Epoch: 2|  Loss:  6.1689 |Global loss: 6.2741| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.774
Epoch: 3|  Loss:  6.1646 |Global loss: 6.2727| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7743
Epoch: 0|  Loss:  6.207 |Global loss: 6.2746| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7742
Epoch: 1|  Loss:  6.201 |Global loss: 6.2704| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7734
Epoch: 2|  Loss:  6.2016 |Global loss: 6.2725| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7728
Epoch: 3|  Loss:  6.1976 |Global loss: 6.2715| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7786
Epoch: 0|  Loss:  6.2366 |Global loss: 6.2763| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7782
Epoch: 1|  Loss:  6.2346 |Global loss: 6.275| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7773
Epoch: 2|  Loss:  6.2338 |Global loss: 6.276| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7768
Epoch: 3|  Loss:  6.2316 |Global loss: 6.2746| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7768
Epoch: 0|  Loss:  6.1964 |Global loss: 6.276| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7759
Epoch: 1|  Loss:  6.1925 |Global loss: 6.2768| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7758
Epoch: 2|  Loss:  6.1874 |Global loss: 6.2731| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7752
Epoch: 3|  Loss:  6.1869 |Global loss: 6.2755| Local H loss: 0.003  | Global H loss: 0.003
------------------------- time cost ------------------------- 2.9502711296081543
Chosen Clients:  [2, 8, 13, 9, 12, 10]

-------------Round number: 41-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.541, 70.595, 77.869, 65.644, 64.526, 64.937, 65.433, 71.216, 64.905, 71.339, 67.169, 63.249, 68.112, 65.617]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.035, 0.042, 0.039, 0.008, 0.008, 0.036, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2116
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5598
Averaged Test F1_score: 0.0375
Averaged Test Recal score: 0.1515
Std Test Accurancy: 0.0335
Std Test AUC: 0.0326
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7724
Epoch: 0|  Loss:  6.1765 |Global loss: 6.2705| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7719
Epoch: 1|  Loss:  6.1742 |Global loss: 6.2704| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7715
Epoch: 2|  Loss:  6.1685 |Global loss: 6.269| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7703
Epoch: 3|  Loss:  6.17 |Global loss: 6.2745| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7752
Epoch: 0|  Loss:  6.18 |Global loss: 6.2703| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7739
Epoch: 1|  Loss:  6.1797 |Global loss: 6.2737| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7738
Epoch: 2|  Loss:  6.173 |Global loss: 6.2706| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7728
Epoch: 3|  Loss:  6.172 |Global loss: 6.2732| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.7727
Epoch: 0|  Loss:  6.1946 |Global loss: 6.27| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7718
Epoch: 1|  Loss:  6.1927 |Global loss: 6.2709| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7714
Epoch: 2|  Loss:  6.1889 |Global loss: 6.2689| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7701
Epoch: 3|  Loss:  6.1889 |Global loss: 6.2723| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7783
Epoch: 0|  Loss:  6.2354 |Global loss: 6.2738| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7765
Epoch: 1|  Loss:  6.2375 |Global loss: 6.2803| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7769
Epoch: 2|  Loss:  6.234 |Global loss: 6.2748| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.776
Epoch: 3|  Loss:  6.2325 |Global loss: 6.2751| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7764
Epoch: 0|  Loss:  6.2283 |Global loss: 6.2715| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7753
Epoch: 1|  Loss:  6.2275 |Global loss: 6.2732| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7752
Epoch: 2|  Loss:  6.2252 |Global loss: 6.2708| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7738
Epoch: 3|  Loss:  6.2257 |Global loss: 6.2746| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7737
Epoch: 0|  Loss:  6.1651 |Global loss: 6.2761| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.7732
Epoch: 1|  Loss:  6.161 |Global loss: 6.2751| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 2|  NKD Loss: 3.7734
Epoch: 2|  Loss:  6.1548 |Global loss: 6.2709| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7726
Epoch: 3|  Loss:  6.1523 |Global loss: 6.2728| Local H loss: 0.0035  | Global H loss: 0.0035
------------------------- time cost ------------------------- 3.07102108001709
Chosen Clients:  [1, 12, 8, 10, 9, 14]

-------------Round number: 42-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.541, 72.226, 77.869, 65.644, 64.526, 64.937, 65.433, 72.358, 64.836, 72.181, 67.169, 63.372, 69.094, 65.617]
F1 Score:  [0.041, 0.043, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.035, 0.042, 0.039, 0.008, 0.008, 0.037, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2065
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5624
Averaged Test F1_score: 0.0376
Averaged Test Recal score: 0.1515
Std Test Accurancy: 0.0335
Std Test AUC: 0.0348
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7739
Epoch: 0|  Loss:  6.2297 |Global loss: 6.2712| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7721
Epoch: 1|  Loss:  6.2309 |Global loss: 6.2763| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7724
Epoch: 2|  Loss:  6.2274 |Global loss: 6.271| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7713
Epoch: 3|  Loss:  6.2268 |Global loss: 6.2726| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7725
Epoch: 0|  Loss:  6.2253 |Global loss: 6.2767| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7727
Epoch: 1|  Loss:  6.2202 |Global loss: 6.271| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.772
Epoch: 2|  Loss:  6.2188 |Global loss: 6.2715| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.771
Epoch: 3|  Loss:  6.2186 |Global loss: 6.2733| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7723
Epoch: 0|  Loss:  6.1696 |Global loss: 6.2734| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7719
Epoch: 1|  Loss:  6.1645 |Global loss: 6.2718| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.772
Epoch: 2|  Loss:  6.1596 |Global loss: 6.2682| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7707
Epoch: 3|  Loss:  6.1579 |Global loss: 6.2718| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7724
Epoch: 0|  Loss:  6.1522 |Global loss: 6.2757| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7724
Epoch: 1|  Loss:  6.1452 |Global loss: 6.2726| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7724
Epoch: 2|  Loss:  6.1407 |Global loss: 6.2702| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7718
Epoch: 3|  Loss:  6.1371 |Global loss: 6.2701| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7743
Epoch: 0|  Loss:  6.2324 |Global loss: 6.2781| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7741
Epoch: 1|  Loss:  6.23 |Global loss: 6.2757| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7733
Epoch: 2|  Loss:  6.2297 |Global loss: 6.2769| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7735
Epoch: 3|  Loss:  6.2248 |Global loss: 6.2708| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7736
Epoch: 0|  Loss:  6.2139 |Global loss: 6.2709| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7721
Epoch: 1|  Loss:  6.2147 |Global loss: 6.2751| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7716
Epoch: 2|  Loss:  6.2128 |Global loss: 6.2747| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7718
Epoch: 3|  Loss:  6.2066 |Global loss: 6.2687| Local H loss: 0.0027  | Global H loss: 0.0027
------------------------- time cost ------------------------- 2.9184587001800537
Chosen Clients:  [5, 3, 13, 8, 0, 4]

-------------Round number: 43-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.067, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.543, 64.726, 72.226, 77.869, 65.644, 64.526, 64.937, 65.433, 73.147, 64.868, 73.87, 67.169, 63.634, 69.094, 66.171]
F1 Score:  [0.041, 0.036, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.036, 0.042, 0.039, 0.008, 0.009, 0.037, 0.043]
Recall Score:  [0.104, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.2021
Averaged Test Accurancy: 0.1039
Averaged Test AUC: 0.5644
Averaged Test F1_score: 0.0373
Averaged Test Recal score: 0.1515
Std Test Accurancy: 0.0335
Std Test AUC: 0.0362
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7743
Epoch: 0|  Loss:  6.2385 |Global loss: 6.2796| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 1|  NKD Loss: 3.7743
Epoch: 1|  Loss:  6.2352 |Global loss: 6.2749| Local H loss: 0.0024  | Global H loss: 0.0024
Epoch: 2|  NKD Loss: 3.7735
Epoch: 2|  Loss:  6.2335 |Global loss: 6.2739| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7725
Epoch: 3|  Loss:  6.2331 |Global loss: 6.2747| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.7704
Epoch: 0|  Loss:  6.1251 |Global loss: 6.2752| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7707
Epoch: 1|  Loss:  6.115 |Global loss: 6.271| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.7697
Epoch: 2|  Loss:  6.1127 |Global loss: 6.2742| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.7701
Epoch: 3|  Loss:  6.1043 |Global loss: 6.2705| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.7686
Epoch: 0|  Loss:  6.1846 |Global loss: 6.2704| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.7677
Epoch: 1|  Loss:  6.1798 |Global loss: 6.27| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 2|  NKD Loss: 3.7673
Epoch: 2|  Loss:  6.179 |Global loss: 6.2698| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.7662
Epoch: 3|  Loss:  6.1761 |Global loss: 6.2709| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.771
Epoch: 0|  Loss:  6.1534 |Global loss: 6.2694| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7698
Epoch: 1|  Loss:  6.1521 |Global loss: 6.2728| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.769
Epoch: 2|  Loss:  6.1516 |Global loss: 6.2756| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.7689
Epoch: 3|  Loss:  6.1476 |Global loss: 6.273| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7769
Epoch: 0|  Loss:  6.249 |Global loss: 6.2798| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7765
Epoch: 1|  Loss:  6.2476 |Global loss: 6.2773| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7758
Epoch: 2|  Loss:  6.2454 |Global loss: 6.2752| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 3|  NKD Loss: 3.7743
Epoch: 3|  Loss:  6.2463 |Global loss: 6.2791| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 0|  NKD Loss: 3.773
Epoch: 0|  Loss:  6.2364 |Global loss: 6.2796| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7738
Epoch: 1|  Loss:  6.23 |Global loss: 6.2695| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7714
Epoch: 2|  Loss:  6.2339 |Global loss: 6.279| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7701
Epoch: 3|  Loss:  6.2332 |Global loss: 6.2801| Local H loss: 0.0026  | Global H loss: 0.0026
------------------------- time cost ------------------------- 3.044736862182617
Chosen Clients:  [7, 3, 11, 0, 5, 2]

-------------Round number: 44-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.058, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.513, 64.726, 72.226, 78.723, 65.627, 64.294, 64.937, 65.433, 73.91, 64.868, 73.87, 67.169, 63.634, 70.198, 66.171]
F1 Score:  [0.027, 0.036, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.036, 0.042, 0.039, 0.008, 0.009, 0.037, 0.043]
Recall Score:  [0.094, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1973
Averaged Test Accurancy: 0.1033
Averaged Test AUC: 0.5657
Averaged Test F1_score: 0.0363
Averaged Test Recal score: 0.1509
Std Test Accurancy: 0.0341
Std Test AUC: 0.0382
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7728
Epoch: 0|  Loss:  6.2234 |Global loss: 6.2778| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7721
Epoch: 1|  Loss:  6.2189 |Global loss: 6.2742| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7719
Epoch: 2|  Loss:  6.2154 |Global loss: 6.2705| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7706
Epoch: 3|  Loss:  6.2133 |Global loss: 6.2714| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.7701
Epoch: 0|  Loss:  6.1071 |Global loss: 6.2748| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.7694
Epoch: 1|  Loss:  6.099 |Global loss: 6.2737| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 2|  NKD Loss: 3.77
Epoch: 2|  Loss:  6.0893 |Global loss: 6.2692| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.7691
Epoch: 3|  Loss:  6.0853 |Global loss: 6.2718| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 0|  NKD Loss: 3.7691
Epoch: 0|  Loss:  6.2171 |Global loss: 6.269| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7684
Epoch: 1|  Loss:  6.2159 |Global loss: 6.269| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7677
Epoch: 2|  Loss:  6.2137 |Global loss: 6.2684| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.766
Epoch: 3|  Loss:  6.2138 |Global loss: 6.2716| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7737
Epoch: 0|  Loss:  6.2442 |Global loss: 6.2765| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7732
Epoch: 1|  Loss:  6.2416 |Global loss: 6.2739| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7721
Epoch: 2|  Loss:  6.2415 |Global loss: 6.2752| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7719
Epoch: 3|  Loss:  6.2382 |Global loss: 6.2706| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7711
Epoch: 0|  Loss:  6.2319 |Global loss: 6.2761| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 1|  NKD Loss: 3.7705
Epoch: 1|  Loss:  6.2306 |Global loss: 6.2746| Local H loss: 0.0025  | Global H loss: 0.0025
Epoch: 2|  NKD Loss: 3.7702
Epoch: 2|  Loss:  6.228 |Global loss: 6.2718| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7694
Epoch: 3|  Loss:  6.2268 |Global loss: 6.2717| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7672
Epoch: 0|  Loss:  6.1626 |Global loss: 6.2724| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7667
Epoch: 1|  Loss:  6.1574 |Global loss: 6.2702| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7668
Epoch: 2|  Loss:  6.1516 |Global loss: 6.2667| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.7652
Epoch: 3|  Loss:  6.1501 |Global loss: 6.272| Local H loss: 0.0034  | Global H loss: 0.0034
------------------------- time cost ------------------------- 2.95932674407959
Chosen Clients:  [2, 6, 9, 3, 10, 12]

-------------Round number: 45-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.05, 0.117, 0.117]
AUC in each clients:  [62.602, 64.726, 73.31, 80.798, 65.627, 64.186, 64.937, 65.884, 73.91, 64.868, 73.87, 67.274, 63.634, 70.198, 66.171]
F1 Score:  [0.05, 0.036, 0.041, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.008, 0.009, 0.037, 0.043]
Recall Score:  [0.115, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.083, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1915
Averaged Test Accurancy: 0.1044
Averaged Test AUC: 0.5678
Averaged Test F1_score: 0.0377
Averaged Test Recal score: 0.1523
Std Test Accurancy: 0.0329
Std Test AUC: 0.0415
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7658
Epoch: 0|  Loss:  6.1464 |Global loss: 6.2699| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.765
Epoch: 1|  Loss:  6.1429 |Global loss: 6.2699| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7645
Epoch: 2|  Loss:  6.1381 |Global loss: 6.2693| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7639
Epoch: 3|  Loss:  6.1361 |Global loss: 6.2709| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7706
Epoch: 0|  Loss:  6.2196 |Global loss: 6.272| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7701
Epoch: 1|  Loss:  6.2172 |Global loss: 6.2694| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7687
Epoch: 2|  Loss:  6.218 |Global loss: 6.2724| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7683
Epoch: 3|  Loss:  6.2141 |Global loss: 6.2685| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.77
Epoch: 0|  Loss:  6.2205 |Global loss: 6.2707| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7696
Epoch: 1|  Loss:  6.2177 |Global loss: 6.2676| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7686
Epoch: 2|  Loss:  6.2164 |Global loss: 6.2685| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7669
Epoch: 3|  Loss:  6.2174 |Global loss: 6.2724| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7695
Epoch: 0|  Loss:  6.0804 |Global loss: 6.2722| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.7693
Epoch: 1|  Loss:  6.0745 |Global loss: 6.2704| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 2|  NKD Loss: 3.7686
Epoch: 2|  Loss:  6.0677 |Global loss: 6.2719| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 3|  NKD Loss: 3.7687
Epoch: 3|  Loss:  6.0635 |Global loss: 6.2706| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 0|  NKD Loss: 3.7685
Epoch: 0|  Loss:  6.1314 |Global loss: 6.2706| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.7679
Epoch: 1|  Loss:  6.1293 |Global loss: 6.2718| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.7669
Epoch: 2|  Loss:  6.1286 |Global loss: 6.2735| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7669
Epoch: 3|  Loss:  6.1224 |Global loss: 6.2719| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.7677
Epoch: 0|  Loss:  6.2138 |Global loss: 6.2723| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7671
Epoch: 1|  Loss:  6.2097 |Global loss: 6.27| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7667
Epoch: 2|  Loss:  6.2066 |Global loss: 6.2669| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7649
Epoch: 3|  Loss:  6.2068 |Global loss: 6.2714| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 2.920802354812622
Chosen Clients:  [14, 2, 13, 8, 10, 6]

-------------Round number: 46-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.058, 0.117, 0.117]
AUC in each clients:  [62.602, 64.726, 75.506, 82.627, 65.627, 64.186, 64.512, 65.884, 73.91, 65.252, 75.165, 67.274, 64.42, 70.198, 66.171]
F1 Score:  [0.05, 0.036, 0.042, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.008, 0.015, 0.037, 0.043]
Recall Score:  [0.115, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.094, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1866
Averaged Test Accurancy: 0.1050
Averaged Test AUC: 0.5711
Averaged Test F1_score: 0.0382
Averaged Test Recal score: 0.1530
Std Test Accurancy: 0.0320
Std Test AUC: 0.0460
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7664
Epoch: 0|  Loss:  6.202 |Global loss: 6.2705| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7658
Epoch: 1|  Loss:  6.1995 |Global loss: 6.27| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7649
Epoch: 2|  Loss:  6.1973 |Global loss: 6.269| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7641
Epoch: 3|  Loss:  6.1926 |Global loss: 6.2663| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7648
Epoch: 0|  Loss:  6.1276 |Global loss: 6.2647| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.7637
Epoch: 1|  Loss:  6.1238 |Global loss: 6.2673| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.7627
Epoch: 2|  Loss:  6.1238 |Global loss: 6.271| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.7628
Epoch: 3|  Loss:  6.1166 |Global loss: 6.2653| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.7623
Epoch: 0|  Loss:  6.1714 |Global loss: 6.2717| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7622
Epoch: 1|  Loss:  6.1657 |Global loss: 6.2679| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.761
Epoch: 2|  Loss:  6.1663 |Global loss: 6.2703| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7601
Epoch: 3|  Loss:  6.1591 |Global loss: 6.2684| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7653
Epoch: 0|  Loss:  6.1419 |Global loss: 6.2734| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.766
Epoch: 1|  Loss:  6.1297 |Global loss: 6.2648| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7643
Epoch: 2|  Loss:  6.13 |Global loss: 6.2719| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.764
Epoch: 3|  Loss:  6.1243 |Global loss: 6.2697| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.7674
Epoch: 0|  Loss:  6.1185 |Global loss: 6.2717| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.7669
Epoch: 1|  Loss:  6.1136 |Global loss: 6.2705| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7662
Epoch: 2|  Loss:  6.1113 |Global loss: 6.2698| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.7657
Epoch: 3|  Loss:  6.1075 |Global loss: 6.2709| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7664
Epoch: 0|  Loss:  6.2135 |Global loss: 6.2714| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.765
Epoch: 1|  Loss:  6.2127 |Global loss: 6.2734| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7647
Epoch: 2|  Loss:  6.2108 |Global loss: 6.2718| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.765
Epoch: 3|  Loss:  6.2026 |Global loss: 6.2624| Local H loss: 0.0028  | Global H loss: 0.0028
------------------------- time cost ------------------------- 3.1046204566955566
Chosen Clients:  [1, 0, 2, 4, 8, 11]

-------------Round number: 47-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.117, 0.125, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.058, 0.117, 0.117]
AUC in each clients:  [62.602, 64.726, 77.064, 82.627, 65.627, 64.186, 64.839, 65.884, 74.367, 65.252, 76.833, 67.274, 64.42, 71.015, 66.677]
F1 Score:  [0.05, 0.036, 0.061, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.008, 0.015, 0.037, 0.043]
Recall Score:  [0.115, 0.167, 0.177, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.094, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1804
Averaged Test Accurancy: 0.1056
Averaged Test AUC: 0.5741
Averaged Test F1_score: 0.0395
Averaged Test Recal score: 0.1537
Std Test Accurancy: 0.0323
Std Test AUC: 0.0485
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7653
Epoch: 0|  Loss:  6.218 |Global loss: 6.2683| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.764
Epoch: 1|  Loss:  6.2172 |Global loss: 6.2698| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7622
Epoch: 2|  Loss:  6.2171 |Global loss: 6.2727| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7621
Epoch: 3|  Loss:  6.2138 |Global loss: 6.2685| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.767
Epoch: 0|  Loss:  6.2366 |Global loss: 6.2753| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7667
Epoch: 1|  Loss:  6.2336 |Global loss: 6.271| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7653
Epoch: 2|  Loss:  6.2338 |Global loss: 6.2731| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 3|  NKD Loss: 3.7647
Epoch: 3|  Loss:  6.2312 |Global loss: 6.2701| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 0|  NKD Loss: 3.7626
Epoch: 0|  Loss:  6.1132 |Global loss: 6.267| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.7617
Epoch: 1|  Loss:  6.11 |Global loss: 6.2689| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.7619
Epoch: 2|  Loss:  6.1036 |Global loss: 6.2668| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.7599
Epoch: 3|  Loss:  6.1049 |Global loss: 6.2741| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7666
Epoch: 0|  Loss:  6.2237 |Global loss: 6.2718| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7656
Epoch: 1|  Loss:  6.222 |Global loss: 6.2709| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7646
Epoch: 2|  Loss:  6.2196 |Global loss: 6.2694| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7639
Epoch: 3|  Loss:  6.2171 |Global loss: 6.2667| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7632
Epoch: 0|  Loss:  6.1223 |Global loss: 6.2717| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7626
Epoch: 1|  Loss:  6.1194 |Global loss: 6.2734| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.7619
Epoch: 2|  Loss:  6.1189 |Global loss: 6.2739| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7624
Epoch: 3|  Loss:  6.111 |Global loss: 6.2683| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7619
Epoch: 0|  Loss:  6.2085 |Global loss: 6.2708| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7616
Epoch: 1|  Loss:  6.2037 |Global loss: 6.2653| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7609
Epoch: 2|  Loss:  6.2002 |Global loss: 6.263| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.759
Epoch: 3|  Loss:  6.2001 |Global loss: 6.2652| Local H loss: 0.0031  | Global H loss: 0.0031
------------------------- time cost ------------------------- 3.013465404510498
Chosen Clients:  [0, 8, 11, 3, 9, 6]

-------------Round number: 48-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.075, 0.117, 0.142, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.058, 0.117, 0.117]
AUC in each clients:  [61.985, 64.561, 78.9, 82.627, 65.291, 64.186, 64.839, 65.884, 75.195, 65.252, 76.833, 67.114, 64.42, 71.015, 66.677]
F1 Score:  [0.047, 0.036, 0.073, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.009, 0.015, 0.037, 0.043]
Recall Score:  [0.115, 0.167, 0.198, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.094, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1743
Averaged Test Accurancy: 0.1067
Averaged Test AUC: 0.5749
Averaged Test F1_score: 0.0401
Averaged Test Recal score: 0.1551
Std Test Accurancy: 0.0332
Std Test AUC: 0.0511
Std Test F1: 0.0002
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7629
Epoch: 0|  Loss:  6.2315 |Global loss: 6.2728| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7617
Epoch: 1|  Loss:  6.2297 |Global loss: 6.2718| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 2|  NKD Loss: 3.7608
Epoch: 2|  Loss:  6.2282 |Global loss: 6.271| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7609
Epoch: 3|  Loss:  6.2242 |Global loss: 6.2653| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7615
Epoch: 0|  Loss:  6.1102 |Global loss: 6.2744| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.7612
Epoch: 1|  Loss:  6.1027 |Global loss: 6.2711| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7612
Epoch: 2|  Loss:  6.1003 |Global loss: 6.2714| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7596
Epoch: 3|  Loss:  6.0983 |Global loss: 6.2747| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.7583
Epoch: 0|  Loss:  6.196 |Global loss: 6.2626| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7571
Epoch: 1|  Loss:  6.1962 |Global loss: 6.2646| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7557
Epoch: 2|  Loss:  6.1943 |Global loss: 6.2658| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7543
Epoch: 3|  Loss:  6.1917 |Global loss: 6.2663| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7646
Epoch: 0|  Loss:  6.0529 |Global loss: 6.2718| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 1|  NKD Loss: 3.7635
Epoch: 1|  Loss:  6.05 |Global loss: 6.2743| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 2|  NKD Loss: 3.763
Epoch: 2|  Loss:  6.0465 |Global loss: 6.2748| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 3|  NKD Loss: 3.7627
Epoch: 3|  Loss:  6.0423 |Global loss: 6.277| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 0|  NKD Loss: 3.7628
Epoch: 0|  Loss:  6.2116 |Global loss: 6.2707| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7613
Epoch: 1|  Loss:  6.2106 |Global loss: 6.2723| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7608
Epoch: 2|  Loss:  6.2073 |Global loss: 6.2697| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7597
Epoch: 3|  Loss:  6.2044 |Global loss: 6.2682| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7614
Epoch: 0|  Loss:  6.2018 |Global loss: 6.2656| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7596
Epoch: 1|  Loss:  6.2035 |Global loss: 6.2714| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7589
Epoch: 2|  Loss:  6.1992 |Global loss: 6.2684| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7579
Epoch: 3|  Loss:  6.1977 |Global loss: 6.2675| Local H loss: 0.0029  | Global H loss: 0.0029
------------------------- time cost ------------------------- 3.1620030403137207
Chosen Clients:  [6, 11, 12, 9, 4, 8]

-------------Round number: 49-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.1, 0.117, 0.142, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.05, 0.058, 0.117, 0.117]
AUC in each clients:  [61.447, 64.561, 78.9, 83.81, 65.291, 64.186, 64.961, 65.884, 76.13, 65.577, 76.833, 67.433, 64.42, 71.015, 66.677]
F1 Score:  [0.064, 0.036, 0.073, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.009, 0.015, 0.037, 0.043]
Recall Score:  [0.146, 0.167, 0.198, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.083, 0.094, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1693
Averaged Test Accurancy: 0.1083
Averaged Test AUC: 0.5762
Averaged Test F1_score: 0.0413
Averaged Test Recal score: 0.1571
Std Test Accurancy: 0.0322
Std Test AUC: 0.0533
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7567
Epoch: 0|  Loss:  6.1949 |Global loss: 6.2671| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7556
Epoch: 1|  Loss:  6.1913 |Global loss: 6.2658| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7546
Epoch: 2|  Loss:  6.1894 |Global loss: 6.2665| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7538
Epoch: 3|  Loss:  6.1874 |Global loss: 6.2653| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.754
Epoch: 0|  Loss:  6.1896 |Global loss: 6.2645| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7534
Epoch: 1|  Loss:  6.184 |Global loss: 6.2598| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 2|  NKD Loss: 3.7512
Epoch: 2|  Loss:  6.1845 |Global loss: 6.2639| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.7502
Epoch: 3|  Loss:  6.1814 |Global loss: 6.2631| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7589
Epoch: 0|  Loss:  6.1988 |Global loss: 6.2688| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.758
Epoch: 1|  Loss:  6.1953 |Global loss: 6.2658| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7563
Epoch: 2|  Loss:  6.195 |Global loss: 6.2691| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7559
Epoch: 3|  Loss:  6.1894 |Global loss: 6.2635| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7579
Epoch: 0|  Loss:  6.204 |Global loss: 6.2706| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7572
Epoch: 1|  Loss:  6.2004 |Global loss: 6.2678| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7554
Epoch: 2|  Loss:  6.2 |Global loss: 6.271| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.755
Epoch: 3|  Loss:  6.1981 |Global loss: 6.2688| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7601
Epoch: 0|  Loss:  6.2151 |Global loss: 6.27| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7592
Epoch: 1|  Loss:  6.2134 |Global loss: 6.2687| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7575
Epoch: 2|  Loss:  6.2118 |Global loss: 6.2689| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7563
Epoch: 3|  Loss:  6.2106 |Global loss: 6.2693| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7609
Epoch: 0|  Loss:  6.0911 |Global loss: 6.2696| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.7589
Epoch: 1|  Loss:  6.096 |Global loss: 6.278| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7598
Epoch: 2|  Loss:  6.0837 |Global loss: 6.2694| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.7587
Epoch: 3|  Loss:  6.0804 |Global loss: 6.2718| Local H loss: 0.0038  | Global H loss: 0.0038
------------------------- time cost ------------------------- 2.8654937744140625
Chosen Clients:  [8, 13, 5, 10, 0, 11]

-------------Round number: 50-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.1, 0.117, 0.142, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.447, 64.561, 78.9, 83.81, 65.577, 64.186, 65.73, 65.884, 77.109, 65.792, 76.833, 68.333, 65.433, 71.015, 66.677]
F1 Score:  [0.064, 0.036, 0.073, 0.097, 0.008, 0.048, 0.036, 0.036, 0.036, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.146, 0.167, 0.198, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1635
Averaged Test Accurancy: 0.1167
Averaged Test AUC: 0.5785
Averaged Test F1_score: 0.0469
Averaged Test Recal score: 0.1676
Std Test Accurancy: 0.0242
Std Test AUC: 0.0530
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7596
Epoch: 0|  Loss:  6.0742 |Global loss: 6.2684| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.7579
Epoch: 1|  Loss:  6.0736 |Global loss: 6.2745| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.758
Epoch: 2|  Loss:  6.069 |Global loss: 6.2706| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.7572
Epoch: 3|  Loss:  6.0674 |Global loss: 6.2717| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7527
Epoch: 0|  Loss:  6.1504 |Global loss: 6.268| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.7516
Epoch: 1|  Loss:  6.1475 |Global loss: 6.2688| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7513
Epoch: 2|  Loss:  6.1442 |Global loss: 6.2658| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.75
Epoch: 3|  Loss:  6.1391 |Global loss: 6.2659| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7602
Epoch: 0|  Loss:  6.2179 |Global loss: 6.2722| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 1|  NKD Loss: 3.7593
Epoch: 1|  Loss:  6.2168 |Global loss: 6.2711| Local H loss: 0.0026  | Global H loss: 0.0026
Epoch: 2|  NKD Loss: 3.7576
Epoch: 2|  Loss:  6.2151 |Global loss: 6.271| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 3|  NKD Loss: 3.7567
Epoch: 3|  Loss:  6.2133 |Global loss: 6.2696| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 0|  NKD Loss: 3.7585
Epoch: 0|  Loss:  6.099 |Global loss: 6.2705| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.7582
Epoch: 1|  Loss:  6.0949 |Global loss: 6.2711| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.757
Epoch: 2|  Loss:  6.0929 |Global loss: 6.271| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.7564
Epoch: 3|  Loss:  6.0866 |Global loss: 6.2707| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 0|  NKD Loss: 3.7563
Epoch: 0|  Loss:  6.2247 |Global loss: 6.2717| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7567
Epoch: 1|  Loss:  6.2183 |Global loss: 6.2624| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7541
Epoch: 2|  Loss:  6.2197 |Global loss: 6.2674| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7533
Epoch: 3|  Loss:  6.2171 |Global loss: 6.2654| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 0|  NKD Loss: 3.7495
Epoch: 0|  Loss:  6.1779 |Global loss: 6.2615| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7483
Epoch: 1|  Loss:  6.1759 |Global loss: 6.2615| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7474
Epoch: 2|  Loss:  6.172 |Global loss: 6.2594| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7461
Epoch: 3|  Loss:  6.1696 |Global loss: 6.2601| Local H loss: 0.0036  | Global H loss: 0.0036
------------------------- time cost ------------------------- 2.8866257667541504
Chosen Clients:  [14, 2, 0, 6, 8, 12]

-------------Round number: 51-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.142, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.245, 64.561, 78.9, 83.81, 65.577, 63.164, 65.73, 65.884, 78.147, 65.792, 77.736, 68.939, 65.433, 71.596, 66.677]
F1 Score:  [0.061, 0.036, 0.073, 0.097, 0.008, 0.048, 0.036, 0.036, 0.037, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.198, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1580
Averaged Test Accurancy: 0.1178
Averaged Test AUC: 0.5796
Averaged Test F1_score: 0.0468
Averaged Test Recal score: 0.1690
Std Test Accurancy: 0.0237
Std Test AUC: 0.0550
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7553
Epoch: 0|  Loss:  6.1855 |Global loss: 6.2697| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7536
Epoch: 1|  Loss:  6.1833 |Global loss: 6.2701| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.753
Epoch: 2|  Loss:  6.1779 |Global loss: 6.2648| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7511
Epoch: 3|  Loss:  6.1768 |Global loss: 6.268| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7537
Epoch: 0|  Loss:  6.0918 |Global loss: 6.2664| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7525
Epoch: 1|  Loss:  6.0855 |Global loss: 6.2701| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.7525
Epoch: 2|  Loss:  6.0814 |Global loss: 6.267| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.7514
Epoch: 3|  Loss:  6.078 |Global loss: 6.2672| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.7513
Epoch: 0|  Loss:  6.2164 |Global loss: 6.2664| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7512
Epoch: 1|  Loss:  6.2127 |Global loss: 6.2608| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 2|  NKD Loss: 3.7492
Epoch: 2|  Loss:  6.2128 |Global loss: 6.2648| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7484
Epoch: 3|  Loss:  6.2088 |Global loss: 6.2597| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 0|  NKD Loss: 3.7496
Epoch: 0|  Loss:  6.1837 |Global loss: 6.2665| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7496
Epoch: 1|  Loss:  6.1764 |Global loss: 6.2604| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7476
Epoch: 2|  Loss:  6.178 |Global loss: 6.2644| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7463
Epoch: 3|  Loss:  6.1728 |Global loss: 6.2638| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.757
Epoch: 0|  Loss:  6.0615 |Global loss: 6.2719| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7571
Epoch: 1|  Loss:  6.056 |Global loss: 6.2706| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 2|  NKD Loss: 3.7564
Epoch: 2|  Loss:  6.0506 |Global loss: 6.2692| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.7561
Epoch: 3|  Loss:  6.0462 |Global loss: 6.2679| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.7513
Epoch: 0|  Loss:  6.1877 |Global loss: 6.2681| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7508
Epoch: 1|  Loss:  6.1841 |Global loss: 6.2652| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7501
Epoch: 2|  Loss:  6.1781 |Global loss: 6.2603| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7484
Epoch: 3|  Loss:  6.1751 |Global loss: 6.2598| Local H loss: 0.0032  | Global H loss: 0.0032
------------------------- time cost ------------------------- 3.093824625015259
Chosen Clients:  [2, 10, 4, 3, 6, 13]

-------------Round number: 52-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.211, 64.561, 80.064, 83.81, 65.577, 63.164, 66.11, 65.884, 79.138, 65.792, 77.736, 68.939, 65.798, 71.596, 67.195]
F1 Score:  [0.056, 0.036, 0.042, 0.097, 0.008, 0.048, 0.036, 0.036, 0.038, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1506
Averaged Test Accurancy: 0.1161
Averaged Test AUC: 0.5814
Averaged Test F1_score: 0.0445
Averaged Test Recal score: 0.1669
Std Test Accurancy: 0.0229
Std Test AUC: 0.0564
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7519
Epoch: 0|  Loss:  6.0707 |Global loss: 6.2639| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.7508
Epoch: 1|  Loss:  6.0681 |Global loss: 6.2654| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.7499
Epoch: 2|  Loss:  6.0623 |Global loss: 6.2672| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 3|  NKD Loss: 3.7484
Epoch: 3|  Loss:  6.0618 |Global loss: 6.2718| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.7532
Epoch: 0|  Loss:  6.0834 |Global loss: 6.2729| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7523
Epoch: 1|  Loss:  6.0791 |Global loss: 6.273| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.7515
Epoch: 2|  Loss:  6.0746 |Global loss: 6.2732| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.7517
Epoch: 3|  Loss:  6.0655 |Global loss: 6.2636| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.7505
Epoch: 0|  Loss:  6.2042 |Global loss: 6.269| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7501
Epoch: 1|  Loss:  6.1971 |Global loss: 6.2589| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7473
Epoch: 2|  Loss:  6.1988 |Global loss: 6.2651| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.746
Epoch: 3|  Loss:  6.1963 |Global loss: 6.2638| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.7553
Epoch: 0|  Loss:  6.0219 |Global loss: 6.2702| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 1|  NKD Loss: 3.7542
Epoch: 1|  Loss:  6.0225 |Global loss: 6.2732| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 2|  NKD Loss: 3.7543
Epoch: 2|  Loss:  6.0103 |Global loss: 6.2686| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 3|  NKD Loss: 3.7525
Epoch: 3|  Loss:  6.0127 |Global loss: 6.274| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 0|  NKD Loss: 3.7448
Epoch: 0|  Loss:  6.1711 |Global loss: 6.2642| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7445
Epoch: 1|  Loss:  6.165 |Global loss: 6.2585| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7421
Epoch: 2|  Loss:  6.1675 |Global loss: 6.2647| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7419
Epoch: 3|  Loss:  6.1595 |Global loss: 6.2584| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7466
Epoch: 0|  Loss:  6.1304 |Global loss: 6.2618| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7452
Epoch: 1|  Loss:  6.1253 |Global loss: 6.261| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 2|  NKD Loss: 3.7438
Epoch: 2|  Loss:  6.1232 |Global loss: 6.2624| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.7418
Epoch: 3|  Loss:  6.123 |Global loss: 6.2668| Local H loss: 0.0041  | Global H loss: 0.0041
------------------------- time cost ------------------------- 2.7497708797454834
Chosen Clients:  [5, 0, 13, 10, 8, 9]

-------------Round number: 53-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.175, 0.175, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.133, 0.117]
AUC in each clients:  [61.211, 64.561, 81.547, 84.123, 65.447, 63.164, 66.944, 65.884, 79.138, 65.792, 78.624, 68.939, 65.798, 72.064, 67.195]
F1 Score:  [0.056, 0.036, 0.131, 0.097, 0.008, 0.048, 0.036, 0.036, 0.038, 0.042, 0.039, 0.061, 0.048, 0.076, 0.043]
Recall Score:  [0.167, 0.167, 0.25, 0.25, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.19, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1425
Averaged Test Accurancy: 0.1211
Averaged Test AUC: 0.5836
Averaged Test F1_score: 0.0530
Averaged Test Recal score: 0.1740
Std Test Accurancy: 0.0274
Std Test AUC: 0.0585
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7503
Epoch: 0|  Loss:  6.2052 |Global loss: 6.2672| Local H loss: 0.0027  | Global H loss: 0.0027
Epoch: 1|  NKD Loss: 3.7484
Epoch: 1|  Loss:  6.202 |Global loss: 6.2646| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7469
Epoch: 2|  Loss:  6.1999 |Global loss: 6.2634| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 3|  NKD Loss: 3.7452
Epoch: 3|  Loss:  6.1982 |Global loss: 6.2627| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7431
Epoch: 0|  Loss:  6.208 |Global loss: 6.2644| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7423
Epoch: 1|  Loss:  6.204 |Global loss: 6.2605| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.741
Epoch: 2|  Loss:  6.2018 |Global loss: 6.2589| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7388
Epoch: 3|  Loss:  6.201 |Global loss: 6.2602| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.7414
Epoch: 0|  Loss:  6.118 |Global loss: 6.2632| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.7398
Epoch: 1|  Loss:  6.1136 |Global loss: 6.2639| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.7389
Epoch: 2|  Loss:  6.1059 |Global loss: 6.2594| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 3|  NKD Loss: 3.7381
Epoch: 3|  Loss:  6.1012 |Global loss: 6.2568| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.7514
Epoch: 0|  Loss:  6.0653 |Global loss: 6.267| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.75
Epoch: 1|  Loss:  6.0637 |Global loss: 6.2699| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.7484
Epoch: 2|  Loss:  6.0634 |Global loss: 6.2746| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.7477
Epoch: 3|  Loss:  6.0581 |Global loss: 6.2717| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.752
Epoch: 0|  Loss:  6.0403 |Global loss: 6.2713| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.7512
Epoch: 1|  Loss:  6.037 |Global loss: 6.2697| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.7499
Epoch: 2|  Loss:  6.0338 |Global loss: 6.2718| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.7499
Epoch: 3|  Loss:  6.0277 |Global loss: 6.27| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.7477
Epoch: 0|  Loss:  6.183 |Global loss: 6.2589| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7441
Epoch: 1|  Loss:  6.184 |Global loss: 6.2667| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7432
Epoch: 2|  Loss:  6.1809 |Global loss: 6.2642| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7421
Epoch: 3|  Loss:  6.1775 |Global loss: 6.2616| Local H loss: 0.0032  | Global H loss: 0.0032
------------------------- time cost ------------------------- 2.814647912979126
Chosen Clients:  [1, 3, 10, 0, 8, 14]

-------------Round number: 54-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.175, 0.175, 0.05, 0.117, 0.117, 0.117, 0.167, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.125, 64.561, 81.547, 84.123, 65.447, 63.242, 66.944, 65.884, 79.831, 65.664, 79.636, 68.939, 65.798, 72.738, 67.195]
F1 Score:  [0.051, 0.036, 0.131, 0.097, 0.008, 0.047, 0.036, 0.036, 0.124, 0.042, 0.039, 0.061, 0.048, 0.038, 0.043]
Recall Score:  [0.167, 0.167, 0.25, 0.25, 0.083, 0.167, 0.167, 0.167, 0.238, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1358
Averaged Test Accurancy: 0.1233
Averaged Test AUC: 0.5848
Averaged Test F1_score: 0.0558
Averaged Test Recal score: 0.1772
Std Test Accurancy: 0.0295
Std Test AUC: 0.0599
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7473
Epoch: 0|  Loss:  6.1992 |Global loss: 6.2697| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 1|  NKD Loss: 3.7444
Epoch: 1|  Loss:  6.2 |Global loss: 6.2744| Local H loss: 0.0028  | Global H loss: 0.0028
Epoch: 2|  NKD Loss: 3.7439
Epoch: 2|  Loss:  6.1929 |Global loss: 6.2644| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 3|  NKD Loss: 3.7419
Epoch: 3|  Loss:  6.1919 |Global loss: 6.2647| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 0|  NKD Loss: 3.7493
Epoch: 0|  Loss:  5.9987 |Global loss: 6.2676| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 1|  NKD Loss: 3.7477
Epoch: 1|  Loss:  5.9908 |Global loss: 6.2685| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 2|  NKD Loss: 3.7458
Epoch: 2|  Loss:  5.9893 |Global loss: 6.2732| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 3|  NKD Loss: 3.7451
Epoch: 3|  Loss:  5.9808 |Global loss: 6.2733| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 0|  NKD Loss: 3.7491
Epoch: 0|  Loss:  6.0516 |Global loss: 6.2669| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.7473
Epoch: 1|  Loss:  6.0492 |Global loss: 6.2662| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.7459
Epoch: 2|  Loss:  6.0469 |Global loss: 6.2695| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 3|  NKD Loss: 3.7447
Epoch: 3|  Loss:  6.0439 |Global loss: 6.2702| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.737
Epoch: 0|  Loss:  6.1996 |Global loss: 6.2619| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7364
Epoch: 1|  Loss:  6.1936 |Global loss: 6.2546| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7344
Epoch: 2|  Loss:  6.1934 |Global loss: 6.2571| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7326
Epoch: 3|  Loss:  6.1891 |Global loss: 6.2544| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.7493
Epoch: 0|  Loss:  6.0239 |Global loss: 6.2699| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.7477
Epoch: 1|  Loss:  6.0231 |Global loss: 6.2739| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.7474
Epoch: 2|  Loss:  6.0151 |Global loss: 6.2692| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.7462
Epoch: 3|  Loss:  6.014 |Global loss: 6.2707| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 0|  NKD Loss: 3.7443
Epoch: 0|  Loss:  6.1661 |Global loss: 6.2639| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7415
Epoch: 1|  Loss:  6.1658 |Global loss: 6.2687| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.74
Epoch: 2|  Loss:  6.1614 |Global loss: 6.266| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 3|  NKD Loss: 3.7389
Epoch: 3|  Loss:  6.1554 |Global loss: 6.2614| Local H loss: 0.0032  | Global H loss: 0.0032
------------------------- time cost ------------------------- 2.936638832092285
Chosen Clients:  [5, 11, 7, 1, 14, 6]

-------------Round number: 55-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.175, 0.175, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 63.64, 81.547, 84.946, 65.447, 63.242, 66.944, 65.884, 80.579, 65.664, 80.659, 68.939, 65.798, 72.738, 67.655]
F1 Score:  [0.049, 0.036, 0.131, 0.097, 0.008, 0.047, 0.036, 0.036, 0.131, 0.042, 0.039, 0.061, 0.048, 0.038, 0.043]
Recall Score:  [0.167, 0.167, 0.25, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1288
Averaged Test Accurancy: 0.1239
Averaged Test AUC: 0.5860
Averaged Test F1_score: 0.0561
Averaged Test Recal score: 0.1780
Std Test Accurancy: 0.0304
Std Test AUC: 0.0624
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7394
Epoch: 0|  Loss:  6.1924 |Global loss: 6.2619| Local H loss: 0.0029  | Global H loss: 0.0029
Epoch: 1|  NKD Loss: 3.7376
Epoch: 1|  Loss:  6.1899 |Global loss: 6.2603| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 2|  NKD Loss: 3.7346
Epoch: 2|  Loss:  6.1911 |Global loss: 6.2651| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 3|  NKD Loss: 3.7331
Epoch: 3|  Loss:  6.1867 |Global loss: 6.261| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 0|  NKD Loss: 3.7325
Epoch: 0|  Loss:  6.1529 |Global loss: 6.2546| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.7303
Epoch: 1|  Loss:  6.1481 |Global loss: 6.253| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7281
Epoch: 2|  Loss:  6.1444 |Global loss: 6.2521| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.7266
Epoch: 3|  Loss:  6.1377 |Global loss: 6.247| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 0|  NKD Loss: 3.7514
Epoch: 0|  Loss:  6.1942 |Global loss: 6.2734| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7483
Epoch: 1|  Loss:  6.1893 |Global loss: 6.2715| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.746
Epoch: 2|  Loss:  6.1834 |Global loss: 6.2658| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7423
Epoch: 3|  Loss:  6.1815 |Global loss: 6.2692| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7383
Epoch: 0|  Loss:  6.1889 |Global loss: 6.2657| Local H loss: 0.003  | Global H loss: 0.003
Epoch: 1|  NKD Loss: 3.7373
Epoch: 1|  Loss:  6.1846 |Global loss: 6.2606| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 2|  NKD Loss: 3.7342
Epoch: 2|  Loss:  6.184 |Global loss: 6.2637| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 3|  NKD Loss: 3.7329
Epoch: 3|  Loss:  6.1805 |Global loss: 6.2605| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 0|  NKD Loss: 3.7373
Epoch: 0|  Loss:  6.1463 |Global loss: 6.2535| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7351
Epoch: 1|  Loss:  6.1459 |Global loss: 6.2572| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 2|  NKD Loss: 3.7315
Epoch: 2|  Loss:  6.1459 |Global loss: 6.2632| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7311
Epoch: 3|  Loss:  6.1383 |Global loss: 6.2567| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.7331
Epoch: 0|  Loss:  6.1508 |Global loss: 6.2597| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 1|  NKD Loss: 3.7312
Epoch: 1|  Loss:  6.1509 |Global loss: 6.2631| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7301
Epoch: 2|  Loss:  6.1471 |Global loss: 6.26| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7286
Epoch: 3|  Loss:  6.1385 |Global loss: 6.2545| Local H loss: 0.0034  | Global H loss: 0.0034
------------------------- time cost ------------------------- 2.8466787338256836
Chosen Clients:  [9, 10, 7, 11, 8, 3]

-------------Round number: 56-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.175, 0.175, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 63.067, 81.547, 84.946, 65.447, 62.93, 67.509, 65.588, 80.579, 65.664, 80.659, 69.014, 65.798, 72.738, 67.992]
F1 Score:  [0.049, 0.036, 0.131, 0.097, 0.008, 0.048, 0.036, 0.036, 0.131, 0.042, 0.039, 0.061, 0.048, 0.038, 0.043]
Recall Score:  [0.167, 0.167, 0.25, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1205
Averaged Test Accurancy: 0.1239
Averaged Test AUC: 0.5859
Averaged Test F1_score: 0.0562
Averaged Test Recal score: 0.1780
Std Test Accurancy: 0.0304
Std Test AUC: 0.0628
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7347
Epoch: 0|  Loss:  6.1657 |Global loss: 6.2563| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7328
Epoch: 1|  Loss:  6.163 |Global loss: 6.2551| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7294
Epoch: 2|  Loss:  6.1623 |Global loss: 6.2599| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7281
Epoch: 3|  Loss:  6.1608 |Global loss: 6.2584| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7413
Epoch: 0|  Loss:  6.0371 |Global loss: 6.2722| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.7404
Epoch: 1|  Loss:  6.0336 |Global loss: 6.2685| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.7384
Epoch: 2|  Loss:  6.0307 |Global loss: 6.2705| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.7378
Epoch: 3|  Loss:  6.0247 |Global loss: 6.269| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 0|  NKD Loss: 3.7404
Epoch: 0|  Loss:  6.1725 |Global loss: 6.2588| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7358
Epoch: 1|  Loss:  6.1744 |Global loss: 6.2685| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.7346
Epoch: 2|  Loss:  6.1654 |Global loss: 6.2579| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.7316
Epoch: 3|  Loss:  6.1655 |Global loss: 6.262| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.7251
Epoch: 0|  Loss:  6.1367 |Global loss: 6.2492| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.7219
Epoch: 1|  Loss:  6.1365 |Global loss: 6.2539| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 2|  NKD Loss: 3.7203
Epoch: 2|  Loss:  6.1309 |Global loss: 6.25| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.7182
Epoch: 3|  Loss:  6.1261 |Global loss: 6.2487| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.7419
Epoch: 0|  Loss:  6.0107 |Global loss: 6.2771| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.7422
Epoch: 1|  Loss:  6.0001 |Global loss: 6.2701| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.7383
Epoch: 2|  Loss:  6.0048 |Global loss: 6.2818| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.7381
Epoch: 3|  Loss:  5.998 |Global loss: 6.2759| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 0|  NKD Loss: 3.7415
Epoch: 0|  Loss:  5.966 |Global loss: 6.2697| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 1|  NKD Loss: 3.7395
Epoch: 1|  Loss:  5.9637 |Global loss: 6.2735| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 2|  NKD Loss: 3.7398
Epoch: 2|  Loss:  5.9505 |Global loss: 6.2653| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 3|  NKD Loss: 3.7374
Epoch: 3|  Loss:  5.9486 |Global loss: 6.2694| Local H loss: 0.0058  | Global H loss: 0.0058
------------------------- time cost ------------------------- 2.9511356353759766
Chosen Clients:  [3, 6, 9, 14, 2, 10]

-------------Round number: 57-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.175, 0.175, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 63.067, 81.547, 85.138, 65.447, 62.93, 67.509, 65.866, 81.282, 66.117, 81.423, 69.312, 65.798, 72.738, 67.992]
F1 Score:  [0.049, 0.036, 0.131, 0.097, 0.008, 0.048, 0.036, 0.036, 0.131, 0.042, 0.039, 0.061, 0.048, 0.038, 0.043]
Recall Score:  [0.167, 0.167, 0.25, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1104
Averaged Test Accurancy: 0.1239
Averaged Test AUC: 0.5874
Averaged Test F1_score: 0.0562
Averaged Test Recal score: 0.1780
Std Test Accurancy: 0.0304
Std Test AUC: 0.0639
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7361
Epoch: 0|  Loss:  5.9471 |Global loss: 6.2763| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 1|  NKD Loss: 3.7355
Epoch: 1|  Loss:  5.9365 |Global loss: 6.269| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 2|  NKD Loss: 3.7338
Epoch: 2|  Loss:  5.9259 |Global loss: 6.2693| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 3|  NKD Loss: 3.7315
Epoch: 3|  Loss:  5.9214 |Global loss: 6.2691| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 0|  NKD Loss: 3.7229
Epoch: 0|  Loss:  6.1338 |Global loss: 6.256| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.7219
Epoch: 1|  Loss:  6.1264 |Global loss: 6.2499| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7196
Epoch: 2|  Loss:  6.1209 |Global loss: 6.2494| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.7164
Epoch: 3|  Loss:  6.121 |Global loss: 6.2544| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7242
Epoch: 0|  Loss:  6.156 |Global loss: 6.2599| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.7232
Epoch: 1|  Loss:  6.1493 |Global loss: 6.2528| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.7211
Epoch: 2|  Loss:  6.1491 |Global loss: 6.2552| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 3|  NKD Loss: 3.7182
Epoch: 3|  Loss:  6.1473 |Global loss: 6.2588| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.7254
Epoch: 0|  Loss:  6.1282 |Global loss: 6.2541| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.723
Epoch: 1|  Loss:  6.1254 |Global loss: 6.255| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.7219
Epoch: 2|  Loss:  6.1174 |Global loss: 6.2489| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.7188
Epoch: 3|  Loss:  6.1158 |Global loss: 6.2527| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7335
Epoch: 0|  Loss:  6.0404 |Global loss: 6.2636| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.7324
Epoch: 1|  Loss:  6.0336 |Global loss: 6.2597| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.7297
Epoch: 2|  Loss:  6.0316 |Global loss: 6.2672| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.7284
Epoch: 3|  Loss:  6.0258 |Global loss: 6.2661| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 0|  NKD Loss: 3.7376
Epoch: 0|  Loss:  6.022 |Global loss: 6.2678| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.7365
Epoch: 1|  Loss:  6.0149 |Global loss: 6.263| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.7347
Epoch: 2|  Loss:  6.012 |Global loss: 6.2609| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.7319
Epoch: 3|  Loss:  6.0145 |Global loss: 6.2682| Local H loss: 0.0043  | Global H loss: 0.0043
------------------------- time cost ------------------------- 3.0180883407592773
Chosen Clients:  [13, 5, 7, 10, 9, 2]

-------------Round number: 58-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 63.067, 81.689, 85.671, 65.447, 62.93, 67.969, 65.866, 81.282, 66.539, 82.082, 69.312, 65.798, 72.738, 68.271]
F1 Score:  [0.049, 0.036, 0.042, 0.097, 0.008, 0.048, 0.036, 0.036, 0.131, 0.042, 0.039, 0.061, 0.048, 0.038, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.1007
Averaged Test Accurancy: 0.1200
Averaged Test AUC: 0.5888
Averaged Test F1_score: 0.0503
Averaged Test Recal score: 0.1725
Std Test Accurancy: 0.0272
Std Test AUC: 0.0648
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7205
Epoch: 0|  Loss:  6.0788 |Global loss: 6.2503| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 1|  NKD Loss: 3.7163
Epoch: 1|  Loss:  6.0753 |Global loss: 6.2562| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.7138
Epoch: 2|  Loss:  6.0712 |Global loss: 6.2548| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 3|  NKD Loss: 3.7118
Epoch: 3|  Loss:  6.0625 |Global loss: 6.2495| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 0|  NKD Loss: 3.7231
Epoch: 0|  Loss:  6.1766 |Global loss: 6.259| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7202
Epoch: 1|  Loss:  6.1727 |Global loss: 6.2566| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7172
Epoch: 2|  Loss:  6.1702 |Global loss: 6.2556| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7147
Epoch: 3|  Loss:  6.1654 |Global loss: 6.2518| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 0|  NKD Loss: 3.7237
Epoch: 0|  Loss:  6.1541 |Global loss: 6.2583| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.7204
Epoch: 1|  Loss:  6.1498 |Global loss: 6.2574| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.7184
Epoch: 2|  Loss:  6.1417 |Global loss: 6.248| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.7131
Epoch: 3|  Loss:  6.1429 |Global loss: 6.2587| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.732
Epoch: 0|  Loss:  6.0094 |Global loss: 6.2686| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.7307
Epoch: 1|  Loss:  6.0026 |Global loss: 6.2638| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.7289
Epoch: 2|  Loss:  5.9991 |Global loss: 6.2666| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.7254
Epoch: 3|  Loss:  6.0031 |Global loss: 6.2716| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 0|  NKD Loss: 3.7154
Epoch: 0|  Loss:  6.1408 |Global loss: 6.2558| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.7148
Epoch: 1|  Loss:  6.1307 |Global loss: 6.2454| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7121
Epoch: 2|  Loss:  6.1307 |Global loss: 6.2502| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.71
Epoch: 3|  Loss:  6.1236 |Global loss: 6.2454| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 0|  NKD Loss: 3.7269
Epoch: 0|  Loss:  6.0222 |Global loss: 6.2675| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.7248
Epoch: 1|  Loss:  6.0201 |Global loss: 6.2675| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 2|  NKD Loss: 3.7253
Epoch: 2|  Loss:  6.004 |Global loss: 6.2546| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 3|  NKD Loss: 3.7222
Epoch: 3|  Loss:  6.0057 |Global loss: 6.2619| Local H loss: 0.0047  | Global H loss: 0.0047
------------------------- time cost ------------------------- 2.7888238430023193
Chosen Clients:  [3, 1, 6, 7, 11, 4]

-------------Round number: 59-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.175, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 63.067, 82.267, 85.671, 65.447, 62.028, 67.969, 66.335, 81.282, 67.486, 82.495, 69.312, 65.798, 73.103, 68.271]
F1 Score:  [0.049, 0.036, 0.042, 0.097, 0.008, 0.049, 0.036, 0.036, 0.131, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.25, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0907
Averaged Test Accurancy: 0.1200
Averaged Test AUC: 0.5898
Averaged Test F1_score: 0.0503
Averaged Test Recal score: 0.1725
Std Test Accurancy: 0.0272
Std Test AUC: 0.0658
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 3.7248
Epoch: 0|  Loss:  5.9051 |Global loss: 6.2643| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 3.7228
Epoch: 1|  Loss:  5.8936 |Global loss: 6.2611| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 3.7194
Epoch: 2|  Loss:  5.8907 |Global loss: 6.2661| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 3|  NKD Loss: 3.7174
Epoch: 3|  Loss:  5.8851 |Global loss: 6.265| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 0|  NKD Loss: 3.7176
Epoch: 0|  Loss:  6.1663 |Global loss: 6.2605| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7142
Epoch: 1|  Loss:  6.1638 |Global loss: 6.2596| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7108
Epoch: 2|  Loss:  6.1568 |Global loss: 6.2544| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.7077
Epoch: 3|  Loss:  6.1552 |Global loss: 6.254| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 0|  NKD Loss: 3.7085
Epoch: 0|  Loss:  6.1149 |Global loss: 6.2554| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.7077
Epoch: 1|  Loss:  6.1025 |Global loss: 6.2442| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.7052
Epoch: 2|  Loss:  6.0972 |Global loss: 6.2425| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.7021
Epoch: 3|  Loss:  6.0962 |Global loss: 6.2456| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 0|  NKD Loss: 3.7124
Epoch: 0|  Loss:  6.1314 |Global loss: 6.244| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.7078
Epoch: 1|  Loss:  6.1344 |Global loss: 6.2553| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.7066
Epoch: 2|  Loss:  6.1234 |Global loss: 6.2437| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.7036
Epoch: 3|  Loss:  6.1205 |Global loss: 6.2441| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 0|  NKD Loss: 3.7064
Epoch: 0|  Loss:  6.1087 |Global loss: 6.2416| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.7023
Epoch: 1|  Loss:  6.1046 |Global loss: 6.2431| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 2|  NKD Loss: 3.6995
Epoch: 2|  Loss:  6.1023 |Global loss: 6.242| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.6981
Epoch: 3|  Loss:  6.0893 |Global loss: 6.2311| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 0|  NKD Loss: 3.7233
Epoch: 0|  Loss:  6.1735 |Global loss: 6.2639| Local H loss: 0.0031  | Global H loss: 0.0031
Epoch: 1|  NKD Loss: 3.7211
Epoch: 1|  Loss:  6.1681 |Global loss: 6.2563| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 2|  NKD Loss: 3.7172
Epoch: 2|  Loss:  6.1646 |Global loss: 6.2538| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 3|  NKD Loss: 3.7145
Epoch: 3|  Loss:  6.1594 |Global loss: 6.2482| Local H loss: 0.0034  | Global H loss: 0.0034
------------------------- time cost ------------------------- 2.9994261264801025
Chosen Clients:  [8, 11, 7, 5, 0, 4]

-------------Round number: 60-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.117, 0.175, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [61.171, 62.153, 82.267, 86.273, 64.123, 62.028, 68.513, 66.523, 81.282, 67.486, 82.495, 69.317, 65.798, 73.103, 68.271]
F1 Score:  [0.049, 0.039, 0.042, 0.185, 0.008, 0.049, 0.036, 0.049, 0.131, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.167, 0.25, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0796
Averaged Test Accurancy: 0.1244
Averaged Test AUC: 0.5893
Averaged Test F1_score: 0.0572
Averaged Test Recal score: 0.1774
Std Test Accurancy: 0.0388
Std Test AUC: 0.0674
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.7213
Epoch: 0|  Loss:  5.9742 |Global loss: 6.266| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.7185
Epoch: 1|  Loss:  5.9672 |Global loss: 6.2687| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 2|  NKD Loss: 3.7178
Epoch: 2|  Loss:  5.9499 |Global loss: 6.2548| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 3|  NKD Loss: 3.7127
Epoch: 3|  Loss:  5.9559 |Global loss: 6.2642| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 0|  NKD Loss: 3.6944
Epoch: 0|  Loss:  6.088 |Global loss: 6.2351| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 1|  NKD Loss: 3.6915
Epoch: 1|  Loss:  6.0798 |Global loss: 6.2327| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 2|  NKD Loss: 3.6862
Epoch: 2|  Loss:  6.0859 |Global loss: 6.2457| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 3|  NKD Loss: 3.6844
Epoch: 3|  Loss:  6.0711 |Global loss: 6.2348| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 0|  NKD Loss: 3.7022
Epoch: 0|  Loss:  6.1137 |Global loss: 6.2403| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.6969
Epoch: 1|  Loss:  6.1153 |Global loss: 6.2498| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 2|  NKD Loss: 3.695
Epoch: 2|  Loss:  6.1059 |Global loss: 6.2423| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.6932
Epoch: 3|  Loss:  6.099 |Global loss: 6.2373| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 0|  NKD Loss: 3.7067
Epoch: 0|  Loss:  6.1548 |Global loss: 6.2446| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 1|  NKD Loss: 3.702
Epoch: 1|  Loss:  6.1554 |Global loss: 6.2511| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.6995
Epoch: 2|  Loss:  6.1481 |Global loss: 6.2434| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 3|  NKD Loss: 3.6967
Epoch: 3|  Loss:  6.1427 |Global loss: 6.2376| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 0|  NKD Loss: 3.7081
Epoch: 0|  Loss:  6.1653 |Global loss: 6.2512| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.7048
Epoch: 1|  Loss:  6.1608 |Global loss: 6.2471| Local H loss: 0.0033  | Global H loss: 0.0033
Epoch: 2|  NKD Loss: 3.7013
Epoch: 2|  Loss:  6.1601 |Global loss: 6.248| Local H loss: 0.0034  | Global H loss: 0.0034
Epoch: 3|  NKD Loss: 3.699
Epoch: 3|  Loss:  6.1531 |Global loss: 6.2388| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 0|  NKD Loss: 3.707
Epoch: 0|  Loss:  6.1602 |Global loss: 6.2578| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.7037
Epoch: 1|  Loss:  6.1536 |Global loss: 6.2506| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 2|  NKD Loss: 3.6994
Epoch: 2|  Loss:  6.1527 |Global loss: 6.2548| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.6966
Epoch: 3|  Loss:  6.1436 |Global loss: 6.2442| Local H loss: 0.0038  | Global H loss: 0.0038
------------------------- time cost ------------------------- 3.00925612449646
Chosen Clients:  [11, 2, 9, 14, 10, 4]

-------------Round number: 61-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.167, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [60.634, 62.153, 82.267, 86.273, 63.464, 61.986, 68.513, 67.644, 80.957, 67.486, 82.495, 70.377, 65.798, 73.103, 68.271]
F1 Score:  [0.061, 0.039, 0.042, 0.185, 0.008, 0.049, 0.036, 0.009, 0.124, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.238, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0693
Averaged Test Accurancy: 0.1194
Averaged Test AUC: 0.5897
Averaged Test F1_score: 0.0549
Averaged Test Recal score: 0.1710
Std Test Accurancy: 0.0423
Std Test AUC: 0.0675
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.6843
Epoch: 0|  Loss:  6.061 |Global loss: 6.2264| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 1|  NKD Loss: 3.6791
Epoch: 1|  Loss:  6.059 |Global loss: 6.2326| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.6769
Epoch: 2|  Loss:  6.0504 |Global loss: 6.2251| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 3|  NKD Loss: 3.6725
Epoch: 3|  Loss:  6.042 |Global loss: 6.2274| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 0|  NKD Loss: 3.706
Epoch: 0|  Loss:  5.988 |Global loss: 6.2601| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 1|  NKD Loss: 3.7047
Epoch: 1|  Loss:  5.9776 |Global loss: 6.25| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.7002
Epoch: 2|  Loss:  5.9786 |Global loss: 6.2629| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 3|  NKD Loss: 3.6989
Epoch: 3|  Loss:  5.9688 |Global loss: 6.2517| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 0|  NKD Loss: 3.6932
Epoch: 0|  Loss:  6.1152 |Global loss: 6.2529| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.6933
Epoch: 1|  Loss:  6.1025 |Global loss: 6.238| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.686
Epoch: 2|  Loss:  6.1039 |Global loss: 6.2494| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.6847
Epoch: 3|  Loss:  6.0957 |Global loss: 6.2409| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.6993
Epoch: 0|  Loss:  6.0928 |Global loss: 6.2464| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.6946
Epoch: 1|  Loss:  6.088 |Global loss: 6.2476| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 2|  NKD Loss: 3.6927
Epoch: 2|  Loss:  6.0815 |Global loss: 6.2405| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.6875
Epoch: 3|  Loss:  6.0768 |Global loss: 6.2436| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 0|  NKD Loss: 3.7117
Epoch: 0|  Loss:  5.9827 |Global loss: 6.2643| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.7091
Epoch: 1|  Loss:  5.9774 |Global loss: 6.2664| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 2|  NKD Loss: 3.7074
Epoch: 2|  Loss:  5.971 |Global loss: 6.2607| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 3|  NKD Loss: 3.7045
Epoch: 3|  Loss:  5.9645 |Global loss: 6.2568| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 0|  NKD Loss: 3.6917
Epoch: 0|  Loss:  6.1441 |Global loss: 6.2483| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.6882
Epoch: 1|  Loss:  6.1369 |Global loss: 6.2435| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.6846
Epoch: 2|  Loss:  6.1315 |Global loss: 6.2385| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 3|  NKD Loss: 3.6811
Epoch: 3|  Loss:  6.1256 |Global loss: 6.2324| Local H loss: 0.0041  | Global H loss: 0.0041
------------------------- time cost ------------------------- 3.048833131790161
Chosen Clients:  [6, 10, 14, 3, 9, 8]

-------------Round number: 62-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.167, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [60.634, 62.153, 82.002, 86.273, 63.694, 61.986, 68.513, 67.644, 80.957, 67.736, 82.273, 71.399, 65.798, 73.103, 68.351]
F1 Score:  [0.061, 0.039, 0.042, 0.185, 0.008, 0.049, 0.036, 0.009, 0.124, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.238, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0546
Averaged Test Accurancy: 0.1194
Averaged Test AUC: 0.5903
Averaged Test F1_score: 0.0549
Averaged Test Recal score: 0.1710
Std Test Accurancy: 0.0423
Std Test AUC: 0.0669
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.684
Epoch: 0|  Loss:  6.0801 |Global loss: 6.2465| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 1|  NKD Loss: 3.6811
Epoch: 1|  Loss:  6.0713 |Global loss: 6.2394| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.6764
Epoch: 2|  Loss:  6.0683 |Global loss: 6.2407| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.6736
Epoch: 3|  Loss:  6.0588 |Global loss: 6.232| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.7031
Epoch: 0|  Loss:  5.9609 |Global loss: 6.2571| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 1|  NKD Loss: 3.6991
Epoch: 1|  Loss:  5.9565 |Global loss: 6.2544| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 2|  NKD Loss: 3.6949
Epoch: 2|  Loss:  5.9538 |Global loss: 6.2595| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 3|  NKD Loss: 3.6926
Epoch: 3|  Loss:  5.9452 |Global loss: 6.2544| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 0|  NKD Loss: 3.6821
Epoch: 0|  Loss:  6.071 |Global loss: 6.2421| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.6804
Epoch: 1|  Loss:  6.0606 |Global loss: 6.2322| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 2|  NKD Loss: 3.6754
Epoch: 2|  Loss:  6.0538 |Global loss: 6.2316| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 3|  NKD Loss: 3.6702
Epoch: 3|  Loss:  6.0492 |Global loss: 6.2323| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 0|  NKD Loss: 3.6994
Epoch: 0|  Loss:  5.8639 |Global loss: 6.2607| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 1|  NKD Loss: 3.6954
Epoch: 1|  Loss:  5.8535 |Global loss: 6.2628| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 3.6918
Epoch: 2|  Loss:  5.8396 |Global loss: 6.2581| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 3|  NKD Loss: 3.6888
Epoch: 3|  Loss:  5.8277 |Global loss: 6.2531| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 3.6813
Epoch: 0|  Loss:  6.0912 |Global loss: 6.24| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 1|  NKD Loss: 3.6776
Epoch: 1|  Loss:  6.0811 |Global loss: 6.2323| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 2|  NKD Loss: 3.6728
Epoch: 2|  Loss:  6.0804 |Global loss: 6.2382| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.6696
Epoch: 3|  Loss:  6.0724 |Global loss: 6.234| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.7026
Epoch: 0|  Loss:  5.9377 |Global loss: 6.257| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 1|  NKD Loss: 3.6985
Epoch: 1|  Loss:  5.9344 |Global loss: 6.2625| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.6951
Epoch: 2|  Loss:  5.9257 |Global loss: 6.2558| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 3|  NKD Loss: 3.6914
Epoch: 3|  Loss:  5.9248 |Global loss: 6.2575| Local H loss: 0.005  | Global H loss: 0.005
------------------------- time cost ------------------------- 3.0324244499206543
Chosen Clients:  [2, 14, 10, 0, 11, 13]

-------------Round number: 63-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.117, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.167, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [60.634, 62.153, 82.002, 86.752, 63.694, 61.986, 69.239, 67.644, 81.22, 68.674, 82.729, 71.399, 65.798, 73.103, 68.574]
F1 Score:  [0.061, 0.039, 0.042, 0.185, 0.008, 0.049, 0.039, 0.009, 0.125, 0.042, 0.039, 0.061, 0.048, 0.037, 0.043]
Recall Score:  [0.167, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.238, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0410
Averaged Test Accurancy: 0.1194
Averaged Test AUC: 0.5920
Averaged Test F1_score: 0.0551
Averaged Test Recal score: 0.1710
Std Test Accurancy: 0.0423
Std Test AUC: 0.0677
Std Test F1: 0.0004
Std Test Recall: 0.0004
Epoch: 0|  NKD Loss: 3.6846
Epoch: 0|  Loss:  5.9547 |Global loss: 6.2492| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 1|  NKD Loss: 3.6799
Epoch: 1|  Loss:  5.9498 |Global loss: 6.2518| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 2|  NKD Loss: 3.6767
Epoch: 2|  Loss:  5.94 |Global loss: 6.2445| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 3|  NKD Loss: 3.6707
Epoch: 3|  Loss:  5.9372 |Global loss: 6.2485| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 0|  NKD Loss: 3.6652
Epoch: 0|  Loss:  6.0424 |Global loss: 6.2323| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 1|  NKD Loss: 3.6631
Epoch: 1|  Loss:  6.0311 |Global loss: 6.2237| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 2|  NKD Loss: 3.6569
Epoch: 2|  Loss:  6.0312 |Global loss: 6.2302| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 3|  NKD Loss: 3.6526
Epoch: 3|  Loss:  6.0232 |Global loss: 6.2262| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 0|  NKD Loss: 3.6906
Epoch: 0|  Loss:  5.9401 |Global loss: 6.2531| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 1|  NKD Loss: 3.6862
Epoch: 1|  Loss:  5.9407 |Global loss: 6.2616| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 2|  NKD Loss: 3.6827
Epoch: 2|  Loss:  5.9307 |Global loss: 6.2499| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 3|  NKD Loss: 3.6781
Epoch: 3|  Loss:  5.9238 |Global loss: 6.2448| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 0|  NKD Loss: 3.6764
Epoch: 0|  Loss:  6.137 |Global loss: 6.2418| Local H loss: 0.0036  | Global H loss: 0.0036
Epoch: 1|  NKD Loss: 3.6716
Epoch: 1|  Loss:  6.13 |Global loss: 6.2336| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 2|  NKD Loss: 3.6645
Epoch: 2|  Loss:  6.1264 |Global loss: 6.2328| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 3|  NKD Loss: 3.6596
Epoch: 3|  Loss:  6.1202 |Global loss: 6.2263| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 0|  NKD Loss: 3.6598
Epoch: 0|  Loss:  6.0254 |Global loss: 6.2216| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 1|  NKD Loss: 3.6536
Epoch: 1|  Loss:  6.0205 |Global loss: 6.225| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 2|  NKD Loss: 3.6503
Epoch: 2|  Loss:  6.0079 |Global loss: 6.2167| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 3|  NKD Loss: 3.645
Epoch: 3|  Loss:  5.9996 |Global loss: 6.2136| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 0|  NKD Loss: 3.6797
Epoch: 0|  Loss:  6.031 |Global loss: 6.2455| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 1|  NKD Loss: 3.6729
Epoch: 1|  Loss:  6.0223 |Global loss: 6.2407| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.6678
Epoch: 2|  Loss:  6.0116 |Global loss: 6.2348| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 3|  NKD Loss: 3.6612
Epoch: 3|  Loss:  6.0047 |Global loss: 6.2337| Local H loss: 0.0051  | Global H loss: 0.0051
------------------------- time cost ------------------------- 2.765939712524414
Chosen Clients:  [3, 14, 8, 0, 5, 11]

-------------Round number: 64-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.167, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [60.371, 62.153, 82.055, 86.752, 63.694, 61.986, 69.239, 67.644, 81.22, 68.674, 82.966, 72.218, 65.798, 72.278, 68.995]
F1 Score:  [0.008, 0.039, 0.042, 0.185, 0.008, 0.049, 0.039, 0.009, 0.125, 0.042, 0.039, 0.061, 0.048, 0.039, 0.043]
Recall Score:  [0.083, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.238, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0219
Averaged Test Accurancy: 0.1150
Averaged Test AUC: 0.5922
Averaged Test F1_score: 0.0517
Averaged Test Recal score: 0.1654
Std Test Accurancy: 0.0458
Std Test AUC: 0.0680
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.672
Epoch: 0|  Loss:  5.8029 |Global loss: 6.2432| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 3.6651
Epoch: 1|  Loss:  5.7929 |Global loss: 6.2489| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 3.6616
Epoch: 2|  Loss:  5.7861 |Global loss: 6.2426| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 3.6527
Epoch: 3|  Loss:  5.7794 |Global loss: 6.2531| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 3.6478
Epoch: 0|  Loss:  6.0145 |Global loss: 6.2258| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 1|  NKD Loss: 3.6438
Epoch: 1|  Loss:  6.003 |Global loss: 6.2189| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 2|  NKD Loss: 3.6388
Epoch: 2|  Loss:  5.9952 |Global loss: 6.2172| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 3|  NKD Loss: 3.6328
Epoch: 3|  Loss:  5.9879 |Global loss: 6.2165| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 0|  NKD Loss: 3.6746
Epoch: 0|  Loss:  5.9034 |Global loss: 6.2506| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 1|  NKD Loss: 3.6692
Epoch: 1|  Loss:  5.8952 |Global loss: 6.2481| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 2|  NKD Loss: 3.665
Epoch: 2|  Loss:  5.8845 |Global loss: 6.2436| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 3|  NKD Loss: 3.6583
Epoch: 3|  Loss:  5.8848 |Global loss: 6.2489| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 0|  NKD Loss: 3.6508
Epoch: 0|  Loss:  6.12 |Global loss: 6.2318| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 1|  NKD Loss: 3.6461
Epoch: 1|  Loss:  6.1071 |Global loss: 6.2167| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 2|  NKD Loss: 3.6372
Epoch: 2|  Loss:  6.1089 |Global loss: 6.2246| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 3|  NKD Loss: 3.6328
Epoch: 3|  Loss:  6.0967 |Global loss: 6.212| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 0|  NKD Loss: 3.6653
Epoch: 0|  Loss:  6.1161 |Global loss: 6.2366| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 1|  NKD Loss: 3.6569
Epoch: 1|  Loss:  6.1097 |Global loss: 6.2342| Local H loss: 0.0038  | Global H loss: 0.0038
Epoch: 2|  NKD Loss: 3.6499
Epoch: 2|  Loss:  6.1093 |Global loss: 6.2359| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 3|  NKD Loss: 3.6441
Epoch: 3|  Loss:  6.0987 |Global loss: 6.2236| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.6409
Epoch: 0|  Loss:  5.9934 |Global loss: 6.2155| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 1|  NKD Loss: 3.6363
Epoch: 1|  Loss:  5.9848 |Global loss: 6.213| Local H loss: 0.0056  | Global H loss: 0.0056
Epoch: 2|  NKD Loss: 3.6283
Epoch: 2|  Loss:  5.9783 |Global loss: 6.2152| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 3|  NKD Loss: 3.6232
Epoch: 3|  Loss:  5.9641 |Global loss: 6.2093| Local H loss: 0.0058  | Global H loss: 0.0058
------------------------- time cost ------------------------- 3.151852607727051
Chosen Clients:  [2, 14, 9, 13, 7, 6]

-------------Round number: 65-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117, 0.117]
AUC in each clients:  [60.658, 62.153, 82.055, 87.268, 63.694, 61.784, 69.239, 67.644, 81.024, 68.674, 82.966, 73.658, 65.798, 72.278, 69.677]
F1 Score:  [0.008, 0.039, 0.042, 0.214, 0.008, 0.061, 0.039, 0.009, 0.048, 0.042, 0.039, 0.061, 0.048, 0.039, 0.043]
Recall Score:  [0.083, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 6.0014
Averaged Test Accurancy: 0.1117
Averaged Test AUC: 0.5937
Averaged Test F1_score: 0.0493
Averaged Test Recal score: 0.1607
Std Test Accurancy: 0.0437
Std Test AUC: 0.0684
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.6512
Epoch: 0|  Loss:  5.9101 |Global loss: 6.236| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 1|  NKD Loss: 3.6437
Epoch: 1|  Loss:  5.9108 |Global loss: 6.2404| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 2|  NKD Loss: 3.6364
Epoch: 2|  Loss:  5.8978 |Global loss: 6.2336| Local H loss: 0.0056  | Global H loss: 0.0056
Epoch: 3|  NKD Loss: 3.6287
Epoch: 3|  Loss:  5.8902 |Global loss: 6.2301| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 0|  NKD Loss: 3.6275
Epoch: 0|  Loss:  5.9862 |Global loss: 6.2219| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 1|  NKD Loss: 3.6211
Epoch: 1|  Loss:  5.9749 |Global loss: 6.2194| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 2|  NKD Loss: 3.6168
Epoch: 2|  Loss:  5.9566 |Global loss: 6.2058| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 3|  NKD Loss: 3.6093
Epoch: 3|  Loss:  5.9475 |Global loss: 6.2003| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 0|  NKD Loss: 3.64
Epoch: 0|  Loss:  6.0393 |Global loss: 6.2244| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.6335
Epoch: 1|  Loss:  6.0321 |Global loss: 6.2184| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 2|  NKD Loss: 3.6253
Epoch: 2|  Loss:  6.0256 |Global loss: 6.2158| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.6173
Epoch: 3|  Loss:  6.0142 |Global loss: 6.2095| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 0|  NKD Loss: 3.6402
Epoch: 0|  Loss:  5.9812 |Global loss: 6.2238| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 1|  NKD Loss: 3.6334
Epoch: 1|  Loss:  5.9662 |Global loss: 6.2143| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 2|  NKD Loss: 3.6221
Epoch: 2|  Loss:  5.9654 |Global loss: 6.223| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 3|  NKD Loss: 3.6158
Epoch: 3|  Loss:  5.9475 |Global loss: 6.2077| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 0|  NKD Loss: 3.6462
Epoch: 0|  Loss:  6.0518 |Global loss: 6.2254| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.6363
Epoch: 1|  Loss:  6.0471 |Global loss: 6.2273| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 2|  NKD Loss: 3.6279
Epoch: 2|  Loss:  6.0406 |Global loss: 6.2245| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 3|  NKD Loss: 3.6185
Epoch: 3|  Loss:  6.027 |Global loss: 6.2142| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 0|  NKD Loss: 3.6422
Epoch: 0|  Loss:  6.0269 |Global loss: 6.2281| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.6317
Epoch: 1|  Loss:  6.0237 |Global loss: 6.2346| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 2|  NKD Loss: 3.6265
Epoch: 2|  Loss:  6.0156 |Global loss: 6.2251| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 3|  NKD Loss: 3.6188
Epoch: 3|  Loss:  6.0041 |Global loss: 6.2191| Local H loss: 0.0044  | Global H loss: 0.0044
------------------------- time cost ------------------------- 2.9408628940582275
Chosen Clients:  [2, 12, 8, 13, 3, 10]

-------------Round number: 66-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.117, 0.242, 0.05, 0.117, 0.117, 0.05, 0.117, 0.05, 0.117, 0.117, 0.117, 0.108, 0.117]
AUC in each clients:  [60.658, 62.153, 81.798, 87.268, 63.694, 61.784, 69.063, 68.57, 81.024, 68.648, 82.966, 73.658, 65.798, 72.441, 70.905]
F1 Score:  [0.008, 0.039, 0.053, 0.214, 0.008, 0.061, 0.049, 0.008, 0.048, 0.01, 0.039, 0.061, 0.048, 0.081, 0.043]
Recall Score:  [0.083, 0.167, 0.167, 0.324, 0.083, 0.167, 0.167, 0.083, 0.167, 0.083, 0.167, 0.167, 0.167, 0.156, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9782
Averaged Test Accurancy: 0.1067
Averaged Test AUC: 0.5947
Averaged Test F1_score: 0.0513
Averaged Test Recal score: 0.1543
Std Test Accurancy: 0.0462
Std Test AUC: 0.0680
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.6242
Epoch: 0|  Loss:  5.8802 |Global loss: 6.2242| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 1|  NKD Loss: 3.6168
Epoch: 1|  Loss:  5.8658 |Global loss: 6.2176| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 2|  NKD Loss: 3.6065
Epoch: 2|  Loss:  5.8611 |Global loss: 6.2206| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 3|  NKD Loss: 3.5966
Epoch: 3|  Loss:  5.8479 |Global loss: 6.2124| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 0|  NKD Loss: 3.6751
Epoch: 0|  Loss:  6.1025 |Global loss: 6.2688| Local H loss: 0.0032  | Global H loss: 0.0032
Epoch: 1|  NKD Loss: 3.6595
Epoch: 1|  Loss:  6.0877 |Global loss: 6.2569| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 2|  NKD Loss: 3.6434
Epoch: 2|  Loss:  6.0744 |Global loss: 6.2489| Local H loss: 0.0037  | Global H loss: 0.0037
Epoch: 3|  NKD Loss: 3.632
Epoch: 3|  Loss:  6.0621 |Global loss: 6.2285| Local H loss: 0.004  | Global H loss: 0.004
Epoch: 0|  NKD Loss: 3.6319
Epoch: 0|  Loss:  5.8563 |Global loss: 6.24| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 1|  NKD Loss: 3.6221
Epoch: 1|  Loss:  5.848 |Global loss: 6.23| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 2|  NKD Loss: 3.6138
Epoch: 2|  Loss:  5.8316 |Global loss: 6.2188| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 3|  NKD Loss: 3.6039
Epoch: 3|  Loss:  5.8208 |Global loss: 6.2199| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 0|  NKD Loss: 3.6072
Epoch: 0|  Loss:  5.947 |Global loss: 6.2125| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 1|  NKD Loss: 3.5988
Epoch: 1|  Loss:  5.9381 |Global loss: 6.2089| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 2|  NKD Loss: 3.5896
Epoch: 2|  Loss:  5.9248 |Global loss: 6.2047| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 3|  NKD Loss: 3.5798
Epoch: 3|  Loss:  5.9048 |Global loss: 6.1899| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 0|  NKD Loss: 3.6279
Epoch: 0|  Loss:  5.7408 |Global loss: 6.234| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 3.6194
Epoch: 1|  Loss:  5.7328 |Global loss: 6.2367| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 3.6103
Epoch: 2|  Loss:  5.7106 |Global loss: 6.226| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 3|  NKD Loss: 3.6001
Epoch: 3|  Loss:  5.7056 |Global loss: 6.2222| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 3.6415
Epoch: 0|  Loss:  5.8825 |Global loss: 6.2361| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 1|  NKD Loss: 3.6331
Epoch: 1|  Loss:  5.8784 |Global loss: 6.2364| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 2|  NKD Loss: 3.6218
Epoch: 2|  Loss:  5.8759 |Global loss: 6.2396| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 3|  NKD Loss: 3.6168
Epoch: 3|  Loss:  5.8644 |Global loss: 6.237| Local H loss: 0.0052  | Global H loss: 0.0052
------------------------- time cost ------------------------- 2.9970006942749023
Chosen Clients:  [13, 10, 0, 8, 7, 5]

-------------Round number: 67-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.05, 0.242, 0.05, 0.117, 0.117, 0.05, 0.117, 0.05, 0.117, 0.117, 0.05, 0.05, 0.117]
AUC in each clients:  [60.658, 62.153, 81.944, 87.359, 63.694, 61.784, 69.063, 68.57, 80.32, 68.648, 82.623, 73.658, 63.591, 73.1, 70.905]
F1 Score:  [0.008, 0.039, 0.008, 0.214, 0.008, 0.061, 0.049, 0.008, 0.049, 0.01, 0.043, 0.061, 0.008, 0.008, 0.043]
Recall Score:  [0.083, 0.167, 0.083, 0.324, 0.083, 0.167, 0.167, 0.083, 0.167, 0.083, 0.167, 0.167, 0.083, 0.083, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9495
Averaged Test Accurancy: 0.0939
Averaged Test AUC: 0.5934
Averaged Test F1_score: 0.0411
Averaged Test Recal score: 0.1383
Std Test Accurancy: 0.0510
Std Test AUC: 0.0685
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.573
Epoch: 0|  Loss:  5.9067 |Global loss: 6.1975| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 3.5628
Epoch: 1|  Loss:  5.887 |Global loss: 6.1856| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 3.5483
Epoch: 2|  Loss:  5.8738 |Global loss: 6.1844| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 3.5345
Epoch: 3|  Loss:  5.8608 |Global loss: 6.1812| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 3.6088
Epoch: 0|  Loss:  5.8524 |Global loss: 6.2265| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 1|  NKD Loss: 3.598
Epoch: 1|  Loss:  5.8384 |Global loss: 6.2153| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 2|  NKD Loss: 3.5887
Epoch: 2|  Loss:  5.8299 |Global loss: 6.2154| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 3|  NKD Loss: 3.5764
Epoch: 3|  Loss:  5.8181 |Global loss: 6.2085| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 0|  NKD Loss: 3.584
Epoch: 0|  Loss:  6.0538 |Global loss: 6.2027| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.5702
Epoch: 1|  Loss:  6.0407 |Global loss: 6.1867| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 2|  NKD Loss: 3.5547
Epoch: 2|  Loss:  6.0355 |Global loss: 6.1845| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 3|  NKD Loss: 3.5406
Epoch: 3|  Loss:  6.0213 |Global loss: 6.1724| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 0|  NKD Loss: 3.5952
Epoch: 0|  Loss:  5.8135 |Global loss: 6.2171| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 1|  NKD Loss: 3.5851
Epoch: 1|  Loss:  5.7911 |Global loss: 6.1977| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 2|  NKD Loss: 3.5722
Epoch: 2|  Loss:  5.7938 |Global loss: 6.2108| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 3|  NKD Loss: 3.5587
Epoch: 3|  Loss:  5.7743 |Global loss: 6.1994| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 0|  NKD Loss: 3.586
Epoch: 0|  Loss:  6.0042 |Global loss: 6.2157| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 1|  NKD Loss: 3.575
Epoch: 1|  Loss:  5.9882 |Global loss: 6.1989| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 2|  NKD Loss: 3.5597
Epoch: 2|  Loss:  5.9743 |Global loss: 6.1891| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 3|  NKD Loss: 3.5485
Epoch: 3|  Loss:  5.9585 |Global loss: 6.1758| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 0|  NKD Loss: 3.596
Epoch: 0|  Loss:  6.0592 |Global loss: 6.2218| Local H loss: 0.0041  | Global H loss: 0.0041
Epoch: 1|  NKD Loss: 3.5824
Epoch: 1|  Loss:  6.0484 |Global loss: 6.208| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 2|  NKD Loss: 3.5694
Epoch: 2|  Loss:  6.0361 |Global loss: 6.193| Local H loss: 0.0044  | Global H loss: 0.0044
Epoch: 3|  NKD Loss: 3.5531
Epoch: 3|  Loss:  6.0235 |Global loss: 6.1829| Local H loss: 0.0046  | Global H loss: 0.0046
------------------------- time cost ------------------------- 2.916379690170288
Chosen Clients:  [8, 5, 4, 2, 3, 14]

-------------Round number: 68-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.05, 0.242, 0.05, 0.05, 0.117, 0.05, 0.117, 0.05, 0.117, 0.117, 0.05, 0.05, 0.117]
AUC in each clients:  [60.57, 62.153, 81.944, 87.359, 63.694, 60.656, 69.063, 68.917, 80.183, 68.648, 82.785, 73.658, 63.591, 74.032, 70.905]
F1 Score:  [0.008, 0.039, 0.008, 0.214, 0.008, 0.008, 0.049, 0.008, 0.049, 0.01, 0.053, 0.061, 0.008, 0.008, 0.043]
Recall Score:  [0.083, 0.167, 0.083, 0.324, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.167, 0.167, 0.083, 0.083, 0.167]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.9148
Averaged Test Accurancy: 0.0894
Averaged Test AUC: 0.5934
Averaged Test F1_score: 0.0383
Averaged Test Recal score: 0.1327
Std Test Accurancy: 0.0517
Std Test AUC: 0.0695
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.5491
Epoch: 0|  Loss:  5.7677 |Global loss: 6.2071| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 3.5355
Epoch: 1|  Loss:  5.7462 |Global loss: 6.1871| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 3.5183
Epoch: 2|  Loss:  5.7249 |Global loss: 6.1728| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 3.4929
Epoch: 3|  Loss:  5.7134 |Global loss: 6.1782| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 3.5324
Epoch: 0|  Loss:  6.0089 |Global loss: 6.174| Local H loss: 0.0047  | Global H loss: 0.0047
Epoch: 1|  NKD Loss: 3.5141
Epoch: 1|  Loss:  5.9992 |Global loss: 6.1671| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.4926
Epoch: 2|  Loss:  5.9848 |Global loss: 6.1576| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 3|  NKD Loss: 3.4746
Epoch: 3|  Loss:  5.9731 |Global loss: 6.1501| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 0|  NKD Loss: 3.5848
Epoch: 0|  Loss:  6.0294 |Global loss: 6.2188| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 1|  NKD Loss: 3.5582
Epoch: 1|  Loss:  6.012 |Global loss: 6.2003| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 2|  NKD Loss: 3.5333
Epoch: 2|  Loss:  5.9981 |Global loss: 6.1825| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 3|  NKD Loss: 3.5097
Epoch: 3|  Loss:  5.9887 |Global loss: 6.1741| Local H loss: 0.0051  | Global H loss: 0.0051
Epoch: 0|  NKD Loss: 3.5511
Epoch: 0|  Loss:  5.8092 |Global loss: 6.2009| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 3.5341
Epoch: 1|  Loss:  5.7909 |Global loss: 6.1861| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 3.5145
Epoch: 2|  Loss:  5.7811 |Global loss: 6.1851| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 3.4935
Epoch: 3|  Loss:  5.7619 |Global loss: 6.1737| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 0|  NKD Loss: 3.5562
Epoch: 0|  Loss:  5.6557 |Global loss: 6.2061| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 1|  NKD Loss: 3.5398
Epoch: 1|  Loss:  5.6268 |Global loss: 6.186| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 3.5173
Epoch: 2|  Loss:  5.6162 |Global loss: 6.1913| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 3|  NKD Loss: 3.4976
Epoch: 3|  Loss:  5.5827 |Global loss: 6.1743| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 0|  NKD Loss: 3.5424
Epoch: 0|  Loss:  5.8885 |Global loss: 6.1869| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 1|  NKD Loss: 3.5246
Epoch: 1|  Loss:  5.8715 |Global loss: 6.1698| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 2|  NKD Loss: 3.5019
Epoch: 2|  Loss:  5.8616 |Global loss: 6.1693| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 3|  NKD Loss: 3.4805
Epoch: 3|  Loss:  5.8468 |Global loss: 6.1665| Local H loss: 0.006  | Global H loss: 0.006
------------------------- time cost ------------------------- 2.974294424057007
Chosen Clients:  [0, 7, 14, 6, 1, 13]

-------------Round number: 69-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.117, 0.05, 0.242, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.117, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [60.57, 62.153, 81.84, 87.579, 62.585, 61.212, 69.063, 68.917, 80.097, 68.648, 82.785, 73.658, 63.591, 74.032, 71.064]
F1 Score:  [0.008, 0.039, 0.008, 0.214, 0.008, 0.008, 0.049, 0.008, 0.009, 0.01, 0.053, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.167, 0.083, 0.324, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.167, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.8651
Averaged Test Accurancy: 0.0806
Averaged Test AUC: 0.5932
Averaged Test F1_score: 0.0333
Averaged Test Recal score: 0.1215
Std Test Accurancy: 0.0520
Std Test AUC: 0.0698
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.4717
Epoch: 0|  Loss:  5.972 |Global loss: 6.1607| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 1|  NKD Loss: 3.4414
Epoch: 1|  Loss:  5.9488 |Global loss: 6.1373| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 2|  NKD Loss: 3.4138
Epoch: 2|  Loss:  5.9164 |Global loss: 6.1013| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 3|  NKD Loss: 3.3773
Epoch: 3|  Loss:  5.9053 |Global loss: 6.0977| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 0|  NKD Loss: 3.4842
Epoch: 0|  Loss:  5.9048 |Global loss: 6.159| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 1|  NKD Loss: 3.4561
Epoch: 1|  Loss:  5.8842 |Global loss: 6.1433| Local H loss: 0.0056  | Global H loss: 0.0056
Epoch: 2|  NKD Loss: 3.4246
Epoch: 2|  Loss:  5.8669 |Global loss: 6.1352| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 3|  NKD Loss: 3.3924
Epoch: 3|  Loss:  5.8289 |Global loss: 6.1044| Local H loss: 0.0059  | Global H loss: 0.0059
Epoch: 0|  NKD Loss: 3.4651
Epoch: 0|  Loss:  5.8135 |Global loss: 6.1359| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 3.4381
Epoch: 1|  Loss:  5.7919 |Global loss: 6.1242| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 3.4023
Epoch: 2|  Loss:  5.7732 |Global loss: 6.1156| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 3|  NKD Loss: 3.3693
Epoch: 3|  Loss:  5.7388 |Global loss: 6.0994| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 0|  NKD Loss: 3.5159
Epoch: 0|  Loss:  5.9099 |Global loss: 6.2023| Local H loss: 0.0045  | Global H loss: 0.0045
Epoch: 1|  NKD Loss: 3.4854
Epoch: 1|  Loss:  5.8886 |Global loss: 6.173| Local H loss: 0.0048  | Global H loss: 0.0048
Epoch: 2|  NKD Loss: 3.4553
Epoch: 2|  Loss:  5.8602 |Global loss: 6.1405| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 3|  NKD Loss: 3.4226
Epoch: 3|  Loss:  5.8367 |Global loss: 6.119| Local H loss: 0.0054  | Global H loss: 0.0054
Epoch: 0|  NKD Loss: 3.5905
Epoch: 0|  Loss:  6.042 |Global loss: 6.2765| Local H loss: 0.0035  | Global H loss: 0.0035
Epoch: 1|  NKD Loss: 3.5581
Epoch: 1|  Loss:  6.0152 |Global loss: 6.2389| Local H loss: 0.0039  | Global H loss: 0.0039
Epoch: 2|  NKD Loss: 3.5227
Epoch: 2|  Loss:  5.9883 |Global loss: 6.2074| Local H loss: 0.0042  | Global H loss: 0.0042
Epoch: 3|  NKD Loss: 3.4879
Epoch: 3|  Loss:  5.9617 |Global loss: 6.1674| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 0|  NKD Loss: 3.4714
Epoch: 0|  Loss:  5.7924 |Global loss: 6.1521| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 3.4392
Epoch: 1|  Loss:  5.7801 |Global loss: 6.1542| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 2|  NKD Loss: 3.4174
Epoch: 2|  Loss:  5.7432 |Global loss: 6.1232| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 3.3799
Epoch: 3|  Loss:  5.7208 |Global loss: 6.1082| Local H loss: 0.007  | Global H loss: 0.007
------------------------- time cost ------------------------- 3.0312256813049316
Chosen Clients:  [1, 7, 13, 2, 12, 6]

-------------Round number: 70-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.242, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.117, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [60.43, 60.499, 81.84, 87.579, 62.585, 61.212, 67.117, 69.162, 80.097, 68.648, 82.785, 73.658, 63.591, 74.399, 71.817]
F1 Score:  [0.008, 0.008, 0.008, 0.214, 0.008, 0.008, 0.008, 0.008, 0.009, 0.01, 0.053, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.324, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.7950
Averaged Test Accurancy: 0.0717
Averaged Test AUC: 0.5919
Averaged Test F1_score: 0.0285
Averaged Test Recal score: 0.1103
Std Test Accurancy: 0.0507
Std Test AUC: 0.0714
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.4107
Epoch: 0|  Loss:  5.9097 |Global loss: 6.1414| Local H loss: 0.005  | Global H loss: 0.005
Epoch: 1|  NKD Loss: 3.3543
Epoch: 1|  Loss:  5.886 |Global loss: 6.1144| Local H loss: 0.0053  | Global H loss: 0.0053
Epoch: 2|  NKD Loss: 3.3053
Epoch: 2|  Loss:  5.851 |Global loss: 6.0783| Local H loss: 0.0056  | Global H loss: 0.0056
Epoch: 3|  NKD Loss: 3.2484
Epoch: 3|  Loss:  5.8146 |Global loss: 6.0472| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 0|  NKD Loss: 3.3707
Epoch: 0|  Loss:  5.8249 |Global loss: 6.1108| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 1|  NKD Loss: 3.329
Epoch: 1|  Loss:  5.7863 |Global loss: 6.0865| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 2|  NKD Loss: 3.2784
Epoch: 2|  Loss:  5.7477 |Global loss: 6.0691| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 3|  NKD Loss: 3.222
Epoch: 3|  Loss:  5.6979 |Global loss: 6.0368| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 3.365
Epoch: 0|  Loss:  5.7022 |Global loss: 6.0959| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 1|  NKD Loss: 3.3213
Epoch: 1|  Loss:  5.6596 |Global loss: 6.072| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 3.2716
Epoch: 2|  Loss:  5.6131 |Global loss: 6.0514| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 3.2092
Epoch: 3|  Loss:  5.5649 |Global loss: 6.0265| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 3.3978
Epoch: 0|  Loss:  5.6662 |Global loss: 6.1228| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 1|  NKD Loss: 3.347
Epoch: 1|  Loss:  5.6417 |Global loss: 6.1078| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 3.2977
Epoch: 2|  Loss:  5.6065 |Global loss: 6.0891| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 3.2395
Epoch: 3|  Loss:  5.5613 |Global loss: 6.0548| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 3.4942
Epoch: 0|  Loss:  5.9324 |Global loss: 6.2117| Local H loss: 0.0043  | Global H loss: 0.0043
Epoch: 1|  NKD Loss: 3.4259
Epoch: 1|  Loss:  5.8864 |Global loss: 6.1661| Local H loss: 0.0049  | Global H loss: 0.0049
Epoch: 2|  NKD Loss: 3.3624
Epoch: 2|  Loss:  5.8502 |Global loss: 6.1114| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 3|  NKD Loss: 3.3016
Epoch: 3|  Loss:  5.8111 |Global loss: 6.062| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 0|  NKD Loss: 3.3703
Epoch: 0|  Loss:  5.8092 |Global loss: 6.1079| Local H loss: 0.0056  | Global H loss: 0.0056
Epoch: 1|  NKD Loss: 3.3322
Epoch: 1|  Loss:  5.7736 |Global loss: 6.0795| Local H loss: 0.0058  | Global H loss: 0.0058
Epoch: 2|  NKD Loss: 3.2819
Epoch: 2|  Loss:  5.7429 |Global loss: 6.056| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 3|  NKD Loss: 3.2287
Epoch: 3|  Loss:  5.6971 |Global loss: 6.0276| Local H loss: 0.0061  | Global H loss: 0.0061
------------------------- time cost ------------------------- 3.0138907432556152
Chosen Clients:  [8, 3, 5, 13, 14, 1]

-------------Round number: 71-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.242, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.117, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [60.43, 61.152, 81.282, 87.579, 62.585, 61.212, 67.758, 70.205, 80.097, 68.648, 82.785, 73.658, 63.642, 75.837, 71.817]
F1 Score:  [0.008, 0.008, 0.008, 0.214, 0.008, 0.008, 0.008, 0.008, 0.009, 0.01, 0.053, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.324, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.6722
Averaged Test Accurancy: 0.0717
Averaged Test AUC: 0.5937
Averaged Test F1_score: 0.0285
Averaged Test Recal score: 0.1103
Std Test Accurancy: 0.0507
Std Test AUC: 0.0707
Std Test F1: 0.0004
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 3.2586
Epoch: 0|  Loss:  5.4959 |Global loss: 6.0835| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 3.1679
Epoch: 1|  Loss:  5.4447 |Global loss: 6.0202| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 3.0784
Epoch: 2|  Loss:  5.3744 |Global loss: 5.9654| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 2.9772
Epoch: 3|  Loss:  5.3105 |Global loss: 5.927| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 3.25
Epoch: 0|  Loss:  5.3604 |Global loss: 6.0793| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 3.1523
Epoch: 1|  Loss:  5.2977 |Global loss: 6.0239| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 2|  NKD Loss: 3.0661
Epoch: 2|  Loss:  5.2288 |Global loss: 5.9686| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 2.9524
Epoch: 3|  Loss:  5.1407 |Global loss: 5.9321| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 3.2496
Epoch: 0|  Loss:  5.7705 |Global loss: 6.076| Local H loss: 0.0052  | Global H loss: 0.0052
Epoch: 1|  NKD Loss: 3.1581
Epoch: 1|  Loss:  5.7163 |Global loss: 6.0048| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 2|  NKD Loss: 3.0649
Epoch: 2|  Loss:  5.6663 |Global loss: 5.9532| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 3|  NKD Loss: 2.9566
Epoch: 3|  Loss:  5.5875 |Global loss: 5.886| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 3.1749
Epoch: 0|  Loss:  5.5391 |Global loss: 6.013| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 1|  NKD Loss: 3.0937
Epoch: 1|  Loss:  5.4635 |Global loss: 5.9722| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 2|  NKD Loss: 3.0074
Epoch: 2|  Loss:  5.3836 |Global loss: 5.9245| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 3|  NKD Loss: 2.8849
Epoch: 3|  Loss:  5.2811 |Global loss: 5.8532| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 0|  NKD Loss: 3.2004
Epoch: 0|  Loss:  5.5903 |Global loss: 6.024| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 1|  NKD Loss: 3.1086
Epoch: 1|  Loss:  5.5445 |Global loss: 5.9839| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 3.0125
Epoch: 2|  Loss:  5.4649 |Global loss: 5.9228| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 2.8926
Epoch: 3|  Loss:  5.3941 |Global loss: 5.8909| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 3.1684
Epoch: 0|  Loss:  5.7626 |Global loss: 6.012| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 1|  NKD Loss: 3.0982
Epoch: 1|  Loss:  5.7018 |Global loss: 5.9679| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 2|  NKD Loss: 2.9999
Epoch: 2|  Loss:  5.6372 |Global loss: 5.9259| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 2.8804
Epoch: 3|  Loss:  5.5469 |Global loss: 5.865| Local H loss: 0.0064  | Global H loss: 0.0064
------------------------- time cost ------------------------- 3.121152639389038
Chosen Clients:  [6, 14, 5, 9, 10, 3]

-------------Round number: 72-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.117, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [60.43, 61.964, 81.282, 86.254, 62.585, 62.089, 67.758, 70.205, 79.249, 68.648, 82.785, 73.658, 63.642, 77.414, 73.242]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.01, 0.053, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.4517
Averaged Test Accurancy: 0.0633
Averaged Test AUC: 0.5951
Averaged Test F1_score: 0.0199
Averaged Test Recal score: 0.0991
Std Test Accurancy: 0.0267
Std Test AUC: 0.0684
Std Test F1: 0.0002
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 2.8753
Epoch: 0|  Loss:  5.3957 |Global loss: 5.8865| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 1|  NKD Loss: 2.7125
Epoch: 1|  Loss:  5.3053 |Global loss: 5.7841| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 2.5348
Epoch: 2|  Loss:  5.2064 |Global loss: 5.7246| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 2.3521
Epoch: 3|  Loss:  5.0783 |Global loss: 5.6818| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 2.8029
Epoch: 0|  Loss:  5.3007 |Global loss: 5.825| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 2.6429
Epoch: 1|  Loss:  5.2013 |Global loss: 5.7753| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 2.4845
Epoch: 2|  Loss:  5.0662 |Global loss: 5.6989| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 3|  NKD Loss: 2.2873
Epoch: 3|  Loss:  4.9435 |Global loss: 5.6516| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 2.7986
Epoch: 0|  Loss:  5.4915 |Global loss: 5.8443| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 2.6546
Epoch: 1|  Loss:  5.3747 |Global loss: 5.7614| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 2.4904
Epoch: 2|  Loss:  5.2538 |Global loss: 5.693| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 3|  NKD Loss: 2.311
Epoch: 3|  Loss:  5.1346 |Global loss: 5.6254| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 0|  NKD Loss: 3.1983
Epoch: 0|  Loss:  5.6291 |Global loss: 6.2092| Local H loss: 0.0046  | Global H loss: 0.0046
Epoch: 1|  NKD Loss: 2.9452
Epoch: 1|  Loss:  5.4694 |Global loss: 5.9768| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 2|  NKD Loss: 2.7423
Epoch: 2|  Loss:  5.3649 |Global loss: 5.8037| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 3|  NKD Loss: 2.5601
Epoch: 3|  Loss:  5.27 |Global loss: 5.7393| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 3.1153
Epoch: 0|  Loss:  5.3963 |Global loss: 6.1242| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 1|  NKD Loss: 2.9118
Epoch: 1|  Loss:  5.317 |Global loss: 5.9826| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 2.7865
Epoch: 2|  Loss:  5.2234 |Global loss: 5.8955| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 2.6588
Epoch: 3|  Loss:  5.1234 |Global loss: 5.8253| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 2.8362
Epoch: 0|  Loss:  5.044 |Global loss: 5.8787| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 2.6931
Epoch: 1|  Loss:  4.9255 |Global loss: 5.8091| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 2.5264
Epoch: 2|  Loss:  4.792 |Global loss: 5.7503| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 2.345
Epoch: 3|  Loss:  4.6518 |Global loss: 5.6858| Local H loss: 0.0103  | Global H loss: 0.0103
------------------------- time cost ------------------------- 2.877319812774658
Chosen Clients:  [10, 3, 6, 12, 8, 0]

-------------Round number: 73-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [60.43, 61.964, 81.282, 87.913, 62.585, 63.385, 68.795, 70.205, 79.249, 65.583, 75.749, 73.658, 63.642, 77.414, 75.701]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 5.1067
Averaged Test Accurancy: 0.0589
Averaged Test AUC: 0.5931
Averaged Test F1_score: 0.0168
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0227
Std Test AUC: 0.0668
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 2.4195
Epoch: 0|  Loss:  4.9705 |Global loss: 5.7729| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 2.2716
Epoch: 1|  Loss:  4.8855 |Global loss: 5.744| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 2.1359
Epoch: 2|  Loss:  4.7747 |Global loss: 5.6887| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 2.0009
Epoch: 3|  Loss:  4.6939 |Global loss: 5.6431| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 2.2985
Epoch: 0|  Loss:  4.5905 |Global loss: 5.657| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 2.1178
Epoch: 1|  Loss:  4.4674 |Global loss: 5.6173| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.9697
Epoch: 2|  Loss:  4.3322 |Global loss: 5.5873| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 1.8289
Epoch: 3|  Loss:  4.2277 |Global loss: 5.5638| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 2.261
Epoch: 0|  Loss:  4.987 |Global loss: 5.6138| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 2.1028
Epoch: 1|  Loss:  4.8814 |Global loss: 5.5794| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 2|  NKD Loss: 1.944
Epoch: 2|  Loss:  4.7622 |Global loss: 5.5463| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.8055
Epoch: 3|  Loss:  4.6603 |Global loss: 5.5246| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 2.4905
Epoch: 0|  Loss:  5.1434 |Global loss: 5.8107| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 2.1842
Epoch: 1|  Loss:  5.0358 |Global loss: 5.6259| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 2|  NKD Loss: 2.0096
Epoch: 2|  Loss:  4.9196 |Global loss: 5.5599| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.871
Epoch: 3|  Loss:  4.8186 |Global loss: 5.547| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 2.3827
Epoch: 0|  Loss:  4.8157 |Global loss: 5.7286| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 2.1739
Epoch: 1|  Loss:  4.7138 |Global loss: 5.6239| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 2.0246
Epoch: 2|  Loss:  4.6114 |Global loss: 5.5789| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.8888
Epoch: 3|  Loss:  4.5054 |Global loss: 5.5678| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 0|  NKD Loss: 2.5631
Epoch: 0|  Loss:  5.2055 |Global loss: 5.8955| Local H loss: 0.0057  | Global H loss: 0.0057
Epoch: 1|  NKD Loss: 2.2177
Epoch: 1|  Loss:  5.063 |Global loss: 5.6059| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 2.0169
Epoch: 2|  Loss:  4.9719 |Global loss: 5.5656| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.8712
Epoch: 3|  Loss:  4.8598 |Global loss: 5.5322| Local H loss: 0.0068  | Global H loss: 0.0068
------------------------- time cost ------------------------- 2.9655323028564453
Chosen Clients:  [4, 11, 6, 1, 12, 14]

-------------Round number: 74-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05]
AUC in each clients:  [61.153, 61.964, 81.282, 90.168, 62.585, 63.385, 71.337, 70.205, 80.282, 65.583, 76.38, 73.658, 64.652, 77.414, 75.701]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.061, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.7706
Averaged Test Accurancy: 0.0589
Averaged Test AUC: 0.5976
Averaged Test F1_score: 0.0168
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0227
Std Test AUC: 0.0690
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 2.4335
Epoch: 0|  Loss:  5.0469 |Global loss: 6.1813| Local H loss: 0.0055  | Global H loss: 0.0055
Epoch: 1|  NKD Loss: 1.8278
Epoch: 1|  Loss:  4.815 |Global loss: 5.5719| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 2|  NKD Loss: 1.6633
Epoch: 2|  Loss:  4.7426 |Global loss: 5.5228| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 3|  NKD Loss: 1.5967
Epoch: 3|  Loss:  4.6806 |Global loss: 5.5173| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 2.5891
Epoch: 0|  Loss:  5.0288 |Global loss: 6.2948| Local H loss: 0.006  | Global H loss: 0.006
Epoch: 1|  NKD Loss: 1.8768
Epoch: 1|  Loss:  4.6839 |Global loss: 5.602| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.6937
Epoch: 2|  Loss:  4.6279 |Global loss: 5.5247| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.6156
Epoch: 3|  Loss:  4.5645 |Global loss: 5.5431| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 0|  NKD Loss: 1.7413
Epoch: 0|  Loss:  4.634 |Global loss: 5.518| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.6625
Epoch: 1|  Loss:  4.5467 |Global loss: 5.5203| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.5654
Epoch: 2|  Loss:  4.4916 |Global loss: 5.537| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.516
Epoch: 3|  Loss:  4.4368 |Global loss: 5.5342| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 1.9405
Epoch: 0|  Loss:  4.8118 |Global loss: 5.6764| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.7103
Epoch: 1|  Loss:  4.765 |Global loss: 5.5451| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 1.6219
Epoch: 2|  Loss:  4.7036 |Global loss: 5.5224| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.544
Epoch: 3|  Loss:  4.6646 |Global loss: 5.5518| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 0|  NKD Loss: 1.7733
Epoch: 0|  Loss:  4.779 |Global loss: 5.5497| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 1|  NKD Loss: 1.6735
Epoch: 1|  Loss:  4.6992 |Global loss: 5.5424| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 1.5946
Epoch: 2|  Loss:  4.6438 |Global loss: 5.5454| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 3|  NKD Loss: 1.5234
Epoch: 3|  Loss:  4.5786 |Global loss: 5.5576| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.7836
Epoch: 0|  Loss:  4.5485 |Global loss: 5.5528| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.6608
Epoch: 1|  Loss:  4.4893 |Global loss: 5.5202| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.5786
Epoch: 2|  Loss:  4.4313 |Global loss: 5.5314| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 3|  NKD Loss: 1.5177
Epoch: 3|  Loss:  4.3673 |Global loss: 5.5223| Local H loss: 0.008  | Global H loss: 0.008
------------------------- time cost ------------------------- 3.2421348094940186
Chosen Clients:  [10, 4, 6, 2, 11, 12]

-------------Round number: 75-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [61.153, 63.417, 81.282, 90.168, 61.923, 63.385, 73.652, 70.205, 80.282, 65.583, 76.38, 71.001, 65.802, 77.414, 78.514]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.5079
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6001
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0690
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.6495
Epoch: 0|  Loss:  4.4416 |Global loss: 5.6816| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.5764
Epoch: 1|  Loss:  4.4156 |Global loss: 5.6403| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.5464
Epoch: 2|  Loss:  4.3791 |Global loss: 5.6367| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.4909
Epoch: 3|  Loss:  4.347 |Global loss: 5.6253| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.4918
Epoch: 0|  Loss:  4.6303 |Global loss: 5.5402| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.4595
Epoch: 1|  Loss:  4.5904 |Global loss: 5.5345| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.4098
Epoch: 2|  Loss:  4.5612 |Global loss: 5.562| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.4022
Epoch: 3|  Loss:  4.5402 |Global loss: 5.5486| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 0|  NKD Loss: 1.506
Epoch: 0|  Loss:  4.4297 |Global loss: 5.5269| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.4544
Epoch: 1|  Loss:  4.3844 |Global loss: 5.5637| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.4158
Epoch: 2|  Loss:  4.3592 |Global loss: 5.5585| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.3839
Epoch: 3|  Loss:  4.3305 |Global loss: 5.5737| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 1.8178
Epoch: 0|  Loss:  4.4254 |Global loss: 5.8473| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.5361
Epoch: 1|  Loss:  4.3767 |Global loss: 5.591| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.4854
Epoch: 2|  Loss:  4.3331 |Global loss: 5.5716| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 3|  NKD Loss: 1.4478
Epoch: 3|  Loss:  4.2888 |Global loss: 5.5735| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 0|  NKD Loss: 1.531
Epoch: 0|  Loss:  4.4813 |Global loss: 5.5301| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.4662
Epoch: 1|  Loss:  4.4383 |Global loss: 5.5643| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 1.4302
Epoch: 2|  Loss:  4.4053 |Global loss: 5.5419| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 3|  NKD Loss: 1.4047
Epoch: 3|  Loss:  4.367 |Global loss: 5.5659| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 0|  NKD Loss: 1.5109
Epoch: 0|  Loss:  4.5873 |Global loss: 5.5494| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 1|  NKD Loss: 1.4752
Epoch: 1|  Loss:  4.5441 |Global loss: 5.582| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 1.4414
Epoch: 2|  Loss:  4.515 |Global loss: 5.566| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.4091
Epoch: 3|  Loss:  4.4874 |Global loss: 5.5638| Local H loss: 0.0068  | Global H loss: 0.0068
------------------------- time cost ------------------------- 2.9322261810302734
Chosen Clients:  [3, 1, 14, 12, 8, 5]

-------------Round number: 76-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [61.153, 63.417, 82.345, 90.168, 64.661, 63.385, 77.83, 70.205, 80.282, 65.583, 79.021, 74.595, 68.276, 77.414, 78.514]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.3962
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6094
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0689
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.4652
Epoch: 0|  Loss:  3.9512 |Global loss: 5.6258| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 1.4203
Epoch: 1|  Loss:  3.9302 |Global loss: 5.6132| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.3837
Epoch: 2|  Loss:  3.9047 |Global loss: 5.6204| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 3|  NKD Loss: 1.3744
Epoch: 3|  Loss:  3.8501 |Global loss: 5.6279| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 0|  NKD Loss: 1.4275
Epoch: 0|  Loss:  4.5715 |Global loss: 5.5778| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 1.3801
Epoch: 1|  Loss:  4.5525 |Global loss: 5.5911| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.3744
Epoch: 2|  Loss:  4.5318 |Global loss: 5.5942| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.3619
Epoch: 3|  Loss:  4.5183 |Global loss: 5.5795| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.3995
Epoch: 0|  Loss:  4.2815 |Global loss: 5.5723| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.3708
Epoch: 1|  Loss:  4.2612 |Global loss: 5.5839| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.3685
Epoch: 2|  Loss:  4.2409 |Global loss: 5.5708| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 3|  NKD Loss: 1.324
Epoch: 3|  Loss:  4.2218 |Global loss: 5.5968| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 0|  NKD Loss: 1.3908
Epoch: 0|  Loss:  4.4883 |Global loss: 5.5892| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 1|  NKD Loss: 1.376
Epoch: 1|  Loss:  4.459 |Global loss: 5.583| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 1.3502
Epoch: 2|  Loss:  4.4393 |Global loss: 5.5946| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 3|  NKD Loss: 1.3503
Epoch: 3|  Loss:  4.42 |Global loss: 5.5901| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 0|  NKD Loss: 1.4573
Epoch: 0|  Loss:  4.1915 |Global loss: 5.6174| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.4078
Epoch: 1|  Loss:  4.1669 |Global loss: 5.5929| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.3921
Epoch: 2|  Loss:  4.1335 |Global loss: 5.5882| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.3825
Epoch: 3|  Loss:  4.1151 |Global loss: 5.6083| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 0|  NKD Loss: 1.492
Epoch: 0|  Loss:  4.5451 |Global loss: 5.656| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.4021
Epoch: 1|  Loss:  4.5491 |Global loss: 5.5632| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 1.38
Epoch: 2|  Loss:  4.5417 |Global loss: 5.5776| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.3745
Epoch: 3|  Loss:  4.5237 |Global loss: 5.5814| Local H loss: 0.0064  | Global H loss: 0.0064
------------------------- time cost ------------------------- 3.100360631942749
Chosen Clients:  [6, 8, 5, 11, 12, 0]

-------------Round number: 77-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [61.153, 64.308, 82.345, 94.07, 64.661, 65.069, 77.83, 70.205, 83.168, 65.583, 79.021, 74.595, 70.855, 77.414, 82.286]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.3513
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6181
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0745
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3577
Epoch: 0|  Loss:  4.2702 |Global loss: 5.5842| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.3319
Epoch: 1|  Loss:  4.2616 |Global loss: 5.5712| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 2|  NKD Loss: 1.3263
Epoch: 2|  Loss:  4.257 |Global loss: 5.5911| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.32
Epoch: 3|  Loss:  4.2376 |Global loss: 5.5883| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.348
Epoch: 0|  Loss:  4.1094 |Global loss: 5.6123| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 1|  NKD Loss: 1.3547
Epoch: 1|  Loss:  4.0727 |Global loss: 5.6031| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 2|  NKD Loss: 1.321
Epoch: 2|  Loss:  4.0557 |Global loss: 5.6198| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.3345
Epoch: 3|  Loss:  4.0498 |Global loss: 5.6089| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 0|  NKD Loss: 1.3403
Epoch: 0|  Loss:  4.5058 |Global loss: 5.5987| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.337
Epoch: 1|  Loss:  4.4885 |Global loss: 5.5822| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 1.3456
Epoch: 2|  Loss:  4.478 |Global loss: 5.5828| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.3326
Epoch: 3|  Loss:  4.4666 |Global loss: 5.583| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.3457
Epoch: 0|  Loss:  4.3205 |Global loss: 5.5865| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.3366
Epoch: 1|  Loss:  4.3013 |Global loss: 5.5745| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.326
Epoch: 2|  Loss:  4.2717 |Global loss: 5.5769| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.3267
Epoch: 3|  Loss:  4.266 |Global loss: 5.5867| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 0|  NKD Loss: 1.3492
Epoch: 0|  Loss:  4.4133 |Global loss: 5.5915| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 1|  NKD Loss: 1.3369
Epoch: 1|  Loss:  4.4003 |Global loss: 5.5822| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 1.3311
Epoch: 2|  Loss:  4.3885 |Global loss: 5.5903| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.3361
Epoch: 3|  Loss:  4.3742 |Global loss: 5.5793| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.3921
Epoch: 0|  Loss:  4.5293 |Global loss: 5.6327| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 1.3587
Epoch: 1|  Loss:  4.543 |Global loss: 5.6022| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 1.3319
Epoch: 2|  Loss:  4.5396 |Global loss: 5.6039| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.3409
Epoch: 3|  Loss:  4.5182 |Global loss: 5.5911| Local H loss: 0.0064  | Global H loss: 0.0064
------------------------- time cost ------------------------- 2.7773845195770264
Chosen Clients:  [10, 3, 0, 2, 4, 7]

-------------Round number: 78-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [63.473, 64.308, 82.345, 94.07, 64.661, 66.002, 81.372, 70.205, 87.486, 65.583, 79.021, 81.634, 74.04, 77.414, 82.286]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.3242
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6299
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0768
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3619
Epoch: 0|  Loss:  4.2738 |Global loss: 5.6844| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.3875
Epoch: 1|  Loss:  4.2529 |Global loss: 5.6484| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.3805
Epoch: 2|  Loss:  4.2438 |Global loss: 5.6207| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.365
Epoch: 3|  Loss:  4.2203 |Global loss: 5.607| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 1.3626
Epoch: 0|  Loss:  3.8359 |Global loss: 5.6231| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.3526
Epoch: 1|  Loss:  3.7979 |Global loss: 5.6352| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 2|  NKD Loss: 1.3371
Epoch: 2|  Loss:  3.7791 |Global loss: 5.6417| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 3|  NKD Loss: 1.306
Epoch: 3|  Loss:  3.7379 |Global loss: 5.6646| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 0|  NKD Loss: 1.3427
Epoch: 0|  Loss:  4.5 |Global loss: 5.5848| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 1|  NKD Loss: 1.3249
Epoch: 1|  Loss:  4.503 |Global loss: 5.5833| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.32
Epoch: 2|  Loss:  4.49 |Global loss: 5.6014| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.3156
Epoch: 3|  Loss:  4.4734 |Global loss: 5.5819| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 1.3533
Epoch: 0|  Loss:  4.1991 |Global loss: 5.5993| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.3424
Epoch: 1|  Loss:  4.1841 |Global loss: 5.5955| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.3332
Epoch: 2|  Loss:  4.1671 |Global loss: 5.5881| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.327
Epoch: 3|  Loss:  4.1453 |Global loss: 5.5973| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 0|  NKD Loss: 1.3207
Epoch: 0|  Loss:  4.4962 |Global loss: 5.5907| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.3302
Epoch: 1|  Loss:  4.4869 |Global loss: 5.5821| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.3148
Epoch: 2|  Loss:  4.4831 |Global loss: 5.5923| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.3115
Epoch: 3|  Loss:  4.4664 |Global loss: 5.5747| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.8094
Epoch: 0|  Loss:  4.5571 |Global loss: 6.0127| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.4655
Epoch: 1|  Loss:  4.5347 |Global loss: 5.668| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 1.4423
Epoch: 2|  Loss:  4.5039 |Global loss: 5.6399| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.4352
Epoch: 3|  Loss:  4.4723 |Global loss: 5.6385| Local H loss: 0.0072  | Global H loss: 0.0072
------------------------- time cost ------------------------- 3.28122615814209
Chosen Clients:  [1, 12, 4, 13, 8, 2]

-------------Round number: 79-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [65.076, 64.308, 87.345, 98.209, 66.455, 66.002, 81.372, 70.941, 87.486, 65.583, 84.181, 81.634, 74.04, 77.414, 82.286]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.2873
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6402
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0833
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.328
Epoch: 0|  Loss:  4.4982 |Global loss: 5.598| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.3278
Epoch: 1|  Loss:  4.4811 |Global loss: 5.5849| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 1.3117
Epoch: 2|  Loss:  4.477 |Global loss: 5.5935| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.3202
Epoch: 3|  Loss:  4.4698 |Global loss: 5.579| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 1.3284
Epoch: 0|  Loss:  4.3481 |Global loss: 5.5813| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 1|  NKD Loss: 1.311
Epoch: 1|  Loss:  4.3466 |Global loss: 5.5762| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.3077
Epoch: 2|  Loss:  4.3366 |Global loss: 5.5918| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.315
Epoch: 3|  Loss:  4.3255 |Global loss: 5.5764| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 1.298
Epoch: 0|  Loss:  4.4605 |Global loss: 5.5822| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 1|  NKD Loss: 1.3176
Epoch: 1|  Loss:  4.4536 |Global loss: 5.5661| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.3001
Epoch: 2|  Loss:  4.4449 |Global loss: 5.5738| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.314
Epoch: 3|  Loss:  4.435 |Global loss: 5.575| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.5449
Epoch: 0|  Loss:  4.265 |Global loss: 5.8037| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 1.3854
Epoch: 1|  Loss:  4.2643 |Global loss: 5.6139| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.3742
Epoch: 2|  Loss:  4.2435 |Global loss: 5.618| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.3516
Epoch: 3|  Loss:  4.2 |Global loss: 5.6041| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 0|  NKD Loss: 1.339
Epoch: 0|  Loss:  4.0294 |Global loss: 5.5942| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 1|  NKD Loss: 1.3316
Epoch: 1|  Loss:  4.0016 |Global loss: 5.5838| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.3169
Epoch: 2|  Loss:  3.9988 |Global loss: 5.6129| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.3162
Epoch: 3|  Loss:  3.9751 |Global loss: 5.6003| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 0|  NKD Loss: 1.3247
Epoch: 0|  Loss:  4.1393 |Global loss: 5.589| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 1.3151
Epoch: 1|  Loss:  4.1214 |Global loss: 5.6061| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 2|  NKD Loss: 1.3114
Epoch: 2|  Loss:  4.1075 |Global loss: 5.5979| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 1.3132
Epoch: 3|  Loss:  4.1014 |Global loss: 5.6003| Local H loss: 0.009  | Global H loss: 0.009
------------------------- time cost ------------------------- 2.795625686645508
Chosen Clients:  [4, 14, 5, 7, 9, 10]

-------------Round number: 80-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [65.076, 65.544, 89.291, 98.209, 68.321, 66.002, 81.372, 70.941, 90.448, 65.583, 84.181, 81.634, 76.208, 81.644, 82.286]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.2569
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6482
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0848
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2806
Epoch: 0|  Loss:  4.4281 |Global loss: 5.5755| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 1|  NKD Loss: 1.3117
Epoch: 1|  Loss:  4.4275 |Global loss: 5.5733| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 1.3105
Epoch: 2|  Loss:  4.4174 |Global loss: 5.5675| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.3114
Epoch: 3|  Loss:  4.4049 |Global loss: 5.5666| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.3255
Epoch: 0|  Loss:  4.1833 |Global loss: 5.5801| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 1|  NKD Loss: 1.3135
Epoch: 1|  Loss:  4.1702 |Global loss: 5.5991| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 2|  NKD Loss: 1.3165
Epoch: 2|  Loss:  4.1685 |Global loss: 5.58| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.3067
Epoch: 3|  Loss:  4.1425 |Global loss: 5.5881| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 0|  NKD Loss: 1.3179
Epoch: 0|  Loss:  4.4474 |Global loss: 5.5688| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2958
Epoch: 1|  Loss:  4.44 |Global loss: 5.6053| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.3175
Epoch: 2|  Loss:  4.4253 |Global loss: 5.5564| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.2998
Epoch: 3|  Loss:  4.4183 |Global loss: 5.5734| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.3827
Epoch: 0|  Loss:  4.4398 |Global loss: 5.6474| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.3804
Epoch: 1|  Loss:  4.4211 |Global loss: 5.6425| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 1.3597
Epoch: 2|  Loss:  4.3925 |Global loss: 5.5944| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.3543
Epoch: 3|  Loss:  4.3875 |Global loss: 5.6186| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 1.4843
Epoch: 0|  Loss:  4.4764 |Global loss: 5.7351| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 1|  NKD Loss: 1.3539
Epoch: 1|  Loss:  4.49 |Global loss: 5.6013| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.3433
Epoch: 2|  Loss:  4.4693 |Global loss: 5.5861| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.3423
Epoch: 3|  Loss:  4.4577 |Global loss: 5.5836| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.3534
Epoch: 0|  Loss:  4.1947 |Global loss: 5.608| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 1.3278
Epoch: 1|  Loss:  4.1868 |Global loss: 5.6106| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 2|  NKD Loss: 1.311
Epoch: 2|  Loss:  4.173 |Global loss: 5.6142| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.3286
Epoch: 3|  Loss:  4.1641 |Global loss: 5.5928| Local H loss: 0.0076  | Global H loss: 0.0076
------------------------- time cost ------------------------- 3.1087729930877686
Chosen Clients:  [13, 0, 8, 1, 6, 3]

-------------Round number: 81-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [65.076, 65.544, 89.291, 98.209, 71.479, 67.777, 81.372, 74.798, 90.448, 67.905, 88.123, 81.634, 76.208, 81.644, 85.646]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.2426
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6584
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0822
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3421
Epoch: 0|  Loss:  4.1731 |Global loss: 5.6053| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.3332
Epoch: 1|  Loss:  4.1629 |Global loss: 5.5994| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.3056
Epoch: 2|  Loss:  4.1283 |Global loss: 5.604| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.3279
Epoch: 3|  Loss:  4.1086 |Global loss: 5.5875| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 0|  NKD Loss: 1.3253
Epoch: 0|  Loss:  4.4726 |Global loss: 5.5773| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.3105
Epoch: 1|  Loss:  4.473 |Global loss: 5.5829| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.3061
Epoch: 2|  Loss:  4.4649 |Global loss: 5.5742| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.3166
Epoch: 3|  Loss:  4.4431 |Global loss: 5.5633| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.333
Epoch: 0|  Loss:  3.9668 |Global loss: 5.586| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 1|  NKD Loss: 1.3038
Epoch: 1|  Loss:  3.9498 |Global loss: 5.6081| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.3239
Epoch: 2|  Loss:  3.9321 |Global loss: 5.5986| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 1.3153
Epoch: 3|  Loss:  3.919 |Global loss: 5.6072| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 1.3117
Epoch: 0|  Loss:  4.4676 |Global loss: 5.594| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 1|  NKD Loss: 1.3311
Epoch: 1|  Loss:  4.4558 |Global loss: 5.5601| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 1.316
Epoch: 2|  Loss:  4.4484 |Global loss: 5.5849| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.3194
Epoch: 3|  Loss:  4.4389 |Global loss: 5.5556| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 1.3218
Epoch: 0|  Loss:  4.2209 |Global loss: 5.58| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 1.3129
Epoch: 1|  Loss:  4.2087 |Global loss: 5.575| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 2|  NKD Loss: 1.3006
Epoch: 2|  Loss:  4.2032 |Global loss: 5.5998| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.314
Epoch: 3|  Loss:  4.1854 |Global loss: 5.5747| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 0|  NKD Loss: 1.3372
Epoch: 0|  Loss:  3.7355 |Global loss: 5.6298| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 1.3246
Epoch: 1|  Loss:  3.7135 |Global loss: 5.6394| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 2|  NKD Loss: 1.3214
Epoch: 2|  Loss:  3.6846 |Global loss: 5.6288| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.3354
Epoch: 3|  Loss:  3.6562 |Global loss: 5.638| Local H loss: 0.0125  | Global H loss: 0.0125
------------------------- time cost ------------------------- 2.8381717205047607
Chosen Clients:  [14, 9, 8, 2, 3, 1]

-------------Round number: 82-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [68.402, 67.983, 89.291, 99.777, 71.479, 67.777, 85.692, 74.798, 92.509, 67.905, 88.123, 81.634, 76.208, 87.562, 85.646]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.2162
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6693
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0836
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.316
Epoch: 0|  Loss:  4.1377 |Global loss: 5.5877| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 1|  NKD Loss: 1.3057
Epoch: 1|  Loss:  4.1311 |Global loss: 5.5927| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 1.321
Epoch: 2|  Loss:  4.107 |Global loss: 5.5812| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.3021
Epoch: 3|  Loss:  4.0927 |Global loss: 5.5927| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 0|  NKD Loss: 1.3138
Epoch: 0|  Loss:  4.4315 |Global loss: 5.6007| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 1|  NKD Loss: 1.301
Epoch: 1|  Loss:  4.4056 |Global loss: 5.6054| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 1.3117
Epoch: 2|  Loss:  4.406 |Global loss: 5.5838| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.3109
Epoch: 3|  Loss:  4.3906 |Global loss: 5.5786| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.3203
Epoch: 0|  Loss:  3.9126 |Global loss: 5.588| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 1.3208
Epoch: 1|  Loss:  3.9013 |Global loss: 5.6054| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.3125
Epoch: 2|  Loss:  3.8733 |Global loss: 5.6046| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2987
Epoch: 3|  Loss:  3.8627 |Global loss: 5.6133| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.321
Epoch: 0|  Loss:  4.0844 |Global loss: 5.5944| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 1.2955
Epoch: 1|  Loss:  4.0665 |Global loss: 5.6054| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 1.3006
Epoch: 2|  Loss:  4.0613 |Global loss: 5.5942| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2915
Epoch: 3|  Loss:  4.0456 |Global loss: 5.6153| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 0|  NKD Loss: 1.328
Epoch: 0|  Loss:  3.6515 |Global loss: 5.6386| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 1|  NKD Loss: 1.335
Epoch: 1|  Loss:  3.6437 |Global loss: 5.6415| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 1.3108
Epoch: 2|  Loss:  3.6112 |Global loss: 5.6574| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.3056
Epoch: 3|  Loss:  3.5715 |Global loss: 5.6604| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 0|  NKD Loss: 1.301
Epoch: 0|  Loss:  4.4257 |Global loss: 5.5812| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 1|  NKD Loss: 1.2869
Epoch: 1|  Loss:  4.4165 |Global loss: 5.5765| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.2857
Epoch: 2|  Loss:  4.4166 |Global loss: 5.5967| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 3|  NKD Loss: 1.3086
Epoch: 3|  Loss:  4.404 |Global loss: 5.5675| Local H loss: 0.0062  | Global H loss: 0.0062
------------------------- time cost ------------------------- 2.9873623847961426
Chosen Clients:  [10, 8, 0, 14, 4, 9]

-------------Round number: 83-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [68.402, 70.384, 91.158, 100.773, 71.479, 67.777, 85.692, 74.798, 94.864, 70.807, 88.123, 81.634, 76.208, 87.562, 88.078]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1885
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6765
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0848
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3106
Epoch: 0|  Loss:  4.1434 |Global loss: 5.5882| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 1|  NKD Loss: 1.3145
Epoch: 1|  Loss:  4.1233 |Global loss: 5.5997| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 1.3031
Epoch: 2|  Loss:  4.123 |Global loss: 5.5815| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 3|  NKD Loss: 1.3026
Epoch: 3|  Loss:  4.0958 |Global loss: 5.5813| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 0|  NKD Loss: 1.3131
Epoch: 0|  Loss:  3.8557 |Global loss: 5.6109| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.3108
Epoch: 1|  Loss:  3.8254 |Global loss: 5.6076| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2983
Epoch: 2|  Loss:  3.8125 |Global loss: 5.6146| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 1.2932
Epoch: 3|  Loss:  3.7949 |Global loss: 5.6262| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 1.3038
Epoch: 0|  Loss:  4.4308 |Global loss: 5.5737| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 1|  NKD Loss: 1.2834
Epoch: 1|  Loss:  4.4319 |Global loss: 5.5762| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.3028
Epoch: 2|  Loss:  4.4216 |Global loss: 5.5716| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 3|  NKD Loss: 1.295
Epoch: 3|  Loss:  4.4178 |Global loss: 5.5661| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 0|  NKD Loss: 1.3037
Epoch: 0|  Loss:  4.083 |Global loss: 5.5825| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 1|  NKD Loss: 1.2796
Epoch: 1|  Loss:  4.086 |Global loss: 5.6157| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.3093
Epoch: 2|  Loss:  4.067 |Global loss: 5.5903| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 3|  NKD Loss: 1.3064
Epoch: 3|  Loss:  4.0623 |Global loss: 5.6041| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 0|  NKD Loss: 1.2739
Epoch: 0|  Loss:  4.3923 |Global loss: 5.5808| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 1|  NKD Loss: 1.2799
Epoch: 1|  Loss:  4.378 |Global loss: 5.5724| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 1.2946
Epoch: 2|  Loss:  4.3696 |Global loss: 5.5586| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 3|  NKD Loss: 1.2767
Epoch: 3|  Loss:  4.3709 |Global loss: 5.5757| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.2982
Epoch: 0|  Loss:  4.358 |Global loss: 5.5864| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 1|  NKD Loss: 1.2914
Epoch: 1|  Loss:  4.3669 |Global loss: 5.5816| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.299
Epoch: 2|  Loss:  4.3423 |Global loss: 5.5922| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.2771
Epoch: 3|  Loss:  4.3362 |Global loss: 5.5944| Local H loss: 0.0069  | Global H loss: 0.0069
------------------------- time cost ------------------------- 2.8149499893188477
Chosen Clients:  [4, 3, 14, 2, 6, 11]

-------------Round number: 84-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [69.935, 70.384, 91.158, 100.773, 74.886, 67.777, 85.692, 74.798, 95.756, 75.921, 90.767, 81.634, 76.208, 87.562, 90.098]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1761
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6852
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0824
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2931
Epoch: 0|  Loss:  4.3569 |Global loss: 5.5617| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 1|  NKD Loss: 1.286
Epoch: 1|  Loss:  4.3418 |Global loss: 5.5643| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.2868
Epoch: 2|  Loss:  4.3325 |Global loss: 5.5625| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 3|  NKD Loss: 1.3011
Epoch: 3|  Loss:  4.3223 |Global loss: 5.5513| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 1.322
Epoch: 0|  Loss:  3.5824 |Global loss: 5.6426| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 1|  NKD Loss: 1.3284
Epoch: 1|  Loss:  3.5683 |Global loss: 5.6527| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 2|  NKD Loss: 1.3006
Epoch: 2|  Loss:  3.558 |Global loss: 5.6542| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 3|  NKD Loss: 1.3143
Epoch: 3|  Loss:  3.5209 |Global loss: 5.6613| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 0|  NKD Loss: 1.3088
Epoch: 0|  Loss:  4.0509 |Global loss: 5.5875| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 1|  NKD Loss: 1.3243
Epoch: 1|  Loss:  4.0398 |Global loss: 5.5961| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.3045
Epoch: 2|  Loss:  4.0344 |Global loss: 5.5932| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 1.3119
Epoch: 3|  Loss:  4.0183 |Global loss: 5.5975| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 0|  NKD Loss: 1.3037
Epoch: 0|  Loss:  4.0444 |Global loss: 5.6041| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 1.2998
Epoch: 1|  Loss:  4.0282 |Global loss: 5.5996| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 1.3159
Epoch: 2|  Loss:  4.0229 |Global loss: 5.5928| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.3147
Epoch: 3|  Loss:  4.0064 |Global loss: 5.5889| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 1.2886
Epoch: 0|  Loss:  4.1678 |Global loss: 5.5868| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 1.2851
Epoch: 1|  Loss:  4.1445 |Global loss: 5.5918| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 1.2913
Epoch: 2|  Loss:  4.1309 |Global loss: 5.5769| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 3|  NKD Loss: 1.2984
Epoch: 3|  Loss:  4.1297 |Global loss: 5.5886| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 0|  NKD Loss: 1.2959
Epoch: 0|  Loss:  4.2266 |Global loss: 5.5711| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.2932
Epoch: 1|  Loss:  4.2098 |Global loss: 5.565| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.2898
Epoch: 2|  Loss:  4.186 |Global loss: 5.5812| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 3|  NKD Loss: 1.2812
Epoch: 3|  Loss:  4.1678 |Global loss: 5.5766| Local H loss: 0.0091  | Global H loss: 0.0091
------------------------- time cost ------------------------- 2.8756237030029297
Chosen Clients:  [4, 10, 14, 3, 11, 0]

-------------Round number: 85-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [69.935, 70.384, 92.026, 101.546, 78.608, 67.777, 88.493, 74.798, 95.756, 75.921, 90.767, 87.53, 76.208, 87.562, 91.694]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1496
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.6939
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0844
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2861
Epoch: 0|  Loss:  4.3083 |Global loss: 5.5627| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2762
Epoch: 1|  Loss:  4.3018 |Global loss: 5.5711| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.2895
Epoch: 2|  Loss:  4.2845 |Global loss: 5.5593| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.2852
Epoch: 3|  Loss:  4.2838 |Global loss: 5.5578| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 1.299
Epoch: 0|  Loss:  4.0917 |Global loss: 5.576| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.2961
Epoch: 1|  Loss:  4.0732 |Global loss: 5.5812| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.3079
Epoch: 2|  Loss:  4.0518 |Global loss: 5.5724| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 3|  NKD Loss: 1.3027
Epoch: 3|  Loss:  4.0557 |Global loss: 5.5733| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 0|  NKD Loss: 1.3005
Epoch: 0|  Loss:  4.0098 |Global loss: 5.605| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 1.2864
Epoch: 1|  Loss:  3.9954 |Global loss: 5.6162| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 2|  NKD Loss: 1.3078
Epoch: 2|  Loss:  3.9872 |Global loss: 5.6103| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 3|  NKD Loss: 1.3012
Epoch: 3|  Loss:  3.9791 |Global loss: 5.6062| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 1.3383
Epoch: 0|  Loss:  3.5235 |Global loss: 5.6533| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.3081
Epoch: 1|  Loss:  3.5169 |Global loss: 5.6648| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 2|  NKD Loss: 1.302
Epoch: 2|  Loss:  3.4951 |Global loss: 5.6665| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 3|  NKD Loss: 1.289
Epoch: 3|  Loss:  3.4509 |Global loss: 5.6722| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 0|  NKD Loss: 1.2805
Epoch: 0|  Loss:  4.1456 |Global loss: 5.5892| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 1.2463
Epoch: 1|  Loss:  4.1164 |Global loss: 5.5974| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 1.289
Epoch: 2|  Loss:  4.0976 |Global loss: 5.5775| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 1.2927
Epoch: 3|  Loss:  4.0914 |Global loss: 5.5632| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 1.2797
Epoch: 0|  Loss:  4.3964 |Global loss: 5.5644| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.287
Epoch: 1|  Loss:  4.3883 |Global loss: 5.5606| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.2918
Epoch: 2|  Loss:  4.3882 |Global loss: 5.5537| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.3015
Epoch: 3|  Loss:  4.3902 |Global loss: 5.5555| Local H loss: 0.0062  | Global H loss: 0.0062
------------------------- time cost ------------------------- 3.1034955978393555
Chosen Clients:  [14, 13, 5, 8, 6, 2]

-------------Round number: 86-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 70.384, 92.026, 102.115, 81.689, 67.777, 88.493, 74.798, 95.756, 75.921, 92.879, 92.106, 76.208, 87.562, 93.511]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1283
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7016
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0865
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3096
Epoch: 0|  Loss:  3.9704 |Global loss: 5.6052| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.3027
Epoch: 1|  Loss:  3.9559 |Global loss: 5.6174| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 1.3058
Epoch: 2|  Loss:  3.9397 |Global loss: 5.6114| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.3094
Epoch: 3|  Loss:  3.9359 |Global loss: 5.6086| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 1.3069
Epoch: 0|  Loss:  4.0865 |Global loss: 5.5845| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 1|  NKD Loss: 1.281
Epoch: 1|  Loss:  4.0639 |Global loss: 5.6036| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.3086
Epoch: 2|  Loss:  4.0567 |Global loss: 5.587| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 3|  NKD Loss: 1.3017
Epoch: 3|  Loss:  4.0405 |Global loss: 5.5803| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 0|  NKD Loss: 1.2994
Epoch: 0|  Loss:  4.3963 |Global loss: 5.5585| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2947
Epoch: 1|  Loss:  4.3957 |Global loss: 5.5719| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.2685
Epoch: 2|  Loss:  4.3897 |Global loss: 5.5774| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.3008
Epoch: 3|  Loss:  4.3787 |Global loss: 5.5601| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.3005
Epoch: 0|  Loss:  3.7986 |Global loss: 5.6112| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.3091
Epoch: 1|  Loss:  3.7661 |Global loss: 5.607| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 1.2966
Epoch: 2|  Loss:  3.7582 |Global loss: 5.6214| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 1.2883
Epoch: 3|  Loss:  3.7383 |Global loss: 5.6259| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.289
Epoch: 0|  Loss:  4.1226 |Global loss: 5.6002| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 1|  NKD Loss: 1.3026
Epoch: 1|  Loss:  4.102 |Global loss: 5.5799| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 2|  NKD Loss: 1.2939
Epoch: 2|  Loss:  4.102 |Global loss: 5.5814| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 1.2848
Epoch: 3|  Loss:  4.0763 |Global loss: 5.5869| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 0|  NKD Loss: 1.2879
Epoch: 0|  Loss:  3.9971 |Global loss: 5.5973| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 1.2997
Epoch: 1|  Loss:  3.9913 |Global loss: 5.6037| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 2|  NKD Loss: 1.3019
Epoch: 2|  Loss:  3.9647 |Global loss: 5.5984| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2711
Epoch: 3|  Loss:  3.9661 |Global loss: 5.6224| Local H loss: 0.0098  | Global H loss: 0.0098
------------------------- time cost ------------------------- 2.905097246170044
Chosen Clients:  [5, 9, 8, 3, 7, 1]

-------------Round number: 87-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 70.384, 92.742, 102.115, 81.689, 70.995, 90.733, 74.798, 96.733, 75.921, 92.879, 92.106, 76.208, 91.555, 94.783]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.1064
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7085
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0871
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.27
Epoch: 0|  Loss:  4.3591 |Global loss: 5.5752| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 1|  NKD Loss: 1.2687
Epoch: 1|  Loss:  4.3554 |Global loss: 5.5768| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.2988
Epoch: 2|  Loss:  4.3408 |Global loss: 5.55| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.289
Epoch: 3|  Loss:  4.3357 |Global loss: 5.5435| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.2724
Epoch: 0|  Loss:  4.3192 |Global loss: 5.5808| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2856
Epoch: 1|  Loss:  4.2936 |Global loss: 5.578| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.2963
Epoch: 2|  Loss:  4.3019 |Global loss: 5.5705| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 3|  NKD Loss: 1.2798
Epoch: 3|  Loss:  4.2949 |Global loss: 5.5795| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 1.3122
Epoch: 0|  Loss:  3.7437 |Global loss: 5.616| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 1.3018
Epoch: 1|  Loss:  3.7195 |Global loss: 5.6216| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 2|  NKD Loss: 1.2911
Epoch: 2|  Loss:  3.6991 |Global loss: 5.6299| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 1.2922
Epoch: 3|  Loss:  3.6774 |Global loss: 5.6345| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 1.3366
Epoch: 0|  Loss:  3.4881 |Global loss: 5.643| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 1|  NKD Loss: 1.3084
Epoch: 1|  Loss:  3.4453 |Global loss: 5.6696| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 2|  NKD Loss: 1.311
Epoch: 2|  Loss:  3.4481 |Global loss: 5.6587| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 3|  NKD Loss: 1.2834
Epoch: 3|  Loss:  3.4218 |Global loss: 5.6812| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 0|  NKD Loss: 1.3234
Epoch: 0|  Loss:  4.3459 |Global loss: 5.6136| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.3022
Epoch: 1|  Loss:  4.324 |Global loss: 5.6113| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.3235
Epoch: 2|  Loss:  4.3209 |Global loss: 5.5906| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.3223
Epoch: 3|  Loss:  4.3064 |Global loss: 5.5682| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.2611
Epoch: 0|  Loss:  4.3825 |Global loss: 5.5877| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.2968
Epoch: 1|  Loss:  4.378 |Global loss: 5.5623| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 2|  NKD Loss: 1.2842
Epoch: 2|  Loss:  4.3785 |Global loss: 5.5616| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 3|  NKD Loss: 1.2654
Epoch: 3|  Loss:  4.3626 |Global loss: 5.5748| Local H loss: 0.0061  | Global H loss: 0.0061
------------------------- time cost ------------------------- 2.9453752040863037
Chosen Clients:  [8, 12, 11, 6, 1, 3]

-------------Round number: 88-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 73.47, 92.742, 102.269, 81.689, 74.35, 90.733, 79.811, 97.737, 80.438, 92.879, 92.106, 76.208, 91.555, 94.783]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.0887
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7180
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0789
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3047
Epoch: 0|  Loss:  3.6771 |Global loss: 5.6225| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.3008
Epoch: 1|  Loss:  3.6606 |Global loss: 5.6343| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 1.2941
Epoch: 2|  Loss:  3.646 |Global loss: 5.6366| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 3|  NKD Loss: 1.2984
Epoch: 3|  Loss:  3.6276 |Global loss: 5.6395| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 0|  NKD Loss: 1.2841
Epoch: 0|  Loss:  4.2975 |Global loss: 5.5756| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2797
Epoch: 1|  Loss:  4.2949 |Global loss: 5.571| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.3062
Epoch: 2|  Loss:  4.2846 |Global loss: 5.5661| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.2804
Epoch: 3|  Loss:  4.2803 |Global loss: 5.5775| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 0|  NKD Loss: 1.2783
Epoch: 0|  Loss:  4.0535 |Global loss: 5.5836| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 1.278
Epoch: 1|  Loss:  4.0432 |Global loss: 5.5681| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.2777
Epoch: 2|  Loss:  4.0071 |Global loss: 5.5696| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2738
Epoch: 3|  Loss:  3.9867 |Global loss: 5.5755| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 0|  NKD Loss: 1.2873
Epoch: 0|  Loss:  4.0748 |Global loss: 5.5929| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.2839
Epoch: 1|  Loss:  4.0505 |Global loss: 5.5906| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.2974
Epoch: 2|  Loss:  4.0477 |Global loss: 5.5863| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 3|  NKD Loss: 1.2825
Epoch: 3|  Loss:  4.0347 |Global loss: 5.5892| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 0|  NKD Loss: 1.2711
Epoch: 0|  Loss:  4.3464 |Global loss: 5.5727| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.2782
Epoch: 1|  Loss:  4.3447 |Global loss: 5.5761| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 2|  NKD Loss: 1.2689
Epoch: 2|  Loss:  4.3388 |Global loss: 5.5642| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.2865
Epoch: 3|  Loss:  4.323 |Global loss: 5.5518| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.3279
Epoch: 0|  Loss:  3.4307 |Global loss: 5.6535| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 1|  NKD Loss: 1.2973
Epoch: 1|  Loss:  3.4187 |Global loss: 5.6703| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 1.3065
Epoch: 2|  Loss:  3.3926 |Global loss: 5.6713| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 1.2885
Epoch: 3|  Loss:  3.3758 |Global loss: 5.6831| Local H loss: 0.0154  | Global H loss: 0.0154
------------------------- time cost ------------------------- 2.8013739585876465
Chosen Clients:  [13, 3, 6, 2, 12, 14]

-------------Round number: 89-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 76.781, 92.742, 102.57, 81.689, 74.35, 92.702, 79.811, 98.105, 80.438, 92.879, 93.867, 79.984, 91.555, 94.783]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.0630
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7244
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0766
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2859
Epoch: 0|  Loss:  4.0009 |Global loss: 5.5996| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 1.2893
Epoch: 1|  Loss:  4.0011 |Global loss: 5.6067| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2975
Epoch: 2|  Loss:  3.9798 |Global loss: 5.5858| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 1.287
Epoch: 3|  Loss:  3.9583 |Global loss: 5.5946| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 1.3173
Epoch: 0|  Loss:  3.4007 |Global loss: 5.6659| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 1|  NKD Loss: 1.3205
Epoch: 1|  Loss:  3.3602 |Global loss: 5.6637| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 2|  NKD Loss: 1.2997
Epoch: 2|  Loss:  3.3607 |Global loss: 5.6793| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2807
Epoch: 3|  Loss:  3.3377 |Global loss: 5.6833| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 1.2892
Epoch: 0|  Loss:  4.012 |Global loss: 5.5973| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 1|  NKD Loss: 1.2909
Epoch: 1|  Loss:  3.9996 |Global loss: 5.5803| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 2|  NKD Loss: 1.2951
Epoch: 2|  Loss:  3.9964 |Global loss: 5.5916| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 3|  NKD Loss: 1.2732
Epoch: 3|  Loss:  3.9781 |Global loss: 5.5997| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 0|  NKD Loss: 1.2873
Epoch: 0|  Loss:  3.9585 |Global loss: 5.6084| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2706
Epoch: 1|  Loss:  3.9543 |Global loss: 5.6235| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2898
Epoch: 2|  Loss:  3.9322 |Global loss: 5.6218| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 1.2856
Epoch: 3|  Loss:  3.9348 |Global loss: 5.6105| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.276
Epoch: 0|  Loss:  4.2491 |Global loss: 5.5898| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.2862
Epoch: 1|  Loss:  4.2492 |Global loss: 5.5692| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 2|  NKD Loss: 1.2908
Epoch: 2|  Loss:  4.2323 |Global loss: 5.5749| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 3|  NKD Loss: 1.3019
Epoch: 3|  Loss:  4.2304 |Global loss: 5.5529| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.301
Epoch: 0|  Loss:  3.9141 |Global loss: 5.6046| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 1.2849
Epoch: 1|  Loss:  3.9018 |Global loss: 5.6227| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 1.2957
Epoch: 2|  Loss:  3.8865 |Global loss: 5.6141| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 3|  NKD Loss: 1.299
Epoch: 3|  Loss:  3.8789 |Global loss: 5.6123| Local H loss: 0.0104  | Global H loss: 0.0104
------------------------- time cost ------------------------- 3.0487353801727295
Chosen Clients:  [12, 3, 13, 6, 11, 7]

-------------Round number: 90-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 76.781, 93.402, 103.302, 81.689, 74.35, 93.651, 79.811, 98.105, 80.438, 92.879, 93.867, 83.198, 93.36, 96.41]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.0401
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7294
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0781
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.273
Epoch: 0|  Loss:  4.2111 |Global loss: 5.5884| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.2832
Epoch: 1|  Loss:  4.197 |Global loss: 5.5725| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 1.2881
Epoch: 2|  Loss:  4.1911 |Global loss: 5.5749| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 3|  NKD Loss: 1.2873
Epoch: 3|  Loss:  4.1859 |Global loss: 5.5695| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 0|  NKD Loss: 1.3212
Epoch: 0|  Loss:  3.3626 |Global loss: 5.6679| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 1|  NKD Loss: 1.3092
Epoch: 1|  Loss:  3.3439 |Global loss: 5.6709| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 2|  NKD Loss: 1.2821
Epoch: 2|  Loss:  3.2997 |Global loss: 5.6846| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 3|  NKD Loss: 1.2675
Epoch: 3|  Loss:  3.3005 |Global loss: 5.6937| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.2818
Epoch: 0|  Loss:  3.9277 |Global loss: 5.598| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 1.2932
Epoch: 1|  Loss:  3.9319 |Global loss: 5.6035| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.289
Epoch: 2|  Loss:  3.9027 |Global loss: 5.5984| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 3|  NKD Loss: 1.2754
Epoch: 3|  Loss:  3.8929 |Global loss: 5.6055| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 1.2923
Epoch: 0|  Loss:  3.9549 |Global loss: 5.6033| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.2802
Epoch: 1|  Loss:  3.9552 |Global loss: 5.5958| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 2|  NKD Loss: 1.2926
Epoch: 2|  Loss:  3.9385 |Global loss: 5.5958| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.2735
Epoch: 3|  Loss:  3.9236 |Global loss: 5.6134| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 0|  NKD Loss: 1.2741
Epoch: 0|  Loss:  3.9506 |Global loss: 5.5843| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.2675
Epoch: 1|  Loss:  3.9285 |Global loss: 5.5764| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 2|  NKD Loss: 1.2547
Epoch: 2|  Loss:  3.9126 |Global loss: 5.5981| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 1.2761
Epoch: 3|  Loss:  3.8909 |Global loss: 5.5856| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 0|  NKD Loss: 1.2861
Epoch: 0|  Loss:  4.2685 |Global loss: 5.5861| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.2776
Epoch: 1|  Loss:  4.2591 |Global loss: 5.5797| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 2|  NKD Loss: 1.3003
Epoch: 2|  Loss:  4.2454 |Global loss: 5.5682| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 3|  NKD Loss: 1.2817
Epoch: 3|  Loss:  4.2468 |Global loss: 5.5766| Local H loss: 0.0076  | Global H loss: 0.0076
------------------------- time cost ------------------------- 3.059464454650879
Chosen Clients:  [6, 0, 14, 5, 8, 2]

-------------Round number: 91-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [71.628, 76.781, 93.402, 103.446, 81.689, 74.35, 94.967, 84.306, 98.105, 80.438, 92.879, 95.711, 85.504, 95.492, 96.41]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.0179
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7362
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0783
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3063
Epoch: 0|  Loss:  3.9069 |Global loss: 5.5922| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.2691
Epoch: 1|  Loss:  3.8996 |Global loss: 5.6107| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 2|  NKD Loss: 1.2903
Epoch: 2|  Loss:  3.8833 |Global loss: 5.6147| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 1.2865
Epoch: 3|  Loss:  3.8748 |Global loss: 5.6129| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 0|  NKD Loss: 1.2686
Epoch: 0|  Loss:  4.3595 |Global loss: 5.5627| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.2724
Epoch: 1|  Loss:  4.3618 |Global loss: 5.5569| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 2|  NKD Loss: 1.288
Epoch: 2|  Loss:  4.3481 |Global loss: 5.5473| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.2771
Epoch: 3|  Loss:  4.3524 |Global loss: 5.5481| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 0|  NKD Loss: 1.2835
Epoch: 0|  Loss:  3.8756 |Global loss: 5.6067| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 1.296
Epoch: 1|  Loss:  3.8443 |Global loss: 5.6188| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 1.29
Epoch: 2|  Loss:  3.8362 |Global loss: 5.6104| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 1.301
Epoch: 3|  Loss:  3.8419 |Global loss: 5.608| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 0|  NKD Loss: 1.2781
Epoch: 0|  Loss:  4.3096 |Global loss: 5.5649| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2795
Epoch: 1|  Loss:  4.3108 |Global loss: 5.5517| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.2802
Epoch: 2|  Loss:  4.2901 |Global loss: 5.5476| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.2727
Epoch: 3|  Loss:  4.2912 |Global loss: 5.5612| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.2975
Epoch: 0|  Loss:  3.6262 |Global loss: 5.6324| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 1|  NKD Loss: 1.2972
Epoch: 1|  Loss:  3.6165 |Global loss: 5.6391| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 2|  NKD Loss: 1.2936
Epoch: 2|  Loss:  3.5957 |Global loss: 5.6404| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 3|  NKD Loss: 1.287
Epoch: 3|  Loss:  3.5785 |Global loss: 5.6545| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 1.2903
Epoch: 0|  Loss:  3.9149 |Global loss: 5.6102| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 1|  NKD Loss: 1.2761
Epoch: 1|  Loss:  3.921 |Global loss: 5.6067| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 1.2863
Epoch: 2|  Loss:  3.9063 |Global loss: 5.6124| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2903
Epoch: 3|  Loss:  3.9013 |Global loss: 5.6126| Local H loss: 0.0104  | Global H loss: 0.0104
------------------------- time cost ------------------------- 2.7971651554107666
Chosen Clients:  [12, 9, 8, 4, 7, 3]

-------------Round number: 92-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [74.061, 76.781, 93.808, 103.446, 81.689, 77.964, 95.866, 84.306, 99.106, 80.438, 92.879, 95.711, 85.504, 95.492, 97.33]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 4.0025
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7413
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0748
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2846
Epoch: 0|  Loss:  4.1641 |Global loss: 5.5818| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 1.2855
Epoch: 1|  Loss:  4.1579 |Global loss: 5.5766| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 2|  NKD Loss: 1.2867
Epoch: 2|  Loss:  4.1504 |Global loss: 5.5678| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 3|  NKD Loss: 1.2928
Epoch: 3|  Loss:  4.1446 |Global loss: 5.5762| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 1.2601
Epoch: 0|  Loss:  4.2642 |Global loss: 5.5916| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.271
Epoch: 1|  Loss:  4.2506 |Global loss: 5.574| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 1.2606
Epoch: 2|  Loss:  4.2398 |Global loss: 5.5843| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.2883
Epoch: 3|  Loss:  4.2443 |Global loss: 5.5708| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 0|  NKD Loss: 1.3192
Epoch: 0|  Loss:  3.5821 |Global loss: 5.6218| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 1.3159
Epoch: 1|  Loss:  3.5857 |Global loss: 5.6374| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 2|  NKD Loss: 1.3046
Epoch: 2|  Loss:  3.5625 |Global loss: 5.6505| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.2933
Epoch: 3|  Loss:  3.5364 |Global loss: 5.6538| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.2509
Epoch: 0|  Loss:  4.2465 |Global loss: 5.5772| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.2754
Epoch: 1|  Loss:  4.2318 |Global loss: 5.5511| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 2|  NKD Loss: 1.2766
Epoch: 2|  Loss:  4.2253 |Global loss: 5.5466| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.272
Epoch: 3|  Loss:  4.225 |Global loss: 5.5626| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.2734
Epoch: 0|  Loss:  4.2148 |Global loss: 5.5783| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 1.2827
Epoch: 1|  Loss:  4.2038 |Global loss: 5.5655| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 1.2709
Epoch: 2|  Loss:  4.1859 |Global loss: 5.5779| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 1.2692
Epoch: 3|  Loss:  4.1865 |Global loss: 5.5746| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 1.3291
Epoch: 0|  Loss:  3.329 |Global loss: 5.6629| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 1|  NKD Loss: 1.2934
Epoch: 1|  Loss:  3.3158 |Global loss: 5.6869| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 1.2869
Epoch: 2|  Loss:  3.2826 |Global loss: 5.6872| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 3|  NKD Loss: 1.2681
Epoch: 3|  Loss:  3.2765 |Global loss: 5.6997| Local H loss: 0.0162  | Global H loss: 0.0162
------------------------- time cost ------------------------- 3.24989914894104
Chosen Clients:  [4, 8, 9, 12, 0, 11]

-------------Round number: 93-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [74.061, 76.781, 93.808, 103.695, 85.552, 77.964, 95.866, 87.416, 99.933, 84.727, 92.879, 95.711, 86.584, 95.492, 97.33]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9898
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7488
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0713
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2681
Epoch: 0|  Loss:  4.1914 |Global loss: 5.5697| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 1|  NKD Loss: 1.2695
Epoch: 1|  Loss:  4.1823 |Global loss: 5.5559| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 1.2729
Epoch: 2|  Loss:  4.1757 |Global loss: 5.5546| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 1.285
Epoch: 3|  Loss:  4.1607 |Global loss: 5.5489| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 1.3136
Epoch: 0|  Loss:  3.5506 |Global loss: 5.6416| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 1.2853
Epoch: 1|  Loss:  3.5405 |Global loss: 5.6679| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 1.3035
Epoch: 2|  Loss:  3.525 |Global loss: 5.6584| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.2929
Epoch: 3|  Loss:  3.4956 |Global loss: 5.6608| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 0|  NKD Loss: 1.2558
Epoch: 0|  Loss:  4.2166 |Global loss: 5.5835| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.2772
Epoch: 1|  Loss:  4.2108 |Global loss: 5.5754| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 2|  NKD Loss: 1.2697
Epoch: 2|  Loss:  4.2021 |Global loss: 5.5768| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.2982
Epoch: 3|  Loss:  4.196 |Global loss: 5.5583| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 1.2686
Epoch: 0|  Loss:  4.1295 |Global loss: 5.5903| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 1|  NKD Loss: 1.2741
Epoch: 1|  Loss:  4.1251 |Global loss: 5.5923| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.2919
Epoch: 2|  Loss:  4.1138 |Global loss: 5.582| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.3047
Epoch: 3|  Loss:  4.1106 |Global loss: 5.575| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 0|  NKD Loss: 1.2698
Epoch: 0|  Loss:  4.3271 |Global loss: 5.5588| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 1|  NKD Loss: 1.2607
Epoch: 1|  Loss:  4.323 |Global loss: 5.5606| Local H loss: 0.0061  | Global H loss: 0.0061
Epoch: 2|  NKD Loss: 1.2841
Epoch: 2|  Loss:  4.3239 |Global loss: 5.5497| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.2574
Epoch: 3|  Loss:  4.3121 |Global loss: 5.5637| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 0|  NKD Loss: 1.2575
Epoch: 0|  Loss:  3.8672 |Global loss: 5.5908| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 1|  NKD Loss: 1.2853
Epoch: 1|  Loss:  3.8379 |Global loss: 5.5803| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 1.2593
Epoch: 2|  Loss:  3.8224 |Global loss: 5.5992| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.2774
Epoch: 3|  Loss:  3.797 |Global loss: 5.5948| Local H loss: 0.0127  | Global H loss: 0.0127
------------------------- time cost ------------------------- 3.060821533203125
Chosen Clients:  [0, 13, 9, 8, 12, 5]

-------------Round number: 94-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [76.818, 76.781, 93.808, 103.695, 88.989, 77.964, 95.866, 87.416, 100.264, 86.908, 92.879, 96.9, 87.813, 95.492, 97.33]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9743
Averaged Test Accurancy: 0.0544
Averaged Test AUC: 0.7550
Averaged Test F1_score: 0.0133
Averaged Test Recal score: 0.0879
Std Test Accurancy: 0.0166
Std Test AUC: 0.0678
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2689
Epoch: 0|  Loss:  4.2995 |Global loss: 5.561| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 1|  NKD Loss: 1.2786
Epoch: 1|  Loss:  4.2914 |Global loss: 5.5448| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 1.2588
Epoch: 2|  Loss:  4.2881 |Global loss: 5.5721| Local H loss: 0.0062  | Global H loss: 0.0062
Epoch: 3|  NKD Loss: 1.2815
Epoch: 3|  Loss:  4.2798 |Global loss: 5.5409| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 1.2853
Epoch: 0|  Loss:  3.8782 |Global loss: 5.5962| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 1|  NKD Loss: 1.2862
Epoch: 1|  Loss:  3.8566 |Global loss: 5.6096| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 1.2909
Epoch: 2|  Loss:  3.8363 |Global loss: 5.6031| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.2744
Epoch: 3|  Loss:  3.8184 |Global loss: 5.6074| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 0|  NKD Loss: 1.2677
Epoch: 0|  Loss:  4.1839 |Global loss: 5.5762| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.288
Epoch: 1|  Loss:  4.1735 |Global loss: 5.5814| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.2969
Epoch: 2|  Loss:  4.1777 |Global loss: 5.5685| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.3011
Epoch: 3|  Loss:  4.1595 |Global loss: 5.56| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 0|  NKD Loss: 1.3256
Epoch: 0|  Loss:  3.5368 |Global loss: 5.6418| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 1|  NKD Loss: 1.2981
Epoch: 1|  Loss:  3.4894 |Global loss: 5.6729| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 1.3114
Epoch: 2|  Loss:  3.4906 |Global loss: 5.6622| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.3026
Epoch: 3|  Loss:  3.4753 |Global loss: 5.6671| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 0|  NKD Loss: 1.2759
Epoch: 0|  Loss:  4.1036 |Global loss: 5.5922| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 1|  NKD Loss: 1.2929
Epoch: 1|  Loss:  4.0835 |Global loss: 5.5833| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 1.2993
Epoch: 2|  Loss:  4.0802 |Global loss: 5.5806| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.3007
Epoch: 3|  Loss:  4.0774 |Global loss: 5.5849| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 0|  NKD Loss: 1.2719
Epoch: 0|  Loss:  4.2702 |Global loss: 5.558| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 1.2734
Epoch: 1|  Loss:  4.2609 |Global loss: 5.5602| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 1.286
Epoch: 2|  Loss:  4.2545 |Global loss: 5.5462| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 3|  NKD Loss: 1.2838
Epoch: 3|  Loss:  4.2411 |Global loss: 5.5457| Local H loss: 0.0067  | Global H loss: 0.0067
------------------------- time cost ------------------------- 2.982707977294922
Chosen Clients:  [3, 7, 8, 14, 0, 4]

-------------Round number: 95-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.067, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [79.548, 76.781, 93.808, 103.695, 88.989, 82.637, 95.866, 87.416, 100.932, 89.798, 92.879, 96.9, 88.342, 97.073, 97.33]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.045, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.107, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9546
Averaged Test Accurancy: 0.0556
Averaged Test AUC: 0.7622
Averaged Test F1_score: 0.0157
Averaged Test Recal score: 0.0895
Std Test Accurancy: 0.0169
Std Test AUC: 0.0621
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3466
Epoch: 0|  Loss:  3.3207 |Global loss: 5.6519| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 1|  NKD Loss: 1.3062
Epoch: 1|  Loss:  3.276 |Global loss: 5.6773| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 2|  NKD Loss: 1.2972
Epoch: 2|  Loss:  3.2616 |Global loss: 5.6816| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 3|  NKD Loss: 1.2753
Epoch: 3|  Loss:  3.2447 |Global loss: 5.6945| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 0|  NKD Loss: 1.2841
Epoch: 0|  Loss:  4.162 |Global loss: 5.5742| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.2596
Epoch: 1|  Loss:  4.1591 |Global loss: 5.5816| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.2637
Epoch: 2|  Loss:  4.1368 |Global loss: 5.5792| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.2904
Epoch: 3|  Loss:  4.129 |Global loss: 5.564| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 0|  NKD Loss: 1.3484
Epoch: 0|  Loss:  3.4964 |Global loss: 5.6339| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 1.3242
Epoch: 1|  Loss:  3.4749 |Global loss: 5.6592| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.3052
Epoch: 2|  Loss:  3.4623 |Global loss: 5.6706| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 3|  NKD Loss: 1.2974
Epoch: 3|  Loss:  3.4378 |Global loss: 5.6737| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 0|  NKD Loss: 1.2992
Epoch: 0|  Loss:  3.833 |Global loss: 5.6104| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.3004
Epoch: 1|  Loss:  3.8101 |Global loss: 5.6163| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.3099
Epoch: 2|  Loss:  3.7933 |Global loss: 5.6124| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.301
Epoch: 3|  Loss:  3.7881 |Global loss: 5.6063| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 0|  NKD Loss: 1.2559
Epoch: 0|  Loss:  4.2498 |Global loss: 5.5677| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2709
Epoch: 1|  Loss:  4.2497 |Global loss: 5.5379| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 1.2734
Epoch: 2|  Loss:  4.2474 |Global loss: 5.5485| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.2774
Epoch: 3|  Loss:  4.2353 |Global loss: 5.5445| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 0|  NKD Loss: 1.2484
Epoch: 0|  Loss:  4.1369 |Global loss: 5.5755| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.2702
Epoch: 1|  Loss:  4.1237 |Global loss: 5.5539| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 2|  NKD Loss: 1.2828
Epoch: 2|  Loss:  4.1121 |Global loss: 5.5545| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.2608
Epoch: 3|  Loss:  4.0924 |Global loss: 5.5704| Local H loss: 0.0083  | Global H loss: 0.0083
------------------------- time cost ------------------------- 2.9328713417053223
Chosen Clients:  [4, 3, 7, 13, 2, 12]

-------------Round number: 96-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.075, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [82.633, 76.781, 93.808, 103.708, 90.954, 82.637, 95.866, 88.884, 101.385, 89.798, 92.879, 96.9, 88.342, 97.073, 98.452]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.058, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.119, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9296
Averaged Test Accurancy: 0.0561
Averaged Test AUC: 0.7667
Averaged Test F1_score: 0.0166
Averaged Test Recal score: 0.0903
Std Test Accurancy: 0.0173
Std Test AUC: 0.0598
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2612
Epoch: 0|  Loss:  4.0688 |Global loss: 5.5638| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.2737
Epoch: 1|  Loss:  4.0616 |Global loss: 5.5618| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.2616
Epoch: 2|  Loss:  4.0454 |Global loss: 5.5749| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.2785
Epoch: 3|  Loss:  4.0252 |Global loss: 5.5603| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 1.3086
Epoch: 0|  Loss:  3.257 |Global loss: 5.6716| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 1|  NKD Loss: 1.2834
Epoch: 1|  Loss:  3.2391 |Global loss: 5.6918| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.2785
Epoch: 2|  Loss:  3.2444 |Global loss: 5.6903| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 3|  NKD Loss: 1.2679
Epoch: 3|  Loss:  3.2238 |Global loss: 5.6999| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 0|  NKD Loss: 1.246
Epoch: 0|  Loss:  4.1043 |Global loss: 5.5952| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 1|  NKD Loss: 1.2754
Epoch: 1|  Loss:  4.0997 |Global loss: 5.5745| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 1.2744
Epoch: 2|  Loss:  4.0869 |Global loss: 5.5822| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.283
Epoch: 3|  Loss:  4.0773 |Global loss: 5.571| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 0|  NKD Loss: 1.2677
Epoch: 0|  Loss:  3.7768 |Global loss: 5.6205| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 1|  NKD Loss: 1.2645
Epoch: 1|  Loss:  3.7634 |Global loss: 5.6164| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 2|  NKD Loss: 1.2945
Epoch: 2|  Loss:  3.7502 |Global loss: 5.6086| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.3001
Epoch: 3|  Loss:  3.7275 |Global loss: 5.5908| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 1.2847
Epoch: 0|  Loss:  3.8916 |Global loss: 5.6079| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 1.2796
Epoch: 1|  Loss:  3.8809 |Global loss: 5.6261| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 2|  NKD Loss: 1.2796
Epoch: 2|  Loss:  3.8776 |Global loss: 5.6146| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 3|  NKD Loss: 1.2961
Epoch: 3|  Loss:  3.8572 |Global loss: 5.6092| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 1.2854
Epoch: 0|  Loss:  4.0485 |Global loss: 5.5948| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 1|  NKD Loss: 1.267
Epoch: 1|  Loss:  4.0576 |Global loss: 5.6041| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.2757
Epoch: 2|  Loss:  4.0485 |Global loss: 5.5986| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.2892
Epoch: 3|  Loss:  4.036 |Global loss: 5.6001| Local H loss: 0.0087  | Global H loss: 0.0087
------------------------- time cost ------------------------- 2.815582752227783
Chosen Clients:  [9, 11, 6, 1, 4, 0]

-------------Round number: 97-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.075, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [82.633, 76.781, 94.465, 104.08, 92.858, 82.637, 95.866, 90.655, 101.385, 89.798, 92.879, 96.9, 88.867, 97.988, 98.452]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.058, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.119, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.9069
Averaged Test Accurancy: 0.0561
Averaged Test AUC: 0.7701
Averaged Test F1_score: 0.0166
Averaged Test Recal score: 0.0903
Std Test Accurancy: 0.0173
Std Test AUC: 0.0601
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2647
Epoch: 0|  Loss:  4.1299 |Global loss: 5.5932| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.2804
Epoch: 1|  Loss:  4.1338 |Global loss: 5.5805| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 2|  NKD Loss: 1.2921
Epoch: 2|  Loss:  4.1396 |Global loss: 5.5671| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 3|  NKD Loss: 1.275
Epoch: 3|  Loss:  4.1209 |Global loss: 5.5845| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 0|  NKD Loss: 1.2801
Epoch: 0|  Loss:  3.7828 |Global loss: 5.5851| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 1|  NKD Loss: 1.2725
Epoch: 1|  Loss:  3.7409 |Global loss: 5.5932| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.2666
Epoch: 2|  Loss:  3.7349 |Global loss: 5.6015| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.2734
Epoch: 3|  Loss:  3.7009 |Global loss: 5.6033| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 0|  NKD Loss: 1.2612
Epoch: 0|  Loss:  3.8515 |Global loss: 5.6159| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 1|  NKD Loss: 1.2911
Epoch: 1|  Loss:  3.8367 |Global loss: 5.601| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 1.2924
Epoch: 2|  Loss:  3.8179 |Global loss: 5.594| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 1.276
Epoch: 3|  Loss:  3.7958 |Global loss: 5.61| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.258
Epoch: 0|  Loss:  4.2937 |Global loss: 5.5684| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2682
Epoch: 1|  Loss:  4.2893 |Global loss: 5.5569| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 2|  NKD Loss: 1.2706
Epoch: 2|  Loss:  4.287 |Global loss: 5.5454| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 3|  NKD Loss: 1.278
Epoch: 3|  Loss:  4.288 |Global loss: 5.547| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 0|  NKD Loss: 1.2533
Epoch: 0|  Loss:  4.0041 |Global loss: 5.5824| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 1|  NKD Loss: 1.2734
Epoch: 1|  Loss:  3.9879 |Global loss: 5.5682| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 1.2543
Epoch: 2|  Loss:  3.971 |Global loss: 5.5878| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 3|  NKD Loss: 1.2454
Epoch: 3|  Loss:  3.9566 |Global loss: 5.5912| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 0|  NKD Loss: 1.2587
Epoch: 0|  Loss:  4.2123 |Global loss: 5.5552| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 1|  NKD Loss: 1.25
Epoch: 1|  Loss:  4.209 |Global loss: 5.5653| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.2593
Epoch: 2|  Loss:  4.205 |Global loss: 5.5626| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 3|  NKD Loss: 1.2626
Epoch: 3|  Loss:  4.1862 |Global loss: 5.5543| Local H loss: 0.0066  | Global H loss: 0.0066
------------------------- time cost ------------------------- 2.825817823410034
Chosen Clients:  [13, 6, 0, 1, 2, 3]

-------------Round number: 98-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.075, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [85.255, 81.505, 94.465, 104.08, 94.495, 82.637, 96.615, 90.655, 101.385, 91.653, 92.879, 97.838, 88.867, 97.988, 98.452]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.058, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.119, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.8983
Averaged Test Accurancy: 0.0561
Averaged Test AUC: 0.7771
Averaged Test F1_score: 0.0166
Averaged Test Recal score: 0.0903
Std Test Accurancy: 0.0173
Std Test AUC: 0.0532
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3092
Epoch: 0|  Loss:  3.7097 |Global loss: 5.6006| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 1|  NKD Loss: 1.305
Epoch: 1|  Loss:  3.6988 |Global loss: 5.6027| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 2|  NKD Loss: 1.2893
Epoch: 2|  Loss:  3.6667 |Global loss: 5.6156| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.2903
Epoch: 3|  Loss:  3.6477 |Global loss: 5.621| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 0|  NKD Loss: 1.2938
Epoch: 0|  Loss:  3.7996 |Global loss: 5.6054| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2875
Epoch: 1|  Loss:  3.7913 |Global loss: 5.6076| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 1.2714
Epoch: 2|  Loss:  3.7643 |Global loss: 5.6235| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 1.2934
Epoch: 3|  Loss:  3.7568 |Global loss: 5.6071| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.2463
Epoch: 0|  Loss:  4.1778 |Global loss: 5.5652| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 1|  NKD Loss: 1.2475
Epoch: 1|  Loss:  4.1631 |Global loss: 5.5739| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 2|  NKD Loss: 1.2688
Epoch: 2|  Loss:  4.165 |Global loss: 5.5559| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 3|  NKD Loss: 1.2911
Epoch: 3|  Loss:  4.1597 |Global loss: 5.5377| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.267
Epoch: 0|  Loss:  4.2677 |Global loss: 5.5544| Local H loss: 0.0063  | Global H loss: 0.0063
Epoch: 1|  NKD Loss: 1.2818
Epoch: 1|  Loss:  4.2603 |Global loss: 5.5481| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.2898
Epoch: 2|  Loss:  4.2548 |Global loss: 5.533| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.2896
Epoch: 3|  Loss:  4.2519 |Global loss: 5.5455| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.2791
Epoch: 0|  Loss:  3.8655 |Global loss: 5.608| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 1|  NKD Loss: 1.2837
Epoch: 1|  Loss:  3.8509 |Global loss: 5.6144| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 1.2898
Epoch: 2|  Loss:  3.8369 |Global loss: 5.6155| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 3|  NKD Loss: 1.2823
Epoch: 3|  Loss:  3.8278 |Global loss: 5.6234| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.3298
Epoch: 0|  Loss:  3.2518 |Global loss: 5.6666| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 1|  NKD Loss: 1.3106
Epoch: 1|  Loss:  3.2236 |Global loss: 5.6673| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 2|  NKD Loss: 1.3019
Epoch: 2|  Loss:  3.1999 |Global loss: 5.6909| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.2608
Epoch: 3|  Loss:  3.1931 |Global loss: 5.6972| Local H loss: 0.017  | Global H loss: 0.017
------------------------- time cost ------------------------- 2.783458709716797
Chosen Clients:  [8, 13, 14, 9, 5, 2]

-------------Round number: 99-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.075, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [88.36, 85.436, 95.47, 104.286, 94.495, 82.637, 97.511, 90.655, 101.385, 91.653, 92.879, 97.838, 88.867, 99.095, 98.452]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.058, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.119, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.8711
Averaged Test Accurancy: 0.0561
Averaged Test AUC: 0.7828
Averaged Test F1_score: 0.0166
Averaged Test Recal score: 0.0903
Std Test Accurancy: 0.0173
Std Test AUC: 0.0488
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.3158
Epoch: 0|  Loss:  3.4532 |Global loss: 5.656| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 1.2919
Epoch: 1|  Loss:  3.4271 |Global loss: 5.686| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.2895
Epoch: 2|  Loss:  3.4181 |Global loss: 5.6782| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 3|  NKD Loss: 1.2907
Epoch: 3|  Loss:  3.406 |Global loss: 5.6805| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 0|  NKD Loss: 1.2851
Epoch: 0|  Loss:  3.6365 |Global loss: 5.6217| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 1.2766
Epoch: 1|  Loss:  3.6029 |Global loss: 5.6346| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 2|  NKD Loss: 1.2925
Epoch: 2|  Loss:  3.5871 |Global loss: 5.6263| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 3|  NKD Loss: 1.3079
Epoch: 3|  Loss:  3.5645 |Global loss: 5.6282| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 0|  NKD Loss: 1.2853
Epoch: 0|  Loss:  3.7673 |Global loss: 5.6173| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 1|  NKD Loss: 1.3044
Epoch: 1|  Loss:  3.7469 |Global loss: 5.613| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 1.2923
Epoch: 2|  Loss:  3.7402 |Global loss: 5.6175| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 3|  NKD Loss: 1.2995
Epoch: 3|  Loss:  3.731 |Global loss: 5.6178| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 0|  NKD Loss: 1.2772
Epoch: 0|  Loss:  4.1005 |Global loss: 5.5945| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 1|  NKD Loss: 1.2708
Epoch: 1|  Loss:  4.0982 |Global loss: 5.5897| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 1.2976
Epoch: 2|  Loss:  4.0938 |Global loss: 5.5801| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 3|  NKD Loss: 1.2792
Epoch: 3|  Loss:  4.0862 |Global loss: 5.5913| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 0|  NKD Loss: 1.2561
Epoch: 0|  Loss:  4.2169 |Global loss: 5.5585| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 1|  NKD Loss: 1.2602
Epoch: 1|  Loss:  4.2048 |Global loss: 5.5603| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 2|  NKD Loss: 1.2878
Epoch: 2|  Loss:  4.1919 |Global loss: 5.5436| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.2584
Epoch: 3|  Loss:  4.1887 |Global loss: 5.5628| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.2973
Epoch: 0|  Loss:  3.8302 |Global loss: 5.6058| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 1|  NKD Loss: 1.2821
Epoch: 1|  Loss:  3.8134 |Global loss: 5.616| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.2891
Epoch: 2|  Loss:  3.808 |Global loss: 5.62| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 3|  NKD Loss: 1.291
Epoch: 3|  Loss:  3.7968 |Global loss: 5.6129| Local H loss: 0.0113  | Global H loss: 0.0113
------------------------- time cost ------------------------- 2.7478857040405273
Chosen Clients:  [2, 9, 8, 1, 10, 6]

-------------Round number: 100-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.075, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [88.36, 85.436, 96.755, 104.286, 94.495, 86.192, 97.511, 90.655, 101.632, 92.902, 92.879, 97.838, 88.867, 99.873, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.058, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.119, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.8532
Averaged Test Accurancy: 0.0561
Averaged Test AUC: 0.7872
Averaged Test F1_score: 0.0166
Averaged Test Recal score: 0.0903
Std Test Accurancy: 0.0173
Std Test AUC: 0.0464
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2836
Epoch: 0|  Loss:  3.7912 |Global loss: 5.6212| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 1|  NKD Loss: 1.2925
Epoch: 1|  Loss:  3.7782 |Global loss: 5.6151| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 1.278
Epoch: 2|  Loss:  3.7734 |Global loss: 5.6283| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 3|  NKD Loss: 1.2611
Epoch: 3|  Loss:  3.7528 |Global loss: 5.6413| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 0|  NKD Loss: 1.2702
Epoch: 0|  Loss:  4.0696 |Global loss: 5.5944| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.2763
Epoch: 1|  Loss:  4.0613 |Global loss: 5.5929| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.277
Epoch: 2|  Loss:  4.0546 |Global loss: 5.6017| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 1.2805
Epoch: 3|  Loss:  4.045 |Global loss: 5.5952| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 0|  NKD Loss: 1.325
Epoch: 0|  Loss:  3.4175 |Global loss: 5.6616| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2925
Epoch: 1|  Loss:  3.4001 |Global loss: 5.6838| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.305
Epoch: 2|  Loss:  3.3881 |Global loss: 5.6812| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 3|  NKD Loss: 1.2823
Epoch: 3|  Loss:  3.3751 |Global loss: 5.6923| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 0|  NKD Loss: 1.2347
Epoch: 0|  Loss:  4.2195 |Global loss: 5.573| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 1|  NKD Loss: 1.242
Epoch: 1|  Loss:  4.2077 |Global loss: 5.5717| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 2|  NKD Loss: 1.2479
Epoch: 2|  Loss:  4.2085 |Global loss: 5.5699| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 3|  NKD Loss: 1.2639
Epoch: 3|  Loss:  4.2089 |Global loss: 5.5585| Local H loss: 0.0064  | Global H loss: 0.0064
Epoch: 0|  NKD Loss: 1.2581
Epoch: 0|  Loss:  4.0306 |Global loss: 5.594| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.2441
Epoch: 1|  Loss:  4.0174 |Global loss: 5.6067| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.2687
Epoch: 2|  Loss:  4.0059 |Global loss: 5.5741| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.2869
Epoch: 3|  Loss:  4.0039 |Global loss: 5.5694| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 0|  NKD Loss: 1.2853
Epoch: 0|  Loss:  3.7254 |Global loss: 5.6209| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 1|  NKD Loss: 1.2799
Epoch: 1|  Loss:  3.715 |Global loss: 5.6168| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.2836
Epoch: 2|  Loss:  3.6882 |Global loss: 5.6194| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 1.2887
Epoch: 3|  Loss:  3.6876 |Global loss: 5.6225| Local H loss: 0.0108  | Global H loss: 0.0108
------------------------- time cost ------------------------- 3.327742338180542
Chosen Clients:  [5, 9, 2, 0, 10, 4]

-------------Round number: 101-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [88.36, 87.948, 97.532, 104.286, 94.495, 86.192, 98.467, 90.655, 101.831, 94.227, 95.077, 97.838, 88.867, 99.873, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.8361
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.7917
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0447
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2448
Epoch: 0|  Loss:  4.1559 |Global loss: 5.5731| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2686
Epoch: 1|  Loss:  4.1634 |Global loss: 5.5554| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.2615
Epoch: 2|  Loss:  4.1397 |Global loss: 5.5583| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 3|  NKD Loss: 1.2733
Epoch: 3|  Loss:  4.1329 |Global loss: 5.5514| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 1.2817
Epoch: 0|  Loss:  4.0384 |Global loss: 5.5992| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.2752
Epoch: 1|  Loss:  4.0222 |Global loss: 5.5978| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.2748
Epoch: 2|  Loss:  4.0127 |Global loss: 5.6049| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.2915
Epoch: 3|  Loss:  4.0193 |Global loss: 5.5936| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 0|  NKD Loss: 1.3072
Epoch: 0|  Loss:  3.7546 |Global loss: 5.6119| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 1|  NKD Loss: 1.3003
Epoch: 1|  Loss:  3.7451 |Global loss: 5.6108| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 2|  NKD Loss: 1.2937
Epoch: 2|  Loss:  3.7309 |Global loss: 5.6219| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 3|  NKD Loss: 1.2903
Epoch: 3|  Loss:  3.7196 |Global loss: 5.6215| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 0|  NKD Loss: 1.2312
Epoch: 0|  Loss:  4.123 |Global loss: 5.5773| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 1|  NKD Loss: 1.2768
Epoch: 1|  Loss:  4.123 |Global loss: 5.5536| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.2643
Epoch: 2|  Loss:  4.1097 |Global loss: 5.5613| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.2667
Epoch: 3|  Loss:  4.1095 |Global loss: 5.5563| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 0|  NKD Loss: 1.2611
Epoch: 0|  Loss:  3.971 |Global loss: 5.5919| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 1|  NKD Loss: 1.2525
Epoch: 1|  Loss:  3.9563 |Global loss: 5.5893| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.2954
Epoch: 2|  Loss:  3.9515 |Global loss: 5.5648| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 3|  NKD Loss: 1.2777
Epoch: 3|  Loss:  3.9383 |Global loss: 5.5718| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 0|  NKD Loss: 1.2408
Epoch: 0|  Loss:  3.9415 |Global loss: 5.6005| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 1.2812
Epoch: 1|  Loss:  3.9136 |Global loss: 5.5773| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 1.2739
Epoch: 2|  Loss:  3.9096 |Global loss: 5.5821| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 1.2636
Epoch: 3|  Loss:  3.8883 |Global loss: 5.5846| Local H loss: 0.0102  | Global H loss: 0.0102
------------------------- time cost ------------------------- 3.0985655784606934
Chosen Clients:  [0, 11, 2, 6, 4, 10]

-------------Round number: 102-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [90.871, 87.948, 98.526, 104.286, 95.97, 89.29, 98.467, 90.655, 101.831, 94.777, 96.728, 97.838, 88.867, 99.873, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.8291
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.7974
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0409
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2632
Epoch: 0|  Loss:  4.0883 |Global loss: 5.5629| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2842
Epoch: 1|  Loss:  4.0899 |Global loss: 5.5523| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 2|  NKD Loss: 1.2636
Epoch: 2|  Loss:  4.0751 |Global loss: 5.5678| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 3|  NKD Loss: 1.2713
Epoch: 3|  Loss:  4.0654 |Global loss: 5.5597| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 0|  NKD Loss: 1.2644
Epoch: 0|  Loss:  3.6986 |Global loss: 5.6017| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2708
Epoch: 1|  Loss:  3.678 |Global loss: 5.6163| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.271
Epoch: 2|  Loss:  3.6548 |Global loss: 5.6111| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 3|  NKD Loss: 1.2841
Epoch: 3|  Loss:  3.6522 |Global loss: 5.6132| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 0|  NKD Loss: 1.3023
Epoch: 0|  Loss:  3.7247 |Global loss: 5.6104| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 1|  NKD Loss: 1.3008
Epoch: 1|  Loss:  3.7056 |Global loss: 5.618| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 2|  NKD Loss: 1.2559
Epoch: 2|  Loss:  3.6876 |Global loss: 5.6475| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.2995
Epoch: 3|  Loss:  3.6814 |Global loss: 5.6285| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 0|  NKD Loss: 1.3076
Epoch: 0|  Loss:  3.6904 |Global loss: 5.6014| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.3012
Epoch: 1|  Loss:  3.6584 |Global loss: 5.6151| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.2854
Epoch: 2|  Loss:  3.6456 |Global loss: 5.6294| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.2994
Epoch: 3|  Loss:  3.6366 |Global loss: 5.6198| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 0|  NKD Loss: 1.2813
Epoch: 0|  Loss:  3.8808 |Global loss: 5.5827| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 1.2787
Epoch: 1|  Loss:  3.8681 |Global loss: 5.5809| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.2799
Epoch: 2|  Loss:  3.8426 |Global loss: 5.5841| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 1.2907
Epoch: 3|  Loss:  3.8173 |Global loss: 5.5865| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.2504
Epoch: 0|  Loss:  3.9183 |Global loss: 5.5939| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 1|  NKD Loss: 1.2801
Epoch: 1|  Loss:  3.9187 |Global loss: 5.5716| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.2873
Epoch: 2|  Loss:  3.8886 |Global loss: 5.5691| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 1.2853
Epoch: 3|  Loss:  3.8893 |Global loss: 5.5679| Local H loss: 0.009  | Global H loss: 0.009
------------------------- time cost ------------------------- 3.00129771232605
Chosen Clients:  [0, 11, 5, 6, 7, 2]

-------------Round number: 103-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [92.725, 87.948, 99.344, 104.286, 96.617, 89.29, 99.07, 90.655, 101.831, 94.777, 97.632, 98.316, 88.867, 99.873, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7989
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8003
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0408
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2715
Epoch: 0|  Loss:  4.0452 |Global loss: 5.5613| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.2718
Epoch: 1|  Loss:  4.0346 |Global loss: 5.5632| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 2|  NKD Loss: 1.2798
Epoch: 2|  Loss:  4.0339 |Global loss: 5.558| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 3|  NKD Loss: 1.2806
Epoch: 3|  Loss:  4.034 |Global loss: 5.5568| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 0|  NKD Loss: 1.2837
Epoch: 0|  Loss:  3.6217 |Global loss: 5.6106| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 1|  NKD Loss: 1.2779
Epoch: 1|  Loss:  3.6227 |Global loss: 5.6174| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.2687
Epoch: 2|  Loss:  3.6027 |Global loss: 5.6393| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.2668
Epoch: 3|  Loss:  3.5832 |Global loss: 5.6401| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 0|  NKD Loss: 1.2505
Epoch: 0|  Loss:  4.0936 |Global loss: 5.5667| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.2685
Epoch: 1|  Loss:  4.0858 |Global loss: 5.5541| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 2|  NKD Loss: 1.2596
Epoch: 2|  Loss:  4.0719 |Global loss: 5.5601| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 3|  NKD Loss: 1.2649
Epoch: 3|  Loss:  4.0731 |Global loss: 5.5633| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 0|  NKD Loss: 1.318
Epoch: 0|  Loss:  3.6271 |Global loss: 5.6116| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 1|  NKD Loss: 1.2786
Epoch: 1|  Loss:  3.6092 |Global loss: 5.6378| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 2|  NKD Loss: 1.2886
Epoch: 2|  Loss:  3.5947 |Global loss: 5.636| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 3|  NKD Loss: 1.298
Epoch: 3|  Loss:  3.5769 |Global loss: 5.6275| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 1.2832
Epoch: 0|  Loss:  4.0597 |Global loss: 5.5675| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 1|  NKD Loss: 1.2769
Epoch: 1|  Loss:  4.0467 |Global loss: 5.5757| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.2786
Epoch: 2|  Loss:  4.0436 |Global loss: 5.5721| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.2765
Epoch: 3|  Loss:  4.0262 |Global loss: 5.5797| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 0|  NKD Loss: 1.2942
Epoch: 0|  Loss:  3.6785 |Global loss: 5.6223| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 1|  NKD Loss: 1.2959
Epoch: 1|  Loss:  3.6657 |Global loss: 5.6215| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 2|  NKD Loss: 1.2806
Epoch: 2|  Loss:  3.653 |Global loss: 5.6278| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.2665
Epoch: 3|  Loss:  3.6265 |Global loss: 5.6574| Local H loss: 0.0123  | Global H loss: 0.0123
------------------------- time cost ------------------------- 3.193131685256958
Chosen Clients:  [5, 13, 4, 12, 9, 10]

-------------Round number: 104-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [93.546, 87.948, 100.175, 104.286, 96.617, 90.717, 99.964, 91.684, 101.831, 94.777, 97.632, 98.739, 88.867, 99.873, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7788
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8033
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0397
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2482
Epoch: 0|  Loss:  4.0417 |Global loss: 5.5744| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.2655
Epoch: 1|  Loss:  4.0363 |Global loss: 5.5649| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.2649
Epoch: 2|  Loss:  4.0147 |Global loss: 5.5652| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 3|  NKD Loss: 1.2689
Epoch: 3|  Loss:  3.9973 |Global loss: 5.5601| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 0|  NKD Loss: 1.2838
Epoch: 0|  Loss:  3.5574 |Global loss: 5.6289| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 1|  NKD Loss: 1.2958
Epoch: 1|  Loss:  3.5243 |Global loss: 5.6302| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 2|  NKD Loss: 1.2852
Epoch: 2|  Loss:  3.5083 |Global loss: 5.6399| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 3|  NKD Loss: 1.2879
Epoch: 3|  Loss:  3.4872 |Global loss: 5.64| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 0|  NKD Loss: 1.2627
Epoch: 0|  Loss:  3.8089 |Global loss: 5.5984| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.2736
Epoch: 1|  Loss:  3.7877 |Global loss: 5.5901| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 1.2763
Epoch: 2|  Loss:  3.7585 |Global loss: 5.6017| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 3|  NKD Loss: 1.2703
Epoch: 3|  Loss:  3.7522 |Global loss: 5.6014| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 1.2606
Epoch: 0|  Loss:  4.0263 |Global loss: 5.6123| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 1.2753
Epoch: 1|  Loss:  4.0274 |Global loss: 5.6056| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 2|  NKD Loss: 1.2452
Epoch: 2|  Loss:  4.0156 |Global loss: 5.6218| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 3|  NKD Loss: 1.2873
Epoch: 3|  Loss:  4.0131 |Global loss: 5.6028| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 1.282
Epoch: 0|  Loss:  3.9996 |Global loss: 5.6011| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 1|  NKD Loss: 1.2816
Epoch: 1|  Loss:  3.9936 |Global loss: 5.5976| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.2945
Epoch: 2|  Loss:  3.9853 |Global loss: 5.5982| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 3|  NKD Loss: 1.2858
Epoch: 3|  Loss:  3.9781 |Global loss: 5.6002| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 0|  NKD Loss: 1.276
Epoch: 0|  Loss:  3.8601 |Global loss: 5.5888| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 1|  NKD Loss: 1.2625
Epoch: 1|  Loss:  3.8482 |Global loss: 5.5856| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.2771
Epoch: 2|  Loss:  3.8383 |Global loss: 5.5751| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2759
Epoch: 3|  Loss:  3.8199 |Global loss: 5.5826| Local H loss: 0.0093  | Global H loss: 0.0093
------------------------- time cost ------------------------- 2.8143463134765625
Chosen Clients:  [11, 2, 13, 14, 0, 1]

-------------Round number: 105-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [93.546, 87.948, 100.175, 104.286, 97.873, 92.958, 99.964, 91.684, 101.831, 95.467, 99.064, 98.739, 89.703, 100.491, 99.336]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7600
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8073
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0382
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2767
Epoch: 0|  Loss:  3.5832 |Global loss: 5.6303| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 1.2792
Epoch: 1|  Loss:  3.5738 |Global loss: 5.6392| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 2|  NKD Loss: 1.2874
Epoch: 2|  Loss:  3.553 |Global loss: 5.6345| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 3|  NKD Loss: 1.266
Epoch: 3|  Loss:  3.5349 |Global loss: 5.6532| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 1.3046
Epoch: 0|  Loss:  3.6352 |Global loss: 5.6271| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 1|  NKD Loss: 1.2888
Epoch: 1|  Loss:  3.6165 |Global loss: 5.6314| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 1.2847
Epoch: 2|  Loss:  3.6004 |Global loss: 5.6378| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 1.275
Epoch: 3|  Loss:  3.5871 |Global loss: 5.6458| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.2952
Epoch: 0|  Loss:  3.4796 |Global loss: 5.6379| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 1|  NKD Loss: 1.2751
Epoch: 1|  Loss:  3.4599 |Global loss: 5.6602| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.2781
Epoch: 2|  Loss:  3.4372 |Global loss: 5.6635| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 3|  NKD Loss: 1.2844
Epoch: 3|  Loss:  3.4228 |Global loss: 5.6602| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 0|  NKD Loss: 1.2958
Epoch: 0|  Loss:  3.7144 |Global loss: 5.6207| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 1.3087
Epoch: 1|  Loss:  3.71 |Global loss: 5.6097| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 2|  NKD Loss: 1.2698
Epoch: 2|  Loss:  3.6857 |Global loss: 5.6397| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.3036
Epoch: 3|  Loss:  3.6786 |Global loss: 5.6234| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 0|  NKD Loss: 1.2624
Epoch: 0|  Loss:  4.0039 |Global loss: 5.579| Local H loss: 0.0074  | Global H loss: 0.0074
Epoch: 1|  NKD Loss: 1.2699
Epoch: 1|  Loss:  4.0047 |Global loss: 5.5671| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 2|  NKD Loss: 1.2637
Epoch: 2|  Loss:  3.9905 |Global loss: 5.5754| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 3|  NKD Loss: 1.2761
Epoch: 3|  Loss:  3.9954 |Global loss: 5.5636| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 0|  NKD Loss: 1.2556
Epoch: 0|  Loss:  4.1786 |Global loss: 5.5644| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 1|  NKD Loss: 1.2528
Epoch: 1|  Loss:  4.1752 |Global loss: 5.571| Local H loss: 0.0065  | Global H loss: 0.0065
Epoch: 2|  NKD Loss: 1.2786
Epoch: 2|  Loss:  4.1725 |Global loss: 5.5447| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 3|  NKD Loss: 1.2828
Epoch: 3|  Loss:  4.1618 |Global loss: 5.555| Local H loss: 0.0066  | Global H loss: 0.0066
------------------------- time cost ------------------------- 2.956188440322876
Chosen Clients:  [5, 13, 14, 8, 2, 11]

-------------Round number: 106-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [94.463, 90.062, 100.918, 104.286, 97.873, 92.958, 99.964, 91.684, 101.831, 95.467, 99.064, 99.258, 89.703, 100.779, 100.327]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7347
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8104
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0366
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2576
Epoch: 0|  Loss:  3.9823 |Global loss: 5.5734| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 1|  NKD Loss: 1.2551
Epoch: 1|  Loss:  3.9636 |Global loss: 5.5691| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 2|  NKD Loss: 1.2702
Epoch: 2|  Loss:  3.9459 |Global loss: 5.5668| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 3|  NKD Loss: 1.2459
Epoch: 3|  Loss:  3.937 |Global loss: 5.5819| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 0|  NKD Loss: 1.2914
Epoch: 0|  Loss:  3.4218 |Global loss: 5.6549| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 1|  NKD Loss: 1.285
Epoch: 1|  Loss:  3.3972 |Global loss: 5.6636| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 2|  NKD Loss: 1.2937
Epoch: 2|  Loss:  3.3897 |Global loss: 5.6656| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.2867
Epoch: 3|  Loss:  3.3628 |Global loss: 5.6691| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.2978
Epoch: 0|  Loss:  3.6813 |Global loss: 5.617| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 1|  NKD Loss: 1.3038
Epoch: 1|  Loss:  3.6506 |Global loss: 5.6263| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 2|  NKD Loss: 1.2912
Epoch: 2|  Loss:  3.6444 |Global loss: 5.6336| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 1.2961
Epoch: 3|  Loss:  3.6306 |Global loss: 5.632| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 0|  NKD Loss: 1.3162
Epoch: 0|  Loss:  3.3906 |Global loss: 5.6727| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2952
Epoch: 1|  Loss:  3.3739 |Global loss: 5.6882| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.3028
Epoch: 2|  Loss:  3.3572 |Global loss: 5.6861| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 3|  NKD Loss: 1.289
Epoch: 3|  Loss:  3.3522 |Global loss: 5.6945| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 0|  NKD Loss: 1.3023
Epoch: 0|  Loss:  3.5908 |Global loss: 5.6249| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 1|  NKD Loss: 1.2987
Epoch: 1|  Loss:  3.574 |Global loss: 5.6329| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 1.2882
Epoch: 2|  Loss:  3.5575 |Global loss: 5.6425| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 3|  NKD Loss: 1.264
Epoch: 3|  Loss:  3.5367 |Global loss: 5.6584| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 0|  NKD Loss: 1.2913
Epoch: 0|  Loss:  3.5427 |Global loss: 5.6404| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 1|  NKD Loss: 1.2804
Epoch: 1|  Loss:  3.5163 |Global loss: 5.6507| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 2|  NKD Loss: 1.2716
Epoch: 2|  Loss:  3.5105 |Global loss: 5.6587| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 3|  NKD Loss: 1.2688
Epoch: 3|  Loss:  3.4846 |Global loss: 5.6607| Local H loss: 0.0164  | Global H loss: 0.0164
------------------------- time cost ------------------------- 2.9511401653289795
Chosen Clients:  [10, 0, 1, 5, 4, 11]

-------------Round number: 107-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [94.463, 90.062, 102.05, 104.286, 97.873, 94.996, 99.964, 91.684, 101.913, 95.467, 99.064, 100.016, 89.703, 101.119, 100.875]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.7050
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8131
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0370
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2586
Epoch: 0|  Loss:  3.7885 |Global loss: 5.5961| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 1.2488
Epoch: 1|  Loss:  3.7728 |Global loss: 5.602| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 1.269
Epoch: 2|  Loss:  3.7622 |Global loss: 5.5821| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2812
Epoch: 3|  Loss:  3.7481 |Global loss: 5.5776| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 1.2415
Epoch: 0|  Loss:  3.9524 |Global loss: 5.5983| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 1|  NKD Loss: 1.2564
Epoch: 1|  Loss:  3.9437 |Global loss: 5.5846| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 1.248
Epoch: 2|  Loss:  3.9371 |Global loss: 5.5877| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 3|  NKD Loss: 1.2533
Epoch: 3|  Loss:  3.9358 |Global loss: 5.587| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 0|  NKD Loss: 1.2202
Epoch: 0|  Loss:  4.1266 |Global loss: 5.5901| Local H loss: 0.0066  | Global H loss: 0.0066
Epoch: 1|  NKD Loss: 1.2443
Epoch: 1|  Loss:  4.1216 |Global loss: 5.5737| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 2|  NKD Loss: 1.2632
Epoch: 2|  Loss:  4.1228 |Global loss: 5.5658| Local H loss: 0.0067  | Global H loss: 0.0067
Epoch: 3|  NKD Loss: 1.2628
Epoch: 3|  Loss:  4.1147 |Global loss: 5.5642| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 0|  NKD Loss: 1.2278
Epoch: 0|  Loss:  3.8945 |Global loss: 5.5984| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 1.2361
Epoch: 1|  Loss:  3.8828 |Global loss: 5.5946| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.2691
Epoch: 2|  Loss:  3.8776 |Global loss: 5.5777| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2497
Epoch: 3|  Loss:  3.8703 |Global loss: 5.5858| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2571
Epoch: 0|  Loss:  3.7218 |Global loss: 5.6118| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 1|  NKD Loss: 1.2706
Epoch: 1|  Loss:  3.6895 |Global loss: 5.6088| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 2|  NKD Loss: 1.2606
Epoch: 2|  Loss:  3.6771 |Global loss: 5.6147| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.261
Epoch: 3|  Loss:  3.6587 |Global loss: 5.6119| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 0|  NKD Loss: 1.2929
Epoch: 0|  Loss:  3.4914 |Global loss: 5.6502| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 1|  NKD Loss: 1.2835
Epoch: 1|  Loss:  3.4777 |Global loss: 5.6486| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.2693
Epoch: 2|  Loss:  3.4561 |Global loss: 5.666| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 3|  NKD Loss: 1.2652
Epoch: 3|  Loss:  3.4492 |Global loss: 5.6699| Local H loss: 0.0167  | Global H loss: 0.0167
------------------------- time cost ------------------------- 2.87713885307312
Chosen Clients:  [9, 6, 1, 13, 4, 2]

-------------Round number: 108-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [95.488, 90.958, 102.05, 104.286, 98.507, 96.739, 99.964, 91.684, 101.913, 95.467, 99.956, 100.559, 89.703, 101.119, 100.875]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6918
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8163
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0358
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2696
Epoch: 0|  Loss:  3.9582 |Global loss: 5.6143| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 1|  NKD Loss: 1.2932
Epoch: 1|  Loss:  3.9578 |Global loss: 5.6021| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 2|  NKD Loss: 1.2727
Epoch: 2|  Loss:  3.9417 |Global loss: 5.6038| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 3|  NKD Loss: 1.2744
Epoch: 3|  Loss:  3.9384 |Global loss: 5.6106| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 0|  NKD Loss: 1.2747
Epoch: 0|  Loss:  3.57 |Global loss: 5.6451| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 1|  NKD Loss: 1.306
Epoch: 1|  Loss:  3.5616 |Global loss: 5.6299| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 2|  NKD Loss: 1.2665
Epoch: 2|  Loss:  3.5243 |Global loss: 5.662| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 3|  NKD Loss: 1.2629
Epoch: 3|  Loss:  3.5133 |Global loss: 5.6632| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 1.2528
Epoch: 0|  Loss:  4.0916 |Global loss: 5.5823| Local H loss: 0.0068  | Global H loss: 0.0068
Epoch: 1|  NKD Loss: 1.2633
Epoch: 1|  Loss:  4.0873 |Global loss: 5.569| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 2|  NKD Loss: 1.2686
Epoch: 2|  Loss:  4.0825 |Global loss: 5.5614| Local H loss: 0.0069  | Global H loss: 0.0069
Epoch: 3|  NKD Loss: 1.2835
Epoch: 3|  Loss:  4.0753 |Global loss: 5.5592| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 0|  NKD Loss: 1.3168
Epoch: 0|  Loss:  3.3689 |Global loss: 5.6524| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 1.2968
Epoch: 1|  Loss:  3.3319 |Global loss: 5.6637| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 2|  NKD Loss: 1.2727
Epoch: 2|  Loss:  3.3184 |Global loss: 5.6895| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 3|  NKD Loss: 1.2749
Epoch: 3|  Loss:  3.3173 |Global loss: 5.6835| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 0|  NKD Loss: 1.2755
Epoch: 0|  Loss:  3.6571 |Global loss: 5.6071| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 1.2689
Epoch: 1|  Loss:  3.63 |Global loss: 5.6161| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 2|  NKD Loss: 1.2667
Epoch: 2|  Loss:  3.6016 |Global loss: 5.619| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 3|  NKD Loss: 1.2676
Epoch: 3|  Loss:  3.5849 |Global loss: 5.6255| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 1.2855
Epoch: 0|  Loss:  3.5392 |Global loss: 5.6474| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 1.2804
Epoch: 1|  Loss:  3.5201 |Global loss: 5.6519| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 2|  NKD Loss: 1.2893
Epoch: 2|  Loss:  3.5095 |Global loss: 5.6544| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.27
Epoch: 3|  Loss:  3.4936 |Global loss: 5.6625| Local H loss: 0.0133  | Global H loss: 0.0133
------------------------- time cost ------------------------- 3.539867877960205
Chosen Clients:  [11, 12, 13, 6, 0, 14]

-------------Round number: 109-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [95.488, 91.731, 102.394, 104.286, 99.425, 96.739, 100.737, 91.684, 101.913, 96.589, 99.956, 100.559, 89.703, 101.51, 100.875]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6670
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8187
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0355
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2953
Epoch: 0|  Loss:  3.4642 |Global loss: 5.6555| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 1|  NKD Loss: 1.2963
Epoch: 1|  Loss:  3.4341 |Global loss: 5.6575| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 2|  NKD Loss: 1.2778
Epoch: 2|  Loss:  3.4278 |Global loss: 5.6616| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2712
Epoch: 3|  Loss:  3.4192 |Global loss: 5.6778| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 0|  NKD Loss: 1.2743
Epoch: 0|  Loss:  3.9977 |Global loss: 5.6135| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.2743
Epoch: 1|  Loss:  4.0011 |Global loss: 5.6055| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 1.2777
Epoch: 2|  Loss:  3.9849 |Global loss: 5.6118| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 1.2867
Epoch: 3|  Loss:  3.9812 |Global loss: 5.609| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 0|  NKD Loss: 1.3004
Epoch: 0|  Loss:  3.3254 |Global loss: 5.6754| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 1|  NKD Loss: 1.2924
Epoch: 1|  Loss:  3.3005 |Global loss: 5.6856| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 2|  NKD Loss: 1.2829
Epoch: 2|  Loss:  3.2822 |Global loss: 5.6945| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2773
Epoch: 3|  Loss:  3.268 |Global loss: 5.6919| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 1.303
Epoch: 0|  Loss:  3.514 |Global loss: 5.6424| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 1.2822
Epoch: 1|  Loss:  3.5023 |Global loss: 5.6523| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 1.2958
Epoch: 2|  Loss:  3.4872 |Global loss: 5.6521| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 3|  NKD Loss: 1.2981
Epoch: 3|  Loss:  3.483 |Global loss: 5.6526| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 0|  NKD Loss: 1.2501
Epoch: 0|  Loss:  3.9076 |Global loss: 5.5954| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 1|  NKD Loss: 1.2556
Epoch: 1|  Loss:  3.9098 |Global loss: 5.5927| Local H loss: 0.008  | Global H loss: 0.008
Epoch: 2|  NKD Loss: 1.2667
Epoch: 2|  Loss:  3.889 |Global loss: 5.5828| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 3|  NKD Loss: 1.2463
Epoch: 3|  Loss:  3.8833 |Global loss: 5.6003| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 0|  NKD Loss: 1.2775
Epoch: 0|  Loss:  3.6065 |Global loss: 5.6462| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 1|  NKD Loss: 1.2705
Epoch: 1|  Loss:  3.5952 |Global loss: 5.6541| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 1.2954
Epoch: 2|  Loss:  3.5898 |Global loss: 5.6456| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 3|  NKD Loss: 1.2764
Epoch: 3|  Loss:  3.5782 |Global loss: 5.6457| Local H loss: 0.0132  | Global H loss: 0.0132
------------------------- time cost ------------------------- 2.8154497146606445
Chosen Clients:  [12, 9, 14, 7, 2, 5]

-------------Round number: 110-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 91.731, 102.394, 104.286, 99.425, 96.739, 101.075, 91.684, 101.913, 96.589, 99.956, 101.039, 90.38, 101.784, 101.767]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6467
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8205
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0353
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2748
Epoch: 0|  Loss:  3.9706 |Global loss: 5.621| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 1.2559
Epoch: 1|  Loss:  3.9609 |Global loss: 5.6319| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 1.2703
Epoch: 2|  Loss:  3.9614 |Global loss: 5.6185| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.271
Epoch: 3|  Loss:  3.9548 |Global loss: 5.6209| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2673
Epoch: 0|  Loss:  3.9121 |Global loss: 5.6161| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 1|  NKD Loss: 1.279
Epoch: 1|  Loss:  3.9065 |Global loss: 5.6109| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.2718
Epoch: 2|  Loss:  3.8945 |Global loss: 5.6159| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 3|  NKD Loss: 1.2836
Epoch: 3|  Loss:  3.8951 |Global loss: 5.6017| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 0|  NKD Loss: 1.2659
Epoch: 0|  Loss:  3.5478 |Global loss: 5.6685| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 1|  NKD Loss: 1.2704
Epoch: 1|  Loss:  3.5404 |Global loss: 5.6676| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 2|  NKD Loss: 1.2581
Epoch: 2|  Loss:  3.528 |Global loss: 5.6662| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 3|  NKD Loss: 1.267
Epoch: 3|  Loss:  3.5093 |Global loss: 5.6717| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 0|  NKD Loss: 1.2625
Epoch: 0|  Loss:  4.0012 |Global loss: 5.5946| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 1|  NKD Loss: 1.2468
Epoch: 1|  Loss:  3.9885 |Global loss: 5.6026| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 1.2595
Epoch: 2|  Loss:  3.978 |Global loss: 5.5941| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 3|  NKD Loss: 1.2705
Epoch: 3|  Loss:  3.9748 |Global loss: 5.6011| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2834
Epoch: 0|  Loss:  3.4778 |Global loss: 5.649| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 1.2753
Epoch: 1|  Loss:  3.472 |Global loss: 5.6528| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 2|  NKD Loss: 1.276
Epoch: 2|  Loss:  3.4451 |Global loss: 5.6685| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 1.2742
Epoch: 3|  Loss:  3.4429 |Global loss: 5.6607| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 0|  NKD Loss: 1.2438
Epoch: 0|  Loss:  3.833 |Global loss: 5.5948| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 1|  NKD Loss: 1.252
Epoch: 1|  Loss:  3.8412 |Global loss: 5.5948| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 2|  NKD Loss: 1.2592
Epoch: 2|  Loss:  3.819 |Global loss: 5.5927| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 1.2615
Epoch: 3|  Loss:  3.8094 |Global loss: 5.59| Local H loss: 0.0099  | Global H loss: 0.0099
------------------------- time cost ------------------------- 3.1817467212677
Chosen Clients:  [9, 6, 12, 1, 13, 8]

-------------Round number: 111-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 91.731, 102.857, 104.286, 99.425, 98.431, 101.075, 93.188, 101.913, 98.003, 99.956, 101.039, 90.324, 101.784, 102.618]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.085, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.155, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6359
Averaged Test Accurancy: 0.0578
Averaged Test AUC: 0.8237
Averaged Test F1_score: 0.0184
Averaged Test Recal score: 0.0927
Std Test Accurancy: 0.0201
Std Test AUC: 0.0342
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2503
Epoch: 0|  Loss:  3.8719 |Global loss: 5.6293| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.288
Epoch: 1|  Loss:  3.8654 |Global loss: 5.6088| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 2|  NKD Loss: 1.2626
Epoch: 2|  Loss:  3.8571 |Global loss: 5.6223| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2633
Epoch: 3|  Loss:  3.8436 |Global loss: 5.6201| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2974
Epoch: 0|  Loss:  3.478 |Global loss: 5.6518| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 1.3043
Epoch: 1|  Loss:  3.4524 |Global loss: 5.6474| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 2|  NKD Loss: 1.2798
Epoch: 2|  Loss:  3.4414 |Global loss: 5.6675| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.2589
Epoch: 3|  Loss:  3.4176 |Global loss: 5.6845| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 0|  NKD Loss: 1.2883
Epoch: 0|  Loss:  3.9468 |Global loss: 5.6168| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.272
Epoch: 1|  Loss:  3.9493 |Global loss: 5.6188| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 1.2884
Epoch: 2|  Loss:  3.9474 |Global loss: 5.6124| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.298
Epoch: 3|  Loss:  3.946 |Global loss: 5.6129| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 0|  NKD Loss: 1.2501
Epoch: 0|  Loss:  4.0533 |Global loss: 5.581| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 1|  NKD Loss: 1.2372
Epoch: 1|  Loss:  4.0475 |Global loss: 5.5829| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 2|  NKD Loss: 1.2507
Epoch: 2|  Loss:  4.0408 |Global loss: 5.5875| Local H loss: 0.007  | Global H loss: 0.007
Epoch: 3|  NKD Loss: 1.2624
Epoch: 3|  Loss:  4.0316 |Global loss: 5.5812| Local H loss: 0.0071  | Global H loss: 0.0071
Epoch: 0|  NKD Loss: 1.2959
Epoch: 0|  Loss:  3.2581 |Global loss: 5.6925| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 1|  NKD Loss: 1.2868
Epoch: 1|  Loss:  3.2654 |Global loss: 5.6996| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 2|  NKD Loss: 1.2809
Epoch: 2|  Loss:  3.2437 |Global loss: 5.7033| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 3|  NKD Loss: 1.2854
Epoch: 3|  Loss:  3.2201 |Global loss: 5.7017| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 0|  NKD Loss: 1.2971
Epoch: 0|  Loss:  3.3501 |Global loss: 5.6777| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 1|  NKD Loss: 1.284
Epoch: 1|  Loss:  3.3412 |Global loss: 5.6968| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.3092
Epoch: 2|  Loss:  3.3415 |Global loss: 5.6812| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.3025
Epoch: 3|  Loss:  3.313 |Global loss: 5.6877| Local H loss: 0.0146  | Global H loss: 0.0146
------------------------- time cost ------------------------- 3.016840696334839
Chosen Clients:  [1, 9, 12, 11, 10, 8]

-------------Round number: 112-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 92.973, 102.857, 104.286, 99.425, 98.431, 101.578, 93.188, 102.107, 98.846, 99.956, 101.039, 91.067, 102.173, 102.618]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6144
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8259
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0326
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2454
Epoch: 0|  Loss:  3.9999 |Global loss: 5.591| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 1|  NKD Loss: 1.2555
Epoch: 1|  Loss:  4.0081 |Global loss: 5.5883| Local H loss: 0.0072  | Global H loss: 0.0072
Epoch: 2|  NKD Loss: 1.2637
Epoch: 2|  Loss:  4.0032 |Global loss: 5.584| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 3|  NKD Loss: 1.2711
Epoch: 3|  Loss:  3.9876 |Global loss: 5.5789| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 0|  NKD Loss: 1.2509
Epoch: 0|  Loss:  3.82 |Global loss: 5.6385| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 1|  NKD Loss: 1.2678
Epoch: 1|  Loss:  3.8268 |Global loss: 5.6165| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 1.2844
Epoch: 2|  Loss:  3.8063 |Global loss: 5.6163| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 3|  NKD Loss: 1.275
Epoch: 3|  Loss:  3.7908 |Global loss: 5.6244| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.261
Epoch: 0|  Loss:  3.9274 |Global loss: 5.6355| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.2617
Epoch: 1|  Loss:  3.9334 |Global loss: 5.6346| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 1.2799
Epoch: 2|  Loss:  3.92 |Global loss: 5.624| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2905
Epoch: 3|  Loss:  3.9133 |Global loss: 5.6239| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 0|  NKD Loss: 1.2846
Epoch: 0|  Loss:  3.4186 |Global loss: 5.6617| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 1|  NKD Loss: 1.2867
Epoch: 1|  Loss:  3.4078 |Global loss: 5.6633| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 2|  NKD Loss: 1.2634
Epoch: 2|  Loss:  3.3855 |Global loss: 5.6834| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.277
Epoch: 3|  Loss:  3.3766 |Global loss: 5.6745| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 0|  NKD Loss: 1.2366
Epoch: 0|  Loss:  3.7221 |Global loss: 5.6111| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.242
Epoch: 1|  Loss:  3.701 |Global loss: 5.6148| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 2|  NKD Loss: 1.2704
Epoch: 2|  Loss:  3.6954 |Global loss: 5.5803| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 3|  NKD Loss: 1.2709
Epoch: 3|  Loss:  3.688 |Global loss: 5.5865| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 0|  NKD Loss: 1.3009
Epoch: 0|  Loss:  3.3309 |Global loss: 5.6891| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 1|  NKD Loss: 1.3058
Epoch: 1|  Loss:  3.3027 |Global loss: 5.6881| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 2|  NKD Loss: 1.2967
Epoch: 2|  Loss:  3.3001 |Global loss: 5.6951| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.2687
Epoch: 3|  Loss:  3.2849 |Global loss: 5.7103| Local H loss: 0.0148  | Global H loss: 0.0148
------------------------- time cost ------------------------- 3.0586113929748535
Chosen Clients:  [5, 10, 3, 13, 6, 8]

-------------Round number: 113-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 93.854, 102.857, 104.286, 99.425, 98.431, 101.578, 93.188, 102.231, 99.49, 100.997, 101.463, 91.449, 102.173, 102.618]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.6011
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8278
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0318
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2324
Epoch: 0|  Loss:  3.7743 |Global loss: 5.6143| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 1.2602
Epoch: 1|  Loss:  3.7679 |Global loss: 5.5917| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.262
Epoch: 2|  Loss:  3.7458 |Global loss: 5.5985| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2626
Epoch: 3|  Loss:  3.7349 |Global loss: 5.5969| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 0|  NKD Loss: 1.2478
Epoch: 0|  Loss:  3.6578 |Global loss: 5.6123| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 1.2718
Epoch: 1|  Loss:  3.6484 |Global loss: 5.5941| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 1.2505
Epoch: 2|  Loss:  3.6226 |Global loss: 5.6048| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 3|  NKD Loss: 1.2621
Epoch: 3|  Loss:  3.6133 |Global loss: 5.6062| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 0|  NKD Loss: 1.2934
Epoch: 0|  Loss:  3.2122 |Global loss: 5.6756| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 1|  NKD Loss: 1.2757
Epoch: 1|  Loss:  3.1845 |Global loss: 5.6834| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 2|  NKD Loss: 1.2574
Epoch: 2|  Loss:  3.158 |Global loss: 5.7066| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2652
Epoch: 3|  Loss:  3.1426 |Global loss: 5.694| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 0|  NKD Loss: 1.3112
Epoch: 0|  Loss:  3.2374 |Global loss: 5.6894| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2692
Epoch: 1|  Loss:  3.2107 |Global loss: 5.7173| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2859
Epoch: 2|  Loss:  3.2024 |Global loss: 5.7094| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 1.2745
Epoch: 3|  Loss:  3.1822 |Global loss: 5.7244| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 0|  NKD Loss: 1.2742
Epoch: 0|  Loss:  3.4239 |Global loss: 5.6729| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 1.2936
Epoch: 1|  Loss:  3.4091 |Global loss: 5.6694| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.2862
Epoch: 2|  Loss:  3.4063 |Global loss: 5.6762| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 3|  NKD Loss: 1.2739
Epoch: 3|  Loss:  3.385 |Global loss: 5.6817| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 0|  NKD Loss: 1.3138
Epoch: 0|  Loss:  3.2934 |Global loss: 5.6863| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 1|  NKD Loss: 1.2951
Epoch: 1|  Loss:  3.2718 |Global loss: 5.6969| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 2|  NKD Loss: 1.2817
Epoch: 2|  Loss:  3.2842 |Global loss: 5.7023| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.274
Epoch: 3|  Loss:  3.2591 |Global loss: 5.7184| Local H loss: 0.0151  | Global H loss: 0.0151
------------------------- time cost ------------------------- 3.0898070335388184
Chosen Clients:  [5, 10, 12, 1, 4, 8]

-------------Round number: 114-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 93.854, 102.857, 104.627, 99.425, 99.328, 102.014, 93.188, 102.655, 99.49, 101.955, 101.463, 91.449, 102.1, 102.618]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.5712
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8295
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0325
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2375
Epoch: 0|  Loss:  3.7002 |Global loss: 5.62| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 1|  NKD Loss: 1.2591
Epoch: 1|  Loss:  3.6867 |Global loss: 5.6077| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 1.2304
Epoch: 2|  Loss:  3.6788 |Global loss: 5.6238| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 3|  NKD Loss: 1.2597
Epoch: 3|  Loss:  3.6583 |Global loss: 5.6182| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 0|  NKD Loss: 1.2436
Epoch: 0|  Loss:  3.5745 |Global loss: 5.6145| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 1|  NKD Loss: 1.2474
Epoch: 1|  Loss:  3.5611 |Global loss: 5.6154| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 1.2578
Epoch: 2|  Loss:  3.5533 |Global loss: 5.6123| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.2538
Epoch: 3|  Loss:  3.5389 |Global loss: 5.6118| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 1.2395
Epoch: 0|  Loss:  3.9009 |Global loss: 5.651| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.2701
Epoch: 1|  Loss:  3.9075 |Global loss: 5.6293| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2651
Epoch: 2|  Loss:  3.9025 |Global loss: 5.6382| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2726
Epoch: 3|  Loss:  3.9025 |Global loss: 5.6316| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 0|  NKD Loss: 1.2275
Epoch: 0|  Loss:  3.948 |Global loss: 5.621| Local H loss: 0.0073  | Global H loss: 0.0073
Epoch: 1|  NKD Loss: 1.2461
Epoch: 1|  Loss:  3.9533 |Global loss: 5.5984| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 2|  NKD Loss: 1.2527
Epoch: 2|  Loss:  3.9552 |Global loss: 5.5919| Local H loss: 0.0075  | Global H loss: 0.0075
Epoch: 3|  NKD Loss: 1.253
Epoch: 3|  Loss:  3.9436 |Global loss: 5.5969| Local H loss: 0.0076  | Global H loss: 0.0076
Epoch: 0|  NKD Loss: 1.2343
Epoch: 0|  Loss:  3.5475 |Global loss: 5.6563| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 1|  NKD Loss: 1.2472
Epoch: 1|  Loss:  3.5339 |Global loss: 5.6434| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.2594
Epoch: 2|  Loss:  3.5149 |Global loss: 5.6393| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 3|  NKD Loss: 1.2534
Epoch: 3|  Loss:  3.497 |Global loss: 5.6431| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 0|  NKD Loss: 1.2982
Epoch: 0|  Loss:  3.2581 |Global loss: 5.7026| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.2952
Epoch: 1|  Loss:  3.2341 |Global loss: 5.7017| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 2|  NKD Loss: 1.2658
Epoch: 2|  Loss:  3.229 |Global loss: 5.7183| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 3|  NKD Loss: 1.268
Epoch: 3|  Loss:  3.2207 |Global loss: 5.7199| Local H loss: 0.0154  | Global H loss: 0.0154
------------------------- time cost ------------------------- 2.860495090484619
Chosen Clients:  [14, 8, 1, 0, 7, 11]

-------------Round number: 115-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [96.084, 94.818, 102.857, 104.627, 100.737, 99.874, 102.014, 93.188, 102.984, 99.49, 102.513, 101.463, 92.314, 102.1, 102.618]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.5602
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8320
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0312
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2879
Epoch: 0|  Loss:  3.5052 |Global loss: 5.6611| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2909
Epoch: 1|  Loss:  3.4961 |Global loss: 5.6574| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.2729
Epoch: 2|  Loss:  3.4779 |Global loss: 5.6726| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 3|  NKD Loss: 1.2688
Epoch: 3|  Loss:  3.4654 |Global loss: 5.6697| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 0|  NKD Loss: 1.3034
Epoch: 0|  Loss:  3.2382 |Global loss: 5.6983| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 1.294
Epoch: 1|  Loss:  3.2273 |Global loss: 5.6993| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.2708
Epoch: 2|  Loss:  3.1967 |Global loss: 5.7275| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 3|  NKD Loss: 1.2884
Epoch: 3|  Loss:  3.1842 |Global loss: 5.7112| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 0|  NKD Loss: 1.2473
Epoch: 0|  Loss:  3.9159 |Global loss: 5.6003| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 1|  NKD Loss: 1.2552
Epoch: 1|  Loss:  3.9228 |Global loss: 5.5975| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 2|  NKD Loss: 1.2447
Epoch: 2|  Loss:  3.9152 |Global loss: 5.6085| Local H loss: 0.0077  | Global H loss: 0.0077
Epoch: 3|  NKD Loss: 1.2733
Epoch: 3|  Loss:  3.9099 |Global loss: 5.5878| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 0|  NKD Loss: 1.2301
Epoch: 0|  Loss:  3.8541 |Global loss: 5.6088| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 1|  NKD Loss: 1.2479
Epoch: 1|  Loss:  3.8543 |Global loss: 5.6057| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 2|  NKD Loss: 1.2532
Epoch: 2|  Loss:  3.8564 |Global loss: 5.5987| Local H loss: 0.0083  | Global H loss: 0.0083
Epoch: 3|  NKD Loss: 1.2486
Epoch: 3|  Loss:  3.8464 |Global loss: 5.5967| Local H loss: 0.0085  | Global H loss: 0.0085
Epoch: 0|  NKD Loss: 1.2414
Epoch: 0|  Loss:  3.9522 |Global loss: 5.6113| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.2534
Epoch: 1|  Loss:  3.9443 |Global loss: 5.6072| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2496
Epoch: 2|  Loss:  3.9385 |Global loss: 5.6171| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2753
Epoch: 3|  Loss:  3.9289 |Global loss: 5.6042| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 1.2836
Epoch: 0|  Loss:  3.3917 |Global loss: 5.6692| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 1|  NKD Loss: 1.2716
Epoch: 1|  Loss:  3.3682 |Global loss: 5.6793| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 2|  NKD Loss: 1.2695
Epoch: 2|  Loss:  3.3434 |Global loss: 5.6837| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 3|  NKD Loss: 1.2655
Epoch: 3|  Loss:  3.3396 |Global loss: 5.6776| Local H loss: 0.0176  | Global H loss: 0.0176
------------------------- time cost ------------------------- 3.4561924934387207
Chosen Clients:  [9, 1, 13, 10, 0, 14]

-------------Round number: 116-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [97.442, 96.13, 102.857, 104.627, 100.737, 99.874, 102.014, 94.305, 103.171, 99.49, 102.513, 102.075, 92.314, 102.1, 103.179]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.5472
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8349
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0290
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2365
Epoch: 0|  Loss:  3.777 |Global loss: 5.6401| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.269
Epoch: 1|  Loss:  3.7687 |Global loss: 5.6232| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 1.2643
Epoch: 2|  Loss:  3.7571 |Global loss: 5.6237| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 3|  NKD Loss: 1.2714
Epoch: 3|  Loss:  3.738 |Global loss: 5.6297| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.2321
Epoch: 0|  Loss:  3.8825 |Global loss: 5.6191| Local H loss: 0.0078  | Global H loss: 0.0078
Epoch: 1|  NKD Loss: 1.2584
Epoch: 1|  Loss:  3.8856 |Global loss: 5.6026| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 2|  NKD Loss: 1.2585
Epoch: 2|  Loss:  3.8767 |Global loss: 5.5996| Local H loss: 0.0079  | Global H loss: 0.0079
Epoch: 3|  NKD Loss: 1.2707
Epoch: 3|  Loss:  3.8652 |Global loss: 5.5974| Local H loss: 0.0081  | Global H loss: 0.0081
Epoch: 0|  NKD Loss: 1.2963
Epoch: 0|  Loss:  3.1989 |Global loss: 5.6975| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 1|  NKD Loss: 1.2947
Epoch: 1|  Loss:  3.1891 |Global loss: 5.7015| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 2|  NKD Loss: 1.2807
Epoch: 2|  Loss:  3.1552 |Global loss: 5.7168| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 3|  NKD Loss: 1.2702
Epoch: 3|  Loss:  3.1474 |Global loss: 5.7255| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 0|  NKD Loss: 1.2613
Epoch: 0|  Loss:  3.5119 |Global loss: 5.617| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 1.2481
Epoch: 1|  Loss:  3.5024 |Global loss: 5.6186| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 2|  NKD Loss: 1.2543
Epoch: 2|  Loss:  3.49 |Global loss: 5.6241| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 3|  NKD Loss: 1.2501
Epoch: 3|  Loss:  3.4719 |Global loss: 5.6282| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 0|  NKD Loss: 1.2526
Epoch: 0|  Loss:  3.8133 |Global loss: 5.6087| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 1|  NKD Loss: 1.2565
Epoch: 1|  Loss:  3.8199 |Global loss: 5.5925| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 2|  NKD Loss: 1.2465
Epoch: 2|  Loss:  3.8042 |Global loss: 5.6085| Local H loss: 0.0087  | Global H loss: 0.0087
Epoch: 3|  NKD Loss: 1.258
Epoch: 3|  Loss:  3.7979 |Global loss: 5.6024| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 0|  NKD Loss: 1.294
Epoch: 0|  Loss:  3.456 |Global loss: 5.6666| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 1|  NKD Loss: 1.295
Epoch: 1|  Loss:  3.4484 |Global loss: 5.6628| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 1.2949
Epoch: 2|  Loss:  3.4369 |Global loss: 5.6694| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 3|  NKD Loss: 1.271
Epoch: 3|  Loss:  3.4209 |Global loss: 5.68| Local H loss: 0.0146  | Global H loss: 0.0146
------------------------- time cost ------------------------- 3.2090229988098145
Chosen Clients:  [1, 5, 9, 11, 8, 7]

-------------Round number: 117-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.423, 96.977, 102.857, 104.627, 100.737, 99.874, 102.014, 94.305, 103.171, 100.481, 102.973, 102.075, 92.314, 102.31, 103.994]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.5274
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8373
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0288
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2492
Epoch: 0|  Loss:  3.8344 |Global loss: 5.6172| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 1|  NKD Loss: 1.2317
Epoch: 1|  Loss:  3.8352 |Global loss: 5.6193| Local H loss: 0.0082  | Global H loss: 0.0082
Epoch: 2|  NKD Loss: 1.2596
Epoch: 2|  Loss:  3.8287 |Global loss: 5.6082| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 3|  NKD Loss: 1.2666
Epoch: 3|  Loss:  3.8231 |Global loss: 5.5997| Local H loss: 0.0084  | Global H loss: 0.0084
Epoch: 0|  NKD Loss: 1.2465
Epoch: 0|  Loss:  3.6437 |Global loss: 5.6226| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 1|  NKD Loss: 1.2502
Epoch: 1|  Loss:  3.6252 |Global loss: 5.6198| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 1.2707
Epoch: 2|  Loss:  3.6115 |Global loss: 5.6156| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.2415
Epoch: 3|  Loss:  3.5924 |Global loss: 5.6283| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 0|  NKD Loss: 1.2741
Epoch: 0|  Loss:  3.7231 |Global loss: 5.6271| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 1|  NKD Loss: 1.2614
Epoch: 1|  Loss:  3.6955 |Global loss: 5.6394| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.2771
Epoch: 2|  Loss:  3.6969 |Global loss: 5.6212| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 1.2724
Epoch: 3|  Loss:  3.6765 |Global loss: 5.6234| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.2754
Epoch: 0|  Loss:  3.3422 |Global loss: 5.6779| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.259
Epoch: 1|  Loss:  3.323 |Global loss: 5.6979| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.2617
Epoch: 2|  Loss:  3.3135 |Global loss: 5.6903| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 3|  NKD Loss: 1.2617
Epoch: 3|  Loss:  3.3072 |Global loss: 5.6897| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.3157
Epoch: 0|  Loss:  3.2169 |Global loss: 5.6907| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 1|  NKD Loss: 1.2939
Epoch: 1|  Loss:  3.1917 |Global loss: 5.7151| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 1.2883
Epoch: 2|  Loss:  3.1653 |Global loss: 5.7149| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 3|  NKD Loss: 1.2819
Epoch: 3|  Loss:  3.1649 |Global loss: 5.7217| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.236
Epoch: 0|  Loss:  3.9071 |Global loss: 5.6256| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.2647
Epoch: 1|  Loss:  3.9021 |Global loss: 5.6136| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 1.2607
Epoch: 2|  Loss:  3.8992 |Global loss: 5.6098| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 1.2822
Epoch: 3|  Loss:  3.8843 |Global loss: 5.606| Local H loss: 0.0102  | Global H loss: 0.0102
------------------------- time cost ------------------------- 3.0292186737060547
Chosen Clients:  [12, 11, 5, 0, 10, 3]

-------------Round number: 118-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.423, 97.945, 102.857, 104.627, 100.737, 100.692, 102.014, 94.922, 103.595, 101.277, 102.973, 102.442, 92.314, 102.31, 103.994]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.5023
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8395
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0279
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2619
Epoch: 0|  Loss:  3.8834 |Global loss: 5.6451| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 1.2696
Epoch: 1|  Loss:  3.8837 |Global loss: 5.6397| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2691
Epoch: 2|  Loss:  3.8908 |Global loss: 5.6346| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2786
Epoch: 3|  Loss:  3.883 |Global loss: 5.632| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 0|  NKD Loss: 1.2851
Epoch: 0|  Loss:  3.3049 |Global loss: 5.6829| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2773
Epoch: 1|  Loss:  3.2847 |Global loss: 5.678| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 1.2695
Epoch: 2|  Loss:  3.2792 |Global loss: 5.6821| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 1.2622
Epoch: 3|  Loss:  3.2549 |Global loss: 5.6958| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 0|  NKD Loss: 1.2555
Epoch: 0|  Loss:  3.5672 |Global loss: 5.625| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 1|  NKD Loss: 1.2542
Epoch: 1|  Loss:  3.5639 |Global loss: 5.6339| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 2|  NKD Loss: 1.2558
Epoch: 2|  Loss:  3.5428 |Global loss: 5.6382| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 3|  NKD Loss: 1.2696
Epoch: 3|  Loss:  3.5254 |Global loss: 5.631| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 0|  NKD Loss: 1.2367
Epoch: 0|  Loss:  3.7801 |Global loss: 5.6186| Local H loss: 0.0088  | Global H loss: 0.0088
Epoch: 1|  NKD Loss: 1.2421
Epoch: 1|  Loss:  3.768 |Global loss: 5.6133| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 2|  NKD Loss: 1.2591
Epoch: 2|  Loss:  3.7536 |Global loss: 5.602| Local H loss: 0.0091  | Global H loss: 0.0091
Epoch: 3|  NKD Loss: 1.2573
Epoch: 3|  Loss:  3.7463 |Global loss: 5.607| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2548
Epoch: 0|  Loss:  3.4466 |Global loss: 5.6262| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 1.2637
Epoch: 1|  Loss:  3.4369 |Global loss: 5.6215| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.2588
Epoch: 2|  Loss:  3.4123 |Global loss: 5.6283| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 3|  NKD Loss: 1.2641
Epoch: 3|  Loss:  3.4027 |Global loss: 5.6217| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 0|  NKD Loss: 1.2813
Epoch: 0|  Loss:  3.1545 |Global loss: 5.6862| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 1|  NKD Loss: 1.2858
Epoch: 1|  Loss:  3.1535 |Global loss: 5.6816| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.2509
Epoch: 2|  Loss:  3.1304 |Global loss: 5.6984| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.2475
Epoch: 3|  Loss:  3.1136 |Global loss: 5.709| Local H loss: 0.0175  | Global H loss: 0.0175
------------------------- time cost ------------------------- 3.231475353240967
Chosen Clients:  [11, 7, 13, 6, 9, 5]

-------------Round number: 119-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.891, 97.945, 102.857, 104.885, 100.737, 101.595, 102.014, 94.922, 103.595, 101.277, 103.867, 102.869, 92.654, 102.31, 103.994]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4840
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8413
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0280
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2623
Epoch: 0|  Loss:  3.2708 |Global loss: 5.6923| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 1.2638
Epoch: 1|  Loss:  3.2478 |Global loss: 5.6976| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2661
Epoch: 2|  Loss:  3.2281 |Global loss: 5.6912| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 3|  NKD Loss: 1.2583
Epoch: 3|  Loss:  3.2144 |Global loss: 5.7039| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 0|  NKD Loss: 1.2165
Epoch: 0|  Loss:  3.8535 |Global loss: 5.6535| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 1.2615
Epoch: 1|  Loss:  3.856 |Global loss: 5.6232| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 1.2735
Epoch: 2|  Loss:  3.8527 |Global loss: 5.6156| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2697
Epoch: 3|  Loss:  3.8427 |Global loss: 5.6163| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 1.3067
Epoch: 0|  Loss:  3.1624 |Global loss: 5.7004| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 1|  NKD Loss: 1.276
Epoch: 1|  Loss:  3.1404 |Global loss: 5.721| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.2848
Epoch: 2|  Loss:  3.1333 |Global loss: 5.7276| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 3|  NKD Loss: 1.2645
Epoch: 3|  Loss:  3.1121 |Global loss: 5.7316| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 0|  NKD Loss: 1.2716
Epoch: 0|  Loss:  3.3705 |Global loss: 5.6837| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 1.2682
Epoch: 1|  Loss:  3.3586 |Global loss: 5.6915| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 2|  NKD Loss: 1.2738
Epoch: 2|  Loss:  3.3536 |Global loss: 5.6825| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 3|  NKD Loss: 1.2629
Epoch: 3|  Loss:  3.3415 |Global loss: 5.7042| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 0|  NKD Loss: 1.2647
Epoch: 0|  Loss:  3.6524 |Global loss: 5.6324| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.254
Epoch: 1|  Loss:  3.632 |Global loss: 5.6472| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.2566
Epoch: 2|  Loss:  3.6221 |Global loss: 5.6458| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 1.2765
Epoch: 3|  Loss:  3.6096 |Global loss: 5.6319| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 0|  NKD Loss: 1.2455
Epoch: 0|  Loss:  3.4971 |Global loss: 5.6498| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 1|  NKD Loss: 1.2511
Epoch: 1|  Loss:  3.487 |Global loss: 5.643| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.2768
Epoch: 2|  Loss:  3.4702 |Global loss: 5.6354| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 3|  NKD Loss: 1.2466
Epoch: 3|  Loss:  3.4521 |Global loss: 5.6505| Local H loss: 0.0135  | Global H loss: 0.0135
------------------------- time cost ------------------------- 2.817478656768799
Chosen Clients:  [14, 10, 3, 1, 8, 7]

-------------Round number: 120-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.891, 97.945, 102.857, 104.885, 100.737, 102.178, 102.722, 95.928, 103.595, 102.229, 103.867, 103.428, 92.654, 102.703, 103.994]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4561
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8437
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0277
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2853
Epoch: 0|  Loss:  3.3959 |Global loss: 5.6781| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 1|  NKD Loss: 1.2696
Epoch: 1|  Loss:  3.3814 |Global loss: 5.6861| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 2|  NKD Loss: 1.2535
Epoch: 2|  Loss:  3.3622 |Global loss: 5.705| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 3|  NKD Loss: 1.2789
Epoch: 3|  Loss:  3.3587 |Global loss: 5.688| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 0|  NKD Loss: 1.2413
Epoch: 0|  Loss:  3.3694 |Global loss: 5.6504| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 1.2355
Epoch: 1|  Loss:  3.3614 |Global loss: 5.6526| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.2226
Epoch: 2|  Loss:  3.3427 |Global loss: 5.6681| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 3|  NKD Loss: 1.2478
Epoch: 3|  Loss:  3.334 |Global loss: 5.6532| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 0|  NKD Loss: 1.2617
Epoch: 0|  Loss:  3.133 |Global loss: 5.7019| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.2456
Epoch: 1|  Loss:  3.111 |Global loss: 5.7132| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 2|  NKD Loss: 1.2532
Epoch: 2|  Loss:  3.0951 |Global loss: 5.7082| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.2285
Epoch: 3|  Loss:  3.084 |Global loss: 5.7265| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.2481
Epoch: 0|  Loss:  3.7741 |Global loss: 5.6233| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 1|  NKD Loss: 1.2396
Epoch: 1|  Loss:  3.7796 |Global loss: 5.6198| Local H loss: 0.0086  | Global H loss: 0.0086
Epoch: 2|  NKD Loss: 1.2552
Epoch: 2|  Loss:  3.7633 |Global loss: 5.6128| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 3|  NKD Loss: 1.2599
Epoch: 3|  Loss:  3.7554 |Global loss: 5.6094| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 0|  NKD Loss: 1.2835
Epoch: 0|  Loss:  3.1631 |Global loss: 5.7198| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 1|  NKD Loss: 1.2849
Epoch: 1|  Loss:  3.1464 |Global loss: 5.7162| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 2|  NKD Loss: 1.2757
Epoch: 2|  Loss:  3.1369 |Global loss: 5.7223| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 3|  NKD Loss: 1.2719
Epoch: 3|  Loss:  3.1076 |Global loss: 5.7269| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 0|  NKD Loss: 1.2303
Epoch: 0|  Loss:  3.82 |Global loss: 5.6514| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 1.2631
Epoch: 1|  Loss:  3.8149 |Global loss: 5.6276| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 2|  NKD Loss: 1.2523
Epoch: 2|  Loss:  3.8122 |Global loss: 5.6291| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 1.2786
Epoch: 3|  Loss:  3.7924 |Global loss: 5.6274| Local H loss: 0.0109  | Global H loss: 0.0109
------------------------- time cost ------------------------- 2.929797410964966
Chosen Clients:  [9, 14, 13, 8, 6, 7]

-------------Round number: 121-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.891, 99.008, 102.857, 105.218, 100.737, 102.178, 102.722, 96.662, 103.939, 102.229, 103.895, 103.428, 92.654, 102.703, 104.321]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4355
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8452
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0271
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2537
Epoch: 0|  Loss:  3.5819 |Global loss: 5.6513| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 1|  NKD Loss: 1.2477
Epoch: 1|  Loss:  3.5598 |Global loss: 5.6581| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 2|  NKD Loss: 1.2606
Epoch: 2|  Loss:  3.554 |Global loss: 5.6479| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.2488
Epoch: 3|  Loss:  3.5241 |Global loss: 5.6632| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.2773
Epoch: 0|  Loss:  3.3428 |Global loss: 5.6856| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 1|  NKD Loss: 1.2657
Epoch: 1|  Loss:  3.3093 |Global loss: 5.712| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 1.2651
Epoch: 2|  Loss:  3.3078 |Global loss: 5.7022| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 3|  NKD Loss: 1.2677
Epoch: 3|  Loss:  3.2905 |Global loss: 5.6985| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 0|  NKD Loss: 1.2663
Epoch: 0|  Loss:  3.113 |Global loss: 5.7335| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 1.2602
Epoch: 1|  Loss:  3.1055 |Global loss: 5.744| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 2|  NKD Loss: 1.2459
Epoch: 2|  Loss:  3.0735 |Global loss: 5.7553| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 3|  NKD Loss: 1.2769
Epoch: 3|  Loss:  3.0858 |Global loss: 5.7377| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.2674
Epoch: 0|  Loss:  3.1098 |Global loss: 5.7278| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 1|  NKD Loss: 1.2872
Epoch: 1|  Loss:  3.1126 |Global loss: 5.7243| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 1.2805
Epoch: 2|  Loss:  3.096 |Global loss: 5.7202| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 3|  NKD Loss: 1.2611
Epoch: 3|  Loss:  3.0803 |Global loss: 5.7388| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 0|  NKD Loss: 1.2795
Epoch: 0|  Loss:  3.3261 |Global loss: 5.6884| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 1|  NKD Loss: 1.2809
Epoch: 1|  Loss:  3.3322 |Global loss: 5.6921| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 2|  NKD Loss: 1.2514
Epoch: 2|  Loss:  3.3057 |Global loss: 5.7115| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.2623
Epoch: 3|  Loss:  3.2968 |Global loss: 5.7048| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 0|  NKD Loss: 1.25
Epoch: 0|  Loss:  3.7822 |Global loss: 5.6459| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.2446
Epoch: 1|  Loss:  3.7687 |Global loss: 5.6476| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 2|  NKD Loss: 1.2484
Epoch: 2|  Loss:  3.7609 |Global loss: 5.6417| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.2583
Epoch: 3|  Loss:  3.7484 |Global loss: 5.6483| Local H loss: 0.0112  | Global H loss: 0.0112
------------------------- time cost ------------------------- 2.827164649963379
Chosen Clients:  [6, 5, 0, 2, 12, 8]

-------------Round number: 122-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [98.891, 99.008, 102.857, 105.218, 100.737, 102.178, 103.116, 98.118, 104.33, 102.698, 103.895, 103.428, 92.654, 102.965, 104.605]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.4133
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8471
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0266
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2749
Epoch: 0|  Loss:  3.291 |Global loss: 5.7025| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 1|  NKD Loss: 1.2686
Epoch: 1|  Loss:  3.2833 |Global loss: 5.7048| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.2678
Epoch: 2|  Loss:  3.2786 |Global loss: 5.6995| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 3|  NKD Loss: 1.2525
Epoch: 3|  Loss:  3.2552 |Global loss: 5.7231| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 0|  NKD Loss: 1.2317
Epoch: 0|  Loss:  3.4193 |Global loss: 5.6611| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 1.2411
Epoch: 1|  Loss:  3.4026 |Global loss: 5.6654| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 2|  NKD Loss: 1.2494
Epoch: 2|  Loss:  3.3845 |Global loss: 5.6601| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 3|  NKD Loss: 1.2402
Epoch: 3|  Loss:  3.3633 |Global loss: 5.6703| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 0|  NKD Loss: 1.2092
Epoch: 0|  Loss:  3.7058 |Global loss: 5.6499| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 1|  NKD Loss: 1.2239
Epoch: 1|  Loss:  3.7038 |Global loss: 5.6337| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 2|  NKD Loss: 1.2338
Epoch: 2|  Loss:  3.6945 |Global loss: 5.6282| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2479
Epoch: 3|  Loss:  3.6983 |Global loss: 5.6136| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.2554
Epoch: 0|  Loss:  3.407 |Global loss: 5.678| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 1|  NKD Loss: 1.254
Epoch: 1|  Loss:  3.3996 |Global loss: 5.6721| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 2|  NKD Loss: 1.2525
Epoch: 2|  Loss:  3.3892 |Global loss: 5.6812| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 3|  NKD Loss: 1.2464
Epoch: 3|  Loss:  3.3822 |Global loss: 5.6873| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 1.2379
Epoch: 0|  Loss:  3.8674 |Global loss: 5.6562| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.262
Epoch: 1|  Loss:  3.8679 |Global loss: 5.6472| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2598
Epoch: 2|  Loss:  3.8541 |Global loss: 5.6516| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 3|  NKD Loss: 1.2755
Epoch: 3|  Loss:  3.8737 |Global loss: 5.6293| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 1.2825
Epoch: 0|  Loss:  3.1063 |Global loss: 5.7214| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 1|  NKD Loss: 1.2791
Epoch: 1|  Loss:  3.0649 |Global loss: 5.7339| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 2|  NKD Loss: 1.2634
Epoch: 2|  Loss:  3.055 |Global loss: 5.7438| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 3|  NKD Loss: 1.2644
Epoch: 3|  Loss:  3.0523 |Global loss: 5.7448| Local H loss: 0.0173  | Global H loss: 0.0173
------------------------- time cost ------------------------- 3.0772244930267334
Chosen Clients:  [13, 12, 10, 9, 6, 2]

-------------Round number: 123-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [99.578, 99.008, 103.674, 105.218, 100.737, 102.958, 103.686, 98.118, 104.65, 102.698, 103.895, 103.428, 93.27, 102.965, 104.605]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3985
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8492
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0259
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2948
Epoch: 0|  Loss:  3.098 |Global loss: 5.7224| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.2711
Epoch: 1|  Loss:  3.083 |Global loss: 5.734| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 2|  NKD Loss: 1.2546
Epoch: 2|  Loss:  3.0315 |Global loss: 5.7552| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 3|  NKD Loss: 1.2413
Epoch: 3|  Loss:  3.0321 |Global loss: 5.7585| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.2388
Epoch: 0|  Loss:  3.8417 |Global loss: 5.6626| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 1|  NKD Loss: 1.2682
Epoch: 1|  Loss:  3.8567 |Global loss: 5.6394| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2267
Epoch: 2|  Loss:  3.8475 |Global loss: 5.6725| Local H loss: 0.0095  | Global H loss: 0.0095
Epoch: 3|  NKD Loss: 1.2607
Epoch: 3|  Loss:  3.8498 |Global loss: 5.644| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.2356
Epoch: 0|  Loss:  3.315 |Global loss: 5.6627| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 1|  NKD Loss: 1.2386
Epoch: 1|  Loss:  3.3006 |Global loss: 5.661| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 2|  NKD Loss: 1.225
Epoch: 2|  Loss:  3.2866 |Global loss: 5.6829| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 3|  NKD Loss: 1.2496
Epoch: 3|  Loss:  3.2784 |Global loss: 5.6638| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 0|  NKD Loss: 1.2451
Epoch: 0|  Loss:  3.5082 |Global loss: 5.6643| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 1|  NKD Loss: 1.2711
Epoch: 1|  Loss:  3.491 |Global loss: 5.6534| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 2|  NKD Loss: 1.2518
Epoch: 2|  Loss:  3.4706 |Global loss: 5.6612| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.2633
Epoch: 3|  Loss:  3.4601 |Global loss: 5.6603| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 0|  NKD Loss: 1.2873
Epoch: 0|  Loss:  3.2744 |Global loss: 5.7024| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 1|  NKD Loss: 1.2478
Epoch: 1|  Loss:  3.2379 |Global loss: 5.7272| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 1.2617
Epoch: 2|  Loss:  3.2278 |Global loss: 5.7164| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2441
Epoch: 3|  Loss:  3.1967 |Global loss: 5.7372| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 0|  NKD Loss: 1.2377
Epoch: 0|  Loss:  3.3722 |Global loss: 5.7001| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 1.2612
Epoch: 1|  Loss:  3.3589 |Global loss: 5.6768| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 2|  NKD Loss: 1.2496
Epoch: 2|  Loss:  3.3466 |Global loss: 5.6939| Local H loss: 0.0146  | Global H loss: 0.0146
Epoch: 3|  NKD Loss: 1.2444
Epoch: 3|  Loss:  3.3266 |Global loss: 5.6993| Local H loss: 0.0148  | Global H loss: 0.0148
------------------------- time cost ------------------------- 2.695366859436035
Chosen Clients:  [8, 6, 10, 9, 11, 7]

-------------Round number: 124-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.058, 0.05]
AUC in each clients:  [99.578, 99.008, 104.248, 105.218, 100.737, 102.958, 103.978, 98.118, 104.65, 103.53, 104.191, 103.428, 93.589, 103.037, 104.605]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.027, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.094, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3780
Averaged Test Accurancy: 0.0589
Averaged Test AUC: 0.8505
Averaged Test F1_score: 0.0201
Averaged Test Recal score: 0.0943
Std Test Accurancy: 0.0212
Std Test AUC: 0.0260
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2764
Epoch: 0|  Loss:  3.0404 |Global loss: 5.7258| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2816
Epoch: 1|  Loss:  3.0218 |Global loss: 5.7275| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2444
Epoch: 2|  Loss:  3.0144 |Global loss: 5.7489| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.2528
Epoch: 3|  Loss:  3.0009 |Global loss: 5.7472| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.2741
Epoch: 0|  Loss:  3.2277 |Global loss: 5.7074| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 1.271
Epoch: 1|  Loss:  3.203 |Global loss: 5.7162| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 2|  NKD Loss: 1.266
Epoch: 2|  Loss:  3.1895 |Global loss: 5.7206| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.2676
Epoch: 3|  Loss:  3.1834 |Global loss: 5.7206| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.2251
Epoch: 0|  Loss:  3.254 |Global loss: 5.6816| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 1|  NKD Loss: 1.2346
Epoch: 1|  Loss:  3.2375 |Global loss: 5.683| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 2|  NKD Loss: 1.2505
Epoch: 2|  Loss:  3.238 |Global loss: 5.6694| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2495
Epoch: 3|  Loss:  3.2212 |Global loss: 5.6671| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 0|  NKD Loss: 1.2553
Epoch: 0|  Loss:  3.4347 |Global loss: 5.6648| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 1|  NKD Loss: 1.2587
Epoch: 1|  Loss:  3.4148 |Global loss: 5.6631| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 2|  NKD Loss: 1.2595
Epoch: 2|  Loss:  3.3915 |Global loss: 5.6713| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 3|  NKD Loss: 1.2536
Epoch: 3|  Loss:  3.3716 |Global loss: 5.6759| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 0|  NKD Loss: 1.2402
Epoch: 0|  Loss:  3.2074 |Global loss: 5.7072| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 1|  NKD Loss: 1.25
Epoch: 1|  Loss:  3.19 |Global loss: 5.7027| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.2543
Epoch: 2|  Loss:  3.1791 |Global loss: 5.7002| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2493
Epoch: 3|  Loss:  3.1569 |Global loss: 5.7031| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2372
Epoch: 0|  Loss:  3.7248 |Global loss: 5.6604| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 1|  NKD Loss: 1.2313
Epoch: 1|  Loss:  3.7209 |Global loss: 5.6632| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 2|  NKD Loss: 1.2572
Epoch: 2|  Loss:  3.7137 |Global loss: 5.6464| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 3|  NKD Loss: 1.2604
Epoch: 3|  Loss:  3.701 |Global loss: 5.6541| Local H loss: 0.0117  | Global H loss: 0.0117
------------------------- time cost ------------------------- 2.894350051879883
Chosen Clients:  [10, 3, 6, 7, 13, 4]

-------------Round number: 125-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.058, 0.05]
AUC in each clients:  [99.578, 99.008, 104.248, 105.218, 100.737, 102.958, 104.153, 98.906, 104.964, 104.41, 104.09, 104.015, 93.589, 103.037, 104.605]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.027, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.094, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3552
Averaged Test Accurancy: 0.0589
Averaged Test AUC: 0.8520
Averaged Test F1_score: 0.0201
Averaged Test Recal score: 0.0943
Std Test Accurancy: 0.0212
Std Test AUC: 0.0262
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2316
Epoch: 0|  Loss:  3.2018 |Global loss: 5.6894| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 1.2397
Epoch: 1|  Loss:  3.1944 |Global loss: 5.6891| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 2|  NKD Loss: 1.2367
Epoch: 2|  Loss:  3.1804 |Global loss: 5.6889| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 3|  NKD Loss: 1.2493
Epoch: 3|  Loss:  3.1626 |Global loss: 5.6866| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 0|  NKD Loss: 1.2714
Epoch: 0|  Loss:  3.0829 |Global loss: 5.7025| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2382
Epoch: 1|  Loss:  3.0713 |Global loss: 5.7138| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 1.2458
Epoch: 2|  Loss:  3.0616 |Global loss: 5.7109| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 3|  NKD Loss: 1.247
Epoch: 3|  Loss:  3.0495 |Global loss: 5.7203| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 0|  NKD Loss: 1.2871
Epoch: 0|  Loss:  3.1915 |Global loss: 5.709| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.2545
Epoch: 1|  Loss:  3.1674 |Global loss: 5.732| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 2|  NKD Loss: 1.2559
Epoch: 2|  Loss:  3.1525 |Global loss: 5.7307| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 3|  NKD Loss: 1.2609
Epoch: 3|  Loss:  3.1474 |Global loss: 5.734| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 0|  NKD Loss: 1.2223
Epoch: 0|  Loss:  3.6724 |Global loss: 5.6766| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 1|  NKD Loss: 1.2461
Epoch: 1|  Loss:  3.6647 |Global loss: 5.6651| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 2|  NKD Loss: 1.2613
Epoch: 2|  Loss:  3.6621 |Global loss: 5.6489| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.2545
Epoch: 3|  Loss:  3.6454 |Global loss: 5.6592| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.2674
Epoch: 0|  Loss:  3.0519 |Global loss: 5.744| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.2536
Epoch: 1|  Loss:  3.0175 |Global loss: 5.7512| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.2518
Epoch: 2|  Loss:  3.0098 |Global loss: 5.7578| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 3|  NKD Loss: 1.1976
Epoch: 3|  Loss:  2.9884 |Global loss: 5.7922| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 0|  NKD Loss: 1.2256
Epoch: 0|  Loss:  3.4583 |Global loss: 5.6652| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 1|  NKD Loss: 1.2384
Epoch: 1|  Loss:  3.4398 |Global loss: 5.6567| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 2|  NKD Loss: 1.2519
Epoch: 2|  Loss:  3.4149 |Global loss: 5.6553| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 3|  NKD Loss: 1.2487
Epoch: 3|  Loss:  3.4097 |Global loss: 5.6593| Local H loss: 0.0153  | Global H loss: 0.0153
------------------------- time cost ------------------------- 2.9693500995635986
Chosen Clients:  [2, 3, 12, 14, 9, 10]

-------------Round number: 126-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [99.578, 99.008, 104.248, 105.318, 101.534, 102.958, 104.42, 98.976, 104.964, 104.41, 104.174, 104.015, 93.589, 103.517, 104.605]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3294
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8530
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0262
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.236
Epoch: 0|  Loss:  3.3063 |Global loss: 5.7025| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 1|  NKD Loss: 1.2577
Epoch: 1|  Loss:  3.3045 |Global loss: 5.6907| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.2567
Epoch: 2|  Loss:  3.3003 |Global loss: 5.6904| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.2571
Epoch: 3|  Loss:  3.2791 |Global loss: 5.7011| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 0|  NKD Loss: 1.2484
Epoch: 0|  Loss:  3.0616 |Global loss: 5.7126| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 1.2405
Epoch: 1|  Loss:  3.0429 |Global loss: 5.7179| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2123
Epoch: 2|  Loss:  3.029 |Global loss: 5.7397| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 3|  NKD Loss: 1.233
Epoch: 3|  Loss:  3.0178 |Global loss: 5.7286| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 0|  NKD Loss: 1.2394
Epoch: 0|  Loss:  3.8186 |Global loss: 5.6725| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 1|  NKD Loss: 1.2515
Epoch: 1|  Loss:  3.831 |Global loss: 5.6567| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2662
Epoch: 2|  Loss:  3.8242 |Global loss: 5.6482| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2482
Epoch: 3|  Loss:  3.8158 |Global loss: 5.6589| Local H loss: 0.0097  | Global H loss: 0.0097
Epoch: 0|  NKD Loss: 1.2583
Epoch: 0|  Loss:  3.272 |Global loss: 5.7162| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 1|  NKD Loss: 1.2531
Epoch: 1|  Loss:  3.2644 |Global loss: 5.7067| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 2|  NKD Loss: 1.2518
Epoch: 2|  Loss:  3.245 |Global loss: 5.7142| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 3|  NKD Loss: 1.2628
Epoch: 3|  Loss:  3.2265 |Global loss: 5.716| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 0|  NKD Loss: 1.2525
Epoch: 0|  Loss:  3.3373 |Global loss: 5.6877| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 1|  NKD Loss: 1.2471
Epoch: 1|  Loss:  3.3194 |Global loss: 5.6828| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 1.2376
Epoch: 2|  Loss:  3.2918 |Global loss: 5.6924| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.2518
Epoch: 3|  Loss:  3.2814 |Global loss: 5.6956| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 0|  NKD Loss: 1.2094
Epoch: 0|  Loss:  3.1386 |Global loss: 5.7151| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 1|  NKD Loss: 1.2358
Epoch: 1|  Loss:  3.1386 |Global loss: 5.7031| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.2209
Epoch: 2|  Loss:  3.1231 |Global loss: 5.7122| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 3|  NKD Loss: 1.2215
Epoch: 3|  Loss:  3.1125 |Global loss: 5.7169| Local H loss: 0.017  | Global H loss: 0.017
------------------------- time cost ------------------------- 2.9557087421417236
Chosen Clients:  [13, 6, 12, 4, 2, 0]

-------------Round number: 127-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.05, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
AUC in each clients:  [99.578, 99.008, 104.43, 105.63, 101.534, 102.958, 104.42, 98.976, 104.964, 105.056, 104.438, 104.015, 94.354, 103.517, 104.865]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.008, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.083, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.3173
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.8543
Averaged Test F1_score: 0.0189
Averaged Test Recal score: 0.0935
Std Test Accurancy: 0.0213
Std Test AUC: 0.0257
Std Test F1: 0.0002
Std Test Recall: 0.0002
Epoch: 0|  NKD Loss: 1.2863
Epoch: 0|  Loss:  3.0243 |Global loss: 5.7392| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 1|  NKD Loss: 1.2699
Epoch: 1|  Loss:  3.0105 |Global loss: 5.7507| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 2|  NKD Loss: 1.2482
Epoch: 2|  Loss:  2.9945 |Global loss: 5.7669| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.2384
Epoch: 3|  Loss:  2.9755 |Global loss: 5.7679| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 0|  NKD Loss: 1.2554
Epoch: 0|  Loss:  3.1418 |Global loss: 5.7305| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 1.2608
Epoch: 1|  Loss:  3.1199 |Global loss: 5.7369| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 2|  NKD Loss: 1.235
Epoch: 2|  Loss:  3.1041 |Global loss: 5.7523| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 3|  NKD Loss: 1.2541
Epoch: 3|  Loss:  3.0981 |Global loss: 5.7365| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 0|  NKD Loss: 1.2321
Epoch: 0|  Loss:  3.8086 |Global loss: 5.6717| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2378
Epoch: 1|  Loss:  3.7968 |Global loss: 5.6713| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2555
Epoch: 2|  Loss:  3.8095 |Global loss: 5.6573| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 1.2455
Epoch: 3|  Loss:  3.8 |Global loss: 5.6698| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 1.234
Epoch: 0|  Loss:  3.3702 |Global loss: 5.6747| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 1|  NKD Loss: 1.2326
Epoch: 1|  Loss:  3.358 |Global loss: 5.6742| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 2|  NKD Loss: 1.2349
Epoch: 2|  Loss:  3.3429 |Global loss: 5.6739| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.2468
Epoch: 3|  Loss:  3.3234 |Global loss: 5.6736| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 0|  NKD Loss: 1.2584
Epoch: 0|  Loss:  3.2799 |Global loss: 5.6912| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 1|  NKD Loss: 1.2507
Epoch: 1|  Loss:  3.2682 |Global loss: 5.6993| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.2515
Epoch: 2|  Loss:  3.2489 |Global loss: 5.7095| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 3|  NKD Loss: 1.2588
Epoch: 3|  Loss:  3.2481 |Global loss: 5.6986| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 0|  NKD Loss: 1.201
Epoch: 0|  Loss:  3.6508 |Global loss: 5.6581| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2331
Epoch: 1|  Loss:  3.6388 |Global loss: 5.6379| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 2|  NKD Loss: 1.2262
Epoch: 2|  Loss:  3.6353 |Global loss: 5.6392| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 1.2482
Epoch: 3|  Loss:  3.6256 |Global loss: 5.6257| Local H loss: 0.0102  | Global H loss: 0.0102
------------------------- time cost ------------------------- 2.998950242996216
Chosen Clients:  [7, 5, 12, 14, 6, 4]

-------------Round number: 128-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.1, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05]
AUC in each clients:  [100.129, 99.008, 104.872, 105.63, 102.344, 102.958, 104.678, 98.976, 104.964, 105.056, 104.438, 104.015, 94.645, 103.9, 104.865]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.085, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.104, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.155, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.147, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2996
Averaged Test Accurancy: 0.0650
Averaged Test AUC: 0.8558
Averaged Test F1_score: 0.0304
Averaged Test Recal score: 0.1026
Std Test Accurancy: 0.0251
Std Test AUC: 0.0253
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2439
Epoch: 0|  Loss:  3.621 |Global loss: 5.6746| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 1|  NKD Loss: 1.2547
Epoch: 1|  Loss:  3.6182 |Global loss: 5.6633| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 2|  NKD Loss: 1.2366
Epoch: 2|  Loss:  3.5955 |Global loss: 5.677| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 3|  NKD Loss: 1.2553
Epoch: 3|  Loss:  3.5976 |Global loss: 5.6673| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.2264
Epoch: 0|  Loss:  3.3362 |Global loss: 5.6863| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 1|  NKD Loss: 1.2345
Epoch: 1|  Loss:  3.3253 |Global loss: 5.678| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 2|  NKD Loss: 1.2315
Epoch: 2|  Loss:  3.3075 |Global loss: 5.6819| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 3|  NKD Loss: 1.2339
Epoch: 3|  Loss:  3.2923 |Global loss: 5.6819| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 0|  NKD Loss: 1.2356
Epoch: 0|  Loss:  3.7909 |Global loss: 5.674| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.2421
Epoch: 1|  Loss:  3.796 |Global loss: 5.6665| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2425
Epoch: 2|  Loss:  3.7886 |Global loss: 5.6671| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2482
Epoch: 3|  Loss:  3.7872 |Global loss: 5.6639| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 0|  NKD Loss: 1.258
Epoch: 0|  Loss:  3.2079 |Global loss: 5.7225| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.262
Epoch: 1|  Loss:  3.206 |Global loss: 5.7158| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 2|  NKD Loss: 1.2531
Epoch: 2|  Loss:  3.1788 |Global loss: 5.7224| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 3|  NKD Loss: 1.2658
Epoch: 3|  Loss:  3.1791 |Global loss: 5.7144| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 0|  NKD Loss: 1.2679
Epoch: 0|  Loss:  3.1024 |Global loss: 5.7305| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 1|  NKD Loss: 1.254
Epoch: 1|  Loss:  3.0746 |Global loss: 5.7437| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.2635
Epoch: 2|  Loss:  3.073 |Global loss: 5.7316| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.2637
Epoch: 3|  Loss:  3.0621 |Global loss: 5.7424| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 1.2274
Epoch: 0|  Loss:  3.2957 |Global loss: 5.6883| Local H loss: 0.0166  | Global H loss: 0.0166
Epoch: 1|  NKD Loss: 1.2365
Epoch: 1|  Loss:  3.287 |Global loss: 5.6874| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 1.2551
Epoch: 2|  Loss:  3.2792 |Global loss: 5.6735| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2374
Epoch: 3|  Loss:  3.2512 |Global loss: 5.6855| Local H loss: 0.0173  | Global H loss: 0.0173
------------------------- time cost ------------------------- 2.8224759101867676
Chosen Clients:  [13, 3, 10, 11, 1, 7]

-------------Round number: 129-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.092, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.1, 0.05]
AUC in each clients:  [100.129, 99.008, 104.872, 105.63, 103.477, 103.538, 104.754, 100.333, 104.964, 105.056, 104.438, 104.015, 95.529, 103.9, 105.245]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.078, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.104, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.143, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.147, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2815
Averaged Test Accurancy: 0.0644
Averaged Test AUC: 0.8583
Averaged Test F1_score: 0.0299
Averaged Test Recal score: 0.1018
Std Test Accurancy: 0.0244
Std Test AUC: 0.0234
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2924
Epoch: 0|  Loss:  3.0062 |Global loss: 5.7406| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 1|  NKD Loss: 1.2634
Epoch: 1|  Loss:  2.9735 |Global loss: 5.757| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 2|  NKD Loss: 1.2485
Epoch: 2|  Loss:  2.9742 |Global loss: 5.7637| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 3|  NKD Loss: 1.249
Epoch: 3|  Loss:  2.9614 |Global loss: 5.7661| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 0|  NKD Loss: 1.2586
Epoch: 0|  Loss:  3.0357 |Global loss: 5.7106| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 1.2482
Epoch: 1|  Loss:  3.035 |Global loss: 5.714| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 2|  NKD Loss: 1.2201
Epoch: 2|  Loss:  2.9974 |Global loss: 5.7325| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2311
Epoch: 3|  Loss:  2.9816 |Global loss: 5.7329| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2584
Epoch: 0|  Loss:  3.1242 |Global loss: 5.6922| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 1|  NKD Loss: 1.2487
Epoch: 1|  Loss:  3.0987 |Global loss: 5.6978| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 2|  NKD Loss: 1.2386
Epoch: 2|  Loss:  3.0895 |Global loss: 5.7115| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 3|  NKD Loss: 1.2476
Epoch: 3|  Loss:  3.0851 |Global loss: 5.7065| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.2531
Epoch: 0|  Loss:  3.1512 |Global loss: 5.7074| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 1|  NKD Loss: 1.2574
Epoch: 1|  Loss:  3.1398 |Global loss: 5.6994| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.2419
Epoch: 2|  Loss:  3.1223 |Global loss: 5.7101| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 3|  NKD Loss: 1.2603
Epoch: 3|  Loss:  3.1228 |Global loss: 5.7002| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.228
Epoch: 0|  Loss:  3.7172 |Global loss: 5.642| Local H loss: 0.0089  | Global H loss: 0.0089
Epoch: 1|  NKD Loss: 1.2239
Epoch: 1|  Loss:  3.7229 |Global loss: 5.627| Local H loss: 0.009  | Global H loss: 0.009
Epoch: 2|  NKD Loss: 1.2507
Epoch: 2|  Loss:  3.7108 |Global loss: 5.6208| Local H loss: 0.0092  | Global H loss: 0.0092
Epoch: 3|  NKD Loss: 1.2611
Epoch: 3|  Loss:  3.7011 |Global loss: 5.6063| Local H loss: 0.0093  | Global H loss: 0.0093
Epoch: 0|  NKD Loss: 1.2362
Epoch: 0|  Loss:  3.5707 |Global loss: 5.6813| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 1|  NKD Loss: 1.2593
Epoch: 1|  Loss:  3.5698 |Global loss: 5.6654| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 2|  NKD Loss: 1.2356
Epoch: 2|  Loss:  3.5494 |Global loss: 5.6883| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.2544
Epoch: 3|  Loss:  3.5395 |Global loss: 5.6854| Local H loss: 0.0131  | Global H loss: 0.0131
------------------------- time cost ------------------------- 2.874119758605957
Chosen Clients:  [7, 11, 0, 14, 1, 3]

-------------Round number: 130-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.092, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.125, 0.05]
AUC in each clients:  [100.129, 99.846, 104.872, 105.648, 103.477, 103.538, 104.754, 100.886, 104.964, 105.056, 104.322, 104.722, 95.529, 104.166, 105.245]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.078, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.13, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.143, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.182, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2621
Averaged Test Accurancy: 0.0661
Averaged Test AUC: 0.8595
Averaged Test F1_score: 0.0317
Averaged Test Recal score: 0.1041
Std Test Accurancy: 0.0275
Std Test AUC: 0.0227
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2586
Epoch: 0|  Loss:  3.5195 |Global loss: 5.681| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 1.2417
Epoch: 1|  Loss:  3.5112 |Global loss: 5.6869| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 2|  NKD Loss: 1.2554
Epoch: 2|  Loss:  3.498 |Global loss: 5.681| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 3|  NKD Loss: 1.2556
Epoch: 3|  Loss:  3.4925 |Global loss: 5.6788| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 0|  NKD Loss: 1.2408
Epoch: 0|  Loss:  3.0952 |Global loss: 5.7113| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.2326
Epoch: 1|  Loss:  3.0733 |Global loss: 5.7178| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.2341
Epoch: 2|  Loss:  3.0682 |Global loss: 5.7161| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 3|  NKD Loss: 1.2202
Epoch: 3|  Loss:  3.0442 |Global loss: 5.7254| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 0|  NKD Loss: 1.2055
Epoch: 0|  Loss:  3.5894 |Global loss: 5.6612| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 1.2344
Epoch: 1|  Loss:  3.5933 |Global loss: 5.6414| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 2|  NKD Loss: 1.2371
Epoch: 2|  Loss:  3.5704 |Global loss: 5.6496| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 3|  NKD Loss: 1.2446
Epoch: 3|  Loss:  3.5609 |Global loss: 5.6362| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.2462
Epoch: 0|  Loss:  3.1463 |Global loss: 5.7308| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 1|  NKD Loss: 1.2739
Epoch: 1|  Loss:  3.1491 |Global loss: 5.7167| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.2587
Epoch: 2|  Loss:  3.1275 |Global loss: 5.7271| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.2492
Epoch: 3|  Loss:  3.1054 |Global loss: 5.7327| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 1.2043
Epoch: 0|  Loss:  3.6564 |Global loss: 5.656| Local H loss: 0.0094  | Global H loss: 0.0094
Epoch: 1|  NKD Loss: 1.2398
Epoch: 1|  Loss:  3.651 |Global loss: 5.6391| Local H loss: 0.0096  | Global H loss: 0.0096
Epoch: 2|  NKD Loss: 1.2221
Epoch: 2|  Loss:  3.6379 |Global loss: 5.6338| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.244
Epoch: 3|  Loss:  3.6195 |Global loss: 5.6336| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 0|  NKD Loss: 1.2258
Epoch: 0|  Loss:  2.9964 |Global loss: 5.7226| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2431
Epoch: 1|  Loss:  2.989 |Global loss: 5.7233| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 2|  NKD Loss: 1.2345
Epoch: 2|  Loss:  2.9887 |Global loss: 5.7249| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.2291
Epoch: 3|  Loss:  2.9511 |Global loss: 5.7297| Local H loss: 0.0191  | Global H loss: 0.0191
------------------------- time cost ------------------------- 2.8917605876922607
Chosen Clients:  [10, 9, 7, 4, 6, 11]

-------------Round number: 131-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.092, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.125, 0.05]
AUC in each clients:  [100.985, 100.281, 104.872, 105.752, 103.477, 103.538, 104.754, 100.742, 104.964, 105.056, 104.322, 105.42, 95.529, 104.166, 105.542]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.078, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.13, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.143, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.182, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2424
Averaged Test Accurancy: 0.0661
Averaged Test AUC: 0.8608
Averaged Test F1_score: 0.0317
Averaged Test Recal score: 0.1041
Std Test Accurancy: 0.0275
Std Test AUC: 0.0225
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2708
Epoch: 0|  Loss:  3.0731 |Global loss: 5.6975| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 1|  NKD Loss: 1.2242
Epoch: 1|  Loss:  3.0541 |Global loss: 5.7291| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.2438
Epoch: 2|  Loss:  3.0423 |Global loss: 5.7143| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 3|  NKD Loss: 1.2384
Epoch: 3|  Loss:  3.037 |Global loss: 5.7191| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 0|  NKD Loss: 1.2468
Epoch: 0|  Loss:  3.2597 |Global loss: 5.6957| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.2549
Epoch: 1|  Loss:  3.237 |Global loss: 5.6897| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.2617
Epoch: 2|  Loss:  3.2264 |Global loss: 5.6881| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 3|  NKD Loss: 1.2471
Epoch: 3|  Loss:  3.1983 |Global loss: 5.6969| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 0|  NKD Loss: 1.2557
Epoch: 0|  Loss:  3.4773 |Global loss: 5.6872| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 1|  NKD Loss: 1.256
Epoch: 1|  Loss:  3.4614 |Global loss: 5.6962| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 2|  NKD Loss: 1.2586
Epoch: 2|  Loss:  3.4621 |Global loss: 5.6869| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 3|  NKD Loss: 1.2581
Epoch: 3|  Loss:  3.4609 |Global loss: 5.6842| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 0|  NKD Loss: 1.2256
Epoch: 0|  Loss:  3.2449 |Global loss: 5.6982| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.2618
Epoch: 1|  Loss:  3.2343 |Global loss: 5.6846| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.2437
Epoch: 2|  Loss:  3.2091 |Global loss: 5.6904| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.227
Epoch: 3|  Loss:  3.1824 |Global loss: 5.7083| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 0|  NKD Loss: 1.2735
Epoch: 0|  Loss:  3.0683 |Global loss: 5.7259| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.2674
Epoch: 1|  Loss:  3.0479 |Global loss: 5.7348| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 2|  NKD Loss: 1.2463
Epoch: 2|  Loss:  3.0152 |Global loss: 5.7491| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.2263
Epoch: 3|  Loss:  2.9935 |Global loss: 5.7614| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 0|  NKD Loss: 1.2626
Epoch: 0|  Loss:  3.0423 |Global loss: 5.6997| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 1|  NKD Loss: 1.2059
Epoch: 1|  Loss:  3.0187 |Global loss: 5.7307| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 2|  NKD Loss: 1.2344
Epoch: 2|  Loss:  2.9991 |Global loss: 5.7244| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2489
Epoch: 3|  Loss:  2.9845 |Global loss: 5.7128| Local H loss: 0.0206  | Global H loss: 0.0206
------------------------- time cost ------------------------- 3.456125259399414
Chosen Clients:  [7, 4, 5, 10, 6, 1]

-------------Round number: 132-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.05, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.125, 0.05]
AUC in each clients:  [100.985, 100.281, 104.872, 105.752, 104.259, 103.538, 104.983, 101.294, 104.964, 105.624, 104.537, 105.601, 95.529, 104.166, 105.542]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.008, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.13, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.083, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.182, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.2147
Averaged Test Accurancy: 0.0672
Averaged Test AUC: 0.8622
Averaged Test F1_score: 0.0326
Averaged Test Recal score: 0.1057
Std Test Accurancy: 0.0288
Std Test AUC: 0.0227
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2408
Epoch: 0|  Loss:  3.4228 |Global loss: 5.7125| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.2292
Epoch: 1|  Loss:  3.4125 |Global loss: 5.7187| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 2|  NKD Loss: 1.2545
Epoch: 2|  Loss:  3.4132 |Global loss: 5.7001| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 3|  NKD Loss: 1.2553
Epoch: 3|  Loss:  3.4003 |Global loss: 5.7082| Local H loss: 0.0144  | Global H loss: 0.0144
Epoch: 0|  NKD Loss: 1.2326
Epoch: 0|  Loss:  3.1633 |Global loss: 5.7044| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 1|  NKD Loss: 1.238
Epoch: 1|  Loss:  3.1646 |Global loss: 5.7019| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 2|  NKD Loss: 1.2475
Epoch: 2|  Loss:  3.1444 |Global loss: 5.7017| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2311
Epoch: 3|  Loss:  3.109 |Global loss: 5.7093| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2282
Epoch: 0|  Loss:  3.2683 |Global loss: 5.6931| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.2424
Epoch: 1|  Loss:  3.2535 |Global loss: 5.6794| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.236
Epoch: 2|  Loss:  3.2358 |Global loss: 5.6927| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 3|  NKD Loss: 1.2357
Epoch: 3|  Loss:  3.231 |Global loss: 5.6902| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 0|  NKD Loss: 1.252
Epoch: 0|  Loss:  3.0406 |Global loss: 5.707| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 1|  NKD Loss: 1.2254
Epoch: 1|  Loss:  3.0076 |Global loss: 5.7361| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 2|  NKD Loss: 1.233
Epoch: 2|  Loss:  3.0102 |Global loss: 5.732| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 3|  NKD Loss: 1.2333
Epoch: 3|  Loss:  2.9867 |Global loss: 5.7294| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 0|  NKD Loss: 1.2801
Epoch: 0|  Loss:  3.0277 |Global loss: 5.7299| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.245
Epoch: 1|  Loss:  2.998 |Global loss: 5.7518| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.251
Epoch: 2|  Loss:  2.98 |Global loss: 5.7482| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 1.2277
Epoch: 3|  Loss:  2.9555 |Global loss: 5.7651| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 0|  NKD Loss: 1.2151
Epoch: 0|  Loss:  3.5893 |Global loss: 5.6548| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 1.2217
Epoch: 1|  Loss:  3.5723 |Global loss: 5.6498| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.2482
Epoch: 2|  Loss:  3.5738 |Global loss: 5.6291| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2319
Epoch: 3|  Loss:  3.5494 |Global loss: 5.6468| Local H loss: 0.0105  | Global H loss: 0.0105
------------------------- time cost ------------------------- 2.7528374195098877
Chosen Clients:  [12, 2, 6, 9, 8, 0]

-------------Round number: 133-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.092, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.125, 0.05]
AUC in each clients:  [100.985, 100.88, 104.872, 105.752, 104.93, 104.295, 105.104, 102.052, 104.964, 105.624, 104.98, 105.601, 95.529, 104.166, 105.542]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.064, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.13, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.125, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.182, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1945
Averaged Test Accurancy: 0.0700
Averaged Test AUC: 0.8640
Averaged Test F1_score: 0.0363
Averaged Test Recal score: 0.1085
Std Test Accurancy: 0.0290
Std Test AUC: 0.0224
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.233
Epoch: 0|  Loss:  3.757 |Global loss: 5.6848| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 1|  NKD Loss: 1.247
Epoch: 1|  Loss:  3.7729 |Global loss: 5.6579| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2629
Epoch: 2|  Loss:  3.7647 |Global loss: 5.6548| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 3|  NKD Loss: 1.2633
Epoch: 3|  Loss:  3.7687 |Global loss: 5.658| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 0|  NKD Loss: 1.2425
Epoch: 0|  Loss:  3.2295 |Global loss: 5.7129| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 1|  NKD Loss: 1.2251
Epoch: 1|  Loss:  3.2061 |Global loss: 5.7258| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 2|  NKD Loss: 1.258
Epoch: 2|  Loss:  3.2119 |Global loss: 5.7084| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 3|  NKD Loss: 1.2323
Epoch: 3|  Loss:  3.1882 |Global loss: 5.7237| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 0|  NKD Loss: 1.2635
Epoch: 0|  Loss:  2.9689 |Global loss: 5.7446| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 1|  NKD Loss: 1.2659
Epoch: 1|  Loss:  2.9527 |Global loss: 5.7438| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 2|  NKD Loss: 1.2558
Epoch: 2|  Loss:  2.9435 |Global loss: 5.7466| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 3|  NKD Loss: 1.238
Epoch: 3|  Loss:  2.9245 |Global loss: 5.7649| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 0|  NKD Loss: 1.2557
Epoch: 0|  Loss:  3.1863 |Global loss: 5.703| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 1|  NKD Loss: 1.2499
Epoch: 1|  Loss:  3.1621 |Global loss: 5.7076| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 2|  NKD Loss: 1.2524
Epoch: 2|  Loss:  3.1392 |Global loss: 5.7122| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 1.2447
Epoch: 3|  Loss:  3.1179 |Global loss: 5.7137| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 0|  NKD Loss: 1.2627
Epoch: 0|  Loss:  3.0044 |Global loss: 5.743| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 1|  NKD Loss: 1.2364
Epoch: 1|  Loss:  2.9873 |Global loss: 5.7517| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2351
Epoch: 2|  Loss:  2.9646 |Global loss: 5.7613| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 3|  NKD Loss: 1.2471
Epoch: 3|  Loss:  2.9674 |Global loss: 5.7611| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 0|  NKD Loss: 1.2281
Epoch: 0|  Loss:  3.5399 |Global loss: 5.6482| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.2208
Epoch: 1|  Loss:  3.5211 |Global loss: 5.657| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 2|  NKD Loss: 1.2428
Epoch: 2|  Loss:  3.51 |Global loss: 5.6422| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 3|  NKD Loss: 1.2495
Epoch: 3|  Loss:  3.5038 |Global loss: 5.6383| Local H loss: 0.0115  | Global H loss: 0.0115
------------------------- time cost ------------------------- 2.891512155532837
Chosen Clients:  [0, 13, 1, 2, 6, 8]

-------------Round number: 134-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.092, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.125, 0.05]
AUC in each clients:  [101.733, 100.88, 105.061, 105.752, 104.93, 104.295, 105.602, 102.052, 105.481, 105.997, 104.98, 105.601, 96.07, 104.166, 105.542]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.064, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.13, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.125, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.182, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1771
Averaged Test Accurancy: 0.0700
Averaged Test AUC: 0.8656
Averaged Test F1_score: 0.0363
Averaged Test Recal score: 0.1085
Std Test Accurancy: 0.0290
Std Test AUC: 0.0216
Std Test F1: 0.0003
Std Test Recall: 0.0003
Epoch: 0|  NKD Loss: 1.2223
Epoch: 0|  Loss:  3.4639 |Global loss: 5.6645| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 1|  NKD Loss: 1.2403
Epoch: 1|  Loss:  3.4498 |Global loss: 5.6573| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 2|  NKD Loss: 1.2236
Epoch: 2|  Loss:  3.4384 |Global loss: 5.6633| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.2495
Epoch: 3|  Loss:  3.4294 |Global loss: 5.6485| Local H loss: 0.0124  | Global H loss: 0.0124
Epoch: 0|  NKD Loss: 1.2527
Epoch: 0|  Loss:  2.9601 |Global loss: 5.7631| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 1.2638
Epoch: 1|  Loss:  2.9536 |Global loss: 5.7544| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 2|  NKD Loss: 1.2484
Epoch: 2|  Loss:  2.9272 |Global loss: 5.759| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 3|  NKD Loss: 1.2315
Epoch: 3|  Loss:  2.9112 |Global loss: 5.7774| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 0|  NKD Loss: 1.2189
Epoch: 0|  Loss:  3.5132 |Global loss: 5.6597| Local H loss: 0.0107  | Global H loss: 0.0107
Epoch: 1|  NKD Loss: 1.216
Epoch: 1|  Loss:  3.4997 |Global loss: 5.6615| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 1.2374
Epoch: 2|  Loss:  3.4874 |Global loss: 5.6461| Local H loss: 0.0112  | Global H loss: 0.0112
Epoch: 3|  NKD Loss: 1.2414
Epoch: 3|  Loss:  3.4796 |Global loss: 5.6421| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 0|  NKD Loss: 1.2485
Epoch: 0|  Loss:  3.1793 |Global loss: 5.7193| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 1|  NKD Loss: 1.2566
Epoch: 1|  Loss:  3.1885 |Global loss: 5.7086| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 2|  NKD Loss: 1.2449
Epoch: 2|  Loss:  3.1707 |Global loss: 5.7222| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 3|  NKD Loss: 1.2428
Epoch: 3|  Loss:  3.1484 |Global loss: 5.7354| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 0|  NKD Loss: 1.275
Epoch: 0|  Loss:  2.9334 |Global loss: 5.7373| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 1.2503
Epoch: 1|  Loss:  2.9105 |Global loss: 5.7528| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.2414
Epoch: 2|  Loss:  2.8934 |Global loss: 5.7557| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.2382
Epoch: 3|  Loss:  2.8756 |Global loss: 5.7661| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.2837
Epoch: 0|  Loss:  2.9713 |Global loss: 5.7344| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 1.253
Epoch: 1|  Loss:  2.9461 |Global loss: 5.7493| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 2|  NKD Loss: 1.2432
Epoch: 2|  Loss:  2.9188 |Global loss: 5.7655| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2416
Epoch: 3|  Loss:  2.9168 |Global loss: 5.7613| Local H loss: 0.0186  | Global H loss: 0.0186
------------------------- time cost ------------------------- 2.941448926925659
Chosen Clients:  [10, 9, 4, 6, 13, 14]

-------------Round number: 135-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.092, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.225, 0.05]
AUC in each clients:  [102.486, 101.589, 104.972, 105.752, 104.93, 104.295, 105.82, 102.052, 105.846, 105.997, 104.98, 105.601, 96.07, 104.683, 105.542]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.064, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.229, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.125, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.28, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1540
Averaged Test Accurancy: 0.0767
Averaged Test AUC: 0.8670
Averaged Test F1_score: 0.0429
Averaged Test Recal score: 0.1151
Std Test Accurancy: 0.0469
Std Test AUC: 0.0212
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2506
Epoch: 0|  Loss:  2.9933 |Global loss: 5.7214| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.228
Epoch: 1|  Loss:  2.98 |Global loss: 5.7449| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 2|  NKD Loss: 1.2216
Epoch: 2|  Loss:  2.9746 |Global loss: 5.7489| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 3|  NKD Loss: 1.2326
Epoch: 3|  Loss:  2.9543 |Global loss: 5.7473| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 0|  NKD Loss: 1.2472
Epoch: 0|  Loss:  3.1042 |Global loss: 5.721| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 1|  NKD Loss: 1.2533
Epoch: 1|  Loss:  3.0839 |Global loss: 5.7209| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.2269
Epoch: 2|  Loss:  3.0613 |Global loss: 5.7279| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.2514
Epoch: 3|  Loss:  3.0535 |Global loss: 5.7233| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 0|  NKD Loss: 1.2274
Epoch: 0|  Loss:  3.1112 |Global loss: 5.7141| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2093
Epoch: 1|  Loss:  3.0799 |Global loss: 5.7292| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 2|  NKD Loss: 1.2367
Epoch: 2|  Loss:  3.0717 |Global loss: 5.7154| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 3|  NKD Loss: 1.2203
Epoch: 3|  Loss:  3.0529 |Global loss: 5.727| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.2608
Epoch: 0|  Loss:  2.8854 |Global loss: 5.7465| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.2482
Epoch: 1|  Loss:  2.8659 |Global loss: 5.756| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 2|  NKD Loss: 1.2516
Epoch: 2|  Loss:  2.8569 |Global loss: 5.76| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 3|  NKD Loss: 1.2284
Epoch: 3|  Loss:  2.827 |Global loss: 5.7684| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.2318
Epoch: 0|  Loss:  2.899 |Global loss: 5.7781| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 1.2678
Epoch: 1|  Loss:  2.9049 |Global loss: 5.7605| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 2|  NKD Loss: 1.2183
Epoch: 2|  Loss:  2.8955 |Global loss: 5.7829| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 3|  NKD Loss: 1.2336
Epoch: 3|  Loss:  2.8874 |Global loss: 5.7762| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 0|  NKD Loss: 1.2305
Epoch: 0|  Loss:  3.0725 |Global loss: 5.746| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.2481
Epoch: 1|  Loss:  3.0591 |Global loss: 5.7435| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 2|  NKD Loss: 1.2493
Epoch: 2|  Loss:  3.058 |Global loss: 5.7366| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 3|  NKD Loss: 1.2599
Epoch: 3|  Loss:  3.0444 |Global loss: 5.7392| Local H loss: 0.0179  | Global H loss: 0.0179
------------------------- time cost ------------------------- 3.0108795166015625
Chosen Clients:  [6, 1, 0, 14, 11, 2]

-------------Round number: 136-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.158, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.225, 0.05]
AUC in each clients:  [102.486, 101.589, 104.972, 105.752, 106.079, 104.295, 106.222, 102.052, 105.846, 106.454, 105.497, 105.601, 96.07, 104.919, 105.788]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.134, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.229, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.194, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.28, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1176
Averaged Test Accurancy: 0.0811
Averaged Test AUC: 0.8687
Averaged Test F1_score: 0.0476
Averaged Test Recal score: 0.1197
Std Test Accurancy: 0.0511
Std Test AUC: 0.0221
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2457
Epoch: 0|  Loss:  2.8302 |Global loss: 5.7594| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 1|  NKD Loss: 1.2313
Epoch: 1|  Loss:  2.8071 |Global loss: 5.7703| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 2|  NKD Loss: 1.2017
Epoch: 2|  Loss:  2.7868 |Global loss: 5.7852| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 3|  NKD Loss: 1.2284
Epoch: 3|  Loss:  2.7775 |Global loss: 5.7773| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 0|  NKD Loss: 1.2162
Epoch: 0|  Loss:  3.4325 |Global loss: 5.6773| Local H loss: 0.0114  | Global H loss: 0.0114
Epoch: 1|  NKD Loss: 1.1989
Epoch: 1|  Loss:  3.4211 |Global loss: 5.6754| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 2|  NKD Loss: 1.2006
Epoch: 2|  Loss:  3.3941 |Global loss: 5.684| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.2278
Epoch: 3|  Loss:  3.3881 |Global loss: 5.6654| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.1995
Epoch: 0|  Loss:  3.3803 |Global loss: 5.6933| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 1.2306
Epoch: 1|  Loss:  3.3618 |Global loss: 5.6729| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 2|  NKD Loss: 1.2074
Epoch: 2|  Loss:  3.3547 |Global loss: 5.6869| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.2461
Epoch: 3|  Loss:  3.3462 |Global loss: 5.6624| Local H loss: 0.0133  | Global H loss: 0.0133
Epoch: 0|  NKD Loss: 1.2354
Epoch: 0|  Loss:  3.0196 |Global loss: 5.7467| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2554
Epoch: 1|  Loss:  3.0056 |Global loss: 5.7462| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2553
Epoch: 2|  Loss:  2.9977 |Global loss: 5.7455| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 3|  NKD Loss: 1.2489
Epoch: 3|  Loss:  2.9877 |Global loss: 5.7405| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 0|  NKD Loss: 1.2135
Epoch: 0|  Loss:  2.9636 |Global loss: 5.7309| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.2091
Epoch: 1|  Loss:  2.9305 |Global loss: 5.7363| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 2|  NKD Loss: 1.2206
Epoch: 2|  Loss:  2.9285 |Global loss: 5.7274| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 3|  NKD Loss: 1.227
Epoch: 3|  Loss:  2.9129 |Global loss: 5.7212| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 0|  NKD Loss: 1.221
Epoch: 0|  Loss:  3.1359 |Global loss: 5.7314| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 1|  NKD Loss: 1.2376
Epoch: 1|  Loss:  3.1248 |Global loss: 5.7341| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 2|  NKD Loss: 1.2439
Epoch: 2|  Loss:  3.1261 |Global loss: 5.726| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 3|  NKD Loss: 1.2419
Epoch: 3|  Loss:  3.1037 |Global loss: 5.7354| Local H loss: 0.0169  | Global H loss: 0.0169
------------------------- time cost ------------------------- 2.886828660964966
Chosen Clients:  [3, 10, 0, 8, 4, 13]

-------------Round number: 137-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.158, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.225, 0.05]
AUC in each clients:  [103.241, 102.383, 105.184, 105.752, 106.079, 104.295, 106.508, 102.052, 105.846, 106.454, 105.497, 106.141, 96.07, 104.919, 106.142]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.134, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.229, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.194, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.28, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.1061
Averaged Test Accurancy: 0.0811
Averaged Test AUC: 0.8703
Averaged Test F1_score: 0.0476
Averaged Test Recal score: 0.1197
Std Test Accurancy: 0.0511
Std Test AUC: 0.0219
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2183
Epoch: 0|  Loss:  2.952 |Global loss: 5.7372| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 1|  NKD Loss: 1.2173
Epoch: 1|  Loss:  2.9417 |Global loss: 5.7343| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.2243
Epoch: 2|  Loss:  2.9244 |Global loss: 5.7369| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 3|  NKD Loss: 1.2325
Epoch: 3|  Loss:  2.9404 |Global loss: 5.7286| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.2236
Epoch: 0|  Loss:  2.9521 |Global loss: 5.7528| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2163
Epoch: 1|  Loss:  2.9467 |Global loss: 5.7565| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 2|  NKD Loss: 1.2256
Epoch: 2|  Loss:  2.9238 |Global loss: 5.7547| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 3|  NKD Loss: 1.2309
Epoch: 3|  Loss:  2.9198 |Global loss: 5.7467| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.2092
Epoch: 0|  Loss:  3.3036 |Global loss: 5.6934| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 1.2033
Epoch: 1|  Loss:  3.2797 |Global loss: 5.7039| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 2|  NKD Loss: 1.2375
Epoch: 2|  Loss:  3.2795 |Global loss: 5.6724| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 1.2312
Epoch: 3|  Loss:  3.257 |Global loss: 5.6817| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 0|  NKD Loss: 1.2518
Epoch: 0|  Loss:  2.9158 |Global loss: 5.7488| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 1|  NKD Loss: 1.2479
Epoch: 1|  Loss:  2.8897 |Global loss: 5.7661| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 2|  NKD Loss: 1.2307
Epoch: 2|  Loss:  2.8865 |Global loss: 5.7697| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 3|  NKD Loss: 1.2434
Epoch: 3|  Loss:  2.8834 |Global loss: 5.7581| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 0|  NKD Loss: 1.2272
Epoch: 0|  Loss:  3.0309 |Global loss: 5.7268| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 1|  NKD Loss: 1.2364
Epoch: 1|  Loss:  3.0277 |Global loss: 5.7189| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 2|  NKD Loss: 1.2229
Epoch: 2|  Loss:  3.0127 |Global loss: 5.7284| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.235
Epoch: 3|  Loss:  3.005 |Global loss: 5.7213| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 0|  NKD Loss: 1.2577
Epoch: 0|  Loss:  2.9022 |Global loss: 5.7614| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.257
Epoch: 1|  Loss:  2.8958 |Global loss: 5.7601| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 2|  NKD Loss: 1.2222
Epoch: 2|  Loss:  2.8753 |Global loss: 5.7865| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 3|  NKD Loss: 1.2303
Epoch: 3|  Loss:  2.8616 |Global loss: 5.7849| Local H loss: 0.0209  | Global H loss: 0.0209
------------------------- time cost ------------------------- 2.8023428916931152
Chosen Clients:  [5, 7, 2, 0, 8, 9]

-------------Round number: 138-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.142, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.25, 0.05]
AUC in each clients:  [103.854, 102.383, 105.184, 105.987, 106.811, 104.295, 106.508, 102.052, 106.161, 106.454, 105.467, 106.141, 96.07, 105.054, 106.142]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.109, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.244, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.176, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.304, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0741
Averaged Test Accurancy: 0.0817
Averaged Test AUC: 0.8714
Averaged Test F1_score: 0.0469
Averaged Test Recal score: 0.1201
Std Test Accurancy: 0.0545
Std Test AUC: 0.0223
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2015
Epoch: 0|  Loss:  3.1888 |Global loss: 5.7222| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 1|  NKD Loss: 1.2135
Epoch: 1|  Loss:  3.1722 |Global loss: 5.7112| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 2|  NKD Loss: 1.2101
Epoch: 2|  Loss:  3.1552 |Global loss: 5.7203| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 3|  NKD Loss: 1.2062
Epoch: 3|  Loss:  3.1533 |Global loss: 5.7215| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 0|  NKD Loss: 1.2139
Epoch: 0|  Loss:  3.375 |Global loss: 5.7308| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 1|  NKD Loss: 1.255
Epoch: 1|  Loss:  3.3657 |Global loss: 5.7164| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 2|  NKD Loss: 1.2513
Epoch: 2|  Loss:  3.3602 |Global loss: 5.7162| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 3|  NKD Loss: 1.2345
Epoch: 3|  Loss:  3.3564 |Global loss: 5.7254| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 0|  NKD Loss: 1.2265
Epoch: 0|  Loss:  3.0869 |Global loss: 5.7427| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 1|  NKD Loss: 1.2127
Epoch: 1|  Loss:  3.0711 |Global loss: 5.7457| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 2|  NKD Loss: 1.2319
Epoch: 2|  Loss:  3.0685 |Global loss: 5.7446| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 3|  NKD Loss: 1.2372
Epoch: 3|  Loss:  3.0612 |Global loss: 5.7386| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 1.1991
Epoch: 0|  Loss:  3.2161 |Global loss: 5.7132| Local H loss: 0.0142  | Global H loss: 0.0142
Epoch: 1|  NKD Loss: 1.2061
Epoch: 1|  Loss:  3.2035 |Global loss: 5.7067| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 1.2289
Epoch: 2|  Loss:  3.1833 |Global loss: 5.6961| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.2002
Epoch: 3|  Loss:  3.1677 |Global loss: 5.7135| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 0|  NKD Loss: 1.2501
Epoch: 0|  Loss:  2.8646 |Global loss: 5.7685| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 1|  NKD Loss: 1.223
Epoch: 1|  Loss:  2.8461 |Global loss: 5.7718| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.251
Epoch: 2|  Loss:  2.8396 |Global loss: 5.7641| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 3|  NKD Loss: 1.2054
Epoch: 3|  Loss:  2.805 |Global loss: 5.7908| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 0|  NKD Loss: 1.2508
Epoch: 0|  Loss:  3.0168 |Global loss: 5.7359| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 1|  NKD Loss: 1.2276
Epoch: 1|  Loss:  3.0046 |Global loss: 5.7328| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 2|  NKD Loss: 1.2315
Epoch: 2|  Loss:  2.9876 |Global loss: 5.7401| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.222
Epoch: 3|  Loss:  2.9511 |Global loss: 5.7498| Local H loss: 0.019  | Global H loss: 0.019
------------------------- time cost ------------------------- 2.9115450382232666
Chosen Clients:  [8, 7, 3, 10, 11, 12]

-------------Round number: 139-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.142, 0.05, 0.108, 0.05, 0.108, 0.05, 0.05, 0.05, 0.05, 0.25, 0.05]
AUC in each clients:  [104.648, 102.383, 105.305, 105.987, 106.811, 104.917, 106.508, 101.914, 106.189, 107.105, 105.467, 106.141, 96.07, 105.054, 106.142]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.109, 0.008, 0.092, 0.008, 0.092, 0.008, 0.008, 0.008, 0.008, 0.244, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.176, 0.083, 0.167, 0.083, 0.167, 0.083, 0.083, 0.083, 0.083, 0.304, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0605
Averaged Test Accurancy: 0.0817
Averaged Test AUC: 0.8726
Averaged Test F1_score: 0.0469
Averaged Test Recal score: 0.1201
Std Test Accurancy: 0.0545
Std Test AUC: 0.0226
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2605
Epoch: 0|  Loss:  2.8518 |Global loss: 5.758| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 1|  NKD Loss: 1.2313
Epoch: 1|  Loss:  2.8141 |Global loss: 5.774| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 2|  NKD Loss: 1.2293
Epoch: 2|  Loss:  2.7784 |Global loss: 5.7836| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2288
Epoch: 3|  Loss:  2.7996 |Global loss: 5.7801| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 0|  NKD Loss: 1.2445
Epoch: 0|  Loss:  3.3464 |Global loss: 5.7214| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 1|  NKD Loss: 1.244
Epoch: 1|  Loss:  3.3369 |Global loss: 5.724| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 2|  NKD Loss: 1.2306
Epoch: 2|  Loss:  3.3276 |Global loss: 5.7361| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 3|  NKD Loss: 1.2332
Epoch: 3|  Loss:  3.3154 |Global loss: 5.7387| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 0|  NKD Loss: 1.2154
Epoch: 0|  Loss:  2.924 |Global loss: 5.7391| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 1.216
Epoch: 1|  Loss:  2.9098 |Global loss: 5.7379| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.2092
Epoch: 2|  Loss:  2.8961 |Global loss: 5.7497| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 3|  NKD Loss: 1.2114
Epoch: 3|  Loss:  2.8929 |Global loss: 5.7361| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 0|  NKD Loss: 1.2418
Epoch: 0|  Loss:  2.9202 |Global loss: 5.7434| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.242
Epoch: 1|  Loss:  2.8975 |Global loss: 5.7473| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 2|  NKD Loss: 1.2203
Epoch: 2|  Loss:  2.8974 |Global loss: 5.7598| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 3|  NKD Loss: 1.2214
Epoch: 3|  Loss:  2.8736 |Global loss: 5.7582| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 0|  NKD Loss: 1.2074
Epoch: 0|  Loss:  2.8792 |Global loss: 5.7384| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 1.212
Epoch: 1|  Loss:  2.8843 |Global loss: 5.7272| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.2208
Epoch: 2|  Loss:  2.8545 |Global loss: 5.7275| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 1.2301
Epoch: 3|  Loss:  2.8518 |Global loss: 5.7177| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 1.2205
Epoch: 0|  Loss:  3.74 |Global loss: 5.6909| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.2285
Epoch: 1|  Loss:  3.7348 |Global loss: 5.6879| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 2|  NKD Loss: 1.2297
Epoch: 2|  Loss:  3.7343 |Global loss: 5.6816| Local H loss: 0.0098  | Global H loss: 0.0098
Epoch: 3|  NKD Loss: 1.2487
Epoch: 3|  Loss:  3.7424 |Global loss: 5.6696| Local H loss: 0.01  | Global H loss: 0.01
------------------------- time cost ------------------------- 2.9054672718048096
Chosen Clients:  [4, 6, 3, 10, 2, 14]

-------------Round number: 140-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.142, 0.05, 0.108, 0.05, 0.108, 0.05, 0.142, 0.05, 0.05, 0.25, 0.05]
AUC in each clients:  [104.648, 102.383, 105.305, 106.202, 106.811, 104.917, 106.508, 102.967, 106.429, 107.105, 105.948, 106.933, 96.728, 105.054, 106.142]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.109, 0.008, 0.092, 0.008, 0.092, 0.008, 0.088, 0.008, 0.008, 0.244, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.176, 0.083, 0.167, 0.083, 0.167, 0.083, 0.16, 0.083, 0.083, 0.304, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0433
Averaged Test Accurancy: 0.0878
Averaged Test AUC: 0.8745
Averaged Test F1_score: 0.0523
Averaged Test Recal score: 0.1252
Std Test Accurancy: 0.0558
Std Test AUC: 0.0214
Std Test F1: 0.0005
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.2212
Epoch: 0|  Loss:  2.9663 |Global loss: 5.7293| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.238
Epoch: 1|  Loss:  2.9536 |Global loss: 5.724| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 2|  NKD Loss: 1.2167
Epoch: 2|  Loss:  2.9441 |Global loss: 5.7379| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 3|  NKD Loss: 1.2094
Epoch: 3|  Loss:  2.925 |Global loss: 5.7435| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.2316
Epoch: 0|  Loss:  2.7932 |Global loss: 5.7654| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.2448
Epoch: 1|  Loss:  2.7717 |Global loss: 5.7636| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 2|  NKD Loss: 1.2287
Epoch: 2|  Loss:  2.7477 |Global loss: 5.7702| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.2295
Epoch: 3|  Loss:  2.7388 |Global loss: 5.7722| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 0|  NKD Loss: 1.2295
Epoch: 0|  Loss:  2.8883 |Global loss: 5.7293| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.2153
Epoch: 1|  Loss:  2.8789 |Global loss: 5.7447| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 2|  NKD Loss: 1.1922
Epoch: 2|  Loss:  2.8599 |Global loss: 5.7499| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.2149
Epoch: 3|  Loss:  2.8629 |Global loss: 5.746| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 0|  NKD Loss: 1.2452
Epoch: 0|  Loss:  2.8925 |Global loss: 5.746| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.2099
Epoch: 1|  Loss:  2.859 |Global loss: 5.781| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 2|  NKD Loss: 1.229
Epoch: 2|  Loss:  2.8529 |Global loss: 5.7574| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.2087
Epoch: 3|  Loss:  2.8438 |Global loss: 5.7783| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 0|  NKD Loss: 1.2234
Epoch: 0|  Loss:  3.054 |Global loss: 5.7445| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.2287
Epoch: 1|  Loss:  3.0379 |Global loss: 5.7522| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 2|  NKD Loss: 1.2263
Epoch: 2|  Loss:  3.0253 |Global loss: 5.7482| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 3|  NKD Loss: 1.2226
Epoch: 3|  Loss:  3.0234 |Global loss: 5.7479| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.2486
Epoch: 0|  Loss:  2.9618 |Global loss: 5.7518| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 1.2548
Epoch: 1|  Loss:  2.9554 |Global loss: 5.7494| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 2|  NKD Loss: 1.247
Epoch: 2|  Loss:  2.9404 |Global loss: 5.7458| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 3|  NKD Loss: 1.2452
Epoch: 3|  Loss:  2.9106 |Global loss: 5.7558| Local H loss: 0.0191  | Global H loss: 0.0191
------------------------- time cost ------------------------- 2.962830066680908
Chosen Clients:  [14, 7, 8, 2, 0, 9]

-------------Round number: 141-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.108, 0.05, 0.142, 0.05, 0.05, 0.25, 0.05]
AUC in each clients:  [104.648, 102.383, 105.695, 106.192, 107.598, 104.917, 106.77, 102.967, 106.429, 107.105, 106.26, 106.933, 96.728, 105.054, 106.33]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.092, 0.008, 0.088, 0.008, 0.008, 0.244, 0.008]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.167, 0.083, 0.16, 0.083, 0.083, 0.304, 0.083]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 3.0117
Averaged Test Accurancy: 0.0917
Averaged Test AUC: 0.8756
Averaged Test F1_score: 0.0564
Averaged Test Recal score: 0.1295
Std Test Accurancy: 0.0612
Std Test AUC: 0.0220
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2439
Epoch: 0|  Loss:  2.9038 |Global loss: 5.7587| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.2123
Epoch: 1|  Loss:  2.8806 |Global loss: 5.7688| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 2|  NKD Loss: 1.2324
Epoch: 2|  Loss:  2.8726 |Global loss: 5.7688| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 3|  NKD Loss: 1.2443
Epoch: 3|  Loss:  2.8635 |Global loss: 5.7624| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 0|  NKD Loss: 1.2184
Epoch: 0|  Loss:  3.2957 |Global loss: 5.7528| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 1|  NKD Loss: 1.2412
Epoch: 1|  Loss:  3.305 |Global loss: 5.7312| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 2|  NKD Loss: 1.2492
Epoch: 2|  Loss:  3.292 |Global loss: 5.7324| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 3|  NKD Loss: 1.2416
Epoch: 3|  Loss:  3.2895 |Global loss: 5.7331| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 0|  NKD Loss: 1.2371
Epoch: 0|  Loss:  2.7848 |Global loss: 5.7701| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 1.2081
Epoch: 1|  Loss:  2.7575 |Global loss: 5.7971| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 1.229
Epoch: 2|  Loss:  2.7538 |Global loss: 5.7824| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 3|  NKD Loss: 1.2237
Epoch: 3|  Loss:  2.7468 |Global loss: 5.7854| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 1.2078
Epoch: 0|  Loss:  2.985 |Global loss: 5.7718| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 1|  NKD Loss: 1.2226
Epoch: 1|  Loss:  2.992 |Global loss: 5.7537| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 2|  NKD Loss: 1.2207
Epoch: 2|  Loss:  2.9783 |Global loss: 5.7616| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 3|  NKD Loss: 1.2264
Epoch: 3|  Loss:  2.9709 |Global loss: 5.7591| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 0|  NKD Loss: 1.2012
Epoch: 0|  Loss:  3.1317 |Global loss: 5.7216| Local H loss: 0.0154  | Global H loss: 0.0154
Epoch: 1|  NKD Loss: 1.2024
Epoch: 1|  Loss:  3.1145 |Global loss: 5.7231| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 2|  NKD Loss: 1.2093
Epoch: 2|  Loss:  3.102 |Global loss: 5.7142| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 3|  NKD Loss: 1.2302
Epoch: 3|  Loss:  3.0867 |Global loss: 5.7101| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 0|  NKD Loss: 1.233
Epoch: 0|  Loss:  2.933 |Global loss: 5.7476| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.2139
Epoch: 1|  Loss:  2.911 |Global loss: 5.7605| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 2|  NKD Loss: 1.2251
Epoch: 2|  Loss:  2.8957 |Global loss: 5.7503| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.2227
Epoch: 3|  Loss:  2.8909 |Global loss: 5.7476| Local H loss: 0.0199  | Global H loss: 0.0199
------------------------- time cost ------------------------- 2.617001533508301
Chosen Clients:  [11, 7, 0, 13, 3, 14]

-------------Round number: 142-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.108, 0.175, 0.142, 0.05, 0.05, 0.25, 0.058]
AUC in each clients:  [105.192, 102.383, 105.676, 106.192, 107.598, 104.917, 106.77, 103.102, 107.116, 108.44, 106.26, 106.933, 96.728, 105.054, 106.714]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.092, 0.092, 0.088, 0.008, 0.008, 0.244, 0.025]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.167, 0.167, 0.16, 0.083, 0.083, 0.304, 0.093]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9994
Averaged Test Accurancy: 0.1006
Averaged Test AUC: 0.8773
Averaged Test F1_score: 0.0631
Averaged Test Recal score: 0.1358
Std Test Accurancy: 0.0630
Std Test AUC: 0.0230
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 1.1968
Epoch: 0|  Loss:  2.8097 |Global loss: 5.7419| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 1.2165
Epoch: 1|  Loss:  2.8117 |Global loss: 5.728| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 1.1983
Epoch: 2|  Loss:  2.7706 |Global loss: 5.7456| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1976
Epoch: 3|  Loss:  2.7596 |Global loss: 5.7358| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 1.2337
Epoch: 0|  Loss:  3.2668 |Global loss: 5.754| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 1.2132
Epoch: 1|  Loss:  3.2596 |Global loss: 5.7576| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 2|  NKD Loss: 1.2481
Epoch: 2|  Loss:  3.2547 |Global loss: 5.7475| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 3|  NKD Loss: 1.237
Epoch: 3|  Loss:  3.2501 |Global loss: 5.7441| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 0|  NKD Loss: 1.2041
Epoch: 0|  Loss:  3.054 |Global loss: 5.7267| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 1|  NKD Loss: 1.2131
Epoch: 1|  Loss:  3.0392 |Global loss: 5.7243| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.2249
Epoch: 2|  Loss:  3.0234 |Global loss: 5.7232| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 3|  NKD Loss: 1.2269
Epoch: 3|  Loss:  3.0074 |Global loss: 5.7199| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 0|  NKD Loss: 1.2421
Epoch: 0|  Loss:  2.8605 |Global loss: 5.7747| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 1.2023
Epoch: 1|  Loss:  2.8237 |Global loss: 5.7939| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 1.2325
Epoch: 2|  Loss:  2.854 |Global loss: 5.7821| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 3|  NKD Loss: 1.2066
Epoch: 3|  Loss:  2.8119 |Global loss: 5.7996| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.2281
Epoch: 0|  Loss:  2.8469 |Global loss: 5.734| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.1818
Epoch: 1|  Loss:  2.8364 |Global loss: 5.7578| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 2|  NKD Loss: 1.1737
Epoch: 2|  Loss:  2.8111 |Global loss: 5.7662| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 3|  NKD Loss: 1.2031
Epoch: 3|  Loss:  2.8266 |Global loss: 5.7539| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 0|  NKD Loss: 1.2326
Epoch: 0|  Loss:  2.8476 |Global loss: 5.7667| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.2433
Epoch: 1|  Loss:  2.8405 |Global loss: 5.7611| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 2|  NKD Loss: 1.2358
Epoch: 2|  Loss:  2.8165 |Global loss: 5.7705| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2358
Epoch: 3|  Loss:  2.811 |Global loss: 5.7622| Local H loss: 0.0203  | Global H loss: 0.0203
------------------------- time cost ------------------------- 3.1794893741607666
Chosen Clients:  [3, 12, 9, 0, 11, 10]

-------------Round number: 143-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.108, 0.175, 0.142, 0.2, 0.05, 0.258, 0.075]
AUC in each clients:  [105.69, 102.383, 105.676, 106.676, 107.598, 104.917, 106.77, 103.92, 107.116, 108.44, 106.26, 107.933, 96.728, 105.328, 107.59]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.092, 0.092, 0.088, 0.171, 0.008, 0.251, 0.05]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.167, 0.167, 0.16, 0.241, 0.083, 0.316, 0.111]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9745
Averaged Test Accurancy: 0.1122
Averaged Test AUC: 0.8795
Averaged Test F1_score: 0.0761
Averaged Test Recal score: 0.1483
Std Test Accurancy: 0.0664
Std Test AUC: 0.0235
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2014
Epoch: 0|  Loss:  2.8109 |Global loss: 5.7585| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 1.2145
Epoch: 1|  Loss:  2.8259 |Global loss: 5.7425| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 2|  NKD Loss: 1.2086
Epoch: 2|  Loss:  2.8002 |Global loss: 5.7534| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 3|  NKD Loss: 1.1977
Epoch: 3|  Loss:  2.8026 |Global loss: 5.7456| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 0|  NKD Loss: 1.2004
Epoch: 0|  Loss:  3.6959 |Global loss: 5.7088| Local H loss: 0.0099  | Global H loss: 0.0099
Epoch: 1|  NKD Loss: 1.2231
Epoch: 1|  Loss:  3.7046 |Global loss: 5.6948| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 1.2237
Epoch: 2|  Loss:  3.7049 |Global loss: 5.6944| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 3|  NKD Loss: 1.2235
Epoch: 3|  Loss:  3.702 |Global loss: 5.69| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 0|  NKD Loss: 1.2153
Epoch: 0|  Loss:  2.8599 |Global loss: 5.7665| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.2259
Epoch: 1|  Loss:  2.8418 |Global loss: 5.7589| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 2|  NKD Loss: 1.2085
Epoch: 2|  Loss:  2.8273 |Global loss: 5.7679| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 3|  NKD Loss: 1.2084
Epoch: 3|  Loss:  2.8056 |Global loss: 5.7705| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.1987
Epoch: 0|  Loss:  2.9754 |Global loss: 5.7401| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 1|  NKD Loss: 1.2033
Epoch: 1|  Loss:  2.9651 |Global loss: 5.7389| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2036
Epoch: 2|  Loss:  2.9405 |Global loss: 5.7412| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.2222
Epoch: 3|  Loss:  2.9341 |Global loss: 5.7298| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 0|  NKD Loss: 1.2001
Epoch: 0|  Loss:  2.7445 |Global loss: 5.7433| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1858
Epoch: 1|  Loss:  2.7127 |Global loss: 5.7531| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 1.1902
Epoch: 2|  Loss:  2.7116 |Global loss: 5.7464| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1925
Epoch: 3|  Loss:  2.6632 |Global loss: 5.7431| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.2175
Epoch: 0|  Loss:  2.8536 |Global loss: 5.7742| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 1|  NKD Loss: 1.2262
Epoch: 1|  Loss:  2.8359 |Global loss: 5.7741| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 2|  NKD Loss: 1.1949
Epoch: 2|  Loss:  2.8195 |Global loss: 5.7963| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.2175
Epoch: 3|  Loss:  2.8105 |Global loss: 5.7727| Local H loss: 0.0202  | Global H loss: 0.0202
------------------------- time cost ------------------------- 2.9284965991973877
Chosen Clients:  [9, 13, 12, 3, 2, 1]

-------------Round number: 144-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.108, 0.208, 0.142, 0.2, 0.05, 0.258, 0.075]
AUC in each clients:  [106.583, 102.383, 105.676, 106.91, 107.598, 104.917, 106.77, 103.92, 107.116, 108.645, 106.423, 108.468, 97.395, 105.328, 107.59]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.092, 0.134, 0.088, 0.171, 0.008, 0.251, 0.05]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.167, 0.194, 0.16, 0.241, 0.083, 0.316, 0.111]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9568
Averaged Test Accurancy: 0.1144
Averaged Test AUC: 0.8810
Averaged Test F1_score: 0.0789
Averaged Test Recal score: 0.1501
Std Test Accurancy: 0.0690
Std Test AUC: 0.0229
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2108
Epoch: 0|  Loss:  2.7975 |Global loss: 5.7731| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 1.2053
Epoch: 1|  Loss:  2.7887 |Global loss: 5.7638| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 1.217
Epoch: 2|  Loss:  2.7676 |Global loss: 5.7719| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.2126
Epoch: 3|  Loss:  2.741 |Global loss: 5.7719| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 0|  NKD Loss: 1.2268
Epoch: 0|  Loss:  2.8432 |Global loss: 5.7835| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 1.2229
Epoch: 1|  Loss:  2.8268 |Global loss: 5.7872| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 2|  NKD Loss: 1.2303
Epoch: 2|  Loss:  2.8194 |Global loss: 5.7875| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 1.2184
Epoch: 3|  Loss:  2.7984 |Global loss: 5.7948| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 0|  NKD Loss: 1.2051
Epoch: 0|  Loss:  3.675 |Global loss: 5.7123| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 1|  NKD Loss: 1.2167
Epoch: 1|  Loss:  3.6759 |Global loss: 5.6988| Local H loss: 0.01  | Global H loss: 0.01
Epoch: 2|  NKD Loss: 1.2222
Epoch: 2|  Loss:  3.6771 |Global loss: 5.6949| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 3|  NKD Loss: 1.2455
Epoch: 3|  Loss:  3.6808 |Global loss: 5.6828| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.199
Epoch: 0|  Loss:  2.7912 |Global loss: 5.7532| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 1.2041
Epoch: 1|  Loss:  2.7791 |Global loss: 5.7524| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 2|  NKD Loss: 1.2121
Epoch: 2|  Loss:  2.7625 |Global loss: 5.7444| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1901
Epoch: 3|  Loss:  2.7594 |Global loss: 5.7603| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 1.2265
Epoch: 0|  Loss:  2.963 |Global loss: 5.7486| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 1|  NKD Loss: 1.2244
Epoch: 1|  Loss:  2.9464 |Global loss: 5.7575| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.2237
Epoch: 2|  Loss:  2.9406 |Global loss: 5.7588| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 3|  NKD Loss: 1.2304
Epoch: 3|  Loss:  2.9358 |Global loss: 5.7559| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 0|  NKD Loss: 1.1936
Epoch: 0|  Loss:  3.3495 |Global loss: 5.6905| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 1|  NKD Loss: 1.1968
Epoch: 1|  Loss:  3.3235 |Global loss: 5.6941| Local H loss: 0.0126  | Global H loss: 0.0126
Epoch: 2|  NKD Loss: 1.22
Epoch: 2|  Loss:  3.3116 |Global loss: 5.6777| Local H loss: 0.0129  | Global H loss: 0.0129
Epoch: 3|  NKD Loss: 1.215
Epoch: 3|  Loss:  3.3038 |Global loss: 5.6796| Local H loss: 0.013  | Global H loss: 0.013
------------------------- time cost ------------------------- 2.8116226196289062
Chosen Clients:  [14, 10, 3, 2, 8, 11]

-------------Round number: 145-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.108, 0.258, 0.142, 0.2, 0.05, 0.258, 0.075]
AUC in each clients:  [106.583, 103.302, 105.893, 106.984, 107.598, 104.917, 106.77, 103.92, 107.116, 109.18, 106.423, 108.468, 98.066, 105.643, 107.59]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.092, 0.169, 0.088, 0.171, 0.008, 0.251, 0.05]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.167, 0.236, 0.16, 0.241, 0.083, 0.316, 0.111]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9426
Averaged Test Accurancy: 0.1178
Averaged Test AUC: 0.8825
Averaged Test F1_score: 0.0813
Averaged Test Recal score: 0.1529
Std Test Accurancy: 0.0745
Std Test AUC: 0.0216
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2466
Epoch: 0|  Loss:  2.7916 |Global loss: 5.7696| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 1.2359
Epoch: 1|  Loss:  2.7848 |Global loss: 5.7658| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.2395
Epoch: 2|  Loss:  2.7766 |Global loss: 5.7648| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.2177
Epoch: 3|  Loss:  2.7439 |Global loss: 5.7834| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 0|  NKD Loss: 1.2344
Epoch: 0|  Loss:  2.8163 |Global loss: 5.771| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 1|  NKD Loss: 1.2214
Epoch: 1|  Loss:  2.8017 |Global loss: 5.7758| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 2|  NKD Loss: 1.2257
Epoch: 2|  Loss:  2.804 |Global loss: 5.7742| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 3|  NKD Loss: 1.2156
Epoch: 3|  Loss:  2.7909 |Global loss: 5.786| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 0|  NKD Loss: 1.2138
Epoch: 0|  Loss:  2.772 |Global loss: 5.7394| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 1.1938
Epoch: 1|  Loss:  2.7289 |Global loss: 5.7515| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.1875
Epoch: 2|  Loss:  2.7455 |Global loss: 5.7626| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1984
Epoch: 3|  Loss:  2.737 |Global loss: 5.7489| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.216
Epoch: 0|  Loss:  2.9182 |Global loss: 5.7661| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 1|  NKD Loss: 1.2399
Epoch: 1|  Loss:  2.9205 |Global loss: 5.7493| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 2|  NKD Loss: 1.23
Epoch: 2|  Loss:  2.9107 |Global loss: 5.7524| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2292
Epoch: 3|  Loss:  2.8952 |Global loss: 5.7569| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 0|  NKD Loss: 1.2301
Epoch: 0|  Loss:  2.7323 |Global loss: 5.7781| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.2009
Epoch: 1|  Loss:  2.7122 |Global loss: 5.7937| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 2|  NKD Loss: 1.2231
Epoch: 2|  Loss:  2.6983 |Global loss: 5.7827| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1942
Epoch: 3|  Loss:  2.6677 |Global loss: 5.7977| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 0|  NKD Loss: 1.1917
Epoch: 0|  Loss:  2.6663 |Global loss: 5.7409| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 1.2108
Epoch: 1|  Loss:  2.6617 |Global loss: 5.7301| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1879
Epoch: 2|  Loss:  2.6147 |Global loss: 5.7475| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 1.1889
Epoch: 3|  Loss:  2.6056 |Global loss: 5.743| Local H loss: 0.0249  | Global H loss: 0.0249
------------------------- time cost ------------------------- 3.1641414165496826
Chosen Clients:  [5, 14, 8, 3, 4, 2]

-------------Round number: 146-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.05, 0.117, 0.2, 0.05, 0.108, 0.05, 0.158, 0.258, 0.142, 0.2, 0.05, 0.258, 0.058]
AUC in each clients:  [106.583, 103.302, 106.02, 107.439, 107.598, 104.917, 106.77, 103.92, 107.386, 109.18, 106.62, 108.892, 98.066, 105.643, 108.081]
F1 Score:  [0.008, 0.008, 0.008, 0.087, 0.171, 0.008, 0.092, 0.008, 0.148, 0.169, 0.088, 0.171, 0.008, 0.251, 0.025]
Recall Score:  [0.083, 0.083, 0.083, 0.157, 0.241, 0.083, 0.167, 0.083, 0.208, 0.236, 0.16, 0.241, 0.083, 0.316, 0.093]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.9081
Averaged Test Accurancy: 0.1200
Averaged Test AUC: 0.8836
Averaged Test F1_score: 0.0833
Averaged Test Recal score: 0.1545
Std Test Accurancy: 0.0759
Std Test AUC: 0.0222
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2036
Epoch: 0|  Loss:  3.113 |Global loss: 5.7367| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 1|  NKD Loss: 1.2041
Epoch: 1|  Loss:  3.0997 |Global loss: 5.7328| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 2|  NKD Loss: 1.2222
Epoch: 2|  Loss:  3.0997 |Global loss: 5.7165| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.2334
Epoch: 3|  Loss:  3.0963 |Global loss: 5.7117| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 0|  NKD Loss: 1.2302
Epoch: 0|  Loss:  2.7367 |Global loss: 5.7797| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.2164
Epoch: 1|  Loss:  2.7204 |Global loss: 5.7823| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 1.2367
Epoch: 2|  Loss:  2.7069 |Global loss: 5.7769| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 3|  NKD Loss: 1.2352
Epoch: 3|  Loss:  2.6989 |Global loss: 5.7766| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 0|  NKD Loss: 1.2255
Epoch: 0|  Loss:  2.6791 |Global loss: 5.7933| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.2252
Epoch: 1|  Loss:  2.6785 |Global loss: 5.7904| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.2184
Epoch: 2|  Loss:  2.6617 |Global loss: 5.7935| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 1.2199
Epoch: 3|  Loss:  2.6504 |Global loss: 5.7911| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 1.2097
Epoch: 0|  Loss:  2.7212 |Global loss: 5.7527| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.1897
Epoch: 1|  Loss:  2.7061 |Global loss: 5.7596| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.1928
Epoch: 2|  Loss:  2.696 |Global loss: 5.7573| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 1.1726
Epoch: 3|  Loss:  2.6746 |Global loss: 5.7716| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 1.2047
Epoch: 0|  Loss:  2.9013 |Global loss: 5.7461| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.2124
Epoch: 1|  Loss:  2.8796 |Global loss: 5.744| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 2|  NKD Loss: 1.2022
Epoch: 2|  Loss:  2.8722 |Global loss: 5.7509| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 3|  NKD Loss: 1.2064
Epoch: 3|  Loss:  2.849 |Global loss: 5.7577| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 0|  NKD Loss: 1.2246
Epoch: 0|  Loss:  2.8672 |Global loss: 5.7686| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 1|  NKD Loss: 1.2045
Epoch: 1|  Loss:  2.8607 |Global loss: 5.7723| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.2177
Epoch: 2|  Loss:  2.8504 |Global loss: 5.765| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 3|  NKD Loss: 1.217
Epoch: 3|  Loss:  2.8387 |Global loss: 5.7681| Local H loss: 0.0193  | Global H loss: 0.0193
------------------------- time cost ------------------------- 2.8127195835113525
Chosen Clients:  [7, 8, 5, 14, 12, 1]

-------------Round number: 147-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.058, 0.117, 0.2, 0.05, 0.108, 0.05, 0.125, 0.258, 0.142, 0.2, 0.05, 0.258, 0.108]
AUC in each clients:  [106.583, 103.302, 106.432, 107.514, 108.312, 105.332, 106.77, 103.92, 107.348, 109.18, 106.62, 108.892, 98.066, 105.643, 108.587]
F1 Score:  [0.008, 0.008, 0.029, 0.087, 0.171, 0.008, 0.092, 0.008, 0.116, 0.169, 0.088, 0.171, 0.008, 0.251, 0.103]
Recall Score:  [0.083, 0.083, 0.095, 0.157, 0.241, 0.083, 0.167, 0.083, 0.181, 0.236, 0.16, 0.241, 0.083, 0.316, 0.154]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8909
Averaged Test Accurancy: 0.1217
Averaged Test AUC: 0.8847
Averaged Test F1_score: 0.0878
Averaged Test Recal score: 0.1575
Std Test Accurancy: 0.0731
Std Test AUC: 0.0227
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2333
Epoch: 0|  Loss:  3.2231 |Global loss: 5.7588| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 1|  NKD Loss: 1.2292
Epoch: 1|  Loss:  3.2302 |Global loss: 5.754| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 2|  NKD Loss: 1.2359
Epoch: 2|  Loss:  3.2258 |Global loss: 5.7532| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 3|  NKD Loss: 1.2389
Epoch: 3|  Loss:  3.21 |Global loss: 5.7556| Local H loss: 0.0163  | Global H loss: 0.0163
Epoch: 0|  NKD Loss: 1.2265
Epoch: 0|  Loss:  2.6536 |Global loss: 5.7863| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.2137
Epoch: 1|  Loss:  2.6441 |Global loss: 5.7957| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.1983
Epoch: 2|  Loss:  2.6119 |Global loss: 5.8021| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 1.2058
Epoch: 3|  Loss:  2.5915 |Global loss: 5.8055| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 1.1922
Epoch: 0|  Loss:  3.0519 |Global loss: 5.7506| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.1886
Epoch: 1|  Loss:  3.0278 |Global loss: 5.758| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 2|  NKD Loss: 1.214
Epoch: 2|  Loss:  3.0458 |Global loss: 5.728| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.2142
Epoch: 3|  Loss:  3.0128 |Global loss: 5.7389| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 0|  NKD Loss: 1.2164
Epoch: 0|  Loss:  2.6835 |Global loss: 5.7832| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 1|  NKD Loss: 1.2122
Epoch: 1|  Loss:  2.6694 |Global loss: 5.7876| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 2|  NKD Loss: 1.2271
Epoch: 2|  Loss:  2.6691 |Global loss: 5.7832| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 1.2088
Epoch: 3|  Loss:  2.6315 |Global loss: 5.7941| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 1.1993
Epoch: 0|  Loss:  3.6407 |Global loss: 5.7195| Local H loss: 0.0101  | Global H loss: 0.0101
Epoch: 1|  NKD Loss: 1.2053
Epoch: 1|  Loss:  3.6348 |Global loss: 5.7176| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 2|  NKD Loss: 1.2277
Epoch: 2|  Loss:  3.6397 |Global loss: 5.6951| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 3|  NKD Loss: 1.2179
Epoch: 3|  Loss:  3.6438 |Global loss: 5.7018| Local H loss: 0.0102  | Global H loss: 0.0102
Epoch: 0|  NKD Loss: 1.1836
Epoch: 0|  Loss:  3.2474 |Global loss: 5.7168| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 1|  NKD Loss: 1.195
Epoch: 1|  Loss:  3.2436 |Global loss: 5.7008| Local H loss: 0.0135  | Global H loss: 0.0135
Epoch: 2|  NKD Loss: 1.2089
Epoch: 2|  Loss:  3.2259 |Global loss: 5.7002| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 1.2143
Epoch: 3|  Loss:  3.2116 |Global loss: 5.6921| Local H loss: 0.0141  | Global H loss: 0.0141
------------------------- time cost ------------------------- 2.9448554515838623
Chosen Clients:  [3, 5, 6, 4, 1, 13]

-------------Round number: 148-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.058, 0.117, 0.2, 0.05, 0.108, 0.05, 0.15, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [106.583, 104.331, 106.432, 107.514, 108.312, 105.97, 106.77, 105.251, 107.61, 109.18, 106.62, 108.892, 98.653, 105.643, 109.383]
F1 Score:  [0.008, 0.008, 0.029, 0.087, 0.171, 0.008, 0.092, 0.008, 0.141, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.095, 0.157, 0.241, 0.083, 0.167, 0.083, 0.201, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8888
Averaged Test Accurancy: 0.1261
Averaged Test AUC: 0.8873
Averaged Test F1_score: 0.0921
Averaged Test Recal score: 0.1622
Std Test Accurancy: 0.0736
Std Test AUC: 0.0210
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.1874
Epoch: 0|  Loss:  2.7011 |Global loss: 5.7527| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 1.2099
Epoch: 1|  Loss:  2.6814 |Global loss: 5.7453| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.1943
Epoch: 2|  Loss:  2.689 |Global loss: 5.7565| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 1.211
Epoch: 3|  Loss:  2.671 |Global loss: 5.7487| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.2039
Epoch: 0|  Loss:  2.9916 |Global loss: 5.7434| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 1|  NKD Loss: 1.2285
Epoch: 1|  Loss:  3.0009 |Global loss: 5.7331| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 2|  NKD Loss: 1.2223
Epoch: 2|  Loss:  2.9715 |Global loss: 5.7361| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 3|  NKD Loss: 1.2024
Epoch: 3|  Loss:  2.9597 |Global loss: 5.7477| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 0|  NKD Loss: 1.2405
Epoch: 0|  Loss:  2.7516 |Global loss: 5.762| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 1.2127
Epoch: 1|  Loss:  2.7133 |Global loss: 5.7826| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 1.2263
Epoch: 2|  Loss:  2.723 |Global loss: 5.7735| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 3|  NKD Loss: 1.1798
Epoch: 3|  Loss:  2.6734 |Global loss: 5.8008| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 0|  NKD Loss: 1.2283
Epoch: 0|  Loss:  2.8402 |Global loss: 5.7356| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 1.2116
Epoch: 1|  Loss:  2.8162 |Global loss: 5.7477| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.2117
Epoch: 2|  Loss:  2.811 |Global loss: 5.7473| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 1.2092
Epoch: 3|  Loss:  2.7836 |Global loss: 5.7506| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.2059
Epoch: 0|  Loss:  3.182 |Global loss: 5.7115| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 1|  NKD Loss: 1.2049
Epoch: 1|  Loss:  3.171 |Global loss: 5.7035| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 1.2167
Epoch: 2|  Loss:  3.1522 |Global loss: 5.7043| Local H loss: 0.0149  | Global H loss: 0.0149
Epoch: 3|  NKD Loss: 1.2135
Epoch: 3|  Loss:  3.1289 |Global loss: 5.7044| Local H loss: 0.0151  | Global H loss: 0.0151
Epoch: 0|  NKD Loss: 1.2331
Epoch: 0|  Loss:  2.8137 |Global loss: 5.7811| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 1.2118
Epoch: 1|  Loss:  2.7866 |Global loss: 5.7881| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 2|  NKD Loss: 1.2221
Epoch: 2|  Loss:  2.7869 |Global loss: 5.7919| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 3|  NKD Loss: 1.2166
Epoch: 3|  Loss:  2.7811 |Global loss: 5.7868| Local H loss: 0.0217  | Global H loss: 0.0217
------------------------- time cost ------------------------- 2.9322991371154785
Chosen Clients:  [10, 11, 5, 8, 2, 6]

-------------Round number: 149-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.058, 0.117, 0.2, 0.05, 0.108, 0.05, 0.15, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [106.583, 104.988, 106.432, 107.499, 108.794, 106.741, 107.421, 105.251, 107.61, 109.18, 106.62, 108.892, 98.653, 106.181, 109.383]
F1 Score:  [0.008, 0.008, 0.029, 0.087, 0.171, 0.008, 0.092, 0.008, 0.141, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.095, 0.157, 0.241, 0.083, 0.167, 0.083, 0.201, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8627
Averaged Test Accurancy: 0.1261
Averaged Test AUC: 0.8890
Averaged Test F1_score: 0.0921
Averaged Test Recal score: 0.1622
Std Test Accurancy: 0.0736
Std Test AUC: 0.0209
Std Test F1: 0.0006
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.2242
Epoch: 0|  Loss:  2.782 |Global loss: 5.7797| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.2268
Epoch: 1|  Loss:  2.7793 |Global loss: 5.7757| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.2069
Epoch: 2|  Loss:  2.7475 |Global loss: 5.793| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 3|  NKD Loss: 1.198
Epoch: 3|  Loss:  2.7394 |Global loss: 5.8072| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 1.1841
Epoch: 0|  Loss:  2.582 |Global loss: 5.743| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.1578
Epoch: 1|  Loss:  2.5483 |Global loss: 5.7639| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 1.1935
Epoch: 2|  Loss:  2.5623 |Global loss: 5.7358| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 1.1906
Epoch: 3|  Loss:  2.539 |Global loss: 5.7398| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.2122
Epoch: 0|  Loss:  2.9509 |Global loss: 5.7428| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.2243
Epoch: 1|  Loss:  2.9293 |Global loss: 5.7464| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.2129
Epoch: 2|  Loss:  2.9198 |Global loss: 5.7428| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 3|  NKD Loss: 1.2168
Epoch: 3|  Loss:  2.9091 |Global loss: 5.7449| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.2266
Epoch: 0|  Loss:  2.6088 |Global loss: 5.7799| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 1.225
Epoch: 1|  Loss:  2.5973 |Global loss: 5.7915| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 2|  NKD Loss: 1.1752
Epoch: 2|  Loss:  2.5687 |Global loss: 5.8196| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 3|  NKD Loss: 1.2192
Epoch: 3|  Loss:  2.576 |Global loss: 5.7992| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.2195
Epoch: 0|  Loss:  2.8273 |Global loss: 5.7666| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 1|  NKD Loss: 1.2263
Epoch: 1|  Loss:  2.819 |Global loss: 5.7562| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 2|  NKD Loss: 1.2175
Epoch: 2|  Loss:  2.8219 |Global loss: 5.764| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 3|  NKD Loss: 1.2312
Epoch: 3|  Loss:  2.7996 |Global loss: 5.7604| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 0|  NKD Loss: 1.2119
Epoch: 0|  Loss:  2.6841 |Global loss: 5.7786| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 1.2076
Epoch: 1|  Loss:  2.6736 |Global loss: 5.788| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 2|  NKD Loss: 1.207
Epoch: 2|  Loss:  2.6582 |Global loss: 5.7884| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.214
Epoch: 3|  Loss:  2.6525 |Global loss: 5.7787| Local H loss: 0.0212  | Global H loss: 0.0212
------------------------- time cost ------------------------- 2.8011434078216553
Chosen Clients:  [1, 10, 0, 3, 12, 7]

-------------Round number: 150-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.117, 0.2, 0.05, 0.108, 0.05, 0.292, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [106.583, 104.988, 106.596, 107.499, 108.794, 107.386, 107.484, 105.251, 108.253, 109.18, 106.632, 109.414, 98.653, 106.181, 109.383]
F1 Score:  [0.008, 0.008, 0.092, 0.087, 0.171, 0.008, 0.092, 0.008, 0.253, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.167, 0.157, 0.241, 0.083, 0.167, 0.083, 0.319, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8281
Averaged Test Accurancy: 0.1389
Averaged Test AUC: 0.8902
Averaged Test F1_score: 0.1038
Averaged Test Recal score: 0.1749
Std Test Accurancy: 0.0822
Std Test AUC: 0.0214
Std Test F1: 0.0007
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.1913
Epoch: 0|  Loss:  3.086 |Global loss: 5.7354| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.1787
Epoch: 1|  Loss:  3.0775 |Global loss: 5.7314| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 2|  NKD Loss: 1.1993
Epoch: 2|  Loss:  3.0608 |Global loss: 5.7302| Local H loss: 0.0158  | Global H loss: 0.0158
Epoch: 3|  NKD Loss: 1.1835
Epoch: 3|  Loss:  3.0429 |Global loss: 5.7356| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 0|  NKD Loss: 1.2057
Epoch: 0|  Loss:  2.7517 |Global loss: 5.7961| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 1|  NKD Loss: 1.2024
Epoch: 1|  Loss:  2.7223 |Global loss: 5.797| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 2|  NKD Loss: 1.2126
Epoch: 2|  Loss:  2.7109 |Global loss: 5.7939| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 3|  NKD Loss: 1.2103
Epoch: 3|  Loss:  2.7234 |Global loss: 5.7899| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 0|  NKD Loss: 1.1682
Epoch: 0|  Loss:  2.8804 |Global loss: 5.7752| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 1|  NKD Loss: 1.1907
Epoch: 1|  Loss:  2.8817 |Global loss: 5.7544| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 2|  NKD Loss: 1.2011
Epoch: 2|  Loss:  2.8591 |Global loss: 5.7498| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.215
Epoch: 3|  Loss:  2.8511 |Global loss: 5.7507| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 0|  NKD Loss: 1.1865
Epoch: 0|  Loss:  2.6529 |Global loss: 5.7574| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 1.1741
Epoch: 1|  Loss:  2.6384 |Global loss: 5.7706| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.164
Epoch: 2|  Loss:  2.6274 |Global loss: 5.7747| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 1.1882
Epoch: 3|  Loss:  2.6371 |Global loss: 5.7567| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 0|  NKD Loss: 1.1941
Epoch: 0|  Loss:  3.6167 |Global loss: 5.7241| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 1|  NKD Loss: 1.1984
Epoch: 1|  Loss:  3.6007 |Global loss: 5.7318| Local H loss: 0.0103  | Global H loss: 0.0103
Epoch: 2|  NKD Loss: 1.203
Epoch: 2|  Loss:  3.6111 |Global loss: 5.7141| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 3|  NKD Loss: 1.2374
Epoch: 3|  Loss:  3.6112 |Global loss: 5.6985| Local H loss: 0.0104  | Global H loss: 0.0104
Epoch: 0|  NKD Loss: 1.2072
Epoch: 0|  Loss:  3.1894 |Global loss: 5.7761| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.228
Epoch: 1|  Loss:  3.189 |Global loss: 5.7658| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 2|  NKD Loss: 1.2409
Epoch: 2|  Loss:  3.1869 |Global loss: 5.7632| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 3|  NKD Loss: 1.2225
Epoch: 3|  Loss:  3.1728 |Global loss: 5.7718| Local H loss: 0.0167  | Global H loss: 0.0167
------------------------- time cost ------------------------- 2.888449192047119
Chosen Clients:  [6, 13, 11, 8, 4, 3]

-------------Round number: 151-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.117, 0.2, 0.05, 0.108, 0.05, 0.292, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [106.71, 105.711, 106.596, 107.633, 108.794, 107.386, 107.484, 105.64, 108.253, 109.18, 106.567, 109.414, 99.247, 106.181, 109.383]
F1 Score:  [0.008, 0.008, 0.092, 0.083, 0.171, 0.008, 0.092, 0.008, 0.253, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.167, 0.157, 0.241, 0.083, 0.167, 0.083, 0.319, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.8268
Averaged Test Accurancy: 0.1389
Averaged Test AUC: 0.8912
Averaged Test F1_score: 0.1035
Averaged Test Recal score: 0.1749
Std Test Accurancy: 0.0822
Std Test AUC: 0.0200
Std Test F1: 0.0007
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.2306
Epoch: 0|  Loss:  2.6613 |Global loss: 5.7677| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 1.1969
Epoch: 1|  Loss:  2.6389 |Global loss: 5.7909| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 2|  NKD Loss: 1.2193
Epoch: 2|  Loss:  2.6353 |Global loss: 5.7695| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1888
Epoch: 3|  Loss:  2.5989 |Global loss: 5.7933| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 0|  NKD Loss: 1.2272
Epoch: 0|  Loss:  2.7885 |Global loss: 5.7879| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.2224
Epoch: 1|  Loss:  2.7614 |Global loss: 5.7887| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.2067
Epoch: 2|  Loss:  2.7476 |Global loss: 5.7976| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 1.193
Epoch: 3|  Loss:  2.7381 |Global loss: 5.8041| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 1.1632
Epoch: 0|  Loss:  2.4979 |Global loss: 5.7582| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.1788
Epoch: 1|  Loss:  2.4997 |Global loss: 5.7464| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.1852
Epoch: 2|  Loss:  2.4734 |Global loss: 5.7388| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.1826
Epoch: 3|  Loss:  2.4583 |Global loss: 5.7411| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 1.2315
Epoch: 0|  Loss:  2.5915 |Global loss: 5.7852| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.2072
Epoch: 1|  Loss:  2.552 |Global loss: 5.7966| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1888
Epoch: 2|  Loss:  2.5255 |Global loss: 5.816| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 1.1872
Epoch: 3|  Loss:  2.5277 |Global loss: 5.8147| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 0|  NKD Loss: 1.1931
Epoch: 0|  Loss:  2.7697 |Global loss: 5.7593| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.1959
Epoch: 1|  Loss:  2.7563 |Global loss: 5.7644| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 1.1918
Epoch: 2|  Loss:  2.7292 |Global loss: 5.765| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.184
Epoch: 3|  Loss:  2.717 |Global loss: 5.7703| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 0|  NKD Loss: 1.1868
Epoch: 0|  Loss:  2.6159 |Global loss: 5.7598| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1954
Epoch: 1|  Loss:  2.6249 |Global loss: 5.7533| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1701
Epoch: 2|  Loss:  2.5944 |Global loss: 5.771| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 3|  NKD Loss: 1.1638
Epoch: 3|  Loss:  2.5968 |Global loss: 5.7678| Local H loss: 0.0227  | Global H loss: 0.0227
------------------------- time cost ------------------------- 2.8930270671844482
Chosen Clients:  [10, 11, 7, 2, 6, 0]

-------------Round number: 152-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.175, 0.2, 0.05, 0.15, 0.05, 0.283, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [106.71, 105.711, 106.596, 108.198, 109.203, 107.386, 107.73, 105.64, 108.786, 109.18, 106.567, 109.854, 99.247, 106.292, 109.383]
F1 Score:  [0.008, 0.008, 0.092, 0.171, 0.171, 0.008, 0.152, 0.008, 0.249, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.167, 0.241, 0.241, 0.083, 0.213, 0.083, 0.312, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7900
Averaged Test Accurancy: 0.1450
Averaged Test AUC: 0.8925
Averaged Test F1_score: 0.1131
Averaged Test Recal score: 0.1831
Std Test Accurancy: 0.0810
Std Test AUC: 0.0208
Std Test F1: 0.0007
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.2163
Epoch: 0|  Loss:  2.7231 |Global loss: 5.7961| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 1|  NKD Loss: 1.2088
Epoch: 1|  Loss:  2.6959 |Global loss: 5.8026| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 2|  NKD Loss: 1.1776
Epoch: 2|  Loss:  2.675 |Global loss: 5.8264| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 3|  NKD Loss: 1.1961
Epoch: 3|  Loss:  2.6789 |Global loss: 5.8081| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 0|  NKD Loss: 1.1796
Epoch: 0|  Loss:  2.4462 |Global loss: 5.7489| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 1.1543
Epoch: 1|  Loss:  2.4135 |Global loss: 5.7507| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.1755
Epoch: 2|  Loss:  2.397 |Global loss: 5.7426| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.1556
Epoch: 3|  Loss:  2.3911 |Global loss: 5.7547| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 1.2099
Epoch: 0|  Loss:  3.1442 |Global loss: 5.7894| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 1|  NKD Loss: 1.2124
Epoch: 1|  Loss:  3.1487 |Global loss: 5.7831| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 2|  NKD Loss: 1.228
Epoch: 2|  Loss:  3.1422 |Global loss: 5.7704| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 3|  NKD Loss: 1.2424
Epoch: 3|  Loss:  3.1456 |Global loss: 5.7698| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 0|  NKD Loss: 1.2012
Epoch: 0|  Loss:  2.7721 |Global loss: 5.783| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.2
Epoch: 1|  Loss:  2.7631 |Global loss: 5.778| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 2|  NKD Loss: 1.2085
Epoch: 2|  Loss:  2.7617 |Global loss: 5.764| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.2124
Epoch: 3|  Loss:  2.755 |Global loss: 5.7694| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 0|  NKD Loss: 1.1942
Epoch: 0|  Loss:  2.5974 |Global loss: 5.7953| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.2055
Epoch: 1|  Loss:  2.5994 |Global loss: 5.7832| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 2|  NKD Loss: 1.1651
Epoch: 2|  Loss:  2.5598 |Global loss: 5.8118| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 3|  NKD Loss: 1.1873
Epoch: 3|  Loss:  2.5441 |Global loss: 5.7881| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 1.2003
Epoch: 0|  Loss:  2.8277 |Global loss: 5.7525| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 1|  NKD Loss: 1.1923
Epoch: 1|  Loss:  2.8019 |Global loss: 5.7578| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 2|  NKD Loss: 1.1906
Epoch: 2|  Loss:  2.7831 |Global loss: 5.7638| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 3|  NKD Loss: 1.1966
Epoch: 3|  Loss:  2.7809 |Global loss: 5.7571| Local H loss: 0.0201  | Global H loss: 0.0201
------------------------- time cost ------------------------- 2.8482871055603027
Chosen Clients:  [9, 14, 1, 3, 2, 4]

-------------Round number: 153-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.175, 0.2, 0.05, 0.167, 0.05, 0.283, 0.258, 0.142, 0.2, 0.05, 0.258, 0.15]
AUC in each clients:  [107.481, 105.711, 106.873, 108.198, 109.203, 107.386, 107.792, 105.587, 108.786, 109.18, 106.967, 110.043, 99.247, 106.292, 109.383]
F1 Score:  [0.008, 0.008, 0.092, 0.171, 0.171, 0.008, 0.165, 0.008, 0.249, 0.169, 0.088, 0.171, 0.008, 0.251, 0.143]
Recall Score:  [0.083, 0.083, 0.167, 0.241, 0.241, 0.083, 0.231, 0.083, 0.312, 0.236, 0.16, 0.241, 0.083, 0.316, 0.204]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7648
Averaged Test Accurancy: 0.1461
Averaged Test AUC: 0.8934
Averaged Test F1_score: 0.1140
Averaged Test Recal score: 0.1843
Std Test Accurancy: 0.0811
Std Test AUC: 0.0208
Std Test F1: 0.0007
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.1898
Epoch: 0|  Loss:  2.7218 |Global loss: 5.7898| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.2078
Epoch: 1|  Loss:  2.7252 |Global loss: 5.7741| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 2|  NKD Loss: 1.1837
Epoch: 2|  Loss:  2.685 |Global loss: 5.7864| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 1.2094
Epoch: 3|  Loss:  2.682 |Global loss: 5.7799| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.223
Epoch: 0|  Loss:  2.641 |Global loss: 5.7815| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.199
Epoch: 1|  Loss:  2.6137 |Global loss: 5.795| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 1.1976
Epoch: 2|  Loss:  2.5903 |Global loss: 5.8085| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 1.205
Epoch: 3|  Loss:  2.5831 |Global loss: 5.8007| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 1.1686
Epoch: 0|  Loss:  3.0009 |Global loss: 5.7582| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.1988
Epoch: 1|  Loss:  2.9968 |Global loss: 5.7371| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 2|  NKD Loss: 1.2137
Epoch: 2|  Loss:  2.9862 |Global loss: 5.7295| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 1.1974
Epoch: 3|  Loss:  2.9665 |Global loss: 5.7377| Local H loss: 0.0171  | Global H loss: 0.0171
Epoch: 0|  NKD Loss: 1.1672
Epoch: 0|  Loss:  2.5746 |Global loss: 5.7718| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 1.1575
Epoch: 1|  Loss:  2.5812 |Global loss: 5.7738| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1788
Epoch: 2|  Loss:  2.5688 |Global loss: 5.7645| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1739
Epoch: 3|  Loss:  2.5831 |Global loss: 5.7626| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 1.2033
Epoch: 0|  Loss:  2.722 |Global loss: 5.7792| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 1|  NKD Loss: 1.1923
Epoch: 1|  Loss:  2.7173 |Global loss: 5.7774| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 2|  NKD Loss: 1.2019
Epoch: 2|  Loss:  2.7222 |Global loss: 5.7776| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 3|  NKD Loss: 1.1812
Epoch: 3|  Loss:  2.7076 |Global loss: 5.7927| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 0|  NKD Loss: 1.1907
Epoch: 0|  Loss:  2.6959 |Global loss: 5.7696| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.184
Epoch: 1|  Loss:  2.6881 |Global loss: 5.77| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 2|  NKD Loss: 1.2048
Epoch: 2|  Loss:  2.6798 |Global loss: 5.759| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1959
Epoch: 3|  Loss:  2.6458 |Global loss: 5.7657| Local H loss: 0.0239  | Global H loss: 0.0239
------------------------- time cost ------------------------- 2.7109367847442627
Chosen Clients:  [4, 8, 10, 1, 2, 3]

-------------Round number: 154-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.175, 0.2, 0.05, 0.167, 0.05, 0.283, 0.275, 0.142, 0.2, 0.05, 0.258, 0.175]
AUC in each clients:  [107.481, 105.855, 107.271, 108.294, 109.392, 107.386, 107.792, 105.587, 108.786, 109.69, 106.967, 110.043, 99.247, 106.292, 109.719]
F1 Score:  [0.008, 0.008, 0.092, 0.171, 0.171, 0.008, 0.165, 0.008, 0.249, 0.194, 0.088, 0.171, 0.008, 0.251, 0.165]
Recall Score:  [0.083, 0.083, 0.167, 0.241, 0.241, 0.083, 0.231, 0.083, 0.312, 0.255, 0.16, 0.241, 0.083, 0.316, 0.231]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7464
Averaged Test Accurancy: 0.1489
Averaged Test AUC: 0.8943
Averaged Test F1_score: 0.1171
Averaged Test Recal score: 0.1873
Std Test Accurancy: 0.0830
Std Test AUC: 0.0213
Std Test F1: 0.0007
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.1956
Epoch: 0|  Loss:  2.6482 |Global loss: 5.7628| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1725
Epoch: 1|  Loss:  2.6136 |Global loss: 5.7861| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.179
Epoch: 2|  Loss:  2.6021 |Global loss: 5.7742| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1713
Epoch: 3|  Loss:  2.5737 |Global loss: 5.7801| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 1.1928
Epoch: 0|  Loss:  2.5212 |Global loss: 5.8114| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 1.1979
Epoch: 1|  Loss:  2.4953 |Global loss: 5.8071| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.1923
Epoch: 2|  Loss:  2.4908 |Global loss: 5.8214| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 1.1963
Epoch: 3|  Loss:  2.4846 |Global loss: 5.8124| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.2049
Epoch: 0|  Loss:  2.6843 |Global loss: 5.8094| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 1|  NKD Loss: 1.209
Epoch: 1|  Loss:  2.6932 |Global loss: 5.8082| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 2|  NKD Loss: 1.1987
Epoch: 2|  Loss:  2.6553 |Global loss: 5.8182| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 3|  NKD Loss: 1.1883
Epoch: 3|  Loss:  2.6458 |Global loss: 5.8213| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 0|  NKD Loss: 1.1929
Epoch: 0|  Loss:  2.9377 |Global loss: 5.7535| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 1|  NKD Loss: 1.1901
Epoch: 1|  Loss:  2.9297 |Global loss: 5.7483| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 2|  NKD Loss: 1.2011
Epoch: 2|  Loss:  2.9169 |Global loss: 5.7501| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 3|  NKD Loss: 1.2177
Epoch: 3|  Loss:  2.9278 |Global loss: 5.7266| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 0|  NKD Loss: 1.1932
Epoch: 0|  Loss:  2.6795 |Global loss: 5.7912| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.1944
Epoch: 1|  Loss:  2.6712 |Global loss: 5.7814| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 2|  NKD Loss: 1.2084
Epoch: 2|  Loss:  2.6829 |Global loss: 5.7772| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 3|  NKD Loss: 1.1833
Epoch: 3|  Loss:  2.6587 |Global loss: 5.7866| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 0|  NKD Loss: 1.1774
Epoch: 0|  Loss:  2.5724 |Global loss: 5.766| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1634
Epoch: 1|  Loss:  2.539 |Global loss: 5.7698| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.174
Epoch: 2|  Loss:  2.5576 |Global loss: 5.7594| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.161
Epoch: 3|  Loss:  2.5367 |Global loss: 5.7747| Local H loss: 0.0238  | Global H loss: 0.0238
------------------------- time cost ------------------------- 2.9479281902313232
Chosen Clients:  [12, 14, 2, 7, 8, 13]

-------------Round number: 155-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.175, 0.2, 0.05, 0.167, 0.05, 0.317, 0.275, 0.142, 0.2, 0.05, 0.258, 0.175]
AUC in each clients:  [107.481, 106.719, 107.521, 108.358, 110.045, 107.386, 107.792, 105.587, 109.223, 109.69, 107.037, 110.043, 99.247, 106.292, 109.719]
F1 Score:  [0.008, 0.008, 0.092, 0.171, 0.171, 0.008, 0.165, 0.008, 0.295, 0.194, 0.088, 0.171, 0.008, 0.251, 0.165]
Recall Score:  [0.083, 0.083, 0.167, 0.241, 0.241, 0.083, 0.231, 0.083, 0.347, 0.255, 0.16, 0.241, 0.083, 0.316, 0.231]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7228
Averaged Test Accurancy: 0.1511
Averaged Test AUC: 0.8956
Averaged Test F1_score: 0.1202
Averaged Test Recal score: 0.1897
Std Test Accurancy: 0.0870
Std Test AUC: 0.0216
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 1.1877
Epoch: 0|  Loss:  3.5724 |Global loss: 5.7384| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 1|  NKD Loss: 1.1834
Epoch: 1|  Loss:  3.5669 |Global loss: 5.7447| Local H loss: 0.0105  | Global H loss: 0.0105
Epoch: 2|  NKD Loss: 1.2149
Epoch: 2|  Loss:  3.5735 |Global loss: 5.7158| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 3|  NKD Loss: 1.2367
Epoch: 3|  Loss:  3.584 |Global loss: 5.7005| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.2112
Epoch: 0|  Loss:  2.573 |Global loss: 5.8047| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 1.1945
Epoch: 1|  Loss:  2.5628 |Global loss: 5.8021| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 1.2081
Epoch: 2|  Loss:  2.5581 |Global loss: 5.7982| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.2011
Epoch: 3|  Loss:  2.5416 |Global loss: 5.805| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.1777
Epoch: 0|  Loss:  2.6275 |Global loss: 5.7976| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 1.1658
Epoch: 1|  Loss:  2.628 |Global loss: 5.7987| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 1.1843
Epoch: 2|  Loss:  2.6175 |Global loss: 5.787| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 3|  NKD Loss: 1.1785
Epoch: 3|  Loss:  2.6007 |Global loss: 5.7928| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 0|  NKD Loss: 1.2009
Epoch: 0|  Loss:  3.118 |Global loss: 5.7947| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 1|  NKD Loss: 1.2031
Epoch: 1|  Loss:  3.1108 |Global loss: 5.7989| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 2|  NKD Loss: 1.233
Epoch: 2|  Loss:  3.1119 |Global loss: 5.776| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 3|  NKD Loss: 1.236
Epoch: 3|  Loss:  3.1007 |Global loss: 5.7866| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 0|  NKD Loss: 1.1949
Epoch: 0|  Loss:  2.473 |Global loss: 5.8166| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1947
Epoch: 1|  Loss:  2.4653 |Global loss: 5.8178| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 1.1819
Epoch: 2|  Loss:  2.4392 |Global loss: 5.8261| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.1668
Epoch: 3|  Loss:  2.4114 |Global loss: 5.8272| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 1.2107
Epoch: 0|  Loss:  2.7502 |Global loss: 5.79| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 1.1876
Epoch: 1|  Loss:  2.7198 |Global loss: 5.8098| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 1.1895
Epoch: 2|  Loss:  2.7236 |Global loss: 5.8075| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 1.1752
Epoch: 3|  Loss:  2.6918 |Global loss: 5.8166| Local H loss: 0.0222  | Global H loss: 0.0222
------------------------- time cost ------------------------- 2.9985361099243164
Chosen Clients:  [2, 13, 14, 11, 5, 6]

-------------Round number: 156-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.108, 0.175, 0.2, 0.05, 0.167, 0.05, 0.358, 0.275, 0.142, 0.2, 0.05, 0.258, 0.175]
AUC in each clients:  [107.481, 106.719, 107.795, 108.358, 110.045, 107.386, 107.792, 105.541, 109.661, 109.69, 107.037, 110.043, 100.04, 106.678, 110.007]
F1 Score:  [0.008, 0.008, 0.092, 0.171, 0.171, 0.008, 0.165, 0.008, 0.332, 0.194, 0.088, 0.171, 0.008, 0.251, 0.165]
Recall Score:  [0.083, 0.083, 0.167, 0.241, 0.241, 0.083, 0.231, 0.083, 0.394, 0.255, 0.16, 0.241, 0.083, 0.316, 0.231]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.7160
Averaged Test Accurancy: 0.1539
Averaged Test AUC: 0.8968
Averaged Test F1_score: 0.1227
Averaged Test Recal score: 0.1928
Std Test Accurancy: 0.0927
Std Test AUC: 0.0205
Std Test F1: 0.0008
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.1894
Epoch: 0|  Loss:  2.6004 |Global loss: 5.7826| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.1956
Epoch: 1|  Loss:  2.5895 |Global loss: 5.7705| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.1961
Epoch: 2|  Loss:  2.5869 |Global loss: 5.7756| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1861
Epoch: 3|  Loss:  2.5778 |Global loss: 5.7813| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.2018
Epoch: 0|  Loss:  2.7128 |Global loss: 5.7999| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.1872
Epoch: 1|  Loss:  2.6901 |Global loss: 5.8179| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 1.1985
Epoch: 2|  Loss:  2.7014 |Global loss: 5.804| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 1.1843
Epoch: 3|  Loss:  2.6845 |Global loss: 5.809| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 1.2015
Epoch: 0|  Loss:  2.547 |Global loss: 5.7983| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 1.2067
Epoch: 1|  Loss:  2.5181 |Global loss: 5.8009| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 1.2014
Epoch: 2|  Loss:  2.4931 |Global loss: 5.804| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 1.1758
Epoch: 3|  Loss:  2.4682 |Global loss: 5.8211| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 0|  NKD Loss: 1.1545
Epoch: 0|  Loss:  2.3595 |Global loss: 5.7465| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.1601
Epoch: 1|  Loss:  2.3481 |Global loss: 5.7559| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.1431
Epoch: 2|  Loss:  2.3257 |Global loss: 5.7544| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.1225
Epoch: 3|  Loss:  2.2904 |Global loss: 5.7814| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 1.1819
Epoch: 0|  Loss:  2.8742 |Global loss: 5.7734| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.1928
Epoch: 1|  Loss:  2.8661 |Global loss: 5.7661| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.2047
Epoch: 2|  Loss:  2.8582 |Global loss: 5.7619| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 3|  NKD Loss: 1.2038
Epoch: 3|  Loss:  2.8442 |Global loss: 5.7595| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 0|  NKD Loss: 1.177
Epoch: 0|  Loss:  2.5349 |Global loss: 5.7962| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 1.206
Epoch: 1|  Loss:  2.5487 |Global loss: 5.778| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 2|  NKD Loss: 1.1726
Epoch: 2|  Loss:  2.5223 |Global loss: 5.7969| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 1.1924
Epoch: 3|  Loss:  2.5348 |Global loss: 5.7876| Local H loss: 0.0222  | Global H loss: 0.0222
------------------------- time cost ------------------------- 3.0175375938415527
Chosen Clients:  [7, 5, 12, 2, 0, 10]

-------------Round number: 157-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.167, 0.175, 0.2, 0.108, 0.175, 0.05, 0.358, 0.275, 0.142, 0.292, 0.05, 0.283, 0.183]
AUC in each clients:  [107.481, 106.719, 108.267, 108.358, 110.045, 107.878, 107.874, 105.541, 109.661, 109.69, 107.037, 110.364, 100.04, 106.913, 110.268]
F1 Score:  [0.008, 0.008, 0.17, 0.171, 0.171, 0.081, 0.171, 0.008, 0.332, 0.194, 0.088, 0.252, 0.008, 0.284, 0.171]
Recall Score:  [0.083, 0.083, 0.24, 0.241, 0.241, 0.148, 0.241, 0.083, 0.394, 0.255, 0.16, 0.317, 0.083, 0.343, 0.241]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6892
Averaged Test Accurancy: 0.1706
Averaged Test AUC: 0.8979
Averaged Test F1_score: 0.1411
Averaged Test Recal score: 0.2102
Std Test Accurancy: 0.0957
Std Test AUC: 0.0208
Std Test F1: 0.0008
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.2128
Epoch: 0|  Loss:  3.0897 |Global loss: 5.7901| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 1|  NKD Loss: 1.2154
Epoch: 1|  Loss:  3.0834 |Global loss: 5.7969| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 2|  NKD Loss: 1.2257
Epoch: 2|  Loss:  3.0842 |Global loss: 5.788| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 3|  NKD Loss: 1.2131
Epoch: 3|  Loss:  3.068 |Global loss: 5.7932| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 0|  NKD Loss: 1.1869
Epoch: 0|  Loss:  2.8272 |Global loss: 5.772| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 1.1837
Epoch: 1|  Loss:  2.8021 |Global loss: 5.7806| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 2|  NKD Loss: 1.1992
Epoch: 2|  Loss:  2.8141 |Global loss: 5.7576| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 3|  NKD Loss: 1.1985
Epoch: 3|  Loss:  2.7911 |Global loss: 5.7691| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 0|  NKD Loss: 1.1852
Epoch: 0|  Loss:  3.5283 |Global loss: 5.7544| Local H loss: 0.0106  | Global H loss: 0.0106
Epoch: 1|  NKD Loss: 1.2165
Epoch: 1|  Loss:  3.5377 |Global loss: 5.7293| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 2|  NKD Loss: 1.202
Epoch: 2|  Loss:  3.5433 |Global loss: 5.7243| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 3|  NKD Loss: 1.2244
Epoch: 3|  Loss:  3.5344 |Global loss: 5.7164| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 0|  NKD Loss: 1.1891
Epoch: 0|  Loss:  2.5512 |Global loss: 5.7891| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.184
Epoch: 1|  Loss:  2.5513 |Global loss: 5.7855| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 1.1689
Epoch: 2|  Loss:  2.518 |Global loss: 5.7972| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.191
Epoch: 3|  Loss:  2.5444 |Global loss: 5.7767| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 1.169
Epoch: 0|  Loss:  2.7387 |Global loss: 5.7883| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.1987
Epoch: 1|  Loss:  2.7405 |Global loss: 5.7654| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 2|  NKD Loss: 1.1797
Epoch: 2|  Loss:  2.7099 |Global loss: 5.7738| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 3|  NKD Loss: 1.1849
Epoch: 3|  Loss:  2.6898 |Global loss: 5.7658| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 0|  NKD Loss: 1.1971
Epoch: 0|  Loss:  2.6486 |Global loss: 5.8201| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.1993
Epoch: 1|  Loss:  2.6279 |Global loss: 5.8158| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 1.1811
Epoch: 2|  Loss:  2.6127 |Global loss: 5.8313| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 1.1824
Epoch: 3|  Loss:  2.6174 |Global loss: 5.8301| Local H loss: 0.0217  | Global H loss: 0.0217
------------------------- time cost ------------------------- 3.0353918075561523
Chosen Clients:  [9, 8, 5, 0, 2, 11]

-------------Round number: 158-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.175, 0.175, 0.2, 0.117, 0.175, 0.05, 0.358, 0.275, 0.142, 0.292, 0.05, 0.283, 0.183]
AUC in each clients:  [107.673, 106.719, 108.505, 108.358, 110.045, 108.111, 107.874, 106.334, 109.661, 109.69, 107.248, 110.364, 100.52, 106.913, 110.268]
F1 Score:  [0.008, 0.008, 0.176, 0.171, 0.171, 0.087, 0.171, 0.008, 0.332, 0.194, 0.088, 0.252, 0.008, 0.284, 0.171]
Recall Score:  [0.083, 0.083, 0.25, 0.241, 0.241, 0.157, 0.241, 0.083, 0.394, 0.255, 0.16, 0.317, 0.083, 0.343, 0.241]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6850
Averaged Test Accurancy: 0.1717
Averaged Test AUC: 0.8990
Averaged Test F1_score: 0.1419
Averaged Test Recal score: 0.2115
Std Test Accurancy: 0.0954
Std Test AUC: 0.0196
Std Test F1: 0.0008
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.2085
Epoch: 0|  Loss:  2.6719 |Global loss: 5.7771| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 1.1757
Epoch: 1|  Loss:  2.6377 |Global loss: 5.7916| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 1.2013
Epoch: 2|  Loss:  2.633 |Global loss: 5.7875| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.1882
Epoch: 3|  Loss:  2.6113 |Global loss: 5.7913| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 1.208
Epoch: 0|  Loss:  2.4398 |Global loss: 5.811| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.2073
Epoch: 1|  Loss:  2.4345 |Global loss: 5.7996| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1904
Epoch: 2|  Loss:  2.4049 |Global loss: 5.8183| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 1.2027
Epoch: 3|  Loss:  2.4147 |Global loss: 5.8116| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 1.1968
Epoch: 0|  Loss:  2.7846 |Global loss: 5.7659| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.1935
Epoch: 1|  Loss:  2.7693 |Global loss: 5.7741| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 2|  NKD Loss: 1.1927
Epoch: 2|  Loss:  2.7532 |Global loss: 5.7732| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.207
Epoch: 3|  Loss:  2.7551 |Global loss: 5.7654| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 1.1733
Epoch: 0|  Loss:  2.6697 |Global loss: 5.7795| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 1|  NKD Loss: 1.193
Epoch: 1|  Loss:  2.6727 |Global loss: 5.766| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 1.1936
Epoch: 2|  Loss:  2.6604 |Global loss: 5.7697| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 3|  NKD Loss: 1.1933
Epoch: 3|  Loss:  2.6509 |Global loss: 5.7679| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 0|  NKD Loss: 1.2002
Epoch: 0|  Loss:  2.5134 |Global loss: 5.7714| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.1835
Epoch: 1|  Loss:  2.5085 |Global loss: 5.7724| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1697
Epoch: 2|  Loss:  2.4837 |Global loss: 5.792| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 1.1614
Epoch: 3|  Loss:  2.4674 |Global loss: 5.7991| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 0|  NKD Loss: 1.1469
Epoch: 0|  Loss:  2.2922 |Global loss: 5.7502| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.1636
Epoch: 1|  Loss:  2.2953 |Global loss: 5.7415| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 1.1307
Epoch: 2|  Loss:  2.2498 |Global loss: 5.7689| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.1442
Epoch: 3|  Loss:  2.2518 |Global loss: 5.7552| Local H loss: 0.0291  | Global H loss: 0.0291
------------------------- time cost ------------------------- 2.9989285469055176
Chosen Clients:  [4, 11, 10, 13, 5, 12]

-------------Round number: 159-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.175, 0.175, 0.2, 0.117, 0.175, 0.05, 0.358, 0.325, 0.142, 0.375, 0.05, 0.283, 0.183]
AUC in each clients:  [108.622, 106.719, 108.644, 108.358, 110.045, 108.099, 107.874, 106.334, 110.102, 110.142, 107.248, 110.805, 100.52, 106.913, 110.268]
F1 Score:  [0.008, 0.008, 0.176, 0.171, 0.171, 0.087, 0.171, 0.008, 0.332, 0.257, 0.088, 0.329, 0.008, 0.284, 0.171]
Recall Score:  [0.083, 0.083, 0.25, 0.241, 0.241, 0.157, 0.241, 0.083, 0.394, 0.326, 0.16, 0.387, 0.083, 0.343, 0.241]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6608
Averaged Test Accurancy: 0.1806
Averaged Test AUC: 0.9004
Averaged Test F1_score: 0.1513
Averaged Test Recal score: 0.2209
Std Test Accurancy: 0.1080
Std Test AUC: 0.0203
Std Test F1: 0.0009
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.1839
Epoch: 0|  Loss:  2.5698 |Global loss: 5.7801| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 1.1801
Epoch: 1|  Loss:  2.5557 |Global loss: 5.7804| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 1.1765
Epoch: 2|  Loss:  2.5406 |Global loss: 5.7748| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 1.1705
Epoch: 3|  Loss:  2.5148 |Global loss: 5.7843| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 1.1298
Epoch: 0|  Loss:  2.2463 |Global loss: 5.7594| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 1.1401
Epoch: 1|  Loss:  2.2324 |Global loss: 5.7537| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 1.1306
Epoch: 2|  Loss:  2.2073 |Global loss: 5.7606| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 1.1399
Epoch: 3|  Loss:  2.2082 |Global loss: 5.7528| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 1.2016
Epoch: 0|  Loss:  2.6187 |Global loss: 5.8137| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 1.1875
Epoch: 1|  Loss:  2.6036 |Global loss: 5.8265| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 1.1796
Epoch: 2|  Loss:  2.5798 |Global loss: 5.8441| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 1.1915
Epoch: 3|  Loss:  2.5868 |Global loss: 5.8226| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 0|  NKD Loss: 1.2119
Epoch: 0|  Loss:  2.6931 |Global loss: 5.7978| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 1.176
Epoch: 1|  Loss:  2.6706 |Global loss: 5.8148| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 1.195
Epoch: 2|  Loss:  2.6846 |Global loss: 5.8084| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.1688
Epoch: 3|  Loss:  2.6535 |Global loss: 5.8202| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.1993
Epoch: 0|  Loss:  2.7507 |Global loss: 5.7641| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 1|  NKD Loss: 1.1858
Epoch: 1|  Loss:  2.7182 |Global loss: 5.7834| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 2|  NKD Loss: 1.1784
Epoch: 2|  Loss:  2.702 |Global loss: 5.7852| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 3|  NKD Loss: 1.1933
Epoch: 3|  Loss:  2.6974 |Global loss: 5.7774| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 0|  NKD Loss: 1.1927
Epoch: 0|  Loss:  3.5029 |Global loss: 5.7501| Local H loss: 0.0109  | Global H loss: 0.0109
Epoch: 1|  NKD Loss: 1.1818
Epoch: 1|  Loss:  3.5022 |Global loss: 5.7525| Local H loss: 0.0108  | Global H loss: 0.0108
Epoch: 2|  NKD Loss: 1.2218
Epoch: 2|  Loss:  3.508 |Global loss: 5.722| Local H loss: 0.0111  | Global H loss: 0.0111
Epoch: 3|  NKD Loss: 1.2387
Epoch: 3|  Loss:  3.5043 |Global loss: 5.7117| Local H loss: 0.0112  | Global H loss: 0.0112
------------------------- time cost ------------------------- 3.043217897415161
Chosen Clients:  [12, 2, 1, 6, 4, 14]

-------------Round number: 160-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.05, 0.175, 0.175, 0.2, 0.117, 0.175, 0.05, 0.358, 0.325, 0.142, 0.458, 0.05, 0.267, 0.183]
AUC in each clients:  [108.622, 106.719, 108.644, 108.358, 110.539, 108.345, 107.874, 106.334, 110.102, 110.142, 107.947, 111.558, 100.894, 107.081, 110.268]
F1 Score:  [0.008, 0.008, 0.176, 0.171, 0.171, 0.087, 0.171, 0.008, 0.332, 0.257, 0.088, 0.418, 0.008, 0.266, 0.171]
Recall Score:  [0.083, 0.083, 0.25, 0.241, 0.241, 0.157, 0.241, 0.083, 0.394, 0.326, 0.16, 0.477, 0.083, 0.324, 0.241]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6410
Averaged Test Accurancy: 0.1850
Averaged Test AUC: 0.9019
Averaged Test F1_score: 0.1560
Averaged Test Recal score: 0.2256
Std Test Accurancy: 0.1186
Std Test AUC: 0.0203
Std Test F1: 0.0010
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 1.1772
Epoch: 0|  Loss:  3.4557 |Global loss: 5.7682| Local H loss: 0.011  | Global H loss: 0.011
Epoch: 1|  NKD Loss: 1.2175
Epoch: 1|  Loss:  3.4664 |Global loss: 5.7338| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 2|  NKD Loss: 1.2269
Epoch: 2|  Loss:  3.4726 |Global loss: 5.7253| Local H loss: 0.0113  | Global H loss: 0.0113
Epoch: 3|  NKD Loss: 1.2356
Epoch: 3|  Loss:  3.4614 |Global loss: 5.7244| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 0|  NKD Loss: 1.1896
Epoch: 0|  Loss:  2.4861 |Global loss: 5.765| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1707
Epoch: 1|  Loss:  2.4614 |Global loss: 5.7868| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1595
Epoch: 2|  Loss:  2.4509 |Global loss: 5.7927| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.17
Epoch: 3|  Loss:  2.4277 |Global loss: 5.7874| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.1916
Epoch: 0|  Loss:  2.8672 |Global loss: 5.7589| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 1|  NKD Loss: 1.1984
Epoch: 1|  Loss:  2.8577 |Global loss: 5.7523| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 2|  NKD Loss: 1.2002
Epoch: 2|  Loss:  2.8534 |Global loss: 5.7438| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 3|  NKD Loss: 1.2072
Epoch: 3|  Loss:  2.8526 |Global loss: 5.7468| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 0|  NKD Loss: 1.1994
Epoch: 0|  Loss:  2.5247 |Global loss: 5.7887| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 1.1767
Epoch: 1|  Loss:  2.4955 |Global loss: 5.7946| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 1.1715
Epoch: 2|  Loss:  2.4791 |Global loss: 5.7944| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1769
Epoch: 3|  Loss:  2.4808 |Global loss: 5.7969| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 1.1799
Epoch: 0|  Loss:  2.5035 |Global loss: 5.778| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.173
Epoch: 1|  Loss:  2.4822 |Global loss: 5.7801| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 1.1609
Epoch: 2|  Loss:  2.4487 |Global loss: 5.7946| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1768
Epoch: 3|  Loss:  2.4589 |Global loss: 5.779| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.2019
Epoch: 0|  Loss:  2.489 |Global loss: 5.8008| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.1974
Epoch: 1|  Loss:  2.463 |Global loss: 5.8073| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 1.1898
Epoch: 2|  Loss:  2.4513 |Global loss: 5.8197| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.1806
Epoch: 3|  Loss:  2.4353 |Global loss: 5.816| Local H loss: 0.0238  | Global H loss: 0.0238
------------------------- time cost ------------------------- 2.910102128982544
Chosen Clients:  [5, 9, 4, 2, 14, 13]

-------------Round number: 161-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.133, 0.175, 0.175, 0.283, 0.117, 0.175, 0.05, 0.358, 0.325, 0.142, 0.458, 0.05, 0.267, 0.183]
AUC in each clients:  [108.622, 107.08, 109.311, 108.358, 110.777, 108.345, 107.993, 106.334, 110.102, 110.142, 107.947, 111.558, 101.489, 107.081, 110.448]
F1 Score:  [0.008, 0.092, 0.176, 0.171, 0.248, 0.087, 0.171, 0.008, 0.332, 0.257, 0.088, 0.418, 0.008, 0.266, 0.171]
Recall Score:  [0.083, 0.167, 0.25, 0.241, 0.31, 0.157, 0.241, 0.083, 0.394, 0.326, 0.16, 0.477, 0.083, 0.324, 0.241]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.6306
Averaged Test Accurancy: 0.1961
Averaged Test AUC: 0.9031
Averaged Test F1_score: 0.1667
Averaged Test Recal score: 0.2358
Std Test Accurancy: 0.1163
Std Test AUC: 0.0195
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.1988
Epoch: 0|  Loss:  2.7014 |Global loss: 5.7729| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 1.1771
Epoch: 1|  Loss:  2.6665 |Global loss: 5.7872| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 2|  NKD Loss: 1.1931
Epoch: 2|  Loss:  2.6647 |Global loss: 5.7795| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 3|  NKD Loss: 1.1865
Epoch: 3|  Loss:  2.6608 |Global loss: 5.776| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 0|  NKD Loss: 1.1886
Epoch: 0|  Loss:  2.6071 |Global loss: 5.7904| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 1.2027
Epoch: 1|  Loss:  2.5947 |Global loss: 5.7871| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 2|  NKD Loss: 1.1768
Epoch: 2|  Loss:  2.5694 |Global loss: 5.7983| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 1.1869
Epoch: 3|  Loss:  2.5636 |Global loss: 5.7941| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 0|  NKD Loss: 1.1739
Epoch: 0|  Loss:  2.446 |Global loss: 5.7825| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.1582
Epoch: 1|  Loss:  2.4061 |Global loss: 5.7897| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.1673
Epoch: 2|  Loss:  2.3958 |Global loss: 5.7843| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 1.1495
Epoch: 3|  Loss:  2.3913 |Global loss: 5.7929| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 1.1837
Epoch: 0|  Loss:  2.4422 |Global loss: 5.7766| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 1.1562
Epoch: 1|  Loss:  2.423 |Global loss: 5.7946| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1729
Epoch: 2|  Loss:  2.4173 |Global loss: 5.7869| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 1.1511
Epoch: 3|  Loss:  2.3885 |Global loss: 5.7931| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 1.1704
Epoch: 0|  Loss:  2.4186 |Global loss: 5.8246| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 1.1759
Epoch: 1|  Loss:  2.4041 |Global loss: 5.8194| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.2013
Epoch: 2|  Loss:  2.4203 |Global loss: 5.807| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 1.1699
Epoch: 3|  Loss:  2.3844 |Global loss: 5.8176| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 1.1937
Epoch: 0|  Loss:  2.6673 |Global loss: 5.7991| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.1696
Epoch: 1|  Loss:  2.6395 |Global loss: 5.8194| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1921
Epoch: 2|  Loss:  2.6335 |Global loss: 5.8072| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1736
Epoch: 3|  Loss:  2.6281 |Global loss: 5.8164| Local H loss: 0.0232  | Global H loss: 0.0232
------------------------- time cost ------------------------- 3.023668050765991
Chosen Clients:  [2, 12, 9, 11, 6, 8]

-------------Round number: 162-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.133, 0.25, 0.175, 0.292, 0.117, 0.175, 0.05, 0.358, 0.325, 0.142, 0.458, 0.05, 0.317, 0.267]
AUC in each clients:  [108.622, 107.08, 109.62, 108.358, 111.355, 108.784, 107.993, 106.334, 110.102, 110.505, 107.947, 111.558, 101.489, 107.094, 110.752]
F1 Score:  [0.008, 0.092, 0.254, 0.171, 0.252, 0.087, 0.171, 0.008, 0.332, 0.257, 0.088, 0.418, 0.008, 0.32, 0.255]
Recall Score:  [0.083, 0.167, 0.333, 0.241, 0.317, 0.157, 0.241, 0.083, 0.394, 0.326, 0.16, 0.477, 0.083, 0.376, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5957
Averaged Test Accurancy: 0.2106
Averaged Test AUC: 0.9042
Averaged Test F1_score: 0.1814
Averaged Test Recal score: 0.2508
Std Test Accurancy: 0.1206
Std Test AUC: 0.0203
Std Test F1: 0.0010
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 1.1497
Epoch: 0|  Loss:  2.3793 |Global loss: 5.8014| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 1.1659
Epoch: 1|  Loss:  2.388 |Global loss: 5.7811| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.1679
Epoch: 2|  Loss:  2.3832 |Global loss: 5.7869| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.1543
Epoch: 3|  Loss:  2.3584 |Global loss: 5.7896| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 1.1969
Epoch: 0|  Loss:  3.4293 |Global loss: 5.7607| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 1|  NKD Loss: 1.1978
Epoch: 1|  Loss:  3.4302 |Global loss: 5.7542| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 2|  NKD Loss: 1.2034
Epoch: 2|  Loss:  3.4309 |Global loss: 5.7468| Local H loss: 0.0115  | Global H loss: 0.0115
Epoch: 3|  NKD Loss: 1.2261
Epoch: 3|  Loss:  3.4267 |Global loss: 5.7407| Local H loss: 0.0117  | Global H loss: 0.0117
Epoch: 0|  NKD Loss: 1.1797
Epoch: 0|  Loss:  2.5556 |Global loss: 5.803| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1736
Epoch: 1|  Loss:  2.5253 |Global loss: 5.8002| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1654
Epoch: 2|  Loss:  2.5094 |Global loss: 5.8085| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.1623
Epoch: 3|  Loss:  2.4838 |Global loss: 5.8178| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 1.1114
Epoch: 0|  Loss:  2.1543 |Global loss: 5.7733| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 1.1207
Epoch: 1|  Loss:  2.1686 |Global loss: 5.7623| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 1.1139
Epoch: 2|  Loss:  2.1459 |Global loss: 5.7706| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 1.1246
Epoch: 3|  Loss:  2.1396 |Global loss: 5.7613| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.1753
Epoch: 0|  Loss:  2.4697 |Global loss: 5.7912| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 1.1672
Epoch: 1|  Loss:  2.4443 |Global loss: 5.8016| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1656
Epoch: 2|  Loss:  2.4387 |Global loss: 5.805| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 3|  NKD Loss: 1.1655
Epoch: 3|  Loss:  2.4326 |Global loss: 5.7986| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.1785
Epoch: 0|  Loss:  2.3963 |Global loss: 5.8231| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.1784
Epoch: 1|  Loss:  2.3805 |Global loss: 5.8214| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.1614
Epoch: 2|  Loss:  2.3727 |Global loss: 5.8377| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 1.1709
Epoch: 3|  Loss:  2.3303 |Global loss: 5.8325| Local H loss: 0.0259  | Global H loss: 0.0259
------------------------- time cost ------------------------- 2.7252004146575928
Chosen Clients:  [10, 8, 1, 11, 2, 9]

-------------Round number: 163-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.133, 0.25, 0.175, 0.292, 0.117, 0.233, 0.05, 0.358, 0.408, 0.142, 0.458, 0.05, 0.317, 0.267]
AUC in each clients:  [108.622, 107.08, 109.952, 108.358, 111.355, 108.784, 108.197, 106.334, 110.516, 110.977, 107.947, 111.779, 102.009, 107.094, 110.752]
F1 Score:  [0.008, 0.092, 0.254, 0.171, 0.252, 0.087, 0.244, 0.008, 0.332, 0.333, 0.088, 0.418, 0.008, 0.32, 0.255]
Recall Score:  [0.083, 0.167, 0.333, 0.241, 0.317, 0.157, 0.306, 0.083, 0.394, 0.396, 0.16, 0.477, 0.083, 0.376, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5814
Averaged Test Accurancy: 0.2200
Averaged Test AUC: 0.9054
Averaged Test F1_score: 0.1913
Averaged Test Recal score: 0.2598
Std Test Accurancy: 0.1271
Std Test AUC: 0.0201
Std Test F1: 0.0011
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 1.2083
Epoch: 0|  Loss:  2.6018 |Global loss: 5.8131| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.2029
Epoch: 1|  Loss:  2.5755 |Global loss: 5.8254| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 1.1735
Epoch: 2|  Loss:  2.5575 |Global loss: 5.8396| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 1.1763
Epoch: 3|  Loss:  2.5329 |Global loss: 5.843| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 1.1976
Epoch: 0|  Loss:  2.3645 |Global loss: 5.8097| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.1853
Epoch: 1|  Loss:  2.3467 |Global loss: 5.8192| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 1.1652
Epoch: 2|  Loss:  2.3099 |Global loss: 5.835| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1605
Epoch: 3|  Loss:  2.3075 |Global loss: 5.8348| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.1722
Epoch: 0|  Loss:  2.8018 |Global loss: 5.7777| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 1|  NKD Loss: 1.1995
Epoch: 1|  Loss:  2.8116 |Global loss: 5.7637| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.1637
Epoch: 2|  Loss:  2.7739 |Global loss: 5.7836| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 3|  NKD Loss: 1.197
Epoch: 3|  Loss:  2.7772 |Global loss: 5.7686| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.1019
Epoch: 0|  Loss:  2.1144 |Global loss: 5.7634| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 1.1406
Epoch: 1|  Loss:  2.1281 |Global loss: 5.7529| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.1129
Epoch: 2|  Loss:  2.1092 |Global loss: 5.7527| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.1242
Epoch: 3|  Loss:  2.0894 |Global loss: 5.7573| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.1516
Epoch: 0|  Loss:  2.3659 |Global loss: 5.791| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.1392
Epoch: 1|  Loss:  2.3309 |Global loss: 5.7988| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 1.1518
Epoch: 2|  Loss:  2.3461 |Global loss: 5.7944| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 1.136
Epoch: 3|  Loss:  2.3239 |Global loss: 5.8088| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 1.1695
Epoch: 0|  Loss:  2.4876 |Global loss: 5.8089| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1685
Epoch: 1|  Loss:  2.4752 |Global loss: 5.8109| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.1689
Epoch: 2|  Loss:  2.4567 |Global loss: 5.8075| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 1.1599
Epoch: 3|  Loss:  2.4413 |Global loss: 5.8148| Local H loss: 0.0246  | Global H loss: 0.0246
------------------------- time cost ------------------------- 2.831613063812256
Chosen Clients:  [4, 7, 5, 13, 11, 10]

-------------Round number: 164-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.133, 0.275, 0.175, 0.292, 0.117, 0.233, 0.05, 0.358, 0.375, 0.142, 0.517, 0.05, 0.317, 0.267]
AUC in each clients:  [108.622, 107.459, 110.132, 108.358, 111.355, 108.784, 108.197, 106.334, 110.852, 111.357, 107.689, 112.407, 102.009, 107.094, 110.752]
F1 Score:  [0.008, 0.092, 0.3, 0.171, 0.252, 0.087, 0.244, 0.008, 0.332, 0.311, 0.088, 0.502, 0.008, 0.32, 0.255]
Recall Score:  [0.083, 0.167, 0.365, 0.241, 0.317, 0.157, 0.306, 0.083, 0.394, 0.368, 0.16, 0.56, 0.083, 0.376, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5537
Averaged Test Accurancy: 0.2233
Averaged Test AUC: 0.9063
Averaged Test F1_score: 0.1985
Averaged Test Recal score: 0.2656
Std Test Accurancy: 0.1326
Std Test AUC: 0.0209
Std Test F1: 0.0012
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1631
Epoch: 0|  Loss:  2.358 |Global loss: 5.7907| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.142
Epoch: 1|  Loss:  2.3433 |Global loss: 5.804| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1506
Epoch: 2|  Loss:  2.3307 |Global loss: 5.7938| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.142
Epoch: 3|  Loss:  2.3197 |Global loss: 5.8| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.211
Epoch: 0|  Loss:  3.0543 |Global loss: 5.8075| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.2067
Epoch: 1|  Loss:  3.0354 |Global loss: 5.8125| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 2|  NKD Loss: 1.2099
Epoch: 2|  Loss:  3.0283 |Global loss: 5.8066| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 3|  NKD Loss: 1.2198
Epoch: 3|  Loss:  3.0365 |Global loss: 5.7976| Local H loss: 0.0181  | Global H loss: 0.0181
Epoch: 0|  NKD Loss: 1.1613
Epoch: 0|  Loss:  2.6229 |Global loss: 5.8076| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.1653
Epoch: 1|  Loss:  2.6209 |Global loss: 5.793| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 2|  NKD Loss: 1.1789
Epoch: 2|  Loss:  2.6135 |Global loss: 5.7887| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 1.1665
Epoch: 3|  Loss:  2.597 |Global loss: 5.8021| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 1.1903
Epoch: 0|  Loss:  2.628 |Global loss: 5.8105| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.1534
Epoch: 1|  Loss:  2.6208 |Global loss: 5.8208| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1816
Epoch: 2|  Loss:  2.6053 |Global loss: 5.8193| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1766
Epoch: 3|  Loss:  2.6153 |Global loss: 5.8152| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 1.0974
Epoch: 0|  Loss:  2.0562 |Global loss: 5.7688| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.1092
Epoch: 1|  Loss:  2.0578 |Global loss: 5.7626| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 1.0977
Epoch: 2|  Loss:  2.0332 |Global loss: 5.7635| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 1.0825
Epoch: 3|  Loss:  2.0258 |Global loss: 5.7753| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.1866
Epoch: 0|  Loss:  2.5547 |Global loss: 5.8324| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 1.1736
Epoch: 1|  Loss:  2.5229 |Global loss: 5.8435| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 1.1594
Epoch: 2|  Loss:  2.5059 |Global loss: 5.8534| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 3|  NKD Loss: 1.1597
Epoch: 3|  Loss:  2.4993 |Global loss: 5.8616| Local H loss: 0.0226  | Global H loss: 0.0226
------------------------- time cost ------------------------- 2.858191967010498
Chosen Clients:  [4, 11, 2, 0, 9, 1]

-------------Round number: 165-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.05, 0.133, 0.275, 0.175, 0.35, 0.117, 0.233, 0.05, 0.358, 0.375, 0.142, 0.517, 0.05, 0.35, 0.267]
AUC in each clients:  [108.622, 107.459, 110.132, 108.358, 111.656, 108.824, 108.197, 106.594, 110.852, 111.357, 108.143, 113.031, 102.009, 107.098, 110.752]
F1 Score:  [0.008, 0.092, 0.3, 0.171, 0.306, 0.087, 0.244, 0.008, 0.332, 0.311, 0.088, 0.502, 0.008, 0.341, 0.255]
Recall Score:  [0.083, 0.167, 0.365, 0.241, 0.356, 0.157, 0.306, 0.083, 0.394, 0.368, 0.16, 0.56, 0.083, 0.41, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5435
Averaged Test Accurancy: 0.2294
Averaged Test AUC: 0.9073
Averaged Test F1_score: 0.2035
Averaged Test Recal score: 0.2705
Std Test Accurancy: 0.1371
Std Test AUC: 0.0214
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1254
Epoch: 0|  Loss:  2.2768 |Global loss: 5.8122| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.1351
Epoch: 1|  Loss:  2.2871 |Global loss: 5.8044| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.1319
Epoch: 2|  Loss:  2.2551 |Global loss: 5.8088| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.1317
Epoch: 3|  Loss:  2.2476 |Global loss: 5.8036| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.0999
Epoch: 0|  Loss:  2.02 |Global loss: 5.7675| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 1.0919
Epoch: 1|  Loss:  2.0007 |Global loss: 5.7711| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 1.0738
Epoch: 2|  Loss:  1.9903 |Global loss: 5.7785| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 1.0975
Epoch: 3|  Loss:  1.9859 |Global loss: 5.765| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 1.1385
Epoch: 0|  Loss:  2.3247 |Global loss: 5.8015| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.1425
Epoch: 1|  Loss:  2.3081 |Global loss: 5.7993| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.1352
Epoch: 2|  Loss:  2.2913 |Global loss: 5.7921| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 1.1259
Epoch: 3|  Loss:  2.2805 |Global loss: 5.8131| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1637
Epoch: 0|  Loss:  2.6014 |Global loss: 5.7998| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 1.1691
Epoch: 1|  Loss:  2.5742 |Global loss: 5.7851| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.1642
Epoch: 2|  Loss:  2.5882 |Global loss: 5.7843| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 1.1754
Epoch: 3|  Loss:  2.5846 |Global loss: 5.7789| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 1.1795
Epoch: 0|  Loss:  2.4523 |Global loss: 5.8043| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 1.1563
Epoch: 1|  Loss:  2.4115 |Global loss: 5.8082| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.1343
Epoch: 2|  Loss:  2.3842 |Global loss: 5.8321| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.1577
Epoch: 3|  Loss:  2.3944 |Global loss: 5.8128| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 1.1758
Epoch: 0|  Loss:  2.7564 |Global loss: 5.7829| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 1|  NKD Loss: 1.1693
Epoch: 1|  Loss:  2.7577 |Global loss: 5.7812| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 2|  NKD Loss: 1.1776
Epoch: 2|  Loss:  2.7215 |Global loss: 5.7859| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 3|  NKD Loss: 1.1863
Epoch: 3|  Loss:  2.7213 |Global loss: 5.7774| Local H loss: 0.02  | Global H loss: 0.02
------------------------- time cost ------------------------- 2.963115930557251
Chosen Clients:  [11, 5, 2, 1, 13, 10]

-------------Round number: 166-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.083, 0.133, 0.317, 0.175, 0.4, 0.117, 0.233, 0.05, 0.358, 0.425, 0.142, 0.517, 0.05, 0.35, 0.267]
AUC in each clients:  [109.207, 107.631, 110.426, 108.358, 112.007, 108.824, 108.197, 106.594, 110.852, 111.836, 108.143, 112.911, 102.009, 107.098, 110.752]
F1 Score:  [0.05, 0.092, 0.334, 0.171, 0.331, 0.087, 0.244, 0.008, 0.332, 0.342, 0.088, 0.502, 0.008, 0.341, 0.255]
Recall Score:  [0.111, 0.167, 0.417, 0.241, 0.389, 0.157, 0.306, 0.083, 0.394, 0.41, 0.16, 0.56, 0.083, 0.41, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5176
Averaged Test Accurancy: 0.2411
Averaged Test AUC: 0.9082
Averaged Test F1_score: 0.2123
Averaged Test Recal score: 0.2808
Std Test Accurancy: 0.1429
Std Test AUC: 0.0218
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1022
Epoch: 0|  Loss:  1.9961 |Global loss: 5.7559| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 1.1033
Epoch: 1|  Loss:  1.9885 |Global loss: 5.752| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.0804
Epoch: 2|  Loss:  1.9579 |Global loss: 5.7687| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 1.0825
Epoch: 3|  Loss:  1.9326 |Global loss: 5.7655| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.1619
Epoch: 0|  Loss:  2.5953 |Global loss: 5.799| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 1.1886
Epoch: 1|  Loss:  2.5997 |Global loss: 5.7863| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 1.153
Epoch: 2|  Loss:  2.577 |Global loss: 5.8036| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 1.1638
Epoch: 3|  Loss:  2.5607 |Global loss: 5.8054| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 0|  NKD Loss: 1.1461
Epoch: 0|  Loss:  2.276 |Global loss: 5.787| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 1.1546
Epoch: 1|  Loss:  2.2867 |Global loss: 5.7934| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1315
Epoch: 2|  Loss:  2.2738 |Global loss: 5.793| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 1.1355
Epoch: 3|  Loss:  2.2631 |Global loss: 5.7898| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 1.1691
Epoch: 0|  Loss:  2.6963 |Global loss: 5.7884| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 1|  NKD Loss: 1.1702
Epoch: 1|  Loss:  2.6895 |Global loss: 5.7945| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 2|  NKD Loss: 1.1795
Epoch: 2|  Loss:  2.6797 |Global loss: 5.7849| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 3|  NKD Loss: 1.1883
Epoch: 3|  Loss:  2.6736 |Global loss: 5.7771| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 0|  NKD Loss: 1.1865
Epoch: 0|  Loss:  2.6039 |Global loss: 5.8097| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 1.1704
Epoch: 1|  Loss:  2.5733 |Global loss: 5.8208| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1727
Epoch: 2|  Loss:  2.5837 |Global loss: 5.8159| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.1677
Epoch: 3|  Loss:  2.5621 |Global loss: 5.8237| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 1.1924
Epoch: 0|  Loss:  2.5266 |Global loss: 5.8313| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.1559
Epoch: 1|  Loss:  2.486 |Global loss: 5.8655| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 1.1555
Epoch: 2|  Loss:  2.4829 |Global loss: 5.8531| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 3|  NKD Loss: 1.1697
Epoch: 3|  Loss:  2.4786 |Global loss: 5.844| Local H loss: 0.023  | Global H loss: 0.023
------------------------- time cost ------------------------- 2.7963345050811768
Chosen Clients:  [14, 8, 9, 7, 3, 0]

-------------Round number: 167-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.083, 0.133, 0.317, 0.175, 0.4, 0.192, 0.233, 0.05, 0.358, 0.425, 0.142, 0.517, 0.05, 0.333, 0.267]
AUC in each clients:  [109.207, 107.915, 110.571, 108.358, 112.007, 109.264, 108.197, 106.594, 110.852, 111.836, 108.707, 112.998, 102.009, 107.483, 110.752]
F1 Score:  [0.05, 0.092, 0.334, 0.171, 0.331, 0.171, 0.244, 0.008, 0.332, 0.342, 0.088, 0.502, 0.008, 0.331, 0.255]
Recall Score:  [0.111, 0.167, 0.417, 0.241, 0.389, 0.241, 0.306, 0.083, 0.394, 0.41, 0.16, 0.56, 0.083, 0.393, 0.324]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.5013
Averaged Test Accurancy: 0.2450
Averaged Test AUC: 0.9093
Averaged Test F1_score: 0.2173
Averaged Test Recal score: 0.2853
Std Test Accurancy: 0.1390
Std Test AUC: 0.0216
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1572
Epoch: 0|  Loss:  2.3602 |Global loss: 5.836| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.1771
Epoch: 1|  Loss:  2.3677 |Global loss: 5.8274| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1746
Epoch: 2|  Loss:  2.3653 |Global loss: 5.8246| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 1.1592
Epoch: 3|  Loss:  2.3544 |Global loss: 5.8263| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 1.1762
Epoch: 0|  Loss:  2.3148 |Global loss: 5.829| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.1701
Epoch: 1|  Loss:  2.3162 |Global loss: 5.8437| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.1685
Epoch: 2|  Loss:  2.2844 |Global loss: 5.8354| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.1604
Epoch: 3|  Loss:  2.2794 |Global loss: 5.8325| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 1.1404
Epoch: 0|  Loss:  2.3573 |Global loss: 5.8225| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.1517
Epoch: 1|  Loss:  2.3653 |Global loss: 5.8235| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.1679
Epoch: 2|  Loss:  2.3536 |Global loss: 5.8132| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 1.1268
Epoch: 3|  Loss:  2.3 |Global loss: 5.8414| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 1.1802
Epoch: 0|  Loss:  2.9952 |Global loss: 5.8353| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.2208
Epoch: 1|  Loss:  3.0107 |Global loss: 5.8082| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 2|  NKD Loss: 1.206
Epoch: 2|  Loss:  2.9956 |Global loss: 5.8145| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 3|  NKD Loss: 1.2007
Epoch: 3|  Loss:  2.9895 |Global loss: 5.8157| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 0|  NKD Loss: 1.1549
Epoch: 0|  Loss:  2.5169 |Global loss: 5.7807| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 1.1291
Epoch: 1|  Loss:  2.4847 |Global loss: 5.7933| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.1415
Epoch: 2|  Loss:  2.4881 |Global loss: 5.7877| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 3|  NKD Loss: 1.1512
Epoch: 3|  Loss:  2.4853 |Global loss: 5.7861| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.1527
Epoch: 0|  Loss:  2.5106 |Global loss: 5.8003| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 1.1465
Epoch: 1|  Loss:  2.5115 |Global loss: 5.7961| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 1.1559
Epoch: 2|  Loss:  2.4956 |Global loss: 5.7892| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 1.1688
Epoch: 3|  Loss:  2.5089 |Global loss: 5.7896| Local H loss: 0.0235  | Global H loss: 0.0235
------------------------- time cost ------------------------- 3.13527774810791
Chosen Clients:  [12, 1, 13, 14, 6, 10]

-------------Round number: 168-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.258, 0.133, 0.317, 0.158, 0.4, 0.192, 0.233, 0.108, 0.358, 0.425, 0.142, 0.517, 0.05, 0.333, 0.292]
AUC in each clients:  [110.16, 107.915, 110.571, 108.371, 112.007, 109.264, 108.197, 106.811, 111.201, 111.91, 108.707, 112.998, 102.009, 107.483, 110.742]
F1 Score:  [0.186, 0.092, 0.334, 0.157, 0.331, 0.171, 0.244, 0.081, 0.332, 0.342, 0.088, 0.502, 0.008, 0.331, 0.297]
Recall Score:  [0.242, 0.167, 0.417, 0.217, 0.389, 0.241, 0.306, 0.148, 0.394, 0.41, 0.16, 0.56, 0.083, 0.393, 0.352]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4879
Averaged Test Accurancy: 0.2611
Averaged Test AUC: 0.9102
Averaged Test F1_score: 0.2331
Averaged Test Recal score: 0.2986
Std Test Accurancy: 0.1278
Std Test AUC: 0.0218
Std Test F1: 0.0011
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1821
Epoch: 0|  Loss:  3.3779 |Global loss: 5.7905| Local H loss: 0.0116  | Global H loss: 0.0116
Epoch: 1|  NKD Loss: 1.1993
Epoch: 1|  Loss:  3.3944 |Global loss: 5.7612| Local H loss: 0.0118  | Global H loss: 0.0118
Epoch: 2|  NKD Loss: 1.2115
Epoch: 2|  Loss:  3.3943 |Global loss: 5.7498| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 3|  NKD Loss: 1.227
Epoch: 3|  Loss:  3.3853 |Global loss: 5.7432| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 0|  NKD Loss: 1.1436
Epoch: 0|  Loss:  2.6447 |Global loss: 5.8127| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 1|  NKD Loss: 1.1544
Epoch: 1|  Loss:  2.6402 |Global loss: 5.8061| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 2|  NKD Loss: 1.1646
Epoch: 2|  Loss:  2.6238 |Global loss: 5.8| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 3|  NKD Loss: 1.1739
Epoch: 3|  Loss:  2.6407 |Global loss: 5.7965| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 1.1608
Epoch: 0|  Loss:  2.5779 |Global loss: 5.8102| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 1.1584
Epoch: 1|  Loss:  2.5672 |Global loss: 5.8237| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1701
Epoch: 2|  Loss:  2.5588 |Global loss: 5.8161| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.16
Epoch: 3|  Loss:  2.5494 |Global loss: 5.8212| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.1837
Epoch: 0|  Loss:  2.3494 |Global loss: 5.8142| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 1.1774
Epoch: 1|  Loss:  2.3311 |Global loss: 5.816| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.1499
Epoch: 2|  Loss:  2.3114 |Global loss: 5.8257| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.1487
Epoch: 3|  Loss:  2.2892 |Global loss: 5.8424| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.1656
Epoch: 0|  Loss:  2.4344 |Global loss: 5.7942| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.164
Epoch: 1|  Loss:  2.4087 |Global loss: 5.8039| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 1.1335
Epoch: 2|  Loss:  2.384 |Global loss: 5.8112| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 3|  NKD Loss: 1.1444
Epoch: 3|  Loss:  2.3844 |Global loss: 5.8115| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 0|  NKD Loss: 1.1861
Epoch: 0|  Loss:  2.4897 |Global loss: 5.842| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1747
Epoch: 1|  Loss:  2.4613 |Global loss: 5.8448| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 2|  NKD Loss: 1.1579
Epoch: 2|  Loss:  2.4534 |Global loss: 5.8645| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 1.1721
Epoch: 3|  Loss:  2.4317 |Global loss: 5.8427| Local H loss: 0.0238  | Global H loss: 0.0238
------------------------- time cost ------------------------- 2.8971731662750244
Chosen Clients:  [3, 6, 7, 4, 10, 11]

-------------Round number: 169-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.258, 0.133, 0.317, 0.158, 0.4, 0.192, 0.233, 0.108, 0.358, 0.425, 0.142, 0.517, 0.05, 0.35, 0.342]
AUC in each clients:  [110.16, 108.236, 110.571, 108.371, 112.007, 109.264, 108.513, 106.811, 111.201, 111.91, 109.124, 112.998, 102.372, 107.955, 111.115]
F1 Score:  [0.186, 0.092, 0.334, 0.157, 0.331, 0.171, 0.244, 0.081, 0.332, 0.342, 0.088, 0.502, 0.008, 0.341, 0.339]
Recall Score:  [0.242, 0.167, 0.417, 0.217, 0.389, 0.241, 0.306, 0.148, 0.394, 0.41, 0.16, 0.56, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4830
Averaged Test Accurancy: 0.2656
Averaged Test AUC: 0.9114
Averaged Test F1_score: 0.2365
Averaged Test Recal score: 0.3034
Std Test Accurancy: 0.1298
Std Test AUC: 0.0210
Std Test F1: 0.0011
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1472
Epoch: 0|  Loss:  2.4838 |Global loss: 5.7863| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1442
Epoch: 1|  Loss:  2.4742 |Global loss: 5.7821| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 1.1321
Epoch: 2|  Loss:  2.4523 |Global loss: 5.7884| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1392
Epoch: 3|  Loss:  2.4533 |Global loss: 5.7831| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 1.159
Epoch: 0|  Loss:  2.393 |Global loss: 5.793| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1616
Epoch: 1|  Loss:  2.3668 |Global loss: 5.789| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.1551
Epoch: 2|  Loss:  2.3698 |Global loss: 5.7958| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1441
Epoch: 3|  Loss:  2.3444 |Global loss: 5.8039| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.1948
Epoch: 0|  Loss:  2.9649 |Global loss: 5.832| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 1|  NKD Loss: 1.1928
Epoch: 1|  Loss:  2.955 |Global loss: 5.8279| Local H loss: 0.0187  | Global H loss: 0.0187
Epoch: 2|  NKD Loss: 1.2092
Epoch: 2|  Loss:  2.9725 |Global loss: 5.8125| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 3|  NKD Loss: 1.2137
Epoch: 3|  Loss:  2.9589 |Global loss: 5.8157| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 0|  NKD Loss: 1.1241
Epoch: 0|  Loss:  2.2291 |Global loss: 5.8149| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 1.139
Epoch: 1|  Loss:  2.2165 |Global loss: 5.8072| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 1.1304
Epoch: 2|  Loss:  2.1976 |Global loss: 5.8059| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 1.1135
Epoch: 3|  Loss:  2.1752 |Global loss: 5.8169| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.2001
Epoch: 0|  Loss:  2.4766 |Global loss: 5.8287| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1804
Epoch: 1|  Loss:  2.4321 |Global loss: 5.8397| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1652
Epoch: 2|  Loss:  2.4229 |Global loss: 5.8497| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1599
Epoch: 3|  Loss:  2.4085 |Global loss: 5.854| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.0989
Epoch: 0|  Loss:  1.9444 |Global loss: 5.757| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 1.0772
Epoch: 1|  Loss:  1.9239 |Global loss: 5.7615| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.0928
Epoch: 2|  Loss:  1.9392 |Global loss: 5.75| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 1.065
Epoch: 3|  Loss:  1.8904 |Global loss: 5.7751| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 3.0538182258605957
Chosen Clients:  [3, 10, 5, 0, 14, 6]

-------------Round number: 170-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.258, 0.133, 0.317, 0.242, 0.408, 0.192, 0.25, 0.117, 0.358, 0.425, 0.142, 0.533, 0.05, 0.35, 0.342]
AUC in each clients:  [110.16, 108.236, 110.571, 108.705, 112.588, 109.264, 108.908, 107.047, 111.201, 111.91, 109.21, 113.802, 102.372, 107.955, 111.115]
F1 Score:  [0.186, 0.092, 0.334, 0.246, 0.334, 0.171, 0.255, 0.087, 0.332, 0.342, 0.088, 0.536, 0.008, 0.341, 0.339]
Recall Score:  [0.242, 0.167, 0.417, 0.315, 0.395, 0.241, 0.324, 0.157, 0.394, 0.41, 0.16, 0.581, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4542
Averaged Test Accurancy: 0.2744
Averaged Test AUC: 0.9128
Averaged Test F1_score: 0.2461
Averaged Test Recal score: 0.3135
Std Test Accurancy: 0.1286
Std Test AUC: 0.0218
Std Test F1: 0.0011
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1285
Epoch: 0|  Loss:  2.4349 |Global loss: 5.7941| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 1.1471
Epoch: 1|  Loss:  2.4323 |Global loss: 5.7859| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 1.1486
Epoch: 2|  Loss:  2.4439 |Global loss: 5.7744| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 1.1338
Epoch: 3|  Loss:  2.4108 |Global loss: 5.7911| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 1.1865
Epoch: 0|  Loss:  2.4304 |Global loss: 5.8401| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.162
Epoch: 1|  Loss:  2.3852 |Global loss: 5.8559| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 1.1709
Epoch: 2|  Loss:  2.3906 |Global loss: 5.846| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 1.1487
Epoch: 3|  Loss:  2.3789 |Global loss: 5.871| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.1714
Epoch: 0|  Loss:  2.5653 |Global loss: 5.7974| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 1.1604
Epoch: 1|  Loss:  2.5511 |Global loss: 5.8057| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 1.1534
Epoch: 2|  Loss:  2.5342 |Global loss: 5.8075| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 1.157
Epoch: 3|  Loss:  2.5235 |Global loss: 5.8095| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 1.1434
Epoch: 0|  Loss:  2.4785 |Global loss: 5.8053| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1499
Epoch: 1|  Loss:  2.4737 |Global loss: 5.7996| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.158
Epoch: 2|  Loss:  2.4674 |Global loss: 5.7894| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.1718
Epoch: 3|  Loss:  2.4641 |Global loss: 5.7775| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 1.1726
Epoch: 0|  Loss:  2.2938 |Global loss: 5.8211| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.1576
Epoch: 1|  Loss:  2.2641 |Global loss: 5.8394| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.1583
Epoch: 2|  Loss:  2.2881 |Global loss: 5.8199| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.1658
Epoch: 3|  Loss:  2.2675 |Global loss: 5.8221| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1502
Epoch: 0|  Loss:  2.3436 |Global loss: 5.8001| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 1.133
Epoch: 1|  Loss:  2.3313 |Global loss: 5.8086| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.163
Epoch: 2|  Loss:  2.3288 |Global loss: 5.7933| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 1.1414
Epoch: 3|  Loss:  2.3209 |Global loss: 5.7979| Local H loss: 0.024  | Global H loss: 0.024
------------------------- time cost ------------------------- 3.1446311473846436
Chosen Clients:  [8, 6, 0, 11, 9, 2]

-------------Round number: 171-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.367, 0.133, 0.317, 0.308, 0.408, 0.192, 0.25, 0.117, 0.358, 0.425, 0.175, 0.533, 0.05, 0.35, 0.342]
AUC in each clients:  [111.083, 108.236, 110.571, 109.13, 112.588, 109.538, 109.32, 107.047, 111.201, 111.91, 109.472, 113.802, 102.372, 107.955, 111.067]
F1 Score:  [0.303, 0.092, 0.334, 0.32, 0.334, 0.171, 0.255, 0.087, 0.332, 0.342, 0.136, 0.536, 0.008, 0.341, 0.339]
Recall Score:  [0.358, 0.167, 0.417, 0.382, 0.395, 0.241, 0.324, 0.157, 0.394, 0.41, 0.193, 0.581, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4355
Averaged Test Accurancy: 0.2883
Averaged Test AUC: 0.9141
Averaged Test F1_score: 0.2620
Averaged Test Recal score: 0.3279
Std Test Accurancy: 0.1280
Std Test AUC: 0.0219
Std Test F1: 0.0011
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1637
Epoch: 0|  Loss:  2.2601 |Global loss: 5.8374| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.1522
Epoch: 1|  Loss:  2.2516 |Global loss: 5.8479| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.147
Epoch: 2|  Loss:  2.2391 |Global loss: 5.8508| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.1613
Epoch: 3|  Loss:  2.2414 |Global loss: 5.8363| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 1.1499
Epoch: 0|  Loss:  2.3174 |Global loss: 5.7947| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 1.1457
Epoch: 1|  Loss:  2.311 |Global loss: 5.792| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1261
Epoch: 2|  Loss:  2.2844 |Global loss: 5.8064| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 3|  NKD Loss: 1.1378
Epoch: 3|  Loss:  2.2851 |Global loss: 5.7996| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 1.1362
Epoch: 0|  Loss:  2.4196 |Global loss: 5.8038| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 1.1488
Epoch: 1|  Loss:  2.4306 |Global loss: 5.7922| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.1368
Epoch: 2|  Loss:  2.3933 |Global loss: 5.7979| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1363
Epoch: 3|  Loss:  2.3823 |Global loss: 5.7956| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 1.0845
Epoch: 0|  Loss:  1.9132 |Global loss: 5.7604| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 1.0719
Epoch: 1|  Loss:  1.8881 |Global loss: 5.7613| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.0507
Epoch: 2|  Loss:  1.8749 |Global loss: 5.7783| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 1.0534
Epoch: 3|  Loss:  1.8574 |Global loss: 5.7759| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.148
Epoch: 0|  Loss:  2.32 |Global loss: 5.8162| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 1.1531
Epoch: 1|  Loss:  2.3128 |Global loss: 5.8162| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1318
Epoch: 2|  Loss:  2.2585 |Global loss: 5.8305| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1541
Epoch: 3|  Loss:  2.287 |Global loss: 5.8219| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.1094
Epoch: 0|  Loss:  2.2355 |Global loss: 5.8152| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 1.1351
Epoch: 1|  Loss:  2.2524 |Global loss: 5.8015| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 1.1195
Epoch: 2|  Loss:  2.2377 |Global loss: 5.8104| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1239
Epoch: 3|  Loss:  2.2393 |Global loss: 5.8021| Local H loss: 0.0264  | Global H loss: 0.0264
------------------------- time cost ------------------------- 2.9750492572784424
Chosen Clients:  [9, 2, 8, 7, 11, 1]

-------------Round number: 172-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.308, 0.408, 0.192, 0.25, 0.117, 0.358, 0.392, 0.175, 0.583, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.236, 110.798, 109.13, 112.588, 109.538, 109.512, 107.047, 111.622, 112.285, 109.472, 114.541, 102.372, 107.955, 111.067]
F1 Score:  [0.322, 0.092, 0.334, 0.32, 0.334, 0.171, 0.255, 0.087, 0.332, 0.323, 0.136, 0.582, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.382, 0.395, 0.241, 0.324, 0.157, 0.394, 0.382, 0.193, 0.644, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4229
Averaged Test Accurancy: 0.2906
Averaged Test AUC: 0.9154
Averaged Test F1_score: 0.2651
Averaged Test Recal score: 0.3316
Std Test Accurancy: 0.1336
Std Test AUC: 0.0231
Std Test F1: 0.0012
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1432
Epoch: 0|  Loss:  2.2699 |Global loss: 5.8249| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.1165
Epoch: 1|  Loss:  2.2408 |Global loss: 5.8458| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.1445
Epoch: 2|  Loss:  2.249 |Global loss: 5.82| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 1.1237
Epoch: 3|  Loss:  2.2159 |Global loss: 5.8359| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 1.109
Epoch: 0|  Loss:  2.2143 |Global loss: 5.8135| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.1272
Epoch: 1|  Loss:  2.2119 |Global loss: 5.7991| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.1167
Epoch: 2|  Loss:  2.211 |Global loss: 5.8022| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.1344
Epoch: 3|  Loss:  2.2253 |Global loss: 5.7969| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.162
Epoch: 0|  Loss:  2.2266 |Global loss: 5.8348| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.1567
Epoch: 1|  Loss:  2.2062 |Global loss: 5.8408| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.142
Epoch: 2|  Loss:  2.1908 |Global loss: 5.8543| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.1217
Epoch: 3|  Loss:  2.1706 |Global loss: 5.8632| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.1977
Epoch: 0|  Loss:  2.9381 |Global loss: 5.827| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.1795
Epoch: 1|  Loss:  2.9145 |Global loss: 5.8416| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.182
Epoch: 2|  Loss:  2.9091 |Global loss: 5.8452| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 3|  NKD Loss: 1.1983
Epoch: 3|  Loss:  2.9104 |Global loss: 5.8298| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 0|  NKD Loss: 1.0632
Epoch: 0|  Loss:  1.8465 |Global loss: 5.7714| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 1.053
Epoch: 1|  Loss:  1.8393 |Global loss: 5.7742| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 1.0327
Epoch: 2|  Loss:  1.8109 |Global loss: 5.7816| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 1.0623
Epoch: 3|  Loss:  1.8147 |Global loss: 5.7708| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.1632
Epoch: 0|  Loss:  2.6086 |Global loss: 5.8006| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.1629
Epoch: 1|  Loss:  2.5996 |Global loss: 5.8051| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 1.1602
Epoch: 2|  Loss:  2.5943 |Global loss: 5.8037| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1766
Epoch: 3|  Loss:  2.5924 |Global loss: 5.7965| Local H loss: 0.0215  | Global H loss: 0.0215
------------------------- time cost ------------------------- 2.9031991958618164
Chosen Clients:  [3, 12, 10, 11, 9, 14]

-------------Round number: 173-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.308, 0.408, 0.192, 0.25, 0.117, 0.358, 0.425, 0.175, 0.583, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.413, 111.29, 109.13, 112.588, 109.538, 109.512, 107.132, 111.882, 112.812, 109.472, 114.436, 102.372, 107.955, 111.067]
F1 Score:  [0.322, 0.092, 0.334, 0.32, 0.334, 0.171, 0.255, 0.087, 0.332, 0.337, 0.136, 0.582, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.382, 0.395, 0.241, 0.324, 0.157, 0.394, 0.41, 0.193, 0.644, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.4048
Averaged Test Accurancy: 0.2928
Averaged Test AUC: 0.9162
Averaged Test F1_score: 0.2660
Averaged Test Recal score: 0.3335
Std Test Accurancy: 0.1355
Std Test AUC: 0.0233
Std Test F1: 0.0012
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 1.1181
Epoch: 0|  Loss:  2.3913 |Global loss: 5.8104| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 1.1183
Epoch: 1|  Loss:  2.3989 |Global loss: 5.7889| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.117
Epoch: 2|  Loss:  2.3797 |Global loss: 5.8068| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 1.1554
Epoch: 3|  Loss:  2.3797 |Global loss: 5.7778| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 1.1777
Epoch: 0|  Loss:  3.3464 |Global loss: 5.798| Local H loss: 0.0119  | Global H loss: 0.0119
Epoch: 1|  NKD Loss: 1.1943
Epoch: 1|  Loss:  3.3506 |Global loss: 5.7751| Local H loss: 0.012  | Global H loss: 0.012
Epoch: 2|  NKD Loss: 1.1849
Epoch: 2|  Loss:  3.3394 |Global loss: 5.7811| Local H loss: 0.0121  | Global H loss: 0.0121
Epoch: 3|  NKD Loss: 1.2183
Epoch: 3|  Loss:  3.348 |Global loss: 5.7617| Local H loss: 0.0122  | Global H loss: 0.0122
Epoch: 0|  NKD Loss: 1.1582
Epoch: 0|  Loss:  2.3709 |Global loss: 5.8596| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1511
Epoch: 1|  Loss:  2.365 |Global loss: 5.8697| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1442
Epoch: 2|  Loss:  2.3498 |Global loss: 5.8662| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 1.1427
Epoch: 3|  Loss:  2.3503 |Global loss: 5.8741| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.0613
Epoch: 0|  Loss:  1.8415 |Global loss: 5.7587| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0567
Epoch: 1|  Loss:  1.8053 |Global loss: 5.7721| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 1.0593
Epoch: 2|  Loss:  1.8117 |Global loss: 5.7678| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.0673
Epoch: 3|  Loss:  1.7922 |Global loss: 5.7572| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.1649
Epoch: 0|  Loss:  2.2337 |Global loss: 5.8136| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.118
Epoch: 1|  Loss:  2.1734 |Global loss: 5.8272| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1258
Epoch: 2|  Loss:  2.1683 |Global loss: 5.8292| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.1343
Epoch: 3|  Loss:  2.1534 |Global loss: 5.8215| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.1718
Epoch: 0|  Loss:  2.2448 |Global loss: 5.8287| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 1.1389
Epoch: 1|  Loss:  2.2328 |Global loss: 5.8242| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 1.1424
Epoch: 2|  Loss:  2.2165 |Global loss: 5.8424| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.151
Epoch: 3|  Loss:  2.2094 |Global loss: 5.8325| Local H loss: 0.0259  | Global H loss: 0.0259
------------------------- time cost ------------------------- 2.8190762996673584
Chosen Clients:  [12, 10, 5, 8, 9, 11]

-------------Round number: 174-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.408, 0.192, 0.25, 0.117, 0.358, 0.425, 0.317, 0.65, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.413, 111.29, 108.929, 112.588, 109.538, 109.512, 107.132, 111.882, 113.522, 110.054, 114.737, 103.183, 107.955, 111.283]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.334, 0.171, 0.255, 0.087, 0.332, 0.337, 0.304, 0.663, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.395, 0.241, 0.324, 0.157, 0.394, 0.41, 0.35, 0.718, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3949
Averaged Test Accurancy: 0.3072
Averaged Test AUC: 0.9176
Averaged Test F1_score: 0.2830
Averaged Test Recal score: 0.3495
Std Test Accurancy: 0.1420
Std Test AUC: 0.0229
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1823
Epoch: 0|  Loss:  3.3115 |Global loss: 5.7999| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 1|  NKD Loss: 1.1821
Epoch: 1|  Loss:  3.3204 |Global loss: 5.7871| Local H loss: 0.0123  | Global H loss: 0.0123
Epoch: 2|  NKD Loss: 1.219
Epoch: 2|  Loss:  3.3233 |Global loss: 5.7647| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 3|  NKD Loss: 1.2311
Epoch: 3|  Loss:  3.327 |Global loss: 5.758| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.1814
Epoch: 0|  Loss:  2.3685 |Global loss: 5.8502| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 1.1491
Epoch: 1|  Loss:  2.3467 |Global loss: 5.867| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1614
Epoch: 2|  Loss:  2.3342 |Global loss: 5.8637| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 1.1513
Epoch: 3|  Loss:  2.3206 |Global loss: 5.8668| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 1.1709
Epoch: 0|  Loss:  2.5154 |Global loss: 5.7953| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 1.1618
Epoch: 1|  Loss:  2.5053 |Global loss: 5.8057| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 2|  NKD Loss: 1.1563
Epoch: 2|  Loss:  2.4976 |Global loss: 5.8119| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 1.1546
Epoch: 3|  Loss:  2.4835 |Global loss: 5.8081| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 0|  NKD Loss: 1.17
Epoch: 0|  Loss:  2.2069 |Global loss: 5.8298| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.1413
Epoch: 1|  Loss:  2.1709 |Global loss: 5.8545| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.1451
Epoch: 2|  Loss:  2.1737 |Global loss: 5.8463| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.1452
Epoch: 3|  Loss:  2.1533 |Global loss: 5.8535| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 1.1549
Epoch: 0|  Loss:  2.1657 |Global loss: 5.8143| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.127
Epoch: 1|  Loss:  2.1328 |Global loss: 5.8278| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.1388
Epoch: 2|  Loss:  2.1336 |Global loss: 5.813| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.1156
Epoch: 3|  Loss:  2.0939 |Global loss: 5.8323| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0724
Epoch: 0|  Loss:  1.8246 |Global loss: 5.7465| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 1.0806
Epoch: 1|  Loss:  1.8081 |Global loss: 5.7499| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 1.0488
Epoch: 2|  Loss:  1.7771 |Global loss: 5.7658| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 1.0628
Epoch: 3|  Loss:  1.7764 |Global loss: 5.7532| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 2.937350273132324
Chosen Clients:  [14, 6, 11, 4, 1, 5]

-------------Round number: 175-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.408, 0.192, 0.25, 0.117, 0.358, 0.425, 0.333, 0.658, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.413, 111.29, 108.929, 112.588, 110.025, 109.512, 107.132, 112.164, 113.812, 110.169, 115.103, 103.695, 107.955, 111.283]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.334, 0.171, 0.255, 0.087, 0.332, 0.332, 0.31, 0.668, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.395, 0.241, 0.324, 0.157, 0.394, 0.41, 0.358, 0.727, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3768
Averaged Test Accurancy: 0.3089
Averaged Test AUC: 0.9187
Averaged Test F1_score: 0.2834
Averaged Test Recal score: 0.3506
Std Test Accurancy: 0.1435
Std Test AUC: 0.0229
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1401
Epoch: 0|  Loss:  2.1979 |Global loss: 5.8325| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.1327
Epoch: 1|  Loss:  2.1765 |Global loss: 5.8431| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 1.1388
Epoch: 2|  Loss:  2.1735 |Global loss: 5.8454| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1314
Epoch: 3|  Loss:  2.1611 |Global loss: 5.8292| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.1211
Epoch: 0|  Loss:  2.2661 |Global loss: 5.8054| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.1104
Epoch: 1|  Loss:  2.2743 |Global loss: 5.8191| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 1.1047
Epoch: 2|  Loss:  2.2325 |Global loss: 5.8173| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1376
Epoch: 3|  Loss:  2.2616 |Global loss: 5.7964| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 1.0493
Epoch: 0|  Loss:  1.7493 |Global loss: 5.7609| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0627
Epoch: 1|  Loss:  1.769 |Global loss: 5.7472| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 1.0508
Epoch: 2|  Loss:  1.7499 |Global loss: 5.7545| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 1.052
Epoch: 3|  Loss:  1.7485 |Global loss: 5.7578| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 1.1339
Epoch: 0|  Loss:  2.1817 |Global loss: 5.8062| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 1.1323
Epoch: 1|  Loss:  2.1498 |Global loss: 5.8029| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 1.1225
Epoch: 2|  Loss:  2.1532 |Global loss: 5.8081| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 1.1309
Epoch: 3|  Loss:  2.131 |Global loss: 5.7991| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.1676
Epoch: 0|  Loss:  2.5768 |Global loss: 5.8058| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 1|  NKD Loss: 1.1731
Epoch: 1|  Loss:  2.5731 |Global loss: 5.7924| Local H loss: 0.0216  | Global H loss: 0.0216
Epoch: 2|  NKD Loss: 1.1619
Epoch: 2|  Loss:  2.5619 |Global loss: 5.7999| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 3|  NKD Loss: 1.1686
Epoch: 3|  Loss:  2.5507 |Global loss: 5.8041| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 0|  NKD Loss: 1.1544
Epoch: 0|  Loss:  2.4642 |Global loss: 5.8119| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1404
Epoch: 1|  Loss:  2.4685 |Global loss: 5.8234| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1631
Epoch: 2|  Loss:  2.48 |Global loss: 5.8137| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 1.1599
Epoch: 3|  Loss:  2.4716 |Global loss: 5.8065| Local H loss: 0.0231  | Global H loss: 0.0231
------------------------- time cost ------------------------- 2.947767496109009
Chosen Clients:  [1, 7, 14, 2, 6, 5]

-------------Round number: 176-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.417, 0.192, 0.267, 0.117, 0.358, 0.425, 0.333, 0.658, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.573, 111.29, 108.929, 113.086, 109.892, 109.89, 107.132, 112.164, 113.812, 110.169, 115.15, 103.695, 107.955, 111.595]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.337, 0.171, 0.279, 0.087, 0.332, 0.332, 0.31, 0.664, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.4, 0.241, 0.338, 0.157, 0.394, 0.41, 0.358, 0.727, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3589
Averaged Test Accurancy: 0.3106
Averaged Test AUC: 0.9194
Averaged Test F1_score: 0.2849
Averaged Test Recal score: 0.3519
Std Test Accurancy: 0.1435
Std Test AUC: 0.0231
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1298
Epoch: 0|  Loss:  2.5181 |Global loss: 5.8343| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 1.1595
Epoch: 1|  Loss:  2.5168 |Global loss: 5.8127| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 1.1547
Epoch: 2|  Loss:  2.5199 |Global loss: 5.8181| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 1.1595
Epoch: 3|  Loss:  2.5153 |Global loss: 5.805| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 1.1907
Epoch: 0|  Loss:  2.8883 |Global loss: 5.8395| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 1|  NKD Loss: 1.1903
Epoch: 1|  Loss:  2.8892 |Global loss: 5.8367| Local H loss: 0.0194  | Global H loss: 0.0194
Epoch: 2|  NKD Loss: 1.2041
Epoch: 2|  Loss:  2.8837 |Global loss: 5.8302| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 3|  NKD Loss: 1.2006
Epoch: 3|  Loss:  2.8676 |Global loss: 5.832| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 0|  NKD Loss: 1.1562
Epoch: 0|  Loss:  2.1574 |Global loss: 5.8216| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.1479
Epoch: 1|  Loss:  2.149 |Global loss: 5.8216| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 1.1414
Epoch: 2|  Loss:  2.1361 |Global loss: 5.8352| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.1177
Epoch: 3|  Loss:  2.1049 |Global loss: 5.8488| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.1102
Epoch: 0|  Loss:  2.1904 |Global loss: 5.8067| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 1.1207
Epoch: 1|  Loss:  2.1832 |Global loss: 5.7983| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.1099
Epoch: 2|  Loss:  2.1698 |Global loss: 5.8137| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.1266
Epoch: 3|  Loss:  2.1837 |Global loss: 5.7974| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 1.1348
Epoch: 0|  Loss:  2.2409 |Global loss: 5.7973| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.1267
Epoch: 1|  Loss:  2.2348 |Global loss: 5.7983| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 1.1149
Epoch: 2|  Loss:  2.2299 |Global loss: 5.8109| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 1.1194
Epoch: 3|  Loss:  2.2247 |Global loss: 5.8067| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 1.1513
Epoch: 0|  Loss:  2.4473 |Global loss: 5.8128| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 1.1514
Epoch: 1|  Loss:  2.4502 |Global loss: 5.8105| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 1.1571
Epoch: 2|  Loss:  2.4353 |Global loss: 5.8155| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1526
Epoch: 3|  Loss:  2.4309 |Global loss: 5.8107| Local H loss: 0.0233  | Global H loss: 0.0233
------------------------- time cost ------------------------- 3.0664029121398926
Chosen Clients:  [4, 5, 14, 10, 7, 1]

-------------Round number: 177-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.417, 0.192, 0.367, 0.117, 0.358, 0.425, 0.333, 0.658, 0.05, 0.35, 0.342]
AUC in each clients:  [111.579, 108.956, 111.264, 108.929, 113.086, 110.142, 110.248, 107.208, 112.164, 113.812, 110.169, 115.15, 103.695, 107.955, 111.573]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.337, 0.171, 0.368, 0.087, 0.332, 0.332, 0.31, 0.664, 0.008, 0.341, 0.339]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.4, 0.241, 0.421, 0.157, 0.394, 0.41, 0.358, 0.727, 0.083, 0.41, 0.407]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3470
Averaged Test Accurancy: 0.3172
Averaged Test AUC: 0.9200
Averaged Test F1_score: 0.2909
Averaged Test Recal score: 0.3574
Std Test Accurancy: 0.1436
Std Test AUC: 0.0229
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1198
Epoch: 0|  Loss:  2.1126 |Global loss: 5.8115| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.12
Epoch: 1|  Loss:  2.0995 |Global loss: 5.8062| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 1.1071
Epoch: 2|  Loss:  2.0666 |Global loss: 5.8142| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 1.1149
Epoch: 3|  Loss:  2.0892 |Global loss: 5.8144| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 1.1181
Epoch: 0|  Loss:  2.389 |Global loss: 5.8363| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.1279
Epoch: 1|  Loss:  2.3943 |Global loss: 5.8308| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 2|  NKD Loss: 1.1516
Epoch: 2|  Loss:  2.4035 |Global loss: 5.8114| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1515
Epoch: 3|  Loss:  2.3878 |Global loss: 5.8116| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 1.1548
Epoch: 0|  Loss:  2.128 |Global loss: 5.8173| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.1454
Epoch: 1|  Loss:  2.1077 |Global loss: 5.821| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.1416
Epoch: 2|  Loss:  2.1019 |Global loss: 5.8258| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.1218
Epoch: 3|  Loss:  2.0663 |Global loss: 5.8372| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.1735
Epoch: 0|  Loss:  2.3289 |Global loss: 5.8479| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 1.1687
Epoch: 1|  Loss:  2.3145 |Global loss: 5.8524| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 1.1361
Epoch: 2|  Loss:  2.2901 |Global loss: 5.8783| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.1304
Epoch: 3|  Loss:  2.2786 |Global loss: 5.8869| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.2006
Epoch: 0|  Loss:  2.8624 |Global loss: 5.835| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 1|  NKD Loss: 1.1946
Epoch: 1|  Loss:  2.862 |Global loss: 5.8416| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 2|  NKD Loss: 1.2073
Epoch: 2|  Loss:  2.8546 |Global loss: 5.8258| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.1988
Epoch: 3|  Loss:  2.8421 |Global loss: 5.8345| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 0|  NKD Loss: 1.1574
Epoch: 0|  Loss:  2.5071 |Global loss: 5.813| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 1.1399
Epoch: 1|  Loss:  2.4801 |Global loss: 5.8283| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 1.1587
Epoch: 2|  Loss:  2.477 |Global loss: 5.8109| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1404
Epoch: 3|  Loss:  2.4701 |Global loss: 5.824| Local H loss: 0.0224  | Global H loss: 0.0224
------------------------- time cost ------------------------- 2.840289831161499
Chosen Clients:  [12, 9, 8, 10, 7, 1]

-------------Round number: 178-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.467, 0.192, 0.367, 0.117, 0.358, 0.425, 0.342, 0.658, 0.05, 0.35, 0.35]
AUC in each clients:  [111.579, 109.257, 111.264, 108.929, 112.904, 110.224, 110.248, 107.455, 112.164, 113.812, 110.412, 115.15, 103.695, 107.955, 111.936]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.418, 0.171, 0.368, 0.087, 0.332, 0.332, 0.316, 0.664, 0.008, 0.341, 0.356]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.478, 0.241, 0.421, 0.157, 0.394, 0.41, 0.369, 0.727, 0.083, 0.41, 0.417]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3326
Averaged Test Accurancy: 0.3217
Averaged Test AUC: 0.9205
Averaged Test F1_score: 0.2978
Averaged Test Recal score: 0.3640
Std Test Accurancy: 0.1466
Std Test AUC: 0.0227
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1832
Epoch: 0|  Loss:  3.2745 |Global loss: 5.8086| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 1|  NKD Loss: 1.1783
Epoch: 1|  Loss:  3.2752 |Global loss: 5.7998| Local H loss: 0.0125  | Global H loss: 0.0125
Epoch: 2|  NKD Loss: 1.2099
Epoch: 2|  Loss:  3.2847 |Global loss: 5.7803| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 3|  NKD Loss: 1.2047
Epoch: 3|  Loss:  3.2823 |Global loss: 5.7783| Local H loss: 0.0127  | Global H loss: 0.0127
Epoch: 0|  NKD Loss: 1.1235
Epoch: 0|  Loss:  2.0796 |Global loss: 5.8276| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.102
Epoch: 1|  Loss:  2.069 |Global loss: 5.8319| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.1156
Epoch: 2|  Loss:  2.061 |Global loss: 5.83| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 1.1143
Epoch: 3|  Loss:  2.0496 |Global loss: 5.834| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 1.138
Epoch: 0|  Loss:  2.1496 |Global loss: 5.8472| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.1459
Epoch: 1|  Loss:  2.1314 |Global loss: 5.8567| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 1.1227
Epoch: 2|  Loss:  2.1113 |Global loss: 5.8626| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 1.147
Epoch: 3|  Loss:  2.1216 |Global loss: 5.8479| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 1.1517
Epoch: 0|  Loss:  2.2805 |Global loss: 5.8711| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.1497
Epoch: 1|  Loss:  2.2712 |Global loss: 5.8694| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 1.1392
Epoch: 2|  Loss:  2.2512 |Global loss: 5.8717| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 1.1406
Epoch: 3|  Loss:  2.2582 |Global loss: 5.8738| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.1748
Epoch: 0|  Loss:  2.8255 |Global loss: 5.8529| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.192
Epoch: 1|  Loss:  2.8134 |Global loss: 5.8488| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 2|  NKD Loss: 1.1979
Epoch: 2|  Loss:  2.8206 |Global loss: 5.8352| Local H loss: 0.0204  | Global H loss: 0.0204
Epoch: 3|  NKD Loss: 1.1998
Epoch: 3|  Loss:  2.7997 |Global loss: 5.8313| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 0|  NKD Loss: 1.1309
Epoch: 0|  Loss:  2.4435 |Global loss: 5.8331| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 1.1546
Epoch: 1|  Loss:  2.4499 |Global loss: 5.8209| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 1.1445
Epoch: 2|  Loss:  2.4402 |Global loss: 5.8197| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 1.1536
Epoch: 3|  Loss:  2.4371 |Global loss: 5.8121| Local H loss: 0.0228  | Global H loss: 0.0228
------------------------- time cost ------------------------- 2.784221649169922
Chosen Clients:  [7, 8, 11, 5, 10, 12]

-------------Round number: 179-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.467, 0.192, 0.367, 0.117, 0.358, 0.425, 0.358, 0.658, 0.05, 0.35, 0.35]
AUC in each clients:  [111.579, 109.583, 111.264, 108.929, 112.904, 110.224, 110.248, 107.591, 112.474, 114.053, 110.527, 115.15, 104.015, 107.955, 111.936]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.418, 0.171, 0.368, 0.087, 0.332, 0.337, 0.328, 0.664, 0.008, 0.341, 0.356]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.478, 0.241, 0.421, 0.157, 0.394, 0.41, 0.386, 0.727, 0.083, 0.41, 0.417]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3228
Averaged Test Accurancy: 0.3228
Averaged Test AUC: 0.9214
Averaged Test F1_score: 0.2989
Averaged Test Recal score: 0.3651
Std Test Accurancy: 0.1468
Std Test AUC: 0.0224
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.1998
Epoch: 0|  Loss:  2.7948 |Global loss: 5.8513| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 1|  NKD Loss: 1.1759
Epoch: 1|  Loss:  2.7839 |Global loss: 5.8427| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.1994
Epoch: 2|  Loss:  2.7851 |Global loss: 5.838| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.181
Epoch: 3|  Loss:  2.7643 |Global loss: 5.848| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 0|  NKD Loss: 1.1537
Epoch: 0|  Loss:  2.1221 |Global loss: 5.8392| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 1.1308
Epoch: 1|  Loss:  2.1016 |Global loss: 5.8492| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.1358
Epoch: 2|  Loss:  2.0937 |Global loss: 5.8522| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 1.129
Epoch: 3|  Loss:  2.0778 |Global loss: 5.8437| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 1.0538
Epoch: 0|  Loss:  1.743 |Global loss: 5.7646| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.067
Epoch: 1|  Loss:  1.7469 |Global loss: 5.7494| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 1.0478
Epoch: 2|  Loss:  1.7258 |Global loss: 5.757| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0558
Epoch: 3|  Loss:  1.7342 |Global loss: 5.7474| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 1.1371
Epoch: 0|  Loss:  2.3711 |Global loss: 5.8273| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 1.1296
Epoch: 1|  Loss:  2.3699 |Global loss: 5.8298| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1443
Epoch: 2|  Loss:  2.3823 |Global loss: 5.8212| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1329
Epoch: 3|  Loss:  2.3676 |Global loss: 5.8191| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 0|  NKD Loss: 1.1464
Epoch: 0|  Loss:  2.2412 |Global loss: 5.8736| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 1.1451
Epoch: 1|  Loss:  2.2472 |Global loss: 5.8723| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1552
Epoch: 2|  Loss:  2.243 |Global loss: 5.8656| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.1405
Epoch: 3|  Loss:  2.2302 |Global loss: 5.877| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.1833
Epoch: 0|  Loss:  3.2436 |Global loss: 5.8112| Local H loss: 0.0128  | Global H loss: 0.0128
Epoch: 1|  NKD Loss: 1.1897
Epoch: 1|  Loss:  3.2437 |Global loss: 5.8006| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 2|  NKD Loss: 1.1926
Epoch: 2|  Loss:  3.2377 |Global loss: 5.8004| Local H loss: 0.013  | Global H loss: 0.013
Epoch: 3|  NKD Loss: 1.2338
Epoch: 3|  Loss:  3.2565 |Global loss: 5.7667| Local H loss: 0.0132  | Global H loss: 0.0132
------------------------- time cost ------------------------- 3.463815927505493
Chosen Clients:  [4, 1, 10, 11, 9, 8]

-------------Round number: 180-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.133, 0.317, 0.317, 0.467, 0.192, 0.367, 0.117, 0.458, 0.425, 0.342, 0.658, 0.05, 0.35, 0.35]
AUC in each clients:  [111.579, 109.583, 111.264, 108.929, 112.904, 110.142, 110.248, 107.717, 113.156, 114.053, 110.739, 115.121, 104.473, 107.955, 111.936]
F1 Score:  [0.322, 0.092, 0.334, 0.326, 0.418, 0.171, 0.368, 0.087, 0.437, 0.337, 0.316, 0.664, 0.008, 0.341, 0.356]
Recall Score:  [0.378, 0.167, 0.417, 0.391, 0.478, 0.241, 0.421, 0.157, 0.475, 0.41, 0.369, 0.727, 0.083, 0.41, 0.417]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.3097
Averaged Test Accurancy: 0.3283
Averaged Test AUC: 0.9221
Averaged Test F1_score: 0.3051
Averaged Test Recal score: 0.3694
Std Test Accurancy: 0.1504
Std Test AUC: 0.0220
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.1118
Epoch: 0|  Loss:  2.0829 |Global loss: 5.8068| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 1.0881
Epoch: 1|  Loss:  2.0432 |Global loss: 5.8253| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 1.097
Epoch: 2|  Loss:  2.0301 |Global loss: 5.8226| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 1.103
Epoch: 3|  Loss:  2.0186 |Global loss: 5.8158| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.1593
Epoch: 0|  Loss:  2.4346 |Global loss: 5.8103| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.1525
Epoch: 1|  Loss:  2.4248 |Global loss: 5.818| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 1.1446
Epoch: 2|  Loss:  2.3888 |Global loss: 5.8174| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 1.1576
Epoch: 3|  Loss:  2.402 |Global loss: 5.8102| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 0|  NKD Loss: 1.1502
Epoch: 0|  Loss:  2.229 |Global loss: 5.8685| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.1627
Epoch: 1|  Loss:  2.2378 |Global loss: 5.8581| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 1.1352
Epoch: 2|  Loss:  2.211 |Global loss: 5.8818| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.119
Epoch: 3|  Loss:  2.1831 |Global loss: 5.891| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 1.0462
Epoch: 0|  Loss:  1.7114 |Global loss: 5.7567| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0356
Epoch: 1|  Loss:  1.6782 |Global loss: 5.7686| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.0275
Epoch: 2|  Loss:  1.6898 |Global loss: 5.7621| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 1.0356
Epoch: 3|  Loss:  1.6952 |Global loss: 5.7652| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.1292
Epoch: 0|  Loss:  2.0638 |Global loss: 5.8133| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 1.119
Epoch: 1|  Loss:  2.0268 |Global loss: 5.8285| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 1.1177
Epoch: 2|  Loss:  2.0001 |Global loss: 5.828| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 1.1122
Epoch: 3|  Loss:  2.0016 |Global loss: 5.8274| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 1.1346
Epoch: 0|  Loss:  2.0732 |Global loss: 5.8546| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 1.1438
Epoch: 1|  Loss:  2.0876 |Global loss: 5.843| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 1.1212
Epoch: 2|  Loss:  2.046 |Global loss: 5.867| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.1315
Epoch: 3|  Loss:  2.0605 |Global loss: 5.8488| Local H loss: 0.0297  | Global H loss: 0.0297
------------------------- time cost ------------------------- 2.795016050338745
Chosen Clients:  [4, 6, 13, 11, 2, 0]

-------------Round number: 181-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.383, 0.208, 0.317, 0.317, 0.475, 0.192, 0.367, 0.117, 0.542, 0.492, 0.358, 0.658, 0.05, 0.35, 0.35]
AUC in each clients:  [111.579, 109.864, 111.264, 108.929, 113.66, 110.142, 110.248, 107.717, 113.329, 114.27, 110.952, 115.144, 104.473, 107.955, 111.936]
F1 Score:  [0.322, 0.198, 0.334, 0.326, 0.421, 0.171, 0.368, 0.087, 0.5, 0.416, 0.328, 0.664, 0.008, 0.341, 0.356]
Recall Score:  [0.378, 0.247, 0.417, 0.391, 0.484, 0.241, 0.421, 0.157, 0.555, 0.484, 0.386, 0.727, 0.083, 0.41, 0.417]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2792
Averaged Test Accurancy: 0.3450
Averaged Test AUC: 0.9230
Averaged Test F1_score: 0.3227
Averaged Test Recal score: 0.3865
Std Test Accurancy: 0.1550
Std Test AUC: 0.0226
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.0928
Epoch: 0|  Loss:  2.002 |Global loss: 5.8196| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 1.0731
Epoch: 1|  Loss:  1.9802 |Global loss: 5.8301| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.092
Epoch: 2|  Loss:  1.9874 |Global loss: 5.8195| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.074
Epoch: 3|  Loss:  1.9523 |Global loss: 5.8305| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.1048
Epoch: 0|  Loss:  2.1941 |Global loss: 5.8153| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 1.1023
Epoch: 1|  Loss:  2.2008 |Global loss: 5.8106| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 1.1141
Epoch: 2|  Loss:  2.1912 |Global loss: 5.8068| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.0998
Epoch: 3|  Loss:  2.1882 |Global loss: 5.8148| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.1314
Epoch: 0|  Loss:  2.5157 |Global loss: 5.8474| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1435
Epoch: 1|  Loss:  2.5195 |Global loss: 5.8382| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.1348
Epoch: 2|  Loss:  2.4867 |Global loss: 5.8472| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1505
Epoch: 3|  Loss:  2.5333 |Global loss: 5.8263| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.0212
Epoch: 0|  Loss:  1.6631 |Global loss: 5.7707| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 1.0137
Epoch: 1|  Loss:  1.659 |Global loss: 5.7771| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 1.0277
Epoch: 2|  Loss:  1.6663 |Global loss: 5.7578| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 1.031
Epoch: 3|  Loss:  1.6471 |Global loss: 5.7667| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.1094
Epoch: 0|  Loss:  2.1734 |Global loss: 5.8003| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 1.0826
Epoch: 1|  Loss:  2.1339 |Global loss: 5.8265| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0732
Epoch: 2|  Loss:  2.1115 |Global loss: 5.8282| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 1.1058
Epoch: 3|  Loss:  2.1465 |Global loss: 5.8164| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 1.1152
Epoch: 0|  Loss:  2.3462 |Global loss: 5.8175| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.1093
Epoch: 1|  Loss:  2.3398 |Global loss: 5.8243| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1377
Epoch: 2|  Loss:  2.3321 |Global loss: 5.7984| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 1.1441
Epoch: 3|  Loss:  2.3345 |Global loss: 5.7883| Local H loss: 0.0254  | Global H loss: 0.0254
------------------------- time cost ------------------------- 2.972700595855713
Chosen Clients:  [7, 2, 14, 4, 8, 12]

-------------Round number: 182-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.4, 0.208, 0.317, 0.317, 0.492, 0.192, 0.367, 0.117, 0.542, 0.492, 0.358, 0.658, 0.05, 0.35, 0.35]
AUC in each clients:  [111.842, 109.864, 111.665, 108.929, 114.039, 110.142, 110.839, 107.717, 113.329, 114.27, 110.952, 115.153, 104.473, 107.976, 111.936]
F1 Score:  [0.336, 0.198, 0.334, 0.326, 0.441, 0.171, 0.374, 0.087, 0.5, 0.416, 0.328, 0.664, 0.008, 0.341, 0.356]
Recall Score:  [0.399, 0.247, 0.417, 0.391, 0.495, 0.241, 0.421, 0.157, 0.555, 0.484, 0.386, 0.727, 0.083, 0.41, 0.417]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2707
Averaged Test Accurancy: 0.3472
Averaged Test AUC: 0.9240
Averaged Test F1_score: 0.3253
Averaged Test Recal score: 0.3887
Std Test Accurancy: 0.1563
Std Test AUC: 0.0229
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.1789
Epoch: 0|  Loss:  2.7413 |Global loss: 5.8536| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 1|  NKD Loss: 1.2013
Epoch: 1|  Loss:  2.755 |Global loss: 5.8422| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 1.1851
Epoch: 2|  Loss:  2.7512 |Global loss: 5.8474| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 3|  NKD Loss: 1.1738
Epoch: 3|  Loss:  2.7212 |Global loss: 5.8525| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.0963
Epoch: 0|  Loss:  2.1124 |Global loss: 5.8158| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.0802
Epoch: 1|  Loss:  2.1025 |Global loss: 5.8255| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.1113
Epoch: 2|  Loss:  2.1066 |Global loss: 5.8009| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.0915
Epoch: 3|  Loss:  2.1127 |Global loss: 5.813| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 1.1309
Epoch: 0|  Loss:  2.0737 |Global loss: 5.831| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.1102
Epoch: 1|  Loss:  2.0488 |Global loss: 5.8405| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.1246
Epoch: 2|  Loss:  2.0515 |Global loss: 5.8364| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.1162
Epoch: 3|  Loss:  2.0272 |Global loss: 5.8342| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 1.0694
Epoch: 0|  Loss:  1.9499 |Global loss: 5.8248| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 1.0857
Epoch: 1|  Loss:  1.9404 |Global loss: 5.8193| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 1.0839
Epoch: 2|  Loss:  1.9387 |Global loss: 5.8265| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 1.0955
Epoch: 3|  Loss:  1.9353 |Global loss: 5.8143| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.1536
Epoch: 0|  Loss:  2.0673 |Global loss: 5.8369| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 1.1177
Epoch: 1|  Loss:  2.017 |Global loss: 5.8593| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 1.0923
Epoch: 2|  Loss:  1.9955 |Global loss: 5.8794| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 1.1095
Epoch: 3|  Loss:  1.995 |Global loss: 5.8668| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.1732
Epoch: 0|  Loss:  3.2089 |Global loss: 5.8243| Local H loss: 0.0131  | Global H loss: 0.0131
Epoch: 1|  NKD Loss: 1.1934
Epoch: 1|  Loss:  3.2109 |Global loss: 5.8134| Local H loss: 0.0132  | Global H loss: 0.0132
Epoch: 2|  NKD Loss: 1.2209
Epoch: 2|  Loss:  3.2157 |Global loss: 5.79| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 3|  NKD Loss: 1.2071
Epoch: 3|  Loss:  3.2253 |Global loss: 5.7865| Local H loss: 0.0134  | Global H loss: 0.0134
------------------------- time cost ------------------------- 3.0318357944488525
Chosen Clients:  [9, 2, 13, 10, 14, 0]

-------------Round number: 183-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.4, 0.208, 0.317, 0.317, 0.508, 0.192, 0.367, 0.117, 0.508, 0.492, 0.358, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [111.842, 109.864, 111.733, 108.929, 114.229, 110.142, 110.839, 107.911, 113.26, 114.27, 110.952, 115.153, 104.613, 107.976, 112.337]
F1 Score:  [0.336, 0.198, 0.334, 0.326, 0.457, 0.171, 0.374, 0.087, 0.475, 0.416, 0.328, 0.664, 0.008, 0.341, 0.482]
Recall Score:  [0.399, 0.247, 0.417, 0.391, 0.506, 0.241, 0.421, 0.157, 0.523, 0.484, 0.386, 0.727, 0.083, 0.41, 0.521]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2606
Averaged Test Accurancy: 0.3533
Averaged Test AUC: 0.9245
Averaged Test F1_score: 0.3331
Averaged Test Recal score: 0.3942
Std Test Accurancy: 0.1574
Std Test AUC: 0.0228
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.0972
Epoch: 0|  Loss:  1.9774 |Global loss: 5.8324| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 1.0894
Epoch: 1|  Loss:  1.964 |Global loss: 5.8319| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 1.1088
Epoch: 2|  Loss:  1.9623 |Global loss: 5.8276| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 1.1162
Epoch: 3|  Loss:  1.9715 |Global loss: 5.8171| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.1008
Epoch: 0|  Loss:  2.0978 |Global loss: 5.806| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.1138
Epoch: 1|  Loss:  2.1173 |Global loss: 5.7965| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.0876
Epoch: 2|  Loss:  2.0872 |Global loss: 5.8182| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.1049
Epoch: 3|  Loss:  2.1001 |Global loss: 5.804| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.1591
Epoch: 0|  Loss:  2.5234 |Global loss: 5.8303| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 1.1474
Epoch: 1|  Loss:  2.4922 |Global loss: 5.8326| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.1341
Epoch: 2|  Loss:  2.4829 |Global loss: 5.8299| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 1.153
Epoch: 3|  Loss:  2.4707 |Global loss: 5.8271| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 1.1618
Epoch: 0|  Loss:  2.216 |Global loss: 5.8574| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.1532
Epoch: 1|  Loss:  2.1901 |Global loss: 5.8592| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1515
Epoch: 2|  Loss:  2.1963 |Global loss: 5.8629| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 1.137
Epoch: 3|  Loss:  2.1568 |Global loss: 5.8722| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.1279
Epoch: 0|  Loss:  2.0393 |Global loss: 5.8255| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 1.1263
Epoch: 1|  Loss:  2.0116 |Global loss: 5.8333| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.1155
Epoch: 2|  Loss:  1.9926 |Global loss: 5.8428| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 1.1037
Epoch: 3|  Loss:  1.9934 |Global loss: 5.8392| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.1258
Epoch: 0|  Loss:  2.3022 |Global loss: 5.808| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.1323
Epoch: 1|  Loss:  2.3125 |Global loss: 5.7956| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 1.1029
Epoch: 2|  Loss:  2.2676 |Global loss: 5.8173| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 1.1228
Epoch: 3|  Loss:  2.2854 |Global loss: 5.8018| Local H loss: 0.0259  | Global H loss: 0.0259
------------------------- time cost ------------------------- 3.0266506671905518
Chosen Clients:  [12, 2, 0, 3, 6, 7]

-------------Round number: 184-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.425, 0.208, 0.342, 0.317, 0.508, 0.192, 0.367, 0.117, 0.508, 0.492, 0.392, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [112.27, 109.864, 111.975, 108.929, 114.229, 110.142, 110.839, 107.911, 113.26, 114.519, 111.153, 115.153, 104.613, 108.114, 112.473]
F1 Score:  [0.378, 0.198, 0.376, 0.326, 0.457, 0.171, 0.374, 0.087, 0.475, 0.412, 0.384, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.427, 0.247, 0.444, 0.391, 0.506, 0.241, 0.421, 0.157, 0.523, 0.484, 0.428, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2389
Averaged Test Accurancy: 0.3589
Averaged Test AUC: 0.9252
Averaged Test F1_score: 0.3434
Averaged Test Recal score: 0.4024
Std Test Accurancy: 0.1580
Std Test AUC: 0.0231
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.1542
Epoch: 0|  Loss:  3.1707 |Global loss: 5.8447| Local H loss: 0.0134  | Global H loss: 0.0134
Epoch: 1|  NKD Loss: 1.1895
Epoch: 1|  Loss:  3.1825 |Global loss: 5.8113| Local H loss: 0.0136  | Global H loss: 0.0136
Epoch: 2|  NKD Loss: 1.2133
Epoch: 2|  Loss:  3.184 |Global loss: 5.8024| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 3|  NKD Loss: 1.2062
Epoch: 3|  Loss:  3.1938 |Global loss: 5.796| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 0|  NKD Loss: 1.0893
Epoch: 0|  Loss:  2.076 |Global loss: 5.8217| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.0937
Epoch: 1|  Loss:  2.0797 |Global loss: 5.8125| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.0988
Epoch: 2|  Loss:  2.0856 |Global loss: 5.81| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0868
Epoch: 3|  Loss:  2.08 |Global loss: 5.8202| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 1.122
Epoch: 0|  Loss:  2.2649 |Global loss: 5.8093| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.1196
Epoch: 1|  Loss:  2.2599 |Global loss: 5.8062| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.1256
Epoch: 2|  Loss:  2.2749 |Global loss: 5.7962| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.1368
Epoch: 3|  Loss:  2.2512 |Global loss: 5.7951| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.1129
Epoch: 0|  Loss:  2.3744 |Global loss: 5.805| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.0997
Epoch: 1|  Loss:  2.3514 |Global loss: 5.8131| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 1.1249
Epoch: 2|  Loss:  2.3522 |Global loss: 5.7979| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.1336
Epoch: 3|  Loss:  2.3415 |Global loss: 5.7895| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 1.095
Epoch: 0|  Loss:  2.1585 |Global loss: 5.818| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.0918
Epoch: 1|  Loss:  2.163 |Global loss: 5.8246| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 1.09
Epoch: 2|  Loss:  2.1567 |Global loss: 5.821| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 1.1121
Epoch: 3|  Loss:  2.1637 |Global loss: 5.7955| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 1.1325
Epoch: 0|  Loss:  2.6844 |Global loss: 5.8912| Local H loss: 0.0211  | Global H loss: 0.0211
Epoch: 1|  NKD Loss: 1.177
Epoch: 1|  Loss:  2.7076 |Global loss: 5.8564| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 2|  NKD Loss: 1.2036
Epoch: 2|  Loss:  2.7059 |Global loss: 5.8419| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 1.1749
Epoch: 3|  Loss:  2.6849 |Global loss: 5.8523| Local H loss: 0.0218  | Global H loss: 0.0218
------------------------- time cost ------------------------- 3.1079938411712646
Chosen Clients:  [10, 4, 9, 6, 13, 5]

-------------Round number: 185-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.208, 0.383, 0.333, 0.508, 0.192, 0.4, 0.117, 0.508, 0.492, 0.392, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [112.315, 109.864, 111.958, 109.526, 114.229, 110.142, 110.818, 107.983, 113.26, 114.519, 111.153, 115.153, 104.819, 108.114, 112.473]
F1 Score:  [0.421, 0.198, 0.413, 0.339, 0.457, 0.171, 0.39, 0.087, 0.475, 0.412, 0.384, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.484, 0.247, 0.491, 0.407, 0.506, 0.241, 0.449, 0.157, 0.523, 0.484, 0.428, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2444
Averaged Test Accurancy: 0.3683
Averaged Test AUC: 0.9257
Averaged Test F1_score: 0.3507
Averaged Test Recal score: 0.4123
Std Test Accurancy: 0.1598
Std Test AUC: 0.0225
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.1356
Epoch: 0|  Loss:  2.171 |Global loss: 5.8755| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.147
Epoch: 1|  Loss:  2.1816 |Global loss: 5.8678| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.1423
Epoch: 2|  Loss:  2.1679 |Global loss: 5.8704| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.138
Epoch: 3|  Loss:  2.142 |Global loss: 5.8678| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.098
Epoch: 0|  Loss:  1.9183 |Global loss: 5.8055| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 1.084
Epoch: 1|  Loss:  1.9122 |Global loss: 5.8149| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 1.0962
Epoch: 2|  Loss:  1.9068 |Global loss: 5.811| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0746
Epoch: 3|  Loss:  1.8838 |Global loss: 5.8209| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 1.1217
Epoch: 0|  Loss:  1.9544 |Global loss: 5.8095| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0984
Epoch: 1|  Loss:  1.9219 |Global loss: 5.8256| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 1.0862
Epoch: 2|  Loss:  1.9027 |Global loss: 5.8374| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0647
Epoch: 3|  Loss:  1.8756 |Global loss: 5.8457| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.1282
Epoch: 0|  Loss:  2.1806 |Global loss: 5.7905| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 1.1198
Epoch: 1|  Loss:  2.1366 |Global loss: 5.8007| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 1.1057
Epoch: 2|  Loss:  2.145 |Global loss: 5.8012| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.0956
Epoch: 3|  Loss:  2.1082 |Global loss: 5.8168| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1223
Epoch: 0|  Loss:  2.4693 |Global loss: 5.8447| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.1576
Epoch: 1|  Loss:  2.4625 |Global loss: 5.8217| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.1526
Epoch: 2|  Loss:  2.4782 |Global loss: 5.8184| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 1.1492
Epoch: 3|  Loss:  2.4583 |Global loss: 5.8285| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 1.1475
Epoch: 0|  Loss:  2.3674 |Global loss: 5.8134| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.134
Epoch: 1|  Loss:  2.3472 |Global loss: 5.8218| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1415
Epoch: 2|  Loss:  2.3466 |Global loss: 5.8195| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1571
Epoch: 3|  Loss:  2.3602 |Global loss: 5.8097| Local H loss: 0.0237  | Global H loss: 0.0237
------------------------- time cost ------------------------- 2.954324722290039
Chosen Clients:  [5, 2, 12, 11, 4, 1]

-------------Round number: 186-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.208, 0.383, 0.333, 0.525, 0.192, 0.425, 0.117, 0.508, 0.583, 0.392, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [112.315, 109.864, 111.958, 109.526, 114.814, 110.094, 111.007, 107.983, 113.26, 114.666, 111.616, 115.153, 104.819, 108.426, 112.473]
F1 Score:  [0.421, 0.198, 0.413, 0.339, 0.465, 0.171, 0.408, 0.087, 0.475, 0.517, 0.384, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.484, 0.247, 0.491, 0.407, 0.517, 0.241, 0.47, 0.157, 0.523, 0.578, 0.428, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2273
Averaged Test Accurancy: 0.3772
Averaged Test AUC: 0.9267
Averaged Test F1_score: 0.3594
Averaged Test Recal score: 0.4207
Std Test Accurancy: 0.1673
Std Test AUC: 0.0229
Std Test F1: 0.0014
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 1.1389
Epoch: 0|  Loss:  2.3438 |Global loss: 5.8211| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1196
Epoch: 1|  Loss:  2.3106 |Global loss: 5.8308| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.133
Epoch: 2|  Loss:  2.3255 |Global loss: 5.8279| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1206
Epoch: 3|  Loss:  2.2999 |Global loss: 5.8273| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 1.0806
Epoch: 0|  Loss:  2.0496 |Global loss: 5.8236| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0563
Epoch: 1|  Loss:  2.0278 |Global loss: 5.8428| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 1.0978
Epoch: 2|  Loss:  2.0576 |Global loss: 5.8087| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.0881
Epoch: 3|  Loss:  2.0455 |Global loss: 5.8096| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.1757
Epoch: 0|  Loss:  3.1415 |Global loss: 5.8449| Local H loss: 0.0137  | Global H loss: 0.0137
Epoch: 1|  NKD Loss: 1.1913
Epoch: 1|  Loss:  3.1606 |Global loss: 5.818| Local H loss: 0.0138  | Global H loss: 0.0138
Epoch: 2|  NKD Loss: 1.1919
Epoch: 2|  Loss:  3.1555 |Global loss: 5.8166| Local H loss: 0.0139  | Global H loss: 0.0139
Epoch: 3|  NKD Loss: 1.2007
Epoch: 3|  Loss:  3.1526 |Global loss: 5.8091| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 0|  NKD Loss: 1.0311
Epoch: 0|  Loss:  1.6545 |Global loss: 5.7563| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0137
Epoch: 1|  Loss:  1.631 |Global loss: 5.7666| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.0291
Epoch: 2|  Loss:  1.6344 |Global loss: 5.7639| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 1.0254
Epoch: 3|  Loss:  1.6175 |Global loss: 5.7625| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 1.095
Epoch: 0|  Loss:  1.8967 |Global loss: 5.805| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0696
Epoch: 1|  Loss:  1.869 |Global loss: 5.8251| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0671
Epoch: 2|  Loss:  1.8674 |Global loss: 5.8169| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.0677
Epoch: 3|  Loss:  1.8501 |Global loss: 5.8131| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 1.1312
Epoch: 0|  Loss:  2.3845 |Global loss: 5.8321| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 1.1411
Epoch: 1|  Loss:  2.3919 |Global loss: 5.8232| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 2|  NKD Loss: 1.1415
Epoch: 2|  Loss:  2.3651 |Global loss: 5.8228| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 1.1264
Epoch: 3|  Loss:  2.3483 |Global loss: 5.8298| Local H loss: 0.0233  | Global H loss: 0.0233
------------------------- time cost ------------------------- 2.8295416831970215
Chosen Clients:  [4, 9, 0, 7, 3, 6]

-------------Round number: 187-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.375, 0.333, 0.55, 0.192, 0.425, 0.117, 0.508, 0.583, 0.392, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [112.315, 110.218, 112.514, 109.526, 114.815, 110.501, 111.007, 107.983, 113.26, 114.666, 111.616, 115.208, 104.998, 108.426, 112.473]
F1 Score:  [0.421, 0.238, 0.408, 0.339, 0.504, 0.171, 0.408, 0.087, 0.475, 0.517, 0.384, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.484, 0.295, 0.481, 0.407, 0.544, 0.241, 0.47, 0.157, 0.523, 0.578, 0.428, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.2150
Averaged Test Accurancy: 0.3817
Averaged Test AUC: 0.9275
Averaged Test F1_score: 0.3643
Averaged Test Recal score: 0.4250
Std Test Accurancy: 0.1659
Std Test AUC: 0.0226
Std Test F1: 0.0014
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 1.066
Epoch: 0|  Loss:  1.8412 |Global loss: 5.8153| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 1.0729
Epoch: 1|  Loss:  1.8475 |Global loss: 5.8124| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 1.0735
Epoch: 2|  Loss:  1.8462 |Global loss: 5.8119| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 1.0625
Epoch: 3|  Loss:  1.8125 |Global loss: 5.8101| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 1.0922
Epoch: 0|  Loss:  1.8895 |Global loss: 5.8236| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 1.0957
Epoch: 1|  Loss:  1.8804 |Global loss: 5.8258| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 1.0955
Epoch: 2|  Loss:  1.8678 |Global loss: 5.8164| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 1.0855
Epoch: 3|  Loss:  1.8365 |Global loss: 5.8246| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.1121
Epoch: 0|  Loss:  2.2336 |Global loss: 5.8111| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 1.1169
Epoch: 1|  Loss:  2.2156 |Global loss: 5.7985| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.1123
Epoch: 2|  Loss:  2.2158 |Global loss: 5.8053| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 1.1326
Epoch: 3|  Loss:  2.2119 |Global loss: 5.7924| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 1.1824
Epoch: 0|  Loss:  2.6891 |Global loss: 5.8525| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 1.1838
Epoch: 1|  Loss:  2.6614 |Global loss: 5.8614| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 2|  NKD Loss: 1.1909
Epoch: 2|  Loss:  2.6662 |Global loss: 5.8384| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 1.1861
Epoch: 3|  Loss:  2.6573 |Global loss: 5.8506| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 0|  NKD Loss: 1.1094
Epoch: 0|  Loss:  2.3269 |Global loss: 5.8044| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 1.1149
Epoch: 1|  Loss:  2.3267 |Global loss: 5.8129| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 1.1066
Epoch: 2|  Loss:  2.3235 |Global loss: 5.7951| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.1295
Epoch: 3|  Loss:  2.3126 |Global loss: 5.7918| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 1.1161
Epoch: 0|  Loss:  2.1336 |Global loss: 5.7973| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.0788
Epoch: 1|  Loss:  2.1103 |Global loss: 5.8163| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.0988
Epoch: 2|  Loss:  2.1014 |Global loss: 5.8056| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.09
Epoch: 3|  Loss:  2.0928 |Global loss: 5.807| Local H loss: 0.0255  | Global H loss: 0.0255
------------------------- time cost ------------------------- 3.0299744606018066
Chosen Clients:  [0, 7, 4, 5, 10, 11]

-------------Round number: 188-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.375, 0.392, 0.625, 0.192, 0.433, 0.117, 0.508, 0.692, 0.392, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [112.679, 110.218, 112.514, 110.005, 115.219, 110.501, 111.206, 108.256, 113.26, 114.961, 111.616, 115.208, 104.998, 108.426, 112.473]
F1 Score:  [0.421, 0.238, 0.408, 0.402, 0.598, 0.171, 0.407, 0.087, 0.475, 0.586, 0.384, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.484, 0.295, 0.481, 0.456, 0.634, 0.241, 0.477, 0.157, 0.523, 0.65, 0.428, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1942
Averaged Test Accurancy: 0.3983
Averaged Test AUC: 0.9286
Averaged Test F1_score: 0.3793
Averaged Test Recal score: 0.4395
Std Test Accurancy: 0.1814
Std Test AUC: 0.0229
Std Test F1: 0.0015
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.1029
Epoch: 0|  Loss:  2.1768 |Global loss: 5.8069| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.1035
Epoch: 1|  Loss:  2.1697 |Global loss: 5.8051| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.097
Epoch: 2|  Loss:  2.1496 |Global loss: 5.8063| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.1053
Epoch: 3|  Loss:  2.1563 |Global loss: 5.8041| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.1637
Epoch: 0|  Loss:  2.6359 |Global loss: 5.8623| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 1.1869
Epoch: 1|  Loss:  2.6415 |Global loss: 5.8546| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 1.1627
Epoch: 2|  Loss:  2.6203 |Global loss: 5.8579| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 1.1814
Epoch: 3|  Loss:  2.609 |Global loss: 5.8538| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 1.0757
Epoch: 0|  Loss:  1.8299 |Global loss: 5.8047| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.0759
Epoch: 1|  Loss:  1.8121 |Global loss: 5.7995| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 1.0678
Epoch: 2|  Loss:  1.8043 |Global loss: 5.7974| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.0541
Epoch: 3|  Loss:  1.7722 |Global loss: 5.8198| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.1315
Epoch: 0|  Loss:  2.3125 |Global loss: 5.8292| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.124
Epoch: 1|  Loss:  2.298 |Global loss: 5.831| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 1.125
Epoch: 2|  Loss:  2.279 |Global loss: 5.8325| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.1339
Epoch: 3|  Loss:  2.3128 |Global loss: 5.826| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 1.1351
Epoch: 0|  Loss:  2.1315 |Global loss: 5.8662| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.1167
Epoch: 1|  Loss:  2.131 |Global loss: 5.8901| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.1252
Epoch: 2|  Loss:  2.1147 |Global loss: 5.8791| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.1222
Epoch: 3|  Loss:  2.1087 |Global loss: 5.8821| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.0266
Epoch: 0|  Loss:  1.6273 |Global loss: 5.7589| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.0149
Epoch: 1|  Loss:  1.6225 |Global loss: 5.7638| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 1.0273
Epoch: 2|  Loss:  1.6139 |Global loss: 5.7596| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9909
Epoch: 3|  Loss:  1.5899 |Global loss: 5.7837| Local H loss: 0.0318  | Global H loss: 0.0318
------------------------- time cost ------------------------- 3.139873504638672
Chosen Clients:  [14, 5, 3, 6, 11, 10]

-------------Round number: 189-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.375, 0.392, 0.608, 0.192, 0.433, 0.117, 0.508, 0.692, 0.417, 0.658, 0.05, 0.35, 0.458]
AUC in each clients:  [113.119, 110.218, 112.514, 110.005, 115.011, 110.361, 111.206, 108.367, 113.26, 114.961, 112.034, 115.342, 104.998, 108.426, 112.473]
F1 Score:  [0.421, 0.238, 0.408, 0.402, 0.561, 0.171, 0.407, 0.087, 0.475, 0.586, 0.421, 0.664, 0.008, 0.341, 0.5]
Recall Score:  [0.484, 0.295, 0.481, 0.456, 0.612, 0.241, 0.477, 0.157, 0.523, 0.65, 0.456, 0.727, 0.083, 0.41, 0.547]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1775
Averaged Test Accurancy: 0.3989
Averaged Test AUC: 0.9291
Averaged Test F1_score: 0.3793
Averaged Test Recal score: 0.4399
Std Test Accurancy: 0.1801
Std Test AUC: 0.0230
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 1.1155
Epoch: 0|  Loss:  1.9857 |Global loss: 5.8358| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.1126
Epoch: 1|  Loss:  1.962 |Global loss: 5.8391| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.1046
Epoch: 2|  Loss:  1.9528 |Global loss: 5.8379| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0954
Epoch: 3|  Loss:  1.9521 |Global loss: 5.8472| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.1144
Epoch: 0|  Loss:  2.2734 |Global loss: 5.8347| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 1.1091
Epoch: 1|  Loss:  2.2609 |Global loss: 5.8381| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1191
Epoch: 2|  Loss:  2.2632 |Global loss: 5.836| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.1264
Epoch: 3|  Loss:  2.2712 |Global loss: 5.8303| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.0884
Epoch: 0|  Loss:  2.2895 |Global loss: 5.8213| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.1085
Epoch: 1|  Loss:  2.2889 |Global loss: 5.8108| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.122
Epoch: 2|  Loss:  2.3048 |Global loss: 5.793| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.1237
Epoch: 3|  Loss:  2.2753 |Global loss: 5.7897| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.0966
Epoch: 0|  Loss:  2.0998 |Global loss: 5.8069| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.0961
Epoch: 1|  Loss:  2.0982 |Global loss: 5.8026| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 1.0895
Epoch: 2|  Loss:  2.09 |Global loss: 5.8074| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 1.0976
Epoch: 3|  Loss:  2.1015 |Global loss: 5.8055| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.0218
Epoch: 0|  Loss:  1.6079 |Global loss: 5.7559| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.0158
Epoch: 1|  Loss:  1.5891 |Global loss: 5.7655| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 1.0052
Epoch: 2|  Loss:  1.5908 |Global loss: 5.7696| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 1.0122
Epoch: 3|  Loss:  1.5737 |Global loss: 5.7684| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.1514
Epoch: 0|  Loss:  2.1248 |Global loss: 5.8596| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.1199
Epoch: 1|  Loss:  2.0979 |Global loss: 5.8786| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0985
Epoch: 2|  Loss:  2.0838 |Global loss: 5.8966| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0993
Epoch: 3|  Loss:  2.0708 |Global loss: 5.9004| Local H loss: 0.028  | Global H loss: 0.028
------------------------- time cost ------------------------- 3.04854416847229
Chosen Clients:  [14, 5, 8, 3, 6, 2]

-------------Round number: 190-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.375, 0.425, 0.608, 0.192, 0.433, 0.117, 0.508, 0.692, 0.383, 0.658, 0.05, 0.35, 0.667]
AUC in each clients:  [113.119, 110.218, 112.514, 110.677, 115.011, 110.78, 111.382, 108.367, 113.26, 114.961, 112.34, 115.325, 104.998, 108.426, 113.162]
F1 Score:  [0.421, 0.238, 0.408, 0.416, 0.561, 0.171, 0.412, 0.087, 0.475, 0.586, 0.374, 0.664, 0.008, 0.341, 0.663]
Recall Score:  [0.484, 0.295, 0.481, 0.484, 0.612, 0.241, 0.477, 0.157, 0.523, 0.65, 0.417, 0.727, 0.083, 0.41, 0.708]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1598
Averaged Test Accurancy: 0.4128
Averaged Test AUC: 0.9303
Averaged Test F1_score: 0.3883
Averaged Test Recal score: 0.4499
Std Test Accurancy: 0.1919
Std Test AUC: 0.0229
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.0984
Epoch: 0|  Loss:  1.9451 |Global loss: 5.8341| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.098
Epoch: 1|  Loss:  1.9291 |Global loss: 5.8439| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.084
Epoch: 2|  Loss:  1.9089 |Global loss: 5.8462| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.1
Epoch: 3|  Loss:  1.9032 |Global loss: 5.8355| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 1.1226
Epoch: 0|  Loss:  2.2474 |Global loss: 5.8326| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 1.1222
Epoch: 1|  Loss:  2.2425 |Global loss: 5.8256| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1198
Epoch: 2|  Loss:  2.2389 |Global loss: 5.8321| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.0992
Epoch: 3|  Loss:  2.2338 |Global loss: 5.8413| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 1.1241
Epoch: 0|  Loss:  2.0178 |Global loss: 5.85| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.1327
Epoch: 1|  Loss:  2.0028 |Global loss: 5.8438| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 1.1091
Epoch: 2|  Loss:  1.9719 |Global loss: 5.8633| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 1.1128
Epoch: 3|  Loss:  1.9792 |Global loss: 5.8618| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 1.0972
Epoch: 0|  Loss:  2.2597 |Global loss: 5.8173| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.0936
Epoch: 1|  Loss:  2.2383 |Global loss: 5.8132| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.0968
Epoch: 2|  Loss:  2.2385 |Global loss: 5.8118| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 1.124
Epoch: 3|  Loss:  2.2632 |Global loss: 5.7935| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.0953
Epoch: 0|  Loss:  2.0742 |Global loss: 5.8003| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.0729
Epoch: 1|  Loss:  2.0613 |Global loss: 5.8212| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 1.0855
Epoch: 2|  Loss:  2.0552 |Global loss: 5.8092| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 1.0901
Epoch: 3|  Loss:  2.0654 |Global loss: 5.8025| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.09
Epoch: 0|  Loss:  2.0423 |Global loss: 5.8094| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0785
Epoch: 1|  Loss:  2.0267 |Global loss: 5.8218| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.1002
Epoch: 2|  Loss:  2.0395 |Global loss: 5.8087| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 1.0955
Epoch: 3|  Loss:  2.0319 |Global loss: 5.8059| Local H loss: 0.0285  | Global H loss: 0.0285
------------------------- time cost ------------------------- 3.1076393127441406
Chosen Clients:  [4, 3, 13, 12, 7, 5]

-------------Round number: 191-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.425, 0.425, 0.608, 0.242, 0.433, 0.117, 0.667, 0.692, 0.383, 0.658, 0.05, 0.35, 0.65]
AUC in each clients:  [113.119, 110.218, 112.486, 110.527, 115.011, 111.658, 111.606, 108.367, 114.01, 114.961, 112.34, 115.325, 104.998, 108.426, 113.647]
F1 Score:  [0.421, 0.238, 0.458, 0.416, 0.561, 0.219, 0.407, 0.087, 0.582, 0.586, 0.374, 0.664, 0.008, 0.341, 0.654]
Recall Score:  [0.484, 0.295, 0.516, 0.484, 0.612, 0.274, 0.477, 0.157, 0.638, 0.65, 0.417, 0.727, 0.083, 0.41, 0.696]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1472
Averaged Test Accurancy: 0.4289
Averaged Test AUC: 0.9315
Averaged Test F1_score: 0.4011
Averaged Test Recal score: 0.4613
Std Test Accurancy: 0.1958
Std Test AUC: 0.0233
Std Test F1: 0.0016
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.058
Epoch: 0|  Loss:  1.7665 |Global loss: 5.7982| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0439
Epoch: 1|  Loss:  1.7693 |Global loss: 5.8154| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 1.0602
Epoch: 2|  Loss:  1.7776 |Global loss: 5.8066| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 1.0499
Epoch: 3|  Loss:  1.7708 |Global loss: 5.8149| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.0864
Epoch: 0|  Loss:  2.2336 |Global loss: 5.8188| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 1.1043
Epoch: 1|  Loss:  2.2393 |Global loss: 5.8047| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.1093
Epoch: 2|  Loss:  2.2256 |Global loss: 5.8027| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.1088
Epoch: 3|  Loss:  2.234 |Global loss: 5.7953| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.1102
Epoch: 0|  Loss:  2.4325 |Global loss: 5.8494| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 1.1365
Epoch: 1|  Loss:  2.4317 |Global loss: 5.8366| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 1.1293
Epoch: 2|  Loss:  2.4292 |Global loss: 5.8356| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 1.1304
Epoch: 3|  Loss:  2.4141 |Global loss: 5.841| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1889
Epoch: 0|  Loss:  3.1181 |Global loss: 5.8366| Local H loss: 0.014  | Global H loss: 0.014
Epoch: 1|  NKD Loss: 1.1862
Epoch: 1|  Loss:  3.1269 |Global loss: 5.8268| Local H loss: 0.0141  | Global H loss: 0.0141
Epoch: 2|  NKD Loss: 1.1993
Epoch: 2|  Loss:  3.1174 |Global loss: 5.8287| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 3|  NKD Loss: 1.2101
Epoch: 3|  Loss:  3.1244 |Global loss: 5.8104| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 0|  NKD Loss: 1.1608
Epoch: 0|  Loss:  2.5888 |Global loss: 5.8676| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.1737
Epoch: 1|  Loss:  2.602 |Global loss: 5.8586| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 1.1823
Epoch: 2|  Loss:  2.5762 |Global loss: 5.8513| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 1.1715
Epoch: 3|  Loss:  2.5673 |Global loss: 5.857| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 0|  NKD Loss: 1.1247
Epoch: 0|  Loss:  2.2275 |Global loss: 5.8366| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1156
Epoch: 1|  Loss:  2.2208 |Global loss: 5.8309| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.1166
Epoch: 2|  Loss:  2.2237 |Global loss: 5.8308| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.1113
Epoch: 3|  Loss:  2.2109 |Global loss: 5.8359| Local H loss: 0.0238  | Global H loss: 0.0238
------------------------- time cost ------------------------- 2.986889600753784
Chosen Clients:  [3, 5, 11, 2, 0, 4]

-------------Round number: 192-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.425, 0.392, 0.783, 0.258, 0.433, 0.117, 0.667, 0.692, 0.383, 0.658, 0.05, 0.35, 0.65]
AUC in each clients:  [113.119, 110.218, 112.486, 110.448, 115.773, 111.892, 111.606, 108.726, 114.01, 114.961, 112.34, 115.325, 104.878, 108.78, 113.647]
F1 Score:  [0.421, 0.238, 0.458, 0.397, 0.728, 0.23, 0.407, 0.087, 0.582, 0.586, 0.374, 0.664, 0.008, 0.341, 0.654]
Recall Score:  [0.484, 0.295, 0.516, 0.456, 0.77, 0.285, 0.477, 0.157, 0.638, 0.65, 0.417, 0.727, 0.083, 0.41, 0.696]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1523
Averaged Test Accurancy: 0.4394
Averaged Test AUC: 0.9323
Averaged Test F1_score: 0.4117
Averaged Test Recal score: 0.4707
Std Test Accurancy: 0.2101
Std Test AUC: 0.0235
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1219
Epoch: 0|  Loss:  2.2313 |Global loss: 5.8036| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.1108
Epoch: 1|  Loss:  2.2143 |Global loss: 5.7957| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.112
Epoch: 2|  Loss:  2.1935 |Global loss: 5.7948| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 1.1081
Epoch: 3|  Loss:  2.2038 |Global loss: 5.7877| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.1385
Epoch: 0|  Loss:  2.2179 |Global loss: 5.8191| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1277
Epoch: 1|  Loss:  2.1931 |Global loss: 5.8197| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1222
Epoch: 2|  Loss:  2.1955 |Global loss: 5.8263| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 1.1135
Epoch: 3|  Loss:  2.1898 |Global loss: 5.8287| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 1.0401
Epoch: 0|  Loss:  1.5912 |Global loss: 5.7382| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0228
Epoch: 1|  Loss:  1.5855 |Global loss: 5.7503| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 1.0051
Epoch: 2|  Loss:  1.5558 |Global loss: 5.7642| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0175
Epoch: 3|  Loss:  1.5557 |Global loss: 5.7577| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 1.0935
Epoch: 0|  Loss:  2.0154 |Global loss: 5.804| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.0776
Epoch: 1|  Loss:  2.0025 |Global loss: 5.819| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0942
Epoch: 2|  Loss:  2.0306 |Global loss: 5.8151| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 1.1064
Epoch: 3|  Loss:  2.032 |Global loss: 5.796| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 1.0984
Epoch: 0|  Loss:  2.1566 |Global loss: 5.8122| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.0816
Epoch: 1|  Loss:  2.1319 |Global loss: 5.8146| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0782
Epoch: 2|  Loss:  2.1105 |Global loss: 5.8219| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0826
Epoch: 3|  Loss:  2.117 |Global loss: 5.8182| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 1.0651
Epoch: 0|  Loss:  1.7678 |Global loss: 5.7962| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0708
Epoch: 1|  Loss:  1.7673 |Global loss: 5.7942| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0466
Epoch: 2|  Loss:  1.7445 |Global loss: 5.8069| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 1.0327
Epoch: 3|  Loss:  1.7339 |Global loss: 5.8221| Local H loss: 0.0328  | Global H loss: 0.0328
------------------------- time cost ------------------------- 2.8631694316864014
Chosen Clients:  [4, 1, 5, 14, 12, 2]

-------------Round number: 193-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.258, 0.4, 0.425, 0.775, 0.325, 0.433, 0.117, 0.667, 0.692, 0.383, 0.758, 0.05, 0.35, 0.65]
AUC in each clients:  [113.236, 110.218, 112.614, 111.255, 115.922, 112.058, 111.606, 108.726, 114.01, 114.961, 112.34, 115.727, 104.878, 108.78, 113.647]
F1 Score:  [0.421, 0.238, 0.437, 0.416, 0.716, 0.318, 0.407, 0.087, 0.582, 0.586, 0.374, 0.744, 0.008, 0.341, 0.654]
Recall Score:  [0.484, 0.295, 0.505, 0.484, 0.762, 0.374, 0.477, 0.157, 0.638, 0.65, 0.417, 0.794, 0.083, 0.41, 0.696]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1347
Averaged Test Accurancy: 0.4506
Averaged Test AUC: 0.9333
Averaged Test F1_score: 0.4219
Averaged Test Recal score: 0.4817
Std Test Accurancy: 0.2142
Std Test AUC: 0.0238
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0596
Epoch: 0|  Loss:  1.7366 |Global loss: 5.7897| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.03
Epoch: 1|  Loss:  1.709 |Global loss: 5.8079| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 1.0492
Epoch: 2|  Loss:  1.7352 |Global loss: 5.8025| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 1.0205
Epoch: 3|  Loss:  1.6853 |Global loss: 5.8178| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.1276
Epoch: 0|  Loss:  2.3278 |Global loss: 5.8317| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 1.1375
Epoch: 1|  Loss:  2.3387 |Global loss: 5.826| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.147
Epoch: 2|  Loss:  2.3389 |Global loss: 5.8219| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1293
Epoch: 3|  Loss:  2.3081 |Global loss: 5.8288| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.114
Epoch: 0|  Loss:  2.1983 |Global loss: 5.8347| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1069
Epoch: 1|  Loss:  2.1734 |Global loss: 5.8269| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1108
Epoch: 2|  Loss:  2.1834 |Global loss: 5.8308| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.1235
Epoch: 3|  Loss:  2.1768 |Global loss: 5.8195| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.0915
Epoch: 0|  Loss:  1.8891 |Global loss: 5.8439| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.1033
Epoch: 1|  Loss:  1.8933 |Global loss: 5.8332| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 1.0994
Epoch: 2|  Loss:  1.8868 |Global loss: 5.8367| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.0985
Epoch: 3|  Loss:  1.8836 |Global loss: 5.8348| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 1.1784
Epoch: 0|  Loss:  3.0898 |Global loss: 5.84| Local H loss: 0.0143  | Global H loss: 0.0143
Epoch: 1|  NKD Loss: 1.1826
Epoch: 1|  Loss:  3.0836 |Global loss: 5.8423| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 2|  NKD Loss: 1.2034
Epoch: 2|  Loss:  3.0997 |Global loss: 5.8211| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 3|  NKD Loss: 1.2095
Epoch: 3|  Loss:  3.0983 |Global loss: 5.8223| Local H loss: 0.0147  | Global H loss: 0.0147
Epoch: 0|  NKD Loss: 1.0973
Epoch: 0|  Loss:  1.9983 |Global loss: 5.7975| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 1.0812
Epoch: 1|  Loss:  1.991 |Global loss: 5.8207| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 1.0938
Epoch: 2|  Loss:  2.0135 |Global loss: 5.7995| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.0682
Epoch: 3|  Loss:  1.9714 |Global loss: 5.8238| Local H loss: 0.0287  | Global H loss: 0.0287
------------------------- time cost ------------------------- 2.993485927581787
Chosen Clients:  [13, 10, 5, 12, 9, 8]

-------------Round number: 194-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.267, 0.475, 0.425, 0.825, 0.275, 0.433, 0.117, 0.667, 0.692, 0.383, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.236, 110.377, 112.891, 111.255, 116.195, 112.008, 111.606, 108.726, 114.01, 114.961, 112.34, 115.727, 104.889, 108.78, 113.794]
F1 Score:  [0.421, 0.243, 0.495, 0.416, 0.757, 0.267, 0.407, 0.087, 0.582, 0.586, 0.374, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.484, 0.306, 0.567, 0.484, 0.805, 0.309, 0.477, 0.157, 0.638, 0.65, 0.417, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1304
Averaged Test Accurancy: 0.4583
Averaged Test AUC: 0.9338
Averaged Test F1_score: 0.4267
Averaged Test Recal score: 0.4869
Std Test Accurancy: 0.2231
Std Test AUC: 0.0240
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1268
Epoch: 0|  Loss:  2.419 |Global loss: 5.8349| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.1438
Epoch: 1|  Loss:  2.3957 |Global loss: 5.8343| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 1.1227
Epoch: 2|  Loss:  2.3915 |Global loss: 5.8341| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 1.1505
Epoch: 3|  Loss:  2.3924 |Global loss: 5.8266| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.1262
Epoch: 0|  Loss:  2.0879 |Global loss: 5.8741| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.133
Epoch: 1|  Loss:  2.0852 |Global loss: 5.8686| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.1219
Epoch: 2|  Loss:  2.0601 |Global loss: 5.8746| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.1259
Epoch: 3|  Loss:  2.0601 |Global loss: 5.8702| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 1.1009
Epoch: 0|  Loss:  2.1605 |Global loss: 5.8321| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1337
Epoch: 1|  Loss:  2.168 |Global loss: 5.8129| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 1.1102
Epoch: 2|  Loss:  2.1636 |Global loss: 5.8324| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.1147
Epoch: 3|  Loss:  2.1688 |Global loss: 5.8242| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 1.1687
Epoch: 0|  Loss:  3.0665 |Global loss: 5.8523| Local H loss: 0.0145  | Global H loss: 0.0145
Epoch: 1|  NKD Loss: 1.1874
Epoch: 1|  Loss:  3.0726 |Global loss: 5.8355| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 2|  NKD Loss: 1.2227
Epoch: 2|  Loss:  3.0757 |Global loss: 5.8195| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 3|  NKD Loss: 1.2231
Epoch: 3|  Loss:  3.0723 |Global loss: 5.8075| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 0|  NKD Loss: 1.0932
Epoch: 0|  Loss:  1.8479 |Global loss: 5.8132| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 1.0701
Epoch: 1|  Loss:  1.8099 |Global loss: 5.8375| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.0656
Epoch: 2|  Loss:  1.8075 |Global loss: 5.8297| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 1.0681
Epoch: 3|  Loss:  1.7906 |Global loss: 5.8301| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 1.1368
Epoch: 0|  Loss:  2.0032 |Global loss: 5.8415| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 1.1119
Epoch: 1|  Loss:  1.9624 |Global loss: 5.8634| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.1086
Epoch: 2|  Loss:  1.9548 |Global loss: 5.8472| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 1.104
Epoch: 3|  Loss:  1.9519 |Global loss: 5.8629| Local H loss: 0.0315  | Global H loss: 0.0315
------------------------- time cost ------------------------- 2.970292329788208
Chosen Clients:  [12, 7, 8, 3, 0, 9]

-------------Round number: 195-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.475, 0.267, 0.475, 0.425, 0.825, 0.35, 0.433, 0.117, 0.675, 0.7, 0.492, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.236, 110.377, 112.891, 111.255, 116.195, 112.199, 111.606, 108.726, 114.313, 115.08, 112.689, 115.727, 104.942, 108.941, 113.794]
F1 Score:  [0.421, 0.243, 0.495, 0.416, 0.757, 0.352, 0.407, 0.087, 0.586, 0.603, 0.515, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.484, 0.306, 0.567, 0.484, 0.805, 0.395, 0.477, 0.157, 0.644, 0.66, 0.548, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1099
Averaged Test Accurancy: 0.4717
Averaged Test AUC: 0.9344
Averaged Test F1_score: 0.4431
Averaged Test Recal score: 0.5024
Std Test Accurancy: 0.2198
Std Test AUC: 0.0241
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1724
Epoch: 0|  Loss:  3.0387 |Global loss: 5.8553| Local H loss: 0.0148  | Global H loss: 0.0148
Epoch: 1|  NKD Loss: 1.1693
Epoch: 1|  Loss:  3.0429 |Global loss: 5.8472| Local H loss: 0.015  | Global H loss: 0.015
Epoch: 2|  NKD Loss: 1.1931
Epoch: 2|  Loss:  3.0297 |Global loss: 5.8457| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 3|  NKD Loss: 1.2011
Epoch: 3|  Loss:  3.0293 |Global loss: 5.8268| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 0|  NKD Loss: 1.1718
Epoch: 0|  Loss:  2.5659 |Global loss: 5.8519| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 1|  NKD Loss: 1.1604
Epoch: 1|  Loss:  2.5262 |Global loss: 5.869| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 1.1626
Epoch: 2|  Loss:  2.5413 |Global loss: 5.8527| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.1871
Epoch: 3|  Loss:  2.5346 |Global loss: 5.8489| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 1.1174
Epoch: 0|  Loss:  1.949 |Global loss: 5.8563| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 1.1177
Epoch: 1|  Loss:  1.9519 |Global loss: 5.8565| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.1062
Epoch: 2|  Loss:  1.925 |Global loss: 5.8514| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.0837
Epoch: 3|  Loss:  1.9109 |Global loss: 5.8587| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.0952
Epoch: 0|  Loss:  2.1724 |Global loss: 5.8067| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 1.1019
Epoch: 1|  Loss:  2.1659 |Global loss: 5.8033| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.1082
Epoch: 2|  Loss:  2.1635 |Global loss: 5.7956| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.1159
Epoch: 3|  Loss:  2.1778 |Global loss: 5.7856| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 1.0895
Epoch: 0|  Loss:  2.108 |Global loss: 5.8109| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.0666
Epoch: 1|  Loss:  2.0499 |Global loss: 5.8209| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 1.1039
Epoch: 2|  Loss:  2.1107 |Global loss: 5.7966| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.0922
Epoch: 3|  Loss:  2.0883 |Global loss: 5.8082| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.0845
Epoch: 0|  Loss:  1.8067 |Global loss: 5.8177| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 1.0875
Epoch: 1|  Loss:  1.7947 |Global loss: 5.8186| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 1.0626
Epoch: 2|  Loss:  1.7586 |Global loss: 5.8278| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0592
Epoch: 3|  Loss:  1.7484 |Global loss: 5.8329| Local H loss: 0.032  | Global H loss: 0.032
------------------------- time cost ------------------------- 2.9041059017181396
Chosen Clients:  [5, 6, 10, 8, 13, 7]

-------------Round number: 196-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.5, 0.267, 0.475, 0.425, 0.825, 0.35, 0.433, 0.117, 0.675, 0.767, 0.492, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.414, 110.377, 112.891, 111.436, 116.195, 112.199, 111.606, 108.792, 114.477, 115.218, 112.689, 115.727, 104.933, 108.941, 113.794]
F1 Score:  [0.468, 0.243, 0.495, 0.416, 0.757, 0.352, 0.407, 0.087, 0.586, 0.674, 0.515, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.52, 0.306, 0.567, 0.484, 0.805, 0.395, 0.477, 0.157, 0.644, 0.734, 0.548, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.1090
Averaged Test Accurancy: 0.4778
Averaged Test AUC: 0.9348
Averaged Test F1_score: 0.4510
Averaged Test Recal score: 0.5097
Std Test Accurancy: 0.2251
Std Test AUC: 0.0242
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1064
Epoch: 0|  Loss:  2.1363 |Global loss: 5.8287| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 1|  NKD Loss: 1.1189
Epoch: 1|  Loss:  2.1539 |Global loss: 5.818| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1243
Epoch: 2|  Loss:  2.1378 |Global loss: 5.8146| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.1166
Epoch: 3|  Loss:  2.1395 |Global loss: 5.8179| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.0935
Epoch: 0|  Loss:  2.0501 |Global loss: 5.7999| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.0834
Epoch: 1|  Loss:  2.0475 |Global loss: 5.8119| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.0863
Epoch: 2|  Loss:  2.0341 |Global loss: 5.8059| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.0985
Epoch: 3|  Loss:  2.0531 |Global loss: 5.7969| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 1.1367
Epoch: 0|  Loss:  2.0662 |Global loss: 5.8636| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.129
Epoch: 1|  Loss:  2.0575 |Global loss: 5.8699| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.1053
Epoch: 2|  Loss:  2.0215 |Global loss: 5.8829| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 1.1113
Epoch: 3|  Loss:  2.0303 |Global loss: 5.8814| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.1263
Epoch: 0|  Loss:  1.9218 |Global loss: 5.8466| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.1132
Epoch: 1|  Loss:  1.9228 |Global loss: 5.8483| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 1.1028
Epoch: 2|  Loss:  1.9016 |Global loss: 5.8583| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 1.09
Epoch: 3|  Loss:  1.8863 |Global loss: 5.8662| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.1448
Epoch: 0|  Loss:  2.3868 |Global loss: 5.8186| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.0981
Epoch: 1|  Loss:  2.3624 |Global loss: 5.8493| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 1.1408
Epoch: 2|  Loss:  2.3652 |Global loss: 5.8347| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.1261
Epoch: 3|  Loss:  2.3723 |Global loss: 5.8271| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.1687
Epoch: 0|  Loss:  2.5181 |Global loss: 5.8607| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 1.1701
Epoch: 1|  Loss:  2.5183 |Global loss: 5.8533| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.1641
Epoch: 2|  Loss:  2.4981 |Global loss: 5.8573| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 1.1733
Epoch: 3|  Loss:  2.485 |Global loss: 5.8508| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 2.733590602874756
Chosen Clients:  [0, 13, 9, 2, 4, 3]

-------------Round number: 197-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.5, 0.267, 0.475, 0.425, 0.825, 0.392, 0.433, 0.117, 0.675, 0.767, 0.6, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.414, 110.377, 112.891, 111.436, 116.195, 112.562, 111.51, 109.233, 114.398, 115.218, 113.095, 115.727, 104.933, 109.273, 113.794]
F1 Score:  [0.468, 0.243, 0.495, 0.416, 0.757, 0.383, 0.407, 0.087, 0.581, 0.674, 0.629, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.52, 0.306, 0.567, 0.484, 0.805, 0.427, 0.477, 0.157, 0.644, 0.734, 0.668, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0834
Averaged Test Accurancy: 0.4878
Averaged Test AUC: 0.9356
Averaged Test F1_score: 0.4603
Averaged Test Recal score: 0.5199
Std Test Accurancy: 0.2257
Std Test AUC: 0.0238
Std Test F1: 0.0018
Std Test Recall: 0.0018
Epoch: 0|  NKD Loss: 1.0953
Epoch: 0|  Loss:  2.0867 |Global loss: 5.7998| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 1.0764
Epoch: 1|  Loss:  2.0673 |Global loss: 5.8128| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 1.1025
Epoch: 2|  Loss:  2.0546 |Global loss: 5.7934| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0911
Epoch: 3|  Loss:  2.0718 |Global loss: 5.8018| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.1161
Epoch: 0|  Loss:  2.3331 |Global loss: 5.8498| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.1218
Epoch: 1|  Loss:  2.3336 |Global loss: 5.8405| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.1344
Epoch: 2|  Loss:  2.3555 |Global loss: 5.8261| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.1281
Epoch: 3|  Loss:  2.3128 |Global loss: 5.8389| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 1.0646
Epoch: 0|  Loss:  1.7623 |Global loss: 5.8276| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.083
Epoch: 1|  Loss:  1.7581 |Global loss: 5.8073| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 1.0492
Epoch: 2|  Loss:  1.7077 |Global loss: 5.8322| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 1.0352
Epoch: 3|  Loss:  1.7045 |Global loss: 5.8389| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 1.0588
Epoch: 0|  Loss:  1.9615 |Global loss: 5.8266| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.0752
Epoch: 1|  Loss:  1.9708 |Global loss: 5.8253| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 1.077
Epoch: 2|  Loss:  1.961 |Global loss: 5.8169| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.0734
Epoch: 3|  Loss:  1.9563 |Global loss: 5.813| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.0575
Epoch: 0|  Loss:  1.7268 |Global loss: 5.7874| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.048
Epoch: 1|  Loss:  1.7126 |Global loss: 5.7903| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 1.0415
Epoch: 2|  Loss:  1.6974 |Global loss: 5.793| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 1.0284
Epoch: 3|  Loss:  1.677 |Global loss: 5.8104| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.101
Epoch: 0|  Loss:  2.1553 |Global loss: 5.8084| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 1.088
Epoch: 1|  Loss:  2.1427 |Global loss: 5.8108| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 1.0902
Epoch: 2|  Loss:  2.1244 |Global loss: 5.7942| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0781
Epoch: 3|  Loss:  2.1064 |Global loss: 5.8131| Local H loss: 0.0299  | Global H loss: 0.0299
------------------------- time cost ------------------------- 3.2549898624420166
Chosen Clients:  [6, 1, 2, 4, 5, 7]

-------------Round number: 198-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.267, 0.467, 0.433, 0.783, 0.392, 0.433, 0.117, 0.675, 0.775, 0.6, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.517, 110.377, 112.908, 111.77, 116.236, 112.562, 111.51, 109.233, 114.398, 115.592, 113.095, 115.727, 104.933, 109.355, 113.794]
F1 Score:  [0.502, 0.243, 0.491, 0.427, 0.725, 0.383, 0.407, 0.087, 0.581, 0.693, 0.629, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.567, 0.306, 0.56, 0.489, 0.769, 0.427, 0.477, 0.157, 0.644, 0.744, 0.668, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0692
Averaged Test Accurancy: 0.4878
Averaged Test AUC: 0.9361
Averaged Test F1_score: 0.4622
Averaged Test Recal score: 0.5211
Std Test Accurancy: 0.2227
Std Test AUC: 0.0240
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0862
Epoch: 0|  Loss:  2.0359 |Global loss: 5.8086| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 1.0641
Epoch: 1|  Loss:  2.0009 |Global loss: 5.818| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.0634
Epoch: 2|  Loss:  2.0116 |Global loss: 5.8155| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.0659
Epoch: 3|  Loss:  1.994 |Global loss: 5.8196| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 1.105
Epoch: 0|  Loss:  2.2932 |Global loss: 5.8489| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1177
Epoch: 1|  Loss:  2.297 |Global loss: 5.8346| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.1254
Epoch: 2|  Loss:  2.2807 |Global loss: 5.8359| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.144
Epoch: 3|  Loss:  2.2963 |Global loss: 5.8177| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.0703
Epoch: 0|  Loss:  1.9396 |Global loss: 5.8225| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 1.0673
Epoch: 1|  Loss:  1.9479 |Global loss: 5.8185| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.0857
Epoch: 2|  Loss:  1.9411 |Global loss: 5.8079| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0638
Epoch: 3|  Loss:  1.946 |Global loss: 5.8242| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.0363
Epoch: 0|  Loss:  1.6906 |Global loss: 5.793| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0166
Epoch: 1|  Loss:  1.6764 |Global loss: 5.8056| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 1.0236
Epoch: 2|  Loss:  1.6637 |Global loss: 5.8002| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.022
Epoch: 3|  Loss:  1.6727 |Global loss: 5.8138| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 1.0964
Epoch: 0|  Loss:  2.1174 |Global loss: 5.8341| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 1.1106
Epoch: 1|  Loss:  2.1329 |Global loss: 5.8244| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.1029
Epoch: 2|  Loss:  2.1067 |Global loss: 5.8267| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.0881
Epoch: 3|  Loss:  2.097 |Global loss: 5.8342| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 1.1344
Epoch: 0|  Loss:  2.4593 |Global loss: 5.8735| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.147
Epoch: 1|  Loss:  2.4525 |Global loss: 5.8659| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 1.1628
Epoch: 2|  Loss:  2.4576 |Global loss: 5.8546| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.1635
Epoch: 3|  Loss:  2.454 |Global loss: 5.8622| Local H loss: 0.0251  | Global H loss: 0.0251
------------------------- time cost ------------------------- 3.060303211212158
Chosen Clients:  [3, 8, 1, 7, 13, 5]

-------------Round number: 199-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.275, 0.45, 0.433, 0.833, 0.4, 0.433, 0.15, 0.675, 0.775, 0.6, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.517, 110.788, 113.061, 111.77, 116.607, 112.571, 111.461, 109.095, 114.398, 115.592, 113.095, 115.727, 104.933, 109.355, 113.794]
F1 Score:  [0.502, 0.248, 0.502, 0.427, 0.761, 0.387, 0.407, 0.143, 0.581, 0.693, 0.629, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.567, 0.312, 0.55, 0.489, 0.81, 0.432, 0.477, 0.199, 0.644, 0.744, 0.668, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0714
Averaged Test Accurancy: 0.4933
Averaged Test AUC: 0.9365
Averaged Test F1_score: 0.4697
Averaged Test Recal score: 0.5267
Std Test Accurancy: 0.2233
Std Test AUC: 0.0242
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0722
Epoch: 0|  Loss:  2.0935 |Global loss: 5.8156| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 1.0769
Epoch: 1|  Loss:  2.0884 |Global loss: 5.8122| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0995
Epoch: 2|  Loss:  2.1042 |Global loss: 5.7893| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 1.0864
Epoch: 3|  Loss:  2.0912 |Global loss: 5.8014| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 1.0933
Epoch: 0|  Loss:  1.8892 |Global loss: 5.8641| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 1.0855
Epoch: 1|  Loss:  1.8734 |Global loss: 5.8641| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 1.0958
Epoch: 2|  Loss:  1.8814 |Global loss: 5.8522| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 1.0835
Epoch: 3|  Loss:  1.8641 |Global loss: 5.8698| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 1.1142
Epoch: 0|  Loss:  2.2689 |Global loss: 5.8331| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 1.1246
Epoch: 1|  Loss:  2.2588 |Global loss: 5.83| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 1.1253
Epoch: 2|  Loss:  2.2594 |Global loss: 5.8283| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.1218
Epoch: 3|  Loss:  2.248 |Global loss: 5.8353| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 1.1615
Epoch: 0|  Loss:  2.4483 |Global loss: 5.8586| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 1.1628
Epoch: 1|  Loss:  2.4226 |Global loss: 5.8537| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.1567
Epoch: 2|  Loss:  2.4275 |Global loss: 5.8652| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 1.1616
Epoch: 3|  Loss:  2.4228 |Global loss: 5.8531| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1063
Epoch: 0|  Loss:  2.3151 |Global loss: 5.8288| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.1055
Epoch: 1|  Loss:  2.2836 |Global loss: 5.8518| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 1.1157
Epoch: 2|  Loss:  2.2749 |Global loss: 5.8346| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 1.1152
Epoch: 3|  Loss:  2.2832 |Global loss: 5.8323| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.09
Epoch: 0|  Loss:  2.0915 |Global loss: 5.8394| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.1067
Epoch: 1|  Loss:  2.0865 |Global loss: 5.8211| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.1025
Epoch: 2|  Loss:  2.1007 |Global loss: 5.8265| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 1.0828
Epoch: 3|  Loss:  2.0698 |Global loss: 5.8405| Local H loss: 0.0237  | Global H loss: 0.0237
------------------------- time cost ------------------------- 2.913980007171631
Chosen Clients:  [6, 13, 2, 0, 8, 4]

-------------Round number: 200-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.3, 0.45, 0.542, 0.833, 0.408, 0.433, 0.183, 0.675, 0.775, 0.6, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.517, 111.035, 113.061, 112.145, 116.607, 112.88, 111.461, 109.771, 114.627, 115.592, 113.095, 115.727, 104.933, 109.515, 113.794]
F1 Score:  [0.502, 0.282, 0.502, 0.55, 0.761, 0.39, 0.407, 0.171, 0.586, 0.693, 0.629, 0.744, 0.008, 0.341, 0.672]
Recall Score:  [0.567, 0.333, 0.55, 0.6, 0.81, 0.438, 0.477, 0.241, 0.644, 0.744, 0.668, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0555
Averaged Test Accurancy: 0.5050
Averaged Test AUC: 0.9376
Averaged Test F1_score: 0.4825
Averaged Test Recal score: 0.5387
Std Test Accurancy: 0.2177
Std Test AUC: 0.0238
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0802
Epoch: 0|  Loss:  2.0039 |Global loss: 5.8088| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.075
Epoch: 1|  Loss:  1.9982 |Global loss: 5.8033| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0661
Epoch: 2|  Loss:  1.9855 |Global loss: 5.8183| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 1.0819
Epoch: 3|  Loss:  1.9919 |Global loss: 5.8005| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.119
Epoch: 0|  Loss:  2.2952 |Global loss: 5.8381| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.1226
Epoch: 1|  Loss:  2.2904 |Global loss: 5.8283| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.1138
Epoch: 2|  Loss:  2.2669 |Global loss: 5.8326| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.1151
Epoch: 3|  Loss:  2.2409 |Global loss: 5.8333| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0777
Epoch: 0|  Loss:  1.9355 |Global loss: 5.8128| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 1.0881
Epoch: 1|  Loss:  1.9317 |Global loss: 5.806| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 1.0674
Epoch: 2|  Loss:  1.9088 |Global loss: 5.8122| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0761
Epoch: 3|  Loss:  1.9247 |Global loss: 5.8107| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0945
Epoch: 0|  Loss:  2.0494 |Global loss: 5.8005| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0722
Epoch: 1|  Loss:  2.0256 |Global loss: 5.8106| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.0951
Epoch: 2|  Loss:  2.0468 |Global loss: 5.7974| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0825
Epoch: 3|  Loss:  2.0328 |Global loss: 5.7943| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.1254
Epoch: 0|  Loss:  1.8922 |Global loss: 5.8352| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 1.0692
Epoch: 1|  Loss:  1.8452 |Global loss: 5.8678| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 1.1017
Epoch: 2|  Loss:  1.8671 |Global loss: 5.8554| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 1.0885
Epoch: 3|  Loss:  1.8405 |Global loss: 5.8531| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 1.0477
Epoch: 0|  Loss:  1.6886 |Global loss: 5.7778| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0264
Epoch: 1|  Loss:  1.6585 |Global loss: 5.789| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 1.0085
Epoch: 2|  Loss:  1.6432 |Global loss: 5.8053| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 1.0191
Epoch: 3|  Loss:  1.6567 |Global loss: 5.7964| Local H loss: 0.0326  | Global H loss: 0.0326
------------------------- time cost ------------------------- 2.847872257232666
Chosen Clients:  [1, 4, 3, 8, 6, 10]

-------------Round number: 201-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.3, 0.483, 0.542, 0.833, 0.408, 0.492, 0.183, 0.675, 0.775, 0.6, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.623, 111.035, 113.264, 112.145, 116.848, 112.88, 111.717, 109.771, 114.889, 115.592, 113.095, 115.727, 104.933, 109.84, 113.794]
F1 Score:  [0.502, 0.282, 0.525, 0.55, 0.761, 0.39, 0.49, 0.171, 0.581, 0.693, 0.629, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.567, 0.333, 0.578, 0.6, 0.81, 0.438, 0.537, 0.241, 0.644, 0.744, 0.668, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0335
Averaged Test Accurancy: 0.5111
Averaged Test AUC: 0.9384
Averaged Test F1_score: 0.4889
Averaged Test Recal score: 0.5446
Std Test Accurancy: 0.2164
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1239
Epoch: 0|  Loss:  2.242 |Global loss: 5.8288| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 1.1188
Epoch: 1|  Loss:  2.1992 |Global loss: 5.8312| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1129
Epoch: 2|  Loss:  2.2231 |Global loss: 5.8337| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 1.1059
Epoch: 3|  Loss:  2.2066 |Global loss: 5.837| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 1.028
Epoch: 0|  Loss:  1.6464 |Global loss: 5.7833| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0043
Epoch: 1|  Loss:  1.6196 |Global loss: 5.803| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0234
Epoch: 2|  Loss:  1.6511 |Global loss: 5.7876| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.9993
Epoch: 3|  Loss:  1.6158 |Global loss: 5.8084| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.0769
Epoch: 0|  Loss:  2.0889 |Global loss: 5.8137| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0606
Epoch: 1|  Loss:  2.0633 |Global loss: 5.8274| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 1.0788
Epoch: 2|  Loss:  2.0591 |Global loss: 5.8067| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0666
Epoch: 3|  Loss:  2.0253 |Global loss: 5.8133| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.079
Epoch: 0|  Loss:  1.8281 |Global loss: 5.8579| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 1.0829
Epoch: 1|  Loss:  1.8212 |Global loss: 5.8497| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 1.0983
Epoch: 2|  Loss:  1.8532 |Global loss: 5.8481| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.0728
Epoch: 3|  Loss:  1.8084 |Global loss: 5.854| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 1.0567
Epoch: 0|  Loss:  1.9739 |Global loss: 5.8179| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 1.0579
Epoch: 1|  Loss:  1.9692 |Global loss: 5.8191| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 1.0737
Epoch: 2|  Loss:  1.9854 |Global loss: 5.8104| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.0742
Epoch: 3|  Loss:  1.9736 |Global loss: 5.8127| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 1.1236
Epoch: 0|  Loss:  2.0158 |Global loss: 5.8631| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 1.1169
Epoch: 1|  Loss:  2.022 |Global loss: 5.875| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 1.1045
Epoch: 2|  Loss:  2.0118 |Global loss: 5.8734| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 1.0662
Epoch: 3|  Loss:  1.9615 |Global loss: 5.9071| Local H loss: 0.0293  | Global H loss: 0.0293
------------------------- time cost ------------------------- 3.182255744934082
Chosen Clients:  [0, 14, 1, 10, 6, 9]

-------------Round number: 202-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.342, 0.483, 0.425, 0.833, 0.408, 0.492, 0.183, 0.692, 0.775, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.623, 111.355, 113.264, 111.842, 116.928, 112.88, 111.841, 109.771, 115.105, 115.592, 113.287, 115.727, 104.933, 109.84, 113.794]
F1 Score:  [0.502, 0.329, 0.525, 0.416, 0.761, 0.39, 0.49, 0.171, 0.617, 0.693, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.567, 0.373, 0.578, 0.484, 0.81, 0.438, 0.537, 0.241, 0.662, 0.744, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0227
Averaged Test Accurancy: 0.5078
Averaged Test AUC: 0.9388
Averaged Test F1_score: 0.4858
Averaged Test Recal score: 0.5413
Std Test Accurancy: 0.2161
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0674
Epoch: 0|  Loss:  2.0102 |Global loss: 5.8171| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.08
Epoch: 1|  Loss:  1.9996 |Global loss: 5.7995| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.0821
Epoch: 2|  Loss:  1.9975 |Global loss: 5.7971| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0685
Epoch: 3|  Loss:  1.9914 |Global loss: 5.8079| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 1.0714
Epoch: 0|  Loss:  1.8527 |Global loss: 5.8473| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 1.0957
Epoch: 1|  Loss:  1.8556 |Global loss: 5.8434| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 1.0744
Epoch: 2|  Loss:  1.8274 |Global loss: 5.8501| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 1.0675
Epoch: 3|  Loss:  1.827 |Global loss: 5.8478| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.1115
Epoch: 0|  Loss:  2.2001 |Global loss: 5.8411| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 1.0964
Epoch: 1|  Loss:  2.1824 |Global loss: 5.8435| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.1156
Epoch: 2|  Loss:  2.1937 |Global loss: 5.8395| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.0958
Epoch: 3|  Loss:  2.1702 |Global loss: 5.8475| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.1141
Epoch: 0|  Loss:  2.0058 |Global loss: 5.8785| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 1.1148
Epoch: 1|  Loss:  1.9952 |Global loss: 5.8728| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 1.1064
Epoch: 2|  Loss:  1.9882 |Global loss: 5.8754| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 1.0919
Epoch: 3|  Loss:  1.9519 |Global loss: 5.8859| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 1.0563
Epoch: 0|  Loss:  1.9347 |Global loss: 5.8108| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.0442
Epoch: 1|  Loss:  1.954 |Global loss: 5.827| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.0492
Epoch: 2|  Loss:  1.9204 |Global loss: 5.8201| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0711
Epoch: 3|  Loss:  1.9366 |Global loss: 5.8088| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 1.0567
Epoch: 0|  Loss:  1.7152 |Global loss: 5.8263| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 1|  NKD Loss: 1.0715
Epoch: 1|  Loss:  1.725 |Global loss: 5.8174| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 1.0472
Epoch: 2|  Loss:  1.6979 |Global loss: 5.8328| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 1.0589
Epoch: 3|  Loss:  1.6944 |Global loss: 5.821| Local H loss: 0.0326  | Global H loss: 0.0326
------------------------- time cost ------------------------- 3.1269402503967285
Chosen Clients:  [12, 3, 10, 6, 5, 9]

-------------Round number: 203-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.542, 0.45, 0.483, 0.425, 0.833, 0.408, 0.492, 0.183, 0.692, 0.817, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.611, 111.93, 113.264, 111.842, 116.928, 112.88, 111.929, 109.771, 115.105, 115.674, 113.444, 115.727, 104.933, 109.84, 114.208]
F1 Score:  [0.517, 0.44, 0.525, 0.416, 0.761, 0.39, 0.49, 0.171, 0.617, 0.75, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.575, 0.477, 0.578, 0.484, 0.81, 0.438, 0.537, 0.241, 0.662, 0.796, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 2.0063
Averaged Test Accurancy: 0.5183
Averaged Test AUC: 0.9395
Averaged Test F1_score: 0.4980
Averaged Test Recal score: 0.5523
Std Test Accurancy: 0.2159
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1553
Epoch: 0|  Loss:  2.9882 |Global loss: 5.883| Local H loss: 0.0153  | Global H loss: 0.0153
Epoch: 1|  NKD Loss: 1.175
Epoch: 1|  Loss:  3.0061 |Global loss: 5.8616| Local H loss: 0.0152  | Global H loss: 0.0152
Epoch: 2|  NKD Loss: 1.1858
Epoch: 2|  Loss:  3.0095 |Global loss: 5.8491| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 3|  NKD Loss: 1.1932
Epoch: 3|  Loss:  3.005 |Global loss: 5.8403| Local H loss: 0.0156  | Global H loss: 0.0156
Epoch: 0|  NKD Loss: 1.0639
Epoch: 0|  Loss:  2.0469 |Global loss: 5.8229| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 1.063
Epoch: 1|  Loss:  2.0274 |Global loss: 5.8121| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 1.0671
Epoch: 2|  Loss:  2.0197 |Global loss: 5.8129| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.092
Epoch: 3|  Loss:  2.051 |Global loss: 5.8065| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 1.1108
Epoch: 0|  Loss:  1.983 |Global loss: 5.87| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 1.1112
Epoch: 1|  Loss:  1.9653 |Global loss: 5.8782| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 1.0822
Epoch: 2|  Loss:  1.9375 |Global loss: 5.883| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0941
Epoch: 3|  Loss:  1.9458 |Global loss: 5.8789| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0681
Epoch: 0|  Loss:  1.9388 |Global loss: 5.8058| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.064
Epoch: 1|  Loss:  1.9519 |Global loss: 5.806| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.065
Epoch: 2|  Loss:  1.929 |Global loss: 5.8084| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.0656
Epoch: 3|  Loss:  1.9114 |Global loss: 5.8089| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.0798
Epoch: 0|  Loss:  2.0486 |Global loss: 5.844| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 1.0838
Epoch: 1|  Loss:  2.0677 |Global loss: 5.8434| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 1.0693
Epoch: 2|  Loss:  2.0542 |Global loss: 5.8465| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 1.0898
Epoch: 3|  Loss:  2.0418 |Global loss: 5.8329| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.0316
Epoch: 0|  Loss:  1.6623 |Global loss: 5.8355| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 1.0494
Epoch: 1|  Loss:  1.6779 |Global loss: 5.8288| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0437
Epoch: 2|  Loss:  1.6569 |Global loss: 5.829| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.03
Epoch: 3|  Loss:  1.6326 |Global loss: 5.8345| Local H loss: 0.0329  | Global H loss: 0.0329
------------------------- time cost ------------------------- 3.1790659427642822
Chosen Clients:  [4, 10, 6, 9, 5, 12]

-------------Round number: 204-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.542, 0.45, 0.483, 0.542, 0.833, 0.417, 0.567, 0.183, 0.692, 0.817, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.611, 111.93, 113.264, 112.422, 116.928, 113.061, 112.1, 109.771, 115.105, 115.97, 113.966, 115.727, 105.04, 109.84, 114.208]
F1 Score:  [0.517, 0.44, 0.525, 0.55, 0.761, 0.396, 0.581, 0.171, 0.617, 0.75, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.575, 0.477, 0.578, 0.6, 0.81, 0.445, 0.629, 0.241, 0.662, 0.796, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9997
Averaged Test Accurancy: 0.5317
Averaged Test AUC: 0.9405
Averaged Test F1_score: 0.5134
Averaged Test Recal score: 0.5666
Std Test Accurancy: 0.2142
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0221
Epoch: 0|  Loss:  1.6216 |Global loss: 5.7861| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 1.0111
Epoch: 1|  Loss:  1.6107 |Global loss: 5.7945| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.9917
Epoch: 2|  Loss:  1.6106 |Global loss: 5.8129| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 1.0116
Epoch: 3|  Loss:  1.6136 |Global loss: 5.7912| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 1.0977
Epoch: 0|  Loss:  1.9377 |Global loss: 5.874| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 1.1115
Epoch: 1|  Loss:  1.9424 |Global loss: 5.8716| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 1.0864
Epoch: 2|  Loss:  1.9264 |Global loss: 5.8823| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 1.0887
Epoch: 3|  Loss:  1.9218 |Global loss: 5.8839| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0497
Epoch: 0|  Loss:  1.9025 |Global loss: 5.8145| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.0384
Epoch: 1|  Loss:  1.8907 |Global loss: 5.8235| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 1.0473
Epoch: 2|  Loss:  1.9037 |Global loss: 5.8189| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0523
Epoch: 3|  Loss:  1.898 |Global loss: 5.8116| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 1.0354
Epoch: 0|  Loss:  1.6389 |Global loss: 5.8322| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 1.0465
Epoch: 1|  Loss:  1.6449 |Global loss: 5.8207| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 1.0208
Epoch: 2|  Loss:  1.6225 |Global loss: 5.8383| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.0121
Epoch: 3|  Loss:  1.591 |Global loss: 5.8391| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 1.093
Epoch: 0|  Loss:  2.0504 |Global loss: 5.8375| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 1.0915
Epoch: 1|  Loss:  2.0633 |Global loss: 5.8323| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 1.0926
Epoch: 2|  Loss:  2.0484 |Global loss: 5.8303| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.0917
Epoch: 3|  Loss:  2.03 |Global loss: 5.8307| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 1.153
Epoch: 0|  Loss:  2.9798 |Global loss: 5.8804| Local H loss: 0.0155  | Global H loss: 0.0155
Epoch: 1|  NKD Loss: 1.1959
Epoch: 1|  Loss:  2.9876 |Global loss: 5.8521| Local H loss: 0.0157  | Global H loss: 0.0157
Epoch: 2|  NKD Loss: 1.2004
Epoch: 2|  Loss:  2.9913 |Global loss: 5.8442| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.1999
Epoch: 3|  Loss:  2.9847 |Global loss: 5.8462| Local H loss: 0.0159  | Global H loss: 0.0159
------------------------- time cost ------------------------- 2.853731393814087
Chosen Clients:  [2, 10, 0, 4, 5, 3]

-------------Round number: 205-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.542, 0.45, 0.483, 0.542, 0.833, 0.408, 0.558, 0.183, 0.692, 0.833, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.611, 111.93, 113.264, 112.422, 116.827, 113.082, 112.189, 109.771, 115.105, 116.362, 114.202, 115.727, 105.311, 109.84, 114.208]
F1 Score:  [0.517, 0.44, 0.525, 0.55, 0.761, 0.39, 0.575, 0.171, 0.617, 0.764, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.575, 0.477, 0.578, 0.6, 0.81, 0.438, 0.621, 0.241, 0.662, 0.817, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9944
Averaged Test Accurancy: 0.5317
Averaged Test AUC: 0.9410
Averaged Test F1_score: 0.5135
Averaged Test Recal score: 0.5670
Std Test Accurancy: 0.2159
Std Test AUC: 0.0238
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0624
Epoch: 0|  Loss:  1.8987 |Global loss: 5.8231| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 1.0751
Epoch: 1|  Loss:  1.9165 |Global loss: 5.8125| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 1.0682
Epoch: 2|  Loss:  1.9003 |Global loss: 5.8181| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 1.0623
Epoch: 3|  Loss:  1.8877 |Global loss: 5.8276| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.0862
Epoch: 0|  Loss:  1.9126 |Global loss: 5.8894| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 1.0988
Epoch: 1|  Loss:  1.9126 |Global loss: 5.873| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 1.0837
Epoch: 2|  Loss:  1.8859 |Global loss: 5.8857| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0755
Epoch: 3|  Loss:  1.8894 |Global loss: 5.8894| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.0421
Epoch: 0|  Loss:  1.9568 |Global loss: 5.83| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.0827
Epoch: 1|  Loss:  1.9907 |Global loss: 5.794| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.067
Epoch: 2|  Loss:  1.9838 |Global loss: 5.8087| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0677
Epoch: 3|  Loss:  1.9666 |Global loss: 5.806| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.008
Epoch: 0|  Loss:  1.6122 |Global loss: 5.7854| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 1.0124
Epoch: 1|  Loss:  1.6005 |Global loss: 5.7862| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 1.0225
Epoch: 2|  Loss:  1.6232 |Global loss: 5.7785| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9992
Epoch: 3|  Loss:  1.5866 |Global loss: 5.7931| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 1.0908
Epoch: 0|  Loss:  2.0119 |Global loss: 5.8293| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.0995
Epoch: 1|  Loss:  2.0267 |Global loss: 5.8263| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 1.1058
Epoch: 2|  Loss:  2.0207 |Global loss: 5.8165| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.0946
Epoch: 3|  Loss:  2.0233 |Global loss: 5.8269| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 1.0602
Epoch: 0|  Loss:  2.015 |Global loss: 5.8183| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 1.0635
Epoch: 1|  Loss:  2.0123 |Global loss: 5.8097| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 1.059
Epoch: 2|  Loss:  1.9782 |Global loss: 5.8136| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 1.0768
Epoch: 3|  Loss:  1.9949 |Global loss: 5.8034| Local H loss: 0.0326  | Global H loss: 0.0326
------------------------- time cost ------------------------- 2.8534669876098633
Chosen Clients:  [2, 0, 6, 9, 4, 12]

-------------Round number: 206-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.533, 0.45, 0.492, 0.542, 0.833, 0.417, 0.558, 0.183, 0.692, 0.833, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.74, 111.93, 113.269, 112.425, 116.976, 113.416, 112.189, 109.771, 115.105, 116.362, 114.434, 115.727, 105.311, 109.84, 114.208]
F1 Score:  [0.502, 0.44, 0.53, 0.55, 0.761, 0.407, 0.575, 0.171, 0.617, 0.764, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.567, 0.477, 0.585, 0.6, 0.81, 0.447, 0.621, 0.241, 0.662, 0.817, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9882
Averaged Test Accurancy: 0.5322
Averaged Test AUC: 0.9415
Averaged Test F1_score: 0.5140
Averaged Test Recal score: 0.5675
Std Test Accurancy: 0.2155
Std Test AUC: 0.0241
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0729
Epoch: 0|  Loss:  1.8851 |Global loss: 5.8033| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 1.0627
Epoch: 1|  Loss:  1.8817 |Global loss: 5.8197| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 1.0688
Epoch: 2|  Loss:  1.886 |Global loss: 5.8107| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0504
Epoch: 3|  Loss:  1.8495 |Global loss: 5.8282| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0525
Epoch: 0|  Loss:  1.9351 |Global loss: 5.8099| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.0524
Epoch: 1|  Loss:  1.9403 |Global loss: 5.82| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0618
Epoch: 2|  Loss:  1.9385 |Global loss: 5.8007| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0673
Epoch: 3|  Loss:  1.9373 |Global loss: 5.8032| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0452
Epoch: 0|  Loss:  1.8817 |Global loss: 5.8173| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.0509
Epoch: 1|  Loss:  1.8956 |Global loss: 5.8093| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.0674
Epoch: 2|  Loss:  1.9102 |Global loss: 5.8018| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.0399
Epoch: 3|  Loss:  1.8771 |Global loss: 5.8192| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.0629
Epoch: 0|  Loss:  1.6464 |Global loss: 5.8118| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.0324
Epoch: 1|  Loss:  1.6151 |Global loss: 5.8235| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.9999
Epoch: 2|  Loss:  1.5788 |Global loss: 5.8474| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0261
Epoch: 3|  Loss:  1.5873 |Global loss: 5.8261| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 1.0143
Epoch: 0|  Loss:  1.617 |Global loss: 5.7864| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.9765
Epoch: 1|  Loss:  1.5696 |Global loss: 5.7975| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.9812
Epoch: 2|  Loss:  1.5678 |Global loss: 5.7959| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 1.0106
Epoch: 3|  Loss:  1.6159 |Global loss: 5.7906| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 1.1768
Epoch: 0|  Loss:  2.9744 |Global loss: 5.8691| Local H loss: 0.0159  | Global H loss: 0.0159
Epoch: 1|  NKD Loss: 1.1746
Epoch: 1|  Loss:  2.9566 |Global loss: 5.8692| Local H loss: 0.016  | Global H loss: 0.016
Epoch: 2|  NKD Loss: 1.1882
Epoch: 2|  Loss:  2.9508 |Global loss: 5.8593| Local H loss: 0.0161  | Global H loss: 0.0161
Epoch: 3|  NKD Loss: 1.2056
Epoch: 3|  Loss:  2.9619 |Global loss: 5.8393| Local H loss: 0.0163  | Global H loss: 0.0163
------------------------- time cost ------------------------- 2.9969825744628906
Chosen Clients:  [7, 14, 11, 6, 9, 1]

-------------Round number: 207-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.558, 0.45, 0.525, 0.542, 0.833, 0.417, 0.567, 0.183, 0.692, 0.817, 0.608, 0.758, 0.05, 0.35, 0.683]
AUC in each clients:  [113.942, 111.93, 113.502, 112.425, 117.028, 113.416, 112.46, 109.771, 115.105, 116.378, 114.434, 115.727, 105.234, 109.84, 114.208]
F1 Score:  [0.541, 0.44, 0.561, 0.55, 0.761, 0.407, 0.577, 0.171, 0.617, 0.75, 0.634, 0.744, 0.008, 0.335, 0.672]
Recall Score:  [0.592, 0.477, 0.619, 0.6, 0.81, 0.447, 0.629, 0.241, 0.662, 0.796, 0.677, 0.794, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9757
Averaged Test Accurancy: 0.5356
Averaged Test AUC: 0.9419
Averaged Test F1_score: 0.5179
Averaged Test Recal score: 0.5706
Std Test Accurancy: 0.2139
Std Test AUC: 0.0242
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1289
Epoch: 0|  Loss:  2.3732 |Global loss: 5.8742| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.1475
Epoch: 1|  Loss:  2.3829 |Global loss: 5.861| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 1.1397
Epoch: 2|  Loss:  2.3636 |Global loss: 5.8704| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 1.1579
Epoch: 3|  Loss:  2.3659 |Global loss: 5.8515| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 1.0917
Epoch: 0|  Loss:  1.8333 |Global loss: 5.8328| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 1.0792
Epoch: 1|  Loss:  1.8088 |Global loss: 5.8409| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 1.0793
Epoch: 2|  Loss:  1.8007 |Global loss: 5.8372| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0779
Epoch: 3|  Loss:  1.8017 |Global loss: 5.8404| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.9839
Epoch: 0|  Loss:  1.5431 |Global loss: 5.7785| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0139
Epoch: 1|  Loss:  1.5673 |Global loss: 5.7621| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 1.0034
Epoch: 2|  Loss:  1.5415 |Global loss: 5.7646| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9965
Epoch: 3|  Loss:  1.5234 |Global loss: 5.7744| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 1.0456
Epoch: 0|  Loss:  1.882 |Global loss: 5.8116| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.0489
Epoch: 1|  Loss:  1.8762 |Global loss: 5.8146| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 1.0678
Epoch: 2|  Loss:  1.8728 |Global loss: 5.8003| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.0594
Epoch: 3|  Loss:  1.89 |Global loss: 5.8013| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 1.0354
Epoch: 0|  Loss:  1.6025 |Global loss: 5.8231| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 1.0445
Epoch: 1|  Loss:  1.6012 |Global loss: 5.8133| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 1.0264
Epoch: 2|  Loss:  1.5804 |Global loss: 5.8314| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.032
Epoch: 3|  Loss:  1.5818 |Global loss: 5.8221| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.1137
Epoch: 0|  Loss:  2.1612 |Global loss: 5.8313| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.0978
Epoch: 1|  Loss:  2.1561 |Global loss: 5.8314| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.0884
Epoch: 2|  Loss:  2.1289 |Global loss: 5.8463| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.1127
Epoch: 3|  Loss:  2.1445 |Global loss: 5.8354| Local H loss: 0.0254  | Global H loss: 0.0254
------------------------- time cost ------------------------- 3.1087241172790527
Chosen Clients:  [3, 4, 13, 7, 6, 11]

-------------Round number: 208-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.558, 0.483, 0.525, 0.542, 0.833, 0.417, 0.592, 0.183, 0.692, 0.833, 0.608, 0.775, 0.05, 0.35, 0.683]
AUC in each clients:  [113.942, 112.117, 113.502, 112.425, 117.028, 113.416, 112.705, 110.317, 115.105, 116.455, 114.434, 116.104, 105.234, 109.84, 114.532]
F1 Score:  [0.541, 0.472, 0.561, 0.55, 0.761, 0.407, 0.593, 0.171, 0.617, 0.764, 0.634, 0.752, 0.008, 0.335, 0.672]
Recall Score:  [0.592, 0.514, 0.619, 0.6, 0.81, 0.447, 0.654, 0.241, 0.662, 0.817, 0.677, 0.805, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9666
Averaged Test Accurancy: 0.5417
Averaged Test AUC: 0.9429
Averaged Test F1_score: 0.5225
Averaged Test Recal score: 0.5769
Std Test Accurancy: 0.2161
Std Test AUC: 0.0242
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0429
Epoch: 0|  Loss:  1.9752 |Global loss: 5.825| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0823
Epoch: 1|  Loss:  1.995 |Global loss: 5.8004| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 2|  NKD Loss: 1.0597
Epoch: 2|  Loss:  1.9774 |Global loss: 5.815| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 1.0687
Epoch: 3|  Loss:  1.9762 |Global loss: 5.7975| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.0091
Epoch: 0|  Loss:  1.5939 |Global loss: 5.7794| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0139
Epoch: 1|  Loss:  1.5968 |Global loss: 5.7761| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 1.0019
Epoch: 2|  Loss:  1.5924 |Global loss: 5.7782| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.9916
Epoch: 3|  Loss:  1.5711 |Global loss: 5.7832| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.1032
Epoch: 0|  Loss:  2.2416 |Global loss: 5.842| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0869
Epoch: 1|  Loss:  2.219 |Global loss: 5.8511| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.1122
Epoch: 2|  Loss:  2.2391 |Global loss: 5.8328| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.0958
Epoch: 3|  Loss:  2.2079 |Global loss: 5.8409| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 1.1336
Epoch: 0|  Loss:  2.3357 |Global loss: 5.8758| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 1.1218
Epoch: 1|  Loss:  2.3296 |Global loss: 5.8756| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.1354
Epoch: 2|  Loss:  2.3353 |Global loss: 5.8606| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.1252
Epoch: 3|  Loss:  2.3166 |Global loss: 5.8684| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0527
Epoch: 0|  Loss:  1.8619 |Global loss: 5.818| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.0424
Epoch: 1|  Loss:  1.8649 |Global loss: 5.8132| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 1.0607
Epoch: 2|  Loss:  1.8726 |Global loss: 5.796| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.0579
Epoch: 3|  Loss:  1.8692 |Global loss: 5.805| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9943
Epoch: 0|  Loss:  1.5262 |Global loss: 5.7722| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0009
Epoch: 1|  Loss:  1.5239 |Global loss: 5.7688| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.997
Epoch: 2|  Loss:  1.5102 |Global loss: 5.7683| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.9978
Epoch: 3|  Loss:  1.5177 |Global loss: 5.7665| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 3.0311222076416016
Chosen Clients:  [7, 10, 4, 11, 0, 13]

-------------Round number: 209-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.558, 0.483, 0.525, 0.6, 0.833, 0.417, 0.592, 0.217, 0.692, 0.833, 0.608, 0.783, 0.05, 0.35, 0.683]
AUC in each clients:  [113.942, 112.117, 113.502, 112.871, 117.152, 113.416, 112.823, 110.337, 115.105, 116.455, 114.434, 116.268, 105.234, 110.052, 114.532]
F1 Score:  [0.541, 0.472, 0.561, 0.581, 0.761, 0.407, 0.603, 0.222, 0.617, 0.764, 0.634, 0.755, 0.008, 0.335, 0.672]
Recall Score:  [0.592, 0.514, 0.619, 0.639, 0.81, 0.447, 0.656, 0.278, 0.662, 0.817, 0.677, 0.81, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9596
Averaged Test Accurancy: 0.5483
Averaged Test AUC: 0.9435
Averaged Test F1_score: 0.5289
Averaged Test Recal score: 0.5824
Std Test Accurancy: 0.2136
Std Test AUC: 0.0242
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.1329
Epoch: 0|  Loss:  2.3178 |Global loss: 5.8682| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.1539
Epoch: 1|  Loss:  2.3156 |Global loss: 5.8576| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1437
Epoch: 2|  Loss:  2.3056 |Global loss: 5.8531| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.1491
Epoch: 3|  Loss:  2.3062 |Global loss: 5.8494| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.099
Epoch: 0|  Loss:  1.9027 |Global loss: 5.8714| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 1.0907
Epoch: 1|  Loss:  1.8778 |Global loss: 5.8725| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 1.0694
Epoch: 2|  Loss:  1.8529 |Global loss: 5.8918| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.067
Epoch: 3|  Loss:  1.8582 |Global loss: 5.8899| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.998
Epoch: 0|  Loss:  1.5865 |Global loss: 5.7809| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 1.0185
Epoch: 1|  Loss:  1.5766 |Global loss: 5.7678| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.9971
Epoch: 2|  Loss:  1.5802 |Global loss: 5.7811| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0007
Epoch: 3|  Loss:  1.559 |Global loss: 5.781| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.9947
Epoch: 0|  Loss:  1.5137 |Global loss: 5.7651| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 0.9944
Epoch: 1|  Loss:  1.4921 |Global loss: 5.7695| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.9987
Epoch: 2|  Loss:  1.5045 |Global loss: 5.7652| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.982
Epoch: 3|  Loss:  1.4886 |Global loss: 5.7738| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.0499
Epoch: 0|  Loss:  1.9309 |Global loss: 5.8104| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.0498
Epoch: 1|  Loss:  1.9247 |Global loss: 5.8059| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.0657
Epoch: 2|  Loss:  1.9387 |Global loss: 5.7955| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0737
Epoch: 3|  Loss:  1.9247 |Global loss: 5.795| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.1181
Epoch: 0|  Loss:  2.2236 |Global loss: 5.8381| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 1.0964
Epoch: 1|  Loss:  2.2082 |Global loss: 5.8339| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.112
Epoch: 2|  Loss:  2.2018 |Global loss: 5.8347| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.1156
Epoch: 3|  Loss:  2.2175 |Global loss: 5.8233| Local H loss: 0.0291  | Global H loss: 0.0291
------------------------- time cost ------------------------- 3.2331857681274414
Chosen Clients:  [8, 3, 2, 0, 7, 10]

-------------Round number: 210-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.558, 0.483, 0.525, 0.6, 0.833, 0.417, 0.592, 0.217, 0.692, 0.833, 0.608, 0.783, 0.05, 0.35, 0.683]
AUC in each clients:  [113.983, 112.117, 113.502, 112.871, 117.26, 113.416, 112.823, 110.991, 115.105, 116.455, 114.635, 116.267, 105.234, 110.147, 114.532]
F1 Score:  [0.541, 0.472, 0.561, 0.581, 0.761, 0.407, 0.603, 0.222, 0.617, 0.764, 0.634, 0.755, 0.008, 0.341, 0.672]
Recall Score:  [0.592, 0.514, 0.619, 0.639, 0.81, 0.447, 0.656, 0.278, 0.662, 0.817, 0.677, 0.81, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9446
Averaged Test Accurancy: 0.5483
Averaged Test AUC: 0.9441
Averaged Test F1_score: 0.5293
Averaged Test Recal score: 0.5824
Std Test Accurancy: 0.2136
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0813
Epoch: 0|  Loss:  1.8128 |Global loss: 5.8522| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 1.0987
Epoch: 1|  Loss:  1.8189 |Global loss: 5.8412| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 1.0649
Epoch: 2|  Loss:  1.7994 |Global loss: 5.8602| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 1.0758
Epoch: 3|  Loss:  1.795 |Global loss: 5.8558| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0672
Epoch: 0|  Loss:  1.9458 |Global loss: 5.8052| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0399
Epoch: 1|  Loss:  1.9376 |Global loss: 5.8267| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0601
Epoch: 2|  Loss:  1.959 |Global loss: 5.8074| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 1.0266
Epoch: 3|  Loss:  1.8919 |Global loss: 5.8301| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 1.0606
Epoch: 0|  Loss:  1.8568 |Global loss: 5.8148| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.0639
Epoch: 1|  Loss:  1.8706 |Global loss: 5.828| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 1.0415
Epoch: 2|  Loss:  1.8425 |Global loss: 5.8337| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 1.0699
Epoch: 3|  Loss:  1.8519 |Global loss: 5.814| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 1.0453
Epoch: 0|  Loss:  1.8928 |Global loss: 5.8141| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0358
Epoch: 1|  Loss:  1.8816 |Global loss: 5.8128| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0663
Epoch: 2|  Loss:  1.9131 |Global loss: 5.7912| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0527
Epoch: 3|  Loss:  1.9104 |Global loss: 5.7995| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.133
Epoch: 0|  Loss:  2.2706 |Global loss: 5.8654| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 1.1277
Epoch: 1|  Loss:  2.2637 |Global loss: 5.8601| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.1336
Epoch: 2|  Loss:  2.2621 |Global loss: 5.8565| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.1263
Epoch: 3|  Loss:  2.2418 |Global loss: 5.8537| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.1028
Epoch: 0|  Loss:  1.8756 |Global loss: 5.8644| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0861
Epoch: 1|  Loss:  1.864 |Global loss: 5.8772| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 1.0758
Epoch: 2|  Loss:  1.8492 |Global loss: 5.8811| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0626
Epoch: 3|  Loss:  1.8293 |Global loss: 5.8896| Local H loss: 0.0318  | Global H loss: 0.0318
------------------------- time cost ------------------------- 3.189392566680908
Chosen Clients:  [8, 1, 3, 14, 4, 2]

-------------Round number: 211-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.483, 0.525, 0.6, 0.833, 0.417, 0.592, 0.233, 0.692, 0.833, 0.608, 0.783, 0.05, 0.35, 0.683]
AUC in each clients:  [114.233, 112.117, 113.577, 113.117, 117.26, 113.416, 112.823, 111.327, 115.075, 116.455, 114.673, 116.267, 105.234, 110.147, 114.532]
F1 Score:  [0.566, 0.472, 0.559, 0.581, 0.761, 0.407, 0.603, 0.238, 0.617, 0.764, 0.634, 0.755, 0.008, 0.341, 0.672]
Recall Score:  [0.617, 0.514, 0.616, 0.639, 0.81, 0.447, 0.656, 0.296, 0.662, 0.817, 0.677, 0.81, 0.083, 0.41, 0.722]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9371
Averaged Test Accurancy: 0.5511
Averaged Test AUC: 0.9446
Averaged Test F1_score: 0.5319
Averaged Test Recal score: 0.5851
Std Test Accurancy: 0.2121
Std Test AUC: 0.0238
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.06
Epoch: 0|  Loss:  1.7748 |Global loss: 5.8578| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 1.0505
Epoch: 1|  Loss:  1.7638 |Global loss: 5.8677| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 1.0673
Epoch: 2|  Loss:  1.7767 |Global loss: 5.8576| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 1.057
Epoch: 3|  Loss:  1.7582 |Global loss: 5.8658| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 1.0792
Epoch: 0|  Loss:  2.1151 |Global loss: 5.8559| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.0797
Epoch: 1|  Loss:  2.0992 |Global loss: 5.8484| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.0921
Epoch: 2|  Loss:  2.11 |Global loss: 5.8486| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.0947
Epoch: 3|  Loss:  2.1082 |Global loss: 5.8503| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 1.0465
Epoch: 0|  Loss:  1.9173 |Global loss: 5.8114| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0681
Epoch: 1|  Loss:  1.934 |Global loss: 5.8073| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0613
Epoch: 2|  Loss:  1.9366 |Global loss: 5.8042| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 1.0482
Epoch: 3|  Loss:  1.9027 |Global loss: 5.8095| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 1.074
Epoch: 0|  Loss:  1.7853 |Global loss: 5.8357| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 1.0681
Epoch: 1|  Loss:  1.7781 |Global loss: 5.8382| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 1.0628
Epoch: 2|  Loss:  1.7687 |Global loss: 5.8516| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0526
Epoch: 3|  Loss:  1.7436 |Global loss: 5.848| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.9951
Epoch: 0|  Loss:  1.5663 |Global loss: 5.7789| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.9998
Epoch: 1|  Loss:  1.5681 |Global loss: 5.7755| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.9934
Epoch: 2|  Loss:  1.5396 |Global loss: 5.7757| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.9775
Epoch: 3|  Loss:  1.548 |Global loss: 5.7943| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.0296
Epoch: 0|  Loss:  1.8358 |Global loss: 5.8324| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 1.0515
Epoch: 1|  Loss:  1.8314 |Global loss: 5.8217| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0691
Epoch: 2|  Loss:  1.855 |Global loss: 5.8192| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 1.0449
Epoch: 3|  Loss:  1.8304 |Global loss: 5.8307| Local H loss: 0.0305  | Global H loss: 0.0305
------------------------- time cost ------------------------- 3.0229814052581787
Chosen Clients:  [8, 13, 5, 3, 6, 9]

-------------Round number: 212-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.525, 0.542, 0.617, 0.833, 0.417, 0.592, 0.233, 0.692, 0.833, 0.608, 0.783, 0.05, 0.35, 0.767]
AUC in each clients:  [114.233, 112.502, 114.023, 113.261, 117.436, 113.416, 112.823, 111.327, 115.247, 116.455, 114.673, 116.267, 105.234, 110.147, 114.912]
F1 Score:  [0.566, 0.502, 0.571, 0.588, 0.761, 0.407, 0.603, 0.238, 0.617, 0.764, 0.634, 0.755, 0.008, 0.341, 0.742]
Recall Score:  [0.617, 0.56, 0.634, 0.65, 0.81, 0.447, 0.656, 0.296, 0.662, 0.817, 0.677, 0.81, 0.083, 0.41, 0.784]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9176
Averaged Test Accurancy: 0.5617
Averaged Test AUC: 0.9455
Averaged Test F1_score: 0.5398
Averaged Test Recal score: 0.5942
Std Test Accurancy: 0.2159
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0756
Epoch: 0|  Loss:  1.7636 |Global loss: 5.845| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0494
Epoch: 1|  Loss:  1.7304 |Global loss: 5.8525| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0526
Epoch: 2|  Loss:  1.7382 |Global loss: 5.8618| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 1.0587
Epoch: 3|  Loss:  1.7409 |Global loss: 5.8598| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.0826
Epoch: 0|  Loss:  2.162 |Global loss: 5.8556| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.095
Epoch: 1|  Loss:  2.1608 |Global loss: 5.8373| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 1.103
Epoch: 2|  Loss:  2.1644 |Global loss: 5.8314| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 1.0822
Epoch: 3|  Loss:  2.1345 |Global loss: 5.8471| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 1.0883
Epoch: 0|  Loss:  2.0192 |Global loss: 5.8396| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 1.083
Epoch: 1|  Loss:  2.0009 |Global loss: 5.8297| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.0912
Epoch: 2|  Loss:  2.0051 |Global loss: 5.832| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.0944
Epoch: 3|  Loss:  1.992 |Global loss: 5.8253| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 1.0602
Epoch: 0|  Loss:  1.9067 |Global loss: 5.8111| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 1.0433
Epoch: 1|  Loss:  1.8963 |Global loss: 5.8121| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 1.0559
Epoch: 2|  Loss:  1.8885 |Global loss: 5.8108| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 1.0565
Epoch: 3|  Loss:  1.8698 |Global loss: 5.8073| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 1.0576
Epoch: 0|  Loss:  1.8444 |Global loss: 5.8074| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0414
Epoch: 1|  Loss:  1.8455 |Global loss: 5.8113| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.0174
Epoch: 2|  Loss:  1.8165 |Global loss: 5.8282| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 1.043
Epoch: 3|  Loss:  1.8462 |Global loss: 5.8184| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.0339
Epoch: 0|  Loss:  1.5727 |Global loss: 5.8117| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 1.0204
Epoch: 1|  Loss:  1.5553 |Global loss: 5.825| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0298
Epoch: 2|  Loss:  1.5614 |Global loss: 5.8208| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 1.0174
Epoch: 3|  Loss:  1.5411 |Global loss: 5.8299| Local H loss: 0.0332  | Global H loss: 0.0332
------------------------- time cost ------------------------- 3.369401693344116
Chosen Clients:  [1, 9, 7, 14, 0, 2]

-------------Round number: 213-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.525, 0.542, 0.617, 0.833, 0.417, 0.583, 0.233, 0.692, 0.833, 0.608, 0.783, 0.05, 0.358, 0.767]
AUC in each clients:  [114.233, 112.502, 114.023, 113.345, 117.436, 113.387, 112.845, 111.327, 115.193, 116.57, 114.673, 116.267, 105.234, 110.256, 114.912]
F1 Score:  [0.566, 0.502, 0.571, 0.588, 0.761, 0.396, 0.598, 0.238, 0.617, 0.764, 0.634, 0.755, 0.008, 0.354, 0.742]
Recall Score:  [0.617, 0.56, 0.634, 0.65, 0.81, 0.445, 0.648, 0.296, 0.662, 0.817, 0.677, 0.81, 0.083, 0.417, 0.784]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9127
Averaged Test Accurancy: 0.5617
Averaged Test AUC: 0.9457
Averaged Test F1_score: 0.5396
Averaged Test Recal score: 0.5940
Std Test Accurancy: 0.2153
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0944
Epoch: 0|  Loss:  2.0972 |Global loss: 5.8426| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.1024
Epoch: 1|  Loss:  2.1064 |Global loss: 5.8377| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 1.076
Epoch: 2|  Loss:  2.0694 |Global loss: 5.848| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.0911
Epoch: 3|  Loss:  2.0727 |Global loss: 5.8426| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.0365
Epoch: 0|  Loss:  1.5534 |Global loss: 5.8058| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0173
Epoch: 1|  Loss:  1.535 |Global loss: 5.8244| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 1.018
Epoch: 2|  Loss:  1.5351 |Global loss: 5.8212| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 1.0201
Epoch: 3|  Loss:  1.5349 |Global loss: 5.8219| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 1.1004
Epoch: 0|  Loss:  2.225 |Global loss: 5.8787| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.1211
Epoch: 1|  Loss:  2.2187 |Global loss: 5.8701| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.1144
Epoch: 2|  Loss:  2.2051 |Global loss: 5.8656| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.1345
Epoch: 3|  Loss:  2.2149 |Global loss: 5.8485| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 0|  NKD Loss: 1.0486
Epoch: 0|  Loss:  1.7435 |Global loss: 5.8515| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 1.068
Epoch: 1|  Loss:  1.7405 |Global loss: 5.8478| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 1.0434
Epoch: 2|  Loss:  1.7301 |Global loss: 5.8515| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 1.0641
Epoch: 3|  Loss:  1.739 |Global loss: 5.8433| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0427
Epoch: 0|  Loss:  1.8745 |Global loss: 5.8113| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.063
Epoch: 1|  Loss:  1.8742 |Global loss: 5.7945| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0647
Epoch: 2|  Loss:  1.8739 |Global loss: 5.792| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 1.0484
Epoch: 3|  Loss:  1.8571 |Global loss: 5.7926| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.0357
Epoch: 0|  Loss:  1.8049 |Global loss: 5.8341| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 1.0624
Epoch: 1|  Loss:  1.8326 |Global loss: 5.8148| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 1.0452
Epoch: 2|  Loss:  1.821 |Global loss: 5.837| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 1.0607
Epoch: 3|  Loss:  1.8126 |Global loss: 5.8177| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 2.7896852493286133
Chosen Clients:  [3, 12, 2, 6, 1, 9]

-------------Round number: 214-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.533, 0.617, 0.833, 0.417, 0.583, 0.283, 0.692, 0.833, 0.608, 0.783, 0.05, 0.358, 0.717]
AUC in each clients:  [114.239, 113.056, 113.879, 113.345, 117.436, 113.387, 112.845, 112.051, 115.193, 116.628, 114.673, 116.267, 105.234, 110.256, 115.005]
F1 Score:  [0.566, 0.507, 0.565, 0.588, 0.761, 0.396, 0.598, 0.285, 0.617, 0.764, 0.634, 0.755, 0.008, 0.354, 0.708]
Recall Score:  [0.617, 0.569, 0.625, 0.65, 0.81, 0.445, 0.648, 0.337, 0.662, 0.817, 0.677, 0.81, 0.083, 0.417, 0.75]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.9072
Averaged Test Accurancy: 0.5617
Averaged Test AUC: 0.9464
Averaged Test F1_score: 0.5404
Averaged Test Recal score: 0.5945
Std Test Accurancy: 0.2077
Std Test AUC: 0.0237
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0199
Epoch: 0|  Loss:  1.8409 |Global loss: 5.8192| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 1|  NKD Loss: 1.0418
Epoch: 1|  Loss:  1.8618 |Global loss: 5.8138| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 1.0582
Epoch: 2|  Loss:  1.8554 |Global loss: 5.8031| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0583
Epoch: 3|  Loss:  1.8575 |Global loss: 5.7992| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.166
Epoch: 0|  Loss:  2.9176 |Global loss: 5.883| Local H loss: 0.0162  | Global H loss: 0.0162
Epoch: 1|  NKD Loss: 1.1838
Epoch: 1|  Loss:  2.941 |Global loss: 5.8594| Local H loss: 0.0164  | Global H loss: 0.0164
Epoch: 2|  NKD Loss: 1.19
Epoch: 2|  Loss:  2.9167 |Global loss: 5.8592| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 3|  NKD Loss: 1.1984
Epoch: 3|  Loss:  2.9326 |Global loss: 5.8561| Local H loss: 0.0167  | Global H loss: 0.0167
Epoch: 0|  NKD Loss: 1.0493
Epoch: 0|  Loss:  1.796 |Global loss: 5.831| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 1.0442
Epoch: 1|  Loss:  1.7968 |Global loss: 5.8259| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 1.0451
Epoch: 2|  Loss:  1.7956 |Global loss: 5.8262| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 1.0341
Epoch: 3|  Loss:  1.7689 |Global loss: 5.83| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 1.0311
Epoch: 0|  Loss:  1.8122 |Global loss: 5.8157| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.0577
Epoch: 1|  Loss:  1.8294 |Global loss: 5.8091| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0302
Epoch: 2|  Loss:  1.8115 |Global loss: 5.8115| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0501
Epoch: 3|  Loss:  1.8305 |Global loss: 5.8069| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.084
Epoch: 0|  Loss:  2.0534 |Global loss: 5.8472| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.094
Epoch: 1|  Loss:  2.0669 |Global loss: 5.8422| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.0895
Epoch: 2|  Loss:  2.026 |Global loss: 5.8344| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.0849
Epoch: 3|  Loss:  2.0131 |Global loss: 5.8426| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.0193
Epoch: 0|  Loss:  1.5289 |Global loss: 5.8162| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0184
Epoch: 1|  Loss:  1.5219 |Global loss: 5.8162| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 1.0202
Epoch: 2|  Loss:  1.5183 |Global loss: 5.8183| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 1.0005
Epoch: 3|  Loss:  1.4994 |Global loss: 5.8249| Local H loss: 0.0331  | Global H loss: 0.0331
------------------------- time cost ------------------------- 2.9575438499450684
Chosen Clients:  [7, 3, 13, 6, 11, 0]

-------------Round number: 215-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.55, 0.583, 0.833, 0.417, 0.592, 0.283, 0.692, 0.833, 0.608, 0.783, 0.05, 0.358, 0.717]
AUC in each clients:  [114.239, 113.401, 114.084, 113.372, 117.436, 113.387, 113.215, 112.051, 115.193, 117.121, 114.673, 116.267, 105.29, 110.256, 115.005]
F1 Score:  [0.566, 0.507, 0.576, 0.574, 0.761, 0.396, 0.593, 0.285, 0.617, 0.764, 0.634, 0.755, 0.008, 0.354, 0.708]
Recall Score:  [0.617, 0.569, 0.642, 0.628, 0.81, 0.445, 0.654, 0.337, 0.662, 0.817, 0.677, 0.81, 0.083, 0.417, 0.75]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8973
Averaged Test Accurancy: 0.5611
Averaged Test AUC: 0.9472
Averaged Test F1_score: 0.5399
Averaged Test Recal score: 0.5945
Std Test Accurancy: 0.2072
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.126
Epoch: 0|  Loss:  2.2065 |Global loss: 5.8636| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.1217
Epoch: 1|  Loss:  2.2026 |Global loss: 5.8632| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 1.1365
Epoch: 2|  Loss:  2.1822 |Global loss: 5.8407| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 1.1239
Epoch: 3|  Loss:  2.179 |Global loss: 5.8488| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.0458
Epoch: 0|  Loss:  1.847 |Global loss: 5.8044| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 1.046
Epoch: 1|  Loss:  1.8444 |Global loss: 5.8037| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 1.0361
Epoch: 2|  Loss:  1.8337 |Global loss: 5.8073| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.057
Epoch: 3|  Loss:  1.8433 |Global loss: 5.7958| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.0724
Epoch: 0|  Loss:  2.13 |Global loss: 5.8517| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 1.0831
Epoch: 1|  Loss:  2.1181 |Global loss: 5.834| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 1.1129
Epoch: 2|  Loss:  2.145 |Global loss: 5.8291| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0786
Epoch: 3|  Loss:  2.1046 |Global loss: 5.8496| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.065
Epoch: 0|  Loss:  1.8385 |Global loss: 5.7973| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0278
Epoch: 1|  Loss:  1.8165 |Global loss: 5.8162| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.0558
Epoch: 2|  Loss:  1.8199 |Global loss: 5.7987| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0469
Epoch: 3|  Loss:  1.806 |Global loss: 5.7996| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9882
Epoch: 0|  Loss:  1.4877 |Global loss: 5.772| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.0033
Epoch: 1|  Loss:  1.4963 |Global loss: 5.7661| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.9771
Epoch: 2|  Loss:  1.4703 |Global loss: 5.7779| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.9877
Epoch: 3|  Loss:  1.4756 |Global loss: 5.7645| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.0411
Epoch: 0|  Loss:  1.8378 |Global loss: 5.8055| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.0546
Epoch: 1|  Loss:  1.8593 |Global loss: 5.7915| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 1.0288
Epoch: 2|  Loss:  1.8312 |Global loss: 5.8113| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0281
Epoch: 3|  Loss:  1.8184 |Global loss: 5.8081| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 2.7008297443389893
Chosen Clients:  [6, 9, 4, 13, 2, 10]

-------------Round number: 216-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.55, 0.617, 0.833, 0.417, 0.592, 0.375, 0.692, 0.833, 0.608, 0.808, 0.05, 0.358, 0.717]
AUC in each clients:  [114.26, 113.401, 114.084, 113.686, 117.436, 113.387, 113.275, 112.505, 115.193, 117.121, 114.673, 116.441, 105.29, 110.253, 115.005]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.761, 0.396, 0.593, 0.335, 0.617, 0.764, 0.634, 0.803, 0.008, 0.348, 0.708]
Recall Score:  [0.617, 0.569, 0.642, 0.65, 0.81, 0.445, 0.654, 0.398, 0.662, 0.817, 0.677, 0.841, 0.083, 0.417, 0.75]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8927
Averaged Test Accurancy: 0.5711
Averaged Test AUC: 0.9478
Averaged Test F1_score: 0.5467
Averaged Test Recal score: 0.6021
Std Test Accurancy: 0.2024
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0316
Epoch: 0|  Loss:  1.7928 |Global loss: 5.8128| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0248
Epoch: 1|  Loss:  1.7893 |Global loss: 5.8202| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0413
Epoch: 2|  Loss:  1.7926 |Global loss: 5.8053| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0375
Epoch: 3|  Loss:  1.7961 |Global loss: 5.8118| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.0386
Epoch: 0|  Loss:  1.5224 |Global loss: 5.7947| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 1.0098
Epoch: 1|  Loss:  1.5012 |Global loss: 5.8161| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0195
Epoch: 2|  Loss:  1.5033 |Global loss: 5.8052| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 1.0048
Epoch: 3|  Loss:  1.4614 |Global loss: 5.8159| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.0164
Epoch: 0|  Loss:  1.5705 |Global loss: 5.7587| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0025
Epoch: 1|  Loss:  1.5695 |Global loss: 5.7745| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 1.0048
Epoch: 2|  Loss:  1.555 |Global loss: 5.7686| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0033
Epoch: 3|  Loss:  1.5658 |Global loss: 5.7675| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.0843
Epoch: 0|  Loss:  2.0929 |Global loss: 5.8357| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 1.0863
Epoch: 1|  Loss:  2.1119 |Global loss: 5.8325| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 1.0899
Epoch: 2|  Loss:  2.096 |Global loss: 5.8374| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 1.1084
Epoch: 3|  Loss:  2.1004 |Global loss: 5.8201| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.0592
Epoch: 0|  Loss:  1.778 |Global loss: 5.8111| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 1.056
Epoch: 1|  Loss:  1.8181 |Global loss: 5.8259| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.0503
Epoch: 2|  Loss:  1.777 |Global loss: 5.8241| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0575
Epoch: 3|  Loss:  1.7887 |Global loss: 5.8262| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.109
Epoch: 0|  Loss:  1.8564 |Global loss: 5.8554| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0913
Epoch: 1|  Loss:  1.8346 |Global loss: 5.8589| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 1.0726
Epoch: 2|  Loss:  1.8204 |Global loss: 5.8769| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 1.0596
Epoch: 3|  Loss:  1.8106 |Global loss: 5.8893| Local H loss: 0.0324  | Global H loss: 0.0324
------------------------- time cost ------------------------- 2.9180452823638916
Chosen Clients:  [2, 13, 6, 7, 4, 9]

-------------Round number: 217-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.458, 0.617, 0.833, 0.417, 0.617, 0.375, 0.692, 0.833, 0.625, 0.808, 0.05, 0.358, 0.717]
AUC in each clients:  [114.26, 113.401, 113.669, 113.686, 117.382, 113.387, 113.423, 112.505, 115.193, 117.233, 114.935, 116.441, 105.29, 110.359, 115.005]
F1 Score:  [0.562, 0.507, 0.502, 0.588, 0.761, 0.396, 0.631, 0.335, 0.617, 0.764, 0.651, 0.803, 0.008, 0.354, 0.708]
Recall Score:  [0.617, 0.569, 0.564, 0.65, 0.81, 0.445, 0.685, 0.398, 0.662, 0.817, 0.698, 0.841, 0.083, 0.417, 0.75]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8769
Averaged Test Accurancy: 0.5678
Averaged Test AUC: 0.9479
Averaged Test F1_score: 0.5458
Averaged Test Recal score: 0.6004
Std Test Accurancy: 0.2049
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0635
Epoch: 0|  Loss:  1.7967 |Global loss: 5.8137| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 1.0342
Epoch: 1|  Loss:  1.7553 |Global loss: 5.8352| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 1.0315
Epoch: 2|  Loss:  1.7634 |Global loss: 5.8307| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 1.0456
Epoch: 3|  Loss:  1.7678 |Global loss: 5.8243| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.0893
Epoch: 0|  Loss:  2.076 |Global loss: 5.8354| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 1.0596
Epoch: 1|  Loss:  2.0616 |Global loss: 5.8498| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 1.06
Epoch: 2|  Loss:  2.0461 |Global loss: 5.8476| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 1.0625
Epoch: 3|  Loss:  2.0577 |Global loss: 5.8468| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 1.0396
Epoch: 0|  Loss:  1.7854 |Global loss: 5.8107| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0327
Epoch: 1|  Loss:  1.7834 |Global loss: 5.8116| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0463
Epoch: 2|  Loss:  1.7997 |Global loss: 5.7977| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0355
Epoch: 3|  Loss:  1.7609 |Global loss: 5.809| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.12
Epoch: 0|  Loss:  2.1486 |Global loss: 5.8626| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 1.1065
Epoch: 1|  Loss:  2.1561 |Global loss: 5.8613| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.1112
Epoch: 2|  Loss:  2.1474 |Global loss: 5.8601| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 1.109
Epoch: 3|  Loss:  2.1389 |Global loss: 5.8544| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 0.9772
Epoch: 0|  Loss:  1.5451 |Global loss: 5.7959| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9757
Epoch: 1|  Loss:  1.5298 |Global loss: 5.7853| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.0055
Epoch: 2|  Loss:  1.5632 |Global loss: 5.7685| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9859
Epoch: 3|  Loss:  1.5186 |Global loss: 5.7788| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.0181
Epoch: 0|  Loss:  1.4939 |Global loss: 5.8088| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 1.0006
Epoch: 1|  Loss:  1.4638 |Global loss: 5.815| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9988
Epoch: 2|  Loss:  1.4658 |Global loss: 5.8245| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9786
Epoch: 3|  Loss:  1.4492 |Global loss: 5.8345| Local H loss: 0.0333  | Global H loss: 0.0333
------------------------- time cost ------------------------- 3.0309853553771973
Chosen Clients:  [14, 2, 5, 6, 7, 12]

-------------Round number: 218-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.55, 0.617, 0.833, 0.417, 0.617, 0.375, 0.692, 0.875, 0.625, 0.808, 0.05, 0.467, 0.717]
AUC in each clients:  [114.26, 113.401, 114.23, 113.686, 117.417, 113.387, 113.427, 112.764, 115.193, 117.493, 114.935, 116.441, 105.29, 111.025, 115.005]
F1 Score:  [0.562, 0.507, 0.57, 0.588, 0.761, 0.396, 0.631, 0.335, 0.617, 0.827, 0.651, 0.803, 0.008, 0.471, 0.708]
Recall Score:  [0.617, 0.569, 0.641, 0.65, 0.81, 0.445, 0.685, 0.398, 0.662, 0.859, 0.698, 0.841, 0.083, 0.525, 0.75]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8706
Averaged Test Accurancy: 0.5839
Averaged Test AUC: 0.9489
Averaged Test F1_score: 0.5623
Averaged Test Recal score: 0.6155
Std Test Accurancy: 0.2008
Std Test AUC: 0.0236
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0724
Epoch: 0|  Loss:  1.7637 |Global loss: 5.8366| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 1.0485
Epoch: 1|  Loss:  1.7207 |Global loss: 5.8446| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 1.0706
Epoch: 2|  Loss:  1.7313 |Global loss: 5.8348| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0538
Epoch: 3|  Loss:  1.7155 |Global loss: 5.8368| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 1.05
Epoch: 0|  Loss:  1.7612 |Global loss: 5.8236| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 1.0355
Epoch: 1|  Loss:  1.7591 |Global loss: 5.8372| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 1.0368
Epoch: 2|  Loss:  1.7431 |Global loss: 5.8296| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 1.0421
Epoch: 3|  Loss:  1.7495 |Global loss: 5.8267| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.0718
Epoch: 0|  Loss:  1.9725 |Global loss: 5.8403| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 1.0839
Epoch: 1|  Loss:  1.9895 |Global loss: 5.8326| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 1.0733
Epoch: 2|  Loss:  1.9806 |Global loss: 5.8433| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 1.0925
Epoch: 3|  Loss:  1.991 |Global loss: 5.8271| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 1.0284
Epoch: 0|  Loss:  1.7753 |Global loss: 5.8072| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0236
Epoch: 1|  Loss:  1.7591 |Global loss: 5.8124| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.0197
Epoch: 2|  Loss:  1.7675 |Global loss: 5.8213| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0395
Epoch: 3|  Loss:  1.7639 |Global loss: 5.8078| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 1.1143
Epoch: 0|  Loss:  2.1136 |Global loss: 5.8595| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 1.1083
Epoch: 1|  Loss:  2.1061 |Global loss: 5.8555| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 1.1181
Epoch: 2|  Loss:  2.1107 |Global loss: 5.8519| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.1163
Epoch: 3|  Loss:  2.1072 |Global loss: 5.856| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.1439
Epoch: 0|  Loss:  2.9012 |Global loss: 5.8982| Local H loss: 0.0165  | Global H loss: 0.0165
Epoch: 1|  NKD Loss: 1.1861
Epoch: 1|  Loss:  2.9122 |Global loss: 5.8696| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 2|  NKD Loss: 1.1821
Epoch: 2|  Loss:  2.8983 |Global loss: 5.8713| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 3|  NKD Loss: 1.1937
Epoch: 3|  Loss:  2.9038 |Global loss: 5.858| Local H loss: 0.017  | Global H loss: 0.017
------------------------- time cost ------------------------- 2.9031522274017334
Chosen Clients:  [2, 12, 3, 6, 14, 8]

-------------Round number: 219-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.558, 0.617, 0.833, 0.492, 0.617, 0.383, 0.692, 0.875, 0.625, 0.808, 0.05, 0.467, 0.808]
AUC in each clients:  [114.26, 113.401, 114.668, 113.686, 117.417, 113.788, 113.682, 112.698, 115.193, 117.493, 114.935, 116.441, 105.239, 111.025, 115.038]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.761, 0.47, 0.631, 0.34, 0.617, 0.827, 0.651, 0.803, 0.008, 0.471, 0.767]
Recall Score:  [0.617, 0.569, 0.65, 0.65, 0.81, 0.5, 0.685, 0.407, 0.662, 0.859, 0.698, 0.841, 0.083, 0.525, 0.812]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8611
Averaged Test Accurancy: 0.5961
Averaged Test AUC: 0.9494
Averaged Test F1_score: 0.5719
Averaged Test Recal score: 0.6245
Std Test Accurancy: 0.2019
Std Test AUC: 0.0237
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0597
Epoch: 0|  Loss:  1.7584 |Global loss: 5.8238| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 1.0505
Epoch: 1|  Loss:  1.742 |Global loss: 5.8189| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 1.0341
Epoch: 2|  Loss:  1.725 |Global loss: 5.8315| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0381
Epoch: 3|  Loss:  1.7399 |Global loss: 5.8434| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.1561
Epoch: 0|  Loss:  2.8748 |Global loss: 5.8889| Local H loss: 0.0168  | Global H loss: 0.0168
Epoch: 1|  NKD Loss: 1.1755
Epoch: 1|  Loss:  2.8858 |Global loss: 5.877| Local H loss: 0.0169  | Global H loss: 0.0169
Epoch: 2|  NKD Loss: 1.187
Epoch: 2|  Loss:  2.8938 |Global loss: 5.8638| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 3|  NKD Loss: 1.1924
Epoch: 3|  Loss:  2.8973 |Global loss: 5.8679| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 0|  NKD Loss: 1.0439
Epoch: 0|  Loss:  1.8188 |Global loss: 5.8073| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0522
Epoch: 1|  Loss:  1.8223 |Global loss: 5.8008| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 1.0518
Epoch: 2|  Loss:  1.8207 |Global loss: 5.7959| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 1.0545
Epoch: 3|  Loss:  1.825 |Global loss: 5.7969| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 1.0415
Epoch: 0|  Loss:  1.7676 |Global loss: 5.8016| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.0162
Epoch: 1|  Loss:  1.7416 |Global loss: 5.8116| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0413
Epoch: 2|  Loss:  1.7569 |Global loss: 5.8| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.0295
Epoch: 3|  Loss:  1.7501 |Global loss: 5.7996| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.061
Epoch: 0|  Loss:  1.7267 |Global loss: 5.8273| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.0449
Epoch: 1|  Loss:  1.6883 |Global loss: 5.8578| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 1.0515
Epoch: 2|  Loss:  1.6806 |Global loss: 5.8359| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0342
Epoch: 3|  Loss:  1.6864 |Global loss: 5.848| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0707
Epoch: 0|  Loss:  1.7473 |Global loss: 5.8504| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 1.0709
Epoch: 1|  Loss:  1.747 |Global loss: 5.8478| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0648
Epoch: 2|  Loss:  1.7278 |Global loss: 5.85| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 1.0481
Epoch: 3|  Loss:  1.7159 |Global loss: 5.8503| Local H loss: 0.0336  | Global H loss: 0.0336
------------------------- time cost ------------------------- 2.879084348678589
Chosen Clients:  [1, 8, 7, 14, 9, 4]

-------------Round number: 220-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.558, 0.617, 0.833, 0.492, 0.617, 0.383, 0.692, 0.875, 0.625, 0.808, 0.05, 0.467, 0.858]
AUC in each clients:  [114.26, 113.401, 114.522, 113.572, 117.417, 113.788, 113.942, 112.698, 115.341, 117.493, 114.935, 116.441, 105.604, 111.025, 115.342]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.761, 0.47, 0.631, 0.34, 0.617, 0.827, 0.651, 0.803, 0.008, 0.471, 0.836]
Recall Score:  [0.617, 0.569, 0.65, 0.65, 0.81, 0.5, 0.685, 0.407, 0.662, 0.859, 0.698, 0.841, 0.083, 0.525, 0.869]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8559
Averaged Test Accurancy: 0.5994
Averaged Test AUC: 0.9499
Averaged Test F1_score: 0.5765
Averaged Test Recal score: 0.6283
Std Test Accurancy: 0.2058
Std Test AUC: 0.0232
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0784
Epoch: 0|  Loss:  2.0214 |Global loss: 5.8475| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 1.0923
Epoch: 1|  Loss:  2.0446 |Global loss: 5.837| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0757
Epoch: 2|  Loss:  2.0049 |Global loss: 5.8453| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 1.0997
Epoch: 3|  Loss:  2.0365 |Global loss: 5.835| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0685
Epoch: 0|  Loss:  1.7275 |Global loss: 5.8376| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 1.0595
Epoch: 1|  Loss:  1.7082 |Global loss: 5.8492| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 1.0529
Epoch: 2|  Loss:  1.7088 |Global loss: 5.8481| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 1.0641
Epoch: 3|  Loss:  1.7179 |Global loss: 5.8463| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 1.0935
Epoch: 0|  Loss:  2.0794 |Global loss: 5.8606| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 1.1047
Epoch: 1|  Loss:  2.067 |Global loss: 5.8502| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 1.1012
Epoch: 2|  Loss:  2.0629 |Global loss: 5.8498| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 1.1028
Epoch: 3|  Loss:  2.0586 |Global loss: 5.85| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.0466
Epoch: 0|  Loss:  1.6837 |Global loss: 5.8501| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.03
Epoch: 1|  Loss:  1.6685 |Global loss: 5.8423| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 1.0304
Epoch: 2|  Loss:  1.6341 |Global loss: 5.8515| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0573
Epoch: 3|  Loss:  1.674 |Global loss: 5.8319| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.0263
Epoch: 0|  Loss:  1.4806 |Global loss: 5.7983| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 1.0146
Epoch: 1|  Loss:  1.4686 |Global loss: 5.8042| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 1.0026
Epoch: 2|  Loss:  1.4556 |Global loss: 5.8133| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9831
Epoch: 3|  Loss:  1.428 |Global loss: 5.8259| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.9885
Epoch: 0|  Loss:  1.5476 |Global loss: 5.7779| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9942
Epoch: 1|  Loss:  1.5398 |Global loss: 5.7737| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9678
Epoch: 2|  Loss:  1.5094 |Global loss: 5.7867| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9817
Epoch: 3|  Loss:  1.5312 |Global loss: 5.7748| Local H loss: 0.0309  | Global H loss: 0.0309
------------------------- time cost ------------------------- 3.0594871044158936
Chosen Clients:  [12, 6, 11, 14, 4, 3]

-------------Round number: 221-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.558, 0.617, 0.833, 0.492, 0.617, 0.383, 0.692, 0.858, 0.625, 0.808, 0.05, 0.467, 0.875]
AUC in each clients:  [114.26, 113.423, 114.522, 113.572, 117.72, 113.788, 113.942, 112.968, 115.491, 117.515, 114.935, 116.441, 105.604, 111.025, 115.359]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.761, 0.47, 0.631, 0.34, 0.612, 0.807, 0.651, 0.803, 0.008, 0.471, 0.859]
Recall Score:  [0.617, 0.569, 0.65, 0.65, 0.81, 0.5, 0.685, 0.407, 0.662, 0.842, 0.698, 0.841, 0.083, 0.525, 0.895]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8417
Averaged Test Accurancy: 0.5994
Averaged Test AUC: 0.9503
Averaged Test F1_score: 0.5764
Averaged Test Recal score: 0.6289
Std Test Accurancy: 0.2058
Std Test AUC: 0.0234
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.1527
Epoch: 0|  Loss:  2.8621 |Global loss: 5.901| Local H loss: 0.017  | Global H loss: 0.017
Epoch: 1|  NKD Loss: 1.1734
Epoch: 1|  Loss:  2.8646 |Global loss: 5.8794| Local H loss: 0.0172  | Global H loss: 0.0172
Epoch: 2|  NKD Loss: 1.1754
Epoch: 2|  Loss:  2.8518 |Global loss: 5.8875| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 3|  NKD Loss: 1.1784
Epoch: 3|  Loss:  2.8893 |Global loss: 5.8755| Local H loss: 0.0173  | Global H loss: 0.0173
Epoch: 0|  NKD Loss: 1.0368
Epoch: 0|  Loss:  1.7601 |Global loss: 5.8112| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.0492
Epoch: 1|  Loss:  1.7608 |Global loss: 5.7982| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.0264
Epoch: 2|  Loss:  1.7363 |Global loss: 5.8113| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.0374
Epoch: 3|  Loss:  1.7404 |Global loss: 5.7951| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9765
Epoch: 0|  Loss:  1.4579 |Global loss: 5.7782| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.9611
Epoch: 1|  Loss:  1.4422 |Global loss: 5.7861| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.9888
Epoch: 2|  Loss:  1.4563 |Global loss: 5.768| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9616
Epoch: 3|  Loss:  1.4461 |Global loss: 5.7846| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 1.0309
Epoch: 0|  Loss:  1.6317 |Global loss: 5.8385| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.0239
Epoch: 1|  Loss:  1.6267 |Global loss: 5.8523| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 1.025
Epoch: 2|  Loss:  1.6257 |Global loss: 5.8492| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 1.0212
Epoch: 3|  Loss:  1.608 |Global loss: 5.8527| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.0018
Epoch: 0|  Loss:  1.5552 |Global loss: 5.7665| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9829
Epoch: 1|  Loss:  1.5239 |Global loss: 5.7749| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.9835
Epoch: 2|  Loss:  1.5289 |Global loss: 5.7715| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.9564
Epoch: 3|  Loss:  1.5031 |Global loss: 5.7909| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.028
Epoch: 0|  Loss:  1.7902 |Global loss: 5.804| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 1.044
Epoch: 1|  Loss:  1.7916 |Global loss: 5.8082| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 1.0124
Epoch: 2|  Loss:  1.7693 |Global loss: 5.8152| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 1.0308
Epoch: 3|  Loss:  1.776 |Global loss: 5.8063| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 3.1262543201446533
Chosen Clients:  [3, 2, 7, 14, 11, 9]

-------------Round number: 222-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.558, 0.617, 0.842, 0.492, 0.617, 0.383, 0.692, 0.858, 0.625, 0.85, 0.058, 0.467, 0.883]
AUC in each clients:  [114.26, 113.423, 114.522, 113.846, 117.63, 113.788, 113.858, 112.968, 115.491, 117.515, 114.935, 116.702, 105.406, 111.025, 115.623]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.766, 0.47, 0.631, 0.34, 0.612, 0.807, 0.651, 0.846, 0.021, 0.471, 0.859]
Recall Score:  [0.617, 0.569, 0.65, 0.65, 0.817, 0.5, 0.685, 0.407, 0.662, 0.842, 0.698, 0.894, 0.09, 0.525, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8363
Averaged Test Accurancy: 0.6039
Averaged Test AUC: 0.9506
Averaged Test F1_score: 0.5805
Averaged Test Recal score: 0.6337
Std Test Accurancy: 0.2087
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0429
Epoch: 0|  Loss:  1.7918 |Global loss: 5.8014| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 1.0284
Epoch: 1|  Loss:  1.7649 |Global loss: 5.8085| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 1.0367
Epoch: 2|  Loss:  1.7519 |Global loss: 5.8034| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 1.0471
Epoch: 3|  Loss:  1.7675 |Global loss: 5.7904| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 1.054
Epoch: 0|  Loss:  1.7414 |Global loss: 5.8147| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0416
Epoch: 1|  Loss:  1.7505 |Global loss: 5.8409| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.0509
Epoch: 2|  Loss:  1.7295 |Global loss: 5.8225| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 1.0346
Epoch: 3|  Loss:  1.725 |Global loss: 5.8291| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 1.0587
Epoch: 0|  Loss:  2.0095 |Global loss: 5.8695| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 1.1128
Epoch: 1|  Loss:  2.0399 |Global loss: 5.8534| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 1.1067
Epoch: 2|  Loss:  2.0377 |Global loss: 5.8423| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 1.0857
Epoch: 3|  Loss:  2.0052 |Global loss: 5.8551| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 1.0406
Epoch: 0|  Loss:  1.6331 |Global loss: 5.8288| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 1.0511
Epoch: 1|  Loss:  1.6308 |Global loss: 5.8298| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 1.0057
Epoch: 2|  Loss:  1.5945 |Global loss: 5.8497| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 1.0207
Epoch: 3|  Loss:  1.5957 |Global loss: 5.8486| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.9674
Epoch: 0|  Loss:  1.4428 |Global loss: 5.7848| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.9861
Epoch: 1|  Loss:  1.4376 |Global loss: 5.7696| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.9891
Epoch: 2|  Loss:  1.452 |Global loss: 5.7641| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.974
Epoch: 3|  Loss:  1.4361 |Global loss: 5.7694| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.007
Epoch: 0|  Loss:  1.4547 |Global loss: 5.8081| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 1.0116
Epoch: 1|  Loss:  1.4557 |Global loss: 5.8007| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.9976
Epoch: 2|  Loss:  1.4403 |Global loss: 5.8093| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9756
Epoch: 3|  Loss:  1.4253 |Global loss: 5.834| Local H loss: 0.0332  | Global H loss: 0.0332
------------------------- time cost ------------------------- 2.7421553134918213
Chosen Clients:  [1, 3, 0, 14, 10, 11]

-------------Round number: 223-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.583, 0.533, 0.558, 0.617, 0.842, 0.492, 0.617, 0.383, 0.692, 0.858, 0.625, 0.85, 0.058, 0.467, 0.875]
AUC in each clients:  [114.26, 113.423, 114.666, 114.014, 117.63, 113.788, 113.858, 113.78, 115.491, 117.581, 114.935, 116.858, 105.406, 111.025, 115.873]
F1 Score:  [0.562, 0.507, 0.576, 0.588, 0.766, 0.47, 0.631, 0.34, 0.612, 0.807, 0.651, 0.846, 0.021, 0.471, 0.859]
Recall Score:  [0.617, 0.569, 0.65, 0.65, 0.817, 0.5, 0.685, 0.407, 0.662, 0.842, 0.698, 0.894, 0.09, 0.525, 0.895]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8238
Averaged Test Accurancy: 0.6033
Averaged Test AUC: 0.9514
Averaged Test F1_score: 0.5805
Averaged Test Recal score: 0.6334
Std Test Accurancy: 0.2080
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0922
Epoch: 0|  Loss:  1.9999 |Global loss: 5.8341| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.0408
Epoch: 1|  Loss:  1.9601 |Global loss: 5.8594| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0831
Epoch: 2|  Loss:  1.9809 |Global loss: 5.8387| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.0735
Epoch: 3|  Loss:  1.9723 |Global loss: 5.842| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9774
Epoch: 0|  Loss:  1.6994 |Global loss: 5.8413| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 1.0259
Epoch: 1|  Loss:  1.734 |Global loss: 5.8166| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 1.0151
Epoch: 2|  Loss:  1.7118 |Global loss: 5.8185| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 1.0235
Epoch: 3|  Loss:  1.7365 |Global loss: 5.8071| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 1.029
Epoch: 0|  Loss:  1.8217 |Global loss: 5.8105| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0332
Epoch: 1|  Loss:  1.8439 |Global loss: 5.8068| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0323
Epoch: 2|  Loss:  1.8295 |Global loss: 5.8007| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0443
Epoch: 3|  Loss:  1.8311 |Global loss: 5.7971| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.0388
Epoch: 0|  Loss:  1.6131 |Global loss: 5.84| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0132
Epoch: 1|  Loss:  1.5958 |Global loss: 5.8464| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 1.0231
Epoch: 2|  Loss:  1.588 |Global loss: 5.8398| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0025
Epoch: 3|  Loss:  1.574 |Global loss: 5.849| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.0666
Epoch: 0|  Loss:  1.8065 |Global loss: 5.876| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 1.0706
Epoch: 1|  Loss:  1.8145 |Global loss: 5.8801| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 1.0689
Epoch: 2|  Loss:  1.8093 |Global loss: 5.8786| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.0689
Epoch: 3|  Loss:  1.7898 |Global loss: 5.8773| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9804
Epoch: 0|  Loss:  1.4399 |Global loss: 5.7725| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 0.9737
Epoch: 1|  Loss:  1.4366 |Global loss: 5.7752| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.9844
Epoch: 2|  Loss:  1.4384 |Global loss: 5.766| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9666
Epoch: 3|  Loss:  1.4173 |Global loss: 5.7821| Local H loss: 0.0319  | Global H loss: 0.0319
------------------------- time cost ------------------------- 2.9419467449188232
Chosen Clients:  [0, 14, 8, 2, 3, 5]

-------------Round number: 224-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.492, 0.617, 0.383, 0.692, 0.858, 0.617, 0.85, 0.058, 0.467, 0.883]
AUC in each clients:  [114.34, 113.768, 114.666, 113.961, 117.63, 113.788, 113.858, 113.78, 115.491, 117.581, 114.87, 116.801, 105.406, 111.025, 116.07]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.47, 0.631, 0.34, 0.612, 0.807, 0.643, 0.846, 0.021, 0.471, 0.859]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.5, 0.685, 0.407, 0.662, 0.842, 0.687, 0.894, 0.09, 0.525, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8098
Averaged Test Accurancy: 0.6044
Averaged Test AUC: 0.9517
Averaged Test F1_score: 0.5807
Averaged Test Recal score: 0.6341
Std Test Accurancy: 0.2086
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0291
Epoch: 0|  Loss:  1.7971 |Global loss: 5.8047| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0207
Epoch: 1|  Loss:  1.802 |Global loss: 5.8125| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.017
Epoch: 2|  Loss:  1.7886 |Global loss: 5.8166| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0259
Epoch: 3|  Loss:  1.7947 |Global loss: 5.8088| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.0333
Epoch: 0|  Loss:  1.5902 |Global loss: 5.8269| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 1.0181
Epoch: 1|  Loss:  1.5634 |Global loss: 5.8436| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0169
Epoch: 2|  Loss:  1.5782 |Global loss: 5.8398| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.006
Epoch: 3|  Loss:  1.5475 |Global loss: 5.8435| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0351
Epoch: 0|  Loss:  1.6864 |Global loss: 5.8622| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 1.0325
Epoch: 1|  Loss:  1.6806 |Global loss: 5.861| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0437
Epoch: 2|  Loss:  1.6734 |Global loss: 5.8523| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 1.0292
Epoch: 3|  Loss:  1.6717 |Global loss: 5.8681| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 1.0451
Epoch: 0|  Loss:  1.732 |Global loss: 5.835| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.039
Epoch: 1|  Loss:  1.7137 |Global loss: 5.8281| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 1.0356
Epoch: 2|  Loss:  1.7014 |Global loss: 5.8284| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 1.0211
Epoch: 3|  Loss:  1.684 |Global loss: 5.8375| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 1.0168
Epoch: 0|  Loss:  1.7173 |Global loss: 5.8151| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 1.0165
Epoch: 1|  Loss:  1.7119 |Global loss: 5.8127| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 1.0256
Epoch: 2|  Loss:  1.7241 |Global loss: 5.8066| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 1.0121
Epoch: 3|  Loss:  1.6969 |Global loss: 5.8136| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 1.055
Epoch: 0|  Loss:  1.9412 |Global loss: 5.8457| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 1.0628
Epoch: 1|  Loss:  1.933 |Global loss: 5.8489| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 1.0707
Epoch: 2|  Loss:  1.9591 |Global loss: 5.8382| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 1.0485
Epoch: 3|  Loss:  1.9115 |Global loss: 5.849| Local H loss: 0.0245  | Global H loss: 0.0245
------------------------- time cost ------------------------- 2.7098278999328613
Chosen Clients:  [3, 6, 9, 1, 11, 13]

-------------Round number: 225-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.442, 0.617, 0.383, 0.692, 0.858, 0.617, 0.85, 0.058, 0.467, 0.883]
AUC in each clients:  [114.389, 113.768, 114.777, 114.211, 117.63, 113.692, 113.858, 113.78, 115.542, 117.581, 114.87, 116.801, 105.406, 111.025, 116.181]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.422, 0.631, 0.34, 0.612, 0.807, 0.643, 0.846, 0.021, 0.471, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.467, 0.685, 0.407, 0.662, 0.842, 0.687, 0.894, 0.09, 0.525, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.8014
Averaged Test Accurancy: 0.6011
Averaged Test AUC: 0.9520
Averaged Test F1_score: 0.5774
Averaged Test Recal score: 0.6319
Std Test Accurancy: 0.2108
Std Test AUC: 0.0240
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0201
Epoch: 0|  Loss:  1.7054 |Global loss: 5.8084| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 1.0139
Epoch: 1|  Loss:  1.6959 |Global loss: 5.8113| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 1.0101
Epoch: 2|  Loss:  1.6919 |Global loss: 5.8184| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 1.0318
Epoch: 3|  Loss:  1.6953 |Global loss: 5.7997| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.0265
Epoch: 0|  Loss:  1.7481 |Global loss: 5.8077| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.0093
Epoch: 1|  Loss:  1.7128 |Global loss: 5.8232| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0209
Epoch: 2|  Loss:  1.7195 |Global loss: 5.8087| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.0199
Epoch: 3|  Loss:  1.7102 |Global loss: 5.8088| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9881
Epoch: 0|  Loss:  1.424 |Global loss: 5.8151| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9747
Epoch: 1|  Loss:  1.3969 |Global loss: 5.8264| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.9899
Epoch: 2|  Loss:  1.4196 |Global loss: 5.8152| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.9915
Epoch: 3|  Loss:  1.4242 |Global loss: 5.8099| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.0618
Epoch: 0|  Loss:  1.96 |Global loss: 5.8519| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 1.0787
Epoch: 1|  Loss:  1.974 |Global loss: 5.8332| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0686
Epoch: 2|  Loss:  1.9549 |Global loss: 5.847| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.0547
Epoch: 3|  Loss:  1.933 |Global loss: 5.8539| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9891
Epoch: 0|  Loss:  1.4394 |Global loss: 5.7628| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.9724
Epoch: 1|  Loss:  1.4221 |Global loss: 5.7682| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.9687
Epoch: 2|  Loss:  1.4133 |Global loss: 5.7767| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.9674
Epoch: 3|  Loss:  1.4023 |Global loss: 5.7771| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 1.0684
Epoch: 0|  Loss:  2.028 |Global loss: 5.8534| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 1.0646
Epoch: 1|  Loss:  2.0376 |Global loss: 5.8413| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 1.0597
Epoch: 2|  Loss:  2.027 |Global loss: 5.8411| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.0752
Epoch: 3|  Loss:  2.0264 |Global loss: 5.8313| Local H loss: 0.0316  | Global H loss: 0.0316
------------------------- time cost ------------------------- 3.065593957901001
Chosen Clients:  [14, 13, 5, 2, 1, 6]

-------------Round number: 226-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.442, 0.75, 0.383, 0.692, 0.9, 0.617, 0.85, 0.058, 0.483, 0.883]
AUC in each clients:  [114.389, 114.213, 114.777, 114.258, 117.63, 113.692, 114.315, 113.78, 115.542, 117.67, 114.87, 116.874, 105.406, 111.176, 116.181]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.422, 0.73, 0.34, 0.612, 0.851, 0.643, 0.846, 0.021, 0.483, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.467, 0.779, 0.407, 0.662, 0.884, 0.687, 0.894, 0.09, 0.539, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7939
Averaged Test Accurancy: 0.6139
Averaged Test AUC: 0.9527
Averaged Test F1_score: 0.5877
Averaged Test Recal score: 0.6419
Std Test Accurancy: 0.2168
Std Test AUC: 0.0240
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0332
Epoch: 0|  Loss:  1.5822 |Global loss: 5.8266| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 1.0251
Epoch: 1|  Loss:  1.5712 |Global loss: 5.8278| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0297
Epoch: 2|  Loss:  1.5717 |Global loss: 5.8294| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 1.0008
Epoch: 3|  Loss:  1.5383 |Global loss: 5.8416| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0692
Epoch: 0|  Loss:  2.0175 |Global loss: 5.8393| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 1.0815
Epoch: 1|  Loss:  2.0034 |Global loss: 5.8375| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 1.0707
Epoch: 2|  Loss:  2.016 |Global loss: 5.8307| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 1.0727
Epoch: 3|  Loss:  1.984 |Global loss: 5.8319| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 0|  NKD Loss: 1.0483
Epoch: 0|  Loss:  1.9265 |Global loss: 5.8614| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 1.061
Epoch: 1|  Loss:  1.9323 |Global loss: 5.8438| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 1.0725
Epoch: 2|  Loss:  1.9432 |Global loss: 5.8424| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 1.0787
Epoch: 3|  Loss:  1.9338 |Global loss: 5.8339| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 1.0394
Epoch: 0|  Loss:  1.6985 |Global loss: 5.8248| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 1.0289
Epoch: 1|  Loss:  1.7038 |Global loss: 5.8398| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 1.0139
Epoch: 2|  Loss:  1.6723 |Global loss: 5.8398| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 1.0422
Epoch: 3|  Loss:  1.6953 |Global loss: 5.8282| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0789
Epoch: 0|  Loss:  1.9431 |Global loss: 5.8326| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 1.0758
Epoch: 1|  Loss:  1.9451 |Global loss: 5.8433| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.0653
Epoch: 2|  Loss:  1.9333 |Global loss: 5.8423| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.0753
Epoch: 3|  Loss:  1.931 |Global loss: 5.8425| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.0002
Epoch: 0|  Loss:  1.6819 |Global loss: 5.8273| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 1.0136
Epoch: 1|  Loss:  1.7122 |Global loss: 5.8148| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0343
Epoch: 2|  Loss:  1.7122 |Global loss: 5.8006| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 1.0358
Epoch: 3|  Loss:  1.7275 |Global loss: 5.7973| Local H loss: 0.0288  | Global H loss: 0.0288
------------------------- time cost ------------------------- 2.8211240768432617
Chosen Clients:  [5, 14, 12, 10, 6, 1]

-------------Round number: 227-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.508, 0.742, 0.383, 0.692, 0.9, 0.617, 0.85, 0.058, 0.45, 0.883]
AUC in each clients:  [114.389, 114.105, 114.905, 114.258, 117.63, 113.805, 114.485, 113.78, 115.542, 117.67, 114.87, 116.874, 105.406, 111.014, 116.363]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.505, 0.721, 0.34, 0.612, 0.851, 0.643, 0.846, 0.021, 0.463, 0.859]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.53, 0.769, 0.407, 0.662, 0.884, 0.687, 0.894, 0.09, 0.512, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7934
Averaged Test Accurancy: 0.6156
Averaged Test AUC: 0.9528
Averaged Test F1_score: 0.5915
Averaged Test Recal score: 0.6437
Std Test Accurancy: 0.2151
Std Test AUC: 0.0242
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0524
Epoch: 0|  Loss:  1.9186 |Global loss: 5.8518| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 1.0779
Epoch: 1|  Loss:  1.9155 |Global loss: 5.8294| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.0791
Epoch: 2|  Loss:  1.9133 |Global loss: 5.8245| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.0634
Epoch: 3|  Loss:  1.8929 |Global loss: 5.8436| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.0294
Epoch: 0|  Loss:  1.5722 |Global loss: 5.8236| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0289
Epoch: 1|  Loss:  1.5429 |Global loss: 5.8209| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 1.0232
Epoch: 2|  Loss:  1.5557 |Global loss: 5.8227| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 1.0201
Epoch: 3|  Loss:  1.5476 |Global loss: 5.8286| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.1684
Epoch: 0|  Loss:  2.8451 |Global loss: 5.9021| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 1|  NKD Loss: 1.1594
Epoch: 1|  Loss:  2.8304 |Global loss: 5.8923| Local H loss: 0.0174  | Global H loss: 0.0174
Epoch: 2|  NKD Loss: 1.1958
Epoch: 2|  Loss:  2.8496 |Global loss: 5.8676| Local H loss: 0.0177  | Global H loss: 0.0177
Epoch: 3|  NKD Loss: 1.1825
Epoch: 3|  Loss:  2.8522 |Global loss: 5.8871| Local H loss: 0.0176  | Global H loss: 0.0176
Epoch: 0|  NKD Loss: 1.0676
Epoch: 0|  Loss:  1.8029 |Global loss: 5.8777| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 1.0767
Epoch: 1|  Loss:  1.7852 |Global loss: 5.8694| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0594
Epoch: 2|  Loss:  1.7903 |Global loss: 5.8833| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 1.0648
Epoch: 3|  Loss:  1.7813 |Global loss: 5.8782| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.005
Epoch: 0|  Loss:  1.6984 |Global loss: 5.8191| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.0344
Epoch: 1|  Loss:  1.7146 |Global loss: 5.8009| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.0158
Epoch: 2|  Loss:  1.6859 |Global loss: 5.8172| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 1.0245
Epoch: 3|  Loss:  1.693 |Global loss: 5.8003| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0483
Epoch: 0|  Loss:  1.9067 |Global loss: 5.8524| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.0635
Epoch: 1|  Loss:  1.9107 |Global loss: 5.8476| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.0731
Epoch: 2|  Loss:  1.9199 |Global loss: 5.8433| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.0699
Epoch: 3|  Loss:  1.9121 |Global loss: 5.8397| Local H loss: 0.0274  | Global H loss: 0.0274
------------------------- time cost ------------------------- 3.031689167022705
Chosen Clients:  [11, 1, 6, 12, 10, 4]

-------------Round number: 228-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.575, 0.717, 0.383, 0.692, 0.9, 0.608, 0.85, 0.058, 0.45, 0.883]
AUC in each clients:  [114.389, 114.297, 114.905, 114.258, 117.63, 114.095, 114.429, 113.78, 115.542, 117.67, 115.064, 116.874, 105.688, 111.014, 116.442]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.556, 0.715, 0.34, 0.612, 0.851, 0.634, 0.846, 0.021, 0.463, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.579, 0.757, 0.407, 0.662, 0.884, 0.677, 0.894, 0.09, 0.512, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7873
Averaged Test Accurancy: 0.6178
Averaged Test AUC: 0.9534
Averaged Test F1_score: 0.5937
Averaged Test Recal score: 0.6455
Std Test Accurancy: 0.2127
Std Test AUC: 0.0237
Std Test F1: 0.0018
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 0.9783
Epoch: 0|  Loss:  1.4152 |Global loss: 5.7606| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.983
Epoch: 1|  Loss:  1.4166 |Global loss: 5.7696| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.9563
Epoch: 2|  Loss:  1.373 |Global loss: 5.7784| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.9654
Epoch: 3|  Loss:  1.3887 |Global loss: 5.7754| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 1.0495
Epoch: 0|  Loss:  1.8888 |Global loss: 5.8559| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 1.0616
Epoch: 1|  Loss:  1.9013 |Global loss: 5.8471| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.0798
Epoch: 2|  Loss:  1.8995 |Global loss: 5.8303| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0599
Epoch: 3|  Loss:  1.8845 |Global loss: 5.8474| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.0231
Epoch: 0|  Loss:  1.7009 |Global loss: 5.8038| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 1.0201
Epoch: 1|  Loss:  1.6901 |Global loss: 5.8077| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 1.0266
Epoch: 2|  Loss:  1.6959 |Global loss: 5.8064| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 1.0248
Epoch: 3|  Loss:  1.6894 |Global loss: 5.8013| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.1362
Epoch: 0|  Loss:  2.8119 |Global loss: 5.9136| Local H loss: 0.0175  | Global H loss: 0.0175
Epoch: 1|  NKD Loss: 1.181
Epoch: 1|  Loss:  2.8151 |Global loss: 5.8823| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 1.1646
Epoch: 2|  Loss:  2.7965 |Global loss: 5.8937| Local H loss: 0.0178  | Global H loss: 0.0178
Epoch: 3|  NKD Loss: 1.185
Epoch: 3|  Loss:  2.8148 |Global loss: 5.8681| Local H loss: 0.0179  | Global H loss: 0.0179
Epoch: 0|  NKD Loss: 1.0647
Epoch: 0|  Loss:  1.7756 |Global loss: 5.8729| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0757
Epoch: 1|  Loss:  1.7781 |Global loss: 5.8692| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 1.0659
Epoch: 2|  Loss:  1.7593 |Global loss: 5.8708| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 1.0407
Epoch: 3|  Loss:  1.7393 |Global loss: 5.8892| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.981
Epoch: 0|  Loss:  1.5172 |Global loss: 5.7744| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.979
Epoch: 1|  Loss:  1.5138 |Global loss: 5.7737| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.9825
Epoch: 2|  Loss:  1.5373 |Global loss: 5.7701| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.9874
Epoch: 3|  Loss:  1.5104 |Global loss: 5.7684| Local H loss: 0.0309  | Global H loss: 0.0309
------------------------- time cost ------------------------- 3.04357647895813
Chosen Clients:  [10, 13, 12, 9, 8, 4]

-------------Round number: 229-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.833, 0.575, 0.75, 0.383, 0.692, 0.9, 0.667, 0.85, 0.1, 0.45, 0.883]
AUC in each clients:  [114.389, 114.52, 114.905, 114.258, 117.75, 114.095, 114.643, 113.78, 115.542, 117.67, 115.286, 116.941, 105.654, 111.014, 116.442]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.761, 0.556, 0.73, 0.34, 0.612, 0.851, 0.712, 0.846, 0.064, 0.463, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.81, 0.579, 0.779, 0.407, 0.662, 0.884, 0.744, 0.894, 0.125, 0.512, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7811
Averaged Test Accurancy: 0.6261
Averaged Test AUC: 0.9538
Averaged Test F1_score: 0.6025
Averaged Test Recal score: 0.6533
Std Test Accurancy: 0.2064
Std Test AUC: 0.0239
Std Test F1: 0.0017
Std Test Recall: 0.0017
Epoch: 0|  NKD Loss: 1.0827
Epoch: 0|  Loss:  1.7751 |Global loss: 5.858| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 1.0598
Epoch: 1|  Loss:  1.7475 |Global loss: 5.8728| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 1.0591
Epoch: 2|  Loss:  1.7384 |Global loss: 5.8766| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 1.0398
Epoch: 3|  Loss:  1.7234 |Global loss: 5.8908| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 1.072
Epoch: 0|  Loss:  2.0036 |Global loss: 5.832| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 1|  NKD Loss: 1.0612
Epoch: 1|  Loss:  1.9897 |Global loss: 5.8401| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 1.0663
Epoch: 2|  Loss:  1.9724 |Global loss: 5.8343| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 1.0693
Epoch: 3|  Loss:  1.9791 |Global loss: 5.8313| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 1.1524
Epoch: 0|  Loss:  2.7968 |Global loss: 5.9066| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 1|  NKD Loss: 1.1583
Epoch: 1|  Loss:  2.7931 |Global loss: 5.896| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 2|  NKD Loss: 1.1722
Epoch: 2|  Loss:  2.8039 |Global loss: 5.8953| Local H loss: 0.018  | Global H loss: 0.018
Epoch: 3|  NKD Loss: 1.188
Epoch: 3|  Loss:  2.7919 |Global loss: 5.8902| Local H loss: 0.0183  | Global H loss: 0.0183
Epoch: 0|  NKD Loss: 0.9874
Epoch: 0|  Loss:  1.4139 |Global loss: 5.8102| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.9938
Epoch: 1|  Loss:  1.4167 |Global loss: 5.8085| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.9547
Epoch: 2|  Loss:  1.3723 |Global loss: 5.8351| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9883
Epoch: 3|  Loss:  1.3988 |Global loss: 5.8062| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 1.0549
Epoch: 0|  Loss:  1.6846 |Global loss: 5.8406| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 1.056
Epoch: 1|  Loss:  1.677 |Global loss: 5.8487| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 1.0136
Epoch: 2|  Loss:  1.6433 |Global loss: 5.8596| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 1.0263
Epoch: 3|  Loss:  1.6428 |Global loss: 5.8666| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.9969
Epoch: 0|  Loss:  1.552 |Global loss: 5.7621| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9721
Epoch: 1|  Loss:  1.4952 |Global loss: 5.7743| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9639
Epoch: 2|  Loss:  1.4925 |Global loss: 5.7751| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9871
Epoch: 3|  Loss:  1.5234 |Global loss: 5.7632| Local H loss: 0.0304  | Global H loss: 0.0304
------------------------- time cost ------------------------- 3.1031670570373535
Chosen Clients:  [11, 8, 12, 0, 1, 2]

-------------Round number: 230-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.575, 0.75, 0.383, 0.692, 0.917, 0.675, 0.85, 0.1, 0.583, 0.883]
AUC in each clients:  [114.389, 114.52, 114.905, 114.258, 117.796, 114.095, 114.643, 113.78, 115.536, 117.738, 115.37, 116.941, 105.824, 111.504, 116.442]
F1 Score:  [0.574, 0.507, 0.576, 0.588, 0.766, 0.556, 0.73, 0.34, 0.617, 0.864, 0.719, 0.846, 0.064, 0.605, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.579, 0.779, 0.407, 0.662, 0.9, 0.753, 0.894, 0.125, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7694
Averaged Test Accurancy: 0.6372
Averaged Test AUC: 0.9543
Averaged Test F1_score: 0.6139
Averaged Test Recal score: 0.6633
Std Test Accurancy: 0.2036
Std Test AUC: 0.0234
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9597
Epoch: 0|  Loss:  1.3796 |Global loss: 5.7826| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.9404
Epoch: 1|  Loss:  1.3662 |Global loss: 5.7835| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.388 |Global loss: 5.7708| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.9226
Epoch: 3|  Loss:  1.3258 |Global loss: 5.8062| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 1.0602
Epoch: 0|  Loss:  1.6716 |Global loss: 5.8311| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 1.0527
Epoch: 1|  Loss:  1.6704 |Global loss: 5.8389| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 1.0407
Epoch: 2|  Loss:  1.6431 |Global loss: 5.8438| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 1.0234
Epoch: 3|  Loss:  1.6175 |Global loss: 5.8563| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 1.1657
Epoch: 0|  Loss:  2.7899 |Global loss: 5.8941| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 1|  NKD Loss: 1.1701
Epoch: 1|  Loss:  2.7653 |Global loss: 5.9012| Local H loss: 0.0182  | Global H loss: 0.0182
Epoch: 2|  NKD Loss: 1.1651
Epoch: 2|  Loss:  2.7739 |Global loss: 5.8953| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 3|  NKD Loss: 1.1622
Epoch: 3|  Loss:  2.7579 |Global loss: 5.892| Local H loss: 0.0184  | Global H loss: 0.0184
Epoch: 0|  NKD Loss: 1.0257
Epoch: 0|  Loss:  1.7779 |Global loss: 5.8023| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0138
Epoch: 1|  Loss:  1.7664 |Global loss: 5.8076| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0258
Epoch: 2|  Loss:  1.781 |Global loss: 5.8024| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.029
Epoch: 3|  Loss:  1.7974 |Global loss: 5.7992| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0516
Epoch: 0|  Loss:  1.8695 |Global loss: 5.8524| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 1.0707
Epoch: 1|  Loss:  1.8793 |Global loss: 5.8365| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.07
Epoch: 2|  Loss:  1.8748 |Global loss: 5.8372| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 1.0641
Epoch: 3|  Loss:  1.8764 |Global loss: 5.8444| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.0231
Epoch: 0|  Loss:  1.6505 |Global loss: 5.8352| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 1.0384
Epoch: 1|  Loss:  1.6902 |Global loss: 5.8337| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 1.0092
Epoch: 2|  Loss:  1.6472 |Global loss: 5.8425| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 3|  NKD Loss: 1.0231
Epoch: 3|  Loss:  1.6685 |Global loss: 5.8369| Local H loss: 0.0327  | Global H loss: 0.0327
------------------------- time cost ------------------------- 2.9096500873565674
Chosen Clients:  [3, 12, 8, 9, 11, 1]

-------------Round number: 231-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.575, 0.75, 0.383, 0.692, 0.917, 0.675, 0.85, 0.108, 0.583, 0.883]
AUC in each clients:  [114.439, 114.385, 115.007, 114.258, 117.796, 114.095, 114.643, 113.78, 115.937, 117.738, 115.37, 117.005, 106.089, 111.504, 116.442]
F1 Score:  [0.569, 0.507, 0.576, 0.588, 0.766, 0.556, 0.73, 0.34, 0.612, 0.864, 0.719, 0.846, 0.07, 0.605, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.579, 0.779, 0.407, 0.662, 0.9, 0.753, 0.894, 0.132, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7651
Averaged Test Accurancy: 0.6378
Averaged Test AUC: 0.9547
Averaged Test F1_score: 0.6137
Averaged Test Recal score: 0.6638
Std Test Accurancy: 0.2021
Std Test AUC: 0.0231
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9961
Epoch: 0|  Loss:  1.6726 |Global loss: 5.816| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 1.0205
Epoch: 1|  Loss:  1.6769 |Global loss: 5.8046| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 1.0019
Epoch: 2|  Loss:  1.6591 |Global loss: 5.8187| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 1.0131
Epoch: 3|  Loss:  1.6664 |Global loss: 5.8034| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 1.1689
Epoch: 0|  Loss:  2.7493 |Global loss: 5.889| Local H loss: 0.0186  | Global H loss: 0.0186
Epoch: 1|  NKD Loss: 1.1525
Epoch: 1|  Loss:  2.7451 |Global loss: 5.9022| Local H loss: 0.0185  | Global H loss: 0.0185
Epoch: 2|  NKD Loss: 1.1839
Epoch: 2|  Loss:  2.7548 |Global loss: 5.8776| Local H loss: 0.019  | Global H loss: 0.019
Epoch: 3|  NKD Loss: 1.1756
Epoch: 3|  Loss:  2.7405 |Global loss: 5.8832| Local H loss: 0.0189  | Global H loss: 0.0189
Epoch: 0|  NKD Loss: 1.0531
Epoch: 0|  Loss:  1.647 |Global loss: 5.831| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 1.0338
Epoch: 1|  Loss:  1.6305 |Global loss: 5.8374| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 1.0296
Epoch: 2|  Loss:  1.6255 |Global loss: 5.8511| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 1.0424
Epoch: 3|  Loss:  1.629 |Global loss: 5.8355| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9899
Epoch: 0|  Loss:  1.3937 |Global loss: 5.8024| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 0.9874
Epoch: 1|  Loss:  1.3997 |Global loss: 5.813| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.9857
Epoch: 2|  Loss:  1.3913 |Global loss: 5.8073| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.9673
Epoch: 3|  Loss:  1.3747 |Global loss: 5.822| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9706
Epoch: 0|  Loss:  1.3733 |Global loss: 5.7655| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.978
Epoch: 1|  Loss:  1.3859 |Global loss: 5.7664| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 2|  NKD Loss: 0.9697
Epoch: 2|  Loss:  1.3732 |Global loss: 5.7713| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.9605
Epoch: 3|  Loss:  1.3743 |Global loss: 5.7719| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 1.058
Epoch: 0|  Loss:  1.8594 |Global loss: 5.843| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.0493
Epoch: 1|  Loss:  1.8369 |Global loss: 5.8458| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.0506
Epoch: 2|  Loss:  1.8439 |Global loss: 5.8476| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 1.0519
Epoch: 3|  Loss:  1.8471 |Global loss: 5.8401| Local H loss: 0.0276  | Global H loss: 0.0276
------------------------- time cost ------------------------- 2.884841203689575
Chosen Clients:  [1, 7, 11, 8, 14, 0]

-------------Round number: 232-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.575, 0.75, 0.383, 0.692, 0.917, 0.675, 0.85, 0.108, 0.583, 0.883]
AUC in each clients:  [114.439, 114.888, 115.007, 114.253, 117.796, 114.095, 114.643, 113.78, 116.045, 117.742, 115.37, 117.118, 106.262, 111.504, 116.442]
F1 Score:  [0.569, 0.507, 0.576, 0.588, 0.766, 0.556, 0.73, 0.34, 0.612, 0.864, 0.719, 0.846, 0.07, 0.605, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.579, 0.779, 0.407, 0.662, 0.9, 0.753, 0.894, 0.132, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7551
Averaged Test Accurancy: 0.6378
Averaged Test AUC: 0.9552
Averaged Test F1_score: 0.6137
Averaged Test Recal score: 0.6638
Std Test Accurancy: 0.2021
Std Test AUC: 0.0229
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0624
Epoch: 0|  Loss:  1.8341 |Global loss: 5.8369| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.055
Epoch: 1|  Loss:  1.8211 |Global loss: 5.8455| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.0494
Epoch: 2|  Loss:  1.823 |Global loss: 5.8411| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 1.0649
Epoch: 3|  Loss:  1.8329 |Global loss: 5.8361| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.0911
Epoch: 0|  Loss:  2.0073 |Global loss: 5.8576| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 1.0832
Epoch: 1|  Loss:  1.9877 |Global loss: 5.8534| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 1.0843
Epoch: 2|  Loss:  1.9953 |Global loss: 5.8527| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 1.0765
Epoch: 3|  Loss:  1.976 |Global loss: 5.8651| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9692
Epoch: 0|  Loss:  1.3646 |Global loss: 5.768| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.9584
Epoch: 1|  Loss:  1.3721 |Global loss: 5.7708| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.3385 |Global loss: 5.7826| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.9629
Epoch: 3|  Loss:  1.3543 |Global loss: 5.766| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.0239
Epoch: 0|  Loss:  1.6099 |Global loss: 5.8491| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 1.0324
Epoch: 1|  Loss:  1.6207 |Global loss: 5.8426| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 1.0221
Epoch: 2|  Loss:  1.5982 |Global loss: 5.8498| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0171
Epoch: 3|  Loss:  1.5939 |Global loss: 5.8488| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 1.0302
Epoch: 0|  Loss:  1.5399 |Global loss: 5.8108| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 1.0047
Epoch: 1|  Loss:  1.5258 |Global loss: 5.8321| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 1.0088
Epoch: 2|  Loss:  1.5177 |Global loss: 5.8378| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9998
Epoch: 3|  Loss:  1.5061 |Global loss: 5.8275| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0349
Epoch: 0|  Loss:  1.7866 |Global loss: 5.8007| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0299
Epoch: 1|  Loss:  1.7926 |Global loss: 5.7998| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0253
Epoch: 2|  Loss:  1.7633 |Global loss: 5.802| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.031
Epoch: 3|  Loss:  1.7659 |Global loss: 5.7915| Local H loss: 0.0282  | Global H loss: 0.0282
------------------------- time cost ------------------------- 2.971128463745117
Chosen Clients:  [5, 3, 10, 8, 4, 0]

-------------Round number: 233-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.6, 0.533, 0.558, 0.617, 0.842, 0.575, 0.75, 0.383, 0.692, 0.917, 0.675, 0.85, 0.108, 0.583, 0.883]
AUC in each clients:  [114.639, 114.858, 115.007, 114.253, 117.796, 114.095, 114.643, 113.82, 116.37, 117.742, 115.37, 117.148, 106.262, 111.504, 116.688]
F1 Score:  [0.569, 0.507, 0.576, 0.588, 0.766, 0.556, 0.73, 0.34, 0.612, 0.864, 0.719, 0.846, 0.07, 0.605, 0.857]
Recall Score:  [0.634, 0.569, 0.65, 0.65, 0.817, 0.579, 0.779, 0.407, 0.662, 0.9, 0.753, 0.894, 0.132, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7426
Averaged Test Accurancy: 0.6378
Averaged Test AUC: 0.9557
Averaged Test F1_score: 0.6137
Averaged Test Recal score: 0.6638
Std Test Accurancy: 0.2021
Std Test AUC: 0.0231
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0586
Epoch: 0|  Loss:  1.895 |Global loss: 5.8407| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 1.0766
Epoch: 1|  Loss:  1.9148 |Global loss: 5.8305| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 1.0566
Epoch: 2|  Loss:  1.8933 |Global loss: 5.8455| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 1.0526
Epoch: 3|  Loss:  1.8862 |Global loss: 5.8485| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 1.0188
Epoch: 0|  Loss:  1.6601 |Global loss: 5.8025| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 1.0074
Epoch: 1|  Loss:  1.6558 |Global loss: 5.8085| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 1.0298
Epoch: 2|  Loss:  1.6769 |Global loss: 5.795| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 1.0272
Epoch: 3|  Loss:  1.6514 |Global loss: 5.7932| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 1.0572
Epoch: 0|  Loss:  1.7357 |Global loss: 5.8745| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 1.0591
Epoch: 1|  Loss:  1.7265 |Global loss: 5.8652| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 1.0342
Epoch: 2|  Loss:  1.7047 |Global loss: 5.8907| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 1.0343
Epoch: 3|  Loss:  1.6958 |Global loss: 5.8881| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 1.0309
Epoch: 0|  Loss:  1.601 |Global loss: 5.8398| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 1.0481
Epoch: 1|  Loss:  1.6171 |Global loss: 5.8265| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 1.0296
Epoch: 2|  Loss:  1.5903 |Global loss: 5.8385| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0201
Epoch: 3|  Loss:  1.5851 |Global loss: 5.8413| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.975
Epoch: 0|  Loss:  1.4978 |Global loss: 5.7716| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.9641
Epoch: 1|  Loss:  1.5037 |Global loss: 5.7809| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.976
Epoch: 2|  Loss:  1.5082 |Global loss: 5.7686| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9773
Epoch: 3|  Loss:  1.5073 |Global loss: 5.7701| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0072
Epoch: 0|  Loss:  1.7316 |Global loss: 5.8128| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0171
Epoch: 1|  Loss:  1.7593 |Global loss: 5.7996| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0274
Epoch: 2|  Loss:  1.7654 |Global loss: 5.795| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0264
Epoch: 3|  Loss:  1.7483 |Global loss: 5.79| Local H loss: 0.0282  | Global H loss: 0.0282
------------------------- time cost ------------------------- 3.181053400039673
Chosen Clients:  [1, 14, 3, 2, 0, 10]

-------------Round number: 234-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.608, 0.533, 0.558, 0.617, 0.842, 0.658, 0.75, 0.383, 0.692, 0.917, 0.692, 0.85, 0.108, 0.583, 0.883]
AUC in each clients:  [114.727, 114.858, 115.007, 114.486, 117.741, 114.394, 114.643, 113.82, 116.46, 117.742, 115.402, 117.148, 106.262, 111.504, 116.688]
F1 Score:  [0.588, 0.507, 0.576, 0.588, 0.766, 0.624, 0.73, 0.34, 0.612, 0.864, 0.732, 0.846, 0.07, 0.605, 0.857]
Recall Score:  [0.644, 0.569, 0.65, 0.65, 0.817, 0.644, 0.779, 0.407, 0.662, 0.9, 0.772, 0.894, 0.132, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7360
Averaged Test Accurancy: 0.6450
Averaged Test AUC: 0.9560
Averaged Test F1_score: 0.6203
Averaged Test Recal score: 0.6701
Std Test Accurancy: 0.2015
Std Test AUC: 0.0230
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.071
Epoch: 0|  Loss:  1.8499 |Global loss: 5.8312| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 1.0322
Epoch: 1|  Loss:  1.7942 |Global loss: 5.851| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 1.0395
Epoch: 2|  Loss:  1.7965 |Global loss: 5.8501| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0483
Epoch: 3|  Loss:  1.8092 |Global loss: 5.8485| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.0202
Epoch: 0|  Loss:  1.527 |Global loss: 5.822| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 1.009
Epoch: 1|  Loss:  1.5147 |Global loss: 5.8283| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0078
Epoch: 2|  Loss:  1.5111 |Global loss: 5.8235| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 1.003
Epoch: 3|  Loss:  1.4917 |Global loss: 5.8279| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.0061
Epoch: 0|  Loss:  1.6498 |Global loss: 5.8008| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 1.014
Epoch: 1|  Loss:  1.6413 |Global loss: 5.7975| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 1.0109
Epoch: 2|  Loss:  1.6112 |Global loss: 5.8049| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 1.0022
Epoch: 3|  Loss:  1.6344 |Global loss: 5.8014| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 1.0505
Epoch: 0|  Loss:  1.6798 |Global loss: 5.821| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.0334
Epoch: 1|  Loss:  1.6699 |Global loss: 5.8336| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.9922
Epoch: 2|  Loss:  1.6089 |Global loss: 5.8511| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 1.0273
Epoch: 3|  Loss:  1.6456 |Global loss: 5.8323| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.9895
Epoch: 0|  Loss:  1.715 |Global loss: 5.818| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0294
Epoch: 1|  Loss:  1.7548 |Global loss: 5.7921| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9978
Epoch: 2|  Loss:  1.7278 |Global loss: 5.814| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0061
Epoch: 3|  Loss:  1.7152 |Global loss: 5.8048| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0714
Epoch: 0|  Loss:  1.722 |Global loss: 5.8609| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 1.0672
Epoch: 1|  Loss:  1.7155 |Global loss: 5.8557| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 1.0464
Epoch: 2|  Loss:  1.6914 |Global loss: 5.8744| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 1.0296
Epoch: 3|  Loss:  1.6767 |Global loss: 5.8837| Local H loss: 0.0345  | Global H loss: 0.0345
------------------------- time cost ------------------------- 3.0747663974761963
Chosen Clients:  [13, 6, 8, 12, 7, 14]

-------------Round number: 235-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.842, 0.658, 0.75, 0.383, 0.692, 0.917, 0.7, 0.85, 0.108, 0.583, 0.883]
AUC in each clients:  [114.818, 115.148, 115.039, 114.495, 117.741, 114.394, 114.643, 113.82, 116.46, 117.742, 115.429, 117.148, 106.262, 111.504, 116.685]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.766, 0.624, 0.73, 0.34, 0.612, 0.864, 0.737, 0.846, 0.07, 0.605, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.817, 0.644, 0.779, 0.407, 0.662, 0.9, 0.78, 0.894, 0.132, 0.631, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7298
Averaged Test Accurancy: 0.6461
Averaged Test AUC: 0.9563
Averaged Test F1_score: 0.6210
Averaged Test Recal score: 0.6712
Std Test Accurancy: 0.2016
Std Test AUC: 0.0230
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.041
Epoch: 0|  Loss:  1.9357 |Global loss: 5.8535| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 1.0519
Epoch: 1|  Loss:  1.9543 |Global loss: 5.8372| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 1.0568
Epoch: 2|  Loss:  1.9453 |Global loss: 5.8341| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.0502
Epoch: 3|  Loss:  1.9429 |Global loss: 5.8356| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 1.009
Epoch: 0|  Loss:  1.6664 |Global loss: 5.8172| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.0079
Epoch: 1|  Loss:  1.67 |Global loss: 5.8119| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 1.003
Epoch: 2|  Loss:  1.6528 |Global loss: 5.8178| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.9727
Epoch: 3|  Loss:  1.6236 |Global loss: 5.8393| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0113
Epoch: 0|  Loss:  1.5599 |Global loss: 5.8566| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 1.0237
Epoch: 1|  Loss:  1.5704 |Global loss: 5.837| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 1.0168
Epoch: 2|  Loss:  1.5756 |Global loss: 5.8426| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 1.0052
Epoch: 3|  Loss:  1.5527 |Global loss: 5.846| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 1.1438
Epoch: 0|  Loss:  2.7117 |Global loss: 5.9185| Local H loss: 0.0188  | Global H loss: 0.0188
Epoch: 1|  NKD Loss: 1.1617
Epoch: 1|  Loss:  2.7271 |Global loss: 5.8961| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 2|  NKD Loss: 1.1765
Epoch: 2|  Loss:  2.7214 |Global loss: 5.8963| Local H loss: 0.0192  | Global H loss: 0.0192
Epoch: 3|  NKD Loss: 1.17
Epoch: 3|  Loss:  2.7336 |Global loss: 5.88| Local H loss: 0.0193  | Global H loss: 0.0193
Epoch: 0|  NKD Loss: 1.0661
Epoch: 0|  Loss:  1.9506 |Global loss: 5.8616| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0604
Epoch: 1|  Loss:  1.9305 |Global loss: 5.8679| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 1.0697
Epoch: 2|  Loss:  1.9446 |Global loss: 5.8566| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 1.0885
Epoch: 3|  Loss:  1.9503 |Global loss: 5.8389| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 0.9962
Epoch: 0|  Loss:  1.4947 |Global loss: 5.8288| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 1.0014
Epoch: 1|  Loss:  1.4945 |Global loss: 5.8298| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9889
Epoch: 2|  Loss:  1.4692 |Global loss: 5.8342| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.994
Epoch: 3|  Loss:  1.4762 |Global loss: 5.8335| Local H loss: 0.0304  | Global H loss: 0.0304
------------------------- time cost ------------------------- 2.8180737495422363
Chosen Clients:  [0, 4, 9, 6, 1, 11]

-------------Round number: 236-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.842, 0.658, 0.75, 0.383, 0.692, 0.917, 0.7, 0.85, 0.125, 0.717, 0.883]
AUC in each clients:  [114.818, 115.148, 115.039, 114.495, 117.741, 114.394, 114.808, 114.342, 116.62, 117.742, 115.429, 117.148, 106.259, 111.992, 116.696]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.766, 0.624, 0.73, 0.34, 0.612, 0.864, 0.737, 0.846, 0.08, 0.723, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.817, 0.644, 0.779, 0.407, 0.662, 0.9, 0.78, 0.894, 0.146, 0.756, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7211
Averaged Test Accurancy: 0.6561
Averaged Test AUC: 0.9570
Averaged Test F1_score: 0.6295
Averaged Test Recal score: 0.6805
Std Test Accurancy: 0.1986
Std Test AUC: 0.0227
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9904
Epoch: 0|  Loss:  1.7189 |Global loss: 5.8139| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.0138
Epoch: 1|  Loss:  1.7169 |Global loss: 5.8016| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.017
Epoch: 2|  Loss:  1.7278 |Global loss: 5.8001| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0229
Epoch: 3|  Loss:  1.7151 |Global loss: 5.7888| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9791
Epoch: 0|  Loss:  1.4963 |Global loss: 5.7647| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9564
Epoch: 1|  Loss:  1.4672 |Global loss: 5.7762| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9871
Epoch: 2|  Loss:  1.5075 |Global loss: 5.7584| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9649
Epoch: 3|  Loss:  1.4828 |Global loss: 5.7696| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 0.9771
Epoch: 0|  Loss:  1.3755 |Global loss: 5.8091| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9837
Epoch: 1|  Loss:  1.3815 |Global loss: 5.8025| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.9648
Epoch: 2|  Loss:  1.3647 |Global loss: 5.8129| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.9455
Epoch: 3|  Loss:  1.3226 |Global loss: 5.8268| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.0117
Epoch: 0|  Loss:  1.6639 |Global loss: 5.8109| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.0055
Epoch: 1|  Loss:  1.6571 |Global loss: 5.8132| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.997
Epoch: 2|  Loss:  1.6436 |Global loss: 5.8151| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 1.0168
Epoch: 3|  Loss:  1.6624 |Global loss: 5.7993| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.0468
Epoch: 0|  Loss:  1.8048 |Global loss: 5.8495| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0413
Epoch: 1|  Loss:  1.7914 |Global loss: 5.8508| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0535
Epoch: 2|  Loss:  1.8073 |Global loss: 5.8427| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0564
Epoch: 3|  Loss:  1.785 |Global loss: 5.831| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9652
Epoch: 0|  Loss:  1.3555 |Global loss: 5.768| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.9571
Epoch: 1|  Loss:  1.349 |Global loss: 5.7719| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.9488
Epoch: 2|  Loss:  1.3441 |Global loss: 5.7781| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9494
Epoch: 3|  Loss:  1.3328 |Global loss: 5.778| Local H loss: 0.0315  | Global H loss: 0.0315
------------------------- time cost ------------------------- 3.0945096015930176
Chosen Clients:  [12, 4, 7, 0, 1, 10]

-------------Round number: 237-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.75, 0.383, 0.692, 0.917, 0.7, 0.85, 0.125, 0.717, 0.883]
AUC in each clients:  [114.948, 115.087, 115.039, 114.495, 117.955, 114.394, 114.964, 114.342, 116.62, 117.802, 115.429, 117.198, 106.259, 111.992, 116.696]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.73, 0.34, 0.612, 0.864, 0.737, 0.846, 0.08, 0.723, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.779, 0.407, 0.662, 0.9, 0.78, 0.894, 0.146, 0.756, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7181
Averaged Test Accurancy: 0.6556
Averaged Test AUC: 0.9573
Averaged Test F1_score: 0.6292
Averaged Test Recal score: 0.6800
Std Test Accurancy: 0.1981
Std Test AUC: 0.0229
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.1499
Epoch: 0|  Loss:  2.699 |Global loss: 5.9178| Local H loss: 0.0191  | Global H loss: 0.0191
Epoch: 1|  NKD Loss: 1.1652
Epoch: 1|  Loss:  2.6991 |Global loss: 5.8925| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 2|  NKD Loss: 1.1624
Epoch: 2|  Loss:  2.6969 |Global loss: 5.8922| Local H loss: 0.0195  | Global H loss: 0.0195
Epoch: 3|  NKD Loss: 1.1777
Epoch: 3|  Loss:  2.7027 |Global loss: 5.886| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 0|  NKD Loss: 0.973
Epoch: 0|  Loss:  1.5121 |Global loss: 5.7726| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 0.959
Epoch: 1|  Loss:  1.486 |Global loss: 5.778| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.9585
Epoch: 2|  Loss:  1.4793 |Global loss: 5.778| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.9701
Epoch: 3|  Loss:  1.4794 |Global loss: 5.7634| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.0687
Epoch: 0|  Loss:  1.9239 |Global loss: 5.8561| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 1.0702
Epoch: 1|  Loss:  1.9016 |Global loss: 5.852| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 1.0562
Epoch: 2|  Loss:  1.8957 |Global loss: 5.8569| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 3|  NKD Loss: 1.0668
Epoch: 3|  Loss:  1.8881 |Global loss: 5.8511| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.0081
Epoch: 0|  Loss:  1.714 |Global loss: 5.8042| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 1.0205
Epoch: 1|  Loss:  1.6936 |Global loss: 5.7883| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.0156
Epoch: 2|  Loss:  1.7087 |Global loss: 5.7884| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0224
Epoch: 3|  Loss:  1.7233 |Global loss: 5.7915| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 1.0566
Epoch: 0|  Loss:  1.8074 |Global loss: 5.8414| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.0385
Epoch: 1|  Loss:  1.7777 |Global loss: 5.8462| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 1.0425
Epoch: 2|  Loss:  1.7699 |Global loss: 5.8453| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0517
Epoch: 3|  Loss:  1.7721 |Global loss: 5.8363| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 1.0468
Epoch: 0|  Loss:  1.6848 |Global loss: 5.8689| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 1.0413
Epoch: 1|  Loss:  1.6793 |Global loss: 5.8802| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 1.032
Epoch: 2|  Loss:  1.6636 |Global loss: 5.8797| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.0189
Epoch: 3|  Loss:  1.6505 |Global loss: 5.8902| Local H loss: 0.0346  | Global H loss: 0.0346
------------------------- time cost ------------------------- 3.144134044647217
Chosen Clients:  [10, 14, 12, 6, 8, 4]

-------------Round number: 238-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.842, 0.658, 0.75, 0.383, 0.692, 0.917, 0.7, 0.85, 0.117, 0.717, 0.883]
AUC in each clients:  [115.044, 115.224, 115.039, 114.495, 117.953, 114.394, 114.964, 114.403, 116.62, 117.802, 115.455, 117.198, 106.614, 111.992, 116.696]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.766, 0.624, 0.73, 0.34, 0.612, 0.864, 0.737, 0.846, 0.075, 0.723, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.817, 0.644, 0.779, 0.407, 0.662, 0.9, 0.78, 0.894, 0.139, 0.756, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.7119
Averaged Test Accurancy: 0.6556
Averaged Test AUC: 0.9577
Averaged Test F1_score: 0.6292
Averaged Test Recal score: 0.6800
Std Test Accurancy: 0.2001
Std Test AUC: 0.0223
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0654
Epoch: 0|  Loss:  1.681 |Global loss: 5.8471| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 1.0519
Epoch: 1|  Loss:  1.6729 |Global loss: 5.8623| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 1.0488
Epoch: 2|  Loss:  1.6637 |Global loss: 5.8584| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 1.0368
Epoch: 3|  Loss:  1.6551 |Global loss: 5.8702| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.0064
Epoch: 0|  Loss:  1.5102 |Global loss: 5.8156| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 1.0007
Epoch: 1|  Loss:  1.4714 |Global loss: 5.8311| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.0037
Epoch: 2|  Loss:  1.4746 |Global loss: 5.821| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9912
Epoch: 3|  Loss:  1.4746 |Global loss: 5.8262| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.1633
Epoch: 0|  Loss:  2.6716 |Global loss: 5.9052| Local H loss: 0.0197  | Global H loss: 0.0197
Epoch: 1|  NKD Loss: 1.1572
Epoch: 1|  Loss:  2.6709 |Global loss: 5.8975| Local H loss: 0.0196  | Global H loss: 0.0196
Epoch: 2|  NKD Loss: 1.1553
Epoch: 2|  Loss:  2.6729 |Global loss: 5.8967| Local H loss: 0.0198  | Global H loss: 0.0198
Epoch: 3|  NKD Loss: 1.1647
Epoch: 3|  Loss:  2.6678 |Global loss: 5.8971| Local H loss: 0.02  | Global H loss: 0.02
Epoch: 0|  NKD Loss: 1.0062
Epoch: 0|  Loss:  1.6472 |Global loss: 5.8118| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 1.0174
Epoch: 1|  Loss:  1.6555 |Global loss: 5.8018| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.0144
Epoch: 2|  Loss:  1.6568 |Global loss: 5.8047| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 1.0118
Epoch: 3|  Loss:  1.6523 |Global loss: 5.8045| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.0147
Epoch: 0|  Loss:  1.5643 |Global loss: 5.8438| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 1.0116
Epoch: 1|  Loss:  1.5533 |Global loss: 5.8463| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 1.0191
Epoch: 2|  Loss:  1.5694 |Global loss: 5.8331| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 1.0119
Epoch: 3|  Loss:  1.5442 |Global loss: 5.8465| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9709
Epoch: 0|  Loss:  1.4797 |Global loss: 5.7686| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 0.9514
Epoch: 1|  Loss:  1.4741 |Global loss: 5.7758| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9622
Epoch: 2|  Loss:  1.4914 |Global loss: 5.7728| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9797
Epoch: 3|  Loss:  1.4958 |Global loss: 5.7585| Local H loss: 0.0298  | Global H loss: 0.0298
------------------------- time cost ------------------------- 2.7446696758270264
Chosen Clients:  [3, 12, 9, 10, 14, 2]

-------------Round number: 239-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.767, 0.383, 0.692, 0.917, 0.7, 0.85, 0.125, 0.717, 0.883]
AUC in each clients:  [115.044, 115.224, 115.039, 114.495, 117.942, 114.394, 115.332, 114.403, 116.484, 117.802, 115.471, 117.198, 106.864, 111.992, 116.856]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.745, 0.34, 0.617, 0.864, 0.737, 0.846, 0.08, 0.723, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.8, 0.407, 0.662, 0.9, 0.78, 0.894, 0.146, 0.756, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6997
Averaged Test Accurancy: 0.6567
Averaged Test AUC: 0.9581
Averaged Test F1_score: 0.6305
Averaged Test Recal score: 0.6814
Std Test Accurancy: 0.1986
Std Test AUC: 0.0219
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0018
Epoch: 0|  Loss:  1.6165 |Global loss: 5.8006| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.991
Epoch: 1|  Loss:  1.6093 |Global loss: 5.8104| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9948
Epoch: 2|  Loss:  1.6104 |Global loss: 5.8096| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9934
Epoch: 3|  Loss:  1.597 |Global loss: 5.8082| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 1.1541
Epoch: 0|  Loss:  2.654 |Global loss: 5.9021| Local H loss: 0.0201  | Global H loss: 0.0201
Epoch: 1|  NKD Loss: 1.142
Epoch: 1|  Loss:  2.6345 |Global loss: 5.9106| Local H loss: 0.0199  | Global H loss: 0.0199
Epoch: 2|  NKD Loss: 1.1605
Epoch: 2|  Loss:  2.6299 |Global loss: 5.901| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 3|  NKD Loss: 1.1607
Epoch: 3|  Loss:  2.6498 |Global loss: 5.8918| Local H loss: 0.0202  | Global H loss: 0.0202
Epoch: 0|  NKD Loss: 0.9939
Epoch: 0|  Loss:  1.3726 |Global loss: 5.7935| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.9607
Epoch: 1|  Loss:  1.3541 |Global loss: 5.8166| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.9603
Epoch: 2|  Loss:  1.3467 |Global loss: 5.8139| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.9867
Epoch: 3|  Loss:  1.3758 |Global loss: 5.7994| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 1.059
Epoch: 0|  Loss:  1.6617 |Global loss: 5.8509| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 1.0457
Epoch: 1|  Loss:  1.6591 |Global loss: 5.8623| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 1.0383
Epoch: 2|  Loss:  1.6488 |Global loss: 5.8686| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 1.038
Epoch: 3|  Loss:  1.6428 |Global loss: 5.8656| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 1.0075
Epoch: 0|  Loss:  1.4852 |Global loss: 5.8128| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.999
Epoch: 1|  Loss:  1.473 |Global loss: 5.8263| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9847
Epoch: 2|  Loss:  1.4554 |Global loss: 5.8275| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 1.0042
Epoch: 3|  Loss:  1.471 |Global loss: 5.8166| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 1.0519
Epoch: 0|  Loss:  1.6692 |Global loss: 5.8264| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0244
Epoch: 1|  Loss:  1.6373 |Global loss: 5.8376| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 1.021
Epoch: 2|  Loss:  1.6298 |Global loss: 5.8382| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.0312
Epoch: 3|  Loss:  1.6457 |Global loss: 5.8269| Local H loss: 0.0336  | Global H loss: 0.0336
------------------------- time cost ------------------------- 2.9392313957214355
Chosen Clients:  [8, 12, 13, 7, 6, 9]

-------------Round number: 240-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.767, 0.383, 0.692, 0.917, 0.7, 0.85, 0.15, 0.717, 0.883]
AUC in each clients:  [115.044, 115.224, 115.108, 114.698, 117.942, 114.394, 115.332, 114.403, 116.484, 117.806, 115.463, 117.198, 106.923, 111.992, 116.886]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.745, 0.34, 0.617, 0.864, 0.737, 0.846, 0.109, 0.723, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.8, 0.407, 0.662, 0.9, 0.78, 0.894, 0.172, 0.756, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6859
Averaged Test Accurancy: 0.6583
Averaged Test AUC: 0.9583
Averaged Test F1_score: 0.6325
Averaged Test Recal score: 0.6831
Std Test Accurancy: 0.1942
Std Test AUC: 0.0218
Std Test F1: 0.0016
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.033
Epoch: 0|  Loss:  1.5677 |Global loss: 5.8203| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 1.0164
Epoch: 1|  Loss:  1.538 |Global loss: 5.8314| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 1.0023
Epoch: 2|  Loss:  1.5332 |Global loss: 5.8436| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9874
Epoch: 3|  Loss:  1.5063 |Global loss: 5.8547| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 1.1438
Epoch: 0|  Loss:  2.6205 |Global loss: 5.9266| Local H loss: 0.0203  | Global H loss: 0.0203
Epoch: 1|  NKD Loss: 1.1483
Epoch: 1|  Loss:  2.6199 |Global loss: 5.9024| Local H loss: 0.0205  | Global H loss: 0.0205
Epoch: 2|  NKD Loss: 1.1556
Epoch: 2|  Loss:  2.6394 |Global loss: 5.9138| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 3|  NKD Loss: 1.1525
Epoch: 3|  Loss:  2.6136 |Global loss: 5.9044| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 0|  NKD Loss: 1.0499
Epoch: 0|  Loss:  1.9274 |Global loss: 5.8553| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 1.0385
Epoch: 1|  Loss:  1.9076 |Global loss: 5.8352| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 1.0285
Epoch: 2|  Loss:  1.8887 |Global loss: 5.8544| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 1.0518
Epoch: 3|  Loss:  1.9129 |Global loss: 5.8279| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.0665
Epoch: 0|  Loss:  1.8835 |Global loss: 5.8578| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0631
Epoch: 1|  Loss:  1.8754 |Global loss: 5.8458| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 1.0647
Epoch: 2|  Loss:  1.8481 |Global loss: 5.8427| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 1.0741
Epoch: 3|  Loss:  1.8477 |Global loss: 5.8357| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 1.0071
Epoch: 0|  Loss:  1.6523 |Global loss: 5.8191| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 1.0013
Epoch: 1|  Loss:  1.6278 |Global loss: 5.8086| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 1.0095
Epoch: 2|  Loss:  1.6361 |Global loss: 5.807| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 1.0069
Epoch: 3|  Loss:  1.6339 |Global loss: 5.8096| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9912
Epoch: 0|  Loss:  1.3758 |Global loss: 5.7891| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 0.9653
Epoch: 1|  Loss:  1.3467 |Global loss: 5.8077| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9495
Epoch: 2|  Loss:  1.3293 |Global loss: 5.8228| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9714
Epoch: 3|  Loss:  1.3493 |Global loss: 5.801| Local H loss: 0.0334  | Global H loss: 0.0334
------------------------- time cost ------------------------- 2.7565977573394775
Chosen Clients:  [6, 1, 9, 14, 0, 10]

-------------Round number: 241-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.758, 0.442, 0.717, 0.983, 0.7, 0.85, 0.133, 0.675, 0.883]
AUC in each clients:  [115.044, 115.224, 115.108, 114.698, 117.942, 114.394, 115.31, 114.367, 116.618, 117.898, 115.463, 117.198, 107.05, 111.87, 116.886]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.738, 0.424, 0.643, 0.981, 0.737, 0.846, 0.084, 0.678, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.789, 0.491, 0.69, 0.984, 0.78, 0.894, 0.153, 0.709, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6889
Averaged Test Accurancy: 0.6639
Averaged Test AUC: 0.9584
Averaged Test F1_score: 0.6425
Averaged Test Recal score: 0.6911
Std Test Accurancy: 0.1984
Std Test AUC: 0.0218
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0172
Epoch: 0|  Loss:  1.6299 |Global loss: 5.798| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.9782
Epoch: 1|  Loss:  1.5945 |Global loss: 5.8268| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 1.0217
Epoch: 2|  Loss:  1.6398 |Global loss: 5.7998| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.9997
Epoch: 3|  Loss:  1.6187 |Global loss: 5.8115| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 1.0312
Epoch: 0|  Loss:  1.7541 |Global loss: 5.8538| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 1.0368
Epoch: 1|  Loss:  1.7643 |Global loss: 5.835| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0334
Epoch: 2|  Loss:  1.7545 |Global loss: 5.8484| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.0575
Epoch: 3|  Loss:  1.7634 |Global loss: 5.8323| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9863
Epoch: 0|  Loss:  1.3636 |Global loss: 5.7888| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9762
Epoch: 1|  Loss:  1.3532 |Global loss: 5.7964| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9748
Epoch: 2|  Loss:  1.3439 |Global loss: 5.7944| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 3|  NKD Loss: 0.9668
Epoch: 3|  Loss:  1.3444 |Global loss: 5.803| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 0|  NKD Loss: 0.9874
Epoch: 0|  Loss:  1.4476 |Global loss: 5.8154| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9994
Epoch: 1|  Loss:  1.4595 |Global loss: 5.814| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.9916
Epoch: 2|  Loss:  1.4423 |Global loss: 5.8249| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 1.0073
Epoch: 3|  Loss:  1.4518 |Global loss: 5.8102| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 0.9842
Epoch: 0|  Loss:  1.6722 |Global loss: 5.8197| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.0047
Epoch: 1|  Loss:  1.6818 |Global loss: 5.7958| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.0028
Epoch: 2|  Loss:  1.697 |Global loss: 5.8024| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9796
Epoch: 3|  Loss:  1.6469 |Global loss: 5.8076| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.0466
Epoch: 0|  Loss:  1.6487 |Global loss: 5.8643| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 1.0351
Epoch: 1|  Loss:  1.6283 |Global loss: 5.8647| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 1.0088
Epoch: 2|  Loss:  1.6005 |Global loss: 5.8861| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 1.0159
Epoch: 3|  Loss:  1.6061 |Global loss: 5.8782| Local H loss: 0.0357  | Global H loss: 0.0357
------------------------- time cost ------------------------- 3.188108444213867
Chosen Clients:  [8, 2, 14, 9, 11, 7]

-------------Round number: 242-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.767, 0.442, 0.717, 0.983, 0.7, 0.85, 0.133, 0.675, 0.883]
AUC in each clients:  [115.049, 115.551, 115.108, 114.698, 117.942, 114.394, 115.427, 114.367, 116.618, 118.03, 115.49, 117.198, 107.05, 111.87, 116.914]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.745, 0.424, 0.643, 0.981, 0.737, 0.846, 0.084, 0.678, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.8, 0.491, 0.69, 0.984, 0.78, 0.894, 0.153, 0.709, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6791
Averaged Test Accurancy: 0.6644
Averaged Test AUC: 0.9587
Averaged Test F1_score: 0.6429
Averaged Test Recal score: 0.6918
Std Test Accurancy: 0.1986
Std Test AUC: 0.0219
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.997
Epoch: 0|  Loss:  1.5131 |Global loss: 5.8484| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0118
Epoch: 1|  Loss:  1.5291 |Global loss: 5.8319| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.9921
Epoch: 2|  Loss:  1.5048 |Global loss: 5.8502| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 1.0099
Epoch: 3|  Loss:  1.5254 |Global loss: 5.8333| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 1.0155
Epoch: 0|  Loss:  1.64 |Global loss: 5.8496| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 1.0224
Epoch: 1|  Loss:  1.6231 |Global loss: 5.8357| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 1.0143
Epoch: 2|  Loss:  1.632 |Global loss: 5.8522| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 1.0094
Epoch: 3|  Loss:  1.6214 |Global loss: 5.8534| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.9938
Epoch: 0|  Loss:  1.4547 |Global loss: 5.8153| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9757
Epoch: 1|  Loss:  1.4128 |Global loss: 5.8236| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9868
Epoch: 2|  Loss:  1.4466 |Global loss: 5.8186| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9869
Epoch: 3|  Loss:  1.4235 |Global loss: 5.8223| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.9721
Epoch: 0|  Loss:  1.3404 |Global loss: 5.7979| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.9586
Epoch: 1|  Loss:  1.321 |Global loss: 5.8048| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.9614
Epoch: 2|  Loss:  1.3263 |Global loss: 5.8022| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9532
Epoch: 3|  Loss:  1.3141 |Global loss: 5.8071| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.9459
Epoch: 0|  Loss:  1.3298 |Global loss: 5.7789| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9486
Epoch: 1|  Loss:  1.3369 |Global loss: 5.7806| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9411
Epoch: 2|  Loss:  1.3266 |Global loss: 5.7829| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9527
Epoch: 3|  Loss:  1.3152 |Global loss: 5.7714| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.0384
Epoch: 0|  Loss:  1.8272 |Global loss: 5.8578| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 1.0495
Epoch: 1|  Loss:  1.8164 |Global loss: 5.8514| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 1.0483
Epoch: 2|  Loss:  1.8072 |Global loss: 5.8525| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 1.0533
Epoch: 3|  Loss:  1.8039 |Global loss: 5.8422| Local H loss: 0.0346  | Global H loss: 0.0346
------------------------- time cost ------------------------- 2.7770845890045166
Chosen Clients:  [8, 9, 0, 1, 2, 13]

-------------Round number: 243-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.558, 0.617, 0.833, 0.658, 0.767, 0.442, 0.692, 0.983, 0.7, 0.85, 0.133, 0.675, 0.883]
AUC in each clients:  [115.049, 115.551, 115.133, 114.698, 117.942, 114.394, 115.427, 114.426, 116.67, 118.047, 115.49, 117.22, 107.05, 111.87, 117.008]
F1 Score:  [0.593, 0.507, 0.576, 0.588, 0.761, 0.624, 0.745, 0.424, 0.612, 0.981, 0.737, 0.846, 0.084, 0.678, 0.857]
Recall Score:  [0.653, 0.569, 0.65, 0.65, 0.81, 0.644, 0.8, 0.491, 0.662, 0.984, 0.78, 0.894, 0.153, 0.709, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6678
Averaged Test Accurancy: 0.6628
Averaged Test AUC: 0.9589
Averaged Test F1_score: 0.6409
Averaged Test Recal score: 0.6899
Std Test Accurancy: 0.1983
Std Test AUC: 0.0220
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.997
Epoch: 0|  Loss:  1.5113 |Global loss: 5.8414| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 1.0139
Epoch: 1|  Loss:  1.5168 |Global loss: 5.8285| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9933
Epoch: 2|  Loss:  1.4886 |Global loss: 5.8455| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.9993
Epoch: 3|  Loss:  1.5051 |Global loss: 5.8422| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9639
Epoch: 0|  Loss:  1.3096 |Global loss: 5.7986| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9559
Epoch: 1|  Loss:  1.3113 |Global loss: 5.8066| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.3123 |Global loss: 5.8036| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.2976 |Global loss: 5.8043| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 1.0103
Epoch: 0|  Loss:  1.6687 |Global loss: 5.7925| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0105
Epoch: 1|  Loss:  1.6842 |Global loss: 5.7936| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.985
Epoch: 2|  Loss:  1.653 |Global loss: 5.8079| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 1.0067
Epoch: 3|  Loss:  1.6679 |Global loss: 5.8009| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.0362
Epoch: 0|  Loss:  1.7436 |Global loss: 5.8549| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.016
Epoch: 1|  Loss:  1.7268 |Global loss: 5.8568| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0193
Epoch: 2|  Loss:  1.7244 |Global loss: 5.8608| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 1.0163
Epoch: 3|  Loss:  1.7216 |Global loss: 5.8557| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 1.0091
Epoch: 0|  Loss:  1.6083 |Global loss: 5.8487| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 1.0078
Epoch: 1|  Loss:  1.5915 |Global loss: 5.8403| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 1.0212
Epoch: 2|  Loss:  1.6224 |Global loss: 5.8423| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 1.0273
Epoch: 3|  Loss:  1.6171 |Global loss: 5.8406| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 1.0221
Epoch: 0|  Loss:  1.8802 |Global loss: 5.848| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 1.0311
Epoch: 1|  Loss:  1.8861 |Global loss: 5.85| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0362
Epoch: 2|  Loss:  1.8751 |Global loss: 5.8383| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 1.0384
Epoch: 3|  Loss:  1.8834 |Global loss: 5.8469| Local H loss: 0.0339  | Global H loss: 0.0339
------------------------- time cost ------------------------- 2.8169262409210205
Chosen Clients:  [9, 5, 12, 0, 14, 13]

-------------Round number: 244-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.575, 0.617, 0.833, 0.658, 0.767, 0.442, 0.75, 0.983, 0.7, 0.85, 0.133, 0.742, 0.883]
AUC in each clients:  [115.157, 115.489, 115.281, 114.698, 117.942, 114.394, 115.427, 114.426, 117.075, 118.137, 115.49, 117.22, 107.05, 111.966, 117.008]
F1 Score:  [0.593, 0.507, 0.596, 0.588, 0.761, 0.624, 0.745, 0.424, 0.695, 0.981, 0.737, 0.846, 0.084, 0.737, 0.857]
Recall Score:  [0.653, 0.569, 0.662, 0.65, 0.81, 0.644, 0.8, 0.491, 0.724, 0.984, 0.78, 0.894, 0.153, 0.778, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6658
Averaged Test Accurancy: 0.6722
Averaged Test AUC: 0.9593
Averaged Test F1_score: 0.6517
Averaged Test Recal score: 0.6995
Std Test Accurancy: 0.1997
Std Test AUC: 0.0221
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9712
Epoch: 0|  Loss:  1.3061 |Global loss: 5.7911| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9642
Epoch: 1|  Loss:  1.3005 |Global loss: 5.7893| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9573
Epoch: 2|  Loss:  1.3033 |Global loss: 5.7989| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9538
Epoch: 3|  Loss:  1.3038 |Global loss: 5.7979| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 1.0585
Epoch: 0|  Loss:  1.8766 |Global loss: 5.8532| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 1.0374
Epoch: 1|  Loss:  1.8583 |Global loss: 5.8558| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 1.0417
Epoch: 2|  Loss:  1.8564 |Global loss: 5.853| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.0333
Epoch: 3|  Loss:  1.8304 |Global loss: 5.8512| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 1.1542
Epoch: 0|  Loss:  2.6096 |Global loss: 5.9106| Local H loss: 0.0207  | Global H loss: 0.0207
Epoch: 1|  NKD Loss: 1.1548
Epoch: 1|  Loss:  2.6386 |Global loss: 5.8948| Local H loss: 0.0206  | Global H loss: 0.0206
Epoch: 2|  NKD Loss: 1.1426
Epoch: 2|  Loss:  2.5893 |Global loss: 5.9205| Local H loss: 0.0208  | Global H loss: 0.0208
Epoch: 3|  NKD Loss: 1.1585
Epoch: 3|  Loss:  2.5959 |Global loss: 5.9041| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 0|  NKD Loss: 0.9975
Epoch: 0|  Loss:  1.6622 |Global loss: 5.8015| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9845
Epoch: 1|  Loss:  1.6513 |Global loss: 5.815| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 1.0041
Epoch: 2|  Loss:  1.665 |Global loss: 5.7916| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9889
Epoch: 3|  Loss:  1.6468 |Global loss: 5.8064| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9872
Epoch: 0|  Loss:  1.438 |Global loss: 5.819| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.9807
Epoch: 1|  Loss:  1.4266 |Global loss: 5.8218| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9808
Epoch: 2|  Loss:  1.4186 |Global loss: 5.8279| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9776
Epoch: 3|  Loss:  1.4106 |Global loss: 5.8297| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0224
Epoch: 0|  Loss:  1.8715 |Global loss: 5.8473| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 1.024
Epoch: 1|  Loss:  1.8691 |Global loss: 5.8543| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 1.0182
Epoch: 2|  Loss:  1.8498 |Global loss: 5.8437| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 1.0253
Epoch: 3|  Loss:  1.8522 |Global loss: 5.8464| Local H loss: 0.0339  | Global H loss: 0.0339
------------------------- time cost ------------------------- 2.937828779220581
Chosen Clients:  [2, 12, 10, 3, 11, 9]

-------------Round number: 245-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.575, 0.617, 0.833, 0.7, 0.767, 0.442, 0.75, 0.983, 0.7, 0.85, 0.125, 0.758, 0.883]
AUC in each clients:  [115.272, 115.489, 115.281, 114.698, 117.942, 114.546, 115.427, 114.426, 117.075, 118.125, 115.49, 117.22, 107.2, 112.186, 117.136]
F1 Score:  [0.593, 0.507, 0.596, 0.588, 0.761, 0.651, 0.745, 0.424, 0.695, 0.981, 0.737, 0.846, 0.08, 0.744, 0.857]
Recall Score:  [0.653, 0.569, 0.662, 0.65, 0.81, 0.683, 0.8, 0.491, 0.724, 0.984, 0.78, 0.894, 0.146, 0.789, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6700
Averaged Test Accurancy: 0.6756
Averaged Test AUC: 0.9597
Averaged Test F1_score: 0.6537
Averaged Test Recal score: 0.7023
Std Test Accurancy: 0.2017
Std Test AUC: 0.0217
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0353
Epoch: 0|  Loss:  1.6135 |Global loss: 5.817| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 1.0278
Epoch: 1|  Loss:  1.6204 |Global loss: 5.8265| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 1.0338
Epoch: 2|  Loss:  1.6019 |Global loss: 5.826| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 1.0056
Epoch: 3|  Loss:  1.5833 |Global loss: 5.8475| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 1.1578
Epoch: 0|  Loss:  2.5954 |Global loss: 5.9025| Local H loss: 0.0209  | Global H loss: 0.0209
Epoch: 1|  NKD Loss: 1.144
Epoch: 1|  Loss:  2.5796 |Global loss: 5.9005| Local H loss: 0.021  | Global H loss: 0.021
Epoch: 2|  NKD Loss: 1.1525
Epoch: 2|  Loss:  2.5937 |Global loss: 5.9032| Local H loss: 0.0213  | Global H loss: 0.0213
Epoch: 3|  NKD Loss: 1.1311
Epoch: 3|  Loss:  2.5607 |Global loss: 5.9193| Local H loss: 0.0212  | Global H loss: 0.0212
Epoch: 0|  NKD Loss: 1.0245
Epoch: 0|  Loss:  1.6108 |Global loss: 5.8671| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0239
Epoch: 1|  Loss:  1.6008 |Global loss: 5.8698| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 1.0172
Epoch: 2|  Loss:  1.5975 |Global loss: 5.8752| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 1.0118
Epoch: 3|  Loss:  1.5943 |Global loss: 5.8771| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 1.0037
Epoch: 0|  Loss:  1.6136 |Global loss: 5.8121| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 1.0008
Epoch: 1|  Loss:  1.5992 |Global loss: 5.803| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9807
Epoch: 2|  Loss:  1.5772 |Global loss: 5.8146| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 1.0015
Epoch: 3|  Loss:  1.5998 |Global loss: 5.7987| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9577
Epoch: 0|  Loss:  1.3385 |Global loss: 5.7699| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.3074 |Global loss: 5.789| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9579
Epoch: 2|  Loss:  1.3338 |Global loss: 5.7717| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9488
Epoch: 3|  Loss:  1.3252 |Global loss: 5.772| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9609
Epoch: 0|  Loss:  1.3086 |Global loss: 5.7953| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.9698
Epoch: 1|  Loss:  1.3113 |Global loss: 5.7923| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9571
Epoch: 2|  Loss:  1.3021 |Global loss: 5.7935| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.9143
Epoch: 3|  Loss:  1.2632 |Global loss: 5.8223| Local H loss: 0.0328  | Global H loss: 0.0328
------------------------- time cost ------------------------- 2.9014248847961426
Chosen Clients:  [6, 5, 3, 4, 13, 2]

-------------Round number: 246-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.6, 0.617, 0.833, 0.7, 0.767, 0.442, 0.75, 0.983, 0.7, 0.85, 0.142, 0.758, 0.883]
AUC in each clients:  [115.272, 115.489, 115.327, 114.747, 117.942, 114.546, 115.427, 114.426, 117.075, 118.132, 115.5, 117.265, 107.586, 112.186, 117.136]
F1 Score:  [0.593, 0.507, 0.623, 0.588, 0.761, 0.651, 0.745, 0.424, 0.695, 0.981, 0.737, 0.846, 0.088, 0.744, 0.857]
Recall Score:  [0.653, 0.569, 0.678, 0.65, 0.81, 0.683, 0.8, 0.491, 0.724, 0.984, 0.78, 0.894, 0.16, 0.789, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6506
Averaged Test Accurancy: 0.6783
Averaged Test AUC: 0.9600
Averaged Test F1_score: 0.6560
Averaged Test Recal score: 0.7043
Std Test Accurancy: 0.1979
Std Test AUC: 0.0211
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0163
Epoch: 0|  Loss:  1.6274 |Global loss: 5.7984| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 1.0068
Epoch: 1|  Loss:  1.609 |Global loss: 5.8075| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 1.0075
Epoch: 2|  Loss:  1.6241 |Global loss: 5.8032| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.9995
Epoch: 3|  Loss:  1.6002 |Global loss: 5.8075| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 1.0456
Epoch: 0|  Loss:  1.8554 |Global loss: 5.8554| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.0692
Epoch: 1|  Loss:  1.8653 |Global loss: 5.8273| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.0552
Epoch: 2|  Loss:  1.8518 |Global loss: 5.8438| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 1.064
Epoch: 3|  Loss:  1.8422 |Global loss: 5.8361| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.9815
Epoch: 0|  Loss:  1.5802 |Global loss: 5.8163| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.9983
Epoch: 1|  Loss:  1.5786 |Global loss: 5.8068| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9798
Epoch: 2|  Loss:  1.5702 |Global loss: 5.8073| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 1.0083
Epoch: 3|  Loss:  1.5963 |Global loss: 5.7982| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9712
Epoch: 0|  Loss:  1.5012 |Global loss: 5.7684| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.951
Epoch: 1|  Loss:  1.4745 |Global loss: 5.7782| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.9512
Epoch: 2|  Loss:  1.4707 |Global loss: 5.7745| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9527
Epoch: 3|  Loss:  1.4668 |Global loss: 5.7725| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 1.0242
Epoch: 0|  Loss:  1.8442 |Global loss: 5.8468| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 1.0385
Epoch: 1|  Loss:  1.8496 |Global loss: 5.8338| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 1.0402
Epoch: 2|  Loss:  1.8538 |Global loss: 5.8281| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.0479
Epoch: 3|  Loss:  1.8534 |Global loss: 5.821| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 1.0204
Epoch: 0|  Loss:  1.6085 |Global loss: 5.8418| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 1.0193
Epoch: 1|  Loss:  1.5842 |Global loss: 5.8373| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 1.0088
Epoch: 2|  Loss:  1.5969 |Global loss: 5.8503| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.9925
Epoch: 3|  Loss:  1.5708 |Global loss: 5.8511| Local H loss: 0.034  | Global H loss: 0.034
------------------------- time cost ------------------------- 2.876563549041748
Chosen Clients:  [8, 11, 0, 1, 10, 12]

-------------Round number: 247-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.683, 0.633, 0.833, 0.667, 0.767, 0.442, 0.75, 0.983, 0.7, 0.85, 0.142, 0.767, 0.883]
AUC in each clients:  [115.272, 115.489, 115.669, 114.85, 117.974, 114.427, 115.498, 114.426, 117.075, 118.132, 115.5, 117.265, 107.586, 112.361, 117.136]
F1 Score:  [0.593, 0.507, 0.701, 0.608, 0.761, 0.631, 0.745, 0.424, 0.695, 0.981, 0.737, 0.846, 0.088, 0.75, 0.857]
Recall Score:  [0.653, 0.569, 0.738, 0.662, 0.81, 0.653, 0.8, 0.491, 0.724, 0.984, 0.78, 0.894, 0.16, 0.796, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6502
Averaged Test Accurancy: 0.6833
Averaged Test AUC: 0.9604
Averaged Test F1_score: 0.6616
Averaged Test Recal score: 0.7076
Std Test Accurancy: 0.1967
Std Test AUC: 0.0210
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9889
Epoch: 0|  Loss:  1.4856 |Global loss: 5.842| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0128
Epoch: 1|  Loss:  1.5048 |Global loss: 5.8255| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9945
Epoch: 2|  Loss:  1.4758 |Global loss: 5.836| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 1.019
Epoch: 3|  Loss:  1.5052 |Global loss: 5.8189| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9575
Epoch: 0|  Loss:  1.3136 |Global loss: 5.77| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9554
Epoch: 1|  Loss:  1.3243 |Global loss: 5.7692| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9556
Epoch: 2|  Loss:  1.3254 |Global loss: 5.7678| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9573
Epoch: 3|  Loss:  1.3223 |Global loss: 5.7696| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 1.0095
Epoch: 0|  Loss:  1.659 |Global loss: 5.7896| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 1.0144
Epoch: 1|  Loss:  1.6767 |Global loss: 5.7832| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 1.0058
Epoch: 2|  Loss:  1.6529 |Global loss: 5.7838| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9971
Epoch: 3|  Loss:  1.6546 |Global loss: 5.7938| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.033
Epoch: 0|  Loss:  1.7053 |Global loss: 5.8372| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0302
Epoch: 1|  Loss:  1.7185 |Global loss: 5.8503| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0352
Epoch: 2|  Loss:  1.7298 |Global loss: 5.8453| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0247
Epoch: 3|  Loss:  1.708 |Global loss: 5.8506| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0436
Epoch: 0|  Loss:  1.6165 |Global loss: 5.8494| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 1.036
Epoch: 1|  Loss:  1.6061 |Global loss: 5.8592| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 1.0314
Epoch: 2|  Loss:  1.5968 |Global loss: 5.8649| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 1.0175
Epoch: 3|  Loss:  1.5779 |Global loss: 5.8616| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 1.144
Epoch: 0|  Loss:  2.5782 |Global loss: 5.9107| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 1|  NKD Loss: 1.1499
Epoch: 1|  Loss:  2.5544 |Global loss: 5.905| Local H loss: 0.0214  | Global H loss: 0.0214
Epoch: 2|  NKD Loss: 1.1398
Epoch: 2|  Loss:  2.5371 |Global loss: 5.9125| Local H loss: 0.0215  | Global H loss: 0.0215
Epoch: 3|  NKD Loss: 1.1564
Epoch: 3|  Loss:  2.5627 |Global loss: 5.9| Local H loss: 0.0219  | Global H loss: 0.0219
------------------------- time cost ------------------------- 3.0485293865203857
Chosen Clients:  [2, 9, 7, 1, 10, 5]

-------------Round number: 248-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.558, 0.683, 0.633, 0.833, 0.667, 0.767, 0.442, 0.733, 0.983, 0.7, 0.85, 0.125, 0.767, 0.883]
AUC in each clients:  [115.342, 115.652, 115.669, 114.85, 117.974, 114.427, 115.498, 114.426, 117.04, 118.132, 115.492, 117.186, 107.622, 112.361, 117.136]
F1 Score:  [0.593, 0.536, 0.701, 0.608, 0.761, 0.631, 0.745, 0.424, 0.666, 0.981, 0.737, 0.846, 0.08, 0.75, 0.857]
Recall Score:  [0.653, 0.586, 0.738, 0.662, 0.81, 0.653, 0.8, 0.491, 0.707, 0.984, 0.78, 0.894, 0.146, 0.796, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6513
Averaged Test Accurancy: 0.6828
Averaged Test AUC: 0.9604
Averaged Test F1_score: 0.6611
Averaged Test Recal score: 0.7067
Std Test Accurancy: 0.1983
Std Test AUC: 0.0209
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0214
Epoch: 0|  Loss:  1.577 |Global loss: 5.8437| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 1.0226
Epoch: 1|  Loss:  1.586 |Global loss: 5.8372| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 1.0164
Epoch: 2|  Loss:  1.5853 |Global loss: 5.8344| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 1.0074
Epoch: 3|  Loss:  1.5473 |Global loss: 5.8416| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.9601
Epoch: 0|  Loss:  1.2805 |Global loss: 5.7817| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9673
Epoch: 1|  Loss:  1.3062 |Global loss: 5.783| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.9414
Epoch: 2|  Loss:  1.2603 |Global loss: 5.8028| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9589
Epoch: 3|  Loss:  1.2905 |Global loss: 5.7884| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 1.0528
Epoch: 0|  Loss:  1.8065 |Global loss: 5.845| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 1.0419
Epoch: 1|  Loss:  1.7881 |Global loss: 5.8499| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 1.0542
Epoch: 2|  Loss:  1.8087 |Global loss: 5.8444| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0531
Epoch: 3|  Loss:  1.7666 |Global loss: 5.8301| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 1.0278
Epoch: 0|  Loss:  1.7066 |Global loss: 5.835| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0309
Epoch: 1|  Loss:  1.6989 |Global loss: 5.8455| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.0503
Epoch: 2|  Loss:  1.7105 |Global loss: 5.8312| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0503
Epoch: 3|  Loss:  1.7211 |Global loss: 5.8342| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 1.0216
Epoch: 0|  Loss:  1.5813 |Global loss: 5.8599| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9931
Epoch: 1|  Loss:  1.5544 |Global loss: 5.8904| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 1.0233
Epoch: 2|  Loss:  1.576 |Global loss: 5.8566| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9982
Epoch: 3|  Loss:  1.5554 |Global loss: 5.8769| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 1.0508
Epoch: 0|  Loss:  1.8626 |Global loss: 5.8442| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.0665
Epoch: 1|  Loss:  1.8546 |Global loss: 5.8318| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.053
Epoch: 2|  Loss:  1.8449 |Global loss: 5.8426| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 1.0628
Epoch: 3|  Loss:  1.8427 |Global loss: 5.8383| Local H loss: 0.0253  | Global H loss: 0.0253
------------------------- time cost ------------------------- 2.99760365486145
Chosen Clients:  [2, 11, 7, 10, 9, 0]

-------------Round number: 249-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.533, 0.683, 0.633, 0.833, 0.675, 0.767, 0.575, 0.733, 0.983, 0.708, 0.85, 0.125, 0.767, 0.883]
AUC in each clients:  [115.342, 115.475, 115.612, 114.85, 117.974, 114.427, 115.498, 115.162, 117.04, 118.139, 115.644, 117.186, 107.622, 112.361, 117.136]
F1 Score:  [0.593, 0.507, 0.697, 0.608, 0.761, 0.635, 0.745, 0.56, 0.666, 0.981, 0.742, 0.846, 0.08, 0.75, 0.857]
Recall Score:  [0.653, 0.569, 0.741, 0.662, 0.81, 0.66, 0.8, 0.602, 0.707, 0.984, 0.789, 0.894, 0.146, 0.796, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6408
Averaged Test Accurancy: 0.6911
Averaged Test AUC: 0.9608
Averaged Test F1_score: 0.6685
Averaged Test Recal score: 0.7142
Std Test Accurancy: 0.1914
Std Test AUC: 0.0209
Std Test F1: 0.0016
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0135
Epoch: 0|  Loss:  1.5899 |Global loss: 5.8415| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 1.0134
Epoch: 1|  Loss:  1.5641 |Global loss: 5.8471| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.997
Epoch: 2|  Loss:  1.554 |Global loss: 5.8448| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 1.0148
Epoch: 3|  Loss:  1.5576 |Global loss: 5.8323| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.9328
Epoch: 0|  Loss:  1.3015 |Global loss: 5.7806| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9367
Epoch: 1|  Loss:  1.2904 |Global loss: 5.784| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9356
Epoch: 2|  Loss:  1.2947 |Global loss: 5.7814| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.9591
Epoch: 3|  Loss:  1.3196 |Global loss: 5.7707| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.0537
Epoch: 0|  Loss:  1.776 |Global loss: 5.8343| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 1.0472
Epoch: 1|  Loss:  1.7461 |Global loss: 5.8337| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 1.0314
Epoch: 2|  Loss:  1.7234 |Global loss: 5.8455| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 1.0247
Epoch: 3|  Loss:  1.7227 |Global loss: 5.845| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 1.0306
Epoch: 0|  Loss:  1.5756 |Global loss: 5.8537| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 1.0256
Epoch: 1|  Loss:  1.5716 |Global loss: 5.8627| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9971
Epoch: 2|  Loss:  1.5432 |Global loss: 5.8755| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 1.0127
Epoch: 3|  Loss:  1.5582 |Global loss: 5.8667| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9432
Epoch: 0|  Loss:  1.2797 |Global loss: 5.7949| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.9457
Epoch: 1|  Loss:  1.2808 |Global loss: 5.792| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.9478
Epoch: 2|  Loss:  1.2653 |Global loss: 5.7938| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9537
Epoch: 3|  Loss:  1.2833 |Global loss: 5.7881| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 1.0106
Epoch: 0|  Loss:  1.6576 |Global loss: 5.7912| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9911
Epoch: 1|  Loss:  1.6457 |Global loss: 5.7984| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9902
Epoch: 2|  Loss:  1.6418 |Global loss: 5.8008| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.0017
Epoch: 3|  Loss:  1.633 |Global loss: 5.7813| Local H loss: 0.0277  | Global H loss: 0.0277
------------------------- time cost ------------------------- 3.0557382106781006
Chosen Clients:  [10, 14, 2, 6, 13, 8]

-------------Round number: 250-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.533, 0.675, 0.633, 0.833, 0.675, 0.767, 0.633, 0.733, 0.983, 0.708, 0.85, 0.125, 0.767, 0.883]
AUC in each clients:  [115.395, 115.475, 115.665, 114.85, 117.974, 114.427, 115.498, 115.779, 117.04, 118.183, 115.656, 117.221, 107.622, 112.361, 117.136]
F1 Score:  [0.608, 0.507, 0.685, 0.608, 0.761, 0.635, 0.745, 0.585, 0.666, 0.981, 0.742, 0.846, 0.08, 0.75, 0.857]
Recall Score:  [0.663, 0.569, 0.728, 0.662, 0.81, 0.66, 0.8, 0.646, 0.707, 0.984, 0.789, 0.894, 0.146, 0.796, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6304
Averaged Test Accurancy: 0.6950
Averaged Test AUC: 0.9613
Averaged Test F1_score: 0.6704
Averaged Test Recal score: 0.7169
Std Test Accurancy: 0.1894
Std Test AUC: 0.0209
Std Test F1: 0.0016
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0056
Epoch: 0|  Loss:  1.5439 |Global loss: 5.8615| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 1.0315
Epoch: 1|  Loss:  1.565 |Global loss: 5.8438| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9931
Epoch: 2|  Loss:  1.5255 |Global loss: 5.8732| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 1.003
Epoch: 3|  Loss:  1.5343 |Global loss: 5.866| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 1.0016
Epoch: 0|  Loss:  1.4295 |Global loss: 5.8035| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9785
Epoch: 1|  Loss:  1.411 |Global loss: 5.8238| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9761
Epoch: 2|  Loss:  1.4174 |Global loss: 5.8278| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9525
Epoch: 3|  Loss:  1.3795 |Global loss: 5.84| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0171
Epoch: 0|  Loss:  1.5627 |Global loss: 5.8396| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.9953
Epoch: 1|  Loss:  1.547 |Global loss: 5.854| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 1.0009
Epoch: 2|  Loss:  1.5358 |Global loss: 5.8423| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.0133
Epoch: 3|  Loss:  1.5336 |Global loss: 5.8346| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 1.0017
Epoch: 0|  Loss:  1.6075 |Global loss: 5.8122| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.9881
Epoch: 1|  Loss:  1.5922 |Global loss: 5.8168| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.9807
Epoch: 2|  Loss:  1.5768 |Global loss: 5.8167| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9976
Epoch: 3|  Loss:  1.5864 |Global loss: 5.8115| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 1.0315
Epoch: 0|  Loss:  1.8563 |Global loss: 5.8292| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 1.0182
Epoch: 1|  Loss:  1.8039 |Global loss: 5.8554| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 1.0259
Epoch: 2|  Loss:  1.8307 |Global loss: 5.8342| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.0423
Epoch: 3|  Loss:  1.8392 |Global loss: 5.8227| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9775
Epoch: 0|  Loss:  1.455 |Global loss: 5.8352| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.9947
Epoch: 1|  Loss:  1.4784 |Global loss: 5.8289| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9824
Epoch: 2|  Loss:  1.4487 |Global loss: 5.8485| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9924
Epoch: 3|  Loss:  1.4703 |Global loss: 5.8369| Local H loss: 0.0358  | Global H loss: 0.0358
------------------------- time cost ------------------------- 2.9780280590057373
Chosen Clients:  [1, 3, 4, 2, 8, 7]

-------------Round number: 251-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.533, 0.658, 0.633, 0.833, 0.675, 0.767, 0.633, 0.8, 0.983, 0.708, 0.85, 0.125, 0.783, 0.883]
AUC in each clients:  [115.395, 115.475, 115.734, 114.85, 117.974, 114.427, 115.539, 115.779, 117.145, 118.183, 115.766, 117.221, 107.622, 112.594, 117.211]
F1 Score:  [0.608, 0.507, 0.67, 0.608, 0.761, 0.635, 0.745, 0.585, 0.736, 0.981, 0.742, 0.846, 0.08, 0.759, 0.857]
Recall Score:  [0.663, 0.569, 0.72, 0.662, 0.81, 0.66, 0.8, 0.646, 0.774, 0.984, 0.789, 0.894, 0.146, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6198
Averaged Test Accurancy: 0.6994
Averaged Test AUC: 0.9616
Averaged Test F1_score: 0.6747
Averaged Test Recal score: 0.7218
Std Test Accurancy: 0.1916
Std Test AUC: 0.0209
Std Test F1: 0.0016
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0312
Epoch: 0|  Loss:  1.7117 |Global loss: 5.8442| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0106
Epoch: 1|  Loss:  1.689 |Global loss: 5.8605| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0299
Epoch: 2|  Loss:  1.6966 |Global loss: 5.8484| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.0233
Epoch: 3|  Loss:  1.6851 |Global loss: 5.8526| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9824
Epoch: 0|  Loss:  1.5669 |Global loss: 5.8081| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 1.004
Epoch: 1|  Loss:  1.5835 |Global loss: 5.8027| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 2|  NKD Loss: 0.9878
Epoch: 2|  Loss:  1.556 |Global loss: 5.8022| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.9757
Epoch: 3|  Loss:  1.5422 |Global loss: 5.8109| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.9391
Epoch: 0|  Loss:  1.4608 |Global loss: 5.7859| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.9286
Epoch: 1|  Loss:  1.4403 |Global loss: 5.7912| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.9392
Epoch: 2|  Loss:  1.4512 |Global loss: 5.7722| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.9435
Epoch: 3|  Loss:  1.4621 |Global loss: 5.7827| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0163
Epoch: 0|  Loss:  1.5435 |Global loss: 5.8338| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 0.9988
Epoch: 1|  Loss:  1.5211 |Global loss: 5.8421| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 0.9853
Epoch: 2|  Loss:  1.52 |Global loss: 5.8539| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 3|  NKD Loss: 1.0039
Epoch: 3|  Loss:  1.5251 |Global loss: 5.8436| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9858
Epoch: 0|  Loss:  1.46 |Global loss: 5.8381| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9966
Epoch: 1|  Loss:  1.4579 |Global loss: 5.8313| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9482
Epoch: 2|  Loss:  1.4168 |Global loss: 5.8654| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 1.0064
Epoch: 3|  Loss:  1.4758 |Global loss: 5.823| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 1.038
Epoch: 0|  Loss:  1.7265 |Global loss: 5.8392| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 1.0265
Epoch: 1|  Loss:  1.7047 |Global loss: 5.8423| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 1.028
Epoch: 2|  Loss:  1.7045 |Global loss: 5.8383| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 1.0368
Epoch: 3|  Loss:  1.6917 |Global loss: 5.8348| Local H loss: 0.0364  | Global H loss: 0.0364
------------------------- time cost ------------------------- 3.003244638442993
Chosen Clients:  [12, 2, 6, 3, 5, 14]

-------------Round number: 252-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.567, 0.708, 0.667, 0.833, 0.675, 0.767, 0.65, 0.767, 0.983, 0.708, 0.85, 0.125, 0.783, 0.883]
AUC in each clients:  [115.395, 115.702, 115.914, 114.953, 117.977, 114.427, 115.539, 116.042, 117.06, 118.183, 115.766, 117.221, 107.622, 112.594, 117.211]
F1 Score:  [0.608, 0.544, 0.722, 0.638, 0.761, 0.635, 0.745, 0.592, 0.709, 0.981, 0.742, 0.846, 0.08, 0.759, 0.857]
Recall Score:  [0.663, 0.592, 0.755, 0.684, 0.81, 0.66, 0.8, 0.657, 0.741, 0.984, 0.789, 0.894, 0.146, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6223
Averaged Test Accurancy: 0.7061
Averaged Test AUC: 0.9620
Averaged Test F1_score: 0.6813
Averaged Test Recal score: 0.7257
Std Test Accurancy: 0.1876
Std Test AUC: 0.0209
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.1473
Epoch: 0|  Loss:  2.573 |Global loss: 5.9185| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 1|  NKD Loss: 1.1521
Epoch: 1|  Loss:  2.5458 |Global loss: 5.9121| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 1.1436
Epoch: 2|  Loss:  2.5262 |Global loss: 5.8935| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 1.1447
Epoch: 3|  Loss:  2.5169 |Global loss: 5.9112| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 1.0036
Epoch: 0|  Loss:  1.5183 |Global loss: 5.8374| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 1.0184
Epoch: 1|  Loss:  1.5391 |Global loss: 5.8355| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.998
Epoch: 2|  Loss:  1.5223 |Global loss: 5.843| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 1.0087
Epoch: 3|  Loss:  1.5264 |Global loss: 5.8459| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9884
Epoch: 0|  Loss:  1.573 |Global loss: 5.8145| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 1.0006
Epoch: 1|  Loss:  1.5958 |Global loss: 5.8115| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9951
Epoch: 2|  Loss:  1.5903 |Global loss: 5.8121| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9952
Epoch: 3|  Loss:  1.5922 |Global loss: 5.811| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.9779
Epoch: 0|  Loss:  1.5371 |Global loss: 5.8098| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.9813
Epoch: 1|  Loss:  1.5477 |Global loss: 5.8066| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 2|  NKD Loss: 0.9832
Epoch: 2|  Loss:  1.5455 |Global loss: 5.8068| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.9828
Epoch: 3|  Loss:  1.5303 |Global loss: 5.8006| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 0|  NKD Loss: 1.0409
Epoch: 0|  Loss:  1.8232 |Global loss: 5.8454| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 1.053
Epoch: 1|  Loss:  1.8388 |Global loss: 5.8391| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 1.0528
Epoch: 2|  Loss:  1.8322 |Global loss: 5.8373| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.0616
Epoch: 3|  Loss:  1.8213 |Global loss: 5.8332| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9954
Epoch: 0|  Loss:  1.4266 |Global loss: 5.8089| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9891
Epoch: 1|  Loss:  1.4164 |Global loss: 5.8071| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9665
Epoch: 2|  Loss:  1.3944 |Global loss: 5.8257| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.9705
Epoch: 3|  Loss:  1.3898 |Global loss: 5.8204| Local H loss: 0.0305  | Global H loss: 0.0305
------------------------- time cost ------------------------- 2.822795867919922
Chosen Clients:  [2, 1, 3, 11, 12, 7]

-------------Round number: 253-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.567, 0.7, 0.733, 0.833, 0.7, 0.767, 0.65, 0.767, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.395, 115.702, 115.811, 115.151, 117.977, 114.702, 115.687, 116.042, 117.06, 118.183, 115.766, 117.221, 107.701, 112.594, 117.229]
F1 Score:  [0.608, 0.544, 0.702, 0.684, 0.761, 0.645, 0.745, 0.592, 0.709, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.663, 0.592, 0.745, 0.73, 0.81, 0.681, 0.8, 0.657, 0.741, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6117
Averaged Test Accurancy: 0.7128
Averaged Test AUC: 0.9623
Averaged Test F1_score: 0.6842
Averaged Test Recal score: 0.7304
Std Test Accurancy: 0.1837
Std Test AUC: 0.0207
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.0197
Epoch: 0|  Loss:  1.5187 |Global loss: 5.826| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.9962
Epoch: 1|  Loss:  1.5349 |Global loss: 5.864| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 2|  NKD Loss: 1.0058
Epoch: 2|  Loss:  1.5219 |Global loss: 5.8473| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.9627
Epoch: 3|  Loss:  1.4655 |Global loss: 5.8673| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 1.036
Epoch: 0|  Loss:  1.6871 |Global loss: 5.8397| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.04
Epoch: 1|  Loss:  1.668 |Global loss: 5.8394| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0386
Epoch: 2|  Loss:  1.6912 |Global loss: 5.8364| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.0352
Epoch: 3|  Loss:  1.687 |Global loss: 5.836| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9669
Epoch: 0|  Loss:  1.5224 |Global loss: 5.8182| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 0.9617
Epoch: 1|  Loss:  1.5134 |Global loss: 5.8172| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 0.9881
Epoch: 2|  Loss:  1.5333 |Global loss: 5.794| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.986
Epoch: 3|  Loss:  1.5225 |Global loss: 5.7928| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.9554
Epoch: 0|  Loss:  1.312 |Global loss: 5.765| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9557
Epoch: 1|  Loss:  1.3159 |Global loss: 5.7648| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9631
Epoch: 2|  Loss:  1.3152 |Global loss: 5.7605| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9426
Epoch: 3|  Loss:  1.2987 |Global loss: 5.7731| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.1517
Epoch: 0|  Loss:  2.5545 |Global loss: 5.9082| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 1.134
Epoch: 1|  Loss:  2.5143 |Global loss: 5.9185| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 1.1333
Epoch: 2|  Loss:  2.5134 |Global loss: 5.9044| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 1.1368
Epoch: 3|  Loss:  2.4969 |Global loss: 5.9156| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 0|  NKD Loss: 1.0291
Epoch: 0|  Loss:  1.6908 |Global loss: 5.8409| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 1.0252
Epoch: 1|  Loss:  1.676 |Global loss: 5.8329| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 1.0362
Epoch: 2|  Loss:  1.6652 |Global loss: 5.8218| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 1.0437
Epoch: 3|  Loss:  1.6643 |Global loss: 5.8162| Local H loss: 0.0376  | Global H loss: 0.0376
------------------------- time cost ------------------------- 3.1785223484039307
Chosen Clients:  [11, 5, 2, 7, 12, 4]

-------------Round number: 254-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.625, 0.775, 0.783, 0.833, 0.7, 0.767, 0.667, 0.767, 0.983, 0.708, 0.85, 0.167, 0.783, 0.883]
AUC in each clients:  [115.395, 115.86, 116.08, 115.33, 117.977, 114.702, 115.687, 116.383, 117.06, 118.183, 115.766, 117.345, 108.025, 112.594, 117.229]
F1 Score:  [0.608, 0.581, 0.751, 0.74, 0.761, 0.645, 0.745, 0.623, 0.709, 0.981, 0.742, 0.846, 0.139, 0.759, 0.857]
Recall Score:  [0.663, 0.631, 0.81, 0.777, 0.81, 0.681, 0.8, 0.676, 0.741, 0.984, 0.789, 0.894, 0.195, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6027
Averaged Test Accurancy: 0.7278
Averaged Test AUC: 0.9631
Averaged Test F1_score: 0.6991
Averaged Test Recal score: 0.7441
Std Test Accurancy: 0.1766
Std Test AUC: 0.0202
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9429
Epoch: 0|  Loss:  1.288 |Global loss: 5.7712| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9493
Epoch: 1|  Loss:  1.2926 |Global loss: 5.7687| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9301
Epoch: 2|  Loss:  1.2776 |Global loss: 5.7819| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.9517
Epoch: 3|  Loss:  1.2817 |Global loss: 5.7604| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 1.0517
Epoch: 0|  Loss:  1.8005 |Global loss: 5.8386| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.0152
Epoch: 1|  Loss:  1.7864 |Global loss: 5.8542| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 1.0554
Epoch: 2|  Loss:  1.8095 |Global loss: 5.8331| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 1.0479
Epoch: 3|  Loss:  1.7882 |Global loss: 5.8366| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.9985
Epoch: 0|  Loss:  1.4989 |Global loss: 5.8315| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 1.0129
Epoch: 1|  Loss:  1.52 |Global loss: 5.8334| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 1.0067
Epoch: 2|  Loss:  1.4968 |Global loss: 5.835| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.9867
Epoch: 3|  Loss:  1.4854 |Global loss: 5.8528| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 1.015
Epoch: 0|  Loss:  1.636 |Global loss: 5.8382| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 1.0286
Epoch: 1|  Loss:  1.6446 |Global loss: 5.8282| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 1.0247
Epoch: 2|  Loss:  1.6386 |Global loss: 5.8209| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 1.002
Epoch: 3|  Loss:  1.6079 |Global loss: 5.8428| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 1.1386
Epoch: 0|  Loss:  2.4877 |Global loss: 5.9025| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 1.1483
Epoch: 1|  Loss:  2.4983 |Global loss: 5.9146| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 1.1348
Epoch: 2|  Loss:  2.4867 |Global loss: 5.8954| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 1.1643
Epoch: 3|  Loss:  2.4997 |Global loss: 5.8982| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 0.9599
Epoch: 0|  Loss:  1.473 |Global loss: 5.7674| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.9721
Epoch: 1|  Loss:  1.4939 |Global loss: 5.7659| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.9446
Epoch: 2|  Loss:  1.4646 |Global loss: 5.777| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.9604
Epoch: 3|  Loss:  1.4764 |Global loss: 5.7563| Local H loss: 0.029  | Global H loss: 0.029
------------------------- time cost ------------------------- 2.9108307361602783
Chosen Clients:  [4, 10, 6, 3, 9, 0]

-------------Round number: 255-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.625, 0.733, 0.783, 0.842, 0.7, 0.767, 0.717, 0.767, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.395, 115.86, 116.082, 115.33, 117.989, 114.842, 115.687, 116.448, 117.06, 118.183, 115.766, 117.291, 108.08, 112.594, 117.229]
F1 Score:  [0.608, 0.581, 0.746, 0.74, 0.766, 0.647, 0.745, 0.674, 0.709, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.663, 0.631, 0.774, 0.777, 0.817, 0.683, 0.8, 0.731, 0.741, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.6006
Averaged Test Accurancy: 0.7272
Averaged Test AUC: 0.9632
Averaged Test F1_score: 0.6993
Averaged Test Recal score: 0.7436
Std Test Accurancy: 0.1812
Std Test AUC: 0.0201
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 0.9486
Epoch: 0|  Loss:  1.4561 |Global loss: 5.7627| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.9697
Epoch: 1|  Loss:  1.4729 |Global loss: 5.7562| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.9575
Epoch: 2|  Loss:  1.4722 |Global loss: 5.7647| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.9628
Epoch: 3|  Loss:  1.4731 |Global loss: 5.7653| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.031
Epoch: 0|  Loss:  1.5525 |Global loss: 5.8407| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 1.0223
Epoch: 1|  Loss:  1.5415 |Global loss: 5.8491| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9908
Epoch: 2|  Loss:  1.5114 |Global loss: 5.8718| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 1.0042
Epoch: 3|  Loss:  1.5254 |Global loss: 5.8606| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 1.0113
Epoch: 0|  Loss:  1.5829 |Global loss: 5.7958| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 1.0126
Epoch: 1|  Loss:  1.603 |Global loss: 5.7943| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 1.0038
Epoch: 2|  Loss:  1.5762 |Global loss: 5.8013| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.9985
Epoch: 3|  Loss:  1.5771 |Global loss: 5.8049| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9728
Epoch: 0|  Loss:  1.508 |Global loss: 5.8031| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.9755
Epoch: 1|  Loss:  1.5029 |Global loss: 5.8061| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.9729
Epoch: 2|  Loss:  1.5066 |Global loss: 5.8006| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.992
Epoch: 3|  Loss:  1.5149 |Global loss: 5.796| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 0|  NKD Loss: 0.9546
Epoch: 0|  Loss:  1.2835 |Global loss: 5.7833| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.9554
Epoch: 1|  Loss:  1.285 |Global loss: 5.7782| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.9521
Epoch: 2|  Loss:  1.2625 |Global loss: 5.7848| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.9406
Epoch: 3|  Loss:  1.2572 |Global loss: 5.791| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 1.0001
Epoch: 0|  Loss:  1.6457 |Global loss: 5.7918| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9774
Epoch: 1|  Loss:  1.5895 |Global loss: 5.7966| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9903
Epoch: 2|  Loss:  1.6288 |Global loss: 5.7926| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9778
Epoch: 3|  Loss:  1.6074 |Global loss: 5.8001| Local H loss: 0.0272  | Global H loss: 0.0272
------------------------- time cost ------------------------- 3.3104796409606934
Chosen Clients:  [14, 8, 11, 4, 1, 13]

-------------Round number: 256-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.625, 0.733, 0.767, 0.833, 0.7, 0.775, 0.717, 0.767, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.356, 115.86, 116.082, 115.355, 118.001, 114.842, 115.773, 116.448, 117.06, 118.205, 115.888, 117.291, 108.08, 112.594, 117.229]
F1 Score:  [0.593, 0.581, 0.746, 0.73, 0.761, 0.647, 0.751, 0.674, 0.709, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.653, 0.631, 0.774, 0.764, 0.81, 0.683, 0.81, 0.731, 0.741, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5988
Averaged Test Accurancy: 0.7256
Averaged Test AUC: 0.9634
Averaged Test F1_score: 0.6977
Averaged Test Recal score: 0.7423
Std Test Accurancy: 0.1810
Std Test AUC: 0.0201
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 0.9901
Epoch: 0|  Loss:  1.4101 |Global loss: 5.8028| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9921
Epoch: 1|  Loss:  1.396 |Global loss: 5.8021| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.954
Epoch: 2|  Loss:  1.3787 |Global loss: 5.8284| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9921
Epoch: 3|  Loss:  1.4064 |Global loss: 5.8033| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 1.0143
Epoch: 0|  Loss:  1.4784 |Global loss: 5.815| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 1.004
Epoch: 1|  Loss:  1.4657 |Global loss: 5.8223| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9975
Epoch: 2|  Loss:  1.4606 |Global loss: 5.8202| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9825
Epoch: 3|  Loss:  1.439 |Global loss: 5.8209| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9359
Epoch: 0|  Loss:  1.2794 |Global loss: 5.7762| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.9357
Epoch: 1|  Loss:  1.2818 |Global loss: 5.7778| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.9246
Epoch: 2|  Loss:  1.2525 |Global loss: 5.7783| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.9394
Epoch: 3|  Loss:  1.2846 |Global loss: 5.7666| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.9497
Epoch: 0|  Loss:  1.4507 |Global loss: 5.7699| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.9474
Epoch: 1|  Loss:  1.4564 |Global loss: 5.7694| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.9485
Epoch: 2|  Loss:  1.4543 |Global loss: 5.7687| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.9625
Epoch: 3|  Loss:  1.4667 |Global loss: 5.7556| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0266
Epoch: 0|  Loss:  1.646 |Global loss: 5.8362| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.027
Epoch: 1|  Loss:  1.6728 |Global loss: 5.8422| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0248
Epoch: 2|  Loss:  1.6619 |Global loss: 5.8447| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0105
Epoch: 3|  Loss:  1.6529 |Global loss: 5.8547| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0348
Epoch: 0|  Loss:  1.8183 |Global loss: 5.8311| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 1.0442
Epoch: 1|  Loss:  1.8315 |Global loss: 5.8137| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 1.0161
Epoch: 2|  Loss:  1.812 |Global loss: 5.8308| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 1.0351
Epoch: 3|  Loss:  1.8025 |Global loss: 5.8247| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 3.1364083290100098
Chosen Clients:  [0, 11, 7, 6, 14, 3]

-------------Round number: 257-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.617, 0.642, 0.733, 0.767, 0.842, 0.7, 0.775, 0.717, 0.85, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.356, 116.066, 116.082, 115.355, 118.024, 114.842, 115.773, 116.448, 117.279, 118.205, 115.888, 117.399, 108.08, 112.627, 117.295]
F1 Score:  [0.593, 0.589, 0.746, 0.73, 0.766, 0.647, 0.751, 0.674, 0.816, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.653, 0.642, 0.774, 0.764, 0.817, 0.683, 0.81, 0.731, 0.84, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5939
Averaged Test Accurancy: 0.7328
Averaged Test AUC: 0.9637
Averaged Test F1_score: 0.7057
Averaged Test Recal score: 0.7501
Std Test Accurancy: 0.1832
Std Test AUC: 0.0203
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 1.0009
Epoch: 0|  Loss:  1.62 |Global loss: 5.7892| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9942
Epoch: 1|  Loss:  1.608 |Global loss: 5.7851| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 1.0056
Epoch: 2|  Loss:  1.6298 |Global loss: 5.7817| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 1.0043
Epoch: 3|  Loss:  1.6326 |Global loss: 5.7882| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.92
Epoch: 0|  Loss:  1.259 |Global loss: 5.7883| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9514
Epoch: 1|  Loss:  1.2816 |Global loss: 5.7604| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9332
Epoch: 2|  Loss:  1.2645 |Global loss: 5.7788| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 3|  NKD Loss: 0.9364
Epoch: 3|  Loss:  1.2687 |Global loss: 5.7721| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 1.0174
Epoch: 0|  Loss:  1.6137 |Global loss: 5.8238| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 1.0118
Epoch: 1|  Loss:  1.5996 |Global loss: 5.8297| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 1.0099
Epoch: 2|  Loss:  1.5937 |Global loss: 5.8216| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 1.0252
Epoch: 3|  Loss:  1.607 |Global loss: 5.826| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.988
Epoch: 0|  Loss:  1.5676 |Global loss: 5.8056| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.9921
Epoch: 1|  Loss:  1.5644 |Global loss: 5.8038| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 1.0061
Epoch: 2|  Loss:  1.5802 |Global loss: 5.7973| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 1.0
Epoch: 3|  Loss:  1.5679 |Global loss: 5.8046| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.9662
Epoch: 0|  Loss:  1.3593 |Global loss: 5.8187| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9804
Epoch: 1|  Loss:  1.3913 |Global loss: 5.8054| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9715
Epoch: 2|  Loss:  1.3707 |Global loss: 5.8152| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9606
Epoch: 3|  Loss:  1.367 |Global loss: 5.8211| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.968
Epoch: 0|  Loss:  1.5079 |Global loss: 5.8044| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.9774
Epoch: 1|  Loss:  1.4914 |Global loss: 5.7995| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.98
Epoch: 2|  Loss:  1.4969 |Global loss: 5.7917| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 3|  NKD Loss: 0.9789
Epoch: 3|  Loss:  1.5016 |Global loss: 5.7983| Local H loss: 0.0401  | Global H loss: 0.0401
------------------------- time cost ------------------------- 3.0053904056549072
Chosen Clients:  [3, 5, 12, 8, 10, 13]

-------------Round number: 258-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.792, 0.842, 0.7, 0.783, 0.725, 0.85, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.436, 116.066, 116.082, 115.429, 118.024, 114.842, 115.828, 116.283, 117.279, 118.205, 115.888, 117.487, 108.08, 112.627, 117.43]
F1 Score:  [0.608, 0.589, 0.746, 0.745, 0.766, 0.647, 0.769, 0.687, 0.816, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.782, 0.817, 0.683, 0.819, 0.738, 0.84, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5844
Averaged Test Accurancy: 0.7361
Averaged Test AUC: 0.9639
Averaged Test F1_score: 0.7097
Averaged Test Recal score: 0.7530
Std Test Accurancy: 0.1834
Std Test AUC: 0.0203
Std Test F1: 0.0016
Std Test Recall: 0.0015
Epoch: 0|  NKD Loss: 0.9601
Epoch: 0|  Loss:  1.4859 |Global loss: 5.8077| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.9668
Epoch: 1|  Loss:  1.4868 |Global loss: 5.7997| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.9627
Epoch: 2|  Loss:  1.4752 |Global loss: 5.8039| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.9742
Epoch: 3|  Loss:  1.4733 |Global loss: 5.7899| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 0|  NKD Loss: 1.0382
Epoch: 0|  Loss:  1.7887 |Global loss: 5.8511| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 1.0491
Epoch: 1|  Loss:  1.8064 |Global loss: 5.842| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 1.0466
Epoch: 2|  Loss:  1.7904 |Global loss: 5.836| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 1.0476
Epoch: 3|  Loss:  1.793 |Global loss: 5.8394| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.1333
Epoch: 0|  Loss:  2.4783 |Global loss: 5.9101| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 1.141
Epoch: 1|  Loss:  2.4623 |Global loss: 5.8997| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 2|  NKD Loss: 1.1565
Epoch: 2|  Loss:  2.4752 |Global loss: 5.8964| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 1.1125
Epoch: 3|  Loss:  2.4727 |Global loss: 5.9159| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 0|  NKD Loss: 1.004
Epoch: 0|  Loss:  1.4605 |Global loss: 5.8175| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9935
Epoch: 1|  Loss:  1.4499 |Global loss: 5.8225| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 1.0047
Epoch: 2|  Loss:  1.4572 |Global loss: 5.8161| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9804
Epoch: 3|  Loss:  1.4336 |Global loss: 5.8294| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 1.0263
Epoch: 0|  Loss:  1.5424 |Global loss: 5.8442| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 1.0265
Epoch: 1|  Loss:  1.5397 |Global loss: 5.8455| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 1.0178
Epoch: 2|  Loss:  1.528 |Global loss: 5.8394| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 1.0205
Epoch: 3|  Loss:  1.5229 |Global loss: 5.8449| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.0334
Epoch: 0|  Loss:  1.8189 |Global loss: 5.8217| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 1.0194
Epoch: 1|  Loss:  1.7816 |Global loss: 5.8277| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 1.0328
Epoch: 2|  Loss:  1.7961 |Global loss: 5.8262| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 1.0365
Epoch: 3|  Loss:  1.7925 |Global loss: 5.8183| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 2.9231557846069336
Chosen Clients:  [10, 4, 3, 5, 8, 0]

-------------Round number: 259-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.833, 0.842, 0.7, 0.783, 0.725, 0.817, 0.983, 0.708, 0.85, 0.275, 0.783, 0.883]
AUC in each clients:  [115.436, 116.066, 116.082, 115.608, 118.024, 114.866, 115.828, 116.283, 117.235, 118.205, 115.911, 117.487, 109.064, 112.664, 117.43]
F1 Score:  [0.608, 0.589, 0.746, 0.808, 0.766, 0.65, 0.769, 0.687, 0.778, 0.981, 0.742, 0.846, 0.255, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.83, 0.817, 0.681, 0.819, 0.738, 0.797, 0.984, 0.789, 0.894, 0.324, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5767
Averaged Test Accurancy: 0.7456
Averaged Test AUC: 0.9645
Averaged Test F1_score: 0.7227
Averaged Test Recal score: 0.7641
Std Test Accurancy: 0.1554
Std Test AUC: 0.0186
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.0033
Epoch: 0|  Loss:  1.5146 |Global loss: 5.853| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 1.0103
Epoch: 1|  Loss:  1.5109 |Global loss: 5.8532| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 1.0033
Epoch: 2|  Loss:  1.5037 |Global loss: 5.8541| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9976
Epoch: 3|  Loss:  1.5016 |Global loss: 5.8562| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.9573
Epoch: 0|  Loss:  1.4653 |Global loss: 5.7639| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.9421
Epoch: 1|  Loss:  1.4369 |Global loss: 5.7695| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.9672
Epoch: 2|  Loss:  1.4743 |Global loss: 5.75| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.9728
Epoch: 3|  Loss:  1.4589 |Global loss: 5.7488| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.9779
Epoch: 0|  Loss:  1.4884 |Global loss: 5.7907| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.9835
Epoch: 1|  Loss:  1.4903 |Global loss: 5.783| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.9896
Epoch: 2|  Loss:  1.4994 |Global loss: 5.7898| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.9812
Epoch: 3|  Loss:  1.4636 |Global loss: 5.7898| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 1.0151
Epoch: 0|  Loss:  1.7481 |Global loss: 5.8611| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 1.0389
Epoch: 1|  Loss:  1.7722 |Global loss: 5.834| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 1.0537
Epoch: 2|  Loss:  1.7573 |Global loss: 5.8233| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 1.0597
Epoch: 3|  Loss:  1.7796 |Global loss: 5.8322| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 1.0019
Epoch: 0|  Loss:  1.4401 |Global loss: 5.817| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 1.002
Epoch: 1|  Loss:  1.4421 |Global loss: 5.8126| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9793
Epoch: 2|  Loss:  1.4084 |Global loss: 5.8264| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9851
Epoch: 3|  Loss:  1.4236 |Global loss: 5.824| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9822
Epoch: 0|  Loss:  1.5992 |Global loss: 5.7895| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.979
Epoch: 1|  Loss:  1.6007 |Global loss: 5.8026| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 1.0107
Epoch: 2|  Loss:  1.6187 |Global loss: 5.7739| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9992
Epoch: 3|  Loss:  1.6052 |Global loss: 5.7815| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 2.8414552211761475
Chosen Clients:  [14, 12, 11, 4, 7, 10]

-------------Round number: 260-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.8, 0.842, 0.717, 0.783, 0.725, 0.792, 0.983, 0.708, 0.85, 0.275, 0.783, 0.883]
AUC in each clients:  [115.458, 116.066, 116.082, 115.543, 118.039, 115.129, 115.828, 116.283, 117.157, 118.205, 115.942, 117.487, 109.064, 112.664, 117.43]
F1 Score:  [0.608, 0.589, 0.746, 0.787, 0.766, 0.653, 0.769, 0.687, 0.73, 0.981, 0.742, 0.846, 0.255, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.807, 0.817, 0.693, 0.819, 0.738, 0.766, 0.984, 0.789, 0.894, 0.324, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5705
Averaged Test Accurancy: 0.7428
Averaged Test AUC: 0.9647
Averaged Test F1_score: 0.7183
Averaged Test Recal score: 0.7613
Std Test Accurancy: 0.1534
Std Test AUC: 0.0186
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9767
Epoch: 0|  Loss:  1.383 |Global loss: 5.8041| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 1|  NKD Loss: 0.9783
Epoch: 1|  Loss:  1.3784 |Global loss: 5.8137| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9853
Epoch: 2|  Loss:  1.3851 |Global loss: 5.8015| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.949
Epoch: 3|  Loss:  1.3531 |Global loss: 5.8171| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 1.1478
Epoch: 0|  Loss:  2.4828 |Global loss: 5.925| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 1.146
Epoch: 1|  Loss:  2.4603 |Global loss: 5.8941| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 1.1522
Epoch: 2|  Loss:  2.446 |Global loss: 5.8945| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 1.1552
Epoch: 3|  Loss:  2.4594 |Global loss: 5.881| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 0.9464
Epoch: 0|  Loss:  1.2781 |Global loss: 5.7662| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.9264
Epoch: 1|  Loss:  1.2588 |Global loss: 5.7765| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.9478
Epoch: 2|  Loss:  1.2753 |Global loss: 5.7682| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9434
Epoch: 3|  Loss:  1.2775 |Global loss: 5.7637| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 0.9422
Epoch: 0|  Loss:  1.4504 |Global loss: 5.77| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9442
Epoch: 1|  Loss:  1.4484 |Global loss: 5.7689| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9572
Epoch: 2|  Loss:  1.4632 |Global loss: 5.7559| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.9399
Epoch: 3|  Loss:  1.4371 |Global loss: 5.7689| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9998
Epoch: 0|  Loss:  1.5693 |Global loss: 5.8271| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 1.0211
Epoch: 1|  Loss:  1.5953 |Global loss: 5.8248| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 1.0139
Epoch: 2|  Loss:  1.5816 |Global loss: 5.8161| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9847
Epoch: 3|  Loss:  1.5367 |Global loss: 5.8321| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 1.0214
Epoch: 0|  Loss:  1.5132 |Global loss: 5.8409| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9811
Epoch: 1|  Loss:  1.4767 |Global loss: 5.8659| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 1.0063
Epoch: 2|  Loss:  1.5006 |Global loss: 5.8439| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 1.0003
Epoch: 3|  Loss:  1.4917 |Global loss: 5.8468| Local H loss: 0.0379  | Global H loss: 0.0379
------------------------- time cost ------------------------- 2.9420063495635986
Chosen Clients:  [14, 6, 11, 10, 5, 4]

-------------Round number: 261-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.8, 0.833, 0.717, 0.783, 0.842, 0.792, 0.983, 0.708, 0.85, 0.192, 0.783, 0.883]
AUC in each clients:  [115.458, 116.066, 116.082, 115.543, 118.023, 115.129, 115.828, 116.563, 117.157, 118.205, 116.045, 117.536, 108.327, 112.664, 117.445]
F1 Score:  [0.608, 0.589, 0.746, 0.787, 0.761, 0.653, 0.769, 0.812, 0.73, 0.981, 0.738, 0.846, 0.166, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.807, 0.81, 0.693, 0.819, 0.836, 0.766, 0.984, 0.789, 0.894, 0.231, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5692
Averaged Test Accurancy: 0.7444
Averaged Test AUC: 0.9645
Averaged Test F1_score: 0.7201
Averaged Test Recal score: 0.7612
Std Test Accurancy: 0.1724
Std Test AUC: 0.0199
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9646
Epoch: 0|  Loss:  1.3487 |Global loss: 5.8058| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9487
Epoch: 1|  Loss:  1.3326 |Global loss: 5.8241| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9593
Epoch: 2|  Loss:  1.3517 |Global loss: 5.8126| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.9649
Epoch: 3|  Loss:  1.3563 |Global loss: 5.8149| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.9865
Epoch: 0|  Loss:  1.5582 |Global loss: 5.8107| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.9863
Epoch: 1|  Loss:  1.5553 |Global loss: 5.8122| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.9916
Epoch: 2|  Loss:  1.5517 |Global loss: 5.8023| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9957
Epoch: 3|  Loss:  1.5505 |Global loss: 5.8072| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 0.9387
Epoch: 0|  Loss:  1.268 |Global loss: 5.7711| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.9444
Epoch: 1|  Loss:  1.2726 |Global loss: 5.7648| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.9307
Epoch: 2|  Loss:  1.26 |Global loss: 5.7761| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.9366
Epoch: 3|  Loss:  1.2502 |Global loss: 5.7691| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 0|  NKD Loss: 1.022
Epoch: 0|  Loss:  1.5053 |Global loss: 5.8318| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.9844
Epoch: 1|  Loss:  1.4686 |Global loss: 5.8625| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9967
Epoch: 2|  Loss:  1.4809 |Global loss: 5.85| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.985
Epoch: 3|  Loss:  1.4726 |Global loss: 5.8583| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 1.0508
Epoch: 0|  Loss:  1.7737 |Global loss: 5.8301| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.0302
Epoch: 1|  Loss:  1.7425 |Global loss: 5.8428| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 1.0538
Epoch: 2|  Loss:  1.7694 |Global loss: 5.8291| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 1.0492
Epoch: 3|  Loss:  1.7598 |Global loss: 5.8308| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.9612
Epoch: 0|  Loss:  1.4702 |Global loss: 5.7583| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9385
Epoch: 1|  Loss:  1.4571 |Global loss: 5.773| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9356
Epoch: 2|  Loss:  1.4315 |Global loss: 5.7676| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9388
Epoch: 3|  Loss:  1.4425 |Global loss: 5.7671| Local H loss: 0.0281  | Global H loss: 0.0281
------------------------- time cost ------------------------- 2.9465911388397217
Chosen Clients:  [8, 11, 9, 10, 13, 4]

-------------Round number: 262-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.8, 0.833, 0.708, 0.775, 0.842, 0.792, 0.983, 0.708, 0.85, 0.192, 0.783, 0.883]
AUC in each clients:  [115.458, 116.066, 116.082, 115.543, 118.002, 115.072, 115.851, 116.563, 117.157, 118.205, 116.067, 117.544, 108.327, 112.664, 117.295]
F1 Score:  [0.608, 0.589, 0.746, 0.787, 0.761, 0.651, 0.751, 0.812, 0.73, 0.981, 0.738, 0.846, 0.166, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.807, 0.81, 0.688, 0.81, 0.836, 0.766, 0.984, 0.789, 0.894, 0.231, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5646
Averaged Test Accurancy: 0.7433
Averaged Test AUC: 0.9644
Averaged Test F1_score: 0.7188
Averaged Test Recal score: 0.7603
Std Test Accurancy: 0.1724
Std Test AUC: 0.0198
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9985
Epoch: 0|  Loss:  1.4302 |Global loss: 5.8094| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9902
Epoch: 1|  Loss:  1.4223 |Global loss: 5.8202| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9778
Epoch: 2|  Loss:  1.4154 |Global loss: 5.8309| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9858
Epoch: 3|  Loss:  1.4127 |Global loss: 5.8201| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.942
Epoch: 0|  Loss:  1.2638 |Global loss: 5.7654| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.941
Epoch: 1|  Loss:  1.2648 |Global loss: 5.7628| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 2|  NKD Loss: 0.9539
Epoch: 2|  Loss:  1.2781 |Global loss: 5.7538| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.9342
Epoch: 3|  Loss:  1.2547 |Global loss: 5.771| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.959
Epoch: 0|  Loss:  1.2796 |Global loss: 5.7744| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.9435
Epoch: 1|  Loss:  1.2641 |Global loss: 5.7912| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.9523
Epoch: 2|  Loss:  1.2582 |Global loss: 5.7825| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.929
Epoch: 3|  Loss:  1.2466 |Global loss: 5.7956| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 1.0106
Epoch: 0|  Loss:  1.4848 |Global loss: 5.8366| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 1.0059
Epoch: 1|  Loss:  1.4866 |Global loss: 5.8402| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9952
Epoch: 2|  Loss:  1.4706 |Global loss: 5.8524| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 1.0022
Epoch: 3|  Loss:  1.4742 |Global loss: 5.8397| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.0275
Epoch: 0|  Loss:  1.7875 |Global loss: 5.8223| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 1.0121
Epoch: 1|  Loss:  1.7686 |Global loss: 5.8272| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 1.0365
Epoch: 2|  Loss:  1.7756 |Global loss: 5.8252| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 1.0111
Epoch: 3|  Loss:  1.7688 |Global loss: 5.8188| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.9518
Epoch: 0|  Loss:  1.4629 |Global loss: 5.7656| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9459
Epoch: 1|  Loss:  1.4415 |Global loss: 5.7647| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9465
Epoch: 2|  Loss:  1.436 |Global loss: 5.7619| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9544
Epoch: 3|  Loss:  1.4611 |Global loss: 5.7607| Local H loss: 0.0279  | Global H loss: 0.0279
------------------------- time cost ------------------------- 3.026667833328247
Chosen Clients:  [3, 12, 10, 7, 11, 13]

-------------Round number: 263-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.8, 0.842, 0.708, 0.775, 0.842, 0.808, 0.983, 0.708, 0.85, 0.192, 0.767, 0.883]
AUC in each clients:  [115.458, 116.066, 116.082, 115.543, 118.014, 115.072, 115.851, 116.563, 117.272, 118.195, 116.012, 117.592, 108.327, 112.644, 117.295]
F1 Score:  [0.608, 0.589, 0.746, 0.787, 0.766, 0.651, 0.751, 0.812, 0.743, 0.981, 0.742, 0.846, 0.166, 0.75, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.807, 0.817, 0.688, 0.81, 0.836, 0.783, 0.984, 0.789, 0.894, 0.231, 0.796, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5551
Averaged Test Accurancy: 0.7439
Averaged Test AUC: 0.9644
Averaged Test F1_score: 0.7197
Averaged Test Recal score: 0.7609
Std Test Accurancy: 0.1728
Std Test AUC: 0.0199
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9605
Epoch: 0|  Loss:  1.4531 |Global loss: 5.7995| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.9767
Epoch: 1|  Loss:  1.4674 |Global loss: 5.7863| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.9667
Epoch: 2|  Loss:  1.467 |Global loss: 5.7968| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 3|  NKD Loss: 0.9801
Epoch: 3|  Loss:  1.4671 |Global loss: 5.7834| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 1.1234
Epoch: 0|  Loss:  2.4186 |Global loss: 5.9131| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 1.1226
Epoch: 1|  Loss:  2.4343 |Global loss: 5.9147| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 1.1374
Epoch: 2|  Loss:  2.4207 |Global loss: 5.8997| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 3|  NKD Loss: 1.1316
Epoch: 3|  Loss:  2.428 |Global loss: 5.9002| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 0.9945
Epoch: 0|  Loss:  1.4611 |Global loss: 5.837| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.9998
Epoch: 1|  Loss:  1.4665 |Global loss: 5.8395| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9704
Epoch: 2|  Loss:  1.4397 |Global loss: 5.8607| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9716
Epoch: 3|  Loss:  1.4431 |Global loss: 5.8579| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 1.0086
Epoch: 0|  Loss:  1.5447 |Global loss: 5.815| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.9999
Epoch: 1|  Loss:  1.5277 |Global loss: 5.828| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 1.0173
Epoch: 2|  Loss:  1.545 |Global loss: 5.8068| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 3|  NKD Loss: 0.9889
Epoch: 3|  Loss:  1.5203 |Global loss: 5.8236| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.9304
Epoch: 0|  Loss:  1.2431 |Global loss: 5.7703| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9294
Epoch: 1|  Loss:  1.2402 |Global loss: 5.7711| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9235
Epoch: 2|  Loss:  1.2458 |Global loss: 5.7745| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.9412
Epoch: 3|  Loss:  1.2417 |Global loss: 5.7727| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.014
Epoch: 0|  Loss:  1.7533 |Global loss: 5.8288| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 1.0232
Epoch: 1|  Loss:  1.7681 |Global loss: 5.8181| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 1.0021
Epoch: 2|  Loss:  1.7658 |Global loss: 5.825| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9935
Epoch: 3|  Loss:  1.7346 |Global loss: 5.8398| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 2.7356908321380615
Chosen Clients:  [5, 0, 12, 14, 3, 6]

-------------Round number: 264-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.875, 0.842, 0.708, 0.775, 0.917, 0.808, 0.983, 0.708, 0.85, 0.192, 0.783, 0.883]
AUC in each clients:  [115.458, 116.066, 116.082, 115.937, 118.014, 115.072, 115.851, 117.113, 117.272, 118.195, 116.134, 117.441, 108.752, 112.941, 117.295]
F1 Score:  [0.608, 0.589, 0.746, 0.838, 0.766, 0.651, 0.751, 0.912, 0.743, 0.981, 0.742, 0.846, 0.166, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.866, 0.817, 0.688, 0.81, 0.922, 0.783, 0.984, 0.789, 0.894, 0.231, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5504
Averaged Test Accurancy: 0.7550
Averaged Test AUC: 0.9653
Averaged Test F1_score: 0.7303
Averaged Test Recal score: 0.7715
Std Test Accurancy: 0.1792
Std Test AUC: 0.0190
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 1.0488
Epoch: 0|  Loss:  1.7636 |Global loss: 5.8303| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 1.0344
Epoch: 1|  Loss:  1.7422 |Global loss: 5.8407| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 1.0463
Epoch: 2|  Loss:  1.752 |Global loss: 5.836| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 1.0395
Epoch: 3|  Loss:  1.7426 |Global loss: 5.8391| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 0|  NKD Loss: 0.9898
Epoch: 0|  Loss:  1.6039 |Global loss: 5.7887| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9843
Epoch: 1|  Loss:  1.5954 |Global loss: 5.7917| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9968
Epoch: 2|  Loss:  1.6078 |Global loss: 5.7828| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 1.0026
Epoch: 3|  Loss:  1.595 |Global loss: 5.7759| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.1057
Epoch: 0|  Loss:  2.3911 |Global loss: 5.9254| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 1.1269
Epoch: 1|  Loss:  2.398 |Global loss: 5.9041| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 1.1328
Epoch: 2|  Loss:  2.3912 |Global loss: 5.9064| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 1.1392
Epoch: 3|  Loss:  2.4038 |Global loss: 5.8973| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9799
Epoch: 0|  Loss:  1.3672 |Global loss: 5.7993| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9517
Epoch: 1|  Loss:  1.329 |Global loss: 5.8153| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9822
Epoch: 2|  Loss:  1.367 |Global loss: 5.7916| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.9563
Epoch: 3|  Loss:  1.3307 |Global loss: 5.8083| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9785
Epoch: 0|  Loss:  1.47 |Global loss: 5.787| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.964
Epoch: 1|  Loss:  1.4509 |Global loss: 5.7955| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.9642
Epoch: 2|  Loss:  1.4438 |Global loss: 5.7899| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.9427
Epoch: 3|  Loss:  1.4148 |Global loss: 5.8006| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.9575
Epoch: 0|  Loss:  1.5174 |Global loss: 5.8215| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 1.0029
Epoch: 1|  Loss:  1.554 |Global loss: 5.7976| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 1.0127
Epoch: 2|  Loss:  1.5736 |Global loss: 5.7923| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.9871
Epoch: 3|  Loss:  1.5382 |Global loss: 5.8048| Local H loss: 0.0298  | Global H loss: 0.0298
------------------------- time cost ------------------------- 2.954521417617798
Chosen Clients:  [8, 0, 13, 9, 4, 10]

-------------Round number: 265-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.625, 0.642, 0.733, 0.875, 0.842, 0.7, 0.783, 0.917, 0.808, 0.983, 0.708, 0.85, 0.142, 0.783, 0.883]
AUC in each clients:  [115.47, 116.066, 116.082, 116.124, 118.014, 115.292, 115.934, 117.113, 117.272, 118.195, 116.134, 117.441, 108.861, 112.941, 117.663]
F1 Score:  [0.608, 0.589, 0.746, 0.836, 0.766, 0.646, 0.769, 0.912, 0.743, 0.981, 0.742, 0.846, 0.088, 0.759, 0.857]
Recall Score:  [0.663, 0.642, 0.774, 0.862, 0.817, 0.681, 0.819, 0.922, 0.783, 0.984, 0.789, 0.894, 0.16, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5568
Averaged Test Accurancy: 0.7517
Averaged Test AUC: 0.9659
Averaged Test F1_score: 0.7259
Averaged Test Recal score: 0.7667
Std Test Accurancy: 0.1900
Std Test AUC: 0.0190
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 0.9742
Epoch: 0|  Loss:  1.4042 |Global loss: 5.8214| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9848
Epoch: 1|  Loss:  1.4011 |Global loss: 5.8175| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9697
Epoch: 2|  Loss:  1.3905 |Global loss: 5.8165| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9793
Epoch: 3|  Loss:  1.4005 |Global loss: 5.8164| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9824
Epoch: 0|  Loss:  1.5751 |Global loss: 5.786| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9825
Epoch: 1|  Loss:  1.5944 |Global loss: 5.79| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9841
Epoch: 2|  Loss:  1.5887 |Global loss: 5.7935| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.971
Epoch: 3|  Loss:  1.5685 |Global loss: 5.7942| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 1.0105
Epoch: 0|  Loss:  1.7575 |Global loss: 5.82| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 1.0287
Epoch: 1|  Loss:  1.7569 |Global loss: 5.8146| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 1.0038
Epoch: 2|  Loss:  1.7275 |Global loss: 5.8316| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 1.0178
Epoch: 3|  Loss:  1.7589 |Global loss: 5.8063| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.9322
Epoch: 0|  Loss:  1.2454 |Global loss: 5.7875| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 0.9503
Epoch: 1|  Loss:  1.267 |Global loss: 5.7794| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.9599
Epoch: 2|  Loss:  1.2721 |Global loss: 5.7703| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.9501
Epoch: 3|  Loss:  1.2686 |Global loss: 5.7757| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.9279
Epoch: 0|  Loss:  1.4304 |Global loss: 5.7665| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9576
Epoch: 1|  Loss:  1.4616 |Global loss: 5.7581| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9507
Epoch: 2|  Loss:  1.4554 |Global loss: 5.7537| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9594
Epoch: 3|  Loss:  1.4604 |Global loss: 5.7487| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 1.0097
Epoch: 0|  Loss:  1.4646 |Global loss: 5.8275| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.9919
Epoch: 1|  Loss:  1.444 |Global loss: 5.8408| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.9979
Epoch: 2|  Loss:  1.4588 |Global loss: 5.8364| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9978
Epoch: 3|  Loss:  1.4498 |Global loss: 5.8327| Local H loss: 0.0382  | Global H loss: 0.0382
------------------------- time cost ------------------------- 2.668118476867676
Chosen Clients:  [10, 4, 12, 1, 2, 11]

-------------Round number: 266-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.667, 0.642, 0.733, 0.875, 0.842, 0.7, 0.783, 0.917, 0.875, 0.983, 0.708, 0.85, 0.142, 0.775, 0.883]
AUC in each clients:  [115.505, 116.066, 116.082, 116.124, 118.025, 115.292, 115.934, 117.113, 117.436, 118.293, 116.077, 117.441, 108.861, 113.064, 117.663]
F1 Score:  [0.669, 0.589, 0.746, 0.836, 0.766, 0.646, 0.769, 0.912, 0.835, 0.981, 0.742, 0.846, 0.088, 0.755, 0.857]
Recall Score:  [0.709, 0.642, 0.774, 0.862, 0.817, 0.681, 0.819, 0.922, 0.865, 0.984, 0.789, 0.894, 0.16, 0.803, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5514
Averaged Test Accurancy: 0.7583
Averaged Test AUC: 0.9661
Averaged Test F1_score: 0.7358
Averaged Test Recal score: 0.7747
Std Test Accurancy: 0.1904
Std Test AUC: 0.0190
Std Test F1: 0.0017
Std Test Recall: 0.0016
Epoch: 0|  NKD Loss: 1.0042
Epoch: 0|  Loss:  1.4626 |Global loss: 5.8247| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.9912
Epoch: 1|  Loss:  1.4398 |Global loss: 5.8343| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9993
Epoch: 2|  Loss:  1.4511 |Global loss: 5.826| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9885
Epoch: 3|  Loss:  1.4328 |Global loss: 5.8349| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9311
Epoch: 0|  Loss:  1.4348 |Global loss: 5.773| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9196
Epoch: 1|  Loss:  1.4195 |Global loss: 5.7809| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9527
Epoch: 2|  Loss:  1.4409 |Global loss: 5.7524| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9582
Epoch: 3|  Loss:  1.4614 |Global loss: 5.7491| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.1397
Epoch: 0|  Loss:  2.411 |Global loss: 5.9008| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.1358
Epoch: 1|  Loss:  2.3785 |Global loss: 5.9022| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 1.147
Epoch: 2|  Loss:  2.4021 |Global loss: 5.8911| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 1.1319
Epoch: 3|  Loss:  2.3974 |Global loss: 5.9025| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 1.0191
Epoch: 0|  Loss:  1.6585 |Global loss: 5.8443| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0223
Epoch: 1|  Loss:  1.6289 |Global loss: 5.8402| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0094
Epoch: 2|  Loss:  1.6434 |Global loss: 5.8552| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0243
Epoch: 3|  Loss:  1.6464 |Global loss: 5.836| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0224
Epoch: 0|  Loss:  1.5095 |Global loss: 5.8162| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 1.0029
Epoch: 1|  Loss:  1.4989 |Global loss: 5.8332| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 1.0111
Epoch: 2|  Loss:  1.5039 |Global loss: 5.8275| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9942
Epoch: 3|  Loss:  1.4874 |Global loss: 5.8511| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9544
Epoch: 0|  Loss:  1.2746 |Global loss: 5.7531| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.926
Epoch: 1|  Loss:  1.2367 |Global loss: 5.7719| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.9269
Epoch: 2|  Loss:  1.236 |Global loss: 5.7744| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.9378
Epoch: 3|  Loss:  1.227 |Global loss: 5.7669| Local H loss: 0.0303  | Global H loss: 0.0303
------------------------- time cost ------------------------- 3.0814805030822754
Chosen Clients:  [6, 5, 8, 13, 1, 2]

-------------Round number: 267-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.667, 0.642, 0.725, 0.875, 0.842, 0.7, 0.783, 0.917, 0.875, 0.983, 0.708, 0.85, 0.275, 0.775, 0.883]
AUC in each clients:  [115.505, 116.219, 116.123, 116.124, 118.028, 115.292, 115.934, 117.113, 117.436, 118.293, 116.198, 117.573, 109.981, 113.064, 117.663]
F1 Score:  [0.669, 0.589, 0.716, 0.836, 0.766, 0.646, 0.769, 0.912, 0.835, 0.981, 0.738, 0.846, 0.255, 0.755, 0.857]
Recall Score:  [0.709, 0.642, 0.769, 0.862, 0.817, 0.681, 0.819, 0.922, 0.865, 0.984, 0.789, 0.894, 0.324, 0.803, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5345
Averaged Test Accurancy: 0.7667
Averaged Test AUC: 0.9670
Averaged Test F1_score: 0.7447
Averaged Test Recal score: 0.7853
Std Test Accurancy: 0.1626
Std Test AUC: 0.0172
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.9924
Epoch: 0|  Loss:  1.5459 |Global loss: 5.8039| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.9759
Epoch: 1|  Loss:  1.5229 |Global loss: 5.8204| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.9862
Epoch: 2|  Loss:  1.5428 |Global loss: 5.8041| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.995
Epoch: 3|  Loss:  1.5261 |Global loss: 5.8009| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.0409
Epoch: 0|  Loss:  1.7501 |Global loss: 5.8339| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.0473
Epoch: 1|  Loss:  1.7429 |Global loss: 5.8303| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.0204
Epoch: 2|  Loss:  1.7159 |Global loss: 5.8477| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 1.0479
Epoch: 3|  Loss:  1.7347 |Global loss: 5.825| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 0|  NKD Loss: 0.9812
Epoch: 0|  Loss:  1.3975 |Global loss: 5.818| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9926
Epoch: 1|  Loss:  1.408 |Global loss: 5.8109| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9785
Epoch: 2|  Loss:  1.4003 |Global loss: 5.8227| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9925
Epoch: 3|  Loss:  1.4127 |Global loss: 5.8031| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 1.0156
Epoch: 0|  Loss:  1.7373 |Global loss: 5.826| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 1.0041
Epoch: 1|  Loss:  1.7368 |Global loss: 5.8182| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 1.0117
Epoch: 2|  Loss:  1.7424 |Global loss: 5.816| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 1.0134
Epoch: 3|  Loss:  1.7193 |Global loss: 5.8116| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 1.0287
Epoch: 0|  Loss:  1.6553 |Global loss: 5.8339| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0262
Epoch: 1|  Loss:  1.6362 |Global loss: 5.8408| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.996
Epoch: 2|  Loss:  1.6176 |Global loss: 5.856| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9934
Epoch: 3|  Loss:  1.5791 |Global loss: 5.8578| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9906
Epoch: 0|  Loss:  1.4684 |Global loss: 5.8358| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 1.0172
Epoch: 1|  Loss:  1.5037 |Global loss: 5.8338| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.9993
Epoch: 2|  Loss:  1.4875 |Global loss: 5.8425| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9961
Epoch: 3|  Loss:  1.4937 |Global loss: 5.8457| Local H loss: 0.0351  | Global H loss: 0.0351
------------------------- time cost ------------------------- 2.935643434524536
Chosen Clients:  [11, 4, 12, 9, 2, 3]

-------------Round number: 268-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.667, 0.642, 0.758, 0.875, 0.842, 0.717, 0.783, 0.917, 0.883, 0.983, 0.708, 0.85, 0.275, 0.783, 0.883]
AUC in each clients:  [115.505, 116.41, 115.914, 116.124, 118.028, 115.466, 115.973, 117.113, 117.539, 118.293, 116.198, 117.573, 109.981, 113.181, 117.663]
F1 Score:  [0.669, 0.589, 0.778, 0.836, 0.766, 0.653, 0.769, 0.912, 0.853, 0.981, 0.738, 0.846, 0.255, 0.759, 0.857]
Recall Score:  [0.709, 0.642, 0.806, 0.862, 0.817, 0.693, 0.819, 0.922, 0.874, 0.984, 0.789, 0.894, 0.324, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5341
Averaged Test Accurancy: 0.7711
Averaged Test AUC: 0.9672
Averaged Test F1_score: 0.7507
Averaged Test Recal score: 0.7897
Std Test Accurancy: 0.1622
Std Test AUC: 0.0171
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.9488
Epoch: 0|  Loss:  1.2604 |Global loss: 5.7564| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.9314
Epoch: 1|  Loss:  1.242 |Global loss: 5.7624| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9197
Epoch: 2|  Loss:  1.2167 |Global loss: 5.7745| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 3|  NKD Loss: 0.9423
Epoch: 3|  Loss:  1.2433 |Global loss: 5.7631| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.901
Epoch: 0|  Loss:  1.4029 |Global loss: 5.787| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.954
Epoch: 1|  Loss:  1.4426 |Global loss: 5.7526| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9181
Epoch: 2|  Loss:  1.4087 |Global loss: 5.7797| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9594
Epoch: 3|  Loss:  1.4618 |Global loss: 5.743| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 1.1008
Epoch: 0|  Loss:  2.3424 |Global loss: 5.9249| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 1.1304
Epoch: 1|  Loss:  2.3652 |Global loss: 5.9061| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 1.1379
Epoch: 2|  Loss:  2.3886 |Global loss: 5.8954| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 1.137
Epoch: 3|  Loss:  2.3456 |Global loss: 5.9047| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.9538
Epoch: 0|  Loss:  1.27 |Global loss: 5.7725| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 0.9296
Epoch: 1|  Loss:  1.2439 |Global loss: 5.786| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.9279
Epoch: 2|  Loss:  1.2413 |Global loss: 5.7875| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.9258
Epoch: 3|  Loss:  1.2358 |Global loss: 5.7913| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9992
Epoch: 0|  Loss:  1.5015 |Global loss: 5.8496| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.9973
Epoch: 1|  Loss:  1.4768 |Global loss: 5.8392| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.9896
Epoch: 2|  Loss:  1.4589 |Global loss: 5.8398| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.9803
Epoch: 3|  Loss:  1.4417 |Global loss: 5.8463| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.9585
Epoch: 0|  Loss:  1.4394 |Global loss: 5.7932| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.9596
Epoch: 1|  Loss:  1.4356 |Global loss: 5.7931| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.9701
Epoch: 2|  Loss:  1.4438 |Global loss: 5.7897| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.9557
Epoch: 3|  Loss:  1.4305 |Global loss: 5.7946| Local H loss: 0.0406  | Global H loss: 0.0406
------------------------- time cost ------------------------- 3.0683767795562744
Chosen Clients:  [13, 0, 2, 14, 8, 10]

-------------Round number: 269-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.667, 0.642, 0.775, 0.883, 0.842, 0.717, 0.783, 0.917, 0.883, 0.983, 0.708, 0.85, 0.2, 0.783, 0.883]
AUC in each clients:  [115.505, 116.41, 116.307, 116.378, 118.03, 115.466, 115.973, 117.113, 117.539, 118.283, 116.198, 117.673, 109.299, 113.181, 117.663]
F1 Score:  [0.669, 0.589, 0.751, 0.842, 0.766, 0.653, 0.769, 0.912, 0.853, 0.981, 0.738, 0.846, 0.162, 0.759, 0.857]
Recall Score:  [0.709, 0.642, 0.81, 0.872, 0.817, 0.693, 0.819, 0.922, 0.874, 0.984, 0.789, 0.894, 0.225, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5333
Averaged Test Accurancy: 0.7678
Averaged Test AUC: 0.9672
Averaged Test F1_score: 0.7431
Averaged Test Recal score: 0.7840
Std Test Accurancy: 0.1782
Std Test AUC: 0.0183
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9878
Epoch: 0|  Loss:  1.6915 |Global loss: 5.8296| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9836
Epoch: 1|  Loss:  1.6833 |Global loss: 5.8323| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 1.0062
Epoch: 2|  Loss:  1.7168 |Global loss: 5.8106| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 1.0028
Epoch: 3|  Loss:  1.7081 |Global loss: 5.826| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9644
Epoch: 0|  Loss:  1.5548 |Global loss: 5.8004| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.983
Epoch: 1|  Loss:  1.576 |Global loss: 5.7922| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9918
Epoch: 2|  Loss:  1.5851 |Global loss: 5.7816| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9912
Epoch: 3|  Loss:  1.5663 |Global loss: 5.7783| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.993
Epoch: 0|  Loss:  1.4738 |Global loss: 5.8474| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.9932
Epoch: 1|  Loss:  1.4533 |Global loss: 5.8333| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 1.0014
Epoch: 2|  Loss:  1.4673 |Global loss: 5.8231| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9898
Epoch: 3|  Loss:  1.4501 |Global loss: 5.8416| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9731
Epoch: 0|  Loss:  1.3359 |Global loss: 5.7955| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9726
Epoch: 1|  Loss:  1.354 |Global loss: 5.8037| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9658
Epoch: 2|  Loss:  1.3392 |Global loss: 5.7997| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9436
Epoch: 3|  Loss:  1.3255 |Global loss: 5.8159| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9657
Epoch: 0|  Loss:  1.3651 |Global loss: 5.8147| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9689
Epoch: 1|  Loss:  1.3746 |Global loss: 5.8218| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9678
Epoch: 2|  Loss:  1.3745 |Global loss: 5.8204| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9787
Epoch: 3|  Loss:  1.3894 |Global loss: 5.8129| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9818
Epoch: 0|  Loss:  1.4228 |Global loss: 5.8448| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.9979
Epoch: 1|  Loss:  1.4318 |Global loss: 5.8206| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9879
Epoch: 2|  Loss:  1.4357 |Global loss: 5.831| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9721
Epoch: 3|  Loss:  1.4136 |Global loss: 5.8431| Local H loss: 0.0381  | Global H loss: 0.0381
------------------------- time cost ------------------------- 3.00628662109375
Chosen Clients:  [14, 4, 12, 8, 10, 2]

-------------Round number: 270-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.642, 0.75, 0.883, 0.842, 0.717, 0.783, 0.917, 0.867, 0.983, 0.708, 0.85, 0.2, 0.783, 0.883]
AUC in each clients:  [115.536, 116.41, 116.274, 116.378, 118.03, 115.466, 115.973, 117.113, 117.398, 118.283, 116.179, 117.673, 109.299, 113.244, 117.637]
F1 Score:  [0.684, 0.589, 0.746, 0.842, 0.766, 0.653, 0.769, 0.912, 0.829, 0.981, 0.738, 0.846, 0.162, 0.759, 0.857]
Recall Score:  [0.728, 0.642, 0.785, 0.872, 0.817, 0.693, 0.819, 0.922, 0.856, 0.984, 0.789, 0.894, 0.225, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5264
Averaged Test Accurancy: 0.7661
Averaged Test AUC: 0.9672
Averaged Test F1_score: 0.7422
Averaged Test Recal score: 0.7824
Std Test Accurancy: 0.1769
Std Test AUC: 0.0182
Std Test F1: 0.0015
Std Test Recall: 0.0014
Epoch: 0|  NKD Loss: 0.9732
Epoch: 0|  Loss:  1.3454 |Global loss: 5.8052| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9632
Epoch: 1|  Loss:  1.3325 |Global loss: 5.7955| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9679
Epoch: 2|  Loss:  1.3376 |Global loss: 5.7945| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9529
Epoch: 3|  Loss:  1.3244 |Global loss: 5.8068| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9493
Epoch: 0|  Loss:  1.4283 |Global loss: 5.7601| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9353
Epoch: 1|  Loss:  1.4324 |Global loss: 5.7596| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9427
Epoch: 2|  Loss:  1.4319 |Global loss: 5.7603| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9548
Epoch: 3|  Loss:  1.4327 |Global loss: 5.7432| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.1105
Epoch: 0|  Loss:  2.3474 |Global loss: 5.9074| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.1316
Epoch: 1|  Loss:  2.3471 |Global loss: 5.8975| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.1362
Epoch: 2|  Loss:  2.3715 |Global loss: 5.9125| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.1129
Epoch: 3|  Loss:  2.329 |Global loss: 5.9065| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9762
Epoch: 0|  Loss:  1.3752 |Global loss: 5.8071| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9711
Epoch: 1|  Loss:  1.3695 |Global loss: 5.8173| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9755
Epoch: 2|  Loss:  1.3722 |Global loss: 5.8125| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9786
Epoch: 3|  Loss:  1.3686 |Global loss: 5.8081| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9809
Epoch: 0|  Loss:  1.4241 |Global loss: 5.8384| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9939
Epoch: 1|  Loss:  1.4275 |Global loss: 5.823| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9792
Epoch: 2|  Loss:  1.4223 |Global loss: 5.8368| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.9927
Epoch: 3|  Loss:  1.4247 |Global loss: 5.8245| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9932
Epoch: 0|  Loss:  1.4436 |Global loss: 5.8326| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.9902
Epoch: 1|  Loss:  1.4452 |Global loss: 5.8395| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 0.9985
Epoch: 2|  Loss:  1.4531 |Global loss: 5.8398| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9929
Epoch: 3|  Loss:  1.4614 |Global loss: 5.8377| Local H loss: 0.0356  | Global H loss: 0.0356
------------------------- time cost ------------------------- 3.017338275909424
Chosen Clients:  [1, 9, 13, 5, 10, 8]

-------------Round number: 271-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.642, 0.783, 0.883, 0.833, 0.717, 0.783, 0.917, 0.958, 0.983, 0.708, 0.85, 0.275, 0.783, 0.883]
AUC in each clients:  [115.536, 116.41, 116.369, 116.378, 118.031, 115.466, 115.973, 117.113, 117.782, 118.283, 116.233, 117.673, 110.465, 113.244, 117.668]
F1 Score:  [0.684, 0.589, 0.768, 0.842, 0.761, 0.653, 0.769, 0.912, 0.95, 0.981, 0.738, 0.846, 0.25, 0.759, 0.857]
Recall Score:  [0.728, 0.642, 0.819, 0.872, 0.81, 0.693, 0.819, 0.922, 0.958, 0.984, 0.789, 0.894, 0.324, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5175
Averaged Test Accurancy: 0.7789
Averaged Test AUC: 0.9681
Averaged Test F1_score: 0.7573
Averaged Test Recal score: 0.7976
Std Test Accurancy: 0.1661
Std Test AUC: 0.0164
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 1.023
Epoch: 0|  Loss:  1.636 |Global loss: 5.8431| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0055
Epoch: 1|  Loss:  1.6087 |Global loss: 5.849| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.003
Epoch: 2|  Loss:  1.5966 |Global loss: 5.8504| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 1.0048
Epoch: 3|  Loss:  1.6021 |Global loss: 5.8519| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9386
Epoch: 0|  Loss:  1.235 |Global loss: 5.7784| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 1|  NKD Loss: 0.9177
Epoch: 1|  Loss:  1.2249 |Global loss: 5.7963| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9242
Epoch: 2|  Loss:  1.2155 |Global loss: 5.7932| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 3|  NKD Loss: 0.9484
Epoch: 3|  Loss:  1.2575 |Global loss: 5.7707| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9803
Epoch: 0|  Loss:  1.6803 |Global loss: 5.8366| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 1.0213
Epoch: 1|  Loss:  1.714 |Global loss: 5.8164| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9884
Epoch: 2|  Loss:  1.7064 |Global loss: 5.8211| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.993
Epoch: 3|  Loss:  1.679 |Global loss: 5.8229| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 1.0163
Epoch: 0|  Loss:  1.7105 |Global loss: 5.8462| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 1.0382
Epoch: 1|  Loss:  1.7033 |Global loss: 5.8309| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.0243
Epoch: 2|  Loss:  1.7073 |Global loss: 5.845| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 1.0383
Epoch: 3|  Loss:  1.7289 |Global loss: 5.8321| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.0032
Epoch: 0|  Loss:  1.4348 |Global loss: 5.8178| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9903
Epoch: 1|  Loss:  1.4239 |Global loss: 5.8223| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.952
Epoch: 2|  Loss:  1.3748 |Global loss: 5.8515| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.9648
Epoch: 3|  Loss:  1.3949 |Global loss: 5.8419| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.9566
Epoch: 0|  Loss:  1.3511 |Global loss: 5.8263| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9816
Epoch: 1|  Loss:  1.3731 |Global loss: 5.8107| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9647
Epoch: 2|  Loss:  1.3593 |Global loss: 5.8164| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9623
Epoch: 3|  Loss:  1.3484 |Global loss: 5.8038| Local H loss: 0.0373  | Global H loss: 0.0373
------------------------- time cost ------------------------- 2.897706985473633
Chosen Clients:  [6, 9, 8, 3, 11, 12]

-------------Round number: 272-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.642, 0.783, 0.883, 0.833, 0.708, 0.783, 0.917, 0.958, 0.983, 0.708, 0.85, 0.275, 0.783, 0.883]
AUC in each clients:  [115.536, 116.417, 116.369, 116.378, 118.031, 115.31, 115.973, 117.113, 117.726, 118.28, 116.242, 117.673, 110.465, 113.377, 117.668]
F1 Score:  [0.684, 0.589, 0.768, 0.842, 0.761, 0.651, 0.769, 0.912, 0.95, 0.981, 0.742, 0.846, 0.25, 0.759, 0.857]
Recall Score:  [0.728, 0.642, 0.819, 0.872, 0.81, 0.688, 0.819, 0.922, 0.958, 0.984, 0.789, 0.894, 0.324, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5115
Averaged Test Accurancy: 0.7783
Averaged Test AUC: 0.9681
Averaged Test F1_score: 0.7574
Averaged Test Recal score: 0.7973
Std Test Accurancy: 0.1663
Std Test AUC: 0.0163
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.9841
Epoch: 0|  Loss:  1.5273 |Global loss: 5.8054| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.9873
Epoch: 1|  Loss:  1.5137 |Global loss: 5.8062| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.9797
Epoch: 2|  Loss:  1.5262 |Global loss: 5.8073| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.9882
Epoch: 3|  Loss:  1.5332 |Global loss: 5.7993| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 0.937
Epoch: 0|  Loss:  1.2426 |Global loss: 5.7781| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.9281
Epoch: 1|  Loss:  1.23 |Global loss: 5.7836| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9272
Epoch: 2|  Loss:  1.2303 |Global loss: 5.7864| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9386
Epoch: 3|  Loss:  1.2426 |Global loss: 5.7734| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 0|  NKD Loss: 0.9623
Epoch: 0|  Loss:  1.337 |Global loss: 5.8117| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9786
Epoch: 1|  Loss:  1.3683 |Global loss: 5.8046| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9698
Epoch: 2|  Loss:  1.3517 |Global loss: 5.8022| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9679
Epoch: 3|  Loss:  1.3528 |Global loss: 5.8108| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9392
Epoch: 0|  Loss:  1.4157 |Global loss: 5.807| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 1|  NKD Loss: 0.9511
Epoch: 1|  Loss:  1.3938 |Global loss: 5.7942| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.9565
Epoch: 2|  Loss:  1.4112 |Global loss: 5.7935| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.9584
Epoch: 3|  Loss:  1.4187 |Global loss: 5.7901| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.9237
Epoch: 0|  Loss:  1.2266 |Global loss: 5.7735| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 0.9208
Epoch: 1|  Loss:  1.2128 |Global loss: 5.7693| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9291
Epoch: 2|  Loss:  1.2272 |Global loss: 5.7661| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9243
Epoch: 3|  Loss:  1.2257 |Global loss: 5.7712| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 0|  NKD Loss: 1.1114
Epoch: 0|  Loss:  2.3063 |Global loss: 5.9268| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.0987
Epoch: 1|  Loss:  2.3569 |Global loss: 5.926| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.1316
Epoch: 2|  Loss:  2.3337 |Global loss: 5.9131| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.1104
Epoch: 3|  Loss:  2.3352 |Global loss: 5.9093| Local H loss: 0.0265  | Global H loss: 0.0265
------------------------- time cost ------------------------- 2.825208902359009
Chosen Clients:  [10, 0, 13, 14, 5, 1]

-------------Round number: 273-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.642, 0.783, 0.867, 0.833, 0.708, 0.783, 0.917, 0.958, 0.983, 0.708, 0.85, 0.333, 0.783, 0.883]
AUC in each clients:  [115.536, 116.417, 116.369, 116.101, 118.031, 115.31, 116.08, 117.113, 117.789, 118.298, 116.242, 117.631, 111.095, 113.377, 117.668]
F1 Score:  [0.684, 0.589, 0.768, 0.832, 0.761, 0.651, 0.769, 0.912, 0.95, 0.981, 0.742, 0.846, 0.347, 0.759, 0.857]
Recall Score:  [0.728, 0.642, 0.819, 0.857, 0.81, 0.688, 0.819, 0.922, 0.958, 0.984, 0.789, 0.894, 0.394, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5107
Averaged Test Accurancy: 0.7811
Averaged Test AUC: 0.9684
Averaged Test F1_score: 0.7632
Averaged Test Recal score: 0.8009
Std Test Accurancy: 0.1541
Std Test AUC: 0.0153
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9805
Epoch: 0|  Loss:  1.4065 |Global loss: 5.8245| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.985
Epoch: 1|  Loss:  1.4058 |Global loss: 5.8301| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.9677
Epoch: 2|  Loss:  1.3927 |Global loss: 5.8379| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.9762
Epoch: 3|  Loss:  1.3993 |Global loss: 5.8283| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9815
Epoch: 0|  Loss:  1.5705 |Global loss: 5.7912| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.9951
Epoch: 1|  Loss:  1.5894 |Global loss: 5.7867| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9858
Epoch: 2|  Loss:  1.5667 |Global loss: 5.7846| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9752
Epoch: 3|  Loss:  1.5689 |Global loss: 5.7876| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9874
Epoch: 0|  Loss:  1.6579 |Global loss: 5.83| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 1.0145
Epoch: 1|  Loss:  1.7101 |Global loss: 5.8057| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9917
Epoch: 2|  Loss:  1.6715 |Global loss: 5.8116| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9993
Epoch: 3|  Loss:  1.6845 |Global loss: 5.8179| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9524
Epoch: 0|  Loss:  1.3258 |Global loss: 5.8053| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9633
Epoch: 1|  Loss:  1.3269 |Global loss: 5.8001| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9596
Epoch: 2|  Loss:  1.3193 |Global loss: 5.7996| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.9588
Epoch: 3|  Loss:  1.3207 |Global loss: 5.7992| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0455
Epoch: 0|  Loss:  1.7303 |Global loss: 5.825| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 1.0209
Epoch: 1|  Loss:  1.6814 |Global loss: 5.8443| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 1.0338
Epoch: 2|  Loss:  1.6869 |Global loss: 5.832| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 1.0244
Epoch: 3|  Loss:  1.6906 |Global loss: 5.8317| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 1.0137
Epoch: 0|  Loss:  1.6049 |Global loss: 5.8402| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0136
Epoch: 1|  Loss:  1.6089 |Global loss: 5.8419| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.0074
Epoch: 2|  Loss:  1.5984 |Global loss: 5.8491| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.0293
Epoch: 3|  Loss:  1.6225 |Global loss: 5.8275| Local H loss: 0.0284  | Global H loss: 0.0284
------------------------- time cost ------------------------- 3.107106924057007
Chosen Clients:  [6, 11, 7, 1, 5, 8]

-------------Round number: 274-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.675, 0.783, 0.867, 0.833, 0.733, 0.783, 0.917, 0.958, 0.983, 0.708, 0.85, 0.333, 0.783, 0.883]
AUC in each clients:  [115.543, 116.633, 116.369, 116.101, 118.031, 115.891, 116.08, 117.113, 117.789, 118.298, 116.194, 117.631, 111.095, 113.414, 117.768]
F1 Score:  [0.684, 0.641, 0.768, 0.832, 0.761, 0.662, 0.769, 0.912, 0.95, 0.981, 0.738, 0.846, 0.347, 0.759, 0.857]
Recall Score:  [0.728, 0.679, 0.819, 0.857, 0.81, 0.705, 0.819, 0.922, 0.958, 0.984, 0.789, 0.894, 0.394, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5095
Averaged Test Accurancy: 0.7850
Averaged Test AUC: 0.9689
Averaged Test F1_score: 0.7671
Averaged Test Recal score: 0.8045
Std Test Accurancy: 0.1516
Std Test AUC: 0.0152
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9753
Epoch: 0|  Loss:  1.5161 |Global loss: 5.8147| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 1|  NKD Loss: 0.9813
Epoch: 1|  Loss:  1.5025 |Global loss: 5.8075| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9695
Epoch: 2|  Loss:  1.5 |Global loss: 5.8157| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9881
Epoch: 3|  Loss:  1.5016 |Global loss: 5.7999| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9325
Epoch: 0|  Loss:  1.2406 |Global loss: 5.766| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.9196
Epoch: 1|  Loss:  1.2196 |Global loss: 5.7729| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9184
Epoch: 2|  Loss:  1.2194 |Global loss: 5.7731| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.8982
Epoch: 3|  Loss:  1.2008 |Global loss: 5.7867| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.9919
Epoch: 0|  Loss:  1.5228 |Global loss: 5.8273| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 1.0091
Epoch: 1|  Loss:  1.5202 |Global loss: 5.8177| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.9822
Epoch: 2|  Loss:  1.4917 |Global loss: 5.8217| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 1.0104
Epoch: 3|  Loss:  1.5133 |Global loss: 5.8043| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 1.0131
Epoch: 0|  Loss:  1.6072 |Global loss: 5.8376| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0119
Epoch: 1|  Loss:  1.5708 |Global loss: 5.8442| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0028
Epoch: 2|  Loss:  1.5802 |Global loss: 5.8471| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.0196
Epoch: 3|  Loss:  1.5969 |Global loss: 5.8309| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.0246
Epoch: 0|  Loss:  1.6899 |Global loss: 5.8418| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 1.0149
Epoch: 1|  Loss:  1.6896 |Global loss: 5.8347| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 1.0204
Epoch: 2|  Loss:  1.6953 |Global loss: 5.8391| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 1.0332
Epoch: 3|  Loss:  1.6839 |Global loss: 5.8295| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9712
Epoch: 0|  Loss:  1.3449 |Global loss: 5.8048| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9715
Epoch: 1|  Loss:  1.349 |Global loss: 5.8078| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9639
Epoch: 2|  Loss:  1.3438 |Global loss: 5.8136| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9599
Epoch: 3|  Loss:  1.3441 |Global loss: 5.8103| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 2.98116135597229
Chosen Clients:  [6, 8, 4, 12, 13, 0]

-------------Round number: 275-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.683, 0.658, 0.783, 0.867, 0.833, 0.733, 0.783, 0.933, 0.958, 0.983, 0.708, 0.9, 0.333, 0.783, 0.883]
AUC in each clients:  [115.543, 116.887, 116.369, 116.101, 118.031, 115.678, 116.111, 117.183, 117.996, 118.298, 116.194, 117.752, 111.095, 113.414, 117.768]
F1 Score:  [0.684, 0.625, 0.768, 0.832, 0.761, 0.663, 0.769, 0.919, 0.95, 0.981, 0.738, 0.904, 0.347, 0.759, 0.857]
Recall Score:  [0.728, 0.663, 0.819, 0.857, 0.81, 0.706, 0.819, 0.926, 0.958, 0.984, 0.789, 0.927, 0.394, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5034
Averaged Test Accurancy: 0.7883
Averaged Test AUC: 0.9691
Averaged Test F1_score: 0.7705
Averaged Test Recal score: 0.8060
Std Test Accurancy: 0.1554
Std Test AUC: 0.0155
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9727
Epoch: 0|  Loss:  1.4968 |Global loss: 5.8143| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9909
Epoch: 1|  Loss:  1.5111 |Global loss: 5.808| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.976
Epoch: 2|  Loss:  1.5045 |Global loss: 5.8131| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.9752
Epoch: 3|  Loss:  1.4906 |Global loss: 5.8077| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9644
Epoch: 0|  Loss:  1.3317 |Global loss: 5.8063| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9634
Epoch: 1|  Loss:  1.334 |Global loss: 5.8101| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9664
Epoch: 2|  Loss:  1.3385 |Global loss: 5.8017| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9289
Epoch: 3|  Loss:  1.2944 |Global loss: 5.8273| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.4174 |Global loss: 5.7688| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9356
Epoch: 1|  Loss:  1.3975 |Global loss: 5.7493| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9401
Epoch: 2|  Loss:  1.4247 |Global loss: 5.759| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9578
Epoch: 3|  Loss:  1.4445 |Global loss: 5.7416| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.1187
Epoch: 0|  Loss:  2.2926 |Global loss: 5.9034| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 1.0957
Epoch: 1|  Loss:  2.2791 |Global loss: 5.9118| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.1128
Epoch: 2|  Loss:  2.2794 |Global loss: 5.9114| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 1.1199
Epoch: 3|  Loss:  2.2889 |Global loss: 5.8955| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9774
Epoch: 0|  Loss:  1.6542 |Global loss: 5.8285| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.987
Epoch: 1|  Loss:  1.6858 |Global loss: 5.8225| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 1.0074
Epoch: 2|  Loss:  1.693 |Global loss: 5.8046| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9884
Epoch: 3|  Loss:  1.6811 |Global loss: 5.8175| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9943
Epoch: 0|  Loss:  1.5778 |Global loss: 5.781| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9799
Epoch: 1|  Loss:  1.5429 |Global loss: 5.7808| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9859
Epoch: 2|  Loss:  1.5577 |Global loss: 5.7799| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9813
Epoch: 3|  Loss:  1.5494 |Global loss: 5.7819| Local H loss: 0.0267  | Global H loss: 0.0267
------------------------- time cost ------------------------- 3.1972525119781494
Chosen Clients:  [6, 1, 8, 0, 13, 9]

-------------Round number: 276-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.658, 0.783, 0.867, 0.833, 0.733, 0.783, 0.933, 0.958, 0.983, 0.708, 0.9, 0.292, 0.783, 0.883]
AUC in each clients:  [115.561, 116.887, 116.369, 116.101, 118.013, 115.678, 116.167, 117.183, 118.001, 118.298, 116.194, 117.752, 110.59, 113.678, 117.768]
F1 Score:  [0.69, 0.625, 0.768, 0.832, 0.761, 0.663, 0.769, 0.919, 0.95, 0.981, 0.738, 0.904, 0.293, 0.756, 0.857]
Recall Score:  [0.737, 0.663, 0.819, 0.857, 0.81, 0.706, 0.819, 0.926, 0.958, 0.984, 0.789, 0.927, 0.345, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.5054
Averaged Test Accurancy: 0.7861
Averaged Test AUC: 0.9690
Averaged Test F1_score: 0.7671
Averaged Test Recal score: 0.8033
Std Test Accurancy: 0.1633
Std Test AUC: 0.0161
Std Test F1: 0.0014
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.9815
Epoch: 0|  Loss:  1.4947 |Global loss: 5.8011| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9915
Epoch: 1|  Loss:  1.5078 |Global loss: 5.7977| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9771
Epoch: 2|  Loss:  1.4863 |Global loss: 5.8037| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9775
Epoch: 3|  Loss:  1.487 |Global loss: 5.8058| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 1.021
Epoch: 0|  Loss:  1.6025 |Global loss: 5.8392| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0196
Epoch: 1|  Loss:  1.5995 |Global loss: 5.8267| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.0135
Epoch: 2|  Loss:  1.5874 |Global loss: 5.8372| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 1.0009
Epoch: 3|  Loss:  1.5488 |Global loss: 5.8421| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9614
Epoch: 0|  Loss:  1.3296 |Global loss: 5.8036| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9664
Epoch: 1|  Loss:  1.3371 |Global loss: 5.8032| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9624
Epoch: 2|  Loss:  1.3191 |Global loss: 5.8055| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9728
Epoch: 3|  Loss:  1.3247 |Global loss: 5.7927| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 0|  NKD Loss: 0.9616
Epoch: 0|  Loss:  1.528 |Global loss: 5.7953| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.9682
Epoch: 1|  Loss:  1.5369 |Global loss: 5.7963| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.5324 |Global loss: 5.7927| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9688
Epoch: 3|  Loss:  1.5428 |Global loss: 5.7844| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9962
Epoch: 0|  Loss:  1.6575 |Global loss: 5.8171| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 1.0028
Epoch: 1|  Loss:  1.663 |Global loss: 5.8075| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 1.0091
Epoch: 2|  Loss:  1.6787 |Global loss: 5.8033| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9946
Epoch: 3|  Loss:  1.6399 |Global loss: 5.8085| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9444
Epoch: 0|  Loss:  1.2462 |Global loss: 5.7694| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.9478
Epoch: 1|  Loss:  1.2399 |Global loss: 5.767| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.2247 |Global loss: 5.7781| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.9088
Epoch: 3|  Loss:  1.2064 |Global loss: 5.7957| Local H loss: 0.0322  | Global H loss: 0.0322
------------------------- time cost ------------------------- 3.122337579727173
Chosen Clients:  [3, 12, 5, 14, 11, 1]

-------------Round number: 277-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.667, 0.783, 0.867, 0.833, 0.733, 0.783, 0.933, 0.958, 0.983, 0.708, 0.9, 0.292, 0.783, 0.883]
AUC in each clients:  [115.638, 117.03, 116.369, 116.101, 118.013, 115.678, 116.206, 117.183, 118.005, 118.334, 116.194, 117.752, 110.59, 113.603, 117.768]
F1 Score:  [0.702, 0.635, 0.768, 0.832, 0.761, 0.663, 0.769, 0.919, 0.95, 0.981, 0.738, 0.904, 0.293, 0.759, 0.857]
Recall Score:  [0.747, 0.677, 0.819, 0.857, 0.81, 0.706, 0.819, 0.926, 0.958, 0.984, 0.789, 0.927, 0.345, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4959
Averaged Test Accurancy: 0.7872
Averaged Test AUC: 0.9691
Averaged Test F1_score: 0.7687
Averaged Test Recal score: 0.8049
Std Test Accurancy: 0.1626
Std Test AUC: 0.0161
Std Test F1: 0.0013
Std Test Recall: 0.0013
Epoch: 0|  NKD Loss: 0.9406
Epoch: 0|  Loss:  1.3922 |Global loss: 5.7974| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.949
Epoch: 1|  Loss:  1.3981 |Global loss: 5.7909| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.9525
Epoch: 2|  Loss:  1.4103 |Global loss: 5.791| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.96
Epoch: 3|  Loss:  1.4092 |Global loss: 5.7848| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 1.1168
Epoch: 0|  Loss:  2.2824 |Global loss: 5.8981| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 1.122
Epoch: 1|  Loss:  2.2834 |Global loss: 5.8975| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 1.1237
Epoch: 2|  Loss:  2.2987 |Global loss: 5.8957| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 1.1299
Epoch: 3|  Loss:  2.289 |Global loss: 5.9043| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 1.0338
Epoch: 0|  Loss:  1.6911 |Global loss: 5.8342| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 1.0275
Epoch: 1|  Loss:  1.6796 |Global loss: 5.8229| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 1.015
Epoch: 2|  Loss:  1.6672 |Global loss: 5.8402| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 1.0343
Epoch: 3|  Loss:  1.6759 |Global loss: 5.8283| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.9776
Epoch: 0|  Loss:  1.3488 |Global loss: 5.7854| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9805
Epoch: 1|  Loss:  1.343 |Global loss: 5.7867| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.3341 |Global loss: 5.7891| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.962
Epoch: 3|  Loss:  1.3209 |Global loss: 5.801| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9103
Epoch: 0|  Loss:  1.2115 |Global loss: 5.7796| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.94
Epoch: 1|  Loss:  1.2369 |Global loss: 5.7548| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.9224
Epoch: 2|  Loss:  1.2131 |Global loss: 5.7713| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9206
Epoch: 3|  Loss:  1.2144 |Global loss: 5.7701| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0189
Epoch: 0|  Loss:  1.5756 |Global loss: 5.8267| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 1.0257
Epoch: 1|  Loss:  1.5873 |Global loss: 5.8281| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0005
Epoch: 2|  Loss:  1.5577 |Global loss: 5.8303| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0044
Epoch: 3|  Loss:  1.5555 |Global loss: 5.8412| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 2.9150803089141846
Chosen Clients:  [13, 8, 14, 9, 6, 3]

-------------Round number: 278-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.692, 0.783, 0.883, 0.833, 0.742, 0.783, 0.933, 0.958, 0.983, 0.708, 0.85, 0.317, 0.783, 0.883]
AUC in each clients:  [115.638, 117.376, 116.369, 116.63, 118.013, 115.917, 116.206, 117.183, 118.005, 118.334, 116.194, 117.69, 110.834, 113.603, 117.789]
F1 Score:  [0.702, 0.664, 0.768, 0.842, 0.761, 0.666, 0.769, 0.919, 0.95, 0.981, 0.738, 0.846, 0.339, 0.759, 0.857]
Recall Score:  [0.747, 0.696, 0.819, 0.872, 0.81, 0.712, 0.819, 0.926, 0.958, 0.984, 0.789, 0.894, 0.375, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4963
Averaged Test Accurancy: 0.7889
Averaged Test AUC: 0.9699
Averaged Test F1_score: 0.7707
Averaged Test Recal score: 0.8074
Std Test Accurancy: 0.1549
Std Test AUC: 0.0158
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9873
Epoch: 0|  Loss:  1.6257 |Global loss: 5.8151| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9907
Epoch: 1|  Loss:  1.6638 |Global loss: 5.8133| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9999
Epoch: 2|  Loss:  1.6681 |Global loss: 5.7956| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9843
Epoch: 3|  Loss:  1.6493 |Global loss: 5.8066| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9753
Epoch: 0|  Loss:  1.3331 |Global loss: 5.7937| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.9794
Epoch: 1|  Loss:  1.3361 |Global loss: 5.7893| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.944
Epoch: 2|  Loss:  1.311 |Global loss: 5.8132| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.95
Epoch: 3|  Loss:  1.3122 |Global loss: 5.8119| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9653
Epoch: 0|  Loss:  1.3281 |Global loss: 5.7887| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9707
Epoch: 1|  Loss:  1.3253 |Global loss: 5.7894| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9547
Epoch: 2|  Loss:  1.3122 |Global loss: 5.8014| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9609
Epoch: 3|  Loss:  1.3034 |Global loss: 5.7898| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9543
Epoch: 0|  Loss:  1.2506 |Global loss: 5.7605| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.9504
Epoch: 1|  Loss:  1.25 |Global loss: 5.7614| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.9407
Epoch: 2|  Loss:  1.2336 |Global loss: 5.7668| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.9185
Epoch: 3|  Loss:  1.2161 |Global loss: 5.7806| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9805
Epoch: 0|  Loss:  1.4813 |Global loss: 5.8057| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.986
Epoch: 1|  Loss:  1.4909 |Global loss: 5.7979| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9854
Epoch: 2|  Loss:  1.4985 |Global loss: 5.7958| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9873
Epoch: 3|  Loss:  1.491 |Global loss: 5.7924| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.943
Epoch: 0|  Loss:  1.3911 |Global loss: 5.7935| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.9604
Epoch: 1|  Loss:  1.3941 |Global loss: 5.7839| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.9358
Epoch: 2|  Loss:  1.3877 |Global loss: 5.7983| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.9736
Epoch: 3|  Loss:  1.411 |Global loss: 5.7785| Local H loss: 0.0413  | Global H loss: 0.0413
------------------------- time cost ------------------------- 2.9882965087890625
Chosen Clients:  [0, 1, 7, 5, 12, 10]

-------------Round number: 279-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.692, 0.783, 0.842, 0.833, 0.742, 0.783, 0.933, 0.967, 0.983, 0.708, 0.85, 0.317, 0.783, 0.883]
AUC in each clients:  [115.638, 117.376, 116.369, 116.122, 118.013, 115.917, 116.205, 117.183, 118.252, 118.361, 116.194, 117.69, 110.834, 113.736, 117.842]
F1 Score:  [0.702, 0.664, 0.768, 0.818, 0.761, 0.666, 0.769, 0.919, 0.961, 0.981, 0.738, 0.846, 0.339, 0.759, 0.857]
Recall Score:  [0.747, 0.696, 0.819, 0.84, 0.81, 0.712, 0.819, 0.926, 0.968, 0.984, 0.789, 0.894, 0.375, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4900
Averaged Test Accurancy: 0.7867
Averaged Test AUC: 0.9699
Averaged Test F1_score: 0.7699
Averaged Test Recal score: 0.8059
Std Test Accurancy: 0.1542
Std Test AUC: 0.0158
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9817
Epoch: 0|  Loss:  1.5478 |Global loss: 5.7901| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.9877
Epoch: 1|  Loss:  1.5559 |Global loss: 5.7762| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9875
Epoch: 2|  Loss:  1.5522 |Global loss: 5.7783| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.9795
Epoch: 3|  Loss:  1.5433 |Global loss: 5.78| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0112
Epoch: 0|  Loss:  1.5698 |Global loss: 5.8321| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 1.0274
Epoch: 1|  Loss:  1.5826 |Global loss: 5.8229| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0094
Epoch: 2|  Loss:  1.5721 |Global loss: 5.8413| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9966
Epoch: 3|  Loss:  1.5508 |Global loss: 5.8359| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9953
Epoch: 0|  Loss:  1.4948 |Global loss: 5.8135| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 1.0077
Epoch: 1|  Loss:  1.5014 |Global loss: 5.8042| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.9664
Epoch: 2|  Loss:  1.4594 |Global loss: 5.8307| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.9857
Epoch: 3|  Loss:  1.4629 |Global loss: 5.8132| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 0|  NKD Loss: 1.0302
Epoch: 0|  Loss:  1.6833 |Global loss: 5.8312| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 1.0393
Epoch: 1|  Loss:  1.6857 |Global loss: 5.8286| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 1.038
Epoch: 2|  Loss:  1.6744 |Global loss: 5.8266| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 1.0246
Epoch: 3|  Loss:  1.6658 |Global loss: 5.834| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 1.0985
Epoch: 0|  Loss:  2.2502 |Global loss: 5.9075| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 1.1129
Epoch: 1|  Loss:  2.258 |Global loss: 5.8952| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 1.1042
Epoch: 2|  Loss:  2.2466 |Global loss: 5.9073| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 1.1156
Epoch: 3|  Loss:  2.2578 |Global loss: 5.8951| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9878
Epoch: 0|  Loss:  1.4008 |Global loss: 5.8171| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9906
Epoch: 1|  Loss:  1.4097 |Global loss: 5.8192| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9608
Epoch: 2|  Loss:  1.3773 |Global loss: 5.8417| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.9773
Epoch: 3|  Loss:  1.3913 |Global loss: 5.8285| Local H loss: 0.0388  | Global H loss: 0.0388
------------------------- time cost ------------------------- 2.9603331089019775
Chosen Clients:  [14, 3, 11, 5, 10, 4]

-------------Round number: 280-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.717, 0.783, 0.842, 0.833, 0.733, 0.783, 0.9, 0.967, 0.983, 0.708, 0.85, 0.325, 0.783, 0.883]
AUC in each clients:  [115.625, 117.423, 116.369, 116.122, 118.013, 116.001, 116.205, 117.095, 118.252, 118.361, 116.224, 117.69, 111.408, 113.736, 117.842]
F1 Score:  [0.69, 0.7, 0.768, 0.818, 0.761, 0.662, 0.769, 0.854, 0.961, 0.981, 0.738, 0.846, 0.335, 0.759, 0.857]
Recall Score:  [0.737, 0.729, 0.819, 0.84, 0.81, 0.705, 0.819, 0.884, 0.968, 0.984, 0.789, 0.894, 0.382, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4848
Averaged Test Accurancy: 0.7856
Averaged Test AUC: 0.9702
Averaged Test F1_score: 0.7666
Averaged Test Recal score: 0.8047
Std Test Accurancy: 0.1502
Std Test AUC: 0.0149
Std Test F1: 0.0012
Std Test Recall: 0.0011
Epoch: 0|  NKD Loss: 0.9532
Epoch: 0|  Loss:  1.3053 |Global loss: 5.7868| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.9536
Epoch: 1|  Loss:  1.3093 |Global loss: 5.7944| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9618
Epoch: 2|  Loss:  1.3098 |Global loss: 5.7874| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9519
Epoch: 3|  Loss:  1.2863 |Global loss: 5.793| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9546
Epoch: 0|  Loss:  1.399 |Global loss: 5.7831| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9566
Epoch: 1|  Loss:  1.397 |Global loss: 5.7765| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.9658
Epoch: 2|  Loss:  1.4027 |Global loss: 5.7779| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.9612
Epoch: 3|  Loss:  1.4017 |Global loss: 5.778| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.915
Epoch: 0|  Loss:  1.2059 |Global loss: 5.7671| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.9408
Epoch: 1|  Loss:  1.2338 |Global loss: 5.7591| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9243
Epoch: 2|  Loss:  1.2217 |Global loss: 5.7664| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.9239
Epoch: 3|  Loss:  1.2138 |Global loss: 5.763| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0356
Epoch: 0|  Loss:  1.6511 |Global loss: 5.8295| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.0089
Epoch: 1|  Loss:  1.6437 |Global loss: 5.8437| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 1.0277
Epoch: 2|  Loss:  1.6459 |Global loss: 5.8298| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 1.0244
Epoch: 3|  Loss:  1.6622 |Global loss: 5.8351| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9631
Epoch: 0|  Loss:  1.3741 |Global loss: 5.8406| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.9672
Epoch: 1|  Loss:  1.3783 |Global loss: 5.8252| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9649
Epoch: 2|  Loss:  1.3765 |Global loss: 5.8333| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9727
Epoch: 3|  Loss:  1.3742 |Global loss: 5.8235| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9426
Epoch: 0|  Loss:  1.4398 |Global loss: 5.7548| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9462
Epoch: 1|  Loss:  1.4334 |Global loss: 5.7532| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9569
Epoch: 2|  Loss:  1.4259 |Global loss: 5.7362| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9396
Epoch: 3|  Loss:  1.4089 |Global loss: 5.7479| Local H loss: 0.0272  | Global H loss: 0.0272
------------------------- time cost ------------------------- 2.9248898029327393
Chosen Clients:  [5, 1, 10, 6, 7, 8]

-------------Round number: 281-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.717, 0.783, 0.883, 0.833, 0.733, 0.783, 0.9, 0.967, 0.983, 0.708, 0.908, 0.325, 0.783, 0.883]
AUC in each clients:  [115.625, 117.423, 116.369, 116.908, 118.023, 115.971, 116.205, 117.095, 118.252, 118.361, 116.242, 117.805, 111.408, 113.736, 117.913]
F1 Score:  [0.69, 0.7, 0.768, 0.842, 0.761, 0.662, 0.769, 0.854, 0.961, 0.981, 0.738, 0.91, 0.335, 0.759, 0.857]
Recall Score:  [0.737, 0.729, 0.819, 0.872, 0.81, 0.705, 0.819, 0.884, 0.968, 0.984, 0.789, 0.934, 0.382, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4790
Averaged Test Accurancy: 0.7922
Averaged Test AUC: 0.9707
Averaged Test F1_score: 0.7725
Averaged Test Recal score: 0.8095
Std Test Accurancy: 0.1539
Std Test AUC: 0.0150
Std Test F1: 0.0012
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.0249
Epoch: 0|  Loss:  1.6424 |Global loss: 5.8304| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.026
Epoch: 1|  Loss:  1.6544 |Global loss: 5.8259| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 1.0286
Epoch: 2|  Loss:  1.647 |Global loss: 5.8292| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.0266
Epoch: 3|  Loss:  1.6312 |Global loss: 5.8253| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0235
Epoch: 0|  Loss:  1.5651 |Global loss: 5.824| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.0163
Epoch: 1|  Loss:  1.5599 |Global loss: 5.8372| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.9947
Epoch: 2|  Loss:  1.5334 |Global loss: 5.8378| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9858
Epoch: 3|  Loss:  1.5299 |Global loss: 5.8494| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9669
Epoch: 0|  Loss:  1.3744 |Global loss: 5.8191| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.9731
Epoch: 1|  Loss:  1.3766 |Global loss: 5.8226| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9886
Epoch: 2|  Loss:  1.3919 |Global loss: 5.8129| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9702
Epoch: 3|  Loss:  1.3664 |Global loss: 5.8195| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9768
Epoch: 0|  Loss:  1.4842 |Global loss: 5.8007| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9785
Epoch: 1|  Loss:  1.475 |Global loss: 5.8027| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9816
Epoch: 2|  Loss:  1.4678 |Global loss: 5.7923| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9798
Epoch: 3|  Loss:  1.4788 |Global loss: 5.8022| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9701
Epoch: 0|  Loss:  1.4517 |Global loss: 5.8272| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.9623
Epoch: 1|  Loss:  1.4345 |Global loss: 5.829| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.9892
Epoch: 2|  Loss:  1.4526 |Global loss: 5.81| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.9889
Epoch: 3|  Loss:  1.461 |Global loss: 5.8097| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.9482
Epoch: 0|  Loss:  1.3078 |Global loss: 5.8127| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9528
Epoch: 1|  Loss:  1.3111 |Global loss: 5.8103| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9684
Epoch: 2|  Loss:  1.3188 |Global loss: 5.7946| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9419
Epoch: 3|  Loss:  1.2983 |Global loss: 5.8142| Local H loss: 0.0374  | Global H loss: 0.0374
------------------------- time cost ------------------------- 2.8859827518463135
Chosen Clients:  [11, 6, 4, 12, 7, 8]

-------------Round number: 282-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.733, 0.783, 0.883, 0.833, 0.742, 0.783, 0.967, 0.958, 0.983, 0.708, 0.908, 0.325, 0.783, 0.883]
AUC in each clients:  [115.625, 117.635, 116.369, 116.908, 118.023, 115.907, 116.286, 117.296, 118.167, 118.361, 116.239, 117.805, 111.408, 113.736, 117.913]
F1 Score:  [0.69, 0.719, 0.768, 0.842, 0.761, 0.666, 0.769, 0.96, 0.95, 0.981, 0.738, 0.91, 0.335, 0.759, 0.857]
Recall Score:  [0.737, 0.756, 0.819, 0.872, 0.81, 0.712, 0.819, 0.966, 0.958, 0.984, 0.789, 0.934, 0.382, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4755
Averaged Test Accurancy: 0.7978
Averaged Test AUC: 0.9709
Averaged Test F1_score: 0.7803
Averaged Test Recal score: 0.8165
Std Test Accurancy: 0.1565
Std Test AUC: 0.0151
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9145
Epoch: 0|  Loss:  1.2016 |Global loss: 5.7709| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.9387
Epoch: 1|  Loss:  1.2261 |Global loss: 5.7628| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9326
Epoch: 2|  Loss:  1.2235 |Global loss: 5.7564| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.9268
Epoch: 3|  Loss:  1.2164 |Global loss: 5.7606| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9854
Epoch: 0|  Loss:  1.4597 |Global loss: 5.796| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9872
Epoch: 1|  Loss:  1.4755 |Global loss: 5.7959| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9483
Epoch: 2|  Loss:  1.4476 |Global loss: 5.8088| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9855
Epoch: 3|  Loss:  1.4671 |Global loss: 5.802| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.9333
Epoch: 0|  Loss:  1.4312 |Global loss: 5.7625| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9487
Epoch: 1|  Loss:  1.4301 |Global loss: 5.75| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.932
Epoch: 2|  Loss:  1.423 |Global loss: 5.7556| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9552
Epoch: 3|  Loss:  1.4486 |Global loss: 5.7409| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.0956
Epoch: 0|  Loss:  2.2234 |Global loss: 5.9118| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 1.0903
Epoch: 1|  Loss:  2.231 |Global loss: 5.9123| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 1.1226
Epoch: 2|  Loss:  2.2468 |Global loss: 5.8993| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 1.113
Epoch: 3|  Loss:  2.2211 |Global loss: 5.8972| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.9823
Epoch: 0|  Loss:  1.4414 |Global loss: 5.8124| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.9817
Epoch: 1|  Loss:  1.4357 |Global loss: 5.8106| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.9914
Epoch: 2|  Loss:  1.4547 |Global loss: 5.8074| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.9763
Epoch: 3|  Loss:  1.4251 |Global loss: 5.8136| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.9687
Epoch: 0|  Loss:  1.3198 |Global loss: 5.7929| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.9588
Epoch: 1|  Loss:  1.3143 |Global loss: 5.794| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9598
Epoch: 2|  Loss:  1.309 |Global loss: 5.8014| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9505
Epoch: 3|  Loss:  1.298 |Global loss: 5.8042| Local H loss: 0.0371  | Global H loss: 0.0371
------------------------- time cost ------------------------- 3.0925331115722656
Chosen Clients:  [1, 14, 6, 4, 13, 10]

-------------Round number: 283-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.733, 0.783, 0.883, 0.842, 0.742, 0.792, 0.975, 0.958, 0.983, 0.708, 0.95, 0.308, 0.783, 0.883]
AUC in each clients:  [115.625, 117.635, 116.369, 116.908, 118.024, 115.907, 116.279, 117.446, 118.251, 118.361, 116.239, 118.09, 111.366, 113.736, 117.913]
F1 Score:  [0.69, 0.719, 0.768, 0.842, 0.766, 0.666, 0.783, 0.971, 0.951, 0.981, 0.738, 0.947, 0.322, 0.759, 0.857]
Recall Score:  [0.737, 0.756, 0.819, 0.872, 0.817, 0.712, 0.829, 0.977, 0.958, 0.984, 0.789, 0.96, 0.366, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4760
Averaged Test Accurancy: 0.8011
Averaged Test AUC: 0.9712
Averaged Test F1_score: 0.7840
Averaged Test Recal score: 0.8191
Std Test Accurancy: 0.1628
Std Test AUC: 0.0154
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 1.0003
Epoch: 0|  Loss:  1.5297 |Global loss: 5.8359| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 1.0163
Epoch: 1|  Loss:  1.5445 |Global loss: 5.8246| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 1.0093
Epoch: 2|  Loss:  1.5494 |Global loss: 5.8304| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0057
Epoch: 3|  Loss:  1.538 |Global loss: 5.8324| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9692
Epoch: 0|  Loss:  1.3167 |Global loss: 5.7818| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.9572
Epoch: 1|  Loss:  1.2984 |Global loss: 5.786| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9613
Epoch: 2|  Loss:  1.3025 |Global loss: 5.7885| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9567
Epoch: 3|  Loss:  1.2872 |Global loss: 5.7835| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 0|  NKD Loss: 0.9595
Epoch: 0|  Loss:  1.4561 |Global loss: 5.8083| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.978
Epoch: 1|  Loss:  1.4622 |Global loss: 5.802| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9686
Epoch: 2|  Loss:  1.4573 |Global loss: 5.8011| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9693
Epoch: 3|  Loss:  1.4534 |Global loss: 5.8069| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 0|  NKD Loss: 0.9482
Epoch: 0|  Loss:  1.4348 |Global loss: 5.747| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9318
Epoch: 1|  Loss:  1.4248 |Global loss: 5.761| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9481
Epoch: 2|  Loss:  1.4308 |Global loss: 5.7466| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.917
Epoch: 3|  Loss:  1.379 |Global loss: 5.7613| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9715
Epoch: 0|  Loss:  1.6288 |Global loss: 5.8238| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9866
Epoch: 1|  Loss:  1.6439 |Global loss: 5.8099| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9979
Epoch: 2|  Loss:  1.6402 |Global loss: 5.8043| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.966
Epoch: 3|  Loss:  1.6136 |Global loss: 5.8175| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9683
Epoch: 0|  Loss:  1.3614 |Global loss: 5.8196| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9887
Epoch: 1|  Loss:  1.3882 |Global loss: 5.8006| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9319
Epoch: 2|  Loss:  1.3355 |Global loss: 5.8425| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9623
Epoch: 3|  Loss:  1.3632 |Global loss: 5.8206| Local H loss: 0.0384  | Global H loss: 0.0384
------------------------- time cost ------------------------- 2.935894250869751
Chosen Clients:  [2, 4, 12, 8, 10, 13]

-------------Round number: 284-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.742, 0.783, 0.883, 0.842, 0.742, 0.792, 0.975, 0.958, 0.983, 0.833, 0.95, 0.308, 0.783, 0.883]
AUC in each clients:  [115.625, 117.675, 116.369, 116.908, 118.035, 115.907, 116.416, 117.446, 118.251, 118.361, 116.666, 118.09, 111.366, 113.916, 117.933]
F1 Score:  [0.69, 0.728, 0.768, 0.842, 0.766, 0.666, 0.783, 0.971, 0.951, 0.981, 0.832, 0.947, 0.322, 0.756, 0.857]
Recall Score:  [0.737, 0.765, 0.819, 0.872, 0.817, 0.712, 0.829, 0.977, 0.958, 0.984, 0.873, 0.96, 0.366, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4675
Averaged Test Accurancy: 0.8100
Averaged Test AUC: 0.9716
Averaged Test F1_score: 0.7907
Averaged Test Recal score: 0.8253
Std Test Accurancy: 0.1608
Std Test AUC: 0.0152
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9994
Epoch: 0|  Loss:  1.4476 |Global loss: 5.8249| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9813
Epoch: 1|  Loss:  1.439 |Global loss: 5.8471| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.9911
Epoch: 2|  Loss:  1.4385 |Global loss: 5.8311| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9899
Epoch: 3|  Loss:  1.4432 |Global loss: 5.8462| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9364
Epoch: 0|  Loss:  1.4128 |Global loss: 5.7539| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9408
Epoch: 1|  Loss:  1.4199 |Global loss: 5.7501| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9381
Epoch: 2|  Loss:  1.4257 |Global loss: 5.7517| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9459
Epoch: 3|  Loss:  1.4205 |Global loss: 5.7435| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.094
Epoch: 0|  Loss:  2.2182 |Global loss: 5.9062| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 1.1003
Epoch: 1|  Loss:  2.2041 |Global loss: 5.8997| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 1.1081
Epoch: 2|  Loss:  2.2205 |Global loss: 5.9059| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 1.0943
Epoch: 3|  Loss:  2.1986 |Global loss: 5.9009| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9547
Epoch: 0|  Loss:  1.3045 |Global loss: 5.7993| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.958
Epoch: 1|  Loss:  1.3013 |Global loss: 5.7926| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9576
Epoch: 2|  Loss:  1.3005 |Global loss: 5.792| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9427
Epoch: 3|  Loss:  1.287 |Global loss: 5.8099| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9861
Epoch: 0|  Loss:  1.3786 |Global loss: 5.808| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9604
Epoch: 1|  Loss:  1.3556 |Global loss: 5.8215| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9653
Epoch: 2|  Loss:  1.3608 |Global loss: 5.8215| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.9738
Epoch: 3|  Loss:  1.3565 |Global loss: 5.8109| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9906
Epoch: 0|  Loss:  1.6462 |Global loss: 5.8089| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.988
Epoch: 1|  Loss:  1.6417 |Global loss: 5.8111| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.973
Epoch: 2|  Loss:  1.6026 |Global loss: 5.808| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9648
Epoch: 3|  Loss:  1.6019 |Global loss: 5.8213| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 3.1776368618011475
Chosen Clients:  [10, 8, 5, 12, 2, 11]

-------------Round number: 285-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.742, 0.775, 0.883, 0.833, 0.742, 0.792, 0.975, 0.958, 0.983, 0.783, 0.95, 0.408, 0.783, 0.883]
AUC in each clients:  [115.625, 117.675, 116.343, 116.908, 118.043, 115.907, 116.416, 117.446, 118.364, 118.361, 116.427, 118.09, 111.986, 113.995, 117.933]
F1 Score:  [0.69, 0.728, 0.751, 0.842, 0.761, 0.666, 0.783, 0.971, 0.95, 0.981, 0.806, 0.947, 0.415, 0.756, 0.857]
Recall Score:  [0.737, 0.765, 0.81, 0.872, 0.81, 0.712, 0.829, 0.977, 0.958, 0.984, 0.839, 0.96, 0.484, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4623
Averaged Test Accurancy: 0.8122
Averaged Test AUC: 0.9720
Averaged Test F1_score: 0.7936
Averaged Test Recal score: 0.8298
Std Test Accurancy: 0.1409
Std Test AUC: 0.0143
Std Test F1: 0.0012
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 0.975
Epoch: 0|  Loss:  1.3631 |Global loss: 5.8109| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9652
Epoch: 1|  Loss:  1.3551 |Global loss: 5.8159| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.3441 |Global loss: 5.8254| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.9512
Epoch: 3|  Loss:  1.3406 |Global loss: 5.821| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9591
Epoch: 0|  Loss:  1.2972 |Global loss: 5.7966| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.9503
Epoch: 1|  Loss:  1.2897 |Global loss: 5.8006| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.937
Epoch: 2|  Loss:  1.2827 |Global loss: 5.8115| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.9533
Epoch: 3|  Loss:  1.2921 |Global loss: 5.7925| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 1.0382
Epoch: 0|  Loss:  1.6579 |Global loss: 5.82| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.0178
Epoch: 1|  Loss:  1.6461 |Global loss: 5.8321| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0043
Epoch: 2|  Loss:  1.6242 |Global loss: 5.8416| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 1.0122
Epoch: 3|  Loss:  1.6246 |Global loss: 5.8257| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.1123
Epoch: 0|  Loss:  2.2006 |Global loss: 5.8907| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 1|  NKD Loss: 1.0981
Epoch: 1|  Loss:  2.2039 |Global loss: 5.8972| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 1.1179
Epoch: 2|  Loss:  2.2216 |Global loss: 5.8919| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 1.0936
Epoch: 3|  Loss:  2.1835 |Global loss: 5.9038| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0091
Epoch: 0|  Loss:  1.4682 |Global loss: 5.8231| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9873
Epoch: 1|  Loss:  1.4383 |Global loss: 5.8334| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9786
Epoch: 2|  Loss:  1.4149 |Global loss: 5.8419| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.997
Epoch: 3|  Loss:  1.4409 |Global loss: 5.833| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9244
Epoch: 0|  Loss:  1.2108 |Global loss: 5.7675| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.9144
Epoch: 1|  Loss:  1.2006 |Global loss: 5.7656| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.9228
Epoch: 2|  Loss:  1.2107 |Global loss: 5.7659| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.9077
Epoch: 3|  Loss:  1.1988 |Global loss: 5.773| Local H loss: 0.0292  | Global H loss: 0.0292
------------------------- time cost ------------------------- 2.817460536956787
Chosen Clients:  [2, 5, 14, 0, 11, 12]

-------------Round number: 286-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.692, 0.742, 0.775, 0.883, 0.833, 0.742, 0.792, 0.975, 0.967, 0.983, 0.767, 0.95, 0.408, 0.783, 0.883]
AUC in each clients:  [115.625, 117.675, 116.355, 116.908, 118.043, 115.979, 116.416, 117.446, 118.403, 118.361, 116.503, 118.108, 112.07, 113.995, 117.933]
F1 Score:  [0.69, 0.728, 0.751, 0.842, 0.761, 0.666, 0.783, 0.971, 0.961, 0.981, 0.795, 0.947, 0.415, 0.756, 0.857]
Recall Score:  [0.737, 0.765, 0.81, 0.872, 0.81, 0.712, 0.829, 0.977, 0.968, 0.984, 0.828, 0.96, 0.484, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4586
Averaged Test Accurancy: 0.8117
Averaged Test AUC: 0.9721
Averaged Test F1_score: 0.7936
Averaged Test Recal score: 0.8297
Std Test Accurancy: 0.1418
Std Test AUC: 0.0141
Std Test F1: 0.0012
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 1.0019
Epoch: 0|  Loss:  1.4375 |Global loss: 5.8232| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9867
Epoch: 1|  Loss:  1.4145 |Global loss: 5.8281| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9699
Epoch: 2|  Loss:  1.4178 |Global loss: 5.8464| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9779
Epoch: 3|  Loss:  1.4022 |Global loss: 5.8412| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 1.0276
Epoch: 0|  Loss:  1.6427 |Global loss: 5.8239| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.013
Epoch: 1|  Loss:  1.6118 |Global loss: 5.8352| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 1.0217
Epoch: 2|  Loss:  1.6333 |Global loss: 5.8307| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.0222
Epoch: 3|  Loss:  1.6173 |Global loss: 5.8276| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9236
Epoch: 0|  Loss:  1.2604 |Global loss: 5.8021| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.9576
Epoch: 1|  Loss:  1.2901 |Global loss: 5.7819| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9374
Epoch: 2|  Loss:  1.2798 |Global loss: 5.8027| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 3|  NKD Loss: 0.9317
Epoch: 3|  Loss:  1.2725 |Global loss: 5.7998| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 0.9682
Epoch: 0|  Loss:  1.531 |Global loss: 5.792| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9797
Epoch: 1|  Loss:  1.5351 |Global loss: 5.7753| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.9816
Epoch: 2|  Loss:  1.5352 |Global loss: 5.7775| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.981
Epoch: 3|  Loss:  1.5313 |Global loss: 5.7721| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9266
Epoch: 0|  Loss:  1.2078 |Global loss: 5.7632| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.9245
Epoch: 1|  Loss:  1.2074 |Global loss: 5.7599| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.9251
Epoch: 2|  Loss:  1.2141 |Global loss: 5.7599| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.9273
Epoch: 3|  Loss:  1.2004 |Global loss: 5.7651| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 1.0963
Epoch: 0|  Loss:  2.1716 |Global loss: 5.9044| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 1.1082
Epoch: 1|  Loss:  2.1973 |Global loss: 5.8943| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 1.1185
Epoch: 2|  Loss:  2.178 |Global loss: 5.9022| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 1.0936
Epoch: 3|  Loss:  2.1725 |Global loss: 5.8959| Local H loss: 0.0302  | Global H loss: 0.0302
------------------------- time cost ------------------------- 2.9171226024627686
Chosen Clients:  [4, 7, 0, 11, 1, 12]

-------------Round number: 287-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.742, 0.833, 0.883, 0.833, 0.792, 0.792, 0.975, 0.967, 0.983, 0.767, 0.933, 0.325, 0.783, 0.883]
AUC in each clients:  [115.651, 117.675, 116.57, 116.908, 118.043, 116.258, 116.416, 117.446, 118.403, 118.361, 116.503, 118.039, 111.671, 113.995, 117.973]
F1 Score:  [0.713, 0.728, 0.847, 0.842, 0.761, 0.759, 0.783, 0.971, 0.961, 0.981, 0.795, 0.933, 0.338, 0.756, 0.857]
Recall Score:  [0.758, 0.765, 0.863, 0.872, 0.81, 0.775, 0.829, 0.977, 0.968, 0.984, 0.828, 0.949, 0.383, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4508
Averaged Test Accurancy: 0.8133
Averaged Test AUC: 0.9722
Averaged Test F1_score: 0.8017
Averaged Test Recal score: 0.8314
Std Test Accurancy: 0.1554
Std Test AUC: 0.0147
Std Test F1: 0.0013
Std Test Recall: 0.0012
Epoch: 0|  NKD Loss: 0.9363
Epoch: 0|  Loss:  1.4123 |Global loss: 5.759| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9453
Epoch: 1|  Loss:  1.4301 |Global loss: 5.7435| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9364
Epoch: 2|  Loss:  1.4196 |Global loss: 5.7544| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.9377
Epoch: 3|  Loss:  1.4092 |Global loss: 5.7524| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9632
Epoch: 0|  Loss:  1.4138 |Global loss: 5.8188| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.9847
Epoch: 1|  Loss:  1.4236 |Global loss: 5.8042| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.9842
Epoch: 2|  Loss:  1.4159 |Global loss: 5.8049| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.9692
Epoch: 3|  Loss:  1.3974 |Global loss: 5.8149| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.963
Epoch: 0|  Loss:  1.5031 |Global loss: 5.7889| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.982
Epoch: 1|  Loss:  1.5193 |Global loss: 5.776| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9563
Epoch: 2|  Loss:  1.4815 |Global loss: 5.7929| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.9835
Epoch: 3|  Loss:  1.5335 |Global loss: 5.7804| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9277
Epoch: 0|  Loss:  1.2099 |Global loss: 5.7632| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.9371
Epoch: 1|  Loss:  1.2285 |Global loss: 5.7459| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.9251
Epoch: 2|  Loss:  1.204 |Global loss: 5.7624| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.9189
Epoch: 3|  Loss:  1.206 |Global loss: 5.765| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 1.0027
Epoch: 0|  Loss:  1.5299 |Global loss: 5.8338| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9991
Epoch: 1|  Loss:  1.526 |Global loss: 5.8226| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.99
Epoch: 2|  Loss:  1.5075 |Global loss: 5.8406| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9991
Epoch: 3|  Loss:  1.5109 |Global loss: 5.8288| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.0763
Epoch: 0|  Loss:  2.1507 |Global loss: 5.9087| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 1.0958
Epoch: 1|  Loss:  2.1505 |Global loss: 5.902| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 1.1043
Epoch: 2|  Loss:  2.1704 |Global loss: 5.8862| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 1.0973
Epoch: 3|  Loss:  2.1616 |Global loss: 5.8875| Local H loss: 0.0305  | Global H loss: 0.0305
------------------------- time cost ------------------------- 3.2278385162353516
Chosen Clients:  [10, 7, 0, 6, 9, 1]

-------------Round number: 288-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.725, 0.833, 0.883, 0.842, 0.792, 0.792, 0.975, 0.967, 0.983, 0.767, 0.958, 0.567, 0.783, 0.883]
AUC in each clients:  [115.664, 117.722, 116.57, 116.908, 118.055, 116.258, 116.416, 117.6, 118.403, 118.361, 116.503, 118.172, 112.855, 113.995, 117.973]
F1 Score:  [0.713, 0.704, 0.847, 0.842, 0.766, 0.759, 0.783, 0.971, 0.961, 0.981, 0.795, 0.955, 0.577, 0.756, 0.857]
Recall Score:  [0.758, 0.749, 0.863, 0.872, 0.817, 0.775, 0.829, 0.977, 0.968, 0.984, 0.828, 0.966, 0.637, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4501
Averaged Test Accurancy: 0.8306
Averaged Test AUC: 0.9730
Averaged Test F1_score: 0.8178
Averaged Test Recal score: 0.8489
Std Test Accurancy: 0.1125
Std Test AUC: 0.0130
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9739
Epoch: 0|  Loss:  1.3603 |Global loss: 5.8042| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.9646
Epoch: 1|  Loss:  1.3428 |Global loss: 5.8139| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.9685
Epoch: 2|  Loss:  1.3506 |Global loss: 5.8135| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.9594
Epoch: 3|  Loss:  1.3406 |Global loss: 5.8105| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.9633
Epoch: 0|  Loss:  1.393 |Global loss: 5.8115| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9752
Epoch: 1|  Loss:  1.3973 |Global loss: 5.8018| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9885
Epoch: 2|  Loss:  1.4034 |Global loss: 5.7948| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.9833
Epoch: 3|  Loss:  1.3904 |Global loss: 5.7909| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 0|  NKD Loss: 0.979
Epoch: 0|  Loss:  1.5135 |Global loss: 5.7799| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.9719
Epoch: 1|  Loss:  1.5196 |Global loss: 5.7847| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.9651
Epoch: 2|  Loss:  1.5081 |Global loss: 5.7838| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.9838
Epoch: 3|  Loss:  1.517 |Global loss: 5.7758| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9771
Epoch: 0|  Loss:  1.4617 |Global loss: 5.8021| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.9819
Epoch: 1|  Loss:  1.4607 |Global loss: 5.7951| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9568
Epoch: 2|  Loss:  1.4326 |Global loss: 5.8047| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.9697
Epoch: 3|  Loss:  1.4482 |Global loss: 5.8066| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.9294
Epoch: 0|  Loss:  1.2188 |Global loss: 5.7711| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 0.9278
Epoch: 1|  Loss:  1.2236 |Global loss: 5.7728| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.938
Epoch: 2|  Loss:  1.2275 |Global loss: 5.7652| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.91
Epoch: 3|  Loss:  1.2065 |Global loss: 5.783| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.9825
Epoch: 0|  Loss:  1.4967 |Global loss: 5.8289| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9977
Epoch: 1|  Loss:  1.5037 |Global loss: 5.8245| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 1.013
Epoch: 2|  Loss:  1.5317 |Global loss: 5.8239| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 1.0104
Epoch: 3|  Loss:  1.5315 |Global loss: 5.8241| Local H loss: 0.0282  | Global H loss: 0.0282
------------------------- time cost ------------------------- 2.9680771827697754
Chosen Clients:  [12, 1, 5, 2, 13, 10]

-------------Round number: 289-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.775, 0.833, 0.883, 0.842, 0.792, 0.792, 0.975, 0.967, 0.983, 0.833, 0.958, 0.567, 0.783, 0.883]
AUC in each clients:  [115.658, 117.92, 116.57, 116.908, 118.055, 116.258, 116.513, 117.756, 118.403, 118.373, 116.752, 118.172, 112.855, 113.995, 117.973]
F1 Score:  [0.702, 0.752, 0.847, 0.842, 0.766, 0.759, 0.783, 0.971, 0.961, 0.981, 0.832, 0.955, 0.577, 0.756, 0.857]
Recall Score:  [0.747, 0.798, 0.863, 0.872, 0.817, 0.775, 0.829, 0.977, 0.968, 0.984, 0.873, 0.966, 0.637, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4472
Averaged Test Accurancy: 0.8378
Averaged Test AUC: 0.9734
Averaged Test F1_score: 0.8227
Averaged Test Recal score: 0.8544
Std Test Accurancy: 0.1092
Std Test AUC: 0.0131
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.0924
Epoch: 0|  Loss:  2.1236 |Global loss: 5.9131| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 1.1028
Epoch: 1|  Loss:  2.1373 |Global loss: 5.8847| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 1.0873
Epoch: 2|  Loss:  2.1428 |Global loss: 5.8912| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 1.0837
Epoch: 3|  Loss:  2.103 |Global loss: 5.9031| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.991
Epoch: 0|  Loss:  1.4904 |Global loss: 5.8326| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9902
Epoch: 1|  Loss:  1.499 |Global loss: 5.835| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 1.0089
Epoch: 2|  Loss:  1.5205 |Global loss: 5.824| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9934
Epoch: 3|  Loss:  1.4951 |Global loss: 5.8341| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0087
Epoch: 0|  Loss:  1.6194 |Global loss: 5.8394| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.0082
Epoch: 1|  Loss:  1.614 |Global loss: 5.8347| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 1.0241
Epoch: 2|  Loss:  1.6248 |Global loss: 5.8293| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.0229
Epoch: 3|  Loss:  1.6264 |Global loss: 5.826| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9823
Epoch: 0|  Loss:  1.4137 |Global loss: 5.8356| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 1.0028
Epoch: 1|  Loss:  1.4536 |Global loss: 5.8394| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9929
Epoch: 2|  Loss:  1.4366 |Global loss: 5.8326| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.9988
Epoch: 3|  Loss:  1.4545 |Global loss: 5.8467| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9691
Epoch: 0|  Loss:  1.6079 |Global loss: 5.8251| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9865
Epoch: 1|  Loss:  1.6121 |Global loss: 5.8026| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.973
Epoch: 2|  Loss:  1.5896 |Global loss: 5.8105| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.6315 |Global loss: 5.7893| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9453
Epoch: 0|  Loss:  1.3222 |Global loss: 5.8254| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9724
Epoch: 1|  Loss:  1.3542 |Global loss: 5.8024| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.976
Epoch: 2|  Loss:  1.3478 |Global loss: 5.798| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.969
Epoch: 3|  Loss:  1.3454 |Global loss: 5.8066| Local H loss: 0.0392  | Global H loss: 0.0392
------------------------- time cost ------------------------- 3.010340452194214
Chosen Clients:  [5, 11, 12, 10, 9, 4]

-------------Round number: 290-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.708, 0.858, 0.883, 0.842, 0.742, 0.792, 0.975, 0.967, 0.983, 0.833, 0.958, 0.475, 0.783, 0.883]
AUC in each clients:  [115.658, 117.811, 116.523, 116.908, 118.055, 116.087, 116.513, 117.756, 118.403, 118.373, 116.671, 118.172, 111.948, 114.13, 117.973]
F1 Score:  [0.702, 0.673, 0.867, 0.842, 0.766, 0.666, 0.783, 0.971, 0.961, 0.981, 0.832, 0.955, 0.495, 0.756, 0.857]
Recall Score:  [0.747, 0.731, 0.887, 0.872, 0.817, 0.712, 0.829, 0.977, 0.968, 0.984, 0.873, 0.966, 0.558, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4417
Averaged Test Accurancy: 0.8256
Averaged Test AUC: 0.9728
Averaged Test F1_score: 0.8071
Averaged Test Recal score: 0.8421
Std Test Accurancy: 0.1304
Std Test AUC: 0.0143
Std Test F1: 0.0011
Std Test Recall: 0.0010
Epoch: 0|  NKD Loss: 1.0112
Epoch: 0|  Loss:  1.6154 |Global loss: 5.8326| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 1.0045
Epoch: 1|  Loss:  1.585 |Global loss: 5.8253| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.0164
Epoch: 2|  Loss:  1.5973 |Global loss: 5.8277| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.0132
Epoch: 3|  Loss:  1.6053 |Global loss: 5.8353| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9186
Epoch: 0|  Loss:  1.1852 |Global loss: 5.7544| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.9188
Epoch: 1|  Loss:  1.1856 |Global loss: 5.7643| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 2|  NKD Loss: 0.926
Epoch: 2|  Loss:  1.204 |Global loss: 5.7635| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.9162
Epoch: 3|  Loss:  1.1916 |Global loss: 5.7675| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0749
Epoch: 0|  Loss:  2.1304 |Global loss: 5.8978| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 1.0874
Epoch: 1|  Loss:  2.1164 |Global loss: 5.908| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 1.1019
Epoch: 2|  Loss:  2.1355 |Global loss: 5.8869| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 1.0703
Epoch: 3|  Loss:  2.0969 |Global loss: 5.9008| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.9665
Epoch: 0|  Loss:  1.342 |Global loss: 5.8055| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.9562
Epoch: 1|  Loss:  1.3305 |Global loss: 5.8128| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.94
Epoch: 2|  Loss:  1.311 |Global loss: 5.822| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9585
Epoch: 3|  Loss:  1.3315 |Global loss: 5.8109| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9101
Epoch: 0|  Loss:  1.1988 |Global loss: 5.7827| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.1974 |Global loss: 5.7774| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 2|  NKD Loss: 0.9346
Epoch: 2|  Loss:  1.2259 |Global loss: 5.7642| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.9339
Epoch: 3|  Loss:  1.2047 |Global loss: 5.768| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9258
Epoch: 0|  Loss:  1.4088 |Global loss: 5.7579| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9277
Epoch: 1|  Loss:  1.4263 |Global loss: 5.7637| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.927
Epoch: 2|  Loss:  1.4056 |Global loss: 5.7556| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.9457
Epoch: 3|  Loss:  1.4329 |Global loss: 5.7442| Local H loss: 0.0266  | Global H loss: 0.0266
------------------------- time cost ------------------------- 3.258965253829956
Chosen Clients:  [8, 0, 5, 4, 1, 12]

-------------Round number: 291-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.7, 0.708, 0.858, 0.883, 0.833, 0.758, 0.792, 0.975, 0.967, 0.983, 0.833, 0.933, 0.483, 0.783, 0.883]
AUC in each clients:  [115.658, 117.811, 116.523, 116.908, 118.038, 116.196, 116.513, 117.756, 118.403, 118.362, 116.734, 118.062, 112.446, 114.13, 117.973]
F1 Score:  [0.702, 0.673, 0.867, 0.842, 0.761, 0.701, 0.783, 0.971, 0.961, 0.981, 0.832, 0.933, 0.5, 0.756, 0.857]
Recall Score:  [0.747, 0.731, 0.887, 0.872, 0.81, 0.733, 0.829, 0.977, 0.968, 0.984, 0.873, 0.949, 0.567, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4378
Averaged Test Accurancy: 0.8250
Averaged Test AUC: 0.9731
Averaged Test F1_score: 0.8080
Averaged Test Recal score: 0.8425
Std Test Accurancy: 0.1267
Std Test AUC: 0.0135
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9619
Epoch: 0|  Loss:  1.2976 |Global loss: 5.7902| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.9613
Epoch: 1|  Loss:  1.2925 |Global loss: 5.787| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9281
Epoch: 2|  Loss:  1.262 |Global loss: 5.8053| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9447
Epoch: 3|  Loss:  1.2746 |Global loss: 5.7974| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9704
Epoch: 0|  Loss:  1.5028 |Global loss: 5.7807| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.9677
Epoch: 1|  Loss:  1.5153 |Global loss: 5.7866| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 0.9603
Epoch: 2|  Loss:  1.4929 |Global loss: 5.7839| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9793
Epoch: 3|  Loss:  1.5186 |Global loss: 5.777| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.0053
Epoch: 0|  Loss:  1.5833 |Global loss: 5.8281| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 1.0136
Epoch: 1|  Loss:  1.5987 |Global loss: 5.8352| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.023
Epoch: 2|  Loss:  1.609 |Global loss: 5.8199| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 1.0233
Epoch: 3|  Loss:  1.6025 |Global loss: 5.8175| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9033
Epoch: 0|  Loss:  1.3972 |Global loss: 5.7669| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.93
Epoch: 1|  Loss:  1.4003 |Global loss: 5.7506| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9556
Epoch: 2|  Loss:  1.4408 |Global loss: 5.7383| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.9504
Epoch: 3|  Loss:  1.4262 |Global loss: 5.7402| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9954
Epoch: 0|  Loss:  1.4879 |Global loss: 5.83| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9762
Epoch: 1|  Loss:  1.4806 |Global loss: 5.8472| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9747
Epoch: 2|  Loss:  1.4792 |Global loss: 5.8463| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 1.0039
Epoch: 3|  Loss:  1.5026 |Global loss: 5.8259| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.0642
Epoch: 0|  Loss:  2.0803 |Global loss: 5.9081| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 1.0822
Epoch: 1|  Loss:  2.0905 |Global loss: 5.8912| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 1.0535
Epoch: 2|  Loss:  2.0607 |Global loss: 5.9219| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 1.0807
Epoch: 3|  Loss:  2.0978 |Global loss: 5.8884| Local H loss: 0.0325  | Global H loss: 0.0325
------------------------- time cost ------------------------- 2.84675669670105
Chosen Clients:  [5, 12, 10, 4, 6, 13]

-------------Round number: 292-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.792, 0.858, 0.883, 0.833, 0.783, 0.792, 0.975, 0.958, 0.983, 0.833, 0.933, 0.483, 0.783, 0.883]
AUC in each clients:  [115.723, 118.078, 116.523, 116.908, 118.039, 116.457, 116.513, 117.756, 118.243, 118.362, 116.734, 118.062, 112.639, 114.13, 117.973]
F1 Score:  [0.73, 0.776, 0.867, 0.842, 0.761, 0.748, 0.783, 0.971, 0.95, 0.981, 0.832, 0.933, 0.5, 0.756, 0.857]
Recall Score:  [0.779, 0.808, 0.887, 0.872, 0.81, 0.764, 0.829, 0.977, 0.958, 0.984, 0.873, 0.949, 0.567, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4370
Averaged Test Accurancy: 0.8333
Averaged Test AUC: 0.9734
Averaged Test F1_score: 0.8191
Averaged Test Recal score: 0.8511
Std Test Accurancy: 0.1201
Std Test AUC: 0.0132
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.0264
Epoch: 0|  Loss:  1.6078 |Global loss: 5.8218| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.0042
Epoch: 1|  Loss:  1.5846 |Global loss: 5.8229| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9826
Epoch: 2|  Loss:  1.5609 |Global loss: 5.8413| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 1.0099
Epoch: 3|  Loss:  1.5897 |Global loss: 5.8264| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0844
Epoch: 0|  Loss:  2.0726 |Global loss: 5.8911| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 1.0925
Epoch: 1|  Loss:  2.0877 |Global loss: 5.888| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 1.0866
Epoch: 2|  Loss:  2.0885 |Global loss: 5.8807| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 1.0735
Epoch: 3|  Loss:  2.0427 |Global loss: 5.8933| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.9676
Epoch: 0|  Loss:  1.3359 |Global loss: 5.8018| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 0.9666
Epoch: 1|  Loss:  1.3373 |Global loss: 5.8039| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.9754
Epoch: 2|  Loss:  1.3408 |Global loss: 5.7962| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9468
Epoch: 3|  Loss:  1.3088 |Global loss: 5.8165| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.9335
Epoch: 0|  Loss:  1.4004 |Global loss: 5.7496| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9458
Epoch: 1|  Loss:  1.4211 |Global loss: 5.7404| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.9141
Epoch: 2|  Loss:  1.3805 |Global loss: 5.7618| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.9505
Epoch: 3|  Loss:  1.4242 |Global loss: 5.7317| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9949
Epoch: 0|  Loss:  1.4645 |Global loss: 5.789| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 1|  NKD Loss: 0.9617
Epoch: 1|  Loss:  1.4361 |Global loss: 5.8| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9798
Epoch: 2|  Loss:  1.456 |Global loss: 5.7939| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.9843
Epoch: 3|  Loss:  1.4288 |Global loss: 5.7903| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.9802
Epoch: 0|  Loss:  1.5918 |Global loss: 5.8069| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9775
Epoch: 1|  Loss:  1.5981 |Global loss: 5.8052| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9792
Epoch: 2|  Loss:  1.6153 |Global loss: 5.8033| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9867
Epoch: 3|  Loss:  1.6073 |Global loss: 5.8071| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 3.0614211559295654
Chosen Clients:  [12, 9, 14, 5, 4, 6]

-------------Round number: 293-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.792, 0.858, 0.883, 0.833, 0.833, 0.792, 0.975, 0.958, 0.983, 0.833, 0.933, 0.483, 0.783, 0.883]
AUC in each clients:  [115.723, 118.078, 116.523, 116.908, 118.032, 116.538, 116.521, 117.756, 118.243, 118.362, 116.714, 118.062, 112.652, 113.765, 117.973]
F1 Score:  [0.73, 0.776, 0.867, 0.842, 0.761, 0.805, 0.783, 0.971, 0.95, 0.981, 0.832, 0.933, 0.5, 0.756, 0.857]
Recall Score:  [0.779, 0.808, 0.887, 0.872, 0.81, 0.83, 0.829, 0.977, 0.958, 0.984, 0.873, 0.949, 0.567, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4370
Averaged Test Accurancy: 0.8367
Averaged Test AUC: 0.9732
Averaged Test F1_score: 0.8229
Averaged Test Recal score: 0.8555
Std Test Accurancy: 0.1194
Std Test AUC: 0.0135
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.0875
Epoch: 0|  Loss:  2.0738 |Global loss: 5.8816| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 1.0966
Epoch: 1|  Loss:  2.1094 |Global loss: 5.8806| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 1.0978
Epoch: 2|  Loss:  2.0725 |Global loss: 5.8934| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 1.0768
Epoch: 3|  Loss:  2.0539 |Global loss: 5.8818| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 0|  NKD Loss: 0.9271
Epoch: 0|  Loss:  1.2165 |Global loss: 5.7654| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.9256
Epoch: 1|  Loss:  1.212 |Global loss: 5.7676| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.9246
Epoch: 2|  Loss:  1.2102 |Global loss: 5.7707| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9208
Epoch: 3|  Loss:  1.2029 |Global loss: 5.7694| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.9544
Epoch: 0|  Loss:  1.2902 |Global loss: 5.7892| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9475
Epoch: 1|  Loss:  1.2746 |Global loss: 5.7845| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.937
Epoch: 2|  Loss:  1.2712 |Global loss: 5.7911| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 3|  NKD Loss: 0.9432
Epoch: 3|  Loss:  1.2716 |Global loss: 5.791| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0101
Epoch: 0|  Loss:  1.5798 |Global loss: 5.8357| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 1.0175
Epoch: 1|  Loss:  1.5944 |Global loss: 5.8203| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9829
Epoch: 2|  Loss:  1.5492 |Global loss: 5.8456| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 1.0172
Epoch: 3|  Loss:  1.577 |Global loss: 5.8203| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9456
Epoch: 0|  Loss:  1.399 |Global loss: 5.7345| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.933
Epoch: 1|  Loss:  1.4104 |Global loss: 5.7453| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.9364
Epoch: 2|  Loss:  1.4203 |Global loss: 5.7439| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.9308
Epoch: 3|  Loss:  1.393 |Global loss: 5.7486| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.9635
Epoch: 0|  Loss:  1.4155 |Global loss: 5.8042| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9668
Epoch: 1|  Loss:  1.4289 |Global loss: 5.7988| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 2|  NKD Loss: 0.9506
Epoch: 2|  Loss:  1.4103 |Global loss: 5.808| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 3|  NKD Loss: 0.9609
Epoch: 3|  Loss:  1.4194 |Global loss: 5.7965| Local H loss: 0.0306  | Global H loss: 0.0306
------------------------- time cost ------------------------- 2.92964768409729
Chosen Clients:  [14, 5, 9, 7, 10, 13]

-------------Round number: 294-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.792, 0.858, 0.883, 0.842, 0.767, 0.792, 0.975, 0.958, 0.983, 0.833, 0.933, 0.525, 0.783, 0.9]
AUC in each clients:  [115.723, 118.078, 116.523, 116.908, 118.043, 116.523, 116.558, 117.756, 118.243, 118.418, 116.714, 118.062, 112.927, 113.765, 117.966]
F1 Score:  [0.73, 0.776, 0.867, 0.842, 0.766, 0.706, 0.783, 0.971, 0.95, 0.981, 0.832, 0.933, 0.546, 0.756, 0.884]
Recall Score:  [0.779, 0.808, 0.887, 0.872, 0.817, 0.742, 0.829, 0.977, 0.958, 0.984, 0.873, 0.949, 0.602, 0.81, 0.914]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4316
Averaged Test Accurancy: 0.8367
Averaged Test AUC: 0.9734
Averaged Test F1_score: 0.8215
Averaged Test Recal score: 0.8534
Std Test Accurancy: 0.1134
Std Test AUC: 0.0131
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9558
Epoch: 0|  Loss:  1.2912 |Global loss: 5.7791| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9524
Epoch: 1|  Loss:  1.2703 |Global loss: 5.7822| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 2|  NKD Loss: 0.9504
Epoch: 2|  Loss:  1.2703 |Global loss: 5.7832| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.946
Epoch: 3|  Loss:  1.2639 |Global loss: 5.7815| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 1.0061
Epoch: 0|  Loss:  1.5624 |Global loss: 5.8305| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.002
Epoch: 1|  Loss:  1.5622 |Global loss: 5.8315| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.0036
Epoch: 2|  Loss:  1.5543 |Global loss: 5.831| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.0253
Epoch: 3|  Loss:  1.5728 |Global loss: 5.8091| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9313
Epoch: 0|  Loss:  1.2153 |Global loss: 5.7585| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.9099
Epoch: 1|  Loss:  1.1906 |Global loss: 5.7734| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.9346
Epoch: 2|  Loss:  1.2165 |Global loss: 5.7581| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 3|  NKD Loss: 0.908
Epoch: 3|  Loss:  1.1898 |Global loss: 5.7798| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9667
Epoch: 0|  Loss:  1.3712 |Global loss: 5.8045| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 1|  NKD Loss: 0.9523
Epoch: 1|  Loss:  1.3655 |Global loss: 5.8118| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.9734
Epoch: 2|  Loss:  1.3862 |Global loss: 5.8014| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.9763
Epoch: 3|  Loss:  1.3798 |Global loss: 5.7933| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.9604
Epoch: 0|  Loss:  1.3277 |Global loss: 5.7987| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.9533
Epoch: 1|  Loss:  1.3184 |Global loss: 5.8106| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9612
Epoch: 2|  Loss:  1.3214 |Global loss: 5.8051| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 0.9463
Epoch: 3|  Loss:  1.3098 |Global loss: 5.8139| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9742
Epoch: 0|  Loss:  1.6119 |Global loss: 5.803| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9873
Epoch: 1|  Loss:  1.6285 |Global loss: 5.7995| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9951
Epoch: 2|  Loss:  1.5895 |Global loss: 5.7941| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9649
Epoch: 3|  Loss:  1.575 |Global loss: 5.8084| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 3.0696916580200195
Chosen Clients:  [7, 10, 6, 12, 9, 11]

-------------Round number: 295-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.792, 0.858, 0.883, 0.842, 0.767, 0.792, 0.975, 0.958, 0.983, 0.833, 0.933, 0.525, 0.783, 0.883]
AUC in each clients:  [115.723, 118.078, 116.523, 116.908, 118.043, 116.296, 116.558, 117.909, 118.243, 118.402, 116.894, 118.062, 112.927, 114.116, 117.979]
F1 Score:  [0.73, 0.776, 0.867, 0.842, 0.766, 0.706, 0.783, 0.971, 0.95, 0.981, 0.832, 0.933, 0.546, 0.756, 0.857]
Recall Score:  [0.779, 0.808, 0.887, 0.872, 0.817, 0.742, 0.829, 0.977, 0.958, 0.984, 0.873, 0.949, 0.602, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4244
Averaged Test Accurancy: 0.8356
Averaged Test AUC: 0.9737
Averaged Test F1_score: 0.8197
Averaged Test Recal score: 0.8525
Std Test Accurancy: 0.1129
Std Test AUC: 0.0129
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9744
Epoch: 0|  Loss:  1.3731 |Global loss: 5.7943| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 1|  NKD Loss: 0.9398
Epoch: 1|  Loss:  1.3372 |Global loss: 5.8189| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.964
Epoch: 2|  Loss:  1.3504 |Global loss: 5.7971| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 0.96
Epoch: 3|  Loss:  1.3516 |Global loss: 5.8085| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.9498
Epoch: 0|  Loss:  1.3124 |Global loss: 5.8046| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.9599
Epoch: 1|  Loss:  1.3233 |Global loss: 5.7958| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9599
Epoch: 2|  Loss:  1.3228 |Global loss: 5.8055| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.9493
Epoch: 3|  Loss:  1.3046 |Global loss: 5.8098| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9668
Epoch: 0|  Loss:  1.4111 |Global loss: 5.8005| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.9819
Epoch: 1|  Loss:  1.445 |Global loss: 5.7916| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.9708
Epoch: 2|  Loss:  1.4276 |Global loss: 5.7993| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.9688
Epoch: 3|  Loss:  1.4321 |Global loss: 5.7973| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 1.0847
Epoch: 0|  Loss:  2.0638 |Global loss: 5.8853| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 1.0864
Epoch: 1|  Loss:  2.064 |Global loss: 5.8756| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 1.0555
Epoch: 2|  Loss:  2.0292 |Global loss: 5.9146| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 1.0748
Epoch: 3|  Loss:  2.054 |Global loss: 5.8849| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.918
Epoch: 0|  Loss:  1.1958 |Global loss: 5.7598| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9117
Epoch: 1|  Loss:  1.1691 |Global loss: 5.7705| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.9183
Epoch: 2|  Loss:  1.1991 |Global loss: 5.7658| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9167
Epoch: 3|  Loss:  1.1961 |Global loss: 5.7668| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9129
Epoch: 0|  Loss:  1.1946 |Global loss: 5.7694| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.9124
Epoch: 1|  Loss:  1.1931 |Global loss: 5.7658| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9267
Epoch: 2|  Loss:  1.2005 |Global loss: 5.761| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.9157
Epoch: 3|  Loss:  1.1913 |Global loss: 5.7605| Local H loss: 0.0288  | Global H loss: 0.0288
------------------------- time cost ------------------------- 2.87160325050354
Chosen Clients:  [5, 0, 6, 7, 8, 3]

-------------Round number: 296-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.792, 0.858, 0.883, 0.842, 0.767, 0.792, 0.975, 0.958, 0.983, 0.833, 0.975, 0.5, 0.783, 0.883]
AUC in each clients:  [115.723, 118.078, 116.523, 116.908, 118.043, 116.296, 116.476, 117.892, 118.243, 118.475, 116.821, 118.236, 113.045, 114.116, 117.979]
F1 Score:  [0.73, 0.776, 0.867, 0.842, 0.766, 0.706, 0.783, 0.971, 0.95, 0.981, 0.832, 0.971, 0.516, 0.756, 0.857]
Recall Score:  [0.779, 0.808, 0.887, 0.872, 0.817, 0.742, 0.829, 0.977, 0.958, 0.984, 0.873, 0.977, 0.581, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4170
Averaged Test Accurancy: 0.8367
Averaged Test AUC: 0.9738
Averaged Test F1_score: 0.8203
Averaged Test Recal score: 0.8529
Std Test Accurancy: 0.1203
Std Test AUC: 0.0128
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.0102
Epoch: 0|  Loss:  1.5616 |Global loss: 5.8245| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 1.0173
Epoch: 1|  Loss:  1.5661 |Global loss: 5.8172| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 1.0196
Epoch: 2|  Loss:  1.5748 |Global loss: 5.8167| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 1.0162
Epoch: 3|  Loss:  1.5604 |Global loss: 5.814| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9649
Epoch: 0|  Loss:  1.4911 |Global loss: 5.7874| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.982
Epoch: 1|  Loss:  1.5226 |Global loss: 5.78| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.9676
Epoch: 2|  Loss:  1.4866 |Global loss: 5.7809| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9768
Epoch: 3|  Loss:  1.4881 |Global loss: 5.7712| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.9673
Epoch: 0|  Loss:  1.4138 |Global loss: 5.8014| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.956
Epoch: 1|  Loss:  1.4167 |Global loss: 5.8127| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.9754
Epoch: 2|  Loss:  1.4171 |Global loss: 5.7958| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.973
Epoch: 3|  Loss:  1.4145 |Global loss: 5.7929| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.9589
Epoch: 0|  Loss:  1.3485 |Global loss: 5.8067| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 1|  NKD Loss: 0.962
Epoch: 1|  Loss:  1.3417 |Global loss: 5.7969| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 2|  NKD Loss: 0.9473
Epoch: 2|  Loss:  1.3339 |Global loss: 5.8053| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.9668
Epoch: 3|  Loss:  1.3409 |Global loss: 5.7917| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.932
Epoch: 0|  Loss:  1.2679 |Global loss: 5.8009| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.9524
Epoch: 1|  Loss:  1.2866 |Global loss: 5.7902| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.9313
Epoch: 2|  Loss:  1.2626 |Global loss: 5.8081| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9431
Epoch: 3|  Loss:  1.2692 |Global loss: 5.7966| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9634
Epoch: 0|  Loss:  1.3891 |Global loss: 5.7727| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 1|  NKD Loss: 0.9518
Epoch: 1|  Loss:  1.3826 |Global loss: 5.7802| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.9342
Epoch: 2|  Loss:  1.3663 |Global loss: 5.7927| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.9371
Epoch: 3|  Loss:  1.3689 |Global loss: 5.7931| Local H loss: 0.041  | Global H loss: 0.041
------------------------- time cost ------------------------- 3.006153106689453
Chosen Clients:  [3, 7, 5, 2, 8, 4]

-------------Round number: 297-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.792, 0.858, 0.883, 0.842, 0.8, 0.792, 0.975, 0.958, 0.983, 0.833, 0.975, 0.5, 0.783, 0.883]
AUC in each clients:  [115.674, 118.078, 116.523, 116.996, 118.043, 116.483, 116.639, 117.92, 118.376, 118.475, 116.821, 118.236, 113.045, 114.116, 117.979]
F1 Score:  [0.712, 0.776, 0.867, 0.842, 0.766, 0.772, 0.783, 0.971, 0.95, 0.981, 0.832, 0.971, 0.516, 0.756, 0.857]
Recall Score:  [0.758, 0.808, 0.887, 0.872, 0.817, 0.785, 0.829, 0.977, 0.958, 0.984, 0.873, 0.977, 0.581, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4192
Averaged Test Accurancy: 0.8378
Averaged Test AUC: 0.9741
Averaged Test F1_score: 0.8235
Averaged Test Recal score: 0.8544
Std Test Accurancy: 0.1204
Std Test AUC: 0.0129
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9418
Epoch: 0|  Loss:  1.3581 |Global loss: 5.7803| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9596
Epoch: 1|  Loss:  1.3794 |Global loss: 5.7704| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.9607
Epoch: 2|  Loss:  1.3842 |Global loss: 5.7692| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 3|  NKD Loss: 0.9589
Epoch: 3|  Loss:  1.3693 |Global loss: 5.7695| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 0|  NKD Loss: 0.975
Epoch: 0|  Loss:  1.3488 |Global loss: 5.7825| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.9329
Epoch: 1|  Loss:  1.3082 |Global loss: 5.811| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 2|  NKD Loss: 0.9403
Epoch: 2|  Loss:  1.3128 |Global loss: 5.811| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.9498
Epoch: 3|  Loss:  1.3104 |Global loss: 5.7985| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 0|  NKD Loss: 1.0092
Epoch: 0|  Loss:  1.5551 |Global loss: 5.8155| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9922
Epoch: 1|  Loss:  1.5454 |Global loss: 5.8332| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9984
Epoch: 2|  Loss:  1.5401 |Global loss: 5.8296| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.9821
Epoch: 3|  Loss:  1.5237 |Global loss: 5.8347| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9806
Epoch: 0|  Loss:  1.4146 |Global loss: 5.8406| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 1.0005
Epoch: 1|  Loss:  1.4255 |Global loss: 5.822| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9749
Epoch: 2|  Loss:  1.4162 |Global loss: 5.8488| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9872
Epoch: 3|  Loss:  1.4093 |Global loss: 5.8335| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9547
Epoch: 0|  Loss:  1.2868 |Global loss: 5.7866| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.9401
Epoch: 1|  Loss:  1.2705 |Global loss: 5.7959| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.9484
Epoch: 2|  Loss:  1.2619 |Global loss: 5.7851| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.943
Epoch: 3|  Loss:  1.2704 |Global loss: 5.789| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9361
Epoch: 0|  Loss:  1.422 |Global loss: 5.7482| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.9313
Epoch: 1|  Loss:  1.4114 |Global loss: 5.7508| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 0.9388
Epoch: 2|  Loss:  1.4038 |Global loss: 5.7367| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.9435
Epoch: 3|  Loss:  1.4261 |Global loss: 5.7331| Local H loss: 0.0261  | Global H loss: 0.0261
------------------------- time cost ------------------------- 3.3145248889923096
Chosen Clients:  [5, 10, 14, 11, 6, 3]

-------------Round number: 298-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.792, 0.858, 0.892, 0.833, 0.758, 0.792, 0.975, 0.967, 0.983, 0.833, 0.975, 0.5, 0.783, 0.883]
AUC in each clients:  [115.674, 118.078, 116.51, 117.102, 118.034, 116.523, 116.639, 117.919, 118.531, 118.475, 116.821, 118.236, 113.045, 114.116, 117.979]
F1 Score:  [0.712, 0.776, 0.867, 0.851, 0.761, 0.701, 0.783, 0.971, 0.961, 0.981, 0.832, 0.971, 0.516, 0.756, 0.857]
Recall Score:  [0.758, 0.808, 0.887, 0.882, 0.81, 0.733, 0.829, 0.977, 0.968, 0.984, 0.873, 0.977, 0.581, 0.81, 0.9]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4200
Averaged Test Accurancy: 0.8356
Averaged Test AUC: 0.9743
Averaged Test F1_score: 0.8197
Averaged Test Recal score: 0.8518
Std Test Accurancy: 0.1225
Std Test AUC: 0.0130
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.0089
Epoch: 0|  Loss:  1.5276 |Global loss: 5.8164| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.0053
Epoch: 1|  Loss:  1.5477 |Global loss: 5.8193| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9971
Epoch: 2|  Loss:  1.5323 |Global loss: 5.8184| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9699
Epoch: 3|  Loss:  1.4981 |Global loss: 5.8393| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9494
Epoch: 0|  Loss:  1.303 |Global loss: 5.8027| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9523
Epoch: 1|  Loss:  1.3093 |Global loss: 5.7985| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.943
Epoch: 2|  Loss:  1.2995 |Global loss: 5.8074| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.9562
Epoch: 3|  Loss:  1.3104 |Global loss: 5.8037| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.2589 |Global loss: 5.7909| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9146
Epoch: 1|  Loss:  1.2456 |Global loss: 5.8055| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9392
Epoch: 2|  Loss:  1.2645 |Global loss: 5.7854| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.9457
Epoch: 3|  Loss:  1.2674 |Global loss: 5.782| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 0|  NKD Loss: 0.9349
Epoch: 0|  Loss:  1.2107 |Global loss: 5.7498| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.9111
Epoch: 1|  Loss:  1.1811 |Global loss: 5.7627| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.9194
Epoch: 2|  Loss:  1.1966 |Global loss: 5.7601| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.9175
Epoch: 3|  Loss:  1.1876 |Global loss: 5.7603| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.9617
Epoch: 0|  Loss:  1.414 |Global loss: 5.8021| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9496
Epoch: 1|  Loss:  1.4033 |Global loss: 5.801| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.99
Epoch: 2|  Loss:  1.42 |Global loss: 5.7841| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9807
Epoch: 3|  Loss:  1.4269 |Global loss: 5.7854| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.956
Epoch: 0|  Loss:  1.3743 |Global loss: 5.7718| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 1|  NKD Loss: 0.9454
Epoch: 1|  Loss:  1.3573 |Global loss: 5.7818| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.9452
Epoch: 2|  Loss:  1.3612 |Global loss: 5.7795| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.9642
Epoch: 3|  Loss:  1.3754 |Global loss: 5.7589| Local H loss: 0.0415  | Global H loss: 0.0415
------------------------- time cost ------------------------- 2.9114975929260254
Chosen Clients:  [3, 0, 12, 8, 10, 14]

-------------Round number: 299-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.792, 0.858, 0.883, 0.833, 0.817, 0.792, 0.975, 0.967, 0.983, 0.833, 0.967, 0.5, 0.783, 0.95]
AUC in each clients:  [115.674, 118.078, 116.51, 117.361, 118.034, 116.82, 116.684, 117.919, 118.531, 118.475, 116.907, 118.231, 113.045, 114.116, 118.092]
F1 Score:  [0.712, 0.776, 0.867, 0.842, 0.761, 0.783, 0.783, 0.971, 0.961, 0.981, 0.832, 0.963, 0.516, 0.756, 0.944]
Recall Score:  [0.758, 0.808, 0.887, 0.872, 0.81, 0.805, 0.829, 0.977, 0.968, 0.984, 0.873, 0.971, 0.581, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4170
Averaged Test Accurancy: 0.8428
Averaged Test AUC: 0.9747
Averaged Test F1_score: 0.8299
Averaged Test Recal score: 0.8593
Std Test Accurancy: 0.1229
Std Test AUC: 0.0130
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9538
Epoch: 0|  Loss:  1.3608 |Global loss: 5.7753| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9314
Epoch: 1|  Loss:  1.3213 |Global loss: 5.7838| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.9139
Epoch: 2|  Loss:  1.3157 |Global loss: 5.7918| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.9652
Epoch: 3|  Loss:  1.3618 |Global loss: 5.7611| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.978
Epoch: 0|  Loss:  1.5094 |Global loss: 5.7802| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.9663
Epoch: 1|  Loss:  1.4862 |Global loss: 5.7835| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.9912
Epoch: 2|  Loss:  1.5225 |Global loss: 5.766| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9642
Epoch: 3|  Loss:  1.4885 |Global loss: 5.784| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 1.0737
Epoch: 0|  Loss:  2.0324 |Global loss: 5.8866| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 1.0661
Epoch: 1|  Loss:  2.0233 |Global loss: 5.8879| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 1.0733
Epoch: 2|  Loss:  2.0374 |Global loss: 5.8874| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 1.0669
Epoch: 3|  Loss:  2.0161 |Global loss: 5.8887| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9509
Epoch: 0|  Loss:  1.2748 |Global loss: 5.7849| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9417
Epoch: 1|  Loss:  1.2624 |Global loss: 5.7899| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.957
Epoch: 2|  Loss:  1.2756 |Global loss: 5.7847| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9253
Epoch: 3|  Loss:  1.24 |Global loss: 5.7988| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9417
Epoch: 0|  Loss:  1.2929 |Global loss: 5.81| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9556
Epoch: 1|  Loss:  1.3029 |Global loss: 5.7967| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.9614
Epoch: 2|  Loss:  1.3138 |Global loss: 5.7928| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.9333
Epoch: 3|  Loss:  1.2822 |Global loss: 5.8096| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.2582 |Global loss: 5.7965| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.926
Epoch: 1|  Loss:  1.2457 |Global loss: 5.7926| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9584
Epoch: 2|  Loss:  1.2636 |Global loss: 5.7718| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9471
Epoch: 3|  Loss:  1.2637 |Global loss: 5.7751| Local H loss: 0.0301  | Global H loss: 0.0301
------------------------- time cost ------------------------- 2.7589876651763916
Chosen Clients:  [5, 6, 11, 9, 8, 0]

-------------Round number: 300-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.708, 0.792, 0.858, 0.892, 0.833, 0.817, 0.792, 0.975, 0.967, 0.983, 0.833, 0.967, 0.483, 0.783, 0.95]
AUC in each clients:  [115.698, 118.078, 116.51, 117.22, 118.034, 116.82, 116.684, 117.919, 118.504, 118.475, 116.817, 118.231, 112.843, 114.116, 118.081]
F1 Score:  [0.712, 0.776, 0.867, 0.851, 0.761, 0.783, 0.783, 0.971, 0.961, 0.981, 0.832, 0.963, 0.5, 0.756, 0.944]
Recall Score:  [0.758, 0.808, 0.887, 0.882, 0.81, 0.805, 0.829, 0.977, 0.968, 0.984, 0.873, 0.971, 0.567, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4167
Averaged Test Accurancy: 0.8422
Averaged Test AUC: 0.9745
Averaged Test F1_score: 0.8294
Averaged Test Recal score: 0.8590
Std Test Accurancy: 0.1262
Std Test AUC: 0.0132
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.0025
Epoch: 0|  Loss:  1.5091 |Global loss: 5.8228| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.0077
Epoch: 1|  Loss:  1.5415 |Global loss: 5.8182| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0011
Epoch: 2|  Loss:  1.5271 |Global loss: 5.8235| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 1.0161
Epoch: 3|  Loss:  1.5505 |Global loss: 5.8122| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.945
Epoch: 0|  Loss:  1.393 |Global loss: 5.8105| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9601
Epoch: 1|  Loss:  1.4019 |Global loss: 5.8042| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.9812
Epoch: 2|  Loss:  1.4189 |Global loss: 5.7888| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.949
Epoch: 3|  Loss:  1.3806 |Global loss: 5.8013| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 0|  NKD Loss: 0.8906
Epoch: 0|  Loss:  1.1636 |Global loss: 5.7803| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9262
Epoch: 1|  Loss:  1.1833 |Global loss: 5.7445| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9401
Epoch: 2|  Loss:  1.2123 |Global loss: 5.7504| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.9157
Epoch: 3|  Loss:  1.1938 |Global loss: 5.7582| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9179
Epoch: 0|  Loss:  1.1976 |Global loss: 5.763| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.9041
Epoch: 1|  Loss:  1.1814 |Global loss: 5.7701| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9032
Epoch: 2|  Loss:  1.1818 |Global loss: 5.774| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.909
Epoch: 3|  Loss:  1.1798 |Global loss: 5.7667| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9442
Epoch: 0|  Loss:  1.2648 |Global loss: 5.7857| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9416
Epoch: 1|  Loss:  1.2565 |Global loss: 5.7882| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.941
Epoch: 2|  Loss:  1.2553 |Global loss: 5.7934| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9385
Epoch: 3|  Loss:  1.2571 |Global loss: 5.7904| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.9665
Epoch: 0|  Loss:  1.4707 |Global loss: 5.7774| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.967
Epoch: 1|  Loss:  1.4963 |Global loss: 5.7802| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9685
Epoch: 2|  Loss:  1.4886 |Global loss: 5.7819| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.958
Epoch: 3|  Loss:  1.4788 |Global loss: 5.7905| Local H loss: 0.026  | Global H loss: 0.026
------------------------- time cost ------------------------- 2.822864055633545
Chosen Clients:  [8, 4, 6, 14, 12, 13]

-------------Round number: 301-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.792, 0.858, 0.892, 0.833, 0.808, 0.8, 0.975, 0.967, 0.983, 0.833, 0.975, 0.483, 0.783, 0.95]
AUC in each clients:  [115.8, 118.078, 116.51, 117.22, 118.034, 116.699, 116.688, 117.919, 118.47, 118.448, 116.817, 118.318, 112.843, 114.116, 118.081]
F1 Score:  [0.737, 0.776, 0.867, 0.851, 0.761, 0.781, 0.796, 0.971, 0.961, 0.981, 0.832, 0.971, 0.5, 0.756, 0.944]
Recall Score:  [0.789, 0.808, 0.887, 0.882, 0.81, 0.795, 0.838, 0.977, 0.968, 0.984, 0.873, 0.977, 0.567, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4142
Averaged Test Accurancy: 0.8444
Averaged Test AUC: 0.9745
Averaged Test F1_score: 0.8323
Averaged Test Recal score: 0.8614
Std Test Accurancy: 0.1251
Std Test AUC: 0.0132
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9398
Epoch: 0|  Loss:  1.2578 |Global loss: 5.7838| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9476
Epoch: 1|  Loss:  1.2629 |Global loss: 5.7817| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9528
Epoch: 2|  Loss:  1.2542 |Global loss: 5.7786| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9294
Epoch: 3|  Loss:  1.244 |Global loss: 5.7892| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.9262
Epoch: 0|  Loss:  1.3995 |Global loss: 5.7506| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9369
Epoch: 1|  Loss:  1.4193 |Global loss: 5.7454| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9427
Epoch: 2|  Loss:  1.4243 |Global loss: 5.741| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.9507
Epoch: 3|  Loss:  1.4287 |Global loss: 5.7317| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9663
Epoch: 0|  Loss:  1.397 |Global loss: 5.7971| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.9574
Epoch: 1|  Loss:  1.3884 |Global loss: 5.7952| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.3981 |Global loss: 5.7946| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9492
Epoch: 3|  Loss:  1.3759 |Global loss: 5.802| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.9568
Epoch: 0|  Loss:  1.2702 |Global loss: 5.7773| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 1|  NKD Loss: 0.9454
Epoch: 1|  Loss:  1.2634 |Global loss: 5.7749| Local H loss: 0.03  | Global H loss: 0.03
Epoch: 2|  NKD Loss: 0.9363
Epoch: 2|  Loss:  1.2552 |Global loss: 5.7841| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9284
Epoch: 3|  Loss:  1.2416 |Global loss: 5.791| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 1.0857
Epoch: 0|  Loss:  2.0614 |Global loss: 5.8728| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 1.0541
Epoch: 1|  Loss:  1.9971 |Global loss: 5.8993| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 1.0848
Epoch: 2|  Loss:  2.0336 |Global loss: 5.8758| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.057
Epoch: 3|  Loss:  2.0059 |Global loss: 5.8791| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9831
Epoch: 0|  Loss:  1.5914 |Global loss: 5.8008| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.9807
Epoch: 1|  Loss:  1.5918 |Global loss: 5.7987| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9936
Epoch: 2|  Loss:  1.6127 |Global loss: 5.7945| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9646
Epoch: 3|  Loss:  1.5819 |Global loss: 5.811| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 3.2867631912231445
Chosen Clients:  [8, 6, 3, 10, 11, 13]

-------------Round number: 302-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.792, 0.858, 0.892, 0.833, 0.808, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.533, 0.783, 0.942]
AUC in each clients:  [115.8, 118.078, 116.51, 117.22, 118.043, 116.699, 116.704, 117.919, 118.523, 118.448, 116.817, 118.318, 113.661, 113.832, 118.139]
F1 Score:  [0.737, 0.776, 0.867, 0.851, 0.761, 0.781, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.553, 0.76, 0.935]
Recall Score:  [0.789, 0.808, 0.887, 0.882, 0.81, 0.795, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.609, 0.81, 0.949]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4106
Averaged Test Accurancy: 0.8478
Averaged Test AUC: 0.9748
Averaged Test F1_score: 0.8362
Averaged Test Recal score: 0.8643
Std Test Accurancy: 0.1150
Std Test AUC: 0.0125
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9486
Epoch: 0|  Loss:  1.2614 |Global loss: 5.7837| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.9545
Epoch: 1|  Loss:  1.2632 |Global loss: 5.7755| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9312
Epoch: 2|  Loss:  1.2415 |Global loss: 5.7916| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9097
Epoch: 3|  Loss:  1.2214 |Global loss: 5.804| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.966
Epoch: 0|  Loss:  1.387 |Global loss: 5.794| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9712
Epoch: 1|  Loss:  1.403 |Global loss: 5.7926| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9528
Epoch: 2|  Loss:  1.3693 |Global loss: 5.7929| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 3|  NKD Loss: 0.9488
Epoch: 3|  Loss:  1.3714 |Global loss: 5.8008| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.9386
Epoch: 0|  Loss:  1.3352 |Global loss: 5.7799| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.9392
Epoch: 1|  Loss:  1.3358 |Global loss: 5.774| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9472
Epoch: 2|  Loss:  1.3404 |Global loss: 5.7696| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.9409
Epoch: 3|  Loss:  1.3344 |Global loss: 5.7713| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.9424
Epoch: 0|  Loss:  1.2819 |Global loss: 5.7942| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.9522
Epoch: 1|  Loss:  1.2968 |Global loss: 5.8007| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9546
Epoch: 2|  Loss:  1.3042 |Global loss: 5.7975| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9585
Epoch: 3|  Loss:  1.3046 |Global loss: 5.7913| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9271
Epoch: 0|  Loss:  1.201 |Global loss: 5.7546| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.9187
Epoch: 1|  Loss:  1.1905 |Global loss: 5.7592| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.9191
Epoch: 2|  Loss:  1.1907 |Global loss: 5.7604| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.9167
Epoch: 3|  Loss:  1.1764 |Global loss: 5.758| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.968
Epoch: 0|  Loss:  1.564 |Global loss: 5.8092| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9792
Epoch: 1|  Loss:  1.5991 |Global loss: 5.7935| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9981
Epoch: 2|  Loss:  1.5864 |Global loss: 5.7888| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9939
Epoch: 3|  Loss:  1.5825 |Global loss: 5.7831| Local H loss: 0.0373  | Global H loss: 0.0373
------------------------- time cost ------------------------- 2.89139986038208
Chosen Clients:  [10, 5, 8, 11, 12, 13]

-------------Round number: 303-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.792, 0.858, 0.892, 0.833, 0.808, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.533, 0.783, 0.942]
AUC in each clients:  [115.8, 118.078, 116.51, 117.534, 118.043, 116.699, 116.75, 117.919, 118.523, 118.448, 116.958, 118.33, 113.661, 113.903, 118.139]
F1 Score:  [0.737, 0.776, 0.867, 0.851, 0.761, 0.781, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.553, 0.756, 0.935]
Recall Score:  [0.789, 0.808, 0.887, 0.882, 0.81, 0.795, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.609, 0.81, 0.949]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4083
Averaged Test Accurancy: 0.8478
Averaged Test AUC: 0.9752
Averaged Test F1_score: 0.8359
Averaged Test Recal score: 0.8643
Std Test Accurancy: 0.1150
Std Test AUC: 0.0124
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9376
Epoch: 0|  Loss:  1.28 |Global loss: 5.8063| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9488
Epoch: 1|  Loss:  1.2908 |Global loss: 5.7993| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9515
Epoch: 2|  Loss:  1.2988 |Global loss: 5.7929| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.9642
Epoch: 3|  Loss:  1.2995 |Global loss: 5.7887| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 1.0034
Epoch: 0|  Loss:  1.5338 |Global loss: 5.8254| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9924
Epoch: 1|  Loss:  1.5081 |Global loss: 5.8248| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 1.0007
Epoch: 2|  Loss:  1.5283 |Global loss: 5.8223| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 1.0009
Epoch: 3|  Loss:  1.5263 |Global loss: 5.8244| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9325
Epoch: 0|  Loss:  1.2382 |Global loss: 5.7907| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9314
Epoch: 1|  Loss:  1.2375 |Global loss: 5.7914| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9218
Epoch: 2|  Loss:  1.2317 |Global loss: 5.79| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9308
Epoch: 3|  Loss:  1.2352 |Global loss: 5.7926| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9111
Epoch: 0|  Loss:  1.1829 |Global loss: 5.7606| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.8919
Epoch: 1|  Loss:  1.1612 |Global loss: 5.7792| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9165
Epoch: 2|  Loss:  1.1836 |Global loss: 5.7585| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.9236
Epoch: 3|  Loss:  1.192 |Global loss: 5.7536| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 1.0551
Epoch: 0|  Loss:  1.9818 |Global loss: 5.8898| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 1|  NKD Loss: 1.0682
Epoch: 1|  Loss:  2.0179 |Global loss: 5.8801| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 1.0599
Epoch: 2|  Loss:  1.998 |Global loss: 5.8942| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 1.0797
Epoch: 3|  Loss:  1.9991 |Global loss: 5.8708| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9626
Epoch: 0|  Loss:  1.5605 |Global loss: 5.804| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9723
Epoch: 1|  Loss:  1.5909 |Global loss: 5.7963| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9836
Epoch: 2|  Loss:  1.5896 |Global loss: 5.7981| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9821
Epoch: 3|  Loss:  1.5651 |Global loss: 5.795| Local H loss: 0.0371  | Global H loss: 0.0371
------------------------- time cost ------------------------- 3.111497402191162
Chosen Clients:  [13, 11, 12, 7, 1, 0]

-------------Round number: 304-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.792, 0.858, 0.892, 0.833, 0.8, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.492, 0.783, 0.942]
AUC in each clients:  [115.8, 118.078, 116.51, 117.534, 118.043, 116.82, 116.75, 117.919, 118.516, 118.448, 116.937, 118.38, 113.355, 114.152, 118.139]
F1 Score:  [0.737, 0.776, 0.867, 0.851, 0.761, 0.772, 0.806, 0.971, 0.961, 0.981, 0.832, 0.97, 0.513, 0.756, 0.935]
Recall Score:  [0.789, 0.808, 0.887, 0.882, 0.81, 0.785, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.574, 0.81, 0.949]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4066
Averaged Test Accurancy: 0.8444
Averaged Test AUC: 0.9752
Averaged Test F1_score: 0.8326
Averaged Test Recal score: 0.8613
Std Test Accurancy: 0.1230
Std Test AUC: 0.0126
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9539
Epoch: 0|  Loss:  1.5516 |Global loss: 5.8088| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9637
Epoch: 1|  Loss:  1.5477 |Global loss: 5.8062| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9649
Epoch: 2|  Loss:  1.5561 |Global loss: 5.805| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9735
Epoch: 3|  Loss:  1.5665 |Global loss: 5.8016| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9234
Epoch: 0|  Loss:  1.194 |Global loss: 5.7522| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.9085
Epoch: 1|  Loss:  1.1803 |Global loss: 5.7626| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.9214
Epoch: 2|  Loss:  1.1921 |Global loss: 5.7515| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1633 |Global loss: 5.766| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 1.0834
Epoch: 0|  Loss:  2.0119 |Global loss: 5.8642| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 1.0655
Epoch: 1|  Loss:  1.9895 |Global loss: 5.8803| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 1.0559
Epoch: 2|  Loss:  1.9726 |Global loss: 5.8799| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 1.0422
Epoch: 3|  Loss:  1.9479 |Global loss: 5.8922| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9376
Epoch: 0|  Loss:  1.305 |Global loss: 5.8083| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 1|  NKD Loss: 0.9567
Epoch: 1|  Loss:  1.3192 |Global loss: 5.7943| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.9557
Epoch: 2|  Loss:  1.3197 |Global loss: 5.7937| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 3|  NKD Loss: 0.9536
Epoch: 3|  Loss:  1.3032 |Global loss: 5.794| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 1.0051
Epoch: 0|  Loss:  1.4849 |Global loss: 5.8253| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9761
Epoch: 1|  Loss:  1.4703 |Global loss: 5.8429| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.982
Epoch: 2|  Loss:  1.4617 |Global loss: 5.8296| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9679
Epoch: 3|  Loss:  1.4489 |Global loss: 5.8303| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9628
Epoch: 0|  Loss:  1.4741 |Global loss: 5.7853| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.9737
Epoch: 1|  Loss:  1.4939 |Global loss: 5.7789| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9736
Epoch: 2|  Loss:  1.4885 |Global loss: 5.7768| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.9456
Epoch: 3|  Loss:  1.4531 |Global loss: 5.7888| Local H loss: 0.026  | Global H loss: 0.026
------------------------- time cost ------------------------- 3.2063076496124268
Chosen Clients:  [10, 8, 7, 0, 13, 3]

-------------Round number: 305-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.783, 0.858, 0.892, 0.833, 0.8, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.942]
AUC in each clients:  [115.805, 118.033, 116.51, 117.534, 118.043, 116.82, 116.75, 117.963, 118.516, 118.448, 116.937, 118.307, 113.935, 114.149, 118.139]
F1 Score:  [0.729, 0.756, 0.867, 0.851, 0.761, 0.772, 0.806, 0.971, 0.961, 0.981, 0.832, 0.97, 0.566, 0.756, 0.935]
Recall Score:  [0.779, 0.81, 0.887, 0.882, 0.81, 0.785, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.623, 0.81, 0.949]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.4021
Averaged Test Accurancy: 0.8472
Averaged Test AUC: 0.9755
Averaged Test F1_score: 0.8343
Averaged Test Recal score: 0.8641
Std Test Accurancy: 0.1131
Std Test AUC: 0.0118
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.956
Epoch: 0|  Loss:  1.2958 |Global loss: 5.7891| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9593
Epoch: 1|  Loss:  1.3001 |Global loss: 5.7876| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.9308
Epoch: 2|  Loss:  1.2687 |Global loss: 5.8063| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9477
Epoch: 3|  Loss:  1.2798 |Global loss: 5.7904| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.9481
Epoch: 0|  Loss:  1.2452 |Global loss: 5.7705| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.9534
Epoch: 1|  Loss:  1.2491 |Global loss: 5.7642| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9351
Epoch: 2|  Loss:  1.2365 |Global loss: 5.7819| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9399
Epoch: 3|  Loss:  1.2438 |Global loss: 5.7779| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 0|  NKD Loss: 0.9311
Epoch: 0|  Loss:  1.2918 |Global loss: 5.8116| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.9284
Epoch: 1|  Loss:  1.2884 |Global loss: 5.8103| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.9396
Epoch: 2|  Loss:  1.2899 |Global loss: 5.8013| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.9588
Epoch: 3|  Loss:  1.3113 |Global loss: 5.7904| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 0|  NKD Loss: 0.9758
Epoch: 0|  Loss:  1.4768 |Global loss: 5.7738| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.965
Epoch: 1|  Loss:  1.4637 |Global loss: 5.7798| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9794
Epoch: 2|  Loss:  1.479 |Global loss: 5.7676| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.9738
Epoch: 3|  Loss:  1.4691 |Global loss: 5.7731| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.9846
Epoch: 0|  Loss:  1.5833 |Global loss: 5.794| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9679
Epoch: 1|  Loss:  1.5594 |Global loss: 5.7984| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9697
Epoch: 2|  Loss:  1.5614 |Global loss: 5.7965| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9629
Epoch: 3|  Loss:  1.5609 |Global loss: 5.7997| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9436
Epoch: 0|  Loss:  1.3342 |Global loss: 5.7751| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9377
Epoch: 1|  Loss:  1.3329 |Global loss: 5.7731| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.9091
Epoch: 2|  Loss:  1.2976 |Global loss: 5.7926| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.9515
Epoch: 3|  Loss:  1.329 |Global loss: 5.7621| Local H loss: 0.0421  | Global H loss: 0.0421
------------------------- time cost ------------------------- 3.083047866821289
Chosen Clients:  [8, 11, 0, 5, 9, 14]

-------------Round number: 306-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.725, 0.783, 0.858, 0.892, 0.833, 0.8, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.942]
AUC in each clients:  [115.833, 118.033, 116.51, 117.555, 118.043, 116.82, 116.75, 118.31, 118.569, 118.448, 117.027, 118.307, 113.935, 114.256, 118.139]
F1 Score:  [0.729, 0.756, 0.867, 0.851, 0.761, 0.772, 0.806, 0.971, 0.961, 0.981, 0.832, 0.97, 0.566, 0.756, 0.935]
Recall Score:  [0.779, 0.81, 0.887, 0.882, 0.81, 0.785, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.623, 0.81, 0.949]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3972
Averaged Test Accurancy: 0.8472
Averaged Test AUC: 0.9759
Averaged Test F1_score: 0.8343
Averaged Test Recal score: 0.8641
Std Test Accurancy: 0.1131
Std Test AUC: 0.0118
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9028
Epoch: 0|  Loss:  1.2088 |Global loss: 5.8015| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9562
Epoch: 1|  Loss:  1.2548 |Global loss: 5.7662| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.933
Epoch: 2|  Loss:  1.2295 |Global loss: 5.7812| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.9339
Epoch: 3|  Loss:  1.2345 |Global loss: 5.7839| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.9119
Epoch: 0|  Loss:  1.1773 |Global loss: 5.7526| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.9163
Epoch: 1|  Loss:  1.1832 |Global loss: 5.756| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.8994
Epoch: 2|  Loss:  1.1538 |Global loss: 5.7641| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.922
Epoch: 3|  Loss:  1.1895 |Global loss: 5.7527| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9572
Epoch: 0|  Loss:  1.4681 |Global loss: 5.7878| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.9555
Epoch: 1|  Loss:  1.4617 |Global loss: 5.7831| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.9659
Epoch: 2|  Loss:  1.4585 |Global loss: 5.7786| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9878
Epoch: 3|  Loss:  1.4883 |Global loss: 5.7584| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 1.0212
Epoch: 0|  Loss:  1.5422 |Global loss: 5.8085| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9674
Epoch: 1|  Loss:  1.4921 |Global loss: 5.8337| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 1.0159
Epoch: 2|  Loss:  1.5345 |Global loss: 5.8159| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0065
Epoch: 3|  Loss:  1.5302 |Global loss: 5.8147| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9327
Epoch: 0|  Loss:  1.2109 |Global loss: 5.7469| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9156
Epoch: 1|  Loss:  1.178 |Global loss: 5.7577| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9104
Epoch: 2|  Loss:  1.1836 |Global loss: 5.766| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9332
Epoch: 3|  Loss:  1.1741 |Global loss: 5.7495| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.9495
Epoch: 0|  Loss:  1.2639 |Global loss: 5.776| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.9108
Epoch: 1|  Loss:  1.2247 |Global loss: 5.7956| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.9237
Epoch: 2|  Loss:  1.2396 |Global loss: 5.79| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.922
Epoch: 3|  Loss:  1.2382 |Global loss: 5.7935| Local H loss: 0.0296  | Global H loss: 0.0296
------------------------- time cost ------------------------- 2.9007742404937744
Chosen Clients:  [8, 1, 10, 6, 4, 5]

-------------Round number: 307-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.783, 0.858, 0.892, 0.833, 0.783, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.95]
AUC in each clients:  [115.912, 118.033, 116.51, 117.555, 118.043, 116.81, 116.75, 118.31, 118.583, 118.46, 117.027, 118.322, 113.935, 114.256, 118.145]
F1 Score:  [0.736, 0.756, 0.867, 0.851, 0.761, 0.733, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.566, 0.756, 0.944]
Recall Score:  [0.789, 0.81, 0.887, 0.882, 0.81, 0.763, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3928
Averaged Test Accurancy: 0.8472
Averaged Test AUC: 0.9759
Averaged Test F1_score: 0.8328
Averaged Test Recal score: 0.8637
Std Test Accurancy: 0.1136
Std Test AUC: 0.0118
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9404
Epoch: 0|  Loss:  1.2366 |Global loss: 5.7763| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.2172 |Global loss: 5.7877| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9442
Epoch: 2|  Loss:  1.2414 |Global loss: 5.7672| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9172
Epoch: 3|  Loss:  1.2138 |Global loss: 5.7888| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9701
Epoch: 0|  Loss:  1.4542 |Global loss: 5.8302| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9977
Epoch: 1|  Loss:  1.4679 |Global loss: 5.8214| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 1.0103
Epoch: 2|  Loss:  1.4903 |Global loss: 5.8141| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9851
Epoch: 3|  Loss:  1.4525 |Global loss: 5.8381| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9423
Epoch: 0|  Loss:  1.282 |Global loss: 5.7993| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9515
Epoch: 1|  Loss:  1.2893 |Global loss: 5.7913| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.9477
Epoch: 2|  Loss:  1.279 |Global loss: 5.7899| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.9334
Epoch: 3|  Loss:  1.2703 |Global loss: 5.7974| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9783
Epoch: 0|  Loss:  1.4057 |Global loss: 5.7874| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9619
Epoch: 1|  Loss:  1.3856 |Global loss: 5.788| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.9561
Epoch: 2|  Loss:  1.3777 |Global loss: 5.799| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9689
Epoch: 3|  Loss:  1.3838 |Global loss: 5.7911| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.4144 |Global loss: 5.7442| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9283
Epoch: 1|  Loss:  1.3991 |Global loss: 5.7486| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9458
Epoch: 2|  Loss:  1.4187 |Global loss: 5.7303| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9389
Epoch: 3|  Loss:  1.4004 |Global loss: 5.7327| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.9977
Epoch: 0|  Loss:  1.5071 |Global loss: 5.8207| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9974
Epoch: 1|  Loss:  1.5097 |Global loss: 5.8222| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0031
Epoch: 2|  Loss:  1.5074 |Global loss: 5.8149| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0033
Epoch: 3|  Loss:  1.5074 |Global loss: 5.8151| Local H loss: 0.0268  | Global H loss: 0.0268
------------------------- time cost ------------------------- 2.738217353820801
Chosen Clients:  [1, 10, 9, 5, 8, 11]

-------------Round number: 308-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.825, 0.858, 0.892, 0.833, 0.808, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.95]
AUC in each clients:  [115.912, 117.928, 116.51, 117.555, 118.045, 116.879, 116.765, 118.31, 118.599, 118.46, 117.051, 118.322, 113.935, 114.256, 118.145]
F1 Score:  [0.736, 0.763, 0.867, 0.851, 0.761, 0.778, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.566, 0.756, 0.944]
Recall Score:  [0.789, 0.808, 0.887, 0.882, 0.81, 0.794, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3917
Averaged Test Accurancy: 0.8517
Averaged Test AUC: 0.9759
Averaged Test F1_score: 0.8363
Averaged Test Recal score: 0.8657
Std Test Accurancy: 0.1117
Std Test AUC: 0.0118
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9868
Epoch: 0|  Loss:  1.4621 |Global loss: 5.8278| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9946
Epoch: 1|  Loss:  1.4602 |Global loss: 5.8192| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9798
Epoch: 2|  Loss:  1.4538 |Global loss: 5.8306| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.987
Epoch: 3|  Loss:  1.4403 |Global loss: 5.8304| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9377
Epoch: 0|  Loss:  1.2684 |Global loss: 5.7956| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9495
Epoch: 1|  Loss:  1.2811 |Global loss: 5.785| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.9409
Epoch: 2|  Loss:  1.2713 |Global loss: 5.7945| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.932
Epoch: 3|  Loss:  1.2595 |Global loss: 5.7971| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9128
Epoch: 0|  Loss:  1.1734 |Global loss: 5.7561| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9206
Epoch: 1|  Loss:  1.1852 |Global loss: 5.7565| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.9212
Epoch: 2|  Loss:  1.1912 |Global loss: 5.7595| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.8994
Epoch: 3|  Loss:  1.1501 |Global loss: 5.7686| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.006
Epoch: 0|  Loss:  1.5243 |Global loss: 5.821| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 1.0183
Epoch: 1|  Loss:  1.5301 |Global loss: 5.8095| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0164
Epoch: 2|  Loss:  1.5275 |Global loss: 5.8061| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 1.0138
Epoch: 3|  Loss:  1.5165 |Global loss: 5.8013| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9397
Epoch: 0|  Loss:  1.2331 |Global loss: 5.7743| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9301
Epoch: 1|  Loss:  1.2229 |Global loss: 5.78| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9221
Epoch: 2|  Loss:  1.2058 |Global loss: 5.7823| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9216
Epoch: 3|  Loss:  1.2183 |Global loss: 5.7839| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.8955
Epoch: 0|  Loss:  1.1596 |Global loss: 5.7613| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.8884
Epoch: 1|  Loss:  1.1527 |Global loss: 5.7757| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9209
Epoch: 2|  Loss:  1.1847 |Global loss: 5.7513| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9262
Epoch: 3|  Loss:  1.1887 |Global loss: 5.7462| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 3.263946533203125
Chosen Clients:  [2, 4, 3, 6, 0, 11]

-------------Round number: 309-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.858, 0.892, 0.833, 0.858, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.95]
AUC in each clients:  [115.912, 118.236, 116.51, 117.555, 118.045, 116.958, 116.765, 118.31, 118.596, 118.488, 117.079, 118.361, 113.935, 114.256, 118.145]
F1 Score:  [0.736, 0.831, 0.867, 0.851, 0.761, 0.841, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.566, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.887, 0.882, 0.81, 0.856, 0.847, 0.977, 0.968, 0.984, 0.873, 0.977, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3842
Averaged Test Accurancy: 0.8572
Averaged Test AUC: 0.9762
Averaged Test F1_score: 0.8450
Averaged Test Recal score: 0.8733
Std Test Accurancy: 0.1108
Std Test AUC: 0.0119
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9888
Epoch: 0|  Loss:  1.4196 |Global loss: 5.8342| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9822
Epoch: 1|  Loss:  1.4038 |Global loss: 5.8313| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9976
Epoch: 2|  Loss:  1.4641 |Global loss: 5.8442| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.4154 |Global loss: 5.833| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9152
Epoch: 0|  Loss:  1.3859 |Global loss: 5.7477| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.9115
Epoch: 1|  Loss:  1.3832 |Global loss: 5.7606| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9076
Epoch: 2|  Loss:  1.3787 |Global loss: 5.759| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.9198
Epoch: 3|  Loss:  1.3956 |Global loss: 5.7516| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.9492
Epoch: 0|  Loss:  1.3326 |Global loss: 5.7671| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.9176
Epoch: 1|  Loss:  1.3021 |Global loss: 5.7855| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.9417
Epoch: 2|  Loss:  1.3252 |Global loss: 5.7725| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.9327
Epoch: 3|  Loss:  1.3138 |Global loss: 5.7731| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.9651
Epoch: 0|  Loss:  1.3897 |Global loss: 5.7967| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.9548
Epoch: 1|  Loss:  1.3687 |Global loss: 5.7931| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.9522
Epoch: 2|  Loss:  1.3657 |Global loss: 5.7986| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9564
Epoch: 3|  Loss:  1.3659 |Global loss: 5.7912| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.9659
Epoch: 0|  Loss:  1.4688 |Global loss: 5.7829| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9454
Epoch: 1|  Loss:  1.4413 |Global loss: 5.793| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9554
Epoch: 2|  Loss:  1.456 |Global loss: 5.7848| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.9293
Epoch: 3|  Loss:  1.4232 |Global loss: 5.7999| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.9254
Epoch: 0|  Loss:  1.1879 |Global loss: 5.7474| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9305
Epoch: 1|  Loss:  1.1941 |Global loss: 5.7422| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9249
Epoch: 2|  Loss:  1.1877 |Global loss: 5.746| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.908
Epoch: 3|  Loss:  1.1584 |Global loss: 5.7553| Local H loss: 0.0282  | Global H loss: 0.0282
------------------------- time cost ------------------------- 2.7692713737487793
Chosen Clients:  [2, 8, 13, 4, 7, 9]

-------------Round number: 310-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.858, 0.833, 0.967, 0.842, 0.858, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.95]
AUC in each clients:  [115.965, 118.236, 116.614, 117.67, 118.041, 116.958, 116.836, 118.31, 118.596, 118.488, 117.079, 118.319, 113.935, 114.256, 118.145]
F1 Score:  [0.742, 0.831, 0.842, 0.96, 0.766, 0.841, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.566, 0.756, 0.944]
Recall Score:  [0.798, 0.86, 0.861, 0.965, 0.817, 0.856, 0.847, 0.977, 0.968, 0.984, 0.873, 0.978, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3783
Averaged Test Accurancy: 0.8617
Averaged Test AUC: 0.9764
Averaged Test F1_score: 0.8513
Averaged Test Recal score: 0.8782
Std Test Accurancy: 0.1134
Std Test AUC: 0.0119
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9736
Epoch: 0|  Loss:  1.3883 |Global loss: 5.8342| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9972
Epoch: 1|  Loss:  1.4398 |Global loss: 5.8293| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 1.0004
Epoch: 2|  Loss:  1.4196 |Global loss: 5.8189| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.958
Epoch: 3|  Loss:  1.3707 |Global loss: 5.8509| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9178
Epoch: 0|  Loss:  1.1991 |Global loss: 5.79| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9388
Epoch: 1|  Loss:  1.2309 |Global loss: 5.7743| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9352
Epoch: 2|  Loss:  1.2298 |Global loss: 5.7703| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9037
Epoch: 3|  Loss:  1.193 |Global loss: 5.7881| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.973
Epoch: 0|  Loss:  1.5511 |Global loss: 5.7938| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.976
Epoch: 1|  Loss:  1.544 |Global loss: 5.7955| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9592
Epoch: 2|  Loss:  1.5452 |Global loss: 5.7984| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9806
Epoch: 3|  Loss:  1.5565 |Global loss: 5.7913| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9322
Epoch: 0|  Loss:  1.4071 |Global loss: 5.7446| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.9225
Epoch: 1|  Loss:  1.4012 |Global loss: 5.7507| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.9226
Epoch: 2|  Loss:  1.3976 |Global loss: 5.7444| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 0.9207
Epoch: 3|  Loss:  1.392 |Global loss: 5.7458| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.9617
Epoch: 0|  Loss:  1.3124 |Global loss: 5.7852| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 1|  NKD Loss: 0.9605
Epoch: 1|  Loss:  1.3072 |Global loss: 5.789| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 2|  NKD Loss: 0.9411
Epoch: 2|  Loss:  1.2843 |Global loss: 5.7912| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 0.9293
Epoch: 3|  Loss:  1.2726 |Global loss: 5.8046| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.8953
Epoch: 0|  Loss:  1.1485 |Global loss: 5.7762| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.8972
Epoch: 1|  Loss:  1.1687 |Global loss: 5.764| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9136
Epoch: 2|  Loss:  1.1803 |Global loss: 5.7593| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.8974
Epoch: 3|  Loss:  1.167 |Global loss: 5.7654| Local H loss: 0.0309  | Global H loss: 0.0309
------------------------- time cost ------------------------- 3.319307327270508
Chosen Clients:  [3, 2, 8, 0, 11, 9]

-------------Round number: 311-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.858, 0.842, 0.967, 0.842, 0.858, 0.808, 0.975, 0.967, 0.983, 0.833, 0.975, 0.55, 0.783, 0.95]
AUC in each clients:  [115.965, 118.236, 116.662, 117.67, 118.053, 116.958, 116.836, 118.402, 118.608, 118.538, 117.079, 118.319, 113.935, 114.132, 118.145]
F1 Score:  [0.742, 0.831, 0.845, 0.96, 0.766, 0.841, 0.806, 0.971, 0.961, 0.981, 0.832, 0.971, 0.566, 0.756, 0.944]
Recall Score:  [0.798, 0.86, 0.869, 0.965, 0.817, 0.856, 0.847, 0.977, 0.968, 0.984, 0.873, 0.978, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3881
Averaged Test Accurancy: 0.8622
Averaged Test AUC: 0.9764
Averaged Test F1_score: 0.8515
Averaged Test Recal score: 0.8787
Std Test Accurancy: 0.1133
Std Test AUC: 0.0121
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9342
Epoch: 0|  Loss:  1.3142 |Global loss: 5.7791| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9395
Epoch: 1|  Loss:  1.3177 |Global loss: 5.7694| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9261
Epoch: 2|  Loss:  1.3012 |Global loss: 5.7736| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9495
Epoch: 3|  Loss:  1.3209 |Global loss: 5.7606| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 0|  NKD Loss: 0.9809
Epoch: 0|  Loss:  1.378 |Global loss: 5.8212| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9872
Epoch: 1|  Loss:  1.3864 |Global loss: 5.8213| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9769
Epoch: 2|  Loss:  1.3769 |Global loss: 5.8325| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9899
Epoch: 3|  Loss:  1.4154 |Global loss: 5.8358| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9218
Epoch: 0|  Loss:  1.2119 |Global loss: 5.7773| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9285
Epoch: 1|  Loss:  1.2175 |Global loss: 5.7736| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9488
Epoch: 2|  Loss:  1.2362 |Global loss: 5.7666| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9335
Epoch: 3|  Loss:  1.2188 |Global loss: 5.7691| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9531
Epoch: 0|  Loss:  1.4509 |Global loss: 5.7874| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.954
Epoch: 1|  Loss:  1.4436 |Global loss: 5.7829| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9511
Epoch: 2|  Loss:  1.4446 |Global loss: 5.7855| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.9795
Epoch: 3|  Loss:  1.4619 |Global loss: 5.7649| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.9139
Epoch: 0|  Loss:  1.178 |Global loss: 5.7524| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9126
Epoch: 1|  Loss:  1.1759 |Global loss: 5.7523| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.8814
Epoch: 2|  Loss:  1.1397 |Global loss: 5.7703| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.8953
Epoch: 3|  Loss:  1.1555 |Global loss: 5.7615| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9264
Epoch: 0|  Loss:  1.1934 |Global loss: 5.7434| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.906
Epoch: 1|  Loss:  1.1752 |Global loss: 5.7595| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9123
Epoch: 2|  Loss:  1.1803 |Global loss: 5.7556| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.8965
Epoch: 3|  Loss:  1.1636 |Global loss: 5.7622| Local H loss: 0.0309  | Global H loss: 0.0309
------------------------- time cost ------------------------- 3.3582820892333984
Chosen Clients:  [13, 6, 8, 3, 12, 11]

-------------Round number: 312-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.842, 0.858, 0.808, 0.975, 0.967, 0.983, 0.833, 0.983, 0.55, 0.783, 0.95]
AUC in each clients:  [115.95, 118.236, 116.657, 117.648, 118.053, 116.958, 116.836, 118.402, 118.665, 118.533, 117.079, 118.468, 113.935, 114.132, 118.145]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.766, 0.841, 0.806, 0.971, 0.961, 0.981, 0.832, 0.98, 0.566, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.817, 0.856, 0.847, 0.977, 0.968, 0.984, 0.873, 0.984, 0.623, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3843
Averaged Test Accurancy: 0.8628
Averaged Test AUC: 0.9765
Averaged Test F1_score: 0.8525
Averaged Test Recal score: 0.8793
Std Test Accurancy: 0.1150
Std Test AUC: 0.0122
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9353
Epoch: 0|  Loss:  1.5331 |Global loss: 5.8094| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9697
Epoch: 1|  Loss:  1.5272 |Global loss: 5.8007| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9727
Epoch: 2|  Loss:  1.5615 |Global loss: 5.7885| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9546
Epoch: 3|  Loss:  1.5337 |Global loss: 5.7988| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9847
Epoch: 0|  Loss:  1.3978 |Global loss: 5.7842| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.9483
Epoch: 1|  Loss:  1.3672 |Global loss: 5.7904| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.9686
Epoch: 2|  Loss:  1.3814 |Global loss: 5.787| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9538
Epoch: 3|  Loss:  1.3677 |Global loss: 5.7963| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9344
Epoch: 0|  Loss:  1.2219 |Global loss: 5.7703| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9095
Epoch: 1|  Loss:  1.1976 |Global loss: 5.7914| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9202
Epoch: 2|  Loss:  1.205 |Global loss: 5.781| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9261
Epoch: 3|  Loss:  1.2112 |Global loss: 5.7788| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9356
Epoch: 0|  Loss:  1.3094 |Global loss: 5.7683| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9086
Epoch: 1|  Loss:  1.2722 |Global loss: 5.7828| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 2|  NKD Loss: 0.9257
Epoch: 2|  Loss:  1.2908 |Global loss: 5.7753| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9138
Epoch: 3|  Loss:  1.2829 |Global loss: 5.7832| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 0|  NKD Loss: 1.0537
Epoch: 0|  Loss:  1.9815 |Global loss: 5.8881| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 1.0691
Epoch: 1|  Loss:  1.9749 |Global loss: 5.8698| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 1.0665
Epoch: 2|  Loss:  1.9753 |Global loss: 5.871| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 1.0743
Epoch: 3|  Loss:  1.9808 |Global loss: 5.8618| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.8954
Epoch: 0|  Loss:  1.1383 |Global loss: 5.759| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9197
Epoch: 1|  Loss:  1.1676 |Global loss: 5.7503| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.9259
Epoch: 2|  Loss:  1.187 |Global loss: 5.7452| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9197
Epoch: 3|  Loss:  1.1788 |Global loss: 5.7521| Local H loss: 0.028  | Global H loss: 0.028
------------------------- time cost ------------------------- 3.0523815155029297
Chosen Clients:  [8, 12, 3, 10, 11, 6]

-------------Round number: 313-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.842, 0.858, 0.817, 0.975, 0.967, 0.983, 0.833, 0.983, 0.483, 0.783, 0.95]
AUC in each clients:  [115.95, 118.236, 116.657, 117.846, 118.053, 116.958, 116.784, 118.402, 118.636, 118.533, 117.079, 118.458, 113.145, 114.253, 118.145]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.766, 0.841, 0.815, 0.971, 0.961, 0.981, 0.832, 0.98, 0.5, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.817, 0.856, 0.856, 0.977, 0.968, 0.984, 0.873, 0.984, 0.567, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3849
Averaged Test Accurancy: 0.8589
Averaged Test AUC: 0.9762
Averaged Test F1_score: 0.8487
Averaged Test Recal score: 0.8761
Std Test Accurancy: 0.1274
Std Test AUC: 0.0131
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9267
Epoch: 0|  Loss:  1.2124 |Global loss: 5.7683| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.918
Epoch: 1|  Loss:  1.1923 |Global loss: 5.7752| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9238
Epoch: 2|  Loss:  1.1967 |Global loss: 5.7702| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9264
Epoch: 3|  Loss:  1.2089 |Global loss: 5.7698| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 1.0548
Epoch: 0|  Loss:  1.9528 |Global loss: 5.8701| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 1.0756
Epoch: 1|  Loss:  1.9728 |Global loss: 5.8636| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 1.062
Epoch: 2|  Loss:  1.9426 |Global loss: 5.8755| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 1.0516
Epoch: 3|  Loss:  1.9467 |Global loss: 5.8759| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9331
Epoch: 0|  Loss:  1.2897 |Global loss: 5.7625| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 1|  NKD Loss: 0.9219
Epoch: 1|  Loss:  1.2858 |Global loss: 5.772| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.9313
Epoch: 2|  Loss:  1.2932 |Global loss: 5.763| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 3|  NKD Loss: 0.9382
Epoch: 3|  Loss:  1.2989 |Global loss: 5.7568| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 0|  NKD Loss: 0.9386
Epoch: 0|  Loss:  1.2662 |Global loss: 5.7937| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.944
Epoch: 1|  Loss:  1.2743 |Global loss: 5.7941| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.9541
Epoch: 2|  Loss:  1.2795 |Global loss: 5.781| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9463
Epoch: 3|  Loss:  1.2664 |Global loss: 5.7783| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9277
Epoch: 0|  Loss:  1.1872 |Global loss: 5.7386| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9081
Epoch: 1|  Loss:  1.1659 |Global loss: 5.7618| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.926
Epoch: 2|  Loss:  1.1911 |Global loss: 5.7448| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.919
Epoch: 3|  Loss:  1.1737 |Global loss: 5.7473| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9542
Epoch: 0|  Loss:  1.3653 |Global loss: 5.797| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9454
Epoch: 1|  Loss:  1.3525 |Global loss: 5.7981| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9684
Epoch: 2|  Loss:  1.3762 |Global loss: 5.7854| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9678
Epoch: 3|  Loss:  1.372 |Global loss: 5.7868| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 3.16239595413208
Chosen Clients:  [11, 4, 8, 13, 14, 12]

-------------Round number: 314-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.842, 0.858, 0.808, 0.975, 0.967, 0.983, 0.842, 0.975, 0.5, 0.783, 0.95]
AUC in each clients:  [115.95, 118.236, 116.657, 117.881, 118.053, 116.958, 116.856, 118.402, 118.698, 118.533, 117.097, 118.554, 113.799, 114.253, 118.145]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.766, 0.841, 0.806, 0.971, 0.961, 0.981, 0.844, 0.97, 0.516, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.817, 0.856, 0.847, 0.977, 0.968, 0.984, 0.878, 0.977, 0.581, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3810
Averaged Test Accurancy: 0.8594
Averaged Test AUC: 0.9767
Averaged Test F1_score: 0.8493
Averaged Test Recal score: 0.8763
Std Test Accurancy: 0.1237
Std Test AUC: 0.0123
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.1772 |Global loss: 5.7498| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9184
Epoch: 1|  Loss:  1.1785 |Global loss: 5.7471| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9181
Epoch: 2|  Loss:  1.1776 |Global loss: 5.7485| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.915
Epoch: 3|  Loss:  1.1599 |Global loss: 5.7464| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9449
Epoch: 0|  Loss:  1.4148 |Global loss: 5.7325| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9332
Epoch: 1|  Loss:  1.3933 |Global loss: 5.7392| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.922
Epoch: 2|  Loss:  1.3798 |Global loss: 5.7441| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.9393
Epoch: 3|  Loss:  1.4057 |Global loss: 5.7313| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.9273
Epoch: 0|  Loss:  1.2072 |Global loss: 5.774| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9074
Epoch: 1|  Loss:  1.1878 |Global loss: 5.7774| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9249
Epoch: 2|  Loss:  1.2047 |Global loss: 5.7739| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9166
Epoch: 3|  Loss:  1.1976 |Global loss: 5.7765| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9654
Epoch: 0|  Loss:  1.5412 |Global loss: 5.7947| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.966
Epoch: 1|  Loss:  1.5557 |Global loss: 5.7923| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9772
Epoch: 2|  Loss:  1.5527 |Global loss: 5.7896| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9738
Epoch: 3|  Loss:  1.5416 |Global loss: 5.7844| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9185
Epoch: 0|  Loss:  1.229 |Global loss: 5.7873| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.9435
Epoch: 1|  Loss:  1.2543 |Global loss: 5.7737| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.951
Epoch: 2|  Loss:  1.2534 |Global loss: 5.777| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9056
Epoch: 3|  Loss:  1.208 |Global loss: 5.8003| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 0|  NKD Loss: 1.0745
Epoch: 0|  Loss:  1.9548 |Global loss: 5.8542| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 1.0742
Epoch: 1|  Loss:  1.975 |Global loss: 5.8691| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 1.0682
Epoch: 2|  Loss:  1.9469 |Global loss: 5.8598| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 1.0463
Epoch: 3|  Loss:  1.9483 |Global loss: 5.8846| Local H loss: 0.0361  | Global H loss: 0.0361
------------------------- time cost ------------------------- 2.956784725189209
Chosen Clients:  [11, 9, 4, 10, 6, 8]

-------------Round number: 315-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.833, 0.858, 0.808, 0.975, 0.967, 0.983, 0.842, 0.983, 0.542, 0.783, 0.917]
AUC in each clients:  [115.95, 118.236, 116.657, 117.881, 118.057, 116.958, 116.856, 118.402, 118.729, 118.533, 117.097, 118.704, 114.214, 114.216, 118.102]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.761, 0.841, 0.806, 0.971, 0.961, 0.981, 0.844, 0.98, 0.56, 0.756, 0.907]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.81, 0.856, 0.847, 0.977, 0.968, 0.984, 0.878, 0.984, 0.616, 0.81, 0.928]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3818
Averaged Test Accurancy: 0.8600
Averaged Test AUC: 0.9770
Averaged Test F1_score: 0.8501
Averaged Test Recal score: 0.8768
Std Test Accurancy: 0.1151
Std Test AUC: 0.0119
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9208
Epoch: 0|  Loss:  1.1759 |Global loss: 5.7487| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9057
Epoch: 1|  Loss:  1.1614 |Global loss: 5.7524| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9052
Epoch: 2|  Loss:  1.1621 |Global loss: 5.7552| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.9045
Epoch: 3|  Loss:  1.1615 |Global loss: 5.7576| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9067
Epoch: 0|  Loss:  1.1725 |Global loss: 5.7574| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.927
Epoch: 1|  Loss:  1.1761 |Global loss: 5.7463| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9029
Epoch: 2|  Loss:  1.1649 |Global loss: 5.7547| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 3|  NKD Loss: 0.9108
Epoch: 3|  Loss:  1.1737 |Global loss: 5.7554| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.9362
Epoch: 0|  Loss:  1.3965 |Global loss: 5.7329| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.9295
Epoch: 1|  Loss:  1.4066 |Global loss: 5.744| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.9299
Epoch: 2|  Loss:  1.3957 |Global loss: 5.7422| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.9106
Epoch: 3|  Loss:  1.3672 |Global loss: 5.7483| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9498
Epoch: 0|  Loss:  1.2742 |Global loss: 5.7784| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.9361
Epoch: 1|  Loss:  1.2622 |Global loss: 5.7934| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9322
Epoch: 2|  Loss:  1.259 |Global loss: 5.7921| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.9498
Epoch: 3|  Loss:  1.2703 |Global loss: 5.7813| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.9727
Epoch: 0|  Loss:  1.3788 |Global loss: 5.782| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9683
Epoch: 1|  Loss:  1.3644 |Global loss: 5.7892| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9635
Epoch: 2|  Loss:  1.3699 |Global loss: 5.7823| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.968
Epoch: 3|  Loss:  1.3645 |Global loss: 5.7878| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9194
Epoch: 0|  Loss:  1.1987 |Global loss: 5.7734| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9271
Epoch: 1|  Loss:  1.2043 |Global loss: 5.7738| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.2049 |Global loss: 5.7696| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9302
Epoch: 3|  Loss:  1.2016 |Global loss: 5.764| Local H loss: 0.0371  | Global H loss: 0.0371
------------------------- time cost ------------------------- 3.19415283203125
Chosen Clients:  [14, 9, 5, 4, 13, 10]

-------------Round number: 316-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.842, 0.858, 0.808, 0.975, 0.967, 0.983, 0.908, 0.983, 0.542, 0.783, 0.917]
AUC in each clients:  [115.95, 118.236, 116.657, 117.881, 118.036, 116.958, 116.883, 118.402, 118.692, 118.583, 117.205, 118.644, 114.214, 114.216, 118.102]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.766, 0.841, 0.806, 0.971, 0.961, 0.981, 0.909, 0.98, 0.56, 0.756, 0.907]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.817, 0.856, 0.847, 0.977, 0.968, 0.984, 0.923, 0.984, 0.616, 0.81, 0.928]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3714
Averaged Test Accurancy: 0.8650
Averaged Test AUC: 0.9770
Averaged Test F1_score: 0.8547
Averaged Test Recal score: 0.8803
Std Test Accurancy: 0.1155
Std Test AUC: 0.0119
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.945
Epoch: 0|  Loss:  1.2491 |Global loss: 5.7691| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.9297
Epoch: 1|  Loss:  1.2359 |Global loss: 5.7789| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.9264
Epoch: 2|  Loss:  1.2331 |Global loss: 5.7804| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9386
Epoch: 3|  Loss:  1.2352 |Global loss: 5.7685| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9192
Epoch: 0|  Loss:  1.1823 |Global loss: 5.748| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.9317
Epoch: 1|  Loss:  1.1938 |Global loss: 5.737| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9312
Epoch: 2|  Loss:  1.1946 |Global loss: 5.7368| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9229
Epoch: 3|  Loss:  1.1869 |Global loss: 5.7405| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.9945
Epoch: 0|  Loss:  1.4889 |Global loss: 5.8139| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9891
Epoch: 1|  Loss:  1.5015 |Global loss: 5.8211| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.984
Epoch: 2|  Loss:  1.4791 |Global loss: 5.8281| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 1.006
Epoch: 3|  Loss:  1.5108 |Global loss: 5.8128| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9103
Epoch: 0|  Loss:  1.3853 |Global loss: 5.7557| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9219
Epoch: 1|  Loss:  1.3926 |Global loss: 5.7459| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.9359
Epoch: 2|  Loss:  1.3936 |Global loss: 5.7322| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.929
Epoch: 3|  Loss:  1.3953 |Global loss: 5.7305| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.9648
Epoch: 0|  Loss:  1.5369 |Global loss: 5.7927| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9548
Epoch: 1|  Loss:  1.5217 |Global loss: 5.8049| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9741
Epoch: 2|  Loss:  1.5523 |Global loss: 5.7882| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9597
Epoch: 3|  Loss:  1.5211 |Global loss: 5.7937| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9442
Epoch: 0|  Loss:  1.2666 |Global loss: 5.7871| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9354
Epoch: 1|  Loss:  1.2584 |Global loss: 5.7936| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9451
Epoch: 2|  Loss:  1.2693 |Global loss: 5.7832| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.9494
Epoch: 3|  Loss:  1.2716 |Global loss: 5.781| Local H loss: 0.0391  | Global H loss: 0.0391
------------------------- time cost ------------------------- 3.1189634799957275
Chosen Clients:  [7, 6, 12, 14, 9, 5]

-------------Round number: 317-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.833, 0.8, 0.808, 0.975, 0.967, 0.983, 0.908, 0.983, 0.542, 0.783, 0.95]
AUC in each clients:  [115.95, 118.236, 116.657, 117.881, 118.056, 116.72, 116.883, 118.402, 118.692, 118.596, 117.35, 118.644, 114.214, 114.238, 118.159]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.761, 0.76, 0.806, 0.971, 0.961, 0.981, 0.909, 0.98, 0.56, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.81, 0.778, 0.847, 0.977, 0.968, 0.984, 0.923, 0.984, 0.616, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3745
Averaged Test Accurancy: 0.8628
Averaged Test AUC: 0.9770
Averaged Test F1_score: 0.8515
Averaged Test Recal score: 0.8765
Std Test Accurancy: 0.1181
Std Test AUC: 0.0119
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9517
Epoch: 0|  Loss:  1.286 |Global loss: 5.7855| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.9578
Epoch: 1|  Loss:  1.2937 |Global loss: 5.7825| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 2|  NKD Loss: 0.9534
Epoch: 2|  Loss:  1.2914 |Global loss: 5.7802| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 3|  NKD Loss: 0.931
Epoch: 3|  Loss:  1.2583 |Global loss: 5.794| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 0|  NKD Loss: 0.957
Epoch: 0|  Loss:  1.3599 |Global loss: 5.783| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 1|  NKD Loss: 0.9776
Epoch: 1|  Loss:  1.3692 |Global loss: 5.7737| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9766
Epoch: 2|  Loss:  1.3665 |Global loss: 5.7731| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9556
Epoch: 3|  Loss:  1.3459 |Global loss: 5.7889| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 1.0433
Epoch: 0|  Loss:  1.9279 |Global loss: 5.8892| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 1.0747
Epoch: 1|  Loss:  1.9604 |Global loss: 5.8637| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 1.0566
Epoch: 2|  Loss:  1.9409 |Global loss: 5.8711| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 1.075
Epoch: 3|  Loss:  1.9589 |Global loss: 5.8677| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.944
Epoch: 0|  Loss:  1.2517 |Global loss: 5.7695| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.9405
Epoch: 1|  Loss:  1.2253 |Global loss: 5.771| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 2|  NKD Loss: 0.9324
Epoch: 2|  Loss:  1.2373 |Global loss: 5.7746| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.9374
Epoch: 3|  Loss:  1.2394 |Global loss: 5.7742| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 0|  NKD Loss: 0.9081
Epoch: 0|  Loss:  1.1677 |Global loss: 5.7478| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 1|  NKD Loss: 0.9232
Epoch: 1|  Loss:  1.183 |Global loss: 5.7393| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 2|  NKD Loss: 0.9132
Epoch: 2|  Loss:  1.1603 |Global loss: 5.7428| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9232
Epoch: 3|  Loss:  1.1796 |Global loss: 5.7444| Local H loss: 0.0308  | Global H loss: 0.0308
Epoch: 0|  NKD Loss: 0.9966
Epoch: 0|  Loss:  1.4945 |Global loss: 5.8126| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 1.0061
Epoch: 1|  Loss:  1.4964 |Global loss: 5.8033| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9943
Epoch: 2|  Loss:  1.4654 |Global loss: 5.8198| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9967
Epoch: 3|  Loss:  1.49 |Global loss: 5.811| Local H loss: 0.027  | Global H loss: 0.027
------------------------- time cost ------------------------- 2.8454749584198
Chosen Clients:  [6, 1, 10, 4, 3, 9]

-------------Round number: 318-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.858, 0.842, 0.975, 0.833, 0.808, 0.817, 0.975, 0.967, 0.983, 0.908, 0.983, 0.483, 0.783, 0.95]
AUC in each clients:  [115.95, 118.236, 116.657, 117.881, 118.056, 116.788, 116.898, 118.506, 118.692, 118.6, 117.35, 118.644, 113.444, 114.238, 118.195]
F1 Score:  [0.736, 0.831, 0.845, 0.971, 0.761, 0.77, 0.815, 0.971, 0.961, 0.981, 0.909, 0.98, 0.5, 0.756, 0.944]
Recall Score:  [0.789, 0.86, 0.869, 0.976, 0.81, 0.786, 0.856, 0.977, 0.968, 0.984, 0.923, 0.984, 0.567, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3719
Averaged Test Accurancy: 0.8600
Averaged Test AUC: 0.9767
Averaged Test F1_score: 0.8487
Averaged Test Recal score: 0.8743
Std Test Accurancy: 0.1286
Std Test AUC: 0.0130
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9704
Epoch: 0|  Loss:  1.3652 |Global loss: 5.7834| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9476
Epoch: 1|  Loss:  1.3432 |Global loss: 5.791| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9539
Epoch: 2|  Loss:  1.3303 |Global loss: 5.7857| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9581
Epoch: 3|  Loss:  1.3505 |Global loss: 5.7779| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 1.0057
Epoch: 0|  Loss:  1.4672 |Global loss: 5.8132| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9692
Epoch: 1|  Loss:  1.4355 |Global loss: 5.8391| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9849
Epoch: 2|  Loss:  1.4478 |Global loss: 5.8281| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9907
Epoch: 3|  Loss:  1.4468 |Global loss: 5.8215| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9345
Epoch: 0|  Loss:  1.2547 |Global loss: 5.7928| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.9442
Epoch: 1|  Loss:  1.262 |Global loss: 5.7819| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9287
Epoch: 2|  Loss:  1.2519 |Global loss: 5.7946| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9416
Epoch: 3|  Loss:  1.2629 |Global loss: 5.7847| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9382
Epoch: 0|  Loss:  1.3944 |Global loss: 5.7315| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9316
Epoch: 1|  Loss:  1.4004 |Global loss: 5.7378| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.9273
Epoch: 2|  Loss:  1.3844 |Global loss: 5.7395| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9357
Epoch: 3|  Loss:  1.4003 |Global loss: 5.7271| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 0.9316
Epoch: 0|  Loss:  1.2919 |Global loss: 5.7643| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9323
Epoch: 1|  Loss:  1.2893 |Global loss: 5.7603| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9272
Epoch: 2|  Loss:  1.283 |Global loss: 5.7632| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.936
Epoch: 3|  Loss:  1.2893 |Global loss: 5.7599| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.9201
Epoch: 0|  Loss:  1.1813 |Global loss: 5.7385| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.9139
Epoch: 1|  Loss:  1.1725 |Global loss: 5.7492| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 2|  NKD Loss: 0.9064
Epoch: 2|  Loss:  1.1612 |Global loss: 5.7523| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 3|  NKD Loss: 0.9184
Epoch: 3|  Loss:  1.176 |Global loss: 5.7402| Local H loss: 0.0306  | Global H loss: 0.0306
------------------------- time cost ------------------------- 2.9341838359832764
Chosen Clients:  [11, 10, 4, 3, 13, 5]

-------------Round number: 319-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.892, 0.842, 0.975, 0.833, 0.808, 0.817, 0.975, 0.967, 0.983, 0.917, 0.983, 0.483, 0.783, 0.95]
AUC in each clients:  [115.95, 118.264, 116.657, 117.808, 118.048, 116.788, 116.939, 118.506, 118.692, 118.661, 117.34, 118.644, 113.444, 114.238, 118.195]
F1 Score:  [0.736, 0.851, 0.845, 0.971, 0.761, 0.77, 0.815, 0.971, 0.961, 0.981, 0.916, 0.98, 0.5, 0.756, 0.944]
Recall Score:  [0.789, 0.882, 0.869, 0.976, 0.81, 0.786, 0.856, 0.977, 0.968, 0.984, 0.928, 0.984, 0.567, 0.81, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3716
Averaged Test Accurancy: 0.8628
Averaged Test AUC: 0.9768
Averaged Test F1_score: 0.8505
Averaged Test Recal score: 0.8761
Std Test Accurancy: 0.1291
Std Test AUC: 0.0130
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9182
Epoch: 0|  Loss:  1.1639 |Global loss: 5.7486| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9115
Epoch: 1|  Loss:  1.1496 |Global loss: 5.7526| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9115
Epoch: 2|  Loss:  1.1413 |Global loss: 5.746| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9225
Epoch: 3|  Loss:  1.1698 |Global loss: 5.741| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9257
Epoch: 0|  Loss:  1.2477 |Global loss: 5.7926| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.9446
Epoch: 1|  Loss:  1.2636 |Global loss: 5.7828| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9162
Epoch: 2|  Loss:  1.2332 |Global loss: 5.8023| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.9328
Epoch: 3|  Loss:  1.2486 |Global loss: 5.7857| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9283
Epoch: 0|  Loss:  1.391 |Global loss: 5.7433| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9111
Epoch: 1|  Loss:  1.3426 |Global loss: 5.7392| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.9233
Epoch: 2|  Loss:  1.3969 |Global loss: 5.7448| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9373
Epoch: 3|  Loss:  1.3992 |Global loss: 5.7296| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 0.9375
Epoch: 0|  Loss:  1.2947 |Global loss: 5.7578| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 1|  NKD Loss: 0.9377
Epoch: 1|  Loss:  1.2872 |Global loss: 5.7553| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.9252
Epoch: 2|  Loss:  1.2703 |Global loss: 5.7639| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.942
Epoch: 3|  Loss:  1.2964 |Global loss: 5.7489| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.9496
Epoch: 0|  Loss:  1.5014 |Global loss: 5.7934| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9626
Epoch: 1|  Loss:  1.5321 |Global loss: 5.7944| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.959
Epoch: 2|  Loss:  1.5133 |Global loss: 5.7967| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.976
Epoch: 3|  Loss:  1.5322 |Global loss: 5.7815| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.995
Epoch: 0|  Loss:  1.4843 |Global loss: 5.8153| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9903
Epoch: 1|  Loss:  1.4728 |Global loss: 5.8107| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9997
Epoch: 2|  Loss:  1.4848 |Global loss: 5.8112| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9811
Epoch: 3|  Loss:  1.4597 |Global loss: 5.8225| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 2.865659236907959
Chosen Clients:  [2, 0, 9, 11, 1, 10]

-------------Round number: 320-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.733, 0.892, 0.842, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.942, 0.975, 0.483, 0.792, 0.95]
AUC in each clients:  [115.95, 118.264, 116.657, 118.058, 118.045, 117.119, 116.939, 118.506, 118.692, 118.661, 117.453, 118.589, 113.444, 114.29, 118.195]
F1 Score:  [0.736, 0.851, 0.845, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.935, 0.97, 0.5, 0.775, 0.944]
Recall Score:  [0.789, 0.882, 0.869, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.945, 0.977, 0.567, 0.821, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3725
Averaged Test Accurancy: 0.8683
Averaged Test AUC: 0.9771
Averaged Test F1_score: 0.8574
Averaged Test Recal score: 0.8829
Std Test Accurancy: 0.1282
Std Test AUC: 0.0129
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9843
Epoch: 0|  Loss:  1.3929 |Global loss: 5.8181| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9822
Epoch: 1|  Loss:  1.3954 |Global loss: 5.8349| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9966
Epoch: 2|  Loss:  1.3977 |Global loss: 5.8097| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9829
Epoch: 3|  Loss:  1.394 |Global loss: 5.8275| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9617
Epoch: 0|  Loss:  1.4558 |Global loss: 5.7772| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.9706
Epoch: 1|  Loss:  1.4664 |Global loss: 5.7736| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9733
Epoch: 2|  Loss:  1.4658 |Global loss: 5.7741| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.9616
Epoch: 3|  Loss:  1.4517 |Global loss: 5.7763| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.9087
Epoch: 0|  Loss:  1.166 |Global loss: 5.7463| Local H loss: 0.0306  | Global H loss: 0.0306
Epoch: 1|  NKD Loss: 0.8927
Epoch: 1|  Loss:  1.1475 |Global loss: 5.7534| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9058
Epoch: 2|  Loss:  1.1562 |Global loss: 5.7448| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 3|  NKD Loss: 0.907
Epoch: 3|  Loss:  1.1628 |Global loss: 5.7463| Local H loss: 0.0304  | Global H loss: 0.0304
Epoch: 0|  NKD Loss: 0.9123
Epoch: 0|  Loss:  1.1584 |Global loss: 5.7485| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9261
Epoch: 1|  Loss:  1.1672 |Global loss: 5.7418| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9095
Epoch: 2|  Loss:  1.1572 |Global loss: 5.7496| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9151
Epoch: 3|  Loss:  1.1559 |Global loss: 5.7464| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9931
Epoch: 0|  Loss:  1.4536 |Global loss: 5.8138| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9787
Epoch: 1|  Loss:  1.4452 |Global loss: 5.8278| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9802
Epoch: 2|  Loss:  1.4314 |Global loss: 5.826| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9648
Epoch: 3|  Loss:  1.4241 |Global loss: 5.8245| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9332
Epoch: 0|  Loss:  1.2414 |Global loss: 5.7854| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.945
Epoch: 1|  Loss:  1.2581 |Global loss: 5.7773| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.9427
Epoch: 2|  Loss:  1.2559 |Global loss: 5.7808| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.9341
Epoch: 3|  Loss:  1.2465 |Global loss: 5.784| Local H loss: 0.0391  | Global H loss: 0.0391
------------------------- time cost ------------------------- 3.0043888092041016
Chosen Clients:  [8, 0, 14, 4, 10, 12]

-------------Round number: 321-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.892, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.942, 0.983, 0.483, 0.792, 0.95]
AUC in each clients:  [115.973, 118.378, 116.851, 118.058, 118.045, 117.119, 116.939, 118.506, 118.692, 118.675, 117.458, 118.686, 113.444, 114.29, 118.195]
F1 Score:  [0.742, 0.861, 0.894, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.935, 0.98, 0.5, 0.775, 0.944]
Recall Score:  [0.798, 0.894, 0.914, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.945, 0.984, 0.567, 0.821, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3720
Averaged Test Accurancy: 0.8739
Averaged Test AUC: 0.9774
Averaged Test F1_score: 0.8624
Averaged Test Recal score: 0.8877
Std Test Accurancy: 0.1282
Std Test AUC: 0.0130
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9357
Epoch: 0|  Loss:  1.2114 |Global loss: 5.7588| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.921
Epoch: 1|  Loss:  1.1963 |Global loss: 5.7698| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9287
Epoch: 2|  Loss:  1.2025 |Global loss: 5.768| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9153
Epoch: 3|  Loss:  1.1892 |Global loss: 5.7643| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9563
Epoch: 0|  Loss:  1.4427 |Global loss: 5.7825| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9581
Epoch: 1|  Loss:  1.4376 |Global loss: 5.7748| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9677
Epoch: 2|  Loss:  1.4509 |Global loss: 5.7706| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.9572
Epoch: 3|  Loss:  1.4389 |Global loss: 5.782| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 0|  NKD Loss: 0.9203
Epoch: 0|  Loss:  1.2157 |Global loss: 5.7841| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.9308
Epoch: 1|  Loss:  1.234 |Global loss: 5.775| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9358
Epoch: 2|  Loss:  1.231 |Global loss: 5.769| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9201
Epoch: 3|  Loss:  1.2105 |Global loss: 5.7818| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.9098
Epoch: 0|  Loss:  1.3648 |Global loss: 5.7501| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9236
Epoch: 1|  Loss:  1.3897 |Global loss: 5.7409| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.9207
Epoch: 2|  Loss:  1.3817 |Global loss: 5.7287| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9292
Epoch: 3|  Loss:  1.3896 |Global loss: 5.7369| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9409
Epoch: 0|  Loss:  1.2565 |Global loss: 5.7763| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9333
Epoch: 1|  Loss:  1.2483 |Global loss: 5.7838| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9396
Epoch: 2|  Loss:  1.2544 |Global loss: 5.782| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9263
Epoch: 3|  Loss:  1.2364 |Global loss: 5.7792| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 1.0485
Epoch: 0|  Loss:  1.93 |Global loss: 5.8659| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 1.0662
Epoch: 1|  Loss:  1.9393 |Global loss: 5.8617| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 1.056
Epoch: 2|  Loss:  1.9483 |Global loss: 5.8626| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 1.0583
Epoch: 3|  Loss:  1.9172 |Global loss: 5.8651| Local H loss: 0.0373  | Global H loss: 0.0373
------------------------- time cost ------------------------- 2.8529627323150635
Chosen Clients:  [3, 11, 7, 10, 6, 2]

-------------Round number: 322-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.892, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.942, 0.983, 0.508, 0.792, 0.95]
AUC in each clients:  [116.021, 118.378, 116.851, 118.058, 118.026, 117.119, 116.939, 118.506, 118.715, 118.675, 117.626, 118.686, 114.164, 114.29, 118.208]
F1 Score:  [0.742, 0.861, 0.894, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.935, 0.98, 0.527, 0.775, 0.944]
Recall Score:  [0.798, 0.894, 0.914, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.945, 0.984, 0.587, 0.821, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3637
Averaged Test Accurancy: 0.8756
Averaged Test AUC: 0.9779
Averaged Test F1_score: 0.8642
Averaged Test Recal score: 0.8891
Std Test Accurancy: 0.1232
Std Test AUC: 0.0120
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9147
Epoch: 0|  Loss:  1.2616 |Global loss: 5.7701| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9164
Epoch: 1|  Loss:  1.2518 |Global loss: 5.7698| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9327
Epoch: 2|  Loss:  1.2762 |Global loss: 5.7558| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.9323
Epoch: 3|  Loss:  1.2782 |Global loss: 5.7543| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 0|  NKD Loss: 0.8995
Epoch: 0|  Loss:  1.1406 |Global loss: 5.7481| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9207
Epoch: 1|  Loss:  1.1622 |Global loss: 5.7361| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.8914
Epoch: 2|  Loss:  1.1363 |Global loss: 5.757| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9074
Epoch: 3|  Loss:  1.1521 |Global loss: 5.7475| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9347
Epoch: 0|  Loss:  1.2613 |Global loss: 5.7906| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 1|  NKD Loss: 0.9542
Epoch: 1|  Loss:  1.2897 |Global loss: 5.7783| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 2|  NKD Loss: 0.9315
Epoch: 2|  Loss:  1.2575 |Global loss: 5.7952| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.9369
Epoch: 3|  Loss:  1.264 |Global loss: 5.7906| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 0|  NKD Loss: 0.949
Epoch: 0|  Loss:  1.2547 |Global loss: 5.7716| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9452
Epoch: 1|  Loss:  1.2519 |Global loss: 5.7715| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 2|  NKD Loss: 0.9198
Epoch: 2|  Loss:  1.2309 |Global loss: 5.7924| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9301
Epoch: 3|  Loss:  1.2385 |Global loss: 5.7865| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9781
Epoch: 0|  Loss:  1.3549 |Global loss: 5.7792| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9675
Epoch: 1|  Loss:  1.3474 |Global loss: 5.776| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9497
Epoch: 2|  Loss:  1.3368 |Global loss: 5.796| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9559
Epoch: 3|  Loss:  1.3494 |Global loss: 5.7866| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9958
Epoch: 0|  Loss:  1.4073 |Global loss: 5.8253| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9867
Epoch: 1|  Loss:  1.388 |Global loss: 5.82| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9868
Epoch: 2|  Loss:  1.3699 |Global loss: 5.8187| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.3999 |Global loss: 5.8281| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 3.109607458114624
Chosen Clients:  [10, 6, 0, 12, 1, 13]

-------------Round number: 323-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.508, 0.792, 0.95]
AUC in each clients:  [116.021, 118.378, 116.92, 118.208, 118.026, 117.119, 116.939, 118.464, 118.715, 118.675, 117.611, 118.748, 114.164, 114.29, 118.208]
F1 Score:  [0.742, 0.861, 0.874, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.527, 0.775, 0.944]
Recall Score:  [0.798, 0.894, 0.896, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.587, 0.821, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3562
Averaged Test Accurancy: 0.8750
Averaged Test AUC: 0.9780
Averaged Test F1_score: 0.8638
Averaged Test Recal score: 0.8886
Std Test Accurancy: 0.1238
Std Test AUC: 0.0121
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.933
Epoch: 0|  Loss:  1.2418 |Global loss: 5.7823| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9324
Epoch: 1|  Loss:  1.2362 |Global loss: 5.7884| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9482
Epoch: 2|  Loss:  1.2527 |Global loss: 5.7661| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.9347
Epoch: 3|  Loss:  1.242 |Global loss: 5.7774| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.9582
Epoch: 0|  Loss:  1.3501 |Global loss: 5.7833| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9558
Epoch: 1|  Loss:  1.3268 |Global loss: 5.7815| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.9525
Epoch: 2|  Loss:  1.3337 |Global loss: 5.784| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.95
Epoch: 3|  Loss:  1.3409 |Global loss: 5.7853| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9606
Epoch: 0|  Loss:  1.4325 |Global loss: 5.7753| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.9641
Epoch: 1|  Loss:  1.4474 |Global loss: 5.777| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9807
Epoch: 2|  Loss:  1.4611 |Global loss: 5.7628| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 0.9419
Epoch: 3|  Loss:  1.4241 |Global loss: 5.7873| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 1.0697
Epoch: 0|  Loss:  1.9258 |Global loss: 5.8574| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 1.052
Epoch: 1|  Loss:  1.886 |Global loss: 5.864| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 1.0637
Epoch: 2|  Loss:  1.9285 |Global loss: 5.8597| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 1.0387
Epoch: 3|  Loss:  1.8925 |Global loss: 5.8726| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.982
Epoch: 0|  Loss:  1.4271 |Global loss: 5.8234| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9841
Epoch: 1|  Loss:  1.4137 |Global loss: 5.8213| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9802
Epoch: 2|  Loss:  1.4263 |Global loss: 5.821| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9934
Epoch: 3|  Loss:  1.4455 |Global loss: 5.8148| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9495
Epoch: 0|  Loss:  1.5121 |Global loss: 5.7972| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9784
Epoch: 1|  Loss:  1.5369 |Global loss: 5.7787| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9625
Epoch: 2|  Loss:  1.5206 |Global loss: 5.7926| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9672
Epoch: 3|  Loss:  1.5181 |Global loss: 5.7841| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 2.803893804550171
Chosen Clients:  [3, 14, 12, 10, 6, 8]

-------------Round number: 324-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.542, 0.842, 0.95]
AUC in each clients:  [116.069, 118.366, 116.92, 118.208, 118.026, 117.119, 117.002, 118.464, 118.715, 118.675, 117.542, 118.748, 114.146, 114.461, 118.208]
F1 Score:  [0.742, 0.861, 0.874, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.56, 0.84, 0.944]
Recall Score:  [0.798, 0.894, 0.896, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.616, 0.883, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3565
Averaged Test Accurancy: 0.8806
Averaged Test AUC: 0.9781
Averaged Test F1_score: 0.8703
Averaged Test Recal score: 0.8947
Std Test Accurancy: 0.1156
Std Test AUC: 0.0119
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9112
Epoch: 0|  Loss:  1.2507 |Global loss: 5.7691| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 1|  NKD Loss: 0.9143
Epoch: 1|  Loss:  1.2518 |Global loss: 5.7714| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9288
Epoch: 2|  Loss:  1.2697 |Global loss: 5.7574| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9159
Epoch: 3|  Loss:  1.2555 |Global loss: 5.7616| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.9113
Epoch: 0|  Loss:  1.212 |Global loss: 5.7885| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.9384
Epoch: 1|  Loss:  1.2339 |Global loss: 5.7711| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.9256
Epoch: 2|  Loss:  1.2088 |Global loss: 5.7694| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.9109
Epoch: 3|  Loss:  1.2108 |Global loss: 5.7817| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 1.0488
Epoch: 0|  Loss:  1.8981 |Global loss: 5.861| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 1.0377
Epoch: 1|  Loss:  1.8809 |Global loss: 5.871| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 1.0541
Epoch: 2|  Loss:  1.8853 |Global loss: 5.866| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 1.0485
Epoch: 3|  Loss:  1.8979 |Global loss: 5.8606| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.943
Epoch: 0|  Loss:  1.2415 |Global loss: 5.7686| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.2338 |Global loss: 5.7807| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.928
Epoch: 2|  Loss:  1.2345 |Global loss: 5.7807| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.9334
Epoch: 3|  Loss:  1.2378 |Global loss: 5.7765| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9605
Epoch: 0|  Loss:  1.344 |Global loss: 5.7861| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9451
Epoch: 1|  Loss:  1.3146 |Global loss: 5.7976| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9653
Epoch: 2|  Loss:  1.3457 |Global loss: 5.7764| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9428
Epoch: 3|  Loss:  1.3205 |Global loss: 5.788| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9345
Epoch: 0|  Loss:  1.2088 |Global loss: 5.7595| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9132
Epoch: 1|  Loss:  1.1881 |Global loss: 5.7749| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9408
Epoch: 2|  Loss:  1.2109 |Global loss: 5.7559| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9268
Epoch: 3|  Loss:  1.2002 |Global loss: 5.7672| Local H loss: 0.0371  | Global H loss: 0.0371
------------------------- time cost ------------------------- 3.1908278465270996
Chosen Clients:  [10, 14, 6, 9, 12, 8]

-------------Round number: 325-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.975, 0.833, 0.867, 0.825, 0.975, 0.967, 0.983, 0.958, 0.983, 0.583, 0.842, 0.967]
AUC in each clients:  [116.069, 118.366, 116.92, 118.25, 118.026, 117.119, 116.996, 118.464, 118.735, 118.675, 117.651, 118.748, 114.452, 114.461, 118.291]
F1 Score:  [0.742, 0.861, 0.874, 0.971, 0.761, 0.845, 0.824, 0.971, 0.961, 0.981, 0.949, 0.98, 0.603, 0.84, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.976, 0.81, 0.866, 0.866, 0.977, 0.968, 0.984, 0.956, 0.984, 0.642, 0.883, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3448
Averaged Test Accurancy: 0.8850
Averaged Test AUC: 0.9785
Averaged Test F1_score: 0.8750
Averaged Test Recal score: 0.8980
Std Test Accurancy: 0.1081
Std Test AUC: 0.0116
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9191
Epoch: 0|  Loss:  1.2217 |Global loss: 5.7784| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 1|  NKD Loss: 0.9212
Epoch: 1|  Loss:  1.2149 |Global loss: 5.7811| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9396
Epoch: 2|  Loss:  1.2427 |Global loss: 5.7696| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.9258
Epoch: 3|  Loss:  1.2194 |Global loss: 5.7815| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9154
Epoch: 0|  Loss:  1.1969 |Global loss: 5.7784| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.9341
Epoch: 1|  Loss:  1.2258 |Global loss: 5.7665| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.8984
Epoch: 2|  Loss:  1.1967 |Global loss: 5.789| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.9199
Epoch: 3|  Loss:  1.2041 |Global loss: 5.7856| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9573
Epoch: 0|  Loss:  1.3324 |Global loss: 5.7823| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9511
Epoch: 1|  Loss:  1.3316 |Global loss: 5.7894| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9568
Epoch: 2|  Loss:  1.3353 |Global loss: 5.7769| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9442
Epoch: 3|  Loss:  1.3148 |Global loss: 5.7915| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9034
Epoch: 0|  Loss:  1.1592 |Global loss: 5.7483| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 1|  NKD Loss: 0.9034
Epoch: 1|  Loss:  1.1543 |Global loss: 5.7491| Local H loss: 0.0305  | Global H loss: 0.0305
Epoch: 2|  NKD Loss: 0.8967
Epoch: 2|  Loss:  1.1516 |Global loss: 5.7547| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.9012
Epoch: 3|  Loss:  1.1529 |Global loss: 5.7409| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 1.0482
Epoch: 0|  Loss:  1.8599 |Global loss: 5.8596| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 1.0357
Epoch: 1|  Loss:  1.8688 |Global loss: 5.8668| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 1.0468
Epoch: 2|  Loss:  1.8794 |Global loss: 5.8583| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 1.0263
Epoch: 3|  Loss:  1.8621 |Global loss: 5.8841| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.9195
Epoch: 0|  Loss:  1.1895 |Global loss: 5.7701| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9184
Epoch: 1|  Loss:  1.1853 |Global loss: 5.7707| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9249
Epoch: 2|  Loss:  1.1973 |Global loss: 5.7647| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9197
Epoch: 3|  Loss:  1.1873 |Global loss: 5.7595| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 3.1211955547332764
Chosen Clients:  [9, 10, 4, 7, 14, 11]

-------------Round number: 326-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.975, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.492, 0.842, 0.95]
AUC in each clients:  [116.069, 118.366, 116.92, 118.25, 118.026, 117.119, 117.02, 118.464, 118.768, 118.662, 117.633, 118.748, 114.052, 114.461, 118.292]
F1 Score:  [0.742, 0.861, 0.874, 0.971, 0.761, 0.845, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.51, 0.84, 0.944]
Recall Score:  [0.798, 0.894, 0.896, 0.976, 0.81, 0.866, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.573, 0.883, 0.956]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3492
Averaged Test Accurancy: 0.8772
Averaged Test AUC: 0.9782
Averaged Test F1_score: 0.8670
Averaged Test Recal score: 0.8918
Std Test Accurancy: 0.1256
Std Test AUC: 0.0121
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9016
Epoch: 0|  Loss:  1.1531 |Global loss: 5.7485| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 1|  NKD Loss: 0.8951
Epoch: 1|  Loss:  1.145 |Global loss: 5.7541| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 2|  NKD Loss: 0.9082
Epoch: 2|  Loss:  1.159 |Global loss: 5.7464| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 3|  NKD Loss: 0.8873
Epoch: 3|  Loss:  1.126 |Global loss: 5.753| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 0|  NKD Loss: 0.9331
Epoch: 0|  Loss:  1.2338 |Global loss: 5.7732| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.933
Epoch: 1|  Loss:  1.2254 |Global loss: 5.7752| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9117
Epoch: 2|  Loss:  1.2114 |Global loss: 5.7868| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.9171
Epoch: 3|  Loss:  1.2185 |Global loss: 5.7858| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9242
Epoch: 0|  Loss:  1.3953 |Global loss: 5.7386| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.924
Epoch: 1|  Loss:  1.3944 |Global loss: 5.7456| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.9093
Epoch: 2|  Loss:  1.3706 |Global loss: 5.7444| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9318
Epoch: 3|  Loss:  1.4078 |Global loss: 5.7384| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.9426
Epoch: 0|  Loss:  1.2656 |Global loss: 5.785| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 1|  NKD Loss: 0.9405
Epoch: 1|  Loss:  1.2598 |Global loss: 5.7832| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 2|  NKD Loss: 0.9408
Epoch: 2|  Loss:  1.2571 |Global loss: 5.7836| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 3|  NKD Loss: 0.9272
Epoch: 3|  Loss:  1.261 |Global loss: 5.7934| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 0|  NKD Loss: 0.923
Epoch: 0|  Loss:  1.2224 |Global loss: 5.7797| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.9318
Epoch: 1|  Loss:  1.2189 |Global loss: 5.7686| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.932
Epoch: 2|  Loss:  1.226 |Global loss: 5.7688| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.9024
Epoch: 3|  Loss:  1.1931 |Global loss: 5.7865| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9191
Epoch: 0|  Loss:  1.1658 |Global loss: 5.7421| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.8993
Epoch: 1|  Loss:  1.1415 |Global loss: 5.754| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9133
Epoch: 2|  Loss:  1.1659 |Global loss: 5.7409| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.8722
Epoch: 3|  Loss:  1.1221 |Global loss: 5.7724| Local H loss: 0.027  | Global H loss: 0.027
------------------------- time cost ------------------------- 2.921130657196045
Chosen Clients:  [5, 4, 3, 13, 11, 8]

-------------Round number: 327-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.975, 0.842, 0.867, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.492, 0.842, 0.967]
AUC in each clients:  [116.069, 118.366, 116.92, 118.25, 118.048, 117.119, 117.02, 118.556, 118.768, 118.7, 117.793, 118.761, 114.052, 114.461, 118.413]
F1 Score:  [0.742, 0.861, 0.874, 0.971, 0.766, 0.845, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.51, 0.84, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.976, 0.817, 0.866, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.573, 0.883, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3504
Averaged Test Accurancy: 0.8789
Averaged Test AUC: 0.9785
Averaged Test F1_score: 0.8685
Averaged Test Recal score: 0.8932
Std Test Accurancy: 0.1261
Std Test AUC: 0.0122
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 1.0146
Epoch: 0|  Loss:  1.5013 |Global loss: 5.807| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 1.0072
Epoch: 1|  Loss:  1.4789 |Global loss: 5.8002| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9832
Epoch: 2|  Loss:  1.4676 |Global loss: 5.8237| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9758
Epoch: 3|  Loss:  1.4596 |Global loss: 5.8278| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9096
Epoch: 0|  Loss:  1.3528 |Global loss: 5.7396| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9218
Epoch: 1|  Loss:  1.3845 |Global loss: 5.7419| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.897
Epoch: 2|  Loss:  1.349 |Global loss: 5.7574| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9309
Epoch: 3|  Loss:  1.4 |Global loss: 5.7369| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.924
Epoch: 0|  Loss:  1.2635 |Global loss: 5.7615| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 1|  NKD Loss: 0.9252
Epoch: 1|  Loss:  1.2637 |Global loss: 5.7566| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9272
Epoch: 2|  Loss:  1.2631 |Global loss: 5.7567| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9071
Epoch: 3|  Loss:  1.2406 |Global loss: 5.7689| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.9589
Epoch: 0|  Loss:  1.5115 |Global loss: 5.7962| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9627
Epoch: 1|  Loss:  1.5179 |Global loss: 5.7819| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9456
Epoch: 2|  Loss:  1.4974 |Global loss: 5.798| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9642
Epoch: 3|  Loss:  1.512 |Global loss: 5.7926| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8964
Epoch: 0|  Loss:  1.1433 |Global loss: 5.7485| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.8954
Epoch: 1|  Loss:  1.1411 |Global loss: 5.7631| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.8927
Epoch: 2|  Loss:  1.1419 |Global loss: 5.7593| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9164
Epoch: 3|  Loss:  1.1542 |Global loss: 5.737| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9382
Epoch: 0|  Loss:  1.2066 |Global loss: 5.7516| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9055
Epoch: 1|  Loss:  1.1753 |Global loss: 5.7806| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9177
Epoch: 2|  Loss:  1.1898 |Global loss: 5.7659| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9314
Epoch: 3|  Loss:  1.1984 |Global loss: 5.7571| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 2.9518134593963623
Chosen Clients:  [5, 4, 6, 10, 0, 7]

-------------Round number: 328-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.983, 0.833, 0.867, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.492, 0.792, 0.967]
AUC in each clients:  [116.069, 118.366, 116.92, 118.282, 118.036, 116.977, 117.02, 118.556, 118.678, 118.7, 117.793, 118.71, 114.052, 114.252, 118.413]
F1 Score:  [0.742, 0.861, 0.874, 0.982, 0.761, 0.859, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.51, 0.775, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.986, 0.81, 0.859, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.573, 0.821, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3479
Averaged Test Accurancy: 0.8756
Averaged Test AUC: 0.9782
Averaged Test F1_score: 0.8655
Averaged Test Recal score: 0.8888
Std Test Accurancy: 0.1283
Std Test AUC: 0.0124
Std Test F1: 0.0011
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9993
Epoch: 0|  Loss:  1.4799 |Global loss: 5.8065| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9996
Epoch: 1|  Loss:  1.4757 |Global loss: 5.8072| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9718
Epoch: 2|  Loss:  1.4565 |Global loss: 5.8284| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9896
Epoch: 3|  Loss:  1.4622 |Global loss: 5.8115| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9394
Epoch: 0|  Loss:  1.3931 |Global loss: 5.7273| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9174
Epoch: 1|  Loss:  1.3799 |Global loss: 5.7415| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9287
Epoch: 2|  Loss:  1.3708 |Global loss: 5.7264| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9306
Epoch: 3|  Loss:  1.3997 |Global loss: 5.7291| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9382
Epoch: 0|  Loss:  1.3114 |Global loss: 5.7927| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9542
Epoch: 1|  Loss:  1.3127 |Global loss: 5.7742| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.9724
Epoch: 2|  Loss:  1.3482 |Global loss: 5.7713| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 3|  NKD Loss: 0.9601
Epoch: 3|  Loss:  1.3301 |Global loss: 5.7794| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9344
Epoch: 0|  Loss:  1.2193 |Global loss: 5.7642| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.9494
Epoch: 1|  Loss:  1.2479 |Global loss: 5.7654| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.9281
Epoch: 2|  Loss:  1.2208 |Global loss: 5.7718| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9312
Epoch: 3|  Loss:  1.2261 |Global loss: 5.7652| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9443
Epoch: 0|  Loss:  1.4233 |Global loss: 5.7872| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9692
Epoch: 1|  Loss:  1.4426 |Global loss: 5.7736| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.9727
Epoch: 2|  Loss:  1.464 |Global loss: 5.7712| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.9775
Epoch: 3|  Loss:  1.4475 |Global loss: 5.7646| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 0|  NKD Loss: 0.9389
Epoch: 0|  Loss:  1.2573 |Global loss: 5.7828| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.9292
Epoch: 1|  Loss:  1.2485 |Global loss: 5.7869| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.943
Epoch: 2|  Loss:  1.2577 |Global loss: 5.7841| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 3|  NKD Loss: 0.926
Epoch: 3|  Loss:  1.2389 |Global loss: 5.7871| Local H loss: 0.0423  | Global H loss: 0.0423
------------------------- time cost ------------------------- 2.9218547344207764
Chosen Clients:  [3, 6, 12, 7, 4, 11]

-------------Round number: 329-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.867, 0.983, 0.842, 0.883, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.492, 0.792, 0.967]
AUC in each clients:  [116.14, 118.366, 116.92, 118.282, 118.064, 117.13, 117.024, 118.439, 118.678, 118.7, 117.721, 118.71, 114.052, 114.252, 118.413]
F1 Score:  [0.748, 0.861, 0.874, 0.982, 0.766, 0.872, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.51, 0.775, 0.962]
Recall Score:  [0.809, 0.894, 0.896, 0.986, 0.817, 0.883, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.573, 0.821, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3478
Averaged Test Accurancy: 0.8778
Averaged Test AUC: 0.9783
Averaged Test F1_score: 0.8671
Averaged Test Recal score: 0.8916
Std Test Accurancy: 0.1276
Std Test AUC: 0.0123
Std Test F1: 0.0010
Std Test Recall: 0.0009
Epoch: 0|  NKD Loss: 0.9265
Epoch: 0|  Loss:  1.2626 |Global loss: 5.7563| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9425
Epoch: 1|  Loss:  1.2735 |Global loss: 5.7427| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9109
Epoch: 2|  Loss:  1.2333 |Global loss: 5.7577| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 3|  NKD Loss: 0.9234
Epoch: 3|  Loss:  1.2541 |Global loss: 5.7554| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.9488
Epoch: 0|  Loss:  1.3145 |Global loss: 5.7763| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9293
Epoch: 1|  Loss:  1.2928 |Global loss: 5.7915| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9523
Epoch: 2|  Loss:  1.3193 |Global loss: 5.7774| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9392
Epoch: 3|  Loss:  1.3 |Global loss: 5.7902| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 1.0418
Epoch: 0|  Loss:  1.877 |Global loss: 5.8676| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 1.0365
Epoch: 1|  Loss:  1.8482 |Global loss: 5.8664| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 1.0551
Epoch: 2|  Loss:  1.8692 |Global loss: 5.8465| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 1.0277
Epoch: 3|  Loss:  1.8652 |Global loss: 5.8684| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9352
Epoch: 0|  Loss:  1.2416 |Global loss: 5.7773| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 1|  NKD Loss: 0.9396
Epoch: 1|  Loss:  1.2497 |Global loss: 5.7722| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 2|  NKD Loss: 0.9398
Epoch: 2|  Loss:  1.2524 |Global loss: 5.7779| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 0.935
Epoch: 3|  Loss:  1.2343 |Global loss: 5.7724| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.9219
Epoch: 0|  Loss:  1.3856 |Global loss: 5.7402| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.9207
Epoch: 1|  Loss:  1.3904 |Global loss: 5.7432| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.3732 |Global loss: 5.7327| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9101
Epoch: 3|  Loss:  1.3715 |Global loss: 5.7406| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.9125
Epoch: 0|  Loss:  1.1598 |Global loss: 5.7478| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9158
Epoch: 1|  Loss:  1.1656 |Global loss: 5.7387| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9018
Epoch: 2|  Loss:  1.142 |Global loss: 5.7529| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9088
Epoch: 3|  Loss:  1.158 |Global loss: 5.7447| Local H loss: 0.0273  | Global H loss: 0.0273
------------------------- time cost ------------------------- 3.23146390914917
Chosen Clients:  [4, 13, 2, 9, 3, 6]

-------------Round number: 330-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.867, 0.975, 0.842, 0.883, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.533, 0.792, 0.967]
AUC in each clients:  [116.14, 118.366, 116.92, 118.404, 118.069, 117.13, 117.033, 118.561, 118.678, 118.7, 117.721, 118.748, 114.389, 114.252, 118.413]
F1 Score:  [0.748, 0.861, 0.874, 0.971, 0.766, 0.872, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.555, 0.775, 0.962]
Recall Score:  [0.809, 0.894, 0.896, 0.976, 0.817, 0.883, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.602, 0.821, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3502
Averaged Test Accurancy: 0.8800
Averaged Test AUC: 0.9786
Averaged Test F1_score: 0.8694
Averaged Test Recal score: 0.8929
Std Test Accurancy: 0.1189
Std Test AUC: 0.0120
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9195
Epoch: 0|  Loss:  1.3556 |Global loss: 5.7414| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.9375
Epoch: 1|  Loss:  1.3865 |Global loss: 5.725| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9334
Epoch: 2|  Loss:  1.4009 |Global loss: 5.7216| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9422
Epoch: 3|  Loss:  1.3867 |Global loss: 5.7192| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9663
Epoch: 0|  Loss:  1.5088 |Global loss: 5.7777| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9673
Epoch: 1|  Loss:  1.5108 |Global loss: 5.7834| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9762
Epoch: 2|  Loss:  1.5307 |Global loss: 5.778| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9602
Epoch: 3|  Loss:  1.4808 |Global loss: 5.7843| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9968
Epoch: 0|  Loss:  1.3702 |Global loss: 5.8022| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9871
Epoch: 1|  Loss:  1.3819 |Global loss: 5.8152| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9831
Epoch: 2|  Loss:  1.3764 |Global loss: 5.8207| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9698
Epoch: 3|  Loss:  1.3582 |Global loss: 5.8211| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9007
Epoch: 0|  Loss:  1.1499 |Global loss: 5.7502| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.9196
Epoch: 1|  Loss:  1.1686 |Global loss: 5.7329| Local H loss: 0.0303  | Global H loss: 0.0303
Epoch: 2|  NKD Loss: 0.9248
Epoch: 2|  Loss:  1.1743 |Global loss: 5.7284| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 3|  NKD Loss: 0.9182
Epoch: 3|  Loss:  1.1675 |Global loss: 5.7299| Local H loss: 0.0302  | Global H loss: 0.0302
Epoch: 0|  NKD Loss: 0.9259
Epoch: 0|  Loss:  1.2529 |Global loss: 5.7553| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9335
Epoch: 1|  Loss:  1.2579 |Global loss: 5.7418| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.9143
Epoch: 2|  Loss:  1.2406 |Global loss: 5.7574| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.9191
Epoch: 3|  Loss:  1.2369 |Global loss: 5.7472| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.9513
Epoch: 0|  Loss:  1.3221 |Global loss: 5.7826| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 1|  NKD Loss: 0.9615
Epoch: 1|  Loss:  1.33 |Global loss: 5.7749| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9723
Epoch: 2|  Loss:  1.3364 |Global loss: 5.7649| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9523
Epoch: 3|  Loss:  1.3199 |Global loss: 5.7814| Local H loss: 0.0314  | Global H loss: 0.0314
------------------------- time cost ------------------------- 2.8883280754089355
Chosen Clients:  [10, 14, 7, 4, 9, 0]

-------------Round number: 331-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.908, 0.983, 0.833, 0.883, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.533, 0.842, 0.967]
AUC in each clients:  [116.14, 118.366, 117.036, 118.465, 118.045, 117.13, 117.057, 118.561, 118.678, 118.727, 117.721, 118.748, 114.389, 114.472, 118.413]
F1 Score:  [0.748, 0.861, 0.91, 0.982, 0.761, 0.872, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.555, 0.84, 0.962]
Recall Score:  [0.809, 0.894, 0.931, 0.986, 0.81, 0.883, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.602, 0.883, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3473
Averaged Test Accurancy: 0.8861
Averaged Test AUC: 0.9789
Averaged Test F1_score: 0.8765
Averaged Test Recal score: 0.8995
Std Test Accurancy: 0.1178
Std Test AUC: 0.0117
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9443
Epoch: 0|  Loss:  1.2402 |Global loss: 5.7573| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9146
Epoch: 1|  Loss:  1.2061 |Global loss: 5.7782| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9152
Epoch: 2|  Loss:  1.2045 |Global loss: 5.7809| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9267
Epoch: 3|  Loss:  1.2209 |Global loss: 5.775| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.9539
Epoch: 0|  Loss:  1.2303 |Global loss: 5.7528| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.9356
Epoch: 1|  Loss:  1.2176 |Global loss: 5.7566| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9398
Epoch: 2|  Loss:  1.2275 |Global loss: 5.7551| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.9259
Epoch: 3|  Loss:  1.2144 |Global loss: 5.7679| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 0.9501
Epoch: 0|  Loss:  1.2557 |Global loss: 5.7701| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 1|  NKD Loss: 0.9302
Epoch: 1|  Loss:  1.2269 |Global loss: 5.7733| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 2|  NKD Loss: 0.9379
Epoch: 2|  Loss:  1.2433 |Global loss: 5.7722| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.9373
Epoch: 3|  Loss:  1.2394 |Global loss: 5.7772| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.9359
Epoch: 0|  Loss:  1.368 |Global loss: 5.7208| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9208
Epoch: 1|  Loss:  1.3777 |Global loss: 5.7322| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9314
Epoch: 2|  Loss:  1.3834 |Global loss: 5.723| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9352
Epoch: 3|  Loss:  1.3813 |Global loss: 5.7247| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9052
Epoch: 0|  Loss:  1.149 |Global loss: 5.7392| Local H loss: 0.0301  | Global H loss: 0.0301
Epoch: 1|  NKD Loss: 0.8924
Epoch: 1|  Loss:  1.1427 |Global loss: 5.7477| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 2|  NKD Loss: 0.9049
Epoch: 2|  Loss:  1.1551 |Global loss: 5.7369| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 3|  NKD Loss: 0.8953
Epoch: 3|  Loss:  1.1376 |Global loss: 5.7407| Local H loss: 0.0299  | Global H loss: 0.0299
Epoch: 0|  NKD Loss: 0.9824
Epoch: 0|  Loss:  1.463 |Global loss: 5.7647| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.9615
Epoch: 1|  Loss:  1.4349 |Global loss: 5.7741| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9474
Epoch: 2|  Loss:  1.4195 |Global loss: 5.7777| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9658
Epoch: 3|  Loss:  1.4398 |Global loss: 5.7691| Local H loss: 0.0255  | Global H loss: 0.0255
------------------------- time cost ------------------------- 3.1025078296661377
Chosen Clients:  [14, 0, 13, 11, 5, 12]

-------------Round number: 332-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.908, 0.983, 0.833, 0.883, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.533, 0.842, 0.967]
AUC in each clients:  [116.108, 118.366, 117.036, 118.465, 118.052, 117.13, 117.057, 118.455, 118.678, 118.754, 117.848, 118.748, 114.389, 114.472, 118.437]
F1 Score:  [0.742, 0.861, 0.91, 0.982, 0.761, 0.872, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.555, 0.84, 0.962]
Recall Score:  [0.798, 0.894, 0.931, 0.986, 0.81, 0.883, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.602, 0.883, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3520
Averaged Test Accurancy: 0.8856
Averaged Test AUC: 0.9789
Averaged Test F1_score: 0.8761
Averaged Test Recal score: 0.8988
Std Test Accurancy: 0.1184
Std Test AUC: 0.0117
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9255
Epoch: 0|  Loss:  1.2121 |Global loss: 5.7672| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.922
Epoch: 1|  Loss:  1.1989 |Global loss: 5.7681| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.9336
Epoch: 2|  Loss:  1.217 |Global loss: 5.7604| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.931
Epoch: 3|  Loss:  1.218 |Global loss: 5.7593| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9546
Epoch: 0|  Loss:  1.4044 |Global loss: 5.7712| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.9616
Epoch: 1|  Loss:  1.4359 |Global loss: 5.7742| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.9622
Epoch: 2|  Loss:  1.4323 |Global loss: 5.7727| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9639
Epoch: 3|  Loss:  1.4292 |Global loss: 5.77| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.958
Epoch: 0|  Loss:  1.488 |Global loss: 5.7876| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9748
Epoch: 1|  Loss:  1.5129 |Global loss: 5.7777| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9598
Epoch: 2|  Loss:  1.4995 |Global loss: 5.7817| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.953
Epoch: 3|  Loss:  1.489 |Global loss: 5.7899| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9251
Epoch: 0|  Loss:  1.1573 |Global loss: 5.7335| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9103
Epoch: 1|  Loss:  1.1562 |Global loss: 5.7435| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.8934
Epoch: 2|  Loss:  1.1286 |Global loss: 5.7501| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.8899
Epoch: 3|  Loss:  1.1347 |Global loss: 5.7593| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9764
Epoch: 0|  Loss:  1.4612 |Global loss: 5.8244| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.973
Epoch: 1|  Loss:  1.4493 |Global loss: 5.8247| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 1.0056
Epoch: 2|  Loss:  1.4742 |Global loss: 5.8056| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9828
Epoch: 3|  Loss:  1.4617 |Global loss: 5.8173| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 1.0542
Epoch: 0|  Loss:  1.8686 |Global loss: 5.8607| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 1.0505
Epoch: 1|  Loss:  1.8642 |Global loss: 5.855| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 1.0278
Epoch: 2|  Loss:  1.8439 |Global loss: 5.8633| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 1.0453
Epoch: 3|  Loss:  1.8706 |Global loss: 5.851| Local H loss: 0.0392  | Global H loss: 0.0392
------------------------- time cost ------------------------- 3.1527645587921143
Chosen Clients:  [6, 10, 12, 14, 2, 0]

-------------Round number: 333-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.908, 0.983, 0.833, 0.9, 0.817, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.15, 118.366, 117.036, 118.465, 118.052, 117.17, 117.057, 118.455, 118.678, 118.754, 117.848, 118.673, 114.69, 114.502, 118.462]
F1 Score:  [0.748, 0.861, 0.91, 0.982, 0.761, 0.89, 0.815, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.894, 0.931, 0.986, 0.81, 0.9, 0.856, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3426
Averaged Test Accurancy: 0.8917
Averaged Test AUC: 0.9791
Averaged Test F1_score: 0.8817
Averaged Test Recal score: 0.9045
Std Test Accurancy: 0.1062
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9557
Epoch: 0|  Loss:  1.3061 |Global loss: 5.7725| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9642
Epoch: 1|  Loss:  1.3225 |Global loss: 5.7727| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.9535
Epoch: 2|  Loss:  1.304 |Global loss: 5.7757| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.934
Epoch: 3|  Loss:  1.2728 |Global loss: 5.7895| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9295
Epoch: 0|  Loss:  1.2205 |Global loss: 5.7718| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.9413
Epoch: 1|  Loss:  1.2279 |Global loss: 5.7655| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9467
Epoch: 2|  Loss:  1.2418 |Global loss: 5.7603| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9382
Epoch: 3|  Loss:  1.2248 |Global loss: 5.7646| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 1.0457
Epoch: 0|  Loss:  1.8505 |Global loss: 5.8601| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 1.0513
Epoch: 1|  Loss:  1.8435 |Global loss: 5.8434| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 1.0511
Epoch: 2|  Loss:  1.8624 |Global loss: 5.8426| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 1.0399
Epoch: 3|  Loss:  1.8477 |Global loss: 5.8589| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9221
Epoch: 0|  Loss:  1.2057 |Global loss: 5.7672| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.9119
Epoch: 1|  Loss:  1.1896 |Global loss: 5.7712| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.9246
Epoch: 2|  Loss:  1.2093 |Global loss: 5.7634| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 3|  NKD Loss: 0.9299
Epoch: 3|  Loss:  1.2067 |Global loss: 5.7636| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9819
Epoch: 0|  Loss:  1.3811 |Global loss: 5.8259| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9869
Epoch: 1|  Loss:  1.3796 |Global loss: 5.8199| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9772
Epoch: 2|  Loss:  1.374 |Global loss: 5.8318| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9839
Epoch: 3|  Loss:  1.3732 |Global loss: 5.8254| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9726
Epoch: 0|  Loss:  1.446 |Global loss: 5.7655| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9673
Epoch: 1|  Loss:  1.4367 |Global loss: 5.7693| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.9553
Epoch: 2|  Loss:  1.4305 |Global loss: 5.7748| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9655
Epoch: 3|  Loss:  1.4182 |Global loss: 5.7619| Local H loss: 0.0257  | Global H loss: 0.0257
------------------------- time cost ------------------------- 3.0110409259796143
Chosen Clients:  [13, 10, 8, 2, 1, 4]

-------------Round number: 334-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.9, 0.983, 0.833, 0.9, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.967]
AUC in each clients:  [116.148, 118.366, 116.973, 118.465, 118.052, 117.17, 117.067, 118.455, 118.678, 118.754, 117.738, 118.673, 114.533, 114.502, 118.494]
F1 Score:  [0.742, 0.861, 0.902, 0.982, 0.761, 0.89, 0.831, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.962]
Recall Score:  [0.798, 0.894, 0.923, 0.986, 0.81, 0.9, 0.875, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3343
Averaged Test Accurancy: 0.8906
Averaged Test AUC: 0.9789
Averaged Test F1_score: 0.8808
Averaged Test Recal score: 0.9035
Std Test Accurancy: 0.1094
Std Test AUC: 0.0115
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9612
Epoch: 0|  Loss:  1.4895 |Global loss: 5.783| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9689
Epoch: 1|  Loss:  1.5156 |Global loss: 5.7778| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9203
Epoch: 2|  Loss:  1.4611 |Global loss: 5.8044| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.963
Epoch: 3|  Loss:  1.5093 |Global loss: 5.7779| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.926
Epoch: 0|  Loss:  1.2176 |Global loss: 5.773| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9234
Epoch: 1|  Loss:  1.215 |Global loss: 5.7702| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9429
Epoch: 2|  Loss:  1.2322 |Global loss: 5.757| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.9148
Epoch: 3|  Loss:  1.2039 |Global loss: 5.7739| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.9326
Epoch: 0|  Loss:  1.2033 |Global loss: 5.7528| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9252
Epoch: 1|  Loss:  1.191 |Global loss: 5.7603| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9238
Epoch: 2|  Loss:  1.19 |Global loss: 5.757| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9176
Epoch: 3|  Loss:  1.1854 |Global loss: 5.7659| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9842
Epoch: 0|  Loss:  1.3817 |Global loss: 5.8225| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.97
Epoch: 1|  Loss:  1.3624 |Global loss: 5.8418| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9901
Epoch: 2|  Loss:  1.3834 |Global loss: 5.8215| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9749
Epoch: 3|  Loss:  1.3616 |Global loss: 5.8243| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9961
Epoch: 0|  Loss:  1.4369 |Global loss: 5.8104| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9717
Epoch: 1|  Loss:  1.4127 |Global loss: 5.8252| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9944
Epoch: 2|  Loss:  1.4326 |Global loss: 5.8091| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.985
Epoch: 3|  Loss:  1.4216 |Global loss: 5.8165| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9029
Epoch: 0|  Loss:  1.3594 |Global loss: 5.7521| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.92
Epoch: 1|  Loss:  1.3796 |Global loss: 5.7352| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9382
Epoch: 2|  Loss:  1.3998 |Global loss: 5.7249| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9219
Epoch: 3|  Loss:  1.3917 |Global loss: 5.7322| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 3.037583112716675
Chosen Clients:  [7, 5, 4, 6, 3, 1]

-------------Round number: 335-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.983, 0.842, 0.9, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.967]
AUC in each clients:  [116.148, 118.392, 117.001, 118.465, 118.07, 117.17, 117.067, 118.455, 118.778, 118.754, 117.851, 118.673, 114.533, 114.625, 118.494]
F1 Score:  [0.742, 0.861, 0.874, 0.982, 0.766, 0.89, 0.831, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.986, 0.817, 0.9, 0.875, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3368
Averaged Test Accurancy: 0.8889
Averaged Test AUC: 0.9792
Averaged Test F1_score: 0.8793
Averaged Test Recal score: 0.9022
Std Test Accurancy: 0.1093
Std Test AUC: 0.0114
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9312
Epoch: 0|  Loss:  1.2375 |Global loss: 5.786| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 1|  NKD Loss: 0.9348
Epoch: 1|  Loss:  1.2397 |Global loss: 5.778| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 2|  NKD Loss: 0.9138
Epoch: 2|  Loss:  1.2175 |Global loss: 5.7921| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.9394
Epoch: 3|  Loss:  1.2341 |Global loss: 5.7729| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 0|  NKD Loss: 0.9822
Epoch: 0|  Loss:  1.4483 |Global loss: 5.8204| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9879
Epoch: 1|  Loss:  1.4639 |Global loss: 5.8112| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 1.0002
Epoch: 2|  Loss:  1.4508 |Global loss: 5.8048| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 1.0013
Epoch: 3|  Loss:  1.4815 |Global loss: 5.8084| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9026
Epoch: 0|  Loss:  1.3647 |Global loss: 5.7544| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9171
Epoch: 1|  Loss:  1.3586 |Global loss: 5.7358| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9248
Epoch: 2|  Loss:  1.3702 |Global loss: 5.726| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9253
Epoch: 3|  Loss:  1.3763 |Global loss: 5.7319| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9352
Epoch: 0|  Loss:  1.2905 |Global loss: 5.7843| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.96
Epoch: 1|  Loss:  1.3077 |Global loss: 5.7714| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.953
Epoch: 2|  Loss:  1.317 |Global loss: 5.779| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.932
Epoch: 3|  Loss:  1.2869 |Global loss: 5.7902| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9198
Epoch: 0|  Loss:  1.242 |Global loss: 5.7539| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 0.9145
Epoch: 1|  Loss:  1.2393 |Global loss: 5.7577| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.9227
Epoch: 2|  Loss:  1.2479 |Global loss: 5.7496| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.9319
Epoch: 3|  Loss:  1.2564 |Global loss: 5.7437| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 1.0004
Epoch: 0|  Loss:  1.4284 |Global loss: 5.8114| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9781
Epoch: 1|  Loss:  1.42 |Global loss: 5.8218| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9724
Epoch: 2|  Loss:  1.4092 |Global loss: 5.8101| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9915
Epoch: 3|  Loss:  1.3988 |Global loss: 5.812| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 2.851691246032715
Chosen Clients:  [1, 10, 9, 14, 7, 8]

-------------Round number: 336-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.983, 0.833, 0.875, 0.825, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.967]
AUC in each clients:  [116.148, 118.396, 117.001, 118.459, 118.064, 117.062, 117.081, 118.559, 118.778, 118.754, 117.851, 118.673, 114.533, 114.625, 118.494]
F1 Score:  [0.742, 0.861, 0.874, 0.982, 0.761, 0.865, 0.824, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.986, 0.81, 0.869, 0.866, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3310
Averaged Test Accurancy: 0.8861
Averaged Test AUC: 0.9792
Averaged Test F1_score: 0.8768
Averaged Test Recal score: 0.8991
Std Test Accurancy: 0.1098
Std Test AUC: 0.0115
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9782
Epoch: 0|  Loss:  1.4104 |Global loss: 5.8199| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9905
Epoch: 1|  Loss:  1.4191 |Global loss: 5.8137| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.9722
Epoch: 2|  Loss:  1.3863 |Global loss: 5.8206| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9828
Epoch: 3|  Loss:  1.4036 |Global loss: 5.8152| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.8927
Epoch: 0|  Loss:  1.175 |Global loss: 5.7848| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.9216
Epoch: 1|  Loss:  1.2037 |Global loss: 5.7703| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.923
Epoch: 2|  Loss:  1.2147 |Global loss: 5.7748| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.9117
Epoch: 3|  Loss:  1.1959 |Global loss: 5.7726| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.1532 |Global loss: 5.7378| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.9072
Epoch: 1|  Loss:  1.1564 |Global loss: 5.735| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.8874
Epoch: 2|  Loss:  1.1339 |Global loss: 5.7482| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.8939
Epoch: 3|  Loss:  1.1416 |Global loss: 5.7428| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9238
Epoch: 0|  Loss:  1.1958 |Global loss: 5.7617| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.9139
Epoch: 1|  Loss:  1.1963 |Global loss: 5.768| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9085
Epoch: 2|  Loss:  1.1884 |Global loss: 5.7729| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.9338
Epoch: 3|  Loss:  1.2104 |Global loss: 5.7569| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9279
Epoch: 0|  Loss:  1.2265 |Global loss: 5.7756| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.9339
Epoch: 1|  Loss:  1.2323 |Global loss: 5.7736| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.9312
Epoch: 2|  Loss:  1.2303 |Global loss: 5.7729| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 3|  NKD Loss: 0.9443
Epoch: 3|  Loss:  1.2325 |Global loss: 5.7603| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.9243
Epoch: 0|  Loss:  1.1892 |Global loss: 5.7597| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9237
Epoch: 1|  Loss:  1.1838 |Global loss: 5.7601| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9171
Epoch: 2|  Loss:  1.1828 |Global loss: 5.7626| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9096
Epoch: 3|  Loss:  1.1685 |Global loss: 5.7699| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 2.952455520629883
Chosen Clients:  [2, 5, 11, 10, 14, 6]

-------------Round number: 337-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.867, 0.983, 0.833, 0.875, 0.825, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.967]
AUC in each clients:  [116.148, 118.439, 117.001, 118.459, 118.064, 117.062, 117.081, 118.502, 118.889, 118.748, 117.839, 118.673, 114.533, 114.625, 118.519]
F1 Score:  [0.742, 0.859, 0.874, 0.982, 0.761, 0.865, 0.824, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.962]
Recall Score:  [0.798, 0.894, 0.896, 0.986, 0.81, 0.869, 0.866, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3282
Averaged Test Accurancy: 0.8861
Averaged Test AUC: 0.9792
Averaged Test F1_score: 0.8767
Averaged Test Recal score: 0.8991
Std Test Accurancy: 0.1098
Std Test AUC: 0.0115
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9655
Epoch: 0|  Loss:  1.3579 |Global loss: 5.8327| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9888
Epoch: 1|  Loss:  1.3802 |Global loss: 5.8299| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9693
Epoch: 2|  Loss:  1.3447 |Global loss: 5.8244| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9645
Epoch: 3|  Loss:  1.3522 |Global loss: 5.8292| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9929
Epoch: 0|  Loss:  1.4579 |Global loss: 5.8122| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9845
Epoch: 1|  Loss:  1.4494 |Global loss: 5.8153| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9776
Epoch: 2|  Loss:  1.4337 |Global loss: 5.8105| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9834
Epoch: 3|  Loss:  1.4489 |Global loss: 5.813| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9064
Epoch: 0|  Loss:  1.1426 |Global loss: 5.7396| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9186
Epoch: 1|  Loss:  1.1552 |Global loss: 5.7403| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.898
Epoch: 2|  Loss:  1.1453 |Global loss: 5.7558| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.8904
Epoch: 3|  Loss:  1.1374 |Global loss: 5.7612| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9249
Epoch: 0|  Loss:  1.2131 |Global loss: 5.7683| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.9253
Epoch: 1|  Loss:  1.208 |Global loss: 5.7696| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.9122
Epoch: 2|  Loss:  1.1946 |Global loss: 5.7815| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9225
Epoch: 3|  Loss:  1.2024 |Global loss: 5.7663| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.9189
Epoch: 0|  Loss:  1.1949 |Global loss: 5.7602| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.9114
Epoch: 1|  Loss:  1.1876 |Global loss: 5.7707| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9259
Epoch: 2|  Loss:  1.1958 |Global loss: 5.7639| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.9229
Epoch: 3|  Loss:  1.1935 |Global loss: 5.7624| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9497
Epoch: 0|  Loss:  1.3151 |Global loss: 5.7806| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9494
Epoch: 1|  Loss:  1.3093 |Global loss: 5.7783| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9583
Epoch: 2|  Loss:  1.316 |Global loss: 5.7689| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9423
Epoch: 3|  Loss:  1.2932 |Global loss: 5.78| Local H loss: 0.0314  | Global H loss: 0.0314
------------------------- time cost ------------------------- 2.83062744140625
Chosen Clients:  [12, 3, 13, 1, 0, 8]

-------------Round number: 338-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.742, 0.908, 0.917, 0.983, 0.833, 0.875, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.975]
AUC in each clients:  [116.148, 118.439, 117.123, 118.459, 118.064, 117.076, 117.115, 118.502, 118.889, 118.748, 117.895, 118.76, 114.533, 114.625, 118.602]
F1 Score:  [0.742, 0.859, 0.917, 0.982, 0.761, 0.869, 0.835, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.971]
Recall Score:  [0.798, 0.894, 0.938, 0.986, 0.81, 0.869, 0.871, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3188
Averaged Test Accurancy: 0.8906
Averaged Test AUC: 0.9794
Averaged Test F1_score: 0.8811
Averaged Test Recal score: 0.9027
Std Test Accurancy: 0.1100
Std Test AUC: 0.0116
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.0243
Epoch: 0|  Loss:  1.8456 |Global loss: 5.8651| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 1.0343
Epoch: 1|  Loss:  1.8278 |Global loss: 5.8608| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 1.0392
Epoch: 2|  Loss:  1.8385 |Global loss: 5.8564| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 1.0273
Epoch: 3|  Loss:  1.8547 |Global loss: 5.8652| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9061
Epoch: 0|  Loss:  1.2288 |Global loss: 5.7598| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 0.9141
Epoch: 1|  Loss:  1.2181 |Global loss: 5.754| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9165
Epoch: 2|  Loss:  1.2311 |Global loss: 5.753| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.891
Epoch: 3|  Loss:  1.197 |Global loss: 5.7675| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.9647
Epoch: 0|  Loss:  1.4863 |Global loss: 5.7825| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.942
Epoch: 1|  Loss:  1.493 |Global loss: 5.7943| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9332
Epoch: 2|  Loss:  1.4731 |Global loss: 5.8032| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9597
Epoch: 3|  Loss:  1.4872 |Global loss: 5.7849| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9834
Epoch: 0|  Loss:  1.4033 |Global loss: 5.8097| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9761
Epoch: 1|  Loss:  1.3981 |Global loss: 5.8163| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9814
Epoch: 2|  Loss:  1.4022 |Global loss: 5.8179| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9804
Epoch: 3|  Loss:  1.3763 |Global loss: 5.819| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.9566
Epoch: 0|  Loss:  1.4218 |Global loss: 5.777| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9678
Epoch: 1|  Loss:  1.4266 |Global loss: 5.7738| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.9419
Epoch: 2|  Loss:  1.4086 |Global loss: 5.787| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9417
Epoch: 3|  Loss:  1.4047 |Global loss: 5.7825| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.9055
Epoch: 0|  Loss:  1.171 |Global loss: 5.7704| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9114
Epoch: 1|  Loss:  1.1758 |Global loss: 5.7655| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9049
Epoch: 2|  Loss:  1.1652 |Global loss: 5.7718| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9119
Epoch: 3|  Loss:  1.1735 |Global loss: 5.7685| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 3.061915397644043
Chosen Clients:  [10, 1, 11, 0, 13, 14]

-------------Round number: 339-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.917, 0.983, 0.833, 0.875, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.542, 0.85, 0.975]
AUC in each clients:  [116.214, 118.453, 117.123, 118.484, 118.064, 117.076, 117.115, 118.502, 118.848, 118.748, 117.895, 118.76, 114.195, 114.666, 118.602]
F1 Score:  [0.748, 0.861, 0.917, 0.982, 0.761, 0.869, 0.835, 0.971, 0.961, 0.981, 0.949, 0.98, 0.554, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.938, 0.986, 0.81, 0.869, 0.871, 0.977, 0.968, 0.984, 0.956, 0.984, 0.606, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3246
Averaged Test Accurancy: 0.8889
Averaged Test AUC: 0.9793
Averaged Test F1_score: 0.8791
Averaged Test Recal score: 0.9015
Std Test Accurancy: 0.1159
Std Test AUC: 0.0119
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9183
Epoch: 0|  Loss:  1.1968 |Global loss: 5.7672| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.926
Epoch: 1|  Loss:  1.2108 |Global loss: 5.7654| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9182
Epoch: 2|  Loss:  1.2017 |Global loss: 5.7693| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9118
Epoch: 3|  Loss:  1.1932 |Global loss: 5.7783| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.9877
Epoch: 0|  Loss:  1.3994 |Global loss: 5.8126| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9902
Epoch: 1|  Loss:  1.4031 |Global loss: 5.8081| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9801
Epoch: 2|  Loss:  1.3967 |Global loss: 5.8088| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9701
Epoch: 3|  Loss:  1.3774 |Global loss: 5.8166| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9035
Epoch: 0|  Loss:  1.152 |Global loss: 5.7455| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.8983
Epoch: 1|  Loss:  1.1436 |Global loss: 5.7535| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9034
Epoch: 2|  Loss:  1.1507 |Global loss: 5.7444| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.8836
Epoch: 3|  Loss:  1.1139 |Global loss: 5.7504| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9647
Epoch: 0|  Loss:  1.3998 |Global loss: 5.7668| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.9596
Epoch: 1|  Loss:  1.4108 |Global loss: 5.7689| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.9541
Epoch: 2|  Loss:  1.4143 |Global loss: 5.7695| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9433
Epoch: 3|  Loss:  1.3975 |Global loss: 5.7846| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.9498
Epoch: 0|  Loss:  1.4999 |Global loss: 5.7889| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9606
Epoch: 1|  Loss:  1.4959 |Global loss: 5.7809| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9422
Epoch: 2|  Loss:  1.484 |Global loss: 5.7946| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9596
Epoch: 3|  Loss:  1.489 |Global loss: 5.7816| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9045
Epoch: 0|  Loss:  1.1795 |Global loss: 5.7678| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.9201
Epoch: 1|  Loss:  1.1924 |Global loss: 5.7669| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.9115
Epoch: 2|  Loss:  1.1896 |Global loss: 5.7686| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.9106
Epoch: 3|  Loss:  1.1852 |Global loss: 5.7669| Local H loss: 0.0291  | Global H loss: 0.0291
------------------------- time cost ------------------------- 3.0944223403930664
Chosen Clients:  [11, 12, 3, 5, 10, 13]

-------------Round number: 340-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.917, 0.983, 0.833, 0.875, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.542, 0.85, 0.958]
AUC in each clients:  [116.215, 118.474, 117.123, 118.484, 118.064, 117.076, 117.115, 118.502, 118.848, 118.748, 117.902, 118.863, 114.195, 114.636, 118.562]
F1 Score:  [0.748, 0.861, 0.917, 0.982, 0.761, 0.869, 0.835, 0.971, 0.961, 0.981, 0.949, 0.98, 0.554, 0.847, 0.953]
Recall Score:  [0.809, 0.894, 0.938, 0.986, 0.81, 0.869, 0.871, 0.977, 0.968, 0.984, 0.956, 0.984, 0.606, 0.894, 0.963]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3224
Averaged Test Accurancy: 0.8878
Averaged Test AUC: 0.9793
Averaged Test F1_score: 0.8779
Averaged Test Recal score: 0.9006
Std Test Accurancy: 0.1151
Std Test AUC: 0.0120
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.898
Epoch: 0|  Loss:  1.1403 |Global loss: 5.7502| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9183
Epoch: 1|  Loss:  1.164 |Global loss: 5.7377| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.892
Epoch: 2|  Loss:  1.1371 |Global loss: 5.7447| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.904
Epoch: 3|  Loss:  1.1471 |Global loss: 5.7465| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 1.0132
Epoch: 0|  Loss:  1.8039 |Global loss: 5.8728| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 1.0309
Epoch: 1|  Loss:  1.8147 |Global loss: 5.8583| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 1.0353
Epoch: 2|  Loss:  1.8083 |Global loss: 5.8488| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 1.0119
Epoch: 3|  Loss:  1.804 |Global loss: 5.8718| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.8876
Epoch: 0|  Loss:  1.2062 |Global loss: 5.774| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9101
Epoch: 1|  Loss:  1.2144 |Global loss: 5.7546| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 0.9192
Epoch: 2|  Loss:  1.2182 |Global loss: 5.748| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 3|  NKD Loss: 0.9265
Epoch: 3|  Loss:  1.2326 |Global loss: 5.7458| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.9853
Epoch: 0|  Loss:  1.4421 |Global loss: 5.8151| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9841
Epoch: 1|  Loss:  1.4494 |Global loss: 5.8112| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9976
Epoch: 2|  Loss:  1.4497 |Global loss: 5.8046| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9917
Epoch: 3|  Loss:  1.4541 |Global loss: 5.8111| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9064
Epoch: 0|  Loss:  1.1912 |Global loss: 5.7799| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.9314
Epoch: 1|  Loss:  1.213 |Global loss: 5.7592| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9095
Epoch: 2|  Loss:  1.1859 |Global loss: 5.772| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9297
Epoch: 3|  Loss:  1.2092 |Global loss: 5.7614| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9636
Epoch: 0|  Loss:  1.4802 |Global loss: 5.7756| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9508
Epoch: 1|  Loss:  1.4889 |Global loss: 5.7809| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9441
Epoch: 2|  Loss:  1.4819 |Global loss: 5.7892| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9369
Epoch: 3|  Loss:  1.465 |Global loss: 5.7904| Local H loss: 0.0361  | Global H loss: 0.0361
------------------------- time cost ------------------------- 2.849501371383667
Chosen Clients:  [8, 1, 3, 9, 2, 13]

-------------Round number: 341-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.917, 0.983, 0.833, 0.817, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.958]
AUC in each clients:  [116.215, 118.474, 117.123, 118.558, 118.064, 116.889, 117.115, 118.502, 118.848, 118.748, 117.941, 118.814, 114.743, 114.736, 118.562]
F1 Score:  [0.748, 0.861, 0.917, 0.982, 0.761, 0.779, 0.835, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.953]
Recall Score:  [0.809, 0.894, 0.938, 0.986, 0.81, 0.794, 0.871, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.963]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3281
Averaged Test Accurancy: 0.8872
Averaged Test AUC: 0.9796
Averaged Test F1_score: 0.8755
Averaged Test Recal score: 0.8984
Std Test Accurancy: 0.1069
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9138
Epoch: 0|  Loss:  1.1776 |Global loss: 5.7645| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9077
Epoch: 1|  Loss:  1.1678 |Global loss: 5.768| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.8963
Epoch: 2|  Loss:  1.1549 |Global loss: 5.7673| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9141
Epoch: 3|  Loss:  1.1732 |Global loss: 5.764| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9954
Epoch: 0|  Loss:  1.4112 |Global loss: 5.8038| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.9699
Epoch: 1|  Loss:  1.3791 |Global loss: 5.8186| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9732
Epoch: 2|  Loss:  1.3768 |Global loss: 5.8158| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9846
Epoch: 3|  Loss:  1.3917 |Global loss: 5.808| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.8955
Epoch: 0|  Loss:  1.2092 |Global loss: 5.7636| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.9097
Epoch: 1|  Loss:  1.2221 |Global loss: 5.7503| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.9174
Epoch: 2|  Loss:  1.2262 |Global loss: 5.7429| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.9053
Epoch: 3|  Loss:  1.2205 |Global loss: 5.7525| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.8969
Epoch: 0|  Loss:  1.141 |Global loss: 5.7408| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 1|  NKD Loss: 0.8914
Epoch: 1|  Loss:  1.1335 |Global loss: 5.7486| Local H loss: 0.0298  | Global H loss: 0.0298
Epoch: 2|  NKD Loss: 0.9062
Epoch: 2|  Loss:  1.1522 |Global loss: 5.7315| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 3|  NKD Loss: 0.8991
Epoch: 3|  Loss:  1.1446 |Global loss: 5.7388| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9809
Epoch: 0|  Loss:  1.3631 |Global loss: 5.8123| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9806
Epoch: 1|  Loss:  1.3663 |Global loss: 5.8297| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9777
Epoch: 2|  Loss:  1.3565 |Global loss: 5.8205| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9777
Epoch: 3|  Loss:  1.3539 |Global loss: 5.8164| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9334
Epoch: 0|  Loss:  1.4453 |Global loss: 5.7917| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9487
Epoch: 1|  Loss:  1.4859 |Global loss: 5.7796| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9596
Epoch: 2|  Loss:  1.4969 |Global loss: 5.7785| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9412
Epoch: 3|  Loss:  1.4617 |Global loss: 5.7925| Local H loss: 0.0361  | Global H loss: 0.0361
------------------------- time cost ------------------------- 2.9645135402679443
Chosen Clients:  [5, 9, 3, 11, 0, 6]

-------------Round number: 342-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.817, 0.833, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.958]
AUC in each clients:  [116.215, 118.468, 117.087, 118.684, 118.064, 116.889, 117.115, 118.502, 118.799, 118.755, 117.941, 118.814, 114.743, 114.781, 118.562]
F1 Score:  [0.748, 0.861, 0.886, 0.982, 0.761, 0.779, 0.835, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.953]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.794, 0.871, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.963]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3249
Averaged Test Accurancy: 0.8850
Averaged Test AUC: 0.9797
Averaged Test F1_score: 0.8735
Averaged Test Recal score: 0.8963
Std Test Accurancy: 0.1066
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9786
Epoch: 0|  Loss:  1.4409 |Global loss: 5.8138| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9909
Epoch: 1|  Loss:  1.4384 |Global loss: 5.8074| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9753
Epoch: 2|  Loss:  1.4396 |Global loss: 5.8151| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9852
Epoch: 3|  Loss:  1.4361 |Global loss: 5.8053| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.8954
Epoch: 0|  Loss:  1.1411 |Global loss: 5.7411| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.8966
Epoch: 1|  Loss:  1.1416 |Global loss: 5.7389| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9041
Epoch: 2|  Loss:  1.148 |Global loss: 5.7353| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 3|  NKD Loss: 0.9173
Epoch: 3|  Loss:  1.1572 |Global loss: 5.7265| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 0|  NKD Loss: 0.9004
Epoch: 0|  Loss:  1.2093 |Global loss: 5.7646| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.9083
Epoch: 1|  Loss:  1.2169 |Global loss: 5.7544| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.9028
Epoch: 2|  Loss:  1.216 |Global loss: 5.7573| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.9044
Epoch: 3|  Loss:  1.2066 |Global loss: 5.7549| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.911
Epoch: 0|  Loss:  1.1358 |Global loss: 5.7465| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9034
Epoch: 1|  Loss:  1.1503 |Global loss: 5.7489| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9029
Epoch: 2|  Loss:  1.1463 |Global loss: 5.7476| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.8966
Epoch: 3|  Loss:  1.1397 |Global loss: 5.7526| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9636
Epoch: 0|  Loss:  1.407 |Global loss: 5.77| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9508
Epoch: 1|  Loss:  1.3987 |Global loss: 5.7687| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.9607
Epoch: 2|  Loss:  1.4035 |Global loss: 5.7695| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.9699
Epoch: 3|  Loss:  1.4202 |Global loss: 5.7629| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 0.9419
Epoch: 0|  Loss:  1.3018 |Global loss: 5.7803| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9592
Epoch: 1|  Loss:  1.3121 |Global loss: 5.772| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.952
Epoch: 2|  Loss:  1.3013 |Global loss: 5.7767| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9576
Epoch: 3|  Loss:  1.3125 |Global loss: 5.7706| Local H loss: 0.0316  | Global H loss: 0.0316
------------------------- time cost ------------------------- 3.0717506408691406
Chosen Clients:  [13, 9, 14, 10, 7, 11]

-------------Round number: 343-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.883, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.958]
AUC in each clients:  [116.237, 118.468, 117.087, 118.668, 118.064, 117.139, 117.136, 118.502, 118.799, 118.805, 117.941, 118.911, 114.743, 114.781, 118.562]
F1 Score:  [0.748, 0.861, 0.886, 0.982, 0.761, 0.873, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.953]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.88, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.963]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3218
Averaged Test Accurancy: 0.8900
Averaged Test AUC: 0.9799
Averaged Test F1_score: 0.8803
Averaged Test Recal score: 0.9027
Std Test Accurancy: 0.1048
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9565
Epoch: 0|  Loss:  1.4782 |Global loss: 5.7804| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9465
Epoch: 1|  Loss:  1.47 |Global loss: 5.7909| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9673
Epoch: 2|  Loss:  1.4768 |Global loss: 5.7737| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9541
Epoch: 3|  Loss:  1.4984 |Global loss: 5.7684| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.1474 |Global loss: 5.7344| Local H loss: 0.0297  | Global H loss: 0.0297
Epoch: 1|  NKD Loss: 0.9052
Epoch: 1|  Loss:  1.1471 |Global loss: 5.7341| Local H loss: 0.0296  | Global H loss: 0.0296
Epoch: 2|  NKD Loss: 0.9047
Epoch: 2|  Loss:  1.1487 |Global loss: 5.7319| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 3|  NKD Loss: 0.8988
Epoch: 3|  Loss:  1.139 |Global loss: 5.7386| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 0|  NKD Loss: 0.9264
Epoch: 0|  Loss:  1.1913 |Global loss: 5.7542| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.9064
Epoch: 1|  Loss:  1.1707 |Global loss: 5.7712| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.9396
Epoch: 2|  Loss:  1.2088 |Global loss: 5.7492| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.9085
Epoch: 3|  Loss:  1.1725 |Global loss: 5.758| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 0|  NKD Loss: 0.9085
Epoch: 0|  Loss:  1.1912 |Global loss: 5.7771| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9011
Epoch: 1|  Loss:  1.184 |Global loss: 5.7853| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9126
Epoch: 2|  Loss:  1.1899 |Global loss: 5.7721| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.924
Epoch: 3|  Loss:  1.2051 |Global loss: 5.7589| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.8956
Epoch: 0|  Loss:  1.182 |Global loss: 5.7911| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 0.9189
Epoch: 1|  Loss:  1.2118 |Global loss: 5.782| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 0.91
Epoch: 2|  Loss:  1.2005 |Global loss: 5.7832| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 0.9216
Epoch: 3|  Loss:  1.1998 |Global loss: 5.7776| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.8719
Epoch: 0|  Loss:  1.1158 |Global loss: 5.7676| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.8901
Epoch: 1|  Loss:  1.1254 |Global loss: 5.7495| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9118
Epoch: 2|  Loss:  1.1442 |Global loss: 5.7381| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9032
Epoch: 3|  Loss:  1.1238 |Global loss: 5.7436| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 3.106550931930542
Chosen Clients:  [1, 0, 11, 10, 9, 5]

-------------Round number: 344-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.883, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.237, 118.468, 117.087, 118.668, 118.064, 117.139, 117.136, 118.63, 118.799, 118.802, 117.951, 118.883, 114.743, 114.77, 118.686]
F1 Score:  [0.748, 0.861, 0.886, 0.982, 0.761, 0.873, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.88, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3227
Averaged Test Accurancy: 0.8906
Averaged Test AUC: 0.9800
Averaged Test F1_score: 0.8809
Averaged Test Recal score: 0.9032
Std Test Accurancy: 0.1052
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9848
Epoch: 0|  Loss:  1.3781 |Global loss: 5.8058| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9752
Epoch: 1|  Loss:  1.3823 |Global loss: 5.8108| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9794
Epoch: 2|  Loss:  1.3812 |Global loss: 5.81| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9648
Epoch: 3|  Loss:  1.3691 |Global loss: 5.8198| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9611
Epoch: 0|  Loss:  1.3997 |Global loss: 5.7613| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9591
Epoch: 1|  Loss:  1.402 |Global loss: 5.7681| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.9413
Epoch: 2|  Loss:  1.3924 |Global loss: 5.7826| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9421
Epoch: 3|  Loss:  1.3986 |Global loss: 5.7749| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9077
Epoch: 0|  Loss:  1.1377 |Global loss: 5.7357| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9118
Epoch: 1|  Loss:  1.1512 |Global loss: 5.7405| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9105
Epoch: 2|  Loss:  1.1499 |Global loss: 5.7341| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.8947
Epoch: 3|  Loss:  1.1391 |Global loss: 5.7455| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9238
Epoch: 0|  Loss:  1.2018 |Global loss: 5.7622| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.9388
Epoch: 1|  Loss:  1.2173 |Global loss: 5.7531| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.897
Epoch: 2|  Loss:  1.1742 |Global loss: 5.7812| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.9062
Epoch: 3|  Loss:  1.1825 |Global loss: 5.77| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8951
Epoch: 0|  Loss:  1.1378 |Global loss: 5.7365| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 1|  NKD Loss: 0.8965
Epoch: 1|  Loss:  1.137 |Global loss: 5.7375| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 2|  NKD Loss: 0.8697
Epoch: 2|  Loss:  1.1111 |Global loss: 5.7578| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.888
Epoch: 3|  Loss:  1.124 |Global loss: 5.7404| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 0|  NKD Loss: 0.9889
Epoch: 0|  Loss:  1.4289 |Global loss: 5.8055| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9704
Epoch: 1|  Loss:  1.4311 |Global loss: 5.8215| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9812
Epoch: 2|  Loss:  1.4187 |Global loss: 5.809| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9712
Epoch: 3|  Loss:  1.4223 |Global loss: 5.8127| Local H loss: 0.027  | Global H loss: 0.027
------------------------- time cost ------------------------- 3.019927501678467
Chosen Clients:  [3, 0, 8, 1, 4, 14]

-------------Round number: 345-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.908, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.314, 118.468, 117.087, 118.668, 118.064, 117.286, 117.136, 118.63, 118.799, 118.857, 118.022, 118.88, 114.743, 114.77, 118.686]
F1 Score:  [0.748, 0.861, 0.886, 0.982, 0.761, 0.898, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.911, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3181
Averaged Test Accurancy: 0.8922
Averaged Test AUC: 0.9802
Averaged Test F1_score: 0.8825
Averaged Test Recal score: 0.9053
Std Test Accurancy: 0.1053
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9116
Epoch: 0|  Loss:  1.2145 |Global loss: 5.7499| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 0.9143
Epoch: 1|  Loss:  1.2214 |Global loss: 5.7456| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.8942
Epoch: 2|  Loss:  1.1977 |Global loss: 5.756| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.903
Epoch: 3|  Loss:  1.2028 |Global loss: 5.7535| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.9281
Epoch: 0|  Loss:  1.3729 |Global loss: 5.7878| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9646
Epoch: 1|  Loss:  1.405 |Global loss: 5.7643| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.9746
Epoch: 2|  Loss:  1.418 |Global loss: 5.7592| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9468
Epoch: 3|  Loss:  1.3847 |Global loss: 5.774| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9187
Epoch: 0|  Loss:  1.1718 |Global loss: 5.7584| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9181
Epoch: 1|  Loss:  1.1702 |Global loss: 5.757| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9189
Epoch: 2|  Loss:  1.1715 |Global loss: 5.7559| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9072
Epoch: 3|  Loss:  1.1682 |Global loss: 5.768| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9755
Epoch: 0|  Loss:  1.3731 |Global loss: 5.8036| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9794
Epoch: 1|  Loss:  1.3822 |Global loss: 5.8062| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9586
Epoch: 2|  Loss:  1.3398 |Global loss: 5.8243| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9606
Epoch: 3|  Loss:  1.3579 |Global loss: 5.818| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9227
Epoch: 0|  Loss:  1.3849 |Global loss: 5.7356| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9326
Epoch: 1|  Loss:  1.3952 |Global loss: 5.7277| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9385
Epoch: 2|  Loss:  1.4076 |Global loss: 5.7256| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9208
Epoch: 3|  Loss:  1.3612 |Global loss: 5.7267| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9317
Epoch: 0|  Loss:  1.1941 |Global loss: 5.7499| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 1|  NKD Loss: 0.9226
Epoch: 1|  Loss:  1.1911 |Global loss: 5.7513| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.9235
Epoch: 2|  Loss:  1.1936 |Global loss: 5.7555| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 3|  NKD Loss: 0.9099
Epoch: 3|  Loss:  1.1822 |Global loss: 5.7683| Local H loss: 0.029  | Global H loss: 0.029
------------------------- time cost ------------------------- 3.094287395477295
Chosen Clients:  [2, 5, 10, 11, 12, 14]

-------------Round number: 346-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.908, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.319, 118.535, 117.087, 118.684, 118.07, 117.286, 117.136, 118.63, 118.871, 118.857, 118.022, 118.88, 114.743, 114.77, 118.773]
F1 Score:  [0.748, 0.861, 0.886, 0.982, 0.761, 0.898, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.911, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3128
Averaged Test Accurancy: 0.8922
Averaged Test AUC: 0.9804
Averaged Test F1_score: 0.8825
Averaged Test Recal score: 0.9053
Std Test Accurancy: 0.1053
Std Test AUC: 0.0114
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9889
Epoch: 0|  Loss:  1.3635 |Global loss: 5.8119| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.962
Epoch: 1|  Loss:  1.3462 |Global loss: 5.8286| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 1.0019
Epoch: 2|  Loss:  1.3916 |Global loss: 5.8132| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9645
Epoch: 3|  Loss:  1.34 |Global loss: 5.8241| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.977
Epoch: 0|  Loss:  1.4175 |Global loss: 5.8116| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9971
Epoch: 1|  Loss:  1.4376 |Global loss: 5.7972| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9956
Epoch: 2|  Loss:  1.4254 |Global loss: 5.7971| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9977
Epoch: 3|  Loss:  1.4505 |Global loss: 5.801| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9142
Epoch: 0|  Loss:  1.1912 |Global loss: 5.7702| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9187
Epoch: 1|  Loss:  1.1972 |Global loss: 5.761| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9184
Epoch: 2|  Loss:  1.1875 |Global loss: 5.7667| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.8974
Epoch: 3|  Loss:  1.1712 |Global loss: 5.7806| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 0|  NKD Loss: 0.8992
Epoch: 0|  Loss:  1.1383 |Global loss: 5.7494| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.8952
Epoch: 1|  Loss:  1.1315 |Global loss: 5.7428| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8979
Epoch: 2|  Loss:  1.1392 |Global loss: 5.7397| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8892
Epoch: 3|  Loss:  1.1238 |Global loss: 5.7474| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 1.0393
Epoch: 0|  Loss:  1.8233 |Global loss: 5.8447| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 1.0415
Epoch: 1|  Loss:  1.8327 |Global loss: 5.847| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 1.0547
Epoch: 2|  Loss:  1.8429 |Global loss: 5.8409| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 3|  NKD Loss: 1.0311
Epoch: 3|  Loss:  1.8312 |Global loss: 5.8497| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.9139
Epoch: 0|  Loss:  1.1828 |Global loss: 5.7621| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.9334
Epoch: 1|  Loss:  1.2052 |Global loss: 5.7497| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.9076
Epoch: 2|  Loss:  1.1637 |Global loss: 5.7583| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.9302
Epoch: 3|  Loss:  1.1888 |Global loss: 5.7562| Local H loss: 0.0289  | Global H loss: 0.0289
------------------------- time cost ------------------------- 2.8704161643981934
Chosen Clients:  [7, 5, 1, 11, 3, 9]

-------------Round number: 347-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.917, 0.983, 0.833, 0.908, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.583, 0.85, 0.975]
AUC in each clients:  [116.319, 118.535, 117.22, 118.684, 118.07, 117.268, 117.136, 118.63, 118.871, 118.857, 117.955, 118.85, 114.945, 114.77, 118.886]
F1 Score:  [0.748, 0.861, 0.917, 0.982, 0.761, 0.899, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.601, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.938, 0.986, 0.81, 0.912, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.641, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3126
Averaged Test Accurancy: 0.8944
Averaged Test AUC: 0.9806
Averaged Test F1_score: 0.8848
Averaged Test Recal score: 0.9074
Std Test Accurancy: 0.1074
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9362
Epoch: 0|  Loss:  1.2234 |Global loss: 5.7707| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 0.9212
Epoch: 1|  Loss:  1.1995 |Global loss: 5.7808| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.92
Epoch: 2|  Loss:  1.2114 |Global loss: 5.776| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 0.9264
Epoch: 3|  Loss:  1.2125 |Global loss: 5.7718| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.9898
Epoch: 0|  Loss:  1.4395 |Global loss: 5.8063| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.973
Epoch: 1|  Loss:  1.415 |Global loss: 5.8101| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9677
Epoch: 2|  Loss:  1.4086 |Global loss: 5.8208| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9714
Epoch: 3|  Loss:  1.4171 |Global loss: 5.8119| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9614
Epoch: 0|  Loss:  1.3581 |Global loss: 5.8195| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9717
Epoch: 1|  Loss:  1.363 |Global loss: 5.8114| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9543
Epoch: 2|  Loss:  1.3482 |Global loss: 5.8216| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9808
Epoch: 3|  Loss:  1.3685 |Global loss: 5.8059| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.9082
Epoch: 0|  Loss:  1.149 |Global loss: 5.7387| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.9218
Epoch: 1|  Loss:  1.1633 |Global loss: 5.7311| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.8897
Epoch: 2|  Loss:  1.1285 |Global loss: 5.7461| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9157
Epoch: 3|  Loss:  1.1535 |Global loss: 5.7375| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9028
Epoch: 0|  Loss:  1.2045 |Global loss: 5.7525| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 1|  NKD Loss: 0.89
Epoch: 1|  Loss:  1.1929 |Global loss: 5.7581| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.8863
Epoch: 2|  Loss:  1.1845 |Global loss: 5.7669| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.8938
Epoch: 3|  Loss:  1.194 |Global loss: 5.7562| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 0.8935
Epoch: 0|  Loss:  1.1167 |Global loss: 5.7414| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 1|  NKD Loss: 0.9055
Epoch: 1|  Loss:  1.1319 |Global loss: 5.7272| Local H loss: 0.0295  | Global H loss: 0.0295
Epoch: 2|  NKD Loss: 0.9012
Epoch: 2|  Loss:  1.1329 |Global loss: 5.7334| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.8808
Epoch: 3|  Loss:  1.1215 |Global loss: 5.7401| Local H loss: 0.0291  | Global H loss: 0.0291
------------------------- time cost ------------------------- 3.0171611309051514
Chosen Clients:  [0, 2, 5, 1, 10, 3]

-------------Round number: 348-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.917, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.583, 0.85, 0.975]
AUC in each clients:  [116.319, 118.476, 117.22, 118.694, 118.07, 117.232, 117.136, 118.58, 118.871, 118.837, 117.955, 118.872, 114.945, 114.77, 118.886]
F1 Score:  [0.748, 0.861, 0.917, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.601, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.938, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.641, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3051
Averaged Test Accurancy: 0.8939
Averaged Test AUC: 0.9805
Averaged Test F1_score: 0.8842
Averaged Test Recal score: 0.9066
Std Test Accurancy: 0.1073
Std Test AUC: 0.0111
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9551
Epoch: 0|  Loss:  1.3934 |Global loss: 5.7659| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9557
Epoch: 1|  Loss:  1.3967 |Global loss: 5.7668| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.9632
Epoch: 2|  Loss:  1.3956 |Global loss: 5.7618| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.968
Epoch: 3|  Loss:  1.4122 |Global loss: 5.7638| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.9852
Epoch: 0|  Loss:  1.3454 |Global loss: 5.8098| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9824
Epoch: 1|  Loss:  1.3519 |Global loss: 5.8113| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9698
Epoch: 2|  Loss:  1.325 |Global loss: 5.8168| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9764
Epoch: 3|  Loss:  1.3549 |Global loss: 5.8268| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9798
Epoch: 0|  Loss:  1.4242 |Global loss: 5.8077| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9875
Epoch: 1|  Loss:  1.4265 |Global loss: 5.8048| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9909
Epoch: 2|  Loss:  1.4245 |Global loss: 5.8001| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9831
Epoch: 3|  Loss:  1.4226 |Global loss: 5.8036| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.971
Epoch: 0|  Loss:  1.3598 |Global loss: 5.804| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9666
Epoch: 1|  Loss:  1.3474 |Global loss: 5.8083| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9555
Epoch: 2|  Loss:  1.3502 |Global loss: 5.8225| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9631
Epoch: 3|  Loss:  1.3466 |Global loss: 5.8107| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9133
Epoch: 0|  Loss:  1.1832 |Global loss: 5.7636| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.915
Epoch: 1|  Loss:  1.1909 |Global loss: 5.7664| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9276
Epoch: 2|  Loss:  1.2016 |Global loss: 5.7578| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9261
Epoch: 3|  Loss:  1.2012 |Global loss: 5.7555| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9154
Epoch: 0|  Loss:  1.2172 |Global loss: 5.743| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8964
Epoch: 1|  Loss:  1.192 |Global loss: 5.753| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 0.9099
Epoch: 2|  Loss:  1.2063 |Global loss: 5.7373| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 3|  NKD Loss: 0.8966
Epoch: 3|  Loss:  1.1846 |Global loss: 5.7495| Local H loss: 0.0415  | Global H loss: 0.0415
------------------------- time cost ------------------------- 3.260777473449707
Chosen Clients:  [13, 0, 7, 11, 12, 3]

-------------Round number: 349-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.875, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.583, 0.85, 0.975]
AUC in each clients:  [116.343, 118.552, 117.082, 118.754, 118.07, 117.283, 117.136, 118.58, 118.871, 118.837, 118.011, 118.872, 114.945, 114.77, 118.886]
F1 Score:  [0.748, 0.859, 0.879, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.601, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.903, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.641, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3049
Averaged Test Accurancy: 0.8911
Averaged Test AUC: 0.9806
Averaged Test F1_score: 0.8815
Averaged Test Recal score: 0.9043
Std Test Accurancy: 0.1073
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.4322 |Global loss: 5.7887| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9418
Epoch: 1|  Loss:  1.4415 |Global loss: 5.7899| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9694
Epoch: 2|  Loss:  1.4879 |Global loss: 5.7701| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9617
Epoch: 3|  Loss:  1.4676 |Global loss: 5.7717| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9466
Epoch: 0|  Loss:  1.3859 |Global loss: 5.7727| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9466
Epoch: 1|  Loss:  1.3928 |Global loss: 5.7702| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9617
Epoch: 2|  Loss:  1.3904 |Global loss: 5.7597| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.9517
Epoch: 3|  Loss:  1.3873 |Global loss: 5.7699| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.934
Epoch: 0|  Loss:  1.2198 |Global loss: 5.7677| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 1|  NKD Loss: 0.9247
Epoch: 1|  Loss:  1.2091 |Global loss: 5.7708| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 2|  NKD Loss: 0.9314
Epoch: 2|  Loss:  1.217 |Global loss: 5.7662| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 0.9381
Epoch: 3|  Loss:  1.2216 |Global loss: 5.7613| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.9128
Epoch: 0|  Loss:  1.1511 |Global loss: 5.7358| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9001
Epoch: 1|  Loss:  1.1408 |Global loss: 5.7459| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.8975
Epoch: 2|  Loss:  1.1323 |Global loss: 5.7398| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.9004
Epoch: 3|  Loss:  1.1372 |Global loss: 5.7429| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 1.0399
Epoch: 0|  Loss:  1.8021 |Global loss: 5.8466| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 1.0314
Epoch: 1|  Loss:  1.8044 |Global loss: 5.8463| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 1.0277
Epoch: 2|  Loss:  1.8034 |Global loss: 5.8422| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 1.041
Epoch: 3|  Loss:  1.7957 |Global loss: 5.8474| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.8934
Epoch: 0|  Loss:  1.1822 |Global loss: 5.7581| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.901
Epoch: 1|  Loss:  1.1876 |Global loss: 5.7529| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.9221
Epoch: 2|  Loss:  1.2095 |Global loss: 5.7342| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 0.911
Epoch: 3|  Loss:  1.2013 |Global loss: 5.7418| Local H loss: 0.0411  | Global H loss: 0.0411
------------------------- time cost ------------------------- 3.2464182376861572
Chosen Clients:  [2, 3, 9, 8, 4, 1]

-------------Round number: 350-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.875, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.975]
AUC in each clients:  [116.396, 118.552, 117.082, 118.758, 118.07, 117.283, 117.136, 118.676, 118.871, 118.837, 118.011, 118.891, 114.861, 114.694, 118.886]
F1 Score:  [0.748, 0.859, 0.879, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.903, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3104
Averaged Test Accurancy: 0.8917
Averaged Test AUC: 0.9806
Averaged Test F1_score: 0.8820
Averaged Test Recal score: 0.9047
Std Test Accurancy: 0.1057
Std Test AUC: 0.0114
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9797
Epoch: 0|  Loss:  1.3506 |Global loss: 5.8051| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9807
Epoch: 1|  Loss:  1.3354 |Global loss: 5.8061| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9602
Epoch: 2|  Loss:  1.324 |Global loss: 5.8259| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9651
Epoch: 3|  Loss:  1.3291 |Global loss: 5.8238| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9073
Epoch: 0|  Loss:  1.2006 |Global loss: 5.7422| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9029
Epoch: 1|  Loss:  1.1859 |Global loss: 5.7494| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.9107
Epoch: 2|  Loss:  1.2025 |Global loss: 5.7392| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 3|  NKD Loss: 0.9187
Epoch: 3|  Loss:  1.2081 |Global loss: 5.7343| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 0|  NKD Loss: 0.8737
Epoch: 0|  Loss:  1.114 |Global loss: 5.7476| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.901
Epoch: 1|  Loss:  1.1353 |Global loss: 5.7302| Local H loss: 0.0293  | Global H loss: 0.0293
Epoch: 2|  NKD Loss: 0.909
Epoch: 2|  Loss:  1.1453 |Global loss: 5.7308| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 3|  NKD Loss: 0.8955
Epoch: 3|  Loss:  1.1335 |Global loss: 5.7358| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 0|  NKD Loss: 0.9129
Epoch: 0|  Loss:  1.1729 |Global loss: 5.7577| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.1734 |Global loss: 5.7568| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9187
Epoch: 2|  Loss:  1.1786 |Global loss: 5.7511| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9189
Epoch: 3|  Loss:  1.1687 |Global loss: 5.7536| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9343
Epoch: 0|  Loss:  1.3851 |Global loss: 5.7249| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9055
Epoch: 1|  Loss:  1.3669 |Global loss: 5.745| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 0.9215
Epoch: 2|  Loss:  1.3799 |Global loss: 5.7317| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9241
Epoch: 3|  Loss:  1.3719 |Global loss: 5.7282| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9595
Epoch: 0|  Loss:  1.3411 |Global loss: 5.8134| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9697
Epoch: 1|  Loss:  1.3481 |Global loss: 5.808| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9547
Epoch: 2|  Loss:  1.337 |Global loss: 5.8195| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9687
Epoch: 3|  Loss:  1.3413 |Global loss: 5.8024| Local H loss: 0.028  | Global H loss: 0.028
------------------------- time cost ------------------------- 2.8952443599700928
Chosen Clients:  [7, 2, 11, 14, 13, 1]

-------------Round number: 351-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.908, 0.883, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.975]
AUC in each clients:  [116.396, 118.555, 117.192, 118.792, 118.072, 117.283, 117.136, 118.676, 118.804, 118.877, 118.011, 118.891, 114.861, 114.694, 118.886]
F1 Score:  [0.748, 0.859, 0.886, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.971]
Recall Score:  [0.809, 0.894, 0.907, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3047
Averaged Test Accurancy: 0.8922
Averaged Test AUC: 0.9806
Averaged Test F1_score: 0.8825
Averaged Test Recal score: 0.9050
Std Test Accurancy: 0.1056
Std Test AUC: 0.0114
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9306
Epoch: 0|  Loss:  1.2017 |Global loss: 5.7577| Local H loss: 0.0423  | Global H loss: 0.0423
Epoch: 1|  NKD Loss: 0.9076
Epoch: 1|  Loss:  1.1834 |Global loss: 5.7835| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 2|  NKD Loss: 0.9381
Epoch: 2|  Loss:  1.2219 |Global loss: 5.7568| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 3|  NKD Loss: 0.9258
Epoch: 3|  Loss:  1.2074 |Global loss: 5.7706| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 0|  NKD Loss: 0.9741
Epoch: 0|  Loss:  1.3423 |Global loss: 5.8155| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9563
Epoch: 1|  Loss:  1.3158 |Global loss: 5.8282| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9608
Epoch: 2|  Loss:  1.3368 |Global loss: 5.8259| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9595
Epoch: 3|  Loss:  1.3132 |Global loss: 5.8177| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9029
Epoch: 0|  Loss:  1.1384 |Global loss: 5.741| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.8884
Epoch: 1|  Loss:  1.1282 |Global loss: 5.7501| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.9017
Epoch: 2|  Loss:  1.1385 |Global loss: 5.7366| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.9028
Epoch: 3|  Loss:  1.1402 |Global loss: 5.7421| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9102
Epoch: 0|  Loss:  1.1681 |Global loss: 5.7636| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.924
Epoch: 1|  Loss:  1.1903 |Global loss: 5.752| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9078
Epoch: 2|  Loss:  1.1751 |Global loss: 5.7602| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.9282
Epoch: 3|  Loss:  1.1833 |Global loss: 5.7514| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9522
Epoch: 0|  Loss:  1.4802 |Global loss: 5.7753| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9615
Epoch: 1|  Loss:  1.4753 |Global loss: 5.7703| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9452
Epoch: 2|  Loss:  1.4713 |Global loss: 5.7769| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.9418
Epoch: 3|  Loss:  1.4526 |Global loss: 5.7796| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9688
Epoch: 0|  Loss:  1.344 |Global loss: 5.7999| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9747
Epoch: 1|  Loss:  1.3512 |Global loss: 5.7961| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9637
Epoch: 2|  Loss:  1.3352 |Global loss: 5.8026| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9715
Epoch: 3|  Loss:  1.3341 |Global loss: 5.8045| Local H loss: 0.0282  | Global H loss: 0.0282
------------------------- time cost ------------------------- 3.1719775199890137
Chosen Clients:  [13, 4, 14, 6, 12, 0]

-------------Round number: 352-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.917, 0.917, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.396, 118.547, 117.309, 118.792, 118.072, 117.283, 117.136, 118.725, 118.804, 118.877, 118.011, 118.886, 114.861, 114.745, 118.874]
F1 Score:  [0.748, 0.882, 0.918, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.904, 0.937, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3038
Averaged Test Accurancy: 0.8944
Averaged Test AUC: 0.9807
Averaged Test F1_score: 0.8855
Averaged Test Recal score: 0.9072
Std Test Accurancy: 0.1054
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9662
Epoch: 0|  Loss:  1.4757 |Global loss: 5.7725| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.95
Epoch: 1|  Loss:  1.4663 |Global loss: 5.7769| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.9507
Epoch: 2|  Loss:  1.4612 |Global loss: 5.7769| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9513
Epoch: 3|  Loss:  1.4552 |Global loss: 5.7732| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9145
Epoch: 0|  Loss:  1.3495 |Global loss: 5.7309| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.8844
Epoch: 1|  Loss:  1.3522 |Global loss: 5.7468| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 2|  NKD Loss: 0.9119
Epoch: 2|  Loss:  1.3634 |Global loss: 5.7357| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.9432
Epoch: 3|  Loss:  1.3872 |Global loss: 5.7191| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9148
Epoch: 0|  Loss:  1.1772 |Global loss: 5.7635| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.9251
Epoch: 1|  Loss:  1.1923 |Global loss: 5.7467| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9133
Epoch: 2|  Loss:  1.1771 |Global loss: 5.764| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 3|  NKD Loss: 0.9115
Epoch: 3|  Loss:  1.1743 |Global loss: 5.7605| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9278
Epoch: 0|  Loss:  1.2798 |Global loss: 5.7944| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9483
Epoch: 1|  Loss:  1.2953 |Global loss: 5.7723| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9417
Epoch: 2|  Loss:  1.2922 |Global loss: 5.7825| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9228
Epoch: 3|  Loss:  1.271 |Global loss: 5.7965| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 1.028
Epoch: 0|  Loss:  1.8004 |Global loss: 5.8492| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 1.0275
Epoch: 1|  Loss:  1.788 |Global loss: 5.8593| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 1.0277
Epoch: 2|  Loss:  1.7984 |Global loss: 5.8497| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 1.0325
Epoch: 3|  Loss:  1.7916 |Global loss: 5.8509| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 0|  NKD Loss: 0.9581
Epoch: 0|  Loss:  1.3853 |Global loss: 5.766| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.9452
Epoch: 1|  Loss:  1.3659 |Global loss: 5.7713| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.9535
Epoch: 2|  Loss:  1.3881 |Global loss: 5.7663| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9657
Epoch: 3|  Loss:  1.3992 |Global loss: 5.7619| Local H loss: 0.0253  | Global H loss: 0.0253
------------------------- time cost ------------------------- 2.910811424255371
Chosen Clients:  [8, 1, 2, 4, 11, 10]

-------------Round number: 353-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.917, 0.917, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.368, 118.547, 117.309, 118.792, 118.055, 117.283, 117.161, 118.725, 118.804, 118.877, 118.011, 118.886, 115.358, 114.745, 118.798]
F1 Score:  [0.748, 0.882, 0.918, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.637, 0.847, 0.962]
Recall Score:  [0.809, 0.904, 0.937, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.682, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3046
Averaged Test Accurancy: 0.8972
Averaged Test AUC: 0.9810
Averaged Test F1_score: 0.8875
Averaged Test Recal score: 0.9095
Std Test Accurancy: 0.0977
Std Test AUC: 0.0108
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9204
Epoch: 0|  Loss:  1.1792 |Global loss: 5.7546| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9145
Epoch: 1|  Loss:  1.1723 |Global loss: 5.7487| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.8996
Epoch: 2|  Loss:  1.1568 |Global loss: 5.7668| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9115
Epoch: 3|  Loss:  1.1688 |Global loss: 5.7542| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9643
Epoch: 0|  Loss:  1.338 |Global loss: 5.8068| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.968
Epoch: 1|  Loss:  1.3422 |Global loss: 5.8051| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9632
Epoch: 2|  Loss:  1.3243 |Global loss: 5.8002| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9674
Epoch: 3|  Loss:  1.3326 |Global loss: 5.7976| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9875
Epoch: 0|  Loss:  1.3483 |Global loss: 5.805| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.97
Epoch: 1|  Loss:  1.3349 |Global loss: 5.8164| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9526
Epoch: 2|  Loss:  1.3093 |Global loss: 5.8302| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9658
Epoch: 3|  Loss:  1.3343 |Global loss: 5.8252| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9213
Epoch: 0|  Loss:  1.3794 |Global loss: 5.7333| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9113
Epoch: 1|  Loss:  1.3587 |Global loss: 5.7414| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9054
Epoch: 2|  Loss:  1.3461 |Global loss: 5.7404| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.9292
Epoch: 3|  Loss:  1.3682 |Global loss: 5.72| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9144
Epoch: 0|  Loss:  1.1539 |Global loss: 5.727| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.8958
Epoch: 1|  Loss:  1.114 |Global loss: 5.7469| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8994
Epoch: 2|  Loss:  1.117 |Global loss: 5.738| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9102
Epoch: 3|  Loss:  1.1459 |Global loss: 5.7402| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.911
Epoch: 0|  Loss:  1.1846 |Global loss: 5.7661| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.9348
Epoch: 1|  Loss:  1.205 |Global loss: 5.7471| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.9157
Epoch: 2|  Loss:  1.1884 |Global loss: 5.7619| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.9216
Epoch: 3|  Loss:  1.1909 |Global loss: 5.7614| Local H loss: 0.0385  | Global H loss: 0.0385
------------------------- time cost ------------------------- 3.150599718093872
Chosen Clients:  [5, 6, 4, 7, 9, 14]

-------------Round number: 354-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.942, 0.908, 0.983, 0.833, 0.9, 0.842, 0.975, 0.967, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.368, 118.598, 117.368, 118.792, 118.077, 117.283, 117.161, 118.725, 118.925, 118.877, 118.054, 118.792, 115.358, 114.745, 118.798]
F1 Score:  [0.748, 0.926, 0.909, 0.982, 0.761, 0.89, 0.843, 0.971, 0.961, 0.981, 0.949, 0.98, 0.637, 0.847, 0.962]
Recall Score:  [0.809, 0.935, 0.932, 0.986, 0.81, 0.9, 0.881, 0.977, 0.968, 0.984, 0.956, 0.984, 0.682, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3021
Averaged Test Accurancy: 0.8983
Averaged Test AUC: 0.9811
Averaged Test F1_score: 0.8898
Averaged Test Recal score: 0.9112
Std Test Accurancy: 0.0981
Std Test AUC: 0.0108
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9749
Epoch: 0|  Loss:  1.4113 |Global loss: 5.8152| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9632
Epoch: 1|  Loss:  1.3976 |Global loss: 5.8191| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9889
Epoch: 2|  Loss:  1.4233 |Global loss: 5.7982| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9812
Epoch: 3|  Loss:  1.4012 |Global loss: 5.7991| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9484
Epoch: 0|  Loss:  1.3028 |Global loss: 5.7733| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9456
Epoch: 1|  Loss:  1.2702 |Global loss: 5.7819| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 2|  NKD Loss: 0.9477
Epoch: 2|  Loss:  1.2953 |Global loss: 5.773| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9334
Epoch: 3|  Loss:  1.2749 |Global loss: 5.7806| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9155
Epoch: 0|  Loss:  1.3788 |Global loss: 5.7417| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.8962
Epoch: 1|  Loss:  1.3417 |Global loss: 5.7489| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 0.9329
Epoch: 2|  Loss:  1.3796 |Global loss: 5.7223| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.9416
Epoch: 3|  Loss:  1.3905 |Global loss: 5.7112| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.8992
Epoch: 0|  Loss:  1.1788 |Global loss: 5.7875| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 0.923
Epoch: 1|  Loss:  1.1989 |Global loss: 5.7645| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9153
Epoch: 2|  Loss:  1.1973 |Global loss: 5.7646| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.9241
Epoch: 3|  Loss:  1.2018 |Global loss: 5.767| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.8935
Epoch: 0|  Loss:  1.1307 |Global loss: 5.7356| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.8672
Epoch: 1|  Loss:  1.106 |Global loss: 5.7532| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 2|  NKD Loss: 0.9079
Epoch: 2|  Loss:  1.1468 |Global loss: 5.7222| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.8874
Epoch: 3|  Loss:  1.1212 |Global loss: 5.739| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 0|  NKD Loss: 0.9285
Epoch: 0|  Loss:  1.1885 |Global loss: 5.7479| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 1|  NKD Loss: 0.8993
Epoch: 1|  Loss:  1.1526 |Global loss: 5.7651| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.9036
Epoch: 2|  Loss:  1.1658 |Global loss: 5.7573| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.9237
Epoch: 3|  Loss:  1.166 |Global loss: 5.7463| Local H loss: 0.029  | Global H loss: 0.029
------------------------- time cost ------------------------- 3.2744956016540527
Chosen Clients:  [13, 7, 5, 1, 4, 0]

-------------Round number: 355-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.942, 0.908, 0.983, 0.833, 0.867, 0.85, 0.975, 0.967, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.368, 118.598, 117.368, 118.792, 118.086, 117.217, 117.198, 118.736, 118.925, 118.886, 118.054, 118.792, 115.358, 114.745, 118.791]
F1 Score:  [0.748, 0.926, 0.909, 0.982, 0.761, 0.856, 0.853, 0.971, 0.961, 0.981, 0.949, 0.98, 0.637, 0.847, 0.962]
Recall Score:  [0.809, 0.935, 0.932, 0.986, 0.81, 0.855, 0.886, 0.977, 0.968, 0.984, 0.956, 0.984, 0.682, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3046
Averaged Test Accurancy: 0.8967
Averaged Test AUC: 0.9811
Averaged Test F1_score: 0.8882
Averaged Test Recal score: 0.9085
Std Test Accurancy: 0.0982
Std Test AUC: 0.0108
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9541
Epoch: 0|  Loss:  1.4633 |Global loss: 5.7767| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9401
Epoch: 1|  Loss:  1.458 |Global loss: 5.7771| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 0.9537
Epoch: 2|  Loss:  1.4643 |Global loss: 5.771| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.9541
Epoch: 3|  Loss:  1.4643 |Global loss: 5.7726| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9038
Epoch: 0|  Loss:  1.1787 |Global loss: 5.7788| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 0.9228
Epoch: 1|  Loss:  1.1998 |Global loss: 5.7626| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 2|  NKD Loss: 0.9163
Epoch: 2|  Loss:  1.1914 |Global loss: 5.7701| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 3|  NKD Loss: 0.8836
Epoch: 3|  Loss:  1.1586 |Global loss: 5.7966| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 0|  NKD Loss: 0.9751
Epoch: 0|  Loss:  1.4146 |Global loss: 5.798| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9951
Epoch: 1|  Loss:  1.4158 |Global loss: 5.7989| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9688
Epoch: 2|  Loss:  1.3937 |Global loss: 5.8105| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9893
Epoch: 3|  Loss:  1.391 |Global loss: 5.7986| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9797
Epoch: 0|  Loss:  1.3391 |Global loss: 5.787| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9574
Epoch: 1|  Loss:  1.3206 |Global loss: 5.8051| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9824
Epoch: 2|  Loss:  1.3382 |Global loss: 5.7848| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9544
Epoch: 3|  Loss:  1.325 |Global loss: 5.8108| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9273
Epoch: 0|  Loss:  1.3778 |Global loss: 5.7244| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.9029
Epoch: 1|  Loss:  1.3488 |Global loss: 5.7429| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 0.9339
Epoch: 2|  Loss:  1.3916 |Global loss: 5.7174| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.9375
Epoch: 3|  Loss:  1.3883 |Global loss: 5.7166| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 0.9542
Epoch: 0|  Loss:  1.3877 |Global loss: 5.7641| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.9648
Epoch: 1|  Loss:  1.4019 |Global loss: 5.7599| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.9581
Epoch: 2|  Loss:  1.3909 |Global loss: 5.764| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9406
Epoch: 3|  Loss:  1.3783 |Global loss: 5.7747| Local H loss: 0.0251  | Global H loss: 0.0251
------------------------- time cost ------------------------- 2.98018217086792
Chosen Clients:  [8, 13, 11, 4, 10, 9]

-------------Round number: 356-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.892, 0.85, 0.975, 0.967, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.414, 118.655, 117.368, 118.792, 118.083, 117.285, 117.198, 118.642, 118.925, 118.886, 118.054, 118.792, 115.358, 114.737, 118.791]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.886, 0.853, 0.971, 0.961, 0.981, 0.949, 0.98, 0.637, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.888, 0.886, 0.977, 0.968, 0.984, 0.956, 0.984, 0.682, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2993
Averaged Test Accurancy: 0.9006
Averaged Test AUC: 0.9811
Averaged Test F1_score: 0.8932
Averaged Test Recal score: 0.9135
Std Test Accurancy: 0.0992
Std Test AUC: 0.0108
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9265
Epoch: 0|  Loss:  1.183 |Global loss: 5.7451| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.8994
Epoch: 1|  Loss:  1.1555 |Global loss: 5.7633| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9278
Epoch: 2|  Loss:  1.1809 |Global loss: 5.747| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9118
Epoch: 3|  Loss:  1.161 |Global loss: 5.7561| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9592
Epoch: 0|  Loss:  1.4731 |Global loss: 5.771| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9524
Epoch: 1|  Loss:  1.4428 |Global loss: 5.7724| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9408
Epoch: 2|  Loss:  1.4556 |Global loss: 5.7797| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9486
Epoch: 3|  Loss:  1.4435 |Global loss: 5.7775| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8993
Epoch: 0|  Loss:  1.1255 |Global loss: 5.7331| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.9021
Epoch: 1|  Loss:  1.1312 |Global loss: 5.7393| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.8895
Epoch: 2|  Loss:  1.1229 |Global loss: 5.7487| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.8936
Epoch: 3|  Loss:  1.1254 |Global loss: 5.7398| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.3673 |Global loss: 5.7308| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.9201
Epoch: 1|  Loss:  1.3876 |Global loss: 5.7298| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.9266
Epoch: 2|  Loss:  1.3674 |Global loss: 5.721| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.9237
Epoch: 3|  Loss:  1.3741 |Global loss: 5.724| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 0.9186
Epoch: 0|  Loss:  1.1897 |Global loss: 5.762| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.9099
Epoch: 1|  Loss:  1.1764 |Global loss: 5.7676| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.9092
Epoch: 2|  Loss:  1.182 |Global loss: 5.7654| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.9195
Epoch: 3|  Loss:  1.1885 |Global loss: 5.754| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.8984
Epoch: 0|  Loss:  1.1033 |Global loss: 5.7244| Local H loss: 0.0294  | Global H loss: 0.0294
Epoch: 1|  NKD Loss: 0.8942
Epoch: 1|  Loss:  1.1314 |Global loss: 5.7274| Local H loss: 0.0291  | Global H loss: 0.0291
Epoch: 2|  NKD Loss: 0.9092
Epoch: 2|  Loss:  1.1444 |Global loss: 5.7205| Local H loss: 0.0292  | Global H loss: 0.0292
Epoch: 3|  NKD Loss: 0.9128
Epoch: 3|  Loss:  1.1325 |Global loss: 5.7115| Local H loss: 0.0292  | Global H loss: 0.0292
------------------------- time cost ------------------------- 3.2413899898529053
Chosen Clients:  [13, 8, 9, 1, 12, 3]

-------------Round number: 357-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.892, 0.85, 0.975, 0.967, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.414, 118.655, 117.368, 118.792, 118.099, 117.285, 117.198, 118.642, 118.865, 118.893, 118.052, 118.88, 115.358, 114.799, 118.791]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.886, 0.853, 0.971, 0.961, 0.981, 0.949, 0.98, 0.637, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.888, 0.886, 0.977, 0.968, 0.984, 0.956, 0.984, 0.682, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.3032
Averaged Test Accurancy: 0.9006
Averaged Test AUC: 0.9812
Averaged Test F1_score: 0.8932
Averaged Test Recal score: 0.9135
Std Test Accurancy: 0.0992
Std Test AUC: 0.0107
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9255
Epoch: 0|  Loss:  1.4233 |Global loss: 5.7908| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 1|  NKD Loss: 0.9578
Epoch: 1|  Loss:  1.4591 |Global loss: 5.7636| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9266
Epoch: 2|  Loss:  1.429 |Global loss: 5.7849| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.9529
Epoch: 3|  Loss:  1.4439 |Global loss: 5.7642| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9208
Epoch: 0|  Loss:  1.1736 |Global loss: 5.7491| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9159
Epoch: 1|  Loss:  1.1678 |Global loss: 5.755| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.8818
Epoch: 2|  Loss:  1.1364 |Global loss: 5.7678| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9126
Epoch: 3|  Loss:  1.1669 |Global loss: 5.7538| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9024
Epoch: 0|  Loss:  1.1367 |Global loss: 5.7235| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.8821
Epoch: 1|  Loss:  1.1171 |Global loss: 5.7352| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.8892
Epoch: 2|  Loss:  1.1212 |Global loss: 5.7323| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.8743
Epoch: 3|  Loss:  1.1037 |Global loss: 5.7408| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.9781
Epoch: 0|  Loss:  1.3373 |Global loss: 5.7923| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.966
Epoch: 1|  Loss:  1.3151 |Global loss: 5.8001| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9543
Epoch: 2|  Loss:  1.3021 |Global loss: 5.8004| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9454
Epoch: 3|  Loss:  1.3021 |Global loss: 5.8052| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.01
Epoch: 0|  Loss:  1.7704 |Global loss: 5.8632| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 1|  NKD Loss: 1.0307
Epoch: 1|  Loss:  1.7897 |Global loss: 5.8449| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 1.0158
Epoch: 2|  Loss:  1.789 |Global loss: 5.8541| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 3|  NKD Loss: 1.0298
Epoch: 3|  Loss:  1.7847 |Global loss: 5.8361| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.8831
Epoch: 0|  Loss:  1.1726 |Global loss: 5.7547| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.9019
Epoch: 1|  Loss:  1.1811 |Global loss: 5.7388| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.9065
Epoch: 2|  Loss:  1.1911 |Global loss: 5.7392| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.8859
Epoch: 3|  Loss:  1.1749 |Global loss: 5.7489| Local H loss: 0.0409  | Global H loss: 0.0409
------------------------- time cost ------------------------- 2.8973324298858643
Chosen Clients:  [1, 5, 0, 7, 11, 8]

-------------Round number: 358-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.942, 0.908, 0.983, 0.833, 0.892, 0.85, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.414, 118.583, 117.368, 118.852, 118.099, 117.285, 117.198, 118.642, 118.943, 118.939, 118.052, 118.88, 115.273, 114.851, 118.791]
F1 Score:  [0.748, 0.926, 0.909, 0.982, 0.761, 0.886, 0.853, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.935, 0.932, 0.986, 0.81, 0.888, 0.886, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2977
Averaged Test Accurancy: 0.8956
Averaged Test AUC: 0.9812
Averaged Test F1_score: 0.8883
Averaged Test Recal score: 0.9085
Std Test Accurancy: 0.1056
Std Test AUC: 0.0108
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9812
Epoch: 0|  Loss:  1.3407 |Global loss: 5.7825| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9846
Epoch: 1|  Loss:  1.3324 |Global loss: 5.7822| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.9739
Epoch: 2|  Loss:  1.3215 |Global loss: 5.7889| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9369
Epoch: 3|  Loss:  1.2843 |Global loss: 5.8089| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.988
Epoch: 0|  Loss:  1.4087 |Global loss: 5.7929| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9798
Epoch: 1|  Loss:  1.4029 |Global loss: 5.8013| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9881
Epoch: 2|  Loss:  1.4164 |Global loss: 5.7975| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.971
Epoch: 3|  Loss:  1.3853 |Global loss: 5.8092| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9434
Epoch: 0|  Loss:  1.3685 |Global loss: 5.7703| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.9209
Epoch: 1|  Loss:  1.3537 |Global loss: 5.7774| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9605
Epoch: 2|  Loss:  1.3794 |Global loss: 5.7613| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9326
Epoch: 3|  Loss:  1.3487 |Global loss: 5.7766| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9136
Epoch: 0|  Loss:  1.1898 |Global loss: 5.7679| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9307
Epoch: 1|  Loss:  1.1868 |Global loss: 5.7542| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 0.9179
Epoch: 2|  Loss:  1.1899 |Global loss: 5.7653| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.9159
Epoch: 3|  Loss:  1.1908 |Global loss: 5.7694| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 0|  NKD Loss: 0.9052
Epoch: 0|  Loss:  1.14 |Global loss: 5.7429| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.9022
Epoch: 1|  Loss:  1.1388 |Global loss: 5.7333| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.9101
Epoch: 2|  Loss:  1.1454 |Global loss: 5.7349| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9033
Epoch: 3|  Loss:  1.1387 |Global loss: 5.734| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.9134
Epoch: 0|  Loss:  1.1687 |Global loss: 5.7533| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9133
Epoch: 1|  Loss:  1.1634 |Global loss: 5.7549| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9088
Epoch: 2|  Loss:  1.1511 |Global loss: 5.7486| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.8917
Epoch: 3|  Loss:  1.142 |Global loss: 5.7668| Local H loss: 0.0356  | Global H loss: 0.0356
------------------------- time cost ------------------------- 3.1151249408721924
Chosen Clients:  [3, 10, 9, 6, 7, 12]

-------------Round number: 359-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.892, 0.85, 0.975, 0.967, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.373, 118.802, 117.368, 118.852, 118.099, 117.277, 117.198, 118.783, 118.97, 118.939, 118.052, 118.965, 115.273, 114.851, 118.791]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.886, 0.853, 0.971, 0.961, 0.981, 0.949, 0.98, 0.608, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.888, 0.886, 0.977, 0.968, 0.984, 0.956, 0.984, 0.648, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2914
Averaged Test Accurancy: 0.8978
Averaged Test AUC: 0.9814
Averaged Test F1_score: 0.8913
Averaged Test Recal score: 0.9113
Std Test Accurancy: 0.1069
Std Test AUC: 0.0110
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9005
Epoch: 0|  Loss:  1.1887 |Global loss: 5.7438| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 1|  NKD Loss: 0.9057
Epoch: 1|  Loss:  1.1827 |Global loss: 5.732| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 0.8956
Epoch: 2|  Loss:  1.1768 |Global loss: 5.7427| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.8897
Epoch: 3|  Loss:  1.1745 |Global loss: 5.7492| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.9099
Epoch: 0|  Loss:  1.183 |Global loss: 5.7639| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.913
Epoch: 1|  Loss:  1.1817 |Global loss: 5.7575| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.9146
Epoch: 2|  Loss:  1.1799 |Global loss: 5.7609| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.9126
Epoch: 3|  Loss:  1.1762 |Global loss: 5.7631| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.8993
Epoch: 0|  Loss:  1.1304 |Global loss: 5.7291| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.8896
Epoch: 1|  Loss:  1.1174 |Global loss: 5.7246| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.8996
Epoch: 2|  Loss:  1.1305 |Global loss: 5.726| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 3|  NKD Loss: 0.8933
Epoch: 3|  Loss:  1.1248 |Global loss: 5.7287| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.2895 |Global loss: 5.7741| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9362
Epoch: 1|  Loss:  1.2767 |Global loss: 5.7784| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.946
Epoch: 2|  Loss:  1.2882 |Global loss: 5.7679| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9428
Epoch: 3|  Loss:  1.2832 |Global loss: 5.7772| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9181
Epoch: 0|  Loss:  1.1904 |Global loss: 5.7663| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 1|  NKD Loss: 0.9084
Epoch: 1|  Loss:  1.1778 |Global loss: 5.7723| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.9077
Epoch: 2|  Loss:  1.1776 |Global loss: 5.7707| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.919
Epoch: 3|  Loss:  1.1873 |Global loss: 5.7601| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 1.0307
Epoch: 0|  Loss:  1.786 |Global loss: 5.8512| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 1.0424
Epoch: 1|  Loss:  1.8131 |Global loss: 5.8393| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 1.0317
Epoch: 2|  Loss:  1.7865 |Global loss: 5.8406| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 1.0362
Epoch: 3|  Loss:  1.7947 |Global loss: 5.8353| Local H loss: 0.0411  | Global H loss: 0.0411
------------------------- time cost ------------------------- 2.8618690967559814
Chosen Clients:  [13, 10, 14, 12, 5, 4]

-------------Round number: 360-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.892, 0.875, 0.975, 0.967, 0.983, 0.958, 0.983, 0.558, 0.85, 0.967]
AUC in each clients:  [116.373, 118.802, 117.368, 118.861, 118.099, 117.277, 117.265, 118.758, 118.97, 118.925, 118.077, 118.965, 114.989, 114.851, 118.791]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.886, 0.88, 0.971, 0.961, 0.981, 0.949, 0.98, 0.571, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.888, 0.903, 0.977, 0.968, 0.984, 0.956, 0.984, 0.62, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2884
Averaged Test Accurancy: 0.8972
Averaged Test AUC: 0.9813
Averaged Test F1_score: 0.8906
Averaged Test Recal score: 0.9105
Std Test Accurancy: 0.1129
Std Test AUC: 0.0113
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9533
Epoch: 0|  Loss:  1.4473 |Global loss: 5.7761| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9562
Epoch: 1|  Loss:  1.4601 |Global loss: 5.7616| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9434
Epoch: 2|  Loss:  1.4495 |Global loss: 5.7702| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9644
Epoch: 3|  Loss:  1.4583 |Global loss: 5.76| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9299
Epoch: 0|  Loss:  1.1992 |Global loss: 5.7515| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9134
Epoch: 1|  Loss:  1.177 |Global loss: 5.7564| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.9213
Epoch: 2|  Loss:  1.1907 |Global loss: 5.7567| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.9252
Epoch: 3|  Loss:  1.1807 |Global loss: 5.75| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9092
Epoch: 0|  Loss:  1.1679 |Global loss: 5.7572| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.92
Epoch: 1|  Loss:  1.1784 |Global loss: 5.7448| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.908
Epoch: 2|  Loss:  1.1683 |Global loss: 5.7603| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.9185
Epoch: 3|  Loss:  1.1678 |Global loss: 5.7508| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 1.0393
Epoch: 0|  Loss:  1.7877 |Global loss: 5.8397| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 1|  NKD Loss: 1.0243
Epoch: 1|  Loss:  1.7739 |Global loss: 5.8473| Local H loss: 0.0415  | Global H loss: 0.0415
Epoch: 2|  NKD Loss: 1.03
Epoch: 2|  Loss:  1.7626 |Global loss: 5.8364| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 3|  NKD Loss: 1.018
Epoch: 3|  Loss:  1.749 |Global loss: 5.8419| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.9856
Epoch: 0|  Loss:  1.4124 |Global loss: 5.7939| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9689
Epoch: 1|  Loss:  1.3863 |Global loss: 5.8054| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9761
Epoch: 2|  Loss:  1.3989 |Global loss: 5.8003| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.963
Epoch: 3|  Loss:  1.3923 |Global loss: 5.8088| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9175
Epoch: 0|  Loss:  1.3549 |Global loss: 5.7289| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.9297
Epoch: 1|  Loss:  1.3798 |Global loss: 5.7208| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9135
Epoch: 2|  Loss:  1.3678 |Global loss: 5.7296| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 0.9307
Epoch: 3|  Loss:  1.3817 |Global loss: 5.721| Local H loss: 0.0243  | Global H loss: 0.0243
------------------------- time cost ------------------------- 2.93961763381958
Chosen Clients:  [1, 12, 3, 10, 13, 9]

-------------Round number: 361-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.908, 0.875, 0.975, 0.967, 0.983, 0.958, 0.983, 0.55, 0.85, 0.975]
AUC in each clients:  [116.373, 118.802, 117.368, 118.861, 118.094, 117.377, 117.265, 118.758, 118.97, 118.925, 118.081, 118.965, 114.972, 114.84, 118.963]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.766, 0.903, 0.88, 0.971, 0.961, 0.981, 0.949, 0.98, 0.567, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.817, 0.909, 0.903, 0.977, 0.968, 0.984, 0.956, 0.984, 0.613, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2958
Averaged Test Accurancy: 0.8989
Averaged Test AUC: 0.9815
Averaged Test F1_score: 0.8924
Averaged Test Recal score: 0.9124
Std Test Accurancy: 0.1147
Std Test AUC: 0.0114
Std Test F1: 0.0010
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9724
Epoch: 0|  Loss:  1.3267 |Global loss: 5.7872| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9632
Epoch: 1|  Loss:  1.3152 |Global loss: 5.7974| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.3114 |Global loss: 5.8018| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9502
Epoch: 3|  Loss:  1.303 |Global loss: 5.8046| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.0106
Epoch: 0|  Loss:  1.7639 |Global loss: 5.8556| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 1.0417
Epoch: 1|  Loss:  1.7691 |Global loss: 5.8288| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 2|  NKD Loss: 1.0234
Epoch: 2|  Loss:  1.7473 |Global loss: 5.8346| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 1.0127
Epoch: 3|  Loss:  1.7549 |Global loss: 5.8536| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.1714 |Global loss: 5.736| Local H loss: 0.0417  | Global H loss: 0.0417
Epoch: 1|  NKD Loss: 0.9212
Epoch: 1|  Loss:  1.2065 |Global loss: 5.7259| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.8959
Epoch: 2|  Loss:  1.1806 |Global loss: 5.7443| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.9088
Epoch: 3|  Loss:  1.1805 |Global loss: 5.7294| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.9091
Epoch: 0|  Loss:  1.1726 |Global loss: 5.7663| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.8866
Epoch: 1|  Loss:  1.1552 |Global loss: 5.7776| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.9138
Epoch: 2|  Loss:  1.1801 |Global loss: 5.7575| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.9203
Epoch: 3|  Loss:  1.183 |Global loss: 5.7538| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.9499
Epoch: 0|  Loss:  1.4477 |Global loss: 5.7696| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.937
Epoch: 1|  Loss:  1.4326 |Global loss: 5.7803| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.9375
Epoch: 2|  Loss:  1.4417 |Global loss: 5.7749| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9385
Epoch: 3|  Loss:  1.4253 |Global loss: 5.7757| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.8785
Epoch: 0|  Loss:  1.1086 |Global loss: 5.7386| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.9062
Epoch: 1|  Loss:  1.1371 |Global loss: 5.7209| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 2|  NKD Loss: 0.8988
Epoch: 2|  Loss:  1.1307 |Global loss: 5.7183| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.9007
Epoch: 3|  Loss:  1.1309 |Global loss: 5.7231| Local H loss: 0.0289  | Global H loss: 0.0289
------------------------- time cost ------------------------- 2.9983274936676025
Chosen Clients:  [8, 3, 11, 12, 5, 10]

-------------Round number: 362-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.908, 0.875, 0.975, 0.967, 0.983, 0.958, 0.983, 0.575, 0.85, 0.975]
AUC in each clients:  [116.373, 118.721, 117.368, 118.883, 118.094, 117.377, 117.265, 118.758, 118.97, 118.98, 118.061, 118.965, 115.284, 114.901, 118.963]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.766, 0.903, 0.88, 0.971, 0.961, 0.981, 0.949, 0.98, 0.592, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.817, 0.909, 0.903, 0.977, 0.968, 0.984, 0.956, 0.984, 0.634, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2956
Averaged Test Accurancy: 0.9006
Averaged Test AUC: 0.9816
Averaged Test F1_score: 0.8941
Averaged Test Recal score: 0.9138
Std Test Accurancy: 0.1096
Std Test AUC: 0.0110
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.8969
Epoch: 0|  Loss:  1.142 |Global loss: 5.7632| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9117
Epoch: 1|  Loss:  1.1588 |Global loss: 5.754| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9176
Epoch: 2|  Loss:  1.1687 |Global loss: 5.7473| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9167
Epoch: 3|  Loss:  1.1668 |Global loss: 5.7475| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.1807 |Global loss: 5.735| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.1749 |Global loss: 5.7354| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 2|  NKD Loss: 0.9082
Epoch: 2|  Loss:  1.1897 |Global loss: 5.7335| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8935
Epoch: 3|  Loss:  1.1754 |Global loss: 5.7383| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 0|  NKD Loss: 0.9098
Epoch: 0|  Loss:  1.1447 |Global loss: 5.7353| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.9091
Epoch: 1|  Loss:  1.1437 |Global loss: 5.7327| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.8962
Epoch: 2|  Loss:  1.1306 |Global loss: 5.7298| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9012
Epoch: 3|  Loss:  1.138 |Global loss: 5.7362| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 1.0383
Epoch: 0|  Loss:  1.7696 |Global loss: 5.8368| Local H loss: 0.0419  | Global H loss: 0.0419
Epoch: 1|  NKD Loss: 1.01
Epoch: 1|  Loss:  1.7606 |Global loss: 5.8531| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 2|  NKD Loss: 1.0283
Epoch: 2|  Loss:  1.7671 |Global loss: 5.8402| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 3|  NKD Loss: 1.0163
Epoch: 3|  Loss:  1.735 |Global loss: 5.8405| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.9631
Epoch: 0|  Loss:  1.3795 |Global loss: 5.8082| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9912
Epoch: 1|  Loss:  1.4121 |Global loss: 5.7904| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9625
Epoch: 2|  Loss:  1.3832 |Global loss: 5.8086| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9765
Epoch: 3|  Loss:  1.3972 |Global loss: 5.8026| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9275
Epoch: 0|  Loss:  1.1927 |Global loss: 5.7454| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.9044
Epoch: 1|  Loss:  1.1673 |Global loss: 5.7591| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9133
Epoch: 2|  Loss:  1.1787 |Global loss: 5.7607| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9195
Epoch: 3|  Loss:  1.1833 |Global loss: 5.7546| Local H loss: 0.0381  | Global H loss: 0.0381
------------------------- time cost ------------------------- 2.8679771423339844
Chosen Clients:  [11, 8, 3, 5, 13, 10]

-------------Round number: 363-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.925, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.592, 0.85, 0.975]
AUC in each clients:  [116.373, 118.721, 117.368, 118.902, 118.094, 117.429, 117.265, 118.758, 118.951, 118.98, 118.097, 119.008, 115.19, 114.901, 118.963]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.766, 0.917, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.607, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.817, 0.93, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.645, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2939
Averaged Test Accurancy: 0.9033
Averaged Test AUC: 0.9817
Averaged Test F1_score: 0.8966
Averaged Test Recal score: 0.9165
Std Test Accurancy: 0.1069
Std Test AUC: 0.0111
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.8679
Epoch: 0|  Loss:  1.1034 |Global loss: 5.7609| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8965
Epoch: 1|  Loss:  1.1273 |Global loss: 5.7438| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9136
Epoch: 2|  Loss:  1.1508 |Global loss: 5.7263| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1348 |Global loss: 5.7359| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9157
Epoch: 0|  Loss:  1.1668 |Global loss: 5.7483| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8962
Epoch: 1|  Loss:  1.1451 |Global loss: 5.7655| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9228
Epoch: 2|  Loss:  1.171 |Global loss: 5.7422| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9028
Epoch: 3|  Loss:  1.153 |Global loss: 5.7553| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8913
Epoch: 0|  Loss:  1.1698 |Global loss: 5.7466| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8853
Epoch: 1|  Loss:  1.1641 |Global loss: 5.7521| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.905
Epoch: 2|  Loss:  1.1759 |Global loss: 5.7317| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.9081
Epoch: 3|  Loss:  1.1737 |Global loss: 5.732| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.9732
Epoch: 0|  Loss:  1.39 |Global loss: 5.8084| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9827
Epoch: 1|  Loss:  1.401 |Global loss: 5.7947| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9736
Epoch: 2|  Loss:  1.377 |Global loss: 5.7996| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9603
Epoch: 3|  Loss:  1.375 |Global loss: 5.811| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9521
Epoch: 0|  Loss:  1.4582 |Global loss: 5.7574| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9444
Epoch: 1|  Loss:  1.4324 |Global loss: 5.7733| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.9355
Epoch: 2|  Loss:  1.4258 |Global loss: 5.7785| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9406
Epoch: 3|  Loss:  1.4195 |Global loss: 5.7648| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.92
Epoch: 0|  Loss:  1.1762 |Global loss: 5.7551| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9128
Epoch: 1|  Loss:  1.1769 |Global loss: 5.762| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.9124
Epoch: 2|  Loss:  1.1745 |Global loss: 5.7579| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9215
Epoch: 3|  Loss:  1.1816 |Global loss: 5.7481| Local H loss: 0.0385  | Global H loss: 0.0385
------------------------- time cost ------------------------- 3.1022231578826904
Chosen Clients:  [4, 2, 9, 5, 13, 0]

-------------Round number: 364-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.917, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.592, 0.85, 0.975]
AUC in each clients:  [116.373, 118.721, 117.368, 118.906, 118.094, 117.398, 117.265, 118.758, 118.991, 118.98, 118.152, 118.79, 115.19, 114.932, 118.963]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.766, 0.913, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.607, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.817, 0.917, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.645, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2855
Averaged Test Accurancy: 0.9028
Averaged Test AUC: 0.9816
Averaged Test F1_score: 0.8963
Averaged Test Recal score: 0.9157
Std Test Accurancy: 0.1068
Std Test AUC: 0.0110
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9068
Epoch: 0|  Loss:  1.3553 |Global loss: 5.7389| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.8967
Epoch: 1|  Loss:  1.3476 |Global loss: 5.7446| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.9409
Epoch: 2|  Loss:  1.384 |Global loss: 5.7146| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.9168
Epoch: 3|  Loss:  1.3683 |Global loss: 5.7272| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 0.9928
Epoch: 0|  Loss:  1.3445 |Global loss: 5.7948| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9703
Epoch: 1|  Loss:  1.331 |Global loss: 5.812| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9608
Epoch: 2|  Loss:  1.3168 |Global loss: 5.8251| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9538
Epoch: 3|  Loss:  1.3082 |Global loss: 5.8227| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9031
Epoch: 0|  Loss:  1.1193 |Global loss: 5.7183| Local H loss: 0.029  | Global H loss: 0.029
Epoch: 1|  NKD Loss: 0.8926
Epoch: 1|  Loss:  1.1227 |Global loss: 5.7299| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.8993
Epoch: 2|  Loss:  1.1286 |Global loss: 5.7241| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.8987
Epoch: 3|  Loss:  1.1286 |Global loss: 5.7211| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.9838
Epoch: 0|  Loss:  1.4006 |Global loss: 5.7974| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.975
Epoch: 1|  Loss:  1.3832 |Global loss: 5.7984| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9924
Epoch: 2|  Loss:  1.3877 |Global loss: 5.782| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9741
Epoch: 3|  Loss:  1.384 |Global loss: 5.8006| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9567
Epoch: 0|  Loss:  1.4409 |Global loss: 5.7627| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.9418
Epoch: 1|  Loss:  1.415 |Global loss: 5.7724| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.9489
Epoch: 2|  Loss:  1.4537 |Global loss: 5.7629| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9562
Epoch: 3|  Loss:  1.4358 |Global loss: 5.76| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9471
Epoch: 0|  Loss:  1.373 |Global loss: 5.7653| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.9636
Epoch: 1|  Loss:  1.3982 |Global loss: 5.7569| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9656
Epoch: 2|  Loss:  1.3855 |Global loss: 5.7556| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9733
Epoch: 3|  Loss:  1.394 |Global loss: 5.7505| Local H loss: 0.0253  | Global H loss: 0.0253
------------------------- time cost ------------------------- 3.0894176959991455
Chosen Clients:  [12, 11, 14, 1, 0, 9]

-------------Round number: 365-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.842, 0.925, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.592, 0.85, 0.975]
AUC in each clients:  [116.431, 118.721, 117.455, 118.906, 118.094, 117.455, 117.265, 118.758, 118.991, 118.986, 118.152, 118.79, 115.19, 114.889, 118.963]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.766, 0.919, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.607, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.817, 0.93, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.645, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2869
Averaged Test Accurancy: 0.9050
Averaged Test AUC: 0.9817
Averaged Test F1_score: 0.8983
Averaged Test Recal score: 0.9177
Std Test Accurancy: 0.1071
Std Test AUC: 0.0110
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 1.026
Epoch: 0|  Loss:  1.7776 |Global loss: 5.8461| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 1|  NKD Loss: 1.0097
Epoch: 1|  Loss:  1.7407 |Global loss: 5.854| Local H loss: 0.0413  | Global H loss: 0.0413
Epoch: 2|  NKD Loss: 1.0205
Epoch: 2|  Loss:  1.7497 |Global loss: 5.8456| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 3|  NKD Loss: 1.0212
Epoch: 3|  Loss:  1.7551 |Global loss: 5.8322| Local H loss: 0.0418  | Global H loss: 0.0418
Epoch: 0|  NKD Loss: 0.8827
Epoch: 0|  Loss:  1.1185 |Global loss: 5.7461| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9089
Epoch: 1|  Loss:  1.1453 |Global loss: 5.7295| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.9015
Epoch: 2|  Loss:  1.136 |Global loss: 5.7344| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.9151
Epoch: 3|  Loss:  1.1495 |Global loss: 5.7213| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.9101
Epoch: 0|  Loss:  1.1655 |Global loss: 5.753| Local H loss: 0.0289  | Global H loss: 0.0289
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.1886 |Global loss: 5.7439| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.9065
Epoch: 2|  Loss:  1.1616 |Global loss: 5.7541| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.9124
Epoch: 3|  Loss:  1.1594 |Global loss: 5.7532| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 0|  NKD Loss: 0.9664
Epoch: 0|  Loss:  1.32 |Global loss: 5.7904| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9539
Epoch: 1|  Loss:  1.3038 |Global loss: 5.7939| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9722
Epoch: 2|  Loss:  1.3173 |Global loss: 5.7851| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9486
Epoch: 3|  Loss:  1.2905 |Global loss: 5.8001| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9275
Epoch: 0|  Loss:  1.3345 |Global loss: 5.7778| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9699
Epoch: 1|  Loss:  1.3859 |Global loss: 5.753| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.9426
Epoch: 2|  Loss:  1.3657 |Global loss: 5.7663| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9673
Epoch: 3|  Loss:  1.3938 |Global loss: 5.7563| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.8994
Epoch: 0|  Loss:  1.1268 |Global loss: 5.7245| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.8926
Epoch: 1|  Loss:  1.1225 |Global loss: 5.7287| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.9061
Epoch: 2|  Loss:  1.1341 |Global loss: 5.7156| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 3|  NKD Loss: 0.9132
Epoch: 3|  Loss:  1.1406 |Global loss: 5.713| Local H loss: 0.0287  | Global H loss: 0.0287
------------------------- time cost ------------------------- 2.7354986667633057
Chosen Clients:  [5, 9, 10, 4, 8, 13]

-------------Round number: 366-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.958, 0.933, 0.983, 0.842, 0.925, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.427, 118.663, 117.455, 118.906, 118.094, 117.455, 117.265, 118.758, 118.991, 118.939, 118.152, 118.983, 115.571, 114.889, 118.851]
F1 Score:  [0.748, 0.949, 0.932, 0.982, 0.766, 0.919, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.658, 0.847, 0.962]
Recall Score:  [0.809, 0.956, 0.949, 0.986, 0.817, 0.93, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.684, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2912
Averaged Test Accurancy: 0.9061
Averaged Test AUC: 0.9819
Averaged Test F1_score: 0.8996
Averaged Test Recal score: 0.9184
Std Test Accurancy: 0.0982
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9813
Epoch: 0|  Loss:  1.3889 |Global loss: 5.794| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9609
Epoch: 1|  Loss:  1.3678 |Global loss: 5.8123| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9735
Epoch: 2|  Loss:  1.3776 |Global loss: 5.8023| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9516
Epoch: 3|  Loss:  1.3614 |Global loss: 5.8145| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8903
Epoch: 0|  Loss:  1.1196 |Global loss: 5.7273| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.8887
Epoch: 1|  Loss:  1.1109 |Global loss: 5.7265| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.8775
Epoch: 2|  Loss:  1.1049 |Global loss: 5.7359| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.8764
Epoch: 3|  Loss:  1.1019 |Global loss: 5.7365| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9114
Epoch: 0|  Loss:  1.1674 |Global loss: 5.7548| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.9179
Epoch: 1|  Loss:  1.1779 |Global loss: 5.7491| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.8989
Epoch: 2|  Loss:  1.1628 |Global loss: 5.7682| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.9307
Epoch: 3|  Loss:  1.192 |Global loss: 5.7409| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.9218
Epoch: 0|  Loss:  1.3809 |Global loss: 5.7297| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.9161
Epoch: 1|  Loss:  1.3641 |Global loss: 5.7284| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.8999
Epoch: 2|  Loss:  1.3494 |Global loss: 5.7415| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 0.9163
Epoch: 3|  Loss:  1.3707 |Global loss: 5.7297| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 0.8971
Epoch: 0|  Loss:  1.1468 |Global loss: 5.7486| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8895
Epoch: 1|  Loss:  1.1371 |Global loss: 5.7632| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.9145
Epoch: 2|  Loss:  1.1562 |Global loss: 5.745| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9228
Epoch: 3|  Loss:  1.1691 |Global loss: 5.7382| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9455
Epoch: 0|  Loss:  1.4513 |Global loss: 5.7647| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.9591
Epoch: 1|  Loss:  1.4657 |Global loss: 5.7546| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.9314
Epoch: 2|  Loss:  1.4187 |Global loss: 5.7836| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.942
Epoch: 3|  Loss:  1.445 |Global loss: 5.7682| Local H loss: 0.0352  | Global H loss: 0.0352
------------------------- time cost ------------------------- 2.9005072116851807
Chosen Clients:  [9, 1, 12, 2, 3, 14]

-------------Round number: 367-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.958, 0.933, 0.983, 0.833, 0.917, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.633, 0.85, 0.967]
AUC in each clients:  [116.427, 118.663, 117.455, 118.906, 118.101, 117.461, 117.265, 118.758, 119.043, 118.985, 118.124, 118.983, 115.571, 115.042, 118.851]
F1 Score:  [0.748, 0.949, 0.932, 0.982, 0.761, 0.912, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.658, 0.847, 0.962]
Recall Score:  [0.809, 0.956, 0.949, 0.986, 0.81, 0.919, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.684, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2868
Averaged Test Accurancy: 0.9050
Averaged Test AUC: 0.9820
Averaged Test F1_score: 0.8988
Averaged Test Recal score: 0.9172
Std Test Accurancy: 0.0985
Std Test AUC: 0.0104
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.8877
Epoch: 0|  Loss:  1.0991 |Global loss: 5.7167| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 1|  NKD Loss: 0.8976
Epoch: 1|  Loss:  1.1259 |Global loss: 5.7163| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.9118
Epoch: 2|  Loss:  1.1379 |Global loss: 5.7094| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.9063
Epoch: 3|  Loss:  1.1313 |Global loss: 5.7128| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9603
Epoch: 0|  Loss:  1.311 |Global loss: 5.7962| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9513
Epoch: 1|  Loss:  1.293 |Global loss: 5.7942| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9583
Epoch: 2|  Loss:  1.3013 |Global loss: 5.7929| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9497
Epoch: 3|  Loss:  1.2903 |Global loss: 5.8013| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 1.0241
Epoch: 0|  Loss:  1.7383 |Global loss: 5.8284| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 1|  NKD Loss: 1.0173
Epoch: 1|  Loss:  1.7346 |Global loss: 5.8414| Local H loss: 0.042  | Global H loss: 0.042
Epoch: 2|  NKD Loss: 1.0121
Epoch: 2|  Loss:  1.7259 |Global loss: 5.844| Local H loss: 0.0416  | Global H loss: 0.0416
Epoch: 3|  NKD Loss: 1.0289
Epoch: 3|  Loss:  1.7402 |Global loss: 5.828| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 0|  NKD Loss: 0.9968
Epoch: 0|  Loss:  1.3526 |Global loss: 5.793| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9908
Epoch: 1|  Loss:  1.3597 |Global loss: 5.8084| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9639
Epoch: 2|  Loss:  1.3132 |Global loss: 5.8084| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9489
Epoch: 3|  Loss:  1.3017 |Global loss: 5.8249| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9027
Epoch: 0|  Loss:  1.1579 |Global loss: 5.735| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8977
Epoch: 1|  Loss:  1.1657 |Global loss: 5.7361| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.9064
Epoch: 2|  Loss:  1.1815 |Global loss: 5.7263| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.9216
Epoch: 3|  Loss:  1.1961 |Global loss: 5.7185| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.1847 |Global loss: 5.739| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 1|  NKD Loss: 0.9309
Epoch: 1|  Loss:  1.1871 |Global loss: 5.7472| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.9268
Epoch: 2|  Loss:  1.1785 |Global loss: 5.7396| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 3|  NKD Loss: 0.8999
Epoch: 3|  Loss:  1.1552 |Global loss: 5.7625| Local H loss: 0.0285  | Global H loss: 0.0285
------------------------- time cost ------------------------- 3.316288948059082
Chosen Clients:  [9, 3, 1, 10, 14, 8]

-------------Round number: 368-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.917, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.427, 118.767, 117.512, 118.924, 118.101, 117.461, 117.265, 118.758, 119.043, 118.986, 118.124, 118.983, 114.956, 115.042, 118.919]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.912, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.58, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.919, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.639, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2835
Averaged Test Accurancy: 0.9017
Averaged Test AUC: 0.9818
Averaged Test F1_score: 0.8931
Averaged Test Recal score: 0.9139
Std Test Accurancy: 0.1068
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.8807
Epoch: 0|  Loss:  1.0915 |Global loss: 5.7336| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.892
Epoch: 1|  Loss:  1.1033 |Global loss: 5.719| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.8654
Epoch: 2|  Loss:  1.0787 |Global loss: 5.7306| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.8762
Epoch: 3|  Loss:  1.1019 |Global loss: 5.7343| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 0|  NKD Loss: 0.8858
Epoch: 0|  Loss:  1.1585 |Global loss: 5.742| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.8827
Epoch: 1|  Loss:  1.1581 |Global loss: 5.7469| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 2|  NKD Loss: 0.9178
Epoch: 2|  Loss:  1.1897 |Global loss: 5.7255| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8897
Epoch: 3|  Loss:  1.1522 |Global loss: 5.7342| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 0|  NKD Loss: 0.9523
Epoch: 0|  Loss:  1.2932 |Global loss: 5.7936| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9694
Epoch: 1|  Loss:  1.3086 |Global loss: 5.7794| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9626
Epoch: 2|  Loss:  1.2937 |Global loss: 5.7915| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9576
Epoch: 3|  Loss:  1.288 |Global loss: 5.7924| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9243
Epoch: 0|  Loss:  1.1825 |Global loss: 5.7448| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9031
Epoch: 1|  Loss:  1.1664 |Global loss: 5.7583| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9035
Epoch: 2|  Loss:  1.166 |Global loss: 5.7648| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.9069
Epoch: 3|  Loss:  1.155 |Global loss: 5.7509| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.9135
Epoch: 0|  Loss:  1.1677 |Global loss: 5.751| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.9105
Epoch: 1|  Loss:  1.1656 |Global loss: 5.7484| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.9104
Epoch: 2|  Loss:  1.1672 |Global loss: 5.7523| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.9181
Epoch: 3|  Loss:  1.1736 |Global loss: 5.7518| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 0|  NKD Loss: 0.9147
Epoch: 0|  Loss:  1.1606 |Global loss: 5.7451| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9134
Epoch: 1|  Loss:  1.1584 |Global loss: 5.7441| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9003
Epoch: 2|  Loss:  1.1478 |Global loss: 5.7529| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9072
Epoch: 3|  Loss:  1.1528 |Global loss: 5.7534| Local H loss: 0.0359  | Global H loss: 0.0359
------------------------- time cost ------------------------- 2.931812047958374
Chosen Clients:  [8, 12, 3, 6, 0, 10]

-------------Round number: 369-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.917, 0.875, 0.975, 0.975, 0.983, 0.958, 0.983, 0.592, 0.85, 0.967]
AUC in each clients:  [116.427, 118.791, 117.512, 118.917, 118.101, 117.461, 117.265, 118.758, 119.026, 118.997, 118.142, 118.983, 114.956, 115.042, 118.975]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.912, 0.88, 0.971, 0.97, 0.981, 0.949, 0.98, 0.58, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.919, 0.903, 0.977, 0.977, 0.984, 0.956, 0.984, 0.639, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2850
Averaged Test Accurancy: 0.9017
Averaged Test AUC: 0.9819
Averaged Test F1_score: 0.8931
Averaged Test Recal score: 0.9139
Std Test Accurancy: 0.1068
Std Test AUC: 0.0112
Std Test F1: 0.0009
Std Test Recall: 0.0008
Epoch: 0|  NKD Loss: 0.9011
Epoch: 0|  Loss:  1.1447 |Global loss: 5.7574| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9068
Epoch: 1|  Loss:  1.1538 |Global loss: 5.7493| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9203
Epoch: 2|  Loss:  1.1641 |Global loss: 5.7411| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.9116
Epoch: 3|  Loss:  1.1593 |Global loss: 5.7443| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 1.0268
Epoch: 0|  Loss:  1.7332 |Global loss: 5.8306| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 1|  NKD Loss: 1.0231
Epoch: 1|  Loss:  1.735 |Global loss: 5.8271| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 2|  NKD Loss: 1.0181
Epoch: 2|  Loss:  1.7214 |Global loss: 5.836| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 1.0091
Epoch: 3|  Loss:  1.7159 |Global loss: 5.8391| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 0|  NKD Loss: 0.8997
Epoch: 0|  Loss:  1.1707 |Global loss: 5.7335| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 1|  NKD Loss: 0.8878
Epoch: 1|  Loss:  1.1526 |Global loss: 5.7415| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.9034
Epoch: 2|  Loss:  1.1768 |Global loss: 5.7343| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8827
Epoch: 3|  Loss:  1.1485 |Global loss: 5.743| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 0|  NKD Loss: 0.949
Epoch: 0|  Loss:  1.2915 |Global loss: 5.7732| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9495
Epoch: 1|  Loss:  1.2924 |Global loss: 5.7734| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9435
Epoch: 2|  Loss:  1.283 |Global loss: 5.7764| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9415
Epoch: 3|  Loss:  1.2797 |Global loss: 5.7723| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9514
Epoch: 0|  Loss:  1.3741 |Global loss: 5.7646| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9474
Epoch: 1|  Loss:  1.3614 |Global loss: 5.7662| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.9686
Epoch: 2|  Loss:  1.3872 |Global loss: 5.7513| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9358
Epoch: 3|  Loss:  1.3555 |Global loss: 5.769| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9103
Epoch: 0|  Loss:  1.1673 |Global loss: 5.754| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9288
Epoch: 1|  Loss:  1.179 |Global loss: 5.7442| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.9087
Epoch: 2|  Loss:  1.1692 |Global loss: 5.7548| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.927
Epoch: 3|  Loss:  1.1813 |Global loss: 5.7367| Local H loss: 0.0383  | Global H loss: 0.0383
------------------------- time cost ------------------------- 3.3383593559265137
Chosen Clients:  [7, 1, 4, 14, 0, 9]

-------------Round number: 370-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.917, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.967]
AUC in each clients:  [116.441, 118.791, 117.512, 118.923, 118.101, 117.461, 117.308, 118.758, 119.068, 118.997, 118.155, 118.983, 115.604, 115.042, 118.975]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.912, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.962]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.919, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.97]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2778
Averaged Test Accurancy: 0.9089
Averaged Test AUC: 0.9823
Averaged Test F1_score: 0.9020
Averaged Test Recal score: 0.9209
Std Test Accurancy: 0.0886
Std Test AUC: 0.0105
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.921
Epoch: 0|  Loss:  1.1828 |Global loss: 5.7596| Local H loss: 0.0412  | Global H loss: 0.0412
Epoch: 1|  NKD Loss: 0.9286
Epoch: 1|  Loss:  1.1963 |Global loss: 5.7561| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 2|  NKD Loss: 0.9107
Epoch: 2|  Loss:  1.1666 |Global loss: 5.764| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 3|  NKD Loss: 0.8907
Epoch: 3|  Loss:  1.1546 |Global loss: 5.7771| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 0|  NKD Loss: 0.9587
Epoch: 0|  Loss:  1.291 |Global loss: 5.7741| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9779
Epoch: 1|  Loss:  1.3171 |Global loss: 5.7755| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9554
Epoch: 2|  Loss:  1.2882 |Global loss: 5.7932| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9455
Epoch: 3|  Loss:  1.2725 |Global loss: 5.7999| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9182
Epoch: 0|  Loss:  1.3602 |Global loss: 5.7255| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.9228
Epoch: 1|  Loss:  1.3659 |Global loss: 5.7233| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 0.9187
Epoch: 2|  Loss:  1.3616 |Global loss: 5.7247| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9358
Epoch: 3|  Loss:  1.3815 |Global loss: 5.7115| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 0.9124
Epoch: 0|  Loss:  1.1572 |Global loss: 5.7479| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.9238
Epoch: 1|  Loss:  1.1715 |Global loss: 5.7351| Local H loss: 0.0288  | Global H loss: 0.0288
Epoch: 2|  NKD Loss: 0.9052
Epoch: 2|  Loss:  1.1539 |Global loss: 5.7577| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.9111
Epoch: 3|  Loss:  1.1667 |Global loss: 5.7545| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 0.9469
Epoch: 0|  Loss:  1.3688 |Global loss: 5.7655| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9417
Epoch: 1|  Loss:  1.3647 |Global loss: 5.7654| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9623
Epoch: 2|  Loss:  1.3678 |Global loss: 5.7553| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9421
Epoch: 3|  Loss:  1.3625 |Global loss: 5.7643| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.8678
Epoch: 0|  Loss:  1.0931 |Global loss: 5.7375| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.882
Epoch: 1|  Loss:  1.1069 |Global loss: 5.726| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.8897
Epoch: 2|  Loss:  1.1126 |Global loss: 5.7238| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.896
Epoch: 3|  Loss:  1.1222 |Global loss: 5.7125| Local H loss: 0.0283  | Global H loss: 0.0283
------------------------- time cost ------------------------- 2.9238500595092773
Chosen Clients:  [11, 0, 4, 10, 5, 3]

-------------Round number: 371-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.917, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.491, 118.826, 117.512, 118.923, 118.094, 117.461, 117.308, 118.723, 119.068, 118.986, 118.155, 118.983, 115.604, 115.042, 119.038]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.766, 0.912, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.817, 0.919, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2848
Averaged Test Accurancy: 0.9100
Averaged Test AUC: 0.9823
Averaged Test F1_score: 0.9029
Averaged Test Recal score: 0.9219
Std Test Accurancy: 0.0886
Std Test AUC: 0.0105
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8886
Epoch: 0|  Loss:  1.1224 |Global loss: 5.7452| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9013
Epoch: 1|  Loss:  1.1364 |Global loss: 5.7306| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.9086
Epoch: 2|  Loss:  1.1366 |Global loss: 5.7312| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.9004
Epoch: 3|  Loss:  1.1338 |Global loss: 5.7361| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.9273
Epoch: 0|  Loss:  1.3417 |Global loss: 5.7815| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9499
Epoch: 1|  Loss:  1.3617 |Global loss: 5.7677| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9567
Epoch: 2|  Loss:  1.3736 |Global loss: 5.7592| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9385
Epoch: 3|  Loss:  1.3562 |Global loss: 5.7647| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.927
Epoch: 0|  Loss:  1.3667 |Global loss: 5.7237| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.929
Epoch: 1|  Loss:  1.3711 |Global loss: 5.7173| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.9322
Epoch: 2|  Loss:  1.3791 |Global loss: 5.7155| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 0.9296
Epoch: 3|  Loss:  1.3777 |Global loss: 5.7139| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 0.9185
Epoch: 0|  Loss:  1.1774 |Global loss: 5.7462| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.8989
Epoch: 1|  Loss:  1.1601 |Global loss: 5.766| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.904
Epoch: 2|  Loss:  1.162 |Global loss: 5.7586| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.9029
Epoch: 3|  Loss:  1.1624 |Global loss: 5.7541| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.9836
Epoch: 0|  Loss:  1.3709 |Global loss: 5.7831| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9869
Epoch: 1|  Loss:  1.391 |Global loss: 5.7836| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9508
Epoch: 2|  Loss:  1.332 |Global loss: 5.812| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9792
Epoch: 3|  Loss:  1.379 |Global loss: 5.7927| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9093
Epoch: 0|  Loss:  1.1761 |Global loss: 5.7292| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 1|  NKD Loss: 0.9085
Epoch: 1|  Loss:  1.1799 |Global loss: 5.7232| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.9039
Epoch: 2|  Loss:  1.1701 |Global loss: 5.7258| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 3|  NKD Loss: 0.8909
Epoch: 3|  Loss:  1.159 |Global loss: 5.737| Local H loss: 0.0407  | Global H loss: 0.0407
------------------------- time cost ------------------------- 3.2340919971466064
Chosen Clients:  [11, 4, 13, 0, 5, 10]

-------------Round number: 372-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.908, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.432, 118.826, 117.512, 118.932, 118.103, 117.431, 117.308, 118.723, 119.068, 118.986, 118.197, 119.016, 115.604, 115.042, 119.038]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.903, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.909, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2905
Averaged Test Accurancy: 0.9089
Averaged Test AUC: 0.9823
Averaged Test F1_score: 0.9020
Averaged Test Recal score: 0.9207
Std Test Accurancy: 0.0890
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9134
Epoch: 0|  Loss:  1.1367 |Global loss: 5.7202| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 1|  NKD Loss: 0.9091
Epoch: 1|  Loss:  1.1404 |Global loss: 5.7216| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.9102
Epoch: 2|  Loss:  1.1454 |Global loss: 5.7251| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.9161
Epoch: 3|  Loss:  1.1457 |Global loss: 5.7183| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9228
Epoch: 0|  Loss:  1.3708 |Global loss: 5.7231| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 1|  NKD Loss: 0.9243
Epoch: 1|  Loss:  1.3652 |Global loss: 5.7183| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 2|  NKD Loss: 0.9126
Epoch: 2|  Loss:  1.3549 |Global loss: 5.7249| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9255
Epoch: 3|  Loss:  1.3807 |Global loss: 5.7204| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 0.9442
Epoch: 0|  Loss:  1.4297 |Global loss: 5.7679| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.9423
Epoch: 1|  Loss:  1.4207 |Global loss: 5.7642| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.9471
Epoch: 2|  Loss:  1.4412 |Global loss: 5.7574| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.9511
Epoch: 3|  Loss:  1.4425 |Global loss: 5.7629| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9432
Epoch: 0|  Loss:  1.3637 |Global loss: 5.7698| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9573
Epoch: 1|  Loss:  1.3742 |Global loss: 5.7559| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9499
Epoch: 2|  Loss:  1.3683 |Global loss: 5.7629| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9521
Epoch: 3|  Loss:  1.3606 |Global loss: 5.758| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9653
Epoch: 0|  Loss:  1.3687 |Global loss: 5.7957| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9612
Epoch: 1|  Loss:  1.3631 |Global loss: 5.801| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9552
Epoch: 2|  Loss:  1.3572 |Global loss: 5.7983| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9788
Epoch: 3|  Loss:  1.3747 |Global loss: 5.7941| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9015
Epoch: 0|  Loss:  1.1564 |Global loss: 5.7605| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.933
Epoch: 1|  Loss:  1.1917 |Global loss: 5.737| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.9248
Epoch: 2|  Loss:  1.1783 |Global loss: 5.7424| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.8982
Epoch: 3|  Loss:  1.1564 |Global loss: 5.7603| Local H loss: 0.0373  | Global H loss: 0.0373
------------------------- time cost ------------------------- 2.971041202545166
Chosen Clients:  [2, 9, 5, 7, 13, 8]

-------------Round number: 373-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.441, 118.826, 117.512, 118.932, 118.095, 117.498, 117.308, 118.723, 119.068, 118.986, 118.177, 118.887, 115.604, 114.939, 119.038]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.851, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.925, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2832
Averaged Test Accurancy: 0.9100
Averaged Test AUC: 0.9822
Averaged Test F1_score: 0.9035
Averaged Test Recal score: 0.9218
Std Test Accurancy: 0.0891
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.97
Epoch: 0|  Loss:  1.318 |Global loss: 5.8079| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.972
Epoch: 1|  Loss:  1.3289 |Global loss: 5.8207| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9792
Epoch: 2|  Loss:  1.3406 |Global loss: 5.8001| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9426
Epoch: 3|  Loss:  1.2843 |Global loss: 5.8259| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.8921
Epoch: 0|  Loss:  1.1161 |Global loss: 5.7221| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.8989
Epoch: 1|  Loss:  1.1211 |Global loss: 5.7174| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.8852
Epoch: 2|  Loss:  1.1091 |Global loss: 5.724| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.8851
Epoch: 3|  Loss:  1.1096 |Global loss: 5.7208| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9647
Epoch: 0|  Loss:  1.3678 |Global loss: 5.8002| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9691
Epoch: 1|  Loss:  1.3683 |Global loss: 5.7958| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9654
Epoch: 2|  Loss:  1.3611 |Global loss: 5.7969| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9712
Epoch: 3|  Loss:  1.3692 |Global loss: 5.7929| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9193
Epoch: 0|  Loss:  1.1866 |Global loss: 5.759| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 1|  NKD Loss: 0.9242
Epoch: 1|  Loss:  1.1894 |Global loss: 5.7533| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 2|  NKD Loss: 0.9079
Epoch: 2|  Loss:  1.1678 |Global loss: 5.7633| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.9208
Epoch: 3|  Loss:  1.1804 |Global loss: 5.7561| Local H loss: 0.0414  | Global H loss: 0.0414
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.4329 |Global loss: 5.7672| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9481
Epoch: 1|  Loss:  1.4319 |Global loss: 5.76| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.9313
Epoch: 2|  Loss:  1.4011 |Global loss: 5.7721| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9515
Epoch: 3|  Loss:  1.4411 |Global loss: 5.7613| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.9249
Epoch: 0|  Loss:  1.1689 |Global loss: 5.7353| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9187
Epoch: 1|  Loss:  1.1601 |Global loss: 5.741| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9206
Epoch: 2|  Loss:  1.1527 |Global loss: 5.7299| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9037
Epoch: 3|  Loss:  1.1433 |Global loss: 5.7519| Local H loss: 0.0358  | Global H loss: 0.0358
------------------------- time cost ------------------------- 2.7093842029571533
Chosen Clients:  [14, 2, 9, 1, 5, 11]

-------------Round number: 374-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.925, 0.883, 0.975, 0.967, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.441, 118.826, 117.555, 118.932, 118.095, 117.503, 117.308, 118.739, 118.988, 118.996, 118.177, 118.887, 115.604, 114.925, 119.038]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.921, 0.888, 0.971, 0.961, 0.981, 0.949, 0.98, 0.705, 0.851, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.928, 0.908, 0.977, 0.968, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2760
Averaged Test Accurancy: 0.9094
Averaged Test AUC: 0.9822
Averaged Test F1_score: 0.9029
Averaged Test Recal score: 0.9214
Std Test Accurancy: 0.0887
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9276
Epoch: 0|  Loss:  1.1827 |Global loss: 5.738| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 1|  NKD Loss: 0.9207
Epoch: 1|  Loss:  1.1698 |Global loss: 5.7452| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 2|  NKD Loss: 0.9188
Epoch: 2|  Loss:  1.173 |Global loss: 5.7463| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 3|  NKD Loss: 0.9089
Epoch: 3|  Loss:  1.1591 |Global loss: 5.7475| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 0|  NKD Loss: 0.9719
Epoch: 0|  Loss:  1.3213 |Global loss: 5.805| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.958
Epoch: 1|  Loss:  1.303 |Global loss: 5.8082| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9807
Epoch: 2|  Loss:  1.3362 |Global loss: 5.8047| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9351
Epoch: 3|  Loss:  1.2784 |Global loss: 5.8244| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8948
Epoch: 0|  Loss:  1.1163 |Global loss: 5.719| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 1|  NKD Loss: 0.8953
Epoch: 1|  Loss:  1.1188 |Global loss: 5.7168| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.8875
Epoch: 2|  Loss:  1.105 |Global loss: 5.7215| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.8765
Epoch: 3|  Loss:  1.0999 |Global loss: 5.7273| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9744
Epoch: 0|  Loss:  1.2872 |Global loss: 5.7808| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9478
Epoch: 1|  Loss:  1.2743 |Global loss: 5.7939| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9504
Epoch: 2|  Loss:  1.2583 |Global loss: 5.7875| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.951
Epoch: 3|  Loss:  1.2849 |Global loss: 5.7909| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9713
Epoch: 0|  Loss:  1.3549 |Global loss: 5.7881| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9681
Epoch: 1|  Loss:  1.3548 |Global loss: 5.7892| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9708
Epoch: 2|  Loss:  1.3687 |Global loss: 5.7944| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9509
Epoch: 3|  Loss:  1.3369 |Global loss: 5.7991| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8825
Epoch: 0|  Loss:  1.0995 |Global loss: 5.7392| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.9148
Epoch: 1|  Loss:  1.1269 |Global loss: 5.7264| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.879
Epoch: 2|  Loss:  1.1088 |Global loss: 5.7452| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 0.9079
Epoch: 3|  Loss:  1.1403 |Global loss: 5.7316| Local H loss: 0.0259  | Global H loss: 0.0259
------------------------- time cost ------------------------- 3.1842563152313232
Chosen Clients:  [10, 8, 7, 11, 13, 0]

-------------Round number: 375-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.925, 0.983, 0.833, 0.925, 0.883, 0.975, 0.967, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.441, 118.883, 117.571, 118.932, 118.095, 117.53, 117.308, 118.739, 118.988, 118.993, 118.177, 118.986, 115.604, 114.925, 119.055]
F1 Score:  [0.748, 0.971, 0.925, 0.982, 0.761, 0.921, 0.888, 0.971, 0.961, 0.981, 0.949, 0.98, 0.705, 0.851, 0.971]
Recall Score:  [0.809, 0.977, 0.942, 0.986, 0.81, 0.928, 0.908, 0.977, 0.968, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2772
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9823
Averaged Test F1_score: 0.9043
Averaged Test Recal score: 0.9226
Std Test Accurancy: 0.0888
Std Test AUC: 0.0107
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9133
Epoch: 0|  Loss:  1.1706 |Global loss: 5.7477| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.1692 |Global loss: 5.7471| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 2|  NKD Loss: 0.8982
Epoch: 2|  Loss:  1.1508 |Global loss: 5.7584| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.926
Epoch: 3|  Loss:  1.1768 |Global loss: 5.7428| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.9244
Epoch: 0|  Loss:  1.163 |Global loss: 5.7414| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9037
Epoch: 1|  Loss:  1.1472 |Global loss: 5.7518| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9244
Epoch: 2|  Loss:  1.1665 |Global loss: 5.7338| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.8684
Epoch: 3|  Loss:  1.1089 |Global loss: 5.7706| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9051
Epoch: 0|  Loss:  1.1726 |Global loss: 5.7701| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.9171
Epoch: 1|  Loss:  1.18 |Global loss: 5.7597| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.8952
Epoch: 2|  Loss:  1.159 |Global loss: 5.7685| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1646 |Global loss: 5.7689| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9057
Epoch: 0|  Loss:  1.1365 |Global loss: 5.7155| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8978
Epoch: 1|  Loss:  1.1308 |Global loss: 5.7348| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.8975
Epoch: 2|  Loss:  1.1296 |Global loss: 5.7318| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.8973
Epoch: 3|  Loss:  1.125 |Global loss: 5.733| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.9472
Epoch: 0|  Loss:  1.4457 |Global loss: 5.7595| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9169
Epoch: 1|  Loss:  1.3988 |Global loss: 5.7858| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.9279
Epoch: 2|  Loss:  1.4153 |Global loss: 5.7708| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9469
Epoch: 3|  Loss:  1.4249 |Global loss: 5.7604| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9398
Epoch: 0|  Loss:  1.3515 |Global loss: 5.7656| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9569
Epoch: 1|  Loss:  1.3656 |Global loss: 5.7532| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9533
Epoch: 2|  Loss:  1.3615 |Global loss: 5.761| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9674
Epoch: 3|  Loss:  1.3868 |Global loss: 5.7527| Local H loss: 0.0251  | Global H loss: 0.0251
------------------------- time cost ------------------------- 2.8558950424194336
Chosen Clients:  [8, 2, 1, 11, 3, 4]

-------------Round number: 376-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.925, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.491, 118.883, 117.571, 118.932, 118.095, 117.53, 117.308, 118.823, 119.024, 118.993, 118.195, 119.016, 115.604, 114.996, 119.055]
F1 Score:  [0.748, 0.971, 0.925, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.942, 0.986, 0.81, 0.928, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2702
Averaged Test Accurancy: 0.9111
Averaged Test AUC: 0.9825
Averaged Test F1_score: 0.9047
Averaged Test Recal score: 0.9232
Std Test Accurancy: 0.0892
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8978
Epoch: 0|  Loss:  1.1384 |Global loss: 5.7506| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.8989
Epoch: 1|  Loss:  1.1404 |Global loss: 5.754| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.8969
Epoch: 2|  Loss:  1.1396 |Global loss: 5.7505| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9178
Epoch: 3|  Loss:  1.1556 |Global loss: 5.7373| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9849
Epoch: 0|  Loss:  1.3253 |Global loss: 5.7918| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9702
Epoch: 1|  Loss:  1.3228 |Global loss: 5.8123| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9513
Epoch: 2|  Loss:  1.2958 |Global loss: 5.812| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9612
Epoch: 3|  Loss:  1.3137 |Global loss: 5.8208| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9498
Epoch: 0|  Loss:  1.2803 |Global loss: 5.7904| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.955
Epoch: 1|  Loss:  1.2865 |Global loss: 5.7877| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9606
Epoch: 2|  Loss:  1.2937 |Global loss: 5.7884| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9622
Epoch: 3|  Loss:  1.2918 |Global loss: 5.7832| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.1322 |Global loss: 5.7277| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8839
Epoch: 1|  Loss:  1.1096 |Global loss: 5.7465| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9026
Epoch: 2|  Loss:  1.1276 |Global loss: 5.7254| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 0.8984
Epoch: 3|  Loss:  1.1273 |Global loss: 5.7352| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.8991
Epoch: 0|  Loss:  1.1671 |Global loss: 5.729| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 1|  NKD Loss: 0.8788
Epoch: 1|  Loss:  1.1471 |Global loss: 5.7441| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.901
Epoch: 2|  Loss:  1.1596 |Global loss: 5.7317| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 3|  NKD Loss: 0.8748
Epoch: 3|  Loss:  1.1431 |Global loss: 5.7458| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 0|  NKD Loss: 0.8947
Epoch: 0|  Loss:  1.3289 |Global loss: 5.742| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.9062
Epoch: 1|  Loss:  1.3448 |Global loss: 5.7322| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 0.9165
Epoch: 2|  Loss:  1.3591 |Global loss: 5.7271| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9338
Epoch: 3|  Loss:  1.3784 |Global loss: 5.7145| Local H loss: 0.024  | Global H loss: 0.024
------------------------- time cost ------------------------- 2.940262794494629
Chosen Clients:  [14, 12, 1, 6, 9, 2]

-------------Round number: 377-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.491, 118.782, 117.505, 118.945, 118.1, 117.53, 117.308, 118.823, 118.998, 118.993, 118.195, 118.952, 115.604, 114.996, 119.055]
F1 Score:  [0.748, 0.971, 0.894, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.914, 0.986, 0.81, 0.928, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.739, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2698
Averaged Test Accurancy: 0.9089
Averaged Test AUC: 0.9824
Averaged Test F1_score: 0.9026
Averaged Test Recal score: 0.9213
Std Test Accurancy: 0.0892
Std Test AUC: 0.0105
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9101
Epoch: 0|  Loss:  1.1529 |Global loss: 5.7476| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9102
Epoch: 1|  Loss:  1.1637 |Global loss: 5.7498| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.9022
Epoch: 2|  Loss:  1.1495 |Global loss: 5.7503| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9082
Epoch: 3|  Loss:  1.1611 |Global loss: 5.7516| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 1.0061
Epoch: 0|  Loss:  1.7155 |Global loss: 5.8448| Local H loss: 0.0421  | Global H loss: 0.0421
Epoch: 1|  NKD Loss: 1.0157
Epoch: 1|  Loss:  1.7165 |Global loss: 5.8273| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 2|  NKD Loss: 1.0187
Epoch: 2|  Loss:  1.7197 |Global loss: 5.8353| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 3|  NKD Loss: 1.0151
Epoch: 3|  Loss:  1.7246 |Global loss: 5.8408| Local H loss: 0.0426  | Global H loss: 0.0426
Epoch: 0|  NKD Loss: 0.9357
Epoch: 0|  Loss:  1.267 |Global loss: 5.8002| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9599
Epoch: 1|  Loss:  1.2868 |Global loss: 5.7864| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9632
Epoch: 2|  Loss:  1.2894 |Global loss: 5.7742| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9688
Epoch: 3|  Loss:  1.2946 |Global loss: 5.7773| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9555
Epoch: 0|  Loss:  1.2969 |Global loss: 5.7643| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9391
Epoch: 1|  Loss:  1.2586 |Global loss: 5.7714| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9568
Epoch: 2|  Loss:  1.2888 |Global loss: 5.7662| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.954
Epoch: 3|  Loss:  1.2889 |Global loss: 5.7611| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8862
Epoch: 0|  Loss:  1.1082 |Global loss: 5.7226| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.8798
Epoch: 1|  Loss:  1.1025 |Global loss: 5.7252| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9067
Epoch: 2|  Loss:  1.1295 |Global loss: 5.7049| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.887
Epoch: 3|  Loss:  1.1092 |Global loss: 5.7148| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.967
Epoch: 0|  Loss:  1.3181 |Global loss: 5.8076| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9425
Epoch: 1|  Loss:  1.2844 |Global loss: 5.8265| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9599
Epoch: 2|  Loss:  1.301 |Global loss: 5.8006| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9591
Epoch: 3|  Loss:  1.2991 |Global loss: 5.8175| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 3.028179407119751
Chosen Clients:  [8, 14, 3, 13, 0, 10]

-------------Round number: 378-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.675, 0.85, 0.975]
AUC in each clients:  [116.491, 118.973, 117.686, 118.945, 118.1, 117.53, 117.317, 118.823, 118.998, 118.99, 118.195, 118.952, 115.582, 114.996, 119.092]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.693, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.928, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.727, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2702
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9826
Averaged Test F1_score: 0.9043
Averaged Test Recal score: 0.9229
Std Test Accurancy: 0.0921
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9075
Epoch: 0|  Loss:  1.1485 |Global loss: 5.7443| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.8833
Epoch: 1|  Loss:  1.1243 |Global loss: 5.7536| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.9017
Epoch: 2|  Loss:  1.1398 |Global loss: 5.7499| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.888
Epoch: 3|  Loss:  1.1296 |Global loss: 5.7597| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.1612 |Global loss: 5.741| Local H loss: 0.0286  | Global H loss: 0.0286
Epoch: 1|  NKD Loss: 0.9124
Epoch: 1|  Loss:  1.1564 |Global loss: 5.7397| Local H loss: 0.0287  | Global H loss: 0.0287
Epoch: 2|  NKD Loss: 0.9068
Epoch: 2|  Loss:  1.1574 |Global loss: 5.7513| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.8991
Epoch: 3|  Loss:  1.1413 |Global loss: 5.7553| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.8754
Epoch: 0|  Loss:  1.1409 |Global loss: 5.7443| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.8976
Epoch: 1|  Loss:  1.1634 |Global loss: 5.7354| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.8992
Epoch: 2|  Loss:  1.1634 |Global loss: 5.7338| Local H loss: 0.0411  | Global H loss: 0.0411
Epoch: 3|  NKD Loss: 0.881
Epoch: 3|  Loss:  1.1481 |Global loss: 5.7443| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.9382
Epoch: 0|  Loss:  1.4034 |Global loss: 5.7648| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9271
Epoch: 1|  Loss:  1.411 |Global loss: 5.7719| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.9352
Epoch: 2|  Loss:  1.3948 |Global loss: 5.7682| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.9492
Epoch: 3|  Loss:  1.4197 |Global loss: 5.7564| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9491
Epoch: 0|  Loss:  1.3566 |Global loss: 5.7646| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9348
Epoch: 1|  Loss:  1.3437 |Global loss: 5.7699| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.95
Epoch: 2|  Loss:  1.3525 |Global loss: 5.7631| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9536
Epoch: 3|  Loss:  1.3689 |Global loss: 5.7591| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9056
Epoch: 0|  Loss:  1.1622 |Global loss: 5.7504| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.926
Epoch: 1|  Loss:  1.1804 |Global loss: 5.7427| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.9058
Epoch: 2|  Loss:  1.1597 |Global loss: 5.754| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.8983
Epoch: 3|  Loss:  1.1549 |Global loss: 5.7598| Local H loss: 0.0376  | Global H loss: 0.0376
------------------------- time cost ------------------------- 3.0444843769073486
Chosen Clients:  [7, 2, 8, 1, 6, 14]

-------------Round number: 379-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.675, 0.85, 0.975]
AUC in each clients:  [116.531, 118.973, 117.686, 118.944, 118.1, 117.53, 117.317, 118.823, 119.072, 118.99, 118.185, 118.952, 115.582, 114.968, 119.071]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.693, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.928, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.727, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2700
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9826
Averaged Test F1_score: 0.9043
Averaged Test Recal score: 0.9229
Std Test Accurancy: 0.0921
Std Test AUC: 0.0107
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9189
Epoch: 0|  Loss:  1.1807 |Global loss: 5.7594| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 1|  NKD Loss: 0.9093
Epoch: 1|  Loss:  1.1696 |Global loss: 5.7566| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.9231
Epoch: 2|  Loss:  1.1829 |Global loss: 5.7532| Local H loss: 0.041  | Global H loss: 0.041
Epoch: 3|  NKD Loss: 0.9102
Epoch: 3|  Loss:  1.1708 |Global loss: 5.7654| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 0|  NKD Loss: 0.9644
Epoch: 0|  Loss:  1.3071 |Global loss: 5.8018| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9503
Epoch: 1|  Loss:  1.2885 |Global loss: 5.8172| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9526
Epoch: 2|  Loss:  1.2934 |Global loss: 5.8132| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9554
Epoch: 3|  Loss:  1.2962 |Global loss: 5.811| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9097
Epoch: 0|  Loss:  1.1476 |Global loss: 5.7431| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.8776
Epoch: 1|  Loss:  1.1102 |Global loss: 5.7564| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.896
Epoch: 2|  Loss:  1.137 |Global loss: 5.7522| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.897
Epoch: 3|  Loss:  1.1367 |Global loss: 5.7493| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9545
Epoch: 0|  Loss:  1.2765 |Global loss: 5.7857| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9578
Epoch: 1|  Loss:  1.2781 |Global loss: 5.7816| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9498
Epoch: 2|  Loss:  1.2743 |Global loss: 5.7885| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.2628 |Global loss: 5.786| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9476
Epoch: 0|  Loss:  1.2877 |Global loss: 5.7692| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9408
Epoch: 1|  Loss:  1.2703 |Global loss: 5.7724| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9334
Epoch: 2|  Loss:  1.2664 |Global loss: 5.7751| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9614
Epoch: 3|  Loss:  1.2967 |Global loss: 5.7624| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.902
Epoch: 0|  Loss:  1.1496 |Global loss: 5.7516| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9093
Epoch: 1|  Loss:  1.1541 |Global loss: 5.7511| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.9003
Epoch: 2|  Loss:  1.1403 |Global loss: 5.7541| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 3|  NKD Loss: 0.9196
Epoch: 3|  Loss:  1.1574 |Global loss: 5.7362| Local H loss: 0.0285  | Global H loss: 0.0285
------------------------- time cost ------------------------- 3.052342176437378
Chosen Clients:  [12, 9, 3, 5, 7, 1]

-------------Round number: 380-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.675, 0.85, 0.975]
AUC in each clients:  [116.531, 118.867, 117.706, 118.944, 118.1, 117.53, 117.32, 118.841, 119.07, 118.99, 118.185, 118.952, 115.582, 114.968, 119.084]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.921, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.693, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.928, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.727, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2654
Averaged Test Accurancy: 0.9089
Averaged Test AUC: 0.9826
Averaged Test F1_score: 0.9024
Averaged Test Recal score: 0.9212
Std Test Accurancy: 0.0919
Std Test AUC: 0.0106
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0035
Epoch: 0|  Loss:  1.7203 |Global loss: 5.8479| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 1|  NKD Loss: 1.021
Epoch: 1|  Loss:  1.7274 |Global loss: 5.8296| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 1.0087
Epoch: 2|  Loss:  1.703 |Global loss: 5.837| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 3|  NKD Loss: 1.0101
Epoch: 3|  Loss:  1.7314 |Global loss: 5.8325| Local H loss: 0.0427  | Global H loss: 0.0427
Epoch: 0|  NKD Loss: 0.8664
Epoch: 0|  Loss:  1.0802 |Global loss: 5.7358| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.8961
Epoch: 1|  Loss:  1.1171 |Global loss: 5.7177| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.8823
Epoch: 2|  Loss:  1.104 |Global loss: 5.7224| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.8774
Epoch: 3|  Loss:  1.0967 |Global loss: 5.7252| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.894
Epoch: 0|  Loss:  1.158 |Global loss: 5.7349| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 1|  NKD Loss: 0.9076
Epoch: 1|  Loss:  1.1629 |Global loss: 5.7195| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 2|  NKD Loss: 0.8841
Epoch: 2|  Loss:  1.1482 |Global loss: 5.7405| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.8915
Epoch: 3|  Loss:  1.1536 |Global loss: 5.7308| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 0.9778
Epoch: 0|  Loss:  1.3774 |Global loss: 5.794| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9717
Epoch: 1|  Loss:  1.3673 |Global loss: 5.791| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9631
Epoch: 2|  Loss:  1.3564 |Global loss: 5.7944| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9645
Epoch: 3|  Loss:  1.3569 |Global loss: 5.7931| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9069
Epoch: 0|  Loss:  1.1674 |Global loss: 5.7608| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 1|  NKD Loss: 0.9146
Epoch: 1|  Loss:  1.1717 |Global loss: 5.76| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 2|  NKD Loss: 0.8917
Epoch: 2|  Loss:  1.1526 |Global loss: 5.7671| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.9142
Epoch: 3|  Loss:  1.1729 |Global loss: 5.7593| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.9631
Epoch: 0|  Loss:  1.2824 |Global loss: 5.78| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9437
Epoch: 1|  Loss:  1.2595 |Global loss: 5.7819| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.945
Epoch: 2|  Loss:  1.2607 |Global loss: 5.789| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9581
Epoch: 3|  Loss:  1.272 |Global loss: 5.7837| Local H loss: 0.0279  | Global H loss: 0.0279
------------------------- time cost ------------------------- 2.7958927154541016
Chosen Clients:  [0, 9, 2, 7, 1, 6]

-------------Round number: 381-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.531, 118.858, 117.706, 118.938, 118.1, 117.614, 117.32, 118.807, 119.07, 118.997, 118.185, 118.952, 115.761, 114.968, 119.084]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.917, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.93, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2645
Averaged Test Accurancy: 0.9117
Averaged Test AUC: 0.9827
Averaged Test F1_score: 0.9035
Averaged Test Recal score: 0.9233
Std Test Accurancy: 0.0851
Std Test AUC: 0.0104
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9264
Epoch: 0|  Loss:  1.3267 |Global loss: 5.778| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.941
Epoch: 1|  Loss:  1.349 |Global loss: 5.7636| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9486
Epoch: 2|  Loss:  1.3494 |Global loss: 5.7553| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9531
Epoch: 3|  Loss:  1.3597 |Global loss: 5.7605| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.9027
Epoch: 0|  Loss:  1.122 |Global loss: 5.7151| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.8819
Epoch: 1|  Loss:  1.1036 |Global loss: 5.7231| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.8768
Epoch: 2|  Loss:  1.097 |Global loss: 5.7273| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.8707
Epoch: 3|  Loss:  1.0916 |Global loss: 5.7271| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9513
Epoch: 0|  Loss:  1.2903 |Global loss: 5.8076| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9612
Epoch: 1|  Loss:  1.2798 |Global loss: 5.8015| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9673
Epoch: 2|  Loss:  1.2951 |Global loss: 5.8046| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.9499
Epoch: 3|  Loss:  1.2832 |Global loss: 5.811| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9003
Epoch: 0|  Loss:  1.1535 |Global loss: 5.7652| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 0.8973
Epoch: 1|  Loss:  1.1462 |Global loss: 5.7626| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 2|  NKD Loss: 0.9061
Epoch: 2|  Loss:  1.1596 |Global loss: 5.7586| Local H loss: 0.0404  | Global H loss: 0.0404
Epoch: 3|  NKD Loss: 0.8914
Epoch: 3|  Loss:  1.148 |Global loss: 5.768| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.9427
Epoch: 0|  Loss:  1.2635 |Global loss: 5.7885| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9311
Epoch: 1|  Loss:  1.2495 |Global loss: 5.7803| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9311
Epoch: 2|  Loss:  1.2468 |Global loss: 5.7939| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.9414
Epoch: 3|  Loss:  1.2522 |Global loss: 5.7884| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9381
Epoch: 0|  Loss:  1.2752 |Global loss: 5.7734| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9164
Epoch: 1|  Loss:  1.253 |Global loss: 5.7894| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9581
Epoch: 2|  Loss:  1.2891 |Global loss: 5.7592| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9388
Epoch: 3|  Loss:  1.2692 |Global loss: 5.7777| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 3.0219147205352783
Chosen Clients:  [0, 13, 10, 11, 7, 8]

-------------Round number: 382-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.521, 118.983, 117.711, 118.938, 118.1, 117.614, 117.377, 118.863, 119.07, 119.002, 118.185, 118.952, 115.761, 114.968, 119.084]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.761, 0.917, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.81, 0.93, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2673
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9828
Averaged Test F1_score: 0.9028
Averaged Test Recal score: 0.9226
Std Test Accurancy: 0.0853
Std Test AUC: 0.0105
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9277
Epoch: 0|  Loss:  1.3109 |Global loss: 5.7678| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9342
Epoch: 1|  Loss:  1.3373 |Global loss: 5.7664| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9639
Epoch: 2|  Loss:  1.3722 |Global loss: 5.7505| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9304
Epoch: 3|  Loss:  1.3368 |Global loss: 5.7716| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9273
Epoch: 0|  Loss:  1.3997 |Global loss: 5.7707| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.9222
Epoch: 1|  Loss:  1.4059 |Global loss: 5.772| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.9488
Epoch: 2|  Loss:  1.4168 |Global loss: 5.763| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.4358 |Global loss: 5.7519| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9116
Epoch: 0|  Loss:  1.1666 |Global loss: 5.7514| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.9036
Epoch: 1|  Loss:  1.1503 |Global loss: 5.7557| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.8943
Epoch: 2|  Loss:  1.1463 |Global loss: 5.7545| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9044
Epoch: 3|  Loss:  1.1594 |Global loss: 5.7581| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.9011
Epoch: 0|  Loss:  1.1332 |Global loss: 5.7324| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.888
Epoch: 1|  Loss:  1.1195 |Global loss: 5.7403| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8954
Epoch: 2|  Loss:  1.1267 |Global loss: 5.7371| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.9138
Epoch: 3|  Loss:  1.1398 |Global loss: 5.7204| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.913
Epoch: 0|  Loss:  1.1666 |Global loss: 5.7542| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.9103
Epoch: 1|  Loss:  1.1639 |Global loss: 5.7549| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.911
Epoch: 2|  Loss:  1.1657 |Global loss: 5.7589| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 3|  NKD Loss: 0.9038
Epoch: 3|  Loss:  1.1576 |Global loss: 5.7593| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 0|  NKD Loss: 0.9044
Epoch: 0|  Loss:  1.139 |Global loss: 5.7413| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.8967
Epoch: 1|  Loss:  1.1227 |Global loss: 5.7437| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.8938
Epoch: 2|  Loss:  1.1309 |Global loss: 5.7514| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.9123
Epoch: 3|  Loss:  1.1508 |Global loss: 5.7307| Local H loss: 0.0356  | Global H loss: 0.0356
------------------------- time cost ------------------------- 2.76080322265625
Chosen Clients:  [9, 13, 7, 14, 4, 1]

-------------Round number: 383-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.592, 118.983, 117.711, 118.938, 118.1, 117.614, 117.377, 118.843, 119.089, 119.002, 118.205, 119.032, 115.761, 115.201, 119.084]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.761, 0.917, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.81, 0.93, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2619
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9831
Averaged Test F1_score: 0.9028
Averaged Test Recal score: 0.9226
Std Test Accurancy: 0.0853
Std Test AUC: 0.0102
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8801
Epoch: 0|  Loss:  1.0853 |Global loss: 5.7228| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.8762
Epoch: 1|  Loss:  1.0976 |Global loss: 5.7215| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.8639
Epoch: 2|  Loss:  1.0823 |Global loss: 5.7391| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.8639
Epoch: 3|  Loss:  1.0834 |Global loss: 5.7327| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9228
Epoch: 0|  Loss:  1.3865 |Global loss: 5.7735| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9476
Epoch: 1|  Loss:  1.403 |Global loss: 5.7575| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.947
Epoch: 2|  Loss:  1.4151 |Global loss: 5.7547| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.912
Epoch: 3|  Loss:  1.3879 |Global loss: 5.777| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9049
Epoch: 0|  Loss:  1.1543 |Global loss: 5.756| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.158 |Global loss: 5.757| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 2|  NKD Loss: 0.911
Epoch: 2|  Loss:  1.1621 |Global loss: 5.7523| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 3|  NKD Loss: 0.8839
Epoch: 3|  Loss:  1.1354 |Global loss: 5.7687| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 0|  NKD Loss: 0.9084
Epoch: 0|  Loss:  1.1575 |Global loss: 5.749| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.1585 |Global loss: 5.7369| Local H loss: 0.0285  | Global H loss: 0.0285
Epoch: 2|  NKD Loss: 0.9003
Epoch: 2|  Loss:  1.1473 |Global loss: 5.7535| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.898
Epoch: 3|  Loss:  1.1383 |Global loss: 5.7518| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9017
Epoch: 0|  Loss:  1.3378 |Global loss: 5.7389| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 1|  NKD Loss: 0.9211
Epoch: 1|  Loss:  1.3633 |Global loss: 5.7239| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 0.9155
Epoch: 2|  Loss:  1.3606 |Global loss: 5.7245| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 3|  NKD Loss: 0.9293
Epoch: 3|  Loss:  1.36 |Global loss: 5.712| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 0.9625
Epoch: 0|  Loss:  1.2749 |Global loss: 5.7702| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9512
Epoch: 1|  Loss:  1.2617 |Global loss: 5.7785| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9249
Epoch: 2|  Loss:  1.2398 |Global loss: 5.7953| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9565
Epoch: 3|  Loss:  1.2693 |Global loss: 5.7789| Local H loss: 0.0279  | Global H loss: 0.0279
------------------------- time cost ------------------------- 2.62288236618042
Chosen Clients:  [5, 9, 1, 14, 0, 7]

-------------Round number: 384-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.925, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.592, 118.92, 117.711, 118.938, 118.092, 117.614, 117.377, 118.844, 119.089, 118.998, 118.205, 119.032, 115.761, 115.245, 119.112]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.761, 0.917, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.81, 0.93, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2612
Averaged Test Accurancy: 0.9106
Averaged Test AUC: 0.9831
Averaged Test F1_score: 0.9028
Averaged Test Recal score: 0.9226
Std Test Accurancy: 0.0853
Std Test AUC: 0.0101
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9709
Epoch: 0|  Loss:  1.3656 |Global loss: 5.7843| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9825
Epoch: 1|  Loss:  1.3748 |Global loss: 5.7831| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9762
Epoch: 2|  Loss:  1.3679 |Global loss: 5.7883| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9591
Epoch: 3|  Loss:  1.3496 |Global loss: 5.7983| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8901
Epoch: 0|  Loss:  1.1067 |Global loss: 5.7187| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.8771
Epoch: 1|  Loss:  1.0812 |Global loss: 5.7249| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.8777
Epoch: 2|  Loss:  1.0972 |Global loss: 5.7201| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.8652
Epoch: 3|  Loss:  1.0842 |Global loss: 5.73| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.949
Epoch: 0|  Loss:  1.2608 |Global loss: 5.7799| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9536
Epoch: 1|  Loss:  1.2509 |Global loss: 5.7777| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9352
Epoch: 2|  Loss:  1.2452 |Global loss: 5.7829| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.9481
Epoch: 3|  Loss:  1.2479 |Global loss: 5.7819| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.8963
Epoch: 0|  Loss:  1.1416 |Global loss: 5.7596| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 1|  NKD Loss: 0.9205
Epoch: 1|  Loss:  1.1557 |Global loss: 5.7359| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 2|  NKD Loss: 0.9201
Epoch: 2|  Loss:  1.1673 |Global loss: 5.7354| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 3|  NKD Loss: 0.9116
Epoch: 3|  Loss:  1.1531 |Global loss: 5.7397| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 0|  NKD Loss: 0.9423
Epoch: 0|  Loss:  1.3404 |Global loss: 5.765| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9429
Epoch: 1|  Loss:  1.339 |Global loss: 5.7597| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9543
Epoch: 2|  Loss:  1.3617 |Global loss: 5.7597| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.953
Epoch: 3|  Loss:  1.3554 |Global loss: 5.7564| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9136
Epoch: 0|  Loss:  1.1616 |Global loss: 5.7495| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.9175
Epoch: 1|  Loss:  1.1609 |Global loss: 5.7429| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 0.9124
Epoch: 2|  Loss:  1.16 |Global loss: 5.7486| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 3|  NKD Loss: 0.9033
Epoch: 3|  Loss:  1.1556 |Global loss: 5.7504| Local H loss: 0.0397  | Global H loss: 0.0397
------------------------- time cost ------------------------- 2.8446261882781982
Chosen Clients:  [7, 3, 6, 4, 12, 0]

-------------Round number: 385-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.942, 0.883, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.504, 119.027, 117.711, 118.938, 118.092, 117.527, 117.377, 118.896, 119.089, 119.013, 118.205, 119.032, 115.761, 115.245, 119.124]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.761, 0.935, 0.888, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.81, 0.94, 0.908, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2634
Averaged Test Accurancy: 0.9117
Averaged Test AUC: 0.9831
Averaged Test F1_score: 0.9040
Averaged Test Recal score: 0.9233
Std Test Accurancy: 0.0856
Std Test AUC: 0.0103
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.905
Epoch: 0|  Loss:  1.1523 |Global loss: 5.7534| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.8911
Epoch: 1|  Loss:  1.1416 |Global loss: 5.7653| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.1581 |Global loss: 5.7509| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1504 |Global loss: 5.7465| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 0|  NKD Loss: 0.9101
Epoch: 0|  Loss:  1.1704 |Global loss: 5.7223| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.8898
Epoch: 1|  Loss:  1.1493 |Global loss: 5.7331| Local H loss: 0.0406  | Global H loss: 0.0406
Epoch: 2|  NKD Loss: 0.8846
Epoch: 2|  Loss:  1.1481 |Global loss: 5.7362| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 3|  NKD Loss: 0.8939
Epoch: 3|  Loss:  1.1559 |Global loss: 5.729| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 0|  NKD Loss: 0.9523
Epoch: 0|  Loss:  1.2823 |Global loss: 5.7621| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.94
Epoch: 1|  Loss:  1.2717 |Global loss: 5.7697| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9312
Epoch: 2|  Loss:  1.2524 |Global loss: 5.7733| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 3|  NKD Loss: 0.9583
Epoch: 3|  Loss:  1.2758 |Global loss: 5.7588| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.8845
Epoch: 0|  Loss:  1.3348 |Global loss: 5.7526| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.9142
Epoch: 1|  Loss:  1.3607 |Global loss: 5.7276| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 0.9177
Epoch: 2|  Loss:  1.3649 |Global loss: 5.7227| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 0.9206
Epoch: 3|  Loss:  1.3687 |Global loss: 5.7206| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 0|  NKD Loss: 1.0199
Epoch: 0|  Loss:  1.711 |Global loss: 5.8348| Local H loss: 0.0431  | Global H loss: 0.0431
Epoch: 1|  NKD Loss: 0.9952
Epoch: 1|  Loss:  1.7136 |Global loss: 5.8466| Local H loss: 0.0425  | Global H loss: 0.0425
Epoch: 2|  NKD Loss: 0.9931
Epoch: 2|  Loss:  1.6973 |Global loss: 5.855| Local H loss: 0.0424  | Global H loss: 0.0424
Epoch: 3|  NKD Loss: 1.0211
Epoch: 3|  Loss:  1.6993 |Global loss: 5.8239| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 0|  NKD Loss: 0.9332
Epoch: 0|  Loss:  1.332 |Global loss: 5.768| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.949
Epoch: 1|  Loss:  1.3501 |Global loss: 5.7591| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9435
Epoch: 2|  Loss:  1.3431 |Global loss: 5.7603| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9516
Epoch: 3|  Loss:  1.3418 |Global loss: 5.755| Local H loss: 0.025  | Global H loss: 0.025
------------------------- time cost ------------------------- 2.915189504623413
Chosen Clients:  [9, 0, 1, 4, 11, 13]

-------------Round number: 386-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.833, 0.942, 0.892, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.592, 119.027, 117.711, 118.945, 118.112, 117.527, 117.402, 118.856, 119.089, 119.013, 118.205, 119.032, 115.85, 115.245, 119.124]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.761, 0.935, 0.895, 0.971, 0.97, 0.981, 0.949, 0.98, 0.73, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.81, 0.94, 0.914, 0.977, 0.977, 0.984, 0.956, 0.984, 0.77, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2630
Averaged Test Accurancy: 0.9128
Averaged Test AUC: 0.9832
Averaged Test F1_score: 0.9055
Averaged Test Recal score: 0.9245
Std Test Accurancy: 0.0842
Std Test AUC: 0.0101
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9053
Epoch: 0|  Loss:  1.1076 |Global loss: 5.7037| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.8861
Epoch: 1|  Loss:  1.1029 |Global loss: 5.7172| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.8725
Epoch: 2|  Loss:  1.0906 |Global loss: 5.7246| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.8641
Epoch: 3|  Loss:  1.0679 |Global loss: 5.725| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9626
Epoch: 0|  Loss:  1.3569 |Global loss: 5.7459| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.3312 |Global loss: 5.7647| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9458
Epoch: 2|  Loss:  1.3472 |Global loss: 5.7624| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9518
Epoch: 3|  Loss:  1.3377 |Global loss: 5.7521| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9491
Epoch: 0|  Loss:  1.2556 |Global loss: 5.7738| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.949
Epoch: 1|  Loss:  1.2589 |Global loss: 5.7814| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9442
Epoch: 2|  Loss:  1.2506 |Global loss: 5.7778| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9504
Epoch: 3|  Loss:  1.2579 |Global loss: 5.7755| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9146
Epoch: 0|  Loss:  1.368 |Global loss: 5.7294| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.3245 |Global loss: 5.7266| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 0.9164
Epoch: 2|  Loss:  1.3498 |Global loss: 5.7202| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 3|  NKD Loss: 0.9282
Epoch: 3|  Loss:  1.3712 |Global loss: 5.7144| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 0|  NKD Loss: 0.8931
Epoch: 0|  Loss:  1.1222 |Global loss: 5.73| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.8918
Epoch: 1|  Loss:  1.1168 |Global loss: 5.7359| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.9071
Epoch: 2|  Loss:  1.1381 |Global loss: 5.7284| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 3|  NKD Loss: 0.9205
Epoch: 3|  Loss:  1.1471 |Global loss: 5.7166| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.9359
Epoch: 0|  Loss:  1.4071 |Global loss: 5.7597| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 1|  NKD Loss: 0.9183
Epoch: 1|  Loss:  1.3953 |Global loss: 5.7794| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.9266
Epoch: 2|  Loss:  1.4052 |Global loss: 5.7626| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.9459
Epoch: 3|  Loss:  1.4217 |Global loss: 5.7592| Local H loss: 0.0351  | Global H loss: 0.0351
------------------------- time cost ------------------------- 3.079477071762085
Chosen Clients:  [0, 7, 1, 5, 4, 2]

-------------Round number: 387-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.892, 0.983, 0.842, 0.942, 0.892, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.545, 118.969, 117.711, 118.945, 118.102, 117.527, 117.402, 118.856, 119.089, 119.018, 118.205, 118.995, 115.85, 115.286, 119.124]
F1 Score:  [0.748, 0.971, 0.892, 0.982, 0.766, 0.935, 0.895, 0.971, 0.97, 0.981, 0.949, 0.98, 0.73, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.913, 0.986, 0.817, 0.94, 0.914, 0.977, 0.977, 0.984, 0.956, 0.984, 0.77, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2607
Averaged Test Accurancy: 0.9133
Averaged Test AUC: 0.9831
Averaged Test F1_score: 0.9059
Averaged Test Recal score: 0.9250
Std Test Accurancy: 0.0837
Std Test AUC: 0.0101
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9486
Epoch: 0|  Loss:  1.3362 |Global loss: 5.7529| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9589
Epoch: 1|  Loss:  1.3494 |Global loss: 5.7473| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9522
Epoch: 2|  Loss:  1.3406 |Global loss: 5.7521| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.3333 |Global loss: 5.755| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9228
Epoch: 0|  Loss:  1.1577 |Global loss: 5.7408| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 0.9074
Epoch: 1|  Loss:  1.1562 |Global loss: 5.7452| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.913
Epoch: 2|  Loss:  1.1618 |Global loss: 5.7459| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 3|  NKD Loss: 0.9188
Epoch: 3|  Loss:  1.1645 |Global loss: 5.7405| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.9419
Epoch: 0|  Loss:  1.2437 |Global loss: 5.7782| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.947
Epoch: 1|  Loss:  1.2507 |Global loss: 5.7703| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9461
Epoch: 2|  Loss:  1.2513 |Global loss: 5.7654| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.923
Epoch: 3|  Loss:  1.2293 |Global loss: 5.7919| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9718
Epoch: 0|  Loss:  1.3649 |Global loss: 5.7849| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9715
Epoch: 1|  Loss:  1.3645 |Global loss: 5.7889| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9691
Epoch: 2|  Loss:  1.3609 |Global loss: 5.792| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9699
Epoch: 3|  Loss:  1.35 |Global loss: 5.7807| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8886
Epoch: 0|  Loss:  1.326 |Global loss: 5.7349| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.9157
Epoch: 1|  Loss:  1.3452 |Global loss: 5.721| Local H loss: 0.0239  | Global H loss: 0.0239
Epoch: 2|  NKD Loss: 0.9411
Epoch: 2|  Loss:  1.3832 |Global loss: 5.7081| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 3|  NKD Loss: 0.927
Epoch: 3|  Loss:  1.3621 |Global loss: 5.7082| Local H loss: 0.024  | Global H loss: 0.024
Epoch: 0|  NKD Loss: 0.9595
Epoch: 0|  Loss:  1.2869 |Global loss: 5.804| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9714
Epoch: 1|  Loss:  1.3053 |Global loss: 5.7968| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9781
Epoch: 2|  Loss:  1.3098 |Global loss: 5.7849| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9607
Epoch: 3|  Loss:  1.2777 |Global loss: 5.801| Local H loss: 0.0368  | Global H loss: 0.0368
------------------------- time cost ------------------------- 2.740630865097046
Chosen Clients:  [12, 3, 1, 0, 4, 10]

-------------Round number: 388-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.892, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.672, 119.111, 117.67, 118.945, 118.104, 117.622, 117.402, 118.9, 119.089, 119.018, 118.205, 118.995, 115.85, 115.286, 119.124]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.895, 0.971, 0.97, 0.981, 0.949, 0.98, 0.73, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.914, 0.977, 0.977, 0.984, 0.956, 0.984, 0.77, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2663
Averaged Test Accurancy: 0.9139
Averaged Test AUC: 0.9833
Averaged Test F1_score: 0.9069
Averaged Test Recal score: 0.9262
Std Test Accurancy: 0.0840
Std Test AUC: 0.0101
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0293
Epoch: 0|  Loss:  1.7142 |Global loss: 5.812| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 1|  NKD Loss: 1.0095
Epoch: 1|  Loss:  1.7135 |Global loss: 5.8332| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 2|  NKD Loss: 0.9914
Epoch: 2|  Loss:  1.6902 |Global loss: 5.8473| Local H loss: 0.0422  | Global H loss: 0.0422
Epoch: 3|  NKD Loss: 1.0197
Epoch: 3|  Loss:  1.7139 |Global loss: 5.8228| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 0|  NKD Loss: 0.8714
Epoch: 0|  Loss:  1.1324 |Global loss: 5.7447| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 1|  NKD Loss: 0.8996
Epoch: 1|  Loss:  1.1599 |Global loss: 5.7244| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.9072
Epoch: 2|  Loss:  1.1672 |Global loss: 5.7194| Local H loss: 0.0408  | Global H loss: 0.0408
Epoch: 3|  NKD Loss: 0.8995
Epoch: 3|  Loss:  1.1419 |Global loss: 5.7211| Local H loss: 0.0407  | Global H loss: 0.0407
Epoch: 0|  NKD Loss: 0.9538
Epoch: 0|  Loss:  1.2488 |Global loss: 5.7725| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9318
Epoch: 1|  Loss:  1.2396 |Global loss: 5.784| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9412
Epoch: 2|  Loss:  1.2329 |Global loss: 5.7621| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9328
Epoch: 3|  Loss:  1.2329 |Global loss: 5.7791| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9284
Epoch: 0|  Loss:  1.3273 |Global loss: 5.7682| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9572
Epoch: 1|  Loss:  1.3452 |Global loss: 5.7522| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.938
Epoch: 2|  Loss:  1.34 |Global loss: 5.7635| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9516
Epoch: 3|  Loss:  1.3399 |Global loss: 5.7515| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9045
Epoch: 0|  Loss:  1.3402 |Global loss: 5.7311| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.9078
Epoch: 1|  Loss:  1.3491 |Global loss: 5.7285| Local H loss: 0.0238  | Global H loss: 0.0238
Epoch: 2|  NKD Loss: 0.9249
Epoch: 2|  Loss:  1.3674 |Global loss: 5.7189| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 3|  NKD Loss: 0.9054
Epoch: 3|  Loss:  1.3365 |Global loss: 5.7292| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 0.9102
Epoch: 0|  Loss:  1.1599 |Global loss: 5.749| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.9145
Epoch: 1|  Loss:  1.1632 |Global loss: 5.7397| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9087
Epoch: 2|  Loss:  1.153 |Global loss: 5.7478| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.8929
Epoch: 3|  Loss:  1.1456 |Global loss: 5.755| Local H loss: 0.0373  | Global H loss: 0.0373
------------------------- time cost ------------------------- 3.0606584548950195
Chosen Clients:  [13, 14, 12, 4, 9, 8]

-------------Round number: 389-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.892, 0.975, 0.975, 0.983, 0.958, 0.983, 0.7, 0.85, 0.975]
AUC in each clients:  [116.684, 119.142, 117.67, 118.943, 118.091, 117.622, 117.402, 118.9, 119.089, 119.018, 118.231, 118.995, 115.773, 115.286, 119.124]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.895, 0.971, 0.97, 0.981, 0.949, 0.98, 0.7, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.914, 0.977, 0.977, 0.984, 0.956, 0.984, 0.742, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2607
Averaged Test Accurancy: 0.9122
Averaged Test AUC: 0.9833
Averaged Test F1_score: 0.9049
Averaged Test Recal score: 0.9243
Std Test Accurancy: 0.0879
Std Test AUC: 0.0101
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9574
Epoch: 0|  Loss:  1.4333 |Global loss: 5.7458| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9393
Epoch: 1|  Loss:  1.4092 |Global loss: 5.7623| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.9349
Epoch: 2|  Loss:  1.4031 |Global loss: 5.7678| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.9302
Epoch: 3|  Loss:  1.4108 |Global loss: 5.7648| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9109
Epoch: 0|  Loss:  1.1379 |Global loss: 5.7414| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9036
Epoch: 1|  Loss:  1.1452 |Global loss: 5.746| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.9022
Epoch: 2|  Loss:  1.1469 |Global loss: 5.7444| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 3|  NKD Loss: 0.9208
Epoch: 3|  Loss:  1.1503 |Global loss: 5.7336| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 1.0209
Epoch: 0|  Loss:  1.7017 |Global loss: 5.8263| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 1|  NKD Loss: 1.0178
Epoch: 1|  Loss:  1.7056 |Global loss: 5.8268| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 2|  NKD Loss: 1.0078
Epoch: 2|  Loss:  1.6993 |Global loss: 5.8377| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 1.0096
Epoch: 3|  Loss:  1.6945 |Global loss: 5.8199| Local H loss: 0.0437  | Global H loss: 0.0437
Epoch: 0|  NKD Loss: 0.9276
Epoch: 0|  Loss:  1.368 |Global loss: 5.715| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 1|  NKD Loss: 0.9073
Epoch: 1|  Loss:  1.3403 |Global loss: 5.7245| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 0.9053
Epoch: 2|  Loss:  1.3501 |Global loss: 5.7291| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 0.9305
Epoch: 3|  Loss:  1.3819 |Global loss: 5.7157| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 0|  NKD Loss: 0.8795
Epoch: 0|  Loss:  1.0936 |Global loss: 5.7205| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.8913
Epoch: 1|  Loss:  1.1033 |Global loss: 5.7067| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.8866
Epoch: 2|  Loss:  1.1041 |Global loss: 5.711| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.8883
Epoch: 3|  Loss:  1.1034 |Global loss: 5.7176| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9252
Epoch: 0|  Loss:  1.154 |Global loss: 5.7264| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.899
Epoch: 1|  Loss:  1.1371 |Global loss: 5.7462| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.8988
Epoch: 2|  Loss:  1.1377 |Global loss: 5.7432| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.9192
Epoch: 3|  Loss:  1.1563 |Global loss: 5.7304| Local H loss: 0.0357  | Global H loss: 0.0357
------------------------- time cost ------------------------- 2.93477725982666
Chosen Clients:  [12, 14, 11, 6, 1, 7]

-------------Round number: 390-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.892, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.684, 119.142, 117.67, 118.943, 118.092, 117.622, 117.402, 118.9, 119.111, 119.022, 118.231, 118.995, 115.882, 115.211, 119.121]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.895, 0.971, 0.97, 0.981, 0.949, 0.98, 0.722, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.914, 0.977, 0.977, 0.984, 0.956, 0.984, 0.764, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2607
Averaged Test Accurancy: 0.9139
Averaged Test AUC: 0.9833
Averaged Test F1_score: 0.9063
Averaged Test Recal score: 0.9258
Std Test Accurancy: 0.0840
Std Test AUC: 0.0101
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0143
Epoch: 0|  Loss:  1.6828 |Global loss: 5.8306| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 1|  NKD Loss: 0.9926
Epoch: 1|  Loss:  1.6828 |Global loss: 5.8445| Local H loss: 0.0428  | Global H loss: 0.0428
Epoch: 2|  NKD Loss: 0.9868
Epoch: 2|  Loss:  1.6677 |Global loss: 5.838| Local H loss: 0.0429  | Global H loss: 0.0429
Epoch: 3|  NKD Loss: 1.0249
Epoch: 3|  Loss:  1.6924 |Global loss: 5.8118| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 0|  NKD Loss: 0.9053
Epoch: 0|  Loss:  1.1393 |Global loss: 5.7393| Local H loss: 0.0284  | Global H loss: 0.0284
Epoch: 1|  NKD Loss: 0.9217
Epoch: 1|  Loss:  1.1649 |Global loss: 5.7262| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 2|  NKD Loss: 0.9111
Epoch: 2|  Loss:  1.1535 |Global loss: 5.745| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9291
Epoch: 3|  Loss:  1.1687 |Global loss: 5.727| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 0|  NKD Loss: 0.898
Epoch: 0|  Loss:  1.1267 |Global loss: 5.7257| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.8959
Epoch: 1|  Loss:  1.1087 |Global loss: 5.7331| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.9157
Epoch: 2|  Loss:  1.1429 |Global loss: 5.7183| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.908
Epoch: 3|  Loss:  1.1386 |Global loss: 5.7269| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.9579
Epoch: 0|  Loss:  1.2845 |Global loss: 5.759| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9432
Epoch: 1|  Loss:  1.2615 |Global loss: 5.7681| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9481
Epoch: 2|  Loss:  1.2743 |Global loss: 5.7605| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9575
Epoch: 3|  Loss:  1.2848 |Global loss: 5.7566| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9519
Epoch: 0|  Loss:  1.257 |Global loss: 5.7721| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9409
Epoch: 1|  Loss:  1.2292 |Global loss: 5.7799| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.9336
Epoch: 2|  Loss:  1.2243 |Global loss: 5.7636| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9495
Epoch: 3|  Loss:  1.2511 |Global loss: 5.7672| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9163
Epoch: 0|  Loss:  1.1628 |Global loss: 5.7411| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.9082
Epoch: 1|  Loss:  1.1546 |Global loss: 5.749| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 2|  NKD Loss: 0.9064
Epoch: 2|  Loss:  1.1463 |Global loss: 5.7473| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.9105
Epoch: 3|  Loss:  1.1553 |Global loss: 5.7369| Local H loss: 0.0397  | Global H loss: 0.0397
------------------------- time cost ------------------------- 2.8345532417297363
Chosen Clients:  [13, 7, 3, 8, 4, 11]

-------------Round number: 391-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.9, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [116.684, 119.205, 117.67, 118.943, 118.092, 117.622, 117.424, 118.902, 119.111, 119.022, 118.231, 119.02, 116.014, 115.211, 119.136]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.902, 0.971, 0.97, 0.981, 0.949, 0.98, 0.734, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.919, 0.977, 0.977, 0.984, 0.956, 0.984, 0.773, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2586
Averaged Test Accurancy: 0.9150
Averaged Test AUC: 0.9835
Averaged Test F1_score: 0.9076
Averaged Test Recal score: 0.9267
Std Test Accurancy: 0.0826
Std Test AUC: 0.0101
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9479
Epoch: 0|  Loss:  1.418 |Global loss: 5.7548| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.9419
Epoch: 1|  Loss:  1.4278 |Global loss: 5.7584| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.943
Epoch: 2|  Loss:  1.4085 |Global loss: 5.7557| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9417
Epoch: 3|  Loss:  1.4207 |Global loss: 5.7504| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 0|  NKD Loss: 0.9047
Epoch: 0|  Loss:  1.1488 |Global loss: 5.7436| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.8977
Epoch: 1|  Loss:  1.1406 |Global loss: 5.7507| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 2|  NKD Loss: 0.9106
Epoch: 2|  Loss:  1.1544 |Global loss: 5.7446| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.9087
Epoch: 3|  Loss:  1.1521 |Global loss: 5.7402| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 0|  NKD Loss: 0.884
Epoch: 0|  Loss:  1.1428 |Global loss: 5.7351| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.8925
Epoch: 1|  Loss:  1.1515 |Global loss: 5.7292| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.8945
Epoch: 2|  Loss:  1.1523 |Global loss: 5.7303| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.8728
Epoch: 3|  Loss:  1.131 |Global loss: 5.7371| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 0|  NKD Loss: 0.8969
Epoch: 0|  Loss:  1.13 |Global loss: 5.7478| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9239
Epoch: 1|  Loss:  1.1594 |Global loss: 5.7258| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.9106
Epoch: 2|  Loss:  1.1449 |Global loss: 5.7389| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.8959
Epoch: 3|  Loss:  1.1268 |Global loss: 5.7451| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.3757 |Global loss: 5.7102| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.9208
Epoch: 1|  Loss:  1.353 |Global loss: 5.7236| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 0.9102
Epoch: 2|  Loss:  1.3496 |Global loss: 5.7261| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 3|  NKD Loss: 0.9213
Epoch: 3|  Loss:  1.3725 |Global loss: 5.72| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 0|  NKD Loss: 0.8932
Epoch: 0|  Loss:  1.1227 |Global loss: 5.7327| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8849
Epoch: 1|  Loss:  1.114 |Global loss: 5.7381| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.8985
Epoch: 2|  Loss:  1.1106 |Global loss: 5.7276| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9178
Epoch: 3|  Loss:  1.1417 |Global loss: 5.7146| Local H loss: 0.0258  | Global H loss: 0.0258
------------------------- time cost ------------------------- 2.9262492656707764
Chosen Clients:  [12, 0, 13, 4, 14, 6]

-------------Round number: 392-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.942, 0.9, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [116.684, 119.205, 117.67, 118.946, 118.109, 117.622, 117.424, 118.898, 119.033, 119.022, 118.231, 119.042, 116.014, 115.286, 119.136]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.766, 0.938, 0.902, 0.971, 0.97, 0.981, 0.949, 0.98, 0.734, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.817, 0.946, 0.919, 0.977, 0.977, 0.984, 0.956, 0.984, 0.773, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2601
Averaged Test Accurancy: 0.9156
Averaged Test AUC: 0.9835
Averaged Test F1_score: 0.9079
Averaged Test Recal score: 0.9272
Std Test Accurancy: 0.0821
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0224
Epoch: 0|  Loss:  1.6998 |Global loss: 5.8205| Local H loss: 0.0434  | Global H loss: 0.0434
Epoch: 1|  NKD Loss: 0.9982
Epoch: 1|  Loss:  1.678 |Global loss: 5.8316| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 2|  NKD Loss: 1.0071
Epoch: 2|  Loss:  1.677 |Global loss: 5.8299| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 3|  NKD Loss: 1.0024
Epoch: 3|  Loss:  1.6882 |Global loss: 5.8308| Local H loss: 0.0433  | Global H loss: 0.0433
Epoch: 0|  NKD Loss: 0.9654
Epoch: 0|  Loss:  1.3603 |Global loss: 5.7465| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9277
Epoch: 1|  Loss:  1.3228 |Global loss: 5.762| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.949
Epoch: 2|  Loss:  1.3271 |Global loss: 5.7459| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.954
Epoch: 3|  Loss:  1.342 |Global loss: 5.75| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9314
Epoch: 0|  Loss:  1.4138 |Global loss: 5.7686| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.9433
Epoch: 1|  Loss:  1.4107 |Global loss: 5.7496| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 2|  NKD Loss: 0.9253
Epoch: 2|  Loss:  1.4109 |Global loss: 5.7692| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.9582
Epoch: 3|  Loss:  1.416 |Global loss: 5.7454| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9115
Epoch: 0|  Loss:  1.3418 |Global loss: 5.7216| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.9201
Epoch: 1|  Loss:  1.3517 |Global loss: 5.7116| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 0.9331
Epoch: 2|  Loss:  1.3724 |Global loss: 5.7113| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 0.9362
Epoch: 3|  Loss:  1.3768 |Global loss: 5.7078| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 0|  NKD Loss: 0.9179
Epoch: 0|  Loss:  1.1585 |Global loss: 5.7318| Local H loss: 0.0283  | Global H loss: 0.0283
Epoch: 1|  NKD Loss: 0.9162
Epoch: 1|  Loss:  1.1588 |Global loss: 5.7323| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 2|  NKD Loss: 0.916
Epoch: 2|  Loss:  1.1586 |Global loss: 5.7411| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 3|  NKD Loss: 0.9013
Epoch: 3|  Loss:  1.1425 |Global loss: 5.7471| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9373
Epoch: 0|  Loss:  1.2615 |Global loss: 5.7696| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9276
Epoch: 1|  Loss:  1.2574 |Global loss: 5.7776| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9489
Epoch: 2|  Loss:  1.2776 |Global loss: 5.7616| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9488
Epoch: 3|  Loss:  1.2726 |Global loss: 5.7597| Local H loss: 0.0313  | Global H loss: 0.0313
------------------------- time cost ------------------------- 2.9917569160461426
Chosen Clients:  [3, 7, 14, 12, 13, 4]

-------------Round number: 393-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.908, 0.975, 0.975, 0.983, 0.958, 0.983, 0.683, 0.85, 0.975]
AUC in each clients:  [116.65, 119.205, 117.67, 118.946, 118.098, 117.622, 117.459, 118.898, 119.033, 119.022, 118.231, 119.042, 115.735, 115.281, 119.159]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.909, 0.971, 0.97, 0.981, 0.949, 0.98, 0.679, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.925, 0.977, 0.977, 0.984, 0.956, 0.984, 0.728, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2665
Averaged Test Accurancy: 0.9122
Averaged Test AUC: 0.9834
Averaged Test F1_score: 0.9044
Averaged Test Recal score: 0.9241
Std Test Accurancy: 0.0905
Std Test AUC: 0.0102
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9151
Epoch: 0|  Loss:  1.1731 |Global loss: 5.7134| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.8932
Epoch: 1|  Loss:  1.1501 |Global loss: 5.727| Local H loss: 0.0409  | Global H loss: 0.0409
Epoch: 2|  NKD Loss: 0.9023
Epoch: 2|  Loss:  1.1599 |Global loss: 5.7227| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 3|  NKD Loss: 0.895
Epoch: 3|  Loss:  1.1487 |Global loss: 5.7207| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9088
Epoch: 0|  Loss:  1.145 |Global loss: 5.7477| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.901
Epoch: 1|  Loss:  1.1402 |Global loss: 5.7523| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9052
Epoch: 2|  Loss:  1.1483 |Global loss: 5.7441| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9033
Epoch: 3|  Loss:  1.1473 |Global loss: 5.7452| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.8783
Epoch: 0|  Loss:  1.1222 |Global loss: 5.7613| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9179
Epoch: 1|  Loss:  1.1563 |Global loss: 5.7321| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9144
Epoch: 2|  Loss:  1.1512 |Global loss: 5.7293| Local H loss: 0.0282  | Global H loss: 0.0282
Epoch: 3|  NKD Loss: 0.9074
Epoch: 3|  Loss:  1.1473 |Global loss: 5.7392| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9993
Epoch: 0|  Loss:  1.6735 |Global loss: 5.829| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 1|  NKD Loss: 1.0138
Epoch: 1|  Loss:  1.6795 |Global loss: 5.816| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 2|  NKD Loss: 1.016
Epoch: 2|  Loss:  1.6832 |Global loss: 5.8231| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 3|  NKD Loss: 1.0195
Epoch: 3|  Loss:  1.6938 |Global loss: 5.8172| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 0|  NKD Loss: 0.9274
Epoch: 0|  Loss:  1.3925 |Global loss: 5.7579| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.9499
Epoch: 1|  Loss:  1.423 |Global loss: 5.748| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.952
Epoch: 2|  Loss:  1.4232 |Global loss: 5.7507| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.9303
Epoch: 3|  Loss:  1.3999 |Global loss: 5.7543| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.9199
Epoch: 0|  Loss:  1.3535 |Global loss: 5.7195| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.9305
Epoch: 1|  Loss:  1.3695 |Global loss: 5.7116| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 0.9072
Epoch: 2|  Loss:  1.3562 |Global loss: 5.7283| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 0.9281
Epoch: 3|  Loss:  1.3671 |Global loss: 5.7077| Local H loss: 0.0237  | Global H loss: 0.0237
------------------------- time cost ------------------------- 2.913320779800415
Chosen Clients:  [13, 2, 10, 6, 14, 4]

-------------Round number: 394-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.908, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.65, 119.205, 117.67, 118.945, 118.093, 117.622, 117.459, 118.911, 119.033, 119.022, 118.231, 119.042, 115.984, 115.338, 119.222]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.938, 0.909, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.925, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2637
Averaged Test Accurancy: 0.9150
Averaged Test AUC: 0.9836
Averaged Test F1_score: 0.9074
Averaged Test Recal score: 0.9265
Std Test Accurancy: 0.0838
Std Test AUC: 0.0100
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9305
Epoch: 0|  Loss:  1.4093 |Global loss: 5.7606| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.3836 |Global loss: 5.7593| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.9414
Epoch: 2|  Loss:  1.3665 |Global loss: 5.7465| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9407
Epoch: 3|  Loss:  1.3885 |Global loss: 5.7488| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9819
Epoch: 0|  Loss:  1.3243 |Global loss: 5.7983| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9865
Epoch: 1|  Loss:  1.3203 |Global loss: 5.7861| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9604
Epoch: 2|  Loss:  1.2988 |Global loss: 5.8154| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9535
Epoch: 3|  Loss:  1.2858 |Global loss: 5.811| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.901
Epoch: 0|  Loss:  1.1534 |Global loss: 5.7553| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.9194
Epoch: 1|  Loss:  1.1677 |Global loss: 5.74| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.9048
Epoch: 2|  Loss:  1.1538 |Global loss: 5.7507| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.9155
Epoch: 3|  Loss:  1.1633 |Global loss: 5.7376| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.958
Epoch: 0|  Loss:  1.2797 |Global loss: 5.7529| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9432
Epoch: 1|  Loss:  1.268 |Global loss: 5.7619| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9577
Epoch: 2|  Loss:  1.2795 |Global loss: 5.7547| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9348
Epoch: 3|  Loss:  1.2601 |Global loss: 5.7701| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8995
Epoch: 0|  Loss:  1.1383 |Global loss: 5.7463| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9106
Epoch: 1|  Loss:  1.1504 |Global loss: 5.7364| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.894
Epoch: 2|  Loss:  1.1249 |Global loss: 5.7381| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9085
Epoch: 3|  Loss:  1.1466 |Global loss: 5.7366| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 0|  NKD Loss: 0.9261
Epoch: 0|  Loss:  1.3553 |Global loss: 5.7062| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 1|  NKD Loss: 0.9292
Epoch: 1|  Loss:  1.3609 |Global loss: 5.7054| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 2|  NKD Loss: 0.8952
Epoch: 2|  Loss:  1.3476 |Global loss: 5.7364| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 0.9073
Epoch: 3|  Loss:  1.3409 |Global loss: 5.7221| Local H loss: 0.0234  | Global H loss: 0.0234
------------------------- time cost ------------------------- 2.80845046043396
Chosen Clients:  [7, 10, 3, 0, 8, 1]

-------------Round number: 395-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.917, 0.983, 0.833, 0.942, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.65, 119.205, 117.701, 118.945, 118.099, 117.622, 117.478, 118.911, 119.033, 119.022, 118.273, 119.042, 115.984, 115.349, 119.205]
F1 Score:  [0.748, 0.971, 0.917, 0.982, 0.761, 0.938, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.938, 0.986, 0.81, 0.946, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2510
Averaged Test Accurancy: 0.9167
Averaged Test AUC: 0.9836
Averaged Test F1_score: 0.9089
Averaged Test Recal score: 0.9276
Std Test Accurancy: 0.0838
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8933
Epoch: 0|  Loss:  1.1344 |Global loss: 5.7524| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.9125
Epoch: 1|  Loss:  1.1543 |Global loss: 5.7421| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9112
Epoch: 2|  Loss:  1.1515 |Global loss: 5.7404| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.9095
Epoch: 3|  Loss:  1.1521 |Global loss: 5.7399| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.9107
Epoch: 0|  Loss:  1.1588 |Global loss: 5.7435| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.8962
Epoch: 1|  Loss:  1.1381 |Global loss: 5.7551| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.9233
Epoch: 2|  Loss:  1.1702 |Global loss: 5.7328| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.8953
Epoch: 3|  Loss:  1.1464 |Global loss: 5.7542| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.8931
Epoch: 0|  Loss:  1.1495 |Global loss: 5.7275| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 1|  NKD Loss: 0.8928
Epoch: 1|  Loss:  1.1396 |Global loss: 5.7288| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 2|  NKD Loss: 0.8881
Epoch: 2|  Loss:  1.1318 |Global loss: 5.7317| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.8941
Epoch: 3|  Loss:  1.1472 |Global loss: 5.7214| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.9494
Epoch: 0|  Loss:  1.3329 |Global loss: 5.7507| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9443
Epoch: 1|  Loss:  1.3273 |Global loss: 5.7541| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.959
Epoch: 2|  Loss:  1.3424 |Global loss: 5.7425| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.9515
Epoch: 3|  Loss:  1.339 |Global loss: 5.7438| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9156
Epoch: 0|  Loss:  1.1524 |Global loss: 5.7237| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.9062
Epoch: 1|  Loss:  1.1388 |Global loss: 5.7419| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.9184
Epoch: 2|  Loss:  1.1528 |Global loss: 5.7288| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.912
Epoch: 3|  Loss:  1.1445 |Global loss: 5.7321| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9324
Epoch: 0|  Loss:  1.2224 |Global loss: 5.7764| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9531
Epoch: 1|  Loss:  1.2522 |Global loss: 5.7677| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9419
Epoch: 2|  Loss:  1.236 |Global loss: 5.7714| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.963
Epoch: 3|  Loss:  1.2605 |Global loss: 5.7673| Local H loss: 0.0281  | Global H loss: 0.0281
------------------------- time cost ------------------------- 2.7544140815734863
Chosen Clients:  [1, 9, 5, 2, 10, 4]

-------------Round number: 396-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.917, 0.983, 0.833, 0.942, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.745, 119.143, 117.701, 118.943, 118.099, 117.622, 117.478, 118.889, 119.135, 119.022, 118.308, 119.042, 115.984, 115.349, 119.205]
F1 Score:  [0.748, 0.971, 0.917, 0.982, 0.761, 0.938, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.938, 0.986, 0.81, 0.946, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2538
Averaged Test Accurancy: 0.9167
Averaged Test AUC: 0.9837
Averaged Test F1_score: 0.9089
Averaged Test Recal score: 0.9276
Std Test Accurancy: 0.0838
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9455
Epoch: 0|  Loss:  1.2427 |Global loss: 5.7707| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9299
Epoch: 1|  Loss:  1.1967 |Global loss: 5.7702| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 2|  NKD Loss: 0.9608
Epoch: 2|  Loss:  1.254 |Global loss: 5.7559| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9397
Epoch: 3|  Loss:  1.2323 |Global loss: 5.775| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.8987
Epoch: 0|  Loss:  1.1153 |Global loss: 5.702| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9062
Epoch: 1|  Loss:  1.1214 |Global loss: 5.701| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.8654
Epoch: 2|  Loss:  1.0809 |Global loss: 5.7261| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.8669
Epoch: 3|  Loss:  1.0826 |Global loss: 5.7271| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9666
Epoch: 0|  Loss:  1.3425 |Global loss: 5.7948| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.974
Epoch: 1|  Loss:  1.3529 |Global loss: 5.7801| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9767
Epoch: 2|  Loss:  1.3642 |Global loss: 5.7819| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9515
Epoch: 3|  Loss:  1.3357 |Global loss: 5.8015| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9778
Epoch: 0|  Loss:  1.3011 |Global loss: 5.7832| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9749
Epoch: 1|  Loss:  1.3067 |Global loss: 5.7904| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9691
Epoch: 2|  Loss:  1.3055 |Global loss: 5.8003| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9654
Epoch: 3|  Loss:  1.2915 |Global loss: 5.79| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9028
Epoch: 0|  Loss:  1.1502 |Global loss: 5.7475| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.9215
Epoch: 1|  Loss:  1.1688 |Global loss: 5.7356| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.8946
Epoch: 2|  Loss:  1.1409 |Global loss: 5.7495| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.8925
Epoch: 3|  Loss:  1.1398 |Global loss: 5.753| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.9269
Epoch: 0|  Loss:  1.3429 |Global loss: 5.7054| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 1|  NKD Loss: 0.9243
Epoch: 1|  Loss:  1.3487 |Global loss: 5.7046| Local H loss: 0.0237  | Global H loss: 0.0237
Epoch: 2|  NKD Loss: 0.9384
Epoch: 2|  Loss:  1.3737 |Global loss: 5.7057| Local H loss: 0.0236  | Global H loss: 0.0236
Epoch: 3|  NKD Loss: 0.911
Epoch: 3|  Loss:  1.3445 |Global loss: 5.7165| Local H loss: 0.0233  | Global H loss: 0.0233
------------------------- time cost ------------------------- 2.988253116607666
Chosen Clients:  [14, 5, 0, 6, 3, 9]

-------------Round number: 397-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.942, 0.983, 0.833, 0.933, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.745, 119.168, 117.924, 118.943, 118.107, 117.667, 117.478, 118.889, 119.135, 119.023, 118.351, 119.042, 115.984, 115.349, 119.205]
F1 Score:  [0.748, 0.971, 0.939, 0.982, 0.761, 0.926, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.955, 0.986, 0.81, 0.938, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2500
Averaged Test Accurancy: 0.9178
Averaged Test AUC: 0.9839
Averaged Test F1_score: 0.9095
Averaged Test Recal score: 0.9282
Std Test Accurancy: 0.0839
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9203
Epoch: 0|  Loss:  1.1598 |Global loss: 5.7293| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9144
Epoch: 1|  Loss:  1.1505 |Global loss: 5.7355| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.8987
Epoch: 2|  Loss:  1.1349 |Global loss: 5.7419| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.8912
Epoch: 3|  Loss:  1.1285 |Global loss: 5.7501| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9672
Epoch: 0|  Loss:  1.3443 |Global loss: 5.7848| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9706
Epoch: 1|  Loss:  1.3574 |Global loss: 5.7837| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9663
Epoch: 2|  Loss:  1.3463 |Global loss: 5.7882| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9505
Epoch: 3|  Loss:  1.3289 |Global loss: 5.7958| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9412
Epoch: 0|  Loss:  1.3262 |Global loss: 5.759| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9415
Epoch: 1|  Loss:  1.3381 |Global loss: 5.7557| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9431
Epoch: 2|  Loss:  1.3242 |Global loss: 5.7575| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.3235 |Global loss: 5.7494| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9395
Epoch: 0|  Loss:  1.2588 |Global loss: 5.7655| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.91
Epoch: 1|  Loss:  1.2347 |Global loss: 5.7821| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9452
Epoch: 2|  Loss:  1.2659 |Global loss: 5.7575| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9372
Epoch: 3|  Loss:  1.2482 |Global loss: 5.7635| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.9018
Epoch: 0|  Loss:  1.1534 |Global loss: 5.7175| Local H loss: 0.0405  | Global H loss: 0.0405
Epoch: 1|  NKD Loss: 0.8757
Epoch: 1|  Loss:  1.1302 |Global loss: 5.7326| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 2|  NKD Loss: 0.8777
Epoch: 2|  Loss:  1.1316 |Global loss: 5.7324| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 3|  NKD Loss: 0.8903
Epoch: 3|  Loss:  1.1451 |Global loss: 5.7238| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 0|  NKD Loss: 0.884
Epoch: 0|  Loss:  1.0988 |Global loss: 5.7213| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.8636
Epoch: 1|  Loss:  1.0797 |Global loss: 5.7276| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.8852
Epoch: 2|  Loss:  1.1008 |Global loss: 5.7126| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8856
Epoch: 3|  Loss:  1.1007 |Global loss: 5.7154| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 2.8501789569854736
Chosen Clients:  [2, 14, 1, 0, 5, 4]

-------------Round number: 398-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.942, 0.983, 0.833, 0.95, 0.917, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.722, 119.168, 117.924, 118.947, 118.107, 117.636, 117.475, 118.889, 119.135, 119.045, 118.351, 119.042, 115.984, 115.349, 119.188]
F1 Score:  [0.748, 0.971, 0.939, 0.982, 0.761, 0.946, 0.916, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.955, 0.986, 0.81, 0.953, 0.931, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2593
Averaged Test Accurancy: 0.9183
Averaged Test AUC: 0.9839
Averaged Test F1_score: 0.9104
Averaged Test Recal score: 0.9289
Std Test Accurancy: 0.0842
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9615
Epoch: 0|  Loss:  1.2711 |Global loss: 5.795| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9567
Epoch: 1|  Loss:  1.2726 |Global loss: 5.7947| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9636
Epoch: 2|  Loss:  1.2836 |Global loss: 5.798| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9591
Epoch: 3|  Loss:  1.2847 |Global loss: 5.7987| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9147
Epoch: 0|  Loss:  1.1537 |Global loss: 5.734| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9118
Epoch: 1|  Loss:  1.1449 |Global loss: 5.7276| Local H loss: 0.0281  | Global H loss: 0.0281
Epoch: 2|  NKD Loss: 0.903
Epoch: 2|  Loss:  1.1307 |Global loss: 5.7327| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.8917
Epoch: 3|  Loss:  1.1291 |Global loss: 5.7504| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9373
Epoch: 0|  Loss:  1.2309 |Global loss: 5.7741| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.9228
Epoch: 1|  Loss:  1.2172 |Global loss: 5.7834| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9193
Epoch: 2|  Loss:  1.2165 |Global loss: 5.7867| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.9533
Epoch: 3|  Loss:  1.2469 |Global loss: 5.7639| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 0|  NKD Loss: 0.9355
Epoch: 0|  Loss:  1.3197 |Global loss: 5.7632| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9215
Epoch: 1|  Loss:  1.315 |Global loss: 5.7711| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9361
Epoch: 2|  Loss:  1.325 |Global loss: 5.7572| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.93
Epoch: 3|  Loss:  1.3214 |Global loss: 5.7617| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 0.9757
Epoch: 0|  Loss:  1.3542 |Global loss: 5.7807| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9805
Epoch: 1|  Loss:  1.3596 |Global loss: 5.7764| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9595
Epoch: 2|  Loss:  1.3371 |Global loss: 5.7889| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.957
Epoch: 3|  Loss:  1.3314 |Global loss: 5.7949| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9202
Epoch: 0|  Loss:  1.3694 |Global loss: 5.7174| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.3563 |Global loss: 5.71| Local H loss: 0.0235  | Global H loss: 0.0235
Epoch: 2|  NKD Loss: 0.9129
Epoch: 2|  Loss:  1.3374 |Global loss: 5.7149| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 3|  NKD Loss: 0.9181
Epoch: 3|  Loss:  1.3496 |Global loss: 5.7168| Local H loss: 0.0233  | Global H loss: 0.0233
------------------------- time cost ------------------------- 2.769458293914795
Chosen Clients:  [12, 2, 13, 7, 10, 3]

-------------Round number: 399-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.917, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [116.805, 119.163, 117.963, 118.947, 118.096, 117.686, 117.475, 118.889, 119.135, 119.045, 118.351, 119.042, 115.984, 115.349, 119.271]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.936, 0.916, 0.971, 0.97, 0.981, 0.949, 0.98, 0.724, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.946, 0.931, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2472
Averaged Test Accurancy: 0.9156
Averaged Test AUC: 0.9840
Averaged Test F1_score: 0.9073
Averaged Test Recal score: 0.9263
Std Test Accurancy: 0.0838
Std Test AUC: 0.0099
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0055
Epoch: 0|  Loss:  1.669 |Global loss: 5.8314| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 1|  NKD Loss: 0.9856
Epoch: 1|  Loss:  1.6675 |Global loss: 5.8304| Local H loss: 0.043  | Global H loss: 0.043
Epoch: 2|  NKD Loss: 0.9993
Epoch: 2|  Loss:  1.6723 |Global loss: 5.8367| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 3|  NKD Loss: 1.0088
Epoch: 3|  Loss:  1.6601 |Global loss: 5.8208| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 0|  NKD Loss: 0.9428
Epoch: 0|  Loss:  1.2638 |Global loss: 5.7991| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9587
Epoch: 1|  Loss:  1.2846 |Global loss: 5.8018| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9477
Epoch: 2|  Loss:  1.2664 |Global loss: 5.8065| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9532
Epoch: 3|  Loss:  1.2687 |Global loss: 5.791| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9442
Epoch: 0|  Loss:  1.4151 |Global loss: 5.7497| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.9177
Epoch: 1|  Loss:  1.3967 |Global loss: 5.7666| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.9336
Epoch: 2|  Loss:  1.409 |Global loss: 5.76| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.923
Epoch: 3|  Loss:  1.385 |Global loss: 5.7705| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.9104
Epoch: 0|  Loss:  1.1512 |Global loss: 5.7419| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.8948
Epoch: 1|  Loss:  1.1357 |Global loss: 5.7505| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9082
Epoch: 2|  Loss:  1.1479 |Global loss: 5.7408| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.8795
Epoch: 3|  Loss:  1.1191 |Global loss: 5.7555| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.914
Epoch: 0|  Loss:  1.1628 |Global loss: 5.7433| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.913
Epoch: 1|  Loss:  1.1612 |Global loss: 5.7417| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.1563 |Global loss: 5.7402| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9121
Epoch: 3|  Loss:  1.1583 |Global loss: 5.7444| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9016
Epoch: 0|  Loss:  1.153 |Global loss: 5.7186| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.8818
Epoch: 1|  Loss:  1.1328 |Global loss: 5.7297| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 2|  NKD Loss: 0.8966
Epoch: 2|  Loss:  1.1507 |Global loss: 5.7224| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.8774
Epoch: 3|  Loss:  1.1302 |Global loss: 5.7305| Local H loss: 0.0398  | Global H loss: 0.0398
------------------------- time cost ------------------------- 3.151538610458374
Chosen Clients:  [12, 6, 10, 2, 8, 11]

-------------Round number: 400-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.917, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.805, 119.163, 117.951, 118.934, 118.096, 117.686, 117.475, 118.84, 119.135, 119.045, 118.352, 119.042, 115.823, 115.32, 119.271]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.916, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.851, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.931, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2527
Averaged Test Accurancy: 0.9150
Averaged Test AUC: 0.9839
Averaged Test F1_score: 0.9069
Averaged Test Recal score: 0.9263
Std Test Accurancy: 0.0892
Std Test AUC: 0.0100
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 1.0205
Epoch: 0|  Loss:  1.6886 |Global loss: 5.8141| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 1|  NKD Loss: 0.9712
Epoch: 1|  Loss:  1.6263 |Global loss: 5.8422| Local H loss: 0.0432  | Global H loss: 0.0432
Epoch: 2|  NKD Loss: 1.0041
Epoch: 2|  Loss:  1.675 |Global loss: 5.8178| Local H loss: 0.0436  | Global H loss: 0.0436
Epoch: 3|  NKD Loss: 1.0116
Epoch: 3|  Loss:  1.663 |Global loss: 5.8125| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 0|  NKD Loss: 0.9491
Epoch: 0|  Loss:  1.2708 |Global loss: 5.7568| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9507
Epoch: 1|  Loss:  1.2668 |Global loss: 5.7572| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9299
Epoch: 2|  Loss:  1.2479 |Global loss: 5.7726| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.921
Epoch: 3|  Loss:  1.2402 |Global loss: 5.7745| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9065
Epoch: 0|  Loss:  1.1531 |Global loss: 5.7447| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8914
Epoch: 1|  Loss:  1.1405 |Global loss: 5.7539| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.905
Epoch: 2|  Loss:  1.1485 |Global loss: 5.747| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 3|  NKD Loss: 0.897
Epoch: 3|  Loss:  1.1452 |Global loss: 5.7493| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9549
Epoch: 0|  Loss:  1.2656 |Global loss: 5.7926| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9541
Epoch: 1|  Loss:  1.2753 |Global loss: 5.7983| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9286
Epoch: 2|  Loss:  1.2369 |Global loss: 5.8124| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9584
Epoch: 3|  Loss:  1.2829 |Global loss: 5.801| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.8941
Epoch: 0|  Loss:  1.126 |Global loss: 5.7436| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.9145
Epoch: 1|  Loss:  1.1501 |Global loss: 5.727| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.8805
Epoch: 2|  Loss:  1.1166 |Global loss: 5.7557| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.897
Epoch: 3|  Loss:  1.1307 |Global loss: 5.7353| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.9048
Epoch: 0|  Loss:  1.1349 |Global loss: 5.7227| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.8981
Epoch: 1|  Loss:  1.1242 |Global loss: 5.7298| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8918
Epoch: 2|  Loss:  1.117 |Global loss: 5.7331| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9107
Epoch: 3|  Loss:  1.1359 |Global loss: 5.7214| Local H loss: 0.0256  | Global H loss: 0.0256
------------------------- time cost ------------------------- 3.09783673286438
Chosen Clients:  [14, 1, 7, 8, 13, 4]

-------------Round number: 401-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [116.805, 119.163, 118.004, 118.934, 118.096, 117.686, 117.528, 118.84, 119.126, 119.045, 118.354, 119.045, 116.097, 115.32, 119.271]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.936, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.729, 0.851, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.771, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2485
Averaged Test Accurancy: 0.9172
Averaged Test AUC: 0.9841
Averaged Test F1_score: 0.9088
Averaged Test Recal score: 0.9276
Std Test Accurancy: 0.0826
Std Test AUC: 0.0098
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9221
Epoch: 0|  Loss:  1.1481 |Global loss: 5.7246| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.8958
Epoch: 1|  Loss:  1.1313 |Global loss: 5.7445| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9023
Epoch: 2|  Loss:  1.1386 |Global loss: 5.7412| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.9079
Epoch: 3|  Loss:  1.1438 |Global loss: 5.7325| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9367
Epoch: 0|  Loss:  1.2243 |Global loss: 5.7652| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9365
Epoch: 1|  Loss:  1.2119 |Global loss: 5.7713| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9366
Epoch: 2|  Loss:  1.2284 |Global loss: 5.7707| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9391
Epoch: 3|  Loss:  1.2277 |Global loss: 5.7626| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9064
Epoch: 0|  Loss:  1.1426 |Global loss: 5.742| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.8846
Epoch: 1|  Loss:  1.1224 |Global loss: 5.7572| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9057
Epoch: 2|  Loss:  1.1373 |Global loss: 5.7454| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.8966
Epoch: 3|  Loss:  1.1354 |Global loss: 5.7426| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9126
Epoch: 0|  Loss:  1.1448 |Global loss: 5.7314| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.8881
Epoch: 1|  Loss:  1.1024 |Global loss: 5.7447| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.8855
Epoch: 2|  Loss:  1.1178 |Global loss: 5.7494| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 3|  NKD Loss: 0.8993
Epoch: 3|  Loss:  1.1314 |Global loss: 5.7399| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.9294
Epoch: 0|  Loss:  1.3961 |Global loss: 5.7636| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.9277
Epoch: 1|  Loss:  1.3918 |Global loss: 5.7539| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.9137
Epoch: 2|  Loss:  1.3774 |Global loss: 5.7635| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.9337
Epoch: 3|  Loss:  1.3981 |Global loss: 5.756| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.3499 |Global loss: 5.7253| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.9104
Epoch: 1|  Loss:  1.3443 |Global loss: 5.7255| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 0.8955
Epoch: 2|  Loss:  1.3365 |Global loss: 5.7345| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 0.9153
Epoch: 3|  Loss:  1.3492 |Global loss: 5.7186| Local H loss: 0.0233  | Global H loss: 0.0233
------------------------- time cost ------------------------- 3.145871162414551
Chosen Clients:  [5, 7, 4, 11, 14, 9]

-------------Round number: 402-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.842, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [116.805, 119.229, 118.004, 118.934, 118.107, 117.686, 117.528, 118.83, 119.087, 119.045, 118.354, 119.045, 116.097, 115.392, 119.25]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.766, 0.936, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.729, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.817, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.771, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2478
Averaged Test Accurancy: 0.9178
Averaged Test AUC: 0.9841
Averaged Test F1_score: 0.9089
Averaged Test Recal score: 0.9281
Std Test Accurancy: 0.0821
Std Test AUC: 0.0097
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9713
Epoch: 0|  Loss:  1.3448 |Global loss: 5.7808| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9773
Epoch: 1|  Loss:  1.3457 |Global loss: 5.775| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9772
Epoch: 2|  Loss:  1.3514 |Global loss: 5.7835| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9678
Epoch: 3|  Loss:  1.3382 |Global loss: 5.7837| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9054
Epoch: 0|  Loss:  1.138 |Global loss: 5.7382| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.8993
Epoch: 1|  Loss:  1.1349 |Global loss: 5.7456| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.9134
Epoch: 2|  Loss:  1.149 |Global loss: 5.7431| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.911
Epoch: 3|  Loss:  1.1474 |Global loss: 5.7354| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9231
Epoch: 0|  Loss:  1.3693 |Global loss: 5.7166| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 0.912
Epoch: 1|  Loss:  1.3458 |Global loss: 5.7243| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 2|  NKD Loss: 0.8943
Epoch: 2|  Loss:  1.3374 |Global loss: 5.733| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 3|  NKD Loss: 0.9244
Epoch: 3|  Loss:  1.3609 |Global loss: 5.7147| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 0|  NKD Loss: 0.9153
Epoch: 0|  Loss:  1.1316 |Global loss: 5.7125| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.8853
Epoch: 1|  Loss:  1.1052 |Global loss: 5.7327| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.9047
Epoch: 2|  Loss:  1.1295 |Global loss: 5.7263| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.9045
Epoch: 3|  Loss:  1.1311 |Global loss: 5.7229| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 0.9082
Epoch: 0|  Loss:  1.133 |Global loss: 5.7314| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 1|  NKD Loss: 0.8764
Epoch: 1|  Loss:  1.1143 |Global loss: 5.7575| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9015
Epoch: 2|  Loss:  1.1216 |Global loss: 5.7375| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9209
Epoch: 3|  Loss:  1.1561 |Global loss: 5.722| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.8478
Epoch: 0|  Loss:  1.0627 |Global loss: 5.7395| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.8766
Epoch: 1|  Loss:  1.0911 |Global loss: 5.7199| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.889
Epoch: 2|  Loss:  1.1015 |Global loss: 5.7073| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.8707
Epoch: 3|  Loss:  1.0689 |Global loss: 5.7214| Local H loss: 0.0274  | Global H loss: 0.0274
------------------------- time cost ------------------------- 3.14249849319458
Chosen Clients:  [8, 12, 11, 4, 5, 6]

-------------Round number: 403-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.958, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [116.805, 119.229, 118.004, 118.934, 118.093, 117.689, 117.528, 118.844, 119.087, 119.03, 118.354, 118.937, 116.097, 115.392, 119.282]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.955, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.729, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.963, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.771, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2506
Averaged Test Accurancy: 0.9183
Averaged Test AUC: 0.9841
Averaged Test F1_score: 0.9098
Averaged Test Recal score: 0.9287
Std Test Accurancy: 0.0831
Std Test AUC: 0.0096
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9073
Epoch: 0|  Loss:  1.1401 |Global loss: 5.7331| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.9024
Epoch: 1|  Loss:  1.1342 |Global loss: 5.7275| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.8943
Epoch: 2|  Loss:  1.1263 |Global loss: 5.7428| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9215
Epoch: 3|  Loss:  1.1533 |Global loss: 5.7242| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.999
Epoch: 0|  Loss:  1.6379 |Global loss: 5.8217| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 1|  NKD Loss: 0.9997
Epoch: 1|  Loss:  1.6678 |Global loss: 5.827| Local H loss: 0.044  | Global H loss: 0.044
Epoch: 2|  NKD Loss: 0.9879
Epoch: 2|  Loss:  1.6502 |Global loss: 5.8323| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 3|  NKD Loss: 0.9893
Epoch: 3|  Loss:  1.6522 |Global loss: 5.8331| Local H loss: 0.0439  | Global H loss: 0.0439
Epoch: 0|  NKD Loss: 0.8972
Epoch: 0|  Loss:  1.11 |Global loss: 5.73| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.8743
Epoch: 1|  Loss:  1.0734 |Global loss: 5.741| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.9056
Epoch: 2|  Loss:  1.1292 |Global loss: 5.7225| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.8907
Epoch: 3|  Loss:  1.1069 |Global loss: 5.7342| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9194
Epoch: 0|  Loss:  1.3356 |Global loss: 5.7115| Local H loss: 0.0233  | Global H loss: 0.0233
Epoch: 1|  NKD Loss: 0.8808
Epoch: 1|  Loss:  1.3125 |Global loss: 5.7329| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 2|  NKD Loss: 0.8898
Epoch: 2|  Loss:  1.3393 |Global loss: 5.7365| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 3|  NKD Loss: 0.9137
Epoch: 3|  Loss:  1.3296 |Global loss: 5.7114| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 0|  NKD Loss: 0.9671
Epoch: 0|  Loss:  1.3452 |Global loss: 5.7881| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9596
Epoch: 1|  Loss:  1.3356 |Global loss: 5.7888| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9721
Epoch: 2|  Loss:  1.3492 |Global loss: 5.7837| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9552
Epoch: 3|  Loss:  1.3364 |Global loss: 5.7963| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9375
Epoch: 0|  Loss:  1.2559 |Global loss: 5.7631| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9159
Epoch: 1|  Loss:  1.2324 |Global loss: 5.7737| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.942
Epoch: 2|  Loss:  1.254 |Global loss: 5.7581| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9443
Epoch: 3|  Loss:  1.2627 |Global loss: 5.7626| Local H loss: 0.0312  | Global H loss: 0.0312
------------------------- time cost ------------------------- 2.8334169387817383
Chosen Clients:  [8, 2, 4, 9, 1, 5]

-------------Round number: 404-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.958, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [116.805, 119.229, 118.004, 118.934, 118.107, 117.704, 117.532, 118.844, 119.159, 119.03, 118.354, 119.012, 116.069, 115.392, 119.282]
F1 Score:  [0.748, 0.971, 0.903, 0.982, 0.761, 0.954, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.924, 0.986, 0.81, 0.961, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2464
Averaged Test Accurancy: 0.9183
Averaged Test AUC: 0.9841
Averaged Test F1_score: 0.9096
Averaged Test Recal score: 0.9286
Std Test Accurancy: 0.0818
Std Test AUC: 0.0097
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9093
Epoch: 0|  Loss:  1.1378 |Global loss: 5.7314| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.889
Epoch: 1|  Loss:  1.1224 |Global loss: 5.7468| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.8929
Epoch: 2|  Loss:  1.118 |Global loss: 5.7406| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 3|  NKD Loss: 0.9034
Epoch: 3|  Loss:  1.1346 |Global loss: 5.7256| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9533
Epoch: 0|  Loss:  1.2773 |Global loss: 5.7964| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9808
Epoch: 1|  Loss:  1.3047 |Global loss: 5.7868| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.959
Epoch: 2|  Loss:  1.2797 |Global loss: 5.7917| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9352
Epoch: 3|  Loss:  1.2482 |Global loss: 5.807| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9199
Epoch: 0|  Loss:  1.3632 |Global loss: 5.7183| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.9195
Epoch: 1|  Loss:  1.3568 |Global loss: 5.7131| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.9266
Epoch: 2|  Loss:  1.3465 |Global loss: 5.7105| Local H loss: 0.0234  | Global H loss: 0.0234
Epoch: 3|  NKD Loss: 0.9038
Epoch: 3|  Loss:  1.3309 |Global loss: 5.7272| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 0|  NKD Loss: 0.8697
Epoch: 0|  Loss:  1.0854 |Global loss: 5.7195| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.8971
Epoch: 1|  Loss:  1.1092 |Global loss: 5.7048| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.8916
Epoch: 2|  Loss:  1.1046 |Global loss: 5.7079| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.8851
Epoch: 3|  Loss:  1.0995 |Global loss: 5.7072| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9283
Epoch: 0|  Loss:  1.2197 |Global loss: 5.7741| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9333
Epoch: 1|  Loss:  1.2211 |Global loss: 5.7705| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9147
Epoch: 2|  Loss:  1.1785 |Global loss: 5.7666| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9487
Epoch: 3|  Loss:  1.2326 |Global loss: 5.7589| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9712
Epoch: 0|  Loss:  1.3472 |Global loss: 5.7752| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9582
Epoch: 1|  Loss:  1.3296 |Global loss: 5.7922| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9508
Epoch: 2|  Loss:  1.33 |Global loss: 5.7938| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9549
Epoch: 3|  Loss:  1.3228 |Global loss: 5.7865| Local H loss: 0.0272  | Global H loss: 0.0272
------------------------- time cost ------------------------- 3.052000045776367
Chosen Clients:  [12, 8, 11, 13, 9, 1]

-------------Round number: 405-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [116.805, 119.218, 117.925, 118.934, 118.111, 117.78, 117.532, 118.844, 119.175, 119.085, 118.354, 119.012, 116.069, 115.392, 119.282]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2477
Averaged Test Accurancy: 0.9189
Averaged Test AUC: 0.9842
Averaged Test F1_score: 0.9103
Averaged Test Recal score: 0.9293
Std Test Accurancy: 0.0814
Std Test AUC: 0.0097
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9927
Epoch: 0|  Loss:  1.6404 |Global loss: 5.8276| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 1|  NKD Loss: 0.9993
Epoch: 1|  Loss:  1.6474 |Global loss: 5.8187| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 2|  NKD Loss: 0.9835
Epoch: 2|  Loss:  1.646 |Global loss: 5.8267| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 3|  NKD Loss: 1.0042
Epoch: 3|  Loss:  1.6482 |Global loss: 5.8193| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 0|  NKD Loss: 0.8932
Epoch: 0|  Loss:  1.121 |Global loss: 5.7405| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 1|  NKD Loss: 0.8967
Epoch: 1|  Loss:  1.1262 |Global loss: 5.7344| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 2|  NKD Loss: 0.9074
Epoch: 2|  Loss:  1.1369 |Global loss: 5.7343| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 3|  NKD Loss: 0.9071
Epoch: 3|  Loss:  1.1387 |Global loss: 5.7331| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 0|  NKD Loss: 0.9182
Epoch: 0|  Loss:  1.1465 |Global loss: 5.7138| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.8973
Epoch: 1|  Loss:  1.1184 |Global loss: 5.7265| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.902
Epoch: 2|  Loss:  1.1206 |Global loss: 5.7164| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.8933
Epoch: 3|  Loss:  1.1172 |Global loss: 5.7231| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9398
Epoch: 0|  Loss:  1.413 |Global loss: 5.7546| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.9399
Epoch: 1|  Loss:  1.4117 |Global loss: 5.7489| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.9483
Epoch: 2|  Loss:  1.396 |Global loss: 5.7515| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 3|  NKD Loss: 0.9391
Epoch: 3|  Loss:  1.4118 |Global loss: 5.752| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.8959
Epoch: 0|  Loss:  1.1093 |Global loss: 5.701| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.8687
Epoch: 1|  Loss:  1.0817 |Global loss: 5.7232| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.8834
Epoch: 2|  Loss:  1.0954 |Global loss: 5.712| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.8821
Epoch: 3|  Loss:  1.091 |Global loss: 5.707| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9261
Epoch: 0|  Loss:  1.2144 |Global loss: 5.7711| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9049
Epoch: 1|  Loss:  1.1937 |Global loss: 5.7914| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9431
Epoch: 2|  Loss:  1.2118 |Global loss: 5.7646| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9473
Epoch: 3|  Loss:  1.2342 |Global loss: 5.7587| Local H loss: 0.0278  | Global H loss: 0.0278
------------------------- time cost ------------------------- 2.7360012531280518
Chosen Clients:  [13, 11, 8, 7, 0, 14]

-------------Round number: 406-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.675, 0.85, 0.975]
AUC in each clients:  [116.805, 119.211, 117.925, 118.934, 118.111, 117.78, 117.532, 118.844, 119.162, 119.092, 118.354, 119.059, 115.816, 115.44, 119.282]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.675, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.721, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2503
Averaged Test Accurancy: 0.9144
Averaged Test AUC: 0.9841
Averaged Test F1_score: 0.9065
Averaged Test Recal score: 0.9255
Std Test Accurancy: 0.0921
Std Test AUC: 0.0100
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.9148
Epoch: 0|  Loss:  1.3675 |Global loss: 5.7648| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9396
Epoch: 1|  Loss:  1.3882 |Global loss: 5.756| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.9504
Epoch: 2|  Loss:  1.4148 |Global loss: 5.7376| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.942
Epoch: 3|  Loss:  1.4125 |Global loss: 5.7537| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 0|  NKD Loss: 0.8983
Epoch: 0|  Loss:  1.1243 |Global loss: 5.7288| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8705
Epoch: 1|  Loss:  1.0804 |Global loss: 5.7439| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.8972
Epoch: 2|  Loss:  1.1247 |Global loss: 5.7242| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9026
Epoch: 3|  Loss:  1.1206 |Global loss: 5.7252| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.8991
Epoch: 0|  Loss:  1.1295 |Global loss: 5.7338| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 1|  NKD Loss: 0.8944
Epoch: 1|  Loss:  1.1228 |Global loss: 5.7445| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.8856
Epoch: 2|  Loss:  1.1152 |Global loss: 5.7465| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.866
Epoch: 3|  Loss:  1.0974 |Global loss: 5.7583| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.8901
Epoch: 0|  Loss:  1.1183 |Global loss: 5.7441| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.9072
Epoch: 1|  Loss:  1.1425 |Global loss: 5.7402| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.8919
Epoch: 2|  Loss:  1.1278 |Global loss: 5.7421| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.9059
Epoch: 3|  Loss:  1.1355 |Global loss: 5.7402| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.9121
Epoch: 0|  Loss:  1.2926 |Global loss: 5.7738| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9371
Epoch: 1|  Loss:  1.315 |Global loss: 5.7532| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9459
Epoch: 2|  Loss:  1.3198 |Global loss: 5.7484| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9351
Epoch: 3|  Loss:  1.3153 |Global loss: 5.7607| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9124
Epoch: 0|  Loss:  1.147 |Global loss: 5.734| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.8984
Epoch: 1|  Loss:  1.1335 |Global loss: 5.7425| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9158
Epoch: 2|  Loss:  1.1315 |Global loss: 5.7292| Local H loss: 0.028  | Global H loss: 0.028
Epoch: 3|  NKD Loss: 0.9039
Epoch: 3|  Loss:  1.1333 |Global loss: 5.7414| Local H loss: 0.0277  | Global H loss: 0.0277
------------------------- time cost ------------------------- 3.076450824737549
Chosen Clients:  [4, 6, 3, 8, 12, 13]

-------------Round number: 407-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.925, 0.975, 0.975, 0.983, 0.958, 0.983, 0.675, 0.85, 0.975]
AUC in each clients:  [116.767, 119.211, 117.925, 118.934, 118.111, 117.78, 117.532, 118.849, 119.158, 119.092, 118.354, 119.065, 115.816, 115.452, 119.212]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.923, 0.971, 0.97, 0.981, 0.949, 0.98, 0.675, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.936, 0.977, 0.977, 0.984, 0.956, 0.984, 0.721, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2396
Averaged Test Accurancy: 0.9144
Averaged Test AUC: 0.9840
Averaged Test F1_score: 0.9065
Averaged Test Recal score: 0.9255
Std Test Accurancy: 0.0921
Std Test AUC: 0.0099
Std Test F1: 0.0008
Std Test Recall: 0.0007
Epoch: 0|  NKD Loss: 0.901
Epoch: 0|  Loss:  1.3309 |Global loss: 5.7293| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 1|  NKD Loss: 0.9103
Epoch: 1|  Loss:  1.3381 |Global loss: 5.7156| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.9203
Epoch: 2|  Loss:  1.3548 |Global loss: 5.7096| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 0.9216
Epoch: 3|  Loss:  1.3474 |Global loss: 5.7115| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 0|  NKD Loss: 0.9511
Epoch: 0|  Loss:  1.2691 |Global loss: 5.7539| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9153
Epoch: 1|  Loss:  1.2314 |Global loss: 5.7769| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9355
Epoch: 2|  Loss:  1.2405 |Global loss: 5.7619| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9278
Epoch: 3|  Loss:  1.2291 |Global loss: 5.7621| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8867
Epoch: 0|  Loss:  1.1278 |Global loss: 5.7252| Local H loss: 0.0403  | Global H loss: 0.0403
Epoch: 1|  NKD Loss: 0.883
Epoch: 1|  Loss:  1.1347 |Global loss: 5.7272| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.8829
Epoch: 2|  Loss:  1.1249 |Global loss: 5.7266| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.8779
Epoch: 3|  Loss:  1.1297 |Global loss: 5.7305| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 0|  NKD Loss: 0.8988
Epoch: 0|  Loss:  1.1276 |Global loss: 5.7321| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.8799
Epoch: 1|  Loss:  1.1088 |Global loss: 5.748| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.8929
Epoch: 2|  Loss:  1.1223 |Global loss: 5.7406| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9014
Epoch: 3|  Loss:  1.1098 |Global loss: 5.7265| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 0|  NKD Loss: 0.9989
Epoch: 0|  Loss:  1.6458 |Global loss: 5.8203| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 1|  NKD Loss: 0.999
Epoch: 1|  Loss:  1.6481 |Global loss: 5.8215| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 2|  NKD Loss: 0.9782
Epoch: 2|  Loss:  1.6319 |Global loss: 5.8321| Local H loss: 0.0435  | Global H loss: 0.0435
Epoch: 3|  NKD Loss: 0.9987
Epoch: 3|  Loss:  1.6473 |Global loss: 5.8214| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 0|  NKD Loss: 0.914
Epoch: 0|  Loss:  1.3647 |Global loss: 5.7605| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9243
Epoch: 1|  Loss:  1.366 |Global loss: 5.7563| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.9437
Epoch: 2|  Loss:  1.4258 |Global loss: 5.747| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.9287
Epoch: 3|  Loss:  1.392 |Global loss: 5.7616| Local H loss: 0.0343  | Global H loss: 0.0343
------------------------- time cost ------------------------- 2.8790807723999023
Chosen Clients:  [2, 4, 5, 11, 10, 1]

-------------Round number: 408-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.767, 119.211, 117.925, 118.941, 118.103, 117.78, 117.564, 118.849, 119.167, 119.092, 118.354, 119.065, 116.028, 115.486, 119.212]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2474
Averaged Test Accurancy: 0.9178
Averaged Test AUC: 0.9842
Averaged Test F1_score: 0.9087
Averaged Test Recal score: 0.9282
Std Test Accurancy: 0.0852
Std Test AUC: 0.0097
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9555
Epoch: 0|  Loss:  1.274 |Global loss: 5.797| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.959
Epoch: 1|  Loss:  1.2789 |Global loss: 5.7897| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9568
Epoch: 2|  Loss:  1.2636 |Global loss: 5.7865| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9434
Epoch: 3|  Loss:  1.2527 |Global loss: 5.7991| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9204
Epoch: 0|  Loss:  1.3596 |Global loss: 5.7201| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 1|  NKD Loss: 0.9167
Epoch: 1|  Loss:  1.3595 |Global loss: 5.7175| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 2|  NKD Loss: 0.9295
Epoch: 2|  Loss:  1.3617 |Global loss: 5.701| Local H loss: 0.0232  | Global H loss: 0.0232
Epoch: 3|  NKD Loss: 0.9114
Epoch: 3|  Loss:  1.3431 |Global loss: 5.7177| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 0.9619
Epoch: 0|  Loss:  1.3345 |Global loss: 5.7883| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9658
Epoch: 1|  Loss:  1.3234 |Global loss: 5.7845| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9683
Epoch: 2|  Loss:  1.3351 |Global loss: 5.7737| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9704
Epoch: 3|  Loss:  1.3257 |Global loss: 5.7797| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.908
Epoch: 0|  Loss:  1.1331 |Global loss: 5.7177| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8929
Epoch: 1|  Loss:  1.1199 |Global loss: 5.7263| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.9007
Epoch: 2|  Loss:  1.1254 |Global loss: 5.7219| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.9002
Epoch: 3|  Loss:  1.126 |Global loss: 5.7256| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.9225
Epoch: 0|  Loss:  1.1631 |Global loss: 5.7326| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.9007
Epoch: 1|  Loss:  1.1448 |Global loss: 5.7444| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.887
Epoch: 2|  Loss:  1.1279 |Global loss: 5.7556| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9145
Epoch: 3|  Loss:  1.1619 |Global loss: 5.7423| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9279
Epoch: 0|  Loss:  1.2165 |Global loss: 5.7694| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9191
Epoch: 1|  Loss:  1.2089 |Global loss: 5.7757| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9285
Epoch: 2|  Loss:  1.1998 |Global loss: 5.7677| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9363
Epoch: 3|  Loss:  1.2196 |Global loss: 5.7648| Local H loss: 0.0278  | Global H loss: 0.0278
------------------------- time cost ------------------------- 3.160459280014038
Chosen Clients:  [14, 8, 1, 6, 13, 10]

-------------Round number: 409-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.767, 119.228, 117.961, 118.941, 118.105, 117.75, 117.564, 118.849, 119.167, 119.092, 118.392, 119.055, 116.028, 115.486, 119.212]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.938, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2435
Averaged Test Accurancy: 0.9178
Averaged Test AUC: 0.9842
Averaged Test F1_score: 0.9088
Averaged Test Recal score: 0.9282
Std Test Accurancy: 0.0852
Std Test AUC: 0.0097
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9117
Epoch: 0|  Loss:  1.1468 |Global loss: 5.7291| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9121
Epoch: 1|  Loss:  1.1447 |Global loss: 5.7324| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.8749
Epoch: 2|  Loss:  1.0991 |Global loss: 5.753| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9031
Epoch: 3|  Loss:  1.1352 |Global loss: 5.7365| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.8865
Epoch: 0|  Loss:  1.1121 |Global loss: 5.7472| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 0.9061
Epoch: 1|  Loss:  1.1355 |Global loss: 5.7299| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.8864
Epoch: 2|  Loss:  1.1137 |Global loss: 5.7447| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.9003
Epoch: 3|  Loss:  1.1291 |Global loss: 5.732| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9573
Epoch: 0|  Loss:  1.2387 |Global loss: 5.7477| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9444
Epoch: 1|  Loss:  1.2292 |Global loss: 5.7612| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9276
Epoch: 2|  Loss:  1.2125 |Global loss: 5.7638| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9398
Epoch: 3|  Loss:  1.2159 |Global loss: 5.7602| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.253 |Global loss: 5.7562| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9369
Epoch: 1|  Loss:  1.2478 |Global loss: 5.7618| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9285
Epoch: 2|  Loss:  1.2414 |Global loss: 5.7644| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9367
Epoch: 3|  Loss:  1.243 |Global loss: 5.7606| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9172
Epoch: 0|  Loss:  1.3775 |Global loss: 5.7635| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.9303
Epoch: 1|  Loss:  1.394 |Global loss: 5.7495| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.9358
Epoch: 2|  Loss:  1.401 |Global loss: 5.7475| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.9338
Epoch: 3|  Loss:  1.3959 |Global loss: 5.7543| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.1675 |Global loss: 5.7329| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.9124
Epoch: 1|  Loss:  1.1568 |Global loss: 5.7384| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.8928
Epoch: 2|  Loss:  1.139 |Global loss: 5.752| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.8791
Epoch: 3|  Loss:  1.1247 |Global loss: 5.7614| Local H loss: 0.0365  | Global H loss: 0.0365
------------------------- time cost ------------------------- 3.006343126296997
Chosen Clients:  [0, 13, 7, 14, 12, 3]

-------------Round number: 410-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.767, 119.245, 117.961, 118.941, 118.105, 117.75, 117.557, 118.849, 119.155, 119.092, 118.389, 119.055, 116.028, 115.615, 119.245]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.938, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2381
Averaged Test Accurancy: 0.9178
Averaged Test AUC: 0.9843
Averaged Test F1_score: 0.9088
Averaged Test Recal score: 0.9282
Std Test Accurancy: 0.0852
Std Test AUC: 0.0095
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9234
Epoch: 0|  Loss:  1.3014 |Global loss: 5.7616| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9552
Epoch: 1|  Loss:  1.3308 |Global loss: 5.7474| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.934
Epoch: 2|  Loss:  1.316 |Global loss: 5.7582| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9281
Epoch: 3|  Loss:  1.3072 |Global loss: 5.7611| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9237
Epoch: 0|  Loss:  1.3899 |Global loss: 5.7649| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9368
Epoch: 1|  Loss:  1.3924 |Global loss: 5.7493| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.9214
Epoch: 2|  Loss:  1.3807 |Global loss: 5.7565| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 3|  NKD Loss: 0.9287
Epoch: 3|  Loss:  1.3894 |Global loss: 5.7585| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.8928
Epoch: 0|  Loss:  1.1307 |Global loss: 5.7457| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.9063
Epoch: 1|  Loss:  1.1403 |Global loss: 5.7374| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.8644
Epoch: 2|  Loss:  1.0986 |Global loss: 5.7609| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.911
Epoch: 3|  Loss:  1.136 |Global loss: 5.7358| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9187
Epoch: 0|  Loss:  1.1499 |Global loss: 5.7263| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9107
Epoch: 1|  Loss:  1.1425 |Global loss: 5.7322| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 2|  NKD Loss: 0.9092
Epoch: 2|  Loss:  1.1401 |Global loss: 5.7313| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9
Epoch: 3|  Loss:  1.1211 |Global loss: 5.734| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.985
Epoch: 0|  Loss:  1.6397 |Global loss: 5.8304| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 1|  NKD Loss: 0.981
Epoch: 1|  Loss:  1.6156 |Global loss: 5.8249| Local H loss: 0.0438  | Global H loss: 0.0438
Epoch: 2|  NKD Loss: 1.01
Epoch: 2|  Loss:  1.6571 |Global loss: 5.8143| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 3|  NKD Loss: 1.0001
Epoch: 3|  Loss:  1.6496 |Global loss: 5.8232| Local H loss: 0.0442  | Global H loss: 0.0442
Epoch: 0|  NKD Loss: 0.8812
Epoch: 0|  Loss:  1.1322 |Global loss: 5.731| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.9018
Epoch: 1|  Loss:  1.1532 |Global loss: 5.7146| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.8969
Epoch: 2|  Loss:  1.1475 |Global loss: 5.7219| Local H loss: 0.0401  | Global H loss: 0.0401
Epoch: 3|  NKD Loss: 0.8766
Epoch: 3|  Loss:  1.1263 |Global loss: 5.7326| Local H loss: 0.0401  | Global H loss: 0.0401
------------------------- time cost ------------------------- 3.0681748390197754
Chosen Clients:  [10, 14, 4, 7, 8, 11]

-------------Round number: 411-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.761, 119.245, 117.961, 118.935, 118.105, 117.75, 117.557, 118.936, 119.155, 119.092, 118.389, 119.055, 115.994, 115.577, 119.296]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.938, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2455
Averaged Test Accurancy: 0.9161
Averaged Test AUC: 0.9843
Averaged Test F1_score: 0.9076
Averaged Test Recal score: 0.9270
Std Test Accurancy: 0.0893
Std Test AUC: 0.0097
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.913
Epoch: 0|  Loss:  1.1585 |Global loss: 5.737| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9193
Epoch: 1|  Loss:  1.1642 |Global loss: 5.7306| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.926
Epoch: 2|  Loss:  1.1685 |Global loss: 5.7328| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.9046
Epoch: 3|  Loss:  1.1501 |Global loss: 5.7422| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.8847
Epoch: 0|  Loss:  1.1164 |Global loss: 5.7498| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9115
Epoch: 1|  Loss:  1.1433 |Global loss: 5.7344| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.8948
Epoch: 2|  Loss:  1.1118 |Global loss: 5.7385| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8891
Epoch: 3|  Loss:  1.1201 |Global loss: 5.7431| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9021
Epoch: 0|  Loss:  1.3355 |Global loss: 5.7241| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.9176
Epoch: 1|  Loss:  1.3451 |Global loss: 5.7142| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 2|  NKD Loss: 0.8966
Epoch: 2|  Loss:  1.3265 |Global loss: 5.7207| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 0.9141
Epoch: 3|  Loss:  1.336 |Global loss: 5.7097| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 0.9138
Epoch: 0|  Loss:  1.1472 |Global loss: 5.7321| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.8926
Epoch: 1|  Loss:  1.1211 |Global loss: 5.7487| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.9062
Epoch: 2|  Loss:  1.1388 |Global loss: 5.7365| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.8991
Epoch: 3|  Loss:  1.1276 |Global loss: 5.7473| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 0|  NKD Loss: 0.9074
Epoch: 0|  Loss:  1.127 |Global loss: 5.7202| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.9053
Epoch: 1|  Loss:  1.1328 |Global loss: 5.7306| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 2|  NKD Loss: 0.9063
Epoch: 2|  Loss:  1.1317 |Global loss: 5.7307| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.899
Epoch: 3|  Loss:  1.1269 |Global loss: 5.7313| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.912
Epoch: 0|  Loss:  1.1378 |Global loss: 5.7146| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9017
Epoch: 1|  Loss:  1.1126 |Global loss: 5.7184| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.9024
Epoch: 2|  Loss:  1.1207 |Global loss: 5.7164| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.897
Epoch: 3|  Loss:  1.1184 |Global loss: 5.7242| Local H loss: 0.0252  | Global H loss: 0.0252
------------------------- time cost ------------------------- 2.7325634956359863
Chosen Clients:  [7, 4, 5, 11, 8, 0]

-------------Round number: 412-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.761, 119.245, 117.961, 118.935, 118.105, 117.75, 117.557, 118.931, 119.162, 119.092, 118.417, 119.077, 115.994, 115.577, 119.308]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.938, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2420
Averaged Test Accurancy: 0.9161
Averaged Test AUC: 0.9844
Averaged Test F1_score: 0.9076
Averaged Test Recal score: 0.9270
Std Test Accurancy: 0.0893
Std Test AUC: 0.0097
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8742
Epoch: 0|  Loss:  1.1061 |Global loss: 5.7542| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.9055
Epoch: 1|  Loss:  1.14 |Global loss: 5.7271| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.8978
Epoch: 2|  Loss:  1.1179 |Global loss: 5.7368| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.8911
Epoch: 3|  Loss:  1.1256 |Global loss: 5.7434| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 0|  NKD Loss: 0.9181
Epoch: 0|  Loss:  1.3533 |Global loss: 5.7163| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.9184
Epoch: 1|  Loss:  1.3467 |Global loss: 5.7134| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 2|  NKD Loss: 0.9148
Epoch: 2|  Loss:  1.3505 |Global loss: 5.7139| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 3|  NKD Loss: 0.9169
Epoch: 3|  Loss:  1.3452 |Global loss: 5.7152| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 0.9712
Epoch: 0|  Loss:  1.3383 |Global loss: 5.7742| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9718
Epoch: 1|  Loss:  1.3443 |Global loss: 5.7769| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.941
Epoch: 2|  Loss:  1.3128 |Global loss: 5.7926| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9487
Epoch: 3|  Loss:  1.3156 |Global loss: 5.7964| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9138
Epoch: 0|  Loss:  1.1354 |Global loss: 5.716| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.9023
Epoch: 1|  Loss:  1.1258 |Global loss: 5.7158| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.8855
Epoch: 2|  Loss:  1.1085 |Global loss: 5.7351| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.8982
Epoch: 3|  Loss:  1.1222 |Global loss: 5.7268| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.8992
Epoch: 0|  Loss:  1.1228 |Global loss: 5.7313| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.92
Epoch: 1|  Loss:  1.1444 |Global loss: 5.7174| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.9062
Epoch: 2|  Loss:  1.1308 |Global loss: 5.7323| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.9056
Epoch: 3|  Loss:  1.1335 |Global loss: 5.7252| Local H loss: 0.0349  | Global H loss: 0.0349
Epoch: 0|  NKD Loss: 0.9336
Epoch: 0|  Loss:  1.2954 |Global loss: 5.7588| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9465
Epoch: 1|  Loss:  1.3227 |Global loss: 5.7437| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9556
Epoch: 2|  Loss:  1.3339 |Global loss: 5.7432| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9342
Epoch: 3|  Loss:  1.3095 |Global loss: 5.7574| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 3.0885701179504395
Chosen Clients:  [0, 1, 3, 13, 9, 4]

-------------Round number: 413-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.782, 119.245, 117.961, 118.935, 118.113, 117.795, 117.557, 118.95, 119.167, 119.092, 118.417, 119.051, 115.994, 115.577, 119.308]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2436
Averaged Test Accurancy: 0.9161
Averaged Test AUC: 0.9844
Averaged Test F1_score: 0.9075
Averaged Test Recal score: 0.9270
Std Test Accurancy: 0.0893
Std Test AUC: 0.0097
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9226
Epoch: 0|  Loss:  1.2962 |Global loss: 5.7577| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.94
Epoch: 1|  Loss:  1.3119 |Global loss: 5.7481| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9243
Epoch: 2|  Loss:  1.299 |Global loss: 5.7552| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9511
Epoch: 3|  Loss:  1.3268 |Global loss: 5.7466| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.9542
Epoch: 0|  Loss:  1.2367 |Global loss: 5.7528| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9303
Epoch: 1|  Loss:  1.2067 |Global loss: 5.7681| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9393
Epoch: 2|  Loss:  1.2076 |Global loss: 5.7546| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9267
Epoch: 3|  Loss:  1.2063 |Global loss: 5.7686| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9029
Epoch: 0|  Loss:  1.1542 |Global loss: 5.7144| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 1|  NKD Loss: 0.8975
Epoch: 1|  Loss:  1.1454 |Global loss: 5.7211| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 0.8908
Epoch: 2|  Loss:  1.1368 |Global loss: 5.7185| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.9129
Epoch: 3|  Loss:  1.1458 |Global loss: 5.7121| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 0|  NKD Loss: 0.9365
Epoch: 0|  Loss:  1.3815 |Global loss: 5.747| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.9351
Epoch: 1|  Loss:  1.3987 |Global loss: 5.7409| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.9399
Epoch: 2|  Loss:  1.3989 |Global loss: 5.7477| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.9463
Epoch: 3|  Loss:  1.4067 |Global loss: 5.7416| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.8819
Epoch: 0|  Loss:  1.0798 |Global loss: 5.7104| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.8853
Epoch: 1|  Loss:  1.0965 |Global loss: 5.712| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.8835
Epoch: 2|  Loss:  1.0836 |Global loss: 5.7084| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.8727
Epoch: 3|  Loss:  1.0852 |Global loss: 5.7189| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.3281 |Global loss: 5.716| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.8962
Epoch: 1|  Loss:  1.3168 |Global loss: 5.7257| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 0.9083
Epoch: 2|  Loss:  1.3398 |Global loss: 5.7192| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 3|  NKD Loss: 0.9109
Epoch: 3|  Loss:  1.328 |Global loss: 5.703| Local H loss: 0.0231  | Global H loss: 0.0231
------------------------- time cost ------------------------- 2.8081743717193604
Chosen Clients:  [9, 4, 8, 2, 7, 6]

-------------Round number: 414-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.933, 0.983, 0.833, 0.942, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.874, 119.244, 117.961, 118.94, 118.11, 117.795, 117.557, 118.95, 119.167, 119.1, 118.417, 119.051, 115.994, 115.604, 119.308]
F1 Score:  [0.748, 0.971, 0.932, 0.982, 0.761, 0.936, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.949, 0.986, 0.81, 0.946, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2424
Averaged Test Accurancy: 0.9161
Averaged Test AUC: 0.9845
Averaged Test F1_score: 0.9075
Averaged Test Recal score: 0.9270
Std Test Accurancy: 0.0893
Std Test AUC: 0.0096
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9002
Epoch: 0|  Loss:  1.1103 |Global loss: 5.7007| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.8857
Epoch: 1|  Loss:  1.096 |Global loss: 5.7054| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9006
Epoch: 2|  Loss:  1.1115 |Global loss: 5.6993| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9003
Epoch: 3|  Loss:  1.1114 |Global loss: 5.6946| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9193
Epoch: 0|  Loss:  1.3501 |Global loss: 5.7095| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 1|  NKD Loss: 0.9218
Epoch: 1|  Loss:  1.3591 |Global loss: 5.7091| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 0.92
Epoch: 2|  Loss:  1.3596 |Global loss: 5.7166| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 0.9189
Epoch: 3|  Loss:  1.3542 |Global loss: 5.7122| Local H loss: 0.023  | Global H loss: 0.023
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.1271 |Global loss: 5.7269| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 1|  NKD Loss: 0.915
Epoch: 1|  Loss:  1.1399 |Global loss: 5.7185| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 2|  NKD Loss: 0.915
Epoch: 2|  Loss:  1.1404 |Global loss: 5.7203| Local H loss: 0.035  | Global H loss: 0.035
Epoch: 3|  NKD Loss: 0.9209
Epoch: 3|  Loss:  1.1484 |Global loss: 5.7117| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9665
Epoch: 0|  Loss:  1.2879 |Global loss: 5.7911| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9764
Epoch: 1|  Loss:  1.3005 |Global loss: 5.7853| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9269
Epoch: 2|  Loss:  1.2419 |Global loss: 5.8116| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9393
Epoch: 3|  Loss:  1.258 |Global loss: 5.8075| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.91
Epoch: 0|  Loss:  1.1412 |Global loss: 5.7295| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.9091
Epoch: 1|  Loss:  1.1369 |Global loss: 5.7307| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.9063
Epoch: 2|  Loss:  1.1391 |Global loss: 5.7305| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.9066
Epoch: 3|  Loss:  1.1372 |Global loss: 5.7356| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9387
Epoch: 0|  Loss:  1.2374 |Global loss: 5.7532| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9244
Epoch: 1|  Loss:  1.2228 |Global loss: 5.7638| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9532
Epoch: 2|  Loss:  1.2632 |Global loss: 5.7495| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9451
Epoch: 3|  Loss:  1.252 |Global loss: 5.7481| Local H loss: 0.0315  | Global H loss: 0.0315
------------------------- time cost ------------------------- 2.792435646057129
Chosen Clients:  [2, 3, 13, 8, 4, 0]

-------------Round number: 415-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.75, 0.975, 0.908, 0.983, 0.833, 0.942, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.874, 119.244, 117.852, 118.94, 118.113, 117.795, 117.562, 118.947, 119.171, 119.095, 118.417, 119.051, 115.994, 115.604, 119.308]
F1 Score:  [0.748, 0.971, 0.909, 0.982, 0.761, 0.936, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.809, 0.977, 0.932, 0.986, 0.81, 0.946, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2426
Averaged Test Accurancy: 0.9150
Averaged Test AUC: 0.9844
Averaged Test F1_score: 0.9066
Averaged Test Recal score: 0.9265
Std Test Accurancy: 0.0893
Std Test AUC: 0.0096
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9757
Epoch: 0|  Loss:  1.2982 |Global loss: 5.778| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9682
Epoch: 1|  Loss:  1.2851 |Global loss: 5.7896| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9671
Epoch: 2|  Loss:  1.2783 |Global loss: 5.7812| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9485
Epoch: 3|  Loss:  1.2502 |Global loss: 5.7921| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.8829
Epoch: 0|  Loss:  1.132 |Global loss: 5.7241| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.8833
Epoch: 1|  Loss:  1.1289 |Global loss: 5.7279| Local H loss: 0.0402  | Global H loss: 0.0402
Epoch: 2|  NKD Loss: 0.8973
Epoch: 2|  Loss:  1.1435 |Global loss: 5.7134| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 3|  NKD Loss: 0.9063
Epoch: 3|  Loss:  1.1524 |Global loss: 5.7048| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 0|  NKD Loss: 0.9455
Epoch: 0|  Loss:  1.4127 |Global loss: 5.7449| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.9259
Epoch: 1|  Loss:  1.362 |Global loss: 5.7508| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.9237
Epoch: 2|  Loss:  1.3716 |Global loss: 5.7517| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.9445
Epoch: 3|  Loss:  1.4057 |Global loss: 5.7376| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.9003
Epoch: 0|  Loss:  1.123 |Global loss: 5.7292| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 1|  NKD Loss: 0.8919
Epoch: 1|  Loss:  1.1116 |Global loss: 5.7295| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 2|  NKD Loss: 0.9129
Epoch: 2|  Loss:  1.1302 |Global loss: 5.718| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 3|  NKD Loss: 0.8952
Epoch: 3|  Loss:  1.1028 |Global loss: 5.7209| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 0|  NKD Loss: 0.9186
Epoch: 0|  Loss:  1.3548 |Global loss: 5.7135| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 1|  NKD Loss: 0.9147
Epoch: 1|  Loss:  1.3516 |Global loss: 5.7183| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 0.9242
Epoch: 2|  Loss:  1.3637 |Global loss: 5.7074| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 0.9257
Epoch: 3|  Loss:  1.3549 |Global loss: 5.7082| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 0|  NKD Loss: 0.9293
Epoch: 0|  Loss:  1.3074 |Global loss: 5.7593| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9421
Epoch: 1|  Loss:  1.3194 |Global loss: 5.751| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9477
Epoch: 2|  Loss:  1.3143 |Global loss: 5.7438| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9362
Epoch: 3|  Loss:  1.3076 |Global loss: 5.7523| Local H loss: 0.0248  | Global H loss: 0.0248
------------------------- time cost ------------------------- 2.943356990814209
Chosen Clients:  [2, 7, 13, 0, 9, 12]

-------------Round number: 416-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.975, 0.933, 0.983, 0.833, 0.942, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.886, 119.244, 118.109, 118.939, 118.111, 117.795, 117.562, 118.947, 119.226, 119.095, 118.417, 119.051, 115.994, 115.68, 119.308]
F1 Score:  [0.759, 0.971, 0.932, 0.982, 0.761, 0.936, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.814, 0.977, 0.949, 0.986, 0.81, 0.946, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2471
Averaged Test Accurancy: 0.9172
Averaged Test AUC: 0.9846
Averaged Test F1_score: 0.9089
Averaged Test Recal score: 0.9279
Std Test Accurancy: 0.0884
Std Test AUC: 0.0095
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9589
Epoch: 0|  Loss:  1.2703 |Global loss: 5.7823| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9551
Epoch: 1|  Loss:  1.2593 |Global loss: 5.7847| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9423
Epoch: 2|  Loss:  1.2557 |Global loss: 5.8037| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9574
Epoch: 3|  Loss:  1.2681 |Global loss: 5.7887| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.8954
Epoch: 0|  Loss:  1.1252 |Global loss: 5.7346| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.8876
Epoch: 1|  Loss:  1.1189 |Global loss: 5.7422| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.8938
Epoch: 2|  Loss:  1.1231 |Global loss: 5.7405| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.9131
Epoch: 3|  Loss:  1.1436 |Global loss: 5.7261| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.9388
Epoch: 0|  Loss:  1.3963 |Global loss: 5.7433| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 0.9387
Epoch: 1|  Loss:  1.388 |Global loss: 5.7419| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.927
Epoch: 2|  Loss:  1.3616 |Global loss: 5.7538| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.9359
Epoch: 3|  Loss:  1.3832 |Global loss: 5.7366| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.9214
Epoch: 0|  Loss:  1.2981 |Global loss: 5.762| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.9473
Epoch: 1|  Loss:  1.3025 |Global loss: 5.7392| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9503
Epoch: 2|  Loss:  1.3246 |Global loss: 5.7474| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9364
Epoch: 3|  Loss:  1.3074 |Global loss: 5.7524| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.8993
Epoch: 0|  Loss:  1.1122 |Global loss: 5.6961| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.8931
Epoch: 1|  Loss:  1.1041 |Global loss: 5.7021| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.8843
Epoch: 2|  Loss:  1.0917 |Global loss: 5.7011| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.8858
Epoch: 3|  Loss:  1.0954 |Global loss: 5.6988| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9963
Epoch: 0|  Loss:  1.6426 |Global loss: 5.8223| Local H loss: 0.0441  | Global H loss: 0.0441
Epoch: 1|  NKD Loss: 1.0004
Epoch: 1|  Loss:  1.639 |Global loss: 5.8178| Local H loss: 0.0444  | Global H loss: 0.0444
Epoch: 2|  NKD Loss: 1.0037
Epoch: 2|  Loss:  1.6175 |Global loss: 5.8064| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 3|  NKD Loss: 0.9781
Epoch: 3|  Loss:  1.6222 |Global loss: 5.8301| Local H loss: 0.0436  | Global H loss: 0.0436
------------------------- time cost ------------------------- 3.047534465789795
Chosen Clients:  [5, 3, 8, 10, 0, 1]

-------------Round number: 417-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.775, 0.975, 0.933, 0.983, 0.833, 0.942, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.923, 119.244, 118.065, 118.939, 118.111, 117.795, 117.562, 118.958, 119.226, 119.098, 118.417, 119.051, 116.205, 115.682, 119.308]
F1 Score:  [0.774, 0.971, 0.932, 0.982, 0.761, 0.936, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.828, 0.977, 0.949, 0.986, 0.81, 0.946, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2406
Averaged Test Accurancy: 0.9200
Averaged Test AUC: 0.9848
Averaged Test F1_score: 0.9119
Averaged Test Recal score: 0.9302
Std Test Accurancy: 0.0823
Std Test AUC: 0.0093
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9653
Epoch: 0|  Loss:  1.3341 |Global loss: 5.7774| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9581
Epoch: 1|  Loss:  1.3138 |Global loss: 5.7867| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9543
Epoch: 2|  Loss:  1.295 |Global loss: 5.7862| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9556
Epoch: 3|  Loss:  1.3228 |Global loss: 5.7845| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8946
Epoch: 0|  Loss:  1.1391 |Global loss: 5.7186| Local H loss: 0.04  | Global H loss: 0.04
Epoch: 1|  NKD Loss: 0.8763
Epoch: 1|  Loss:  1.1241 |Global loss: 5.732| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 2|  NKD Loss: 0.8974
Epoch: 2|  Loss:  1.1435 |Global loss: 5.7146| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 3|  NKD Loss: 0.8905
Epoch: 3|  Loss:  1.1366 |Global loss: 5.7195| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 0|  NKD Loss: 0.8792
Epoch: 0|  Loss:  1.1038 |Global loss: 5.7449| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.9065
Epoch: 1|  Loss:  1.1317 |Global loss: 5.7245| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 2|  NKD Loss: 0.9124
Epoch: 2|  Loss:  1.1387 |Global loss: 5.7146| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.8923
Epoch: 3|  Loss:  1.1159 |Global loss: 5.7297| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.9058
Epoch: 0|  Loss:  1.1456 |Global loss: 5.7324| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.9203
Epoch: 1|  Loss:  1.1599 |Global loss: 5.7272| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.9204
Epoch: 2|  Loss:  1.1648 |Global loss: 5.7297| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9137
Epoch: 3|  Loss:  1.1568 |Global loss: 5.7379| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.933
Epoch: 0|  Loss:  1.3039 |Global loss: 5.7532| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.952
Epoch: 1|  Loss:  1.3186 |Global loss: 5.7367| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9411
Epoch: 2|  Loss:  1.3095 |Global loss: 5.7479| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9495
Epoch: 3|  Loss:  1.3163 |Global loss: 5.7476| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.931
Epoch: 0|  Loss:  1.211 |Global loss: 5.765| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9435
Epoch: 1|  Loss:  1.2214 |Global loss: 5.754| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9474
Epoch: 2|  Loss:  1.2245 |Global loss: 5.7533| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9257
Epoch: 3|  Loss:  1.2086 |Global loss: 5.7656| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 3.0402374267578125
Chosen Clients:  [0, 6, 13, 5, 2, 9]

-------------Round number: 418-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.933, 0.983, 0.833, 0.958, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.925, 119.252, 118.065, 118.945, 118.111, 117.811, 117.562, 118.958, 119.164, 119.098, 118.43, 119.051, 116.205, 115.682, 119.308]
F1 Score:  [0.764, 0.971, 0.932, 0.982, 0.761, 0.955, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.823, 0.977, 0.949, 0.986, 0.81, 0.963, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2391
Averaged Test Accurancy: 0.9206
Averaged Test AUC: 0.9848
Averaged Test F1_score: 0.9125
Averaged Test Recal score: 0.9310
Std Test Accurancy: 0.0837
Std Test AUC: 0.0093
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.944
Epoch: 0|  Loss:  1.3104 |Global loss: 5.7444| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9312
Epoch: 1|  Loss:  1.2973 |Global loss: 5.7525| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9192
Epoch: 2|  Loss:  1.2857 |Global loss: 5.7576| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9474
Epoch: 3|  Loss:  1.3183 |Global loss: 5.7428| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.2536 |Global loss: 5.7565| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.95
Epoch: 1|  Loss:  1.2598 |Global loss: 5.7484| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9419
Epoch: 2|  Loss:  1.2394 |Global loss: 5.7544| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9289
Epoch: 3|  Loss:  1.2336 |Global loss: 5.76| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.9369
Epoch: 0|  Loss:  1.3937 |Global loss: 5.7496| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9434
Epoch: 1|  Loss:  1.4033 |Global loss: 5.7397| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.9292
Epoch: 2|  Loss:  1.3799 |Global loss: 5.7464| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.9389
Epoch: 3|  Loss:  1.3851 |Global loss: 5.7461| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9664
Epoch: 0|  Loss:  1.3369 |Global loss: 5.7795| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9633
Epoch: 1|  Loss:  1.3287 |Global loss: 5.7801| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9529
Epoch: 2|  Loss:  1.3084 |Global loss: 5.7798| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9554
Epoch: 3|  Loss:  1.3193 |Global loss: 5.7875| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9623
Epoch: 0|  Loss:  1.2677 |Global loss: 5.7761| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9537
Epoch: 1|  Loss:  1.2633 |Global loss: 5.7875| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9746
Epoch: 2|  Loss:  1.2864 |Global loss: 5.7794| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9492
Epoch: 3|  Loss:  1.2569 |Global loss: 5.7906| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.88
Epoch: 0|  Loss:  1.0849 |Global loss: 5.7074| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.8763
Epoch: 1|  Loss:  1.0862 |Global loss: 5.7072| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.8774
Epoch: 2|  Loss:  1.088 |Global loss: 5.7077| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.891
Epoch: 3|  Loss:  1.1005 |Global loss: 5.696| Local H loss: 0.027  | Global H loss: 0.027
------------------------- time cost ------------------------- 2.6533451080322266
Chosen Clients:  [2, 14, 6, 13, 0, 4]

-------------Round number: 419-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.975, 0.933, 0.983, 0.833, 0.958, 0.933, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.908, 119.252, 118.16, 118.945, 118.111, 117.801, 117.597, 118.958, 119.164, 119.101, 118.43, 119.051, 116.205, 115.677, 119.308]
F1 Score:  [0.759, 0.971, 0.932, 0.982, 0.761, 0.955, 0.929, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.814, 0.977, 0.949, 0.986, 0.81, 0.963, 0.942, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2329
Averaged Test Accurancy: 0.9194
Averaged Test AUC: 0.9848
Averaged Test F1_score: 0.9115
Averaged Test Recal score: 0.9298
Std Test Accurancy: 0.0846
Std Test AUC: 0.0093
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.928
Epoch: 0|  Loss:  1.2372 |Global loss: 5.8064| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9575
Epoch: 1|  Loss:  1.2624 |Global loss: 5.7856| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9412
Epoch: 2|  Loss:  1.2459 |Global loss: 5.7928| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9554
Epoch: 3|  Loss:  1.259 |Global loss: 5.7873| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9182
Epoch: 0|  Loss:  1.1474 |Global loss: 5.7232| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9099
Epoch: 1|  Loss:  1.1375 |Global loss: 5.7252| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9036
Epoch: 2|  Loss:  1.1333 |Global loss: 5.7333| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 3|  NKD Loss: 0.8961
Epoch: 3|  Loss:  1.1267 |Global loss: 5.742| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.9273
Epoch: 0|  Loss:  1.2369 |Global loss: 5.7647| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9425
Epoch: 1|  Loss:  1.2346 |Global loss: 5.7531| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9279
Epoch: 2|  Loss:  1.2292 |Global loss: 5.766| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9537
Epoch: 3|  Loss:  1.2593 |Global loss: 5.7422| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9345
Epoch: 0|  Loss:  1.3824 |Global loss: 5.7466| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 0.9426
Epoch: 1|  Loss:  1.393 |Global loss: 5.7455| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.9419
Epoch: 2|  Loss:  1.3993 |Global loss: 5.7415| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.9392
Epoch: 3|  Loss:  1.3844 |Global loss: 5.7332| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9211
Epoch: 0|  Loss:  1.2782 |Global loss: 5.7563| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9378
Epoch: 1|  Loss:  1.3066 |Global loss: 5.7492| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9444
Epoch: 2|  Loss:  1.3101 |Global loss: 5.7436| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9463
Epoch: 3|  Loss:  1.3147 |Global loss: 5.7404| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.3377 |Global loss: 5.7163| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.8994
Epoch: 1|  Loss:  1.3399 |Global loss: 5.7245| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 0.8977
Epoch: 2|  Loss:  1.3225 |Global loss: 5.721| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 0.9104
Epoch: 3|  Loss:  1.3502 |Global loss: 5.7178| Local H loss: 0.0228  | Global H loss: 0.0228
------------------------- time cost ------------------------- 2.922318935394287
Chosen Clients:  [5, 9, 1, 10, 6, 0]

-------------Round number: 420-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.758, 0.975, 0.933, 0.983, 0.833, 0.958, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.955, 119.252, 118.094, 118.945, 118.12, 117.801, 117.65, 118.958, 119.164, 119.101, 118.43, 119.051, 116.205, 115.752, 119.31]
F1 Score:  [0.759, 0.971, 0.932, 0.982, 0.761, 0.955, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.843, 0.971]
Recall Score:  [0.814, 0.977, 0.949, 0.986, 0.81, 0.963, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2351
Averaged Test Accurancy: 0.9200
Averaged Test AUC: 0.9849
Averaged Test F1_score: 0.9119
Averaged Test Recal score: 0.9304
Std Test Accurancy: 0.0847
Std Test AUC: 0.0091
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9707
Epoch: 0|  Loss:  1.3314 |Global loss: 5.7761| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9513
Epoch: 1|  Loss:  1.31 |Global loss: 5.7781| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.962
Epoch: 2|  Loss:  1.3254 |Global loss: 5.7819| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9796
Epoch: 3|  Loss:  1.3394 |Global loss: 5.7694| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.8818
Epoch: 0|  Loss:  1.0929 |Global loss: 5.7058| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.8866
Epoch: 1|  Loss:  1.0817 |Global loss: 5.7061| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.8833
Epoch: 2|  Loss:  1.0909 |Global loss: 5.707| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.8837
Epoch: 3|  Loss:  1.0935 |Global loss: 5.7038| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.951
Epoch: 0|  Loss:  1.2288 |Global loss: 5.7495| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 1|  NKD Loss: 0.9547
Epoch: 1|  Loss:  1.2342 |Global loss: 5.7444| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9327
Epoch: 2|  Loss:  1.2089 |Global loss: 5.7612| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9505
Epoch: 3|  Loss:  1.2283 |Global loss: 5.7433| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 0|  NKD Loss: 0.9064
Epoch: 0|  Loss:  1.1491 |Global loss: 5.7469| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9202
Epoch: 1|  Loss:  1.1621 |Global loss: 5.734| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.9251
Epoch: 2|  Loss:  1.1653 |Global loss: 5.73| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.8902
Epoch: 3|  Loss:  1.1328 |Global loss: 5.7486| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9275
Epoch: 0|  Loss:  1.2376 |Global loss: 5.7635| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9347
Epoch: 1|  Loss:  1.2386 |Global loss: 5.7559| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9337
Epoch: 2|  Loss:  1.2345 |Global loss: 5.7564| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9418
Epoch: 3|  Loss:  1.2489 |Global loss: 5.756| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9443
Epoch: 0|  Loss:  1.3081 |Global loss: 5.7426| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9436
Epoch: 1|  Loss:  1.3091 |Global loss: 5.7423| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9379
Epoch: 2|  Loss:  1.3 |Global loss: 5.7462| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9258
Epoch: 3|  Loss:  1.2907 |Global loss: 5.7552| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 2.9076435565948486
Chosen Clients:  [10, 0, 9, 4, 6, 3]

-------------Round number: 421-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.783, 0.975, 0.933, 0.983, 0.833, 0.942, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.996, 119.273, 118.094, 118.945, 118.12, 117.842, 117.655, 118.958, 119.164, 119.092, 118.442, 119.051, 116.205, 115.752, 119.31]
F1 Score:  [0.783, 0.971, 0.932, 0.982, 0.761, 0.936, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.843, 0.971]
Recall Score:  [0.834, 0.977, 0.949, 0.986, 0.81, 0.946, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2369
Averaged Test Accurancy: 0.9206
Averaged Test AUC: 0.9849
Averaged Test F1_score: 0.9122
Averaged Test Recal score: 0.9306
Std Test Accurancy: 0.0813
Std Test AUC: 0.0091
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9107
Epoch: 0|  Loss:  1.1463 |Global loss: 5.7374| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.8979
Epoch: 1|  Loss:  1.1312 |Global loss: 5.7417| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9172
Epoch: 2|  Loss:  1.1577 |Global loss: 5.7297| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.8882
Epoch: 3|  Loss:  1.1254 |Global loss: 5.7481| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 0|  NKD Loss: 0.9212
Epoch: 0|  Loss:  1.2818 |Global loss: 5.759| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9345
Epoch: 1|  Loss:  1.2842 |Global loss: 5.7421| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9074
Epoch: 2|  Loss:  1.2672 |Global loss: 5.7648| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9518
Epoch: 3|  Loss:  1.3168 |Global loss: 5.7346| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8876
Epoch: 0|  Loss:  1.0822 |Global loss: 5.706| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.868
Epoch: 1|  Loss:  1.0779 |Global loss: 5.7199| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.875
Epoch: 2|  Loss:  1.0852 |Global loss: 5.7125| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.8969
Epoch: 3|  Loss:  1.104 |Global loss: 5.7022| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8952
Epoch: 0|  Loss:  1.3138 |Global loss: 5.7197| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.9117
Epoch: 1|  Loss:  1.3463 |Global loss: 5.7175| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 0.9163
Epoch: 2|  Loss:  1.3302 |Global loss: 5.7057| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 3|  NKD Loss: 0.9084
Epoch: 3|  Loss:  1.3366 |Global loss: 5.7144| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 0|  NKD Loss: 0.9329
Epoch: 0|  Loss:  1.2354 |Global loss: 5.7564| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9223
Epoch: 1|  Loss:  1.2125 |Global loss: 5.7614| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9258
Epoch: 2|  Loss:  1.2279 |Global loss: 5.7596| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9371
Epoch: 3|  Loss:  1.2281 |Global loss: 5.7477| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.872
Epoch: 0|  Loss:  1.1159 |Global loss: 5.7302| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.8875
Epoch: 1|  Loss:  1.1342 |Global loss: 5.7252| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8952
Epoch: 2|  Loss:  1.1409 |Global loss: 5.7113| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 3|  NKD Loss: 0.8712
Epoch: 3|  Loss:  1.104 |Global loss: 5.7223| Local H loss: 0.0398  | Global H loss: 0.0398
------------------------- time cost ------------------------- 2.95800518989563
Chosen Clients:  [0, 7, 5, 3, 6, 2]

-------------Round number: 422-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.933, 0.983, 0.833, 0.942, 0.942, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.964, 119.273, 118.094, 118.939, 118.111, 117.842, 117.666, 118.958, 119.164, 119.096, 118.433, 119.051, 116.205, 115.752, 119.31]
F1 Score:  [0.769, 0.971, 0.932, 0.982, 0.761, 0.936, 0.939, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.843, 0.971]
Recall Score:  [0.82, 0.977, 0.949, 0.986, 0.81, 0.946, 0.951, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2306
Averaged Test Accurancy: 0.9194
Averaged Test AUC: 0.9849
Averaged Test F1_score: 0.9113
Averaged Test Recal score: 0.9297
Std Test Accurancy: 0.0833
Std Test AUC: 0.0091
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.933
Epoch: 0|  Loss:  1.2892 |Global loss: 5.7398| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9457
Epoch: 1|  Loss:  1.3064 |Global loss: 5.7413| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9443
Epoch: 2|  Loss:  1.3016 |Global loss: 5.7385| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9537
Epoch: 3|  Loss:  1.32 |Global loss: 5.739| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9225
Epoch: 0|  Loss:  1.1501 |Global loss: 5.7195| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.9123
Epoch: 1|  Loss:  1.1425 |Global loss: 5.7225| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.8987
Epoch: 2|  Loss:  1.1271 |Global loss: 5.7321| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.8914
Epoch: 3|  Loss:  1.118 |Global loss: 5.7366| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.9653
Epoch: 0|  Loss:  1.328 |Global loss: 5.7782| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9568
Epoch: 1|  Loss:  1.3015 |Global loss: 5.7714| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.962
Epoch: 2|  Loss:  1.3184 |Global loss: 5.7762| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.953
Epoch: 3|  Loss:  1.3115 |Global loss: 5.7815| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8741
Epoch: 0|  Loss:  1.1184 |Global loss: 5.729| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 1|  NKD Loss: 0.8968
Epoch: 1|  Loss:  1.1411 |Global loss: 5.7156| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.1563 |Global loss: 5.7054| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.8553
Epoch: 3|  Loss:  1.0943 |Global loss: 5.7398| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9284
Epoch: 0|  Loss:  1.2324 |Global loss: 5.7602| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.2094 |Global loss: 5.7621| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9273
Epoch: 2|  Loss:  1.2294 |Global loss: 5.7562| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9011
Epoch: 3|  Loss:  1.2013 |Global loss: 5.7667| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9622
Epoch: 0|  Loss:  1.2641 |Global loss: 5.7748| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.96
Epoch: 1|  Loss:  1.2675 |Global loss: 5.7779| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.954
Epoch: 2|  Loss:  1.2672 |Global loss: 5.7896| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9458
Epoch: 3|  Loss:  1.2512 |Global loss: 5.7839| Local H loss: 0.0365  | Global H loss: 0.0365
------------------------- time cost ------------------------- 3.240356922149658
Chosen Clients:  [8, 9, 10, 7, 4, 0]

-------------Round number: 423-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.975, 0.942, 0.983, 0.833, 0.958, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [117.073, 119.273, 118.336, 118.939, 118.111, 117.876, 117.755, 118.954, 119.164, 119.096, 118.433, 119.051, 116.205, 115.752, 119.31]
F1 Score:  [0.791, 0.971, 0.939, 0.982, 0.761, 0.955, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.843, 0.971]
Recall Score:  [0.839, 0.977, 0.955, 0.986, 0.81, 0.963, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2313
Averaged Test Accurancy: 0.9233
Averaged Test AUC: 0.9852
Averaged Test F1_score: 0.9149
Averaged Test Recal score: 0.9328
Std Test Accurancy: 0.0810
Std Test AUC: 0.0090
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9036
Epoch: 0|  Loss:  1.12 |Global loss: 5.7286| Local H loss: 0.0348  | Global H loss: 0.0348
Epoch: 1|  NKD Loss: 0.8976
Epoch: 1|  Loss:  1.1195 |Global loss: 5.7324| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.8802
Epoch: 2|  Loss:  1.1016 |Global loss: 5.7328| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.8983
Epoch: 3|  Loss:  1.1178 |Global loss: 5.7263| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 0|  NKD Loss: 0.8875
Epoch: 0|  Loss:  1.0967 |Global loss: 5.7004| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.8764
Epoch: 1|  Loss:  1.085 |Global loss: 5.7104| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.8758
Epoch: 2|  Loss:  1.0852 |Global loss: 5.71| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.8896
Epoch: 3|  Loss:  1.0988 |Global loss: 5.6959| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9132
Epoch: 0|  Loss:  1.1484 |Global loss: 5.736| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.9181
Epoch: 1|  Loss:  1.159 |Global loss: 5.7279| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.8833
Epoch: 2|  Loss:  1.1218 |Global loss: 5.7519| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9179
Epoch: 3|  Loss:  1.1539 |Global loss: 5.7336| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 0|  NKD Loss: 0.9107
Epoch: 0|  Loss:  1.1345 |Global loss: 5.7234| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 1|  NKD Loss: 0.9113
Epoch: 1|  Loss:  1.1368 |Global loss: 5.7237| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 2|  NKD Loss: 0.9008
Epoch: 2|  Loss:  1.1277 |Global loss: 5.7257| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 3|  NKD Loss: 0.8899
Epoch: 3|  Loss:  1.1176 |Global loss: 5.7381| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.8993
Epoch: 0|  Loss:  1.3195 |Global loss: 5.7213| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.9323
Epoch: 1|  Loss:  1.3644 |Global loss: 5.7016| Local H loss: 0.0229  | Global H loss: 0.0229
Epoch: 2|  NKD Loss: 0.9137
Epoch: 2|  Loss:  1.3375 |Global loss: 5.7118| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 3|  NKD Loss: 0.9332
Epoch: 3|  Loss:  1.3475 |Global loss: 5.6936| Local H loss: 0.0231  | Global H loss: 0.0231
Epoch: 0|  NKD Loss: 0.9435
Epoch: 0|  Loss:  1.3042 |Global loss: 5.7417| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9478
Epoch: 1|  Loss:  1.3018 |Global loss: 5.7334| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9441
Epoch: 2|  Loss:  1.3049 |Global loss: 5.7416| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9517
Epoch: 3|  Loss:  1.3157 |Global loss: 5.7399| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 2.782740592956543
Chosen Clients:  [14, 12, 13, 11, 2, 9]

-------------Round number: 424-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.942, 0.983, 0.842, 0.958, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [116.999, 119.273, 118.336, 118.939, 118.116, 117.876, 117.755, 118.959, 119.174, 119.093, 118.439, 119.051, 116.205, 115.752, 119.31]
F1 Score:  [0.769, 0.971, 0.939, 0.982, 0.766, 0.955, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.843, 0.971]
Recall Score:  [0.82, 0.977, 0.955, 0.986, 0.817, 0.963, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2363
Averaged Test Accurancy: 0.9222
Averaged Test AUC: 0.9852
Averaged Test F1_score: 0.9138
Averaged Test Recal score: 0.9320
Std Test Accurancy: 0.0834
Std Test AUC: 0.0091
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8898
Epoch: 0|  Loss:  1.1135 |Global loss: 5.7306| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.8834
Epoch: 1|  Loss:  1.102 |Global loss: 5.7412| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9124
Epoch: 2|  Loss:  1.141 |Global loss: 5.7297| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9179
Epoch: 3|  Loss:  1.1456 |Global loss: 5.7221| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.0025
Epoch: 0|  Loss:  1.6392 |Global loss: 5.8222| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 1|  NKD Loss: 1.0012
Epoch: 1|  Loss:  1.6302 |Global loss: 5.8064| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 2|  NKD Loss: 0.99
Epoch: 2|  Loss:  1.6145 |Global loss: 5.8214| Local H loss: 0.045  | Global H loss: 0.045
Epoch: 3|  NKD Loss: 0.9905
Epoch: 3|  Loss:  1.6114 |Global loss: 5.8203| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 0|  NKD Loss: 0.9305
Epoch: 0|  Loss:  1.3786 |Global loss: 5.7463| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.9461
Epoch: 1|  Loss:  1.4047 |Global loss: 5.7392| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 2|  NKD Loss: 0.9372
Epoch: 2|  Loss:  1.3786 |Global loss: 5.7446| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.9379
Epoch: 3|  Loss:  1.3777 |Global loss: 5.7432| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.9003
Epoch: 0|  Loss:  1.1179 |Global loss: 5.7226| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.8763
Epoch: 1|  Loss:  1.0973 |Global loss: 5.7323| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9065
Epoch: 2|  Loss:  1.1143 |Global loss: 5.7137| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.9134
Epoch: 3|  Loss:  1.1368 |Global loss: 5.7158| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.9554
Epoch: 0|  Loss:  1.2609 |Global loss: 5.783| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9563
Epoch: 1|  Loss:  1.2522 |Global loss: 5.7762| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9321
Epoch: 2|  Loss:  1.2259 |Global loss: 5.7922| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9322
Epoch: 3|  Loss:  1.2342 |Global loss: 5.7953| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8627
Epoch: 0|  Loss:  1.0722 |Global loss: 5.7193| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.8883
Epoch: 1|  Loss:  1.0922 |Global loss: 5.699| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.8768
Epoch: 2|  Loss:  1.0868 |Global loss: 5.7044| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.8822
Epoch: 3|  Loss:  1.076 |Global loss: 5.7074| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 3.0972278118133545
Chosen Clients:  [10, 6, 7, 4, 14, 12]

-------------Round number: 425-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.958, 0.983, 0.842, 0.958, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [116.999, 119.273, 118.455, 118.939, 118.116, 117.876, 117.755, 118.959, 119.174, 119.091, 118.439, 119.063, 116.076, 115.781, 119.31]
F1 Score:  [0.769, 0.971, 0.955, 0.982, 0.766, 0.955, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.847, 0.971]
Recall Score:  [0.82, 0.977, 0.966, 0.986, 0.817, 0.963, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2328
Averaged Test Accurancy: 0.9217
Averaged Test AUC: 0.9852
Averaged Test F1_score: 0.9131
Averaged Test Recal score: 0.9314
Std Test Accurancy: 0.0880
Std Test AUC: 0.0092
Std Test F1: 0.0008
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9112
Epoch: 0|  Loss:  1.1508 |Global loss: 5.7289| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.9101
Epoch: 1|  Loss:  1.1407 |Global loss: 5.7332| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 2|  NKD Loss: 0.9172
Epoch: 2|  Loss:  1.1522 |Global loss: 5.7326| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.8959
Epoch: 3|  Loss:  1.1345 |Global loss: 5.7426| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9266
Epoch: 0|  Loss:  1.2263 |Global loss: 5.7638| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9545
Epoch: 1|  Loss:  1.25 |Global loss: 5.7449| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.2184 |Global loss: 5.7619| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9241
Epoch: 3|  Loss:  1.2251 |Global loss: 5.7579| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8918
Epoch: 0|  Loss:  1.1189 |Global loss: 5.7405| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 1|  NKD Loss: 0.911
Epoch: 1|  Loss:  1.1389 |Global loss: 5.7259| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 2|  NKD Loss: 0.887
Epoch: 2|  Loss:  1.1146 |Global loss: 5.733| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.8773
Epoch: 3|  Loss:  1.089 |Global loss: 5.7394| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 0|  NKD Loss: 0.9222
Epoch: 0|  Loss:  1.3475 |Global loss: 5.7089| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 1|  NKD Loss: 0.8981
Epoch: 1|  Loss:  1.3353 |Global loss: 5.72| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 0.9068
Epoch: 2|  Loss:  1.3344 |Global loss: 5.7154| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 0.9153
Epoch: 3|  Loss:  1.3433 |Global loss: 5.7104| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 0.917
Epoch: 0|  Loss:  1.1415 |Global loss: 5.7184| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.1315 |Global loss: 5.7313| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.903
Epoch: 2|  Loss:  1.129 |Global loss: 5.732| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9147
Epoch: 3|  Loss:  1.1331 |Global loss: 5.7195| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9988
Epoch: 0|  Loss:  1.6266 |Global loss: 5.8165| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 1|  NKD Loss: 0.981
Epoch: 1|  Loss:  1.6189 |Global loss: 5.8228| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 2|  NKD Loss: 0.9894
Epoch: 2|  Loss:  1.6142 |Global loss: 5.8222| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 3|  NKD Loss: 0.9984
Epoch: 3|  Loss:  1.6305 |Global loss: 5.8069| Local H loss: 0.0452  | Global H loss: 0.0452
------------------------- time cost ------------------------- 3.0301008224487305
Chosen Clients:  [12, 3, 7, 1, 5, 13]

-------------Round number: 426-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.958, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [116.999, 119.273, 118.455, 118.939, 118.108, 117.876, 117.748, 118.967, 119.174, 119.091, 118.439, 119.063, 116.374, 115.781, 119.311]
F1 Score:  [0.769, 0.971, 0.955, 0.982, 0.761, 0.955, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.82, 0.977, 0.966, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2331
Averaged Test Accurancy: 0.9256
Averaged Test AUC: 0.9853
Averaged Test F1_score: 0.9169
Averaged Test Recal score: 0.9346
Std Test Accurancy: 0.0793
Std Test AUC: 0.0089
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9905
Epoch: 0|  Loss:  1.6134 |Global loss: 5.8216| Local H loss: 0.045  | Global H loss: 0.045
Epoch: 1|  NKD Loss: 0.9748
Epoch: 1|  Loss:  1.6084 |Global loss: 5.8288| Local H loss: 0.0443  | Global H loss: 0.0443
Epoch: 2|  NKD Loss: 0.9834
Epoch: 2|  Loss:  1.5975 |Global loss: 5.8303| Local H loss: 0.0447  | Global H loss: 0.0447
Epoch: 3|  NKD Loss: 0.9877
Epoch: 3|  Loss:  1.5957 |Global loss: 5.8115| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 0|  NKD Loss: 0.8795
Epoch: 0|  Loss:  1.1224 |Global loss: 5.729| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.9005
Epoch: 1|  Loss:  1.1438 |Global loss: 5.7098| Local H loss: 0.0398  | Global H loss: 0.0398
Epoch: 2|  NKD Loss: 0.8885
Epoch: 2|  Loss:  1.1323 |Global loss: 5.7172| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.9016
Epoch: 3|  Loss:  1.1234 |Global loss: 5.7079| Local H loss: 0.0399  | Global H loss: 0.0399
Epoch: 0|  NKD Loss: 0.9025
Epoch: 0|  Loss:  1.1271 |Global loss: 5.7278| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.8967
Epoch: 1|  Loss:  1.111 |Global loss: 5.7371| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.8959
Epoch: 2|  Loss:  1.1232 |Global loss: 5.7314| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9132
Epoch: 3|  Loss:  1.1267 |Global loss: 5.716| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.9285
Epoch: 0|  Loss:  1.2052 |Global loss: 5.7594| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9415
Epoch: 1|  Loss:  1.2159 |Global loss: 5.751| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9248
Epoch: 2|  Loss:  1.1831 |Global loss: 5.7636| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 3|  NKD Loss: 0.9369
Epoch: 3|  Loss:  1.2048 |Global loss: 5.7501| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9632
Epoch: 0|  Loss:  1.3221 |Global loss: 5.7771| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9544
Epoch: 1|  Loss:  1.2953 |Global loss: 5.7833| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9538
Epoch: 2|  Loss:  1.3143 |Global loss: 5.7821| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.952
Epoch: 3|  Loss:  1.3066 |Global loss: 5.7841| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9399
Epoch: 0|  Loss:  1.3836 |Global loss: 5.7393| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9426
Epoch: 1|  Loss:  1.391 |Global loss: 5.7357| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.9272
Epoch: 2|  Loss:  1.3719 |Global loss: 5.7434| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.9359
Epoch: 3|  Loss:  1.3918 |Global loss: 5.7438| Local H loss: 0.0337  | Global H loss: 0.0337
------------------------- time cost ------------------------- 3.1422176361083984
Chosen Clients:  [1, 10, 5, 11, 12, 2]

-------------Round number: 427-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.958, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [116.999, 119.258, 118.455, 118.939, 118.108, 117.898, 117.748, 118.967, 119.174, 119.091, 118.439, 119.063, 116.324, 115.811, 119.311]
F1 Score:  [0.769, 0.971, 0.955, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.82, 0.977, 0.966, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2281
Averaged Test Accurancy: 0.9261
Averaged Test AUC: 0.9853
Averaged Test F1_score: 0.9175
Averaged Test Recal score: 0.9351
Std Test Accurancy: 0.0796
Std Test AUC: 0.0089
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9276
Epoch: 0|  Loss:  1.1983 |Global loss: 5.7612| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 1|  NKD Loss: 0.9252
Epoch: 1|  Loss:  1.201 |Global loss: 5.7588| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9323
Epoch: 2|  Loss:  1.2101 |Global loss: 5.7604| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9298
Epoch: 3|  Loss:  1.2043 |Global loss: 5.7476| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.8912
Epoch: 0|  Loss:  1.1313 |Global loss: 5.7506| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9036
Epoch: 1|  Loss:  1.1394 |Global loss: 5.7384| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 2|  NKD Loss: 0.9015
Epoch: 2|  Loss:  1.1341 |Global loss: 5.7369| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9158
Epoch: 3|  Loss:  1.1539 |Global loss: 5.7271| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9618
Epoch: 0|  Loss:  1.3201 |Global loss: 5.7745| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9659
Epoch: 1|  Loss:  1.3173 |Global loss: 5.7707| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9551
Epoch: 2|  Loss:  1.2992 |Global loss: 5.7807| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9491
Epoch: 3|  Loss:  1.302 |Global loss: 5.7862| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.8797
Epoch: 0|  Loss:  1.1028 |Global loss: 5.7246| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9047
Epoch: 1|  Loss:  1.1275 |Global loss: 5.7156| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.9041
Epoch: 2|  Loss:  1.1279 |Global loss: 5.7157| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 3|  NKD Loss: 0.9045
Epoch: 3|  Loss:  1.1282 |Global loss: 5.7161| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 1.001
Epoch: 0|  Loss:  1.6215 |Global loss: 5.8063| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 1|  NKD Loss: 0.9928
Epoch: 1|  Loss:  1.6255 |Global loss: 5.8118| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 2|  NKD Loss: 0.9873
Epoch: 2|  Loss:  1.6147 |Global loss: 5.8198| Local H loss: 0.0445  | Global H loss: 0.0445
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.6128 |Global loss: 5.814| Local H loss: 0.045  | Global H loss: 0.045
Epoch: 0|  NKD Loss: 0.9666
Epoch: 0|  Loss:  1.2615 |Global loss: 5.7761| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9424
Epoch: 1|  Loss:  1.2465 |Global loss: 5.7887| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9389
Epoch: 2|  Loss:  1.2376 |Global loss: 5.7899| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9388
Epoch: 3|  Loss:  1.2456 |Global loss: 5.7955| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 2.918109655380249
Chosen Clients:  [0, 4, 11, 3, 2, 9]

-------------Round number: 428-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.767, 0.975, 0.925, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [116.999, 119.286, 118.505, 118.939, 118.108, 117.866, 117.748, 118.967, 119.174, 119.091, 118.454, 119.069, 116.336, 115.811, 119.311]
F1 Score:  [0.769, 0.971, 0.918, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.82, 0.977, 0.937, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2311
Averaged Test Accurancy: 0.9239
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9151
Averaged Test Recal score: 0.9332
Std Test Accurancy: 0.0791
Std Test AUC: 0.0089
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9309
Epoch: 0|  Loss:  1.2928 |Global loss: 5.7522| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9476
Epoch: 1|  Loss:  1.3113 |Global loss: 5.7424| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9401
Epoch: 2|  Loss:  1.2917 |Global loss: 5.7429| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9409
Epoch: 3|  Loss:  1.3075 |Global loss: 5.7472| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9136
Epoch: 0|  Loss:  1.3518 |Global loss: 5.7183| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.9016
Epoch: 1|  Loss:  1.3313 |Global loss: 5.7225| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 0.9041
Epoch: 2|  Loss:  1.3383 |Global loss: 5.7178| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 0.9201
Epoch: 3|  Loss:  1.3523 |Global loss: 5.7087| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 0|  NKD Loss: 0.8951
Epoch: 0|  Loss:  1.1094 |Global loss: 5.7255| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.9017
Epoch: 1|  Loss:  1.1249 |Global loss: 5.722| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8842
Epoch: 2|  Loss:  1.098 |Global loss: 5.7257| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.8811
Epoch: 3|  Loss:  1.1016 |Global loss: 5.7334| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8815
Epoch: 0|  Loss:  1.1245 |Global loss: 5.7186| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.8965
Epoch: 1|  Loss:  1.1288 |Global loss: 5.7106| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 2|  NKD Loss: 0.8845
Epoch: 2|  Loss:  1.1268 |Global loss: 5.7191| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 3|  NKD Loss: 0.8724
Epoch: 3|  Loss:  1.1144 |Global loss: 5.7329| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.954
Epoch: 0|  Loss:  1.2498 |Global loss: 5.7794| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9606
Epoch: 1|  Loss:  1.261 |Global loss: 5.779| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9473
Epoch: 2|  Loss:  1.2439 |Global loss: 5.7776| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9542
Epoch: 3|  Loss:  1.2433 |Global loss: 5.7745| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8843
Epoch: 0|  Loss:  1.0916 |Global loss: 5.7056| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.8854
Epoch: 1|  Loss:  1.0931 |Global loss: 5.7044| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.861
Epoch: 2|  Loss:  1.0559 |Global loss: 5.7076| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8873
Epoch: 3|  Loss:  1.0941 |Global loss: 5.7036| Local H loss: 0.0267  | Global H loss: 0.0267
------------------------- time cost ------------------------- 2.780959129333496
Chosen Clients:  [3, 14, 9, 13, 2, 7]

-------------Round number: 429-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.108, 119.286, 118.511, 118.937, 118.114, 117.866, 117.748, 118.967, 119.174, 119.091, 118.454, 119.096, 116.336, 115.811, 119.311]
F1 Score:  [0.791, 0.971, 0.912, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.839, 0.977, 0.931, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2242
Averaged Test Accurancy: 0.9250
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9161
Averaged Test Recal score: 0.9341
Std Test Accurancy: 0.0760
Std Test AUC: 0.0088
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9035
Epoch: 0|  Loss:  1.1445 |Global loss: 5.6998| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.8836
Epoch: 1|  Loss:  1.1235 |Global loss: 5.716| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8854
Epoch: 2|  Loss:  1.126 |Global loss: 5.7167| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 3|  NKD Loss: 0.8726
Epoch: 3|  Loss:  1.1137 |Global loss: 5.723| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 0|  NKD Loss: 0.8933
Epoch: 0|  Loss:  1.1202 |Global loss: 5.7339| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.874
Epoch: 1|  Loss:  1.0994 |Global loss: 5.7424| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9079
Epoch: 2|  Loss:  1.1329 |Global loss: 5.7254| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8872
Epoch: 3|  Loss:  1.1127 |Global loss: 5.7391| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8851
Epoch: 0|  Loss:  1.0933 |Global loss: 5.7011| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.8849
Epoch: 1|  Loss:  1.0875 |Global loss: 5.6957| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.8876
Epoch: 2|  Loss:  1.0939 |Global loss: 5.6998| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8591
Epoch: 3|  Loss:  1.0618 |Global loss: 5.7161| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9087
Epoch: 0|  Loss:  1.3598 |Global loss: 5.754| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.9411
Epoch: 1|  Loss:  1.3961 |Global loss: 5.7418| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.9326
Epoch: 2|  Loss:  1.3886 |Global loss: 5.7424| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9294
Epoch: 3|  Loss:  1.383 |Global loss: 5.7505| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.9693
Epoch: 0|  Loss:  1.2724 |Global loss: 5.7678| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9322
Epoch: 1|  Loss:  1.222 |Global loss: 5.79| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9247
Epoch: 2|  Loss:  1.2173 |Global loss: 5.7891| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9547
Epoch: 3|  Loss:  1.2489 |Global loss: 5.7777| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.8883
Epoch: 0|  Loss:  1.1117 |Global loss: 5.7429| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8933
Epoch: 1|  Loss:  1.1047 |Global loss: 5.7339| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.8954
Epoch: 2|  Loss:  1.12 |Global loss: 5.7336| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.8935
Epoch: 3|  Loss:  1.1125 |Global loss: 5.7295| Local H loss: 0.0372  | Global H loss: 0.0372
------------------------- time cost ------------------------- 3.119703531265259
Chosen Clients:  [5, 2, 7, 0, 12, 4]

-------------Round number: 430-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.975, 0.958, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.108, 119.286, 118.461, 118.937, 118.114, 117.866, 117.748, 118.908, 119.174, 119.095, 118.454, 119.096, 116.336, 115.947, 119.311]
F1 Score:  [0.791, 0.971, 0.955, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.839, 0.977, 0.966, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2283
Averaged Test Accurancy: 0.9278
Averaged Test AUC: 0.9855
Averaged Test F1_score: 0.9190
Averaged Test Recal score: 0.9364
Std Test Accurancy: 0.0764
Std Test AUC: 0.0087
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9572
Epoch: 0|  Loss:  1.3133 |Global loss: 5.7763| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9738
Epoch: 1|  Loss:  1.3328 |Global loss: 5.7707| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.3126 |Global loss: 5.7684| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9606
Epoch: 3|  Loss:  1.3041 |Global loss: 5.7698| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9498
Epoch: 0|  Loss:  1.2517 |Global loss: 5.7816| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.935
Epoch: 1|  Loss:  1.2214 |Global loss: 5.7863| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9564
Epoch: 2|  Loss:  1.2516 |Global loss: 5.7791| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.9388
Epoch: 3|  Loss:  1.2251 |Global loss: 5.78| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9148
Epoch: 0|  Loss:  1.1399 |Global loss: 5.7234| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.9082
Epoch: 1|  Loss:  1.132 |Global loss: 5.7264| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 2|  NKD Loss: 0.8831
Epoch: 2|  Loss:  1.0877 |Global loss: 5.734| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9
Epoch: 3|  Loss:  1.1194 |Global loss: 5.7255| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 0|  NKD Loss: 0.9379
Epoch: 0|  Loss:  1.2881 |Global loss: 5.7423| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9345
Epoch: 1|  Loss:  1.2982 |Global loss: 5.7456| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9558
Epoch: 2|  Loss:  1.3082 |Global loss: 5.7315| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9331
Epoch: 3|  Loss:  1.2899 |Global loss: 5.741| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9962
Epoch: 0|  Loss:  1.6145 |Global loss: 5.8182| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 1|  NKD Loss: 0.9941
Epoch: 1|  Loss:  1.6176 |Global loss: 5.8039| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 2|  NKD Loss: 0.9918
Epoch: 2|  Loss:  1.5977 |Global loss: 5.8147| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 3|  NKD Loss: 0.9848
Epoch: 3|  Loss:  1.6082 |Global loss: 5.8192| Local H loss: 0.0446  | Global H loss: 0.0446
Epoch: 0|  NKD Loss: 0.9135
Epoch: 0|  Loss:  1.3343 |Global loss: 5.7109| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 1|  NKD Loss: 0.9224
Epoch: 1|  Loss:  1.3479 |Global loss: 5.7079| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 2|  NKD Loss: 0.8943
Epoch: 2|  Loss:  1.3192 |Global loss: 5.7209| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 0.8998
Epoch: 3|  Loss:  1.3232 |Global loss: 5.7208| Local H loss: 0.0226  | Global H loss: 0.0226
------------------------- time cost ------------------------- 3.2477235794067383
Chosen Clients:  [9, 10, 14, 12, 0, 3]

-------------Round number: 431-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.792, 0.975, 0.917, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [117.087, 119.286, 118.245, 118.937, 118.105, 117.931, 117.748, 118.965, 119.174, 119.095, 118.454, 119.096, 116.325, 115.947, 119.311]
F1 Score:  [0.791, 0.971, 0.917, 0.982, 0.761, 0.955, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.714, 0.847, 0.971]
Recall Score:  [0.839, 0.977, 0.938, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.757, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2281
Averaged Test Accurancy: 0.9222
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9144
Averaged Test Recal score: 0.9323
Std Test Accurancy: 0.0811
Std Test AUC: 0.0087
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.871
Epoch: 0|  Loss:  1.0772 |Global loss: 5.713| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.8735
Epoch: 1|  Loss:  1.0793 |Global loss: 5.7118| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.8723
Epoch: 2|  Loss:  1.0767 |Global loss: 5.7127| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8807
Epoch: 3|  Loss:  1.0864 |Global loss: 5.7042| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.896
Epoch: 0|  Loss:  1.1297 |Global loss: 5.744| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9006
Epoch: 1|  Loss:  1.1357 |Global loss: 5.7363| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9151
Epoch: 2|  Loss:  1.1537 |Global loss: 5.7293| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.9043
Epoch: 3|  Loss:  1.1373 |Global loss: 5.7286| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.8957
Epoch: 0|  Loss:  1.1213 |Global loss: 5.7343| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9083
Epoch: 1|  Loss:  1.1374 |Global loss: 5.7278| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.8884
Epoch: 2|  Loss:  1.1153 |Global loss: 5.7446| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.8934
Epoch: 3|  Loss:  1.1207 |Global loss: 5.7356| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9862
Epoch: 0|  Loss:  1.5928 |Global loss: 5.819| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 1|  NKD Loss: 1.0047
Epoch: 1|  Loss:  1.6277 |Global loss: 5.8052| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 2|  NKD Loss: 1.0011
Epoch: 2|  Loss:  1.6185 |Global loss: 5.7994| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 3|  NKD Loss: 0.9955
Epoch: 3|  Loss:  1.5879 |Global loss: 5.8114| Local H loss: 0.0454  | Global H loss: 0.0454
Epoch: 0|  NKD Loss: 0.9256
Epoch: 0|  Loss:  1.2824 |Global loss: 5.7518| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9329
Epoch: 1|  Loss:  1.2915 |Global loss: 5.7471| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9147
Epoch: 2|  Loss:  1.278 |Global loss: 5.7592| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9545
Epoch: 3|  Loss:  1.2865 |Global loss: 5.7299| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.8766
Epoch: 0|  Loss:  1.1079 |Global loss: 5.7285| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.1213 |Global loss: 5.708| Local H loss: 0.0397  | Global H loss: 0.0397
Epoch: 2|  NKD Loss: 0.8789
Epoch: 2|  Loss:  1.1188 |Global loss: 5.721| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.8905
Epoch: 3|  Loss:  1.1171 |Global loss: 5.7137| Local H loss: 0.0395  | Global H loss: 0.0395
------------------------- time cost ------------------------- 3.096508264541626
Chosen Clients:  [3, 6, 9, 1, 4, 10]

-------------Round number: 432-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.775, 0.975, 0.917, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.017, 119.286, 118.245, 118.936, 118.105, 117.931, 117.748, 118.965, 119.174, 119.098, 118.452, 119.096, 116.408, 115.947, 119.329]
F1 Score:  [0.778, 0.971, 0.917, 0.982, 0.761, 0.955, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.825, 0.977, 0.938, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2311
Averaged Test Accurancy: 0.9233
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9150
Averaged Test Recal score: 0.9331
Std Test Accurancy: 0.0778
Std Test AUC: 0.0086
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8638
Epoch: 0|  Loss:  1.1037 |Global loss: 5.735| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.8918
Epoch: 1|  Loss:  1.1312 |Global loss: 5.7109| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.8853
Epoch: 2|  Loss:  1.1154 |Global loss: 5.7176| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 3|  NKD Loss: 0.8808
Epoch: 3|  Loss:  1.1175 |Global loss: 5.7261| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 0|  NKD Loss: 0.9455
Epoch: 0|  Loss:  1.2422 |Global loss: 5.7448| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9368
Epoch: 1|  Loss:  1.2294 |Global loss: 5.7453| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9366
Epoch: 2|  Loss:  1.2326 |Global loss: 5.7476| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9304
Epoch: 3|  Loss:  1.2262 |Global loss: 5.753| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8857
Epoch: 0|  Loss:  1.0916 |Global loss: 5.7012| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.8792
Epoch: 1|  Loss:  1.0849 |Global loss: 5.7039| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8735
Epoch: 2|  Loss:  1.065 |Global loss: 5.7063| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8802
Epoch: 3|  Loss:  1.0857 |Global loss: 5.6999| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9195
Epoch: 0|  Loss:  1.1856 |Global loss: 5.7659| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9442
Epoch: 1|  Loss:  1.2186 |Global loss: 5.7422| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9297
Epoch: 2|  Loss:  1.2004 |Global loss: 5.7467| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9429
Epoch: 3|  Loss:  1.2062 |Global loss: 5.7498| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 0.9092
Epoch: 0|  Loss:  1.3428 |Global loss: 5.7209| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.9086
Epoch: 1|  Loss:  1.3243 |Global loss: 5.7119| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 0.9124
Epoch: 2|  Loss:  1.3439 |Global loss: 5.7152| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.9322
Epoch: 3|  Loss:  1.3466 |Global loss: 5.6926| Local H loss: 0.0228  | Global H loss: 0.0228
Epoch: 0|  NKD Loss: 0.9023
Epoch: 0|  Loss:  1.1368 |Global loss: 5.7333| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9156
Epoch: 1|  Loss:  1.1545 |Global loss: 5.7218| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9036
Epoch: 2|  Loss:  1.142 |Global loss: 5.7382| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.8869
Epoch: 3|  Loss:  1.1244 |Global loss: 5.7453| Local H loss: 0.0369  | Global H loss: 0.0369
------------------------- time cost ------------------------- 3.1011440753936768
Chosen Clients:  [6, 5, 9, 13, 3, 0]

-------------Round number: 433-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.775, 0.975, 0.917, 0.983, 0.833, 0.958, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.017, 119.289, 118.245, 118.936, 118.106, 117.931, 117.766, 118.965, 119.174, 119.096, 118.469, 119.096, 116.408, 115.947, 119.329]
F1 Score:  [0.778, 0.971, 0.917, 0.982, 0.761, 0.955, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.847, 0.971]
Recall Score:  [0.825, 0.977, 0.938, 0.986, 0.81, 0.963, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2267
Averaged Test Accurancy: 0.9228
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9143
Averaged Test Recal score: 0.9324
Std Test Accurancy: 0.0775
Std Test AUC: 0.0086
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9251
Epoch: 0|  Loss:  1.2208 |Global loss: 5.7564| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9234
Epoch: 1|  Loss:  1.2099 |Global loss: 5.755| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9181
Epoch: 2|  Loss:  1.2147 |Global loss: 5.758| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9377
Epoch: 3|  Loss:  1.2352 |Global loss: 5.7457| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9642
Epoch: 0|  Loss:  1.3011 |Global loss: 5.7677| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9669
Epoch: 1|  Loss:  1.3169 |Global loss: 5.7709| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9554
Epoch: 2|  Loss:  1.3082 |Global loss: 5.7709| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9696
Epoch: 3|  Loss:  1.3241 |Global loss: 5.7648| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8912
Epoch: 0|  Loss:  1.0828 |Global loss: 5.6896| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.8807
Epoch: 1|  Loss:  1.0858 |Global loss: 5.7029| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8809
Epoch: 2|  Loss:  1.086 |Global loss: 5.7013| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.8611
Epoch: 3|  Loss:  1.0664 |Global loss: 5.7144| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.9285
Epoch: 0|  Loss:  1.3702 |Global loss: 5.7465| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9376
Epoch: 1|  Loss:  1.3963 |Global loss: 5.7444| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.9154
Epoch: 2|  Loss:  1.3605 |Global loss: 5.7543| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.942
Epoch: 3|  Loss:  1.3735 |Global loss: 5.7319| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8845
Epoch: 0|  Loss:  1.1235 |Global loss: 5.7182| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 1|  NKD Loss: 0.8638
Epoch: 1|  Loss:  1.094 |Global loss: 5.7277| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 2|  NKD Loss: 0.9001
Epoch: 2|  Loss:  1.1328 |Global loss: 5.7052| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 0.9008
Epoch: 3|  Loss:  1.1386 |Global loss: 5.6978| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.9331
Epoch: 0|  Loss:  1.2825 |Global loss: 5.7436| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9362
Epoch: 1|  Loss:  1.2947 |Global loss: 5.7446| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9186
Epoch: 2|  Loss:  1.2724 |Global loss: 5.7482| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9437
Epoch: 3|  Loss:  1.2926 |Global loss: 5.7371| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 2.733623743057251
Chosen Clients:  [5, 0, 9, 6, 8, 1]

-------------Round number: 434-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.783, 0.975, 0.917, 0.983, 0.833, 0.967, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.073, 119.289, 118.245, 118.936, 118.106, 117.892, 117.798, 118.965, 119.174, 119.092, 118.469, 119.096, 116.408, 115.885, 119.329]
F1 Score:  [0.786, 0.971, 0.917, 0.982, 0.761, 0.964, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.831, 0.977, 0.938, 0.986, 0.81, 0.971, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2249
Averaged Test Accurancy: 0.9239
Averaged Test AUC: 0.9854
Averaged Test F1_score: 0.9152
Averaged Test Recal score: 0.9333
Std Test Accurancy: 0.0768
Std Test AUC: 0.0087
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.973
Epoch: 0|  Loss:  1.3228 |Global loss: 5.7573| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9638
Epoch: 1|  Loss:  1.3097 |Global loss: 5.7672| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9587
Epoch: 2|  Loss:  1.3028 |Global loss: 5.7742| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.949
Epoch: 3|  Loss:  1.2984 |Global loss: 5.7752| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9207
Epoch: 0|  Loss:  1.2611 |Global loss: 5.7537| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9347
Epoch: 1|  Loss:  1.281 |Global loss: 5.7416| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9433
Epoch: 2|  Loss:  1.2996 |Global loss: 5.7403| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9511
Epoch: 3|  Loss:  1.2948 |Global loss: 5.7368| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8698
Epoch: 0|  Loss:  1.0569 |Global loss: 5.7039| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.8684
Epoch: 1|  Loss:  1.0727 |Global loss: 5.7121| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.9031
Epoch: 2|  Loss:  1.1066 |Global loss: 5.6851| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.869
Epoch: 3|  Loss:  1.075 |Global loss: 5.709| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.9398
Epoch: 0|  Loss:  1.2243 |Global loss: 5.753| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 1|  NKD Loss: 0.9254
Epoch: 1|  Loss:  1.221 |Global loss: 5.7568| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9256
Epoch: 2|  Loss:  1.2173 |Global loss: 5.756| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 3|  NKD Loss: 0.9254
Epoch: 3|  Loss:  1.2208 |Global loss: 5.7568| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.8994
Epoch: 0|  Loss:  1.1219 |Global loss: 5.7242| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 1|  NKD Loss: 0.8991
Epoch: 1|  Loss:  1.1227 |Global loss: 5.7274| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 2|  NKD Loss: 0.9055
Epoch: 2|  Loss:  1.1274 |Global loss: 5.7217| Local H loss: 0.0347  | Global H loss: 0.0347
Epoch: 3|  NKD Loss: 0.9126
Epoch: 3|  Loss:  1.1327 |Global loss: 5.713| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9148
Epoch: 0|  Loss:  1.1872 |Global loss: 5.7661| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9468
Epoch: 1|  Loss:  1.2137 |Global loss: 5.7489| Local H loss: 0.0279  | Global H loss: 0.0279
Epoch: 2|  NKD Loss: 0.9382
Epoch: 2|  Loss:  1.2055 |Global loss: 5.7523| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.943
Epoch: 3|  Loss:  1.2143 |Global loss: 5.7443| Local H loss: 0.0276  | Global H loss: 0.0276
------------------------- time cost ------------------------- 4.19793438911438
Chosen Clients:  [11, 1, 12, 0, 8, 5]

-------------Round number: 435-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.833, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.161, 119.282, 118.245, 118.936, 118.106, 117.946, 117.817, 118.965, 119.171, 119.095, 118.469, 119.096, 116.408, 115.885, 119.329]
F1 Score:  [0.842, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.871, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2274
Averaged Test Accurancy: 0.9278
Averaged Test AUC: 0.9855
Averaged Test F1_score: 0.9196
Averaged Test Recal score: 0.9367
Std Test Accurancy: 0.0717
Std Test AUC: 0.0086
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9059
Epoch: 0|  Loss:  1.1283 |Global loss: 5.7147| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.8932
Epoch: 1|  Loss:  1.1164 |Global loss: 5.7284| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.8785
Epoch: 2|  Loss:  1.1012 |Global loss: 5.7332| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.903
Epoch: 3|  Loss:  1.1212 |Global loss: 5.7163| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9275
Epoch: 0|  Loss:  1.1974 |Global loss: 5.7582| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9244
Epoch: 1|  Loss:  1.1947 |Global loss: 5.7459| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9171
Epoch: 2|  Loss:  1.1869 |Global loss: 5.7644| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9483
Epoch: 3|  Loss:  1.2133 |Global loss: 5.7457| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 0|  NKD Loss: 1.0063
Epoch: 0|  Loss:  1.609 |Global loss: 5.7988| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 1|  NKD Loss: 0.9951
Epoch: 1|  Loss:  1.5977 |Global loss: 5.8042| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 2|  NKD Loss: 0.9907
Epoch: 2|  Loss:  1.596 |Global loss: 5.8119| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 3|  NKD Loss: 0.9772
Epoch: 3|  Loss:  1.5939 |Global loss: 5.8192| Local H loss: 0.0451  | Global H loss: 0.0451
Epoch: 0|  NKD Loss: 0.9567
Epoch: 0|  Loss:  1.3138 |Global loss: 5.7319| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9351
Epoch: 1|  Loss:  1.2875 |Global loss: 5.7487| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9347
Epoch: 2|  Loss:  1.2691 |Global loss: 5.741| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9306
Epoch: 3|  Loss:  1.2748 |Global loss: 5.735| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8977
Epoch: 0|  Loss:  1.12 |Global loss: 5.7234| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.8874
Epoch: 1|  Loss:  1.097 |Global loss: 5.7296| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.892
Epoch: 2|  Loss:  1.1118 |Global loss: 5.7301| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.8914
Epoch: 3|  Loss:  1.1137 |Global loss: 5.7285| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.9574
Epoch: 0|  Loss:  1.3041 |Global loss: 5.7686| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9619
Epoch: 1|  Loss:  1.3058 |Global loss: 5.7624| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9569
Epoch: 2|  Loss:  1.3065 |Global loss: 5.7735| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9554
Epoch: 3|  Loss:  1.3069 |Global loss: 5.7694| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 3.2928996086120605
Chosen Clients:  [10, 13, 7, 11, 9, 8]

-------------Round number: 436-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.833, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [117.218, 119.296, 118.245, 118.936, 118.106, 117.972, 117.817, 118.965, 119.188, 119.095, 118.469, 119.112, 116.255, 115.885, 119.329]
F1 Score:  [0.842, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.843, 0.971]
Recall Score:  [0.871, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2200
Averaged Test Accurancy: 0.9239
Averaged Test AUC: 0.9855
Averaged Test F1_score: 0.9161
Averaged Test Recal score: 0.9337
Std Test Accurancy: 0.0821
Std Test AUC: 0.0088
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8934
Epoch: 0|  Loss:  1.1221 |Global loss: 5.7331| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9094
Epoch: 1|  Loss:  1.142 |Global loss: 5.73| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9157
Epoch: 2|  Loss:  1.1535 |Global loss: 5.7253| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 3|  NKD Loss: 0.9027
Epoch: 3|  Loss:  1.1385 |Global loss: 5.7353| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9395
Epoch: 0|  Loss:  1.3848 |Global loss: 5.7352| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 0.9248
Epoch: 1|  Loss:  1.3751 |Global loss: 5.738| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.928
Epoch: 2|  Loss:  1.3825 |Global loss: 5.7459| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.9212
Epoch: 3|  Loss:  1.3523 |Global loss: 5.7478| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8965
Epoch: 0|  Loss:  1.1139 |Global loss: 5.7317| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.9141
Epoch: 1|  Loss:  1.1317 |Global loss: 5.7159| Local H loss: 0.0376  | Global H loss: 0.0376
Epoch: 2|  NKD Loss: 0.8624
Epoch: 2|  Loss:  1.0851 |Global loss: 5.7602| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 3|  NKD Loss: 0.8869
Epoch: 3|  Loss:  1.1021 |Global loss: 5.7378| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.912
Epoch: 0|  Loss:  1.1324 |Global loss: 5.7114| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 1|  NKD Loss: 0.8889
Epoch: 1|  Loss:  1.1075 |Global loss: 5.7196| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.8848
Epoch: 2|  Loss:  1.0908 |Global loss: 5.7304| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9036
Epoch: 3|  Loss:  1.1253 |Global loss: 5.716| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.8851
Epoch: 0|  Loss:  1.0897 |Global loss: 5.6949| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.8796
Epoch: 1|  Loss:  1.0845 |Global loss: 5.7045| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.8659
Epoch: 2|  Loss:  1.0642 |Global loss: 5.7068| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.8805
Epoch: 3|  Loss:  1.0837 |Global loss: 5.6998| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.8826
Epoch: 0|  Loss:  1.1045 |Global loss: 5.7371| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.8891
Epoch: 1|  Loss:  1.1112 |Global loss: 5.7317| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 2|  NKD Loss: 0.9173
Epoch: 2|  Loss:  1.1352 |Global loss: 5.7145| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 3|  NKD Loss: 0.9041
Epoch: 3|  Loss:  1.1231 |Global loss: 5.7226| Local H loss: 0.0343  | Global H loss: 0.0343
------------------------- time cost ------------------------- 3.1613056659698486
Chosen Clients:  [3, 8, 7, 0, 9, 11]

-------------Round number: 437-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.833, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [117.218, 119.296, 118.245, 118.936, 118.106, 117.972, 117.817, 118.945, 119.169, 119.097, 118.47, 119.14, 116.255, 115.98, 119.329]
F1 Score:  [0.842, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.843, 0.971]
Recall Score:  [0.871, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2236
Averaged Test Accurancy: 0.9239
Averaged Test AUC: 0.9855
Averaged Test F1_score: 0.9161
Averaged Test Recal score: 0.9337
Std Test Accurancy: 0.0821
Std Test AUC: 0.0086
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.897
Epoch: 0|  Loss:  1.1349 |Global loss: 5.709| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 1|  NKD Loss: 0.9051
Epoch: 1|  Loss:  1.1416 |Global loss: 5.7022| Local H loss: 0.0396  | Global H loss: 0.0396
Epoch: 2|  NKD Loss: 0.8849
Epoch: 2|  Loss:  1.1229 |Global loss: 5.7128| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 3|  NKD Loss: 0.8937
Epoch: 3|  Loss:  1.131 |Global loss: 5.7107| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 0|  NKD Loss: 0.882
Epoch: 0|  Loss:  1.1052 |Global loss: 5.7342| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 1|  NKD Loss: 0.9093
Epoch: 1|  Loss:  1.1306 |Global loss: 5.7135| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.8977
Epoch: 2|  Loss:  1.1188 |Global loss: 5.729| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1172 |Global loss: 5.7189| Local H loss: 0.0346  | Global H loss: 0.0346
Epoch: 0|  NKD Loss: 0.9156
Epoch: 0|  Loss:  1.138 |Global loss: 5.7154| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 1|  NKD Loss: 0.8759
Epoch: 1|  Loss:  1.0984 |Global loss: 5.7483| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.894
Epoch: 2|  Loss:  1.1174 |Global loss: 5.7293| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.864
Epoch: 3|  Loss:  1.0746 |Global loss: 5.7475| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.9404
Epoch: 0|  Loss:  1.2897 |Global loss: 5.7407| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9331
Epoch: 1|  Loss:  1.2823 |Global loss: 5.7448| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9496
Epoch: 2|  Loss:  1.3016 |Global loss: 5.7336| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9403
Epoch: 3|  Loss:  1.2881 |Global loss: 5.7362| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.8584
Epoch: 0|  Loss:  1.0633 |Global loss: 5.7174| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.8845
Epoch: 1|  Loss:  1.0829 |Global loss: 5.6956| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.8857
Epoch: 2|  Loss:  1.0868 |Global loss: 5.6955| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.8736
Epoch: 3|  Loss:  1.077 |Global loss: 5.7074| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.884
Epoch: 0|  Loss:  1.1006 |Global loss: 5.7309| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.8989
Epoch: 1|  Loss:  1.112 |Global loss: 5.7255| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8838
Epoch: 2|  Loss:  1.0914 |Global loss: 5.7298| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9036
Epoch: 3|  Loss:  1.1248 |Global loss: 5.7126| Local H loss: 0.0249  | Global H loss: 0.0249
------------------------- time cost ------------------------- 3.177711248397827
Chosen Clients:  [10, 12, 7, 9, 11, 14]

-------------Round number: 438-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.825, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [117.089, 119.296, 118.245, 118.936, 118.106, 117.972, 117.817, 118.968, 119.218, 119.096, 118.47, 119.123, 116.255, 115.98, 119.329]
F1 Score:  [0.84, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.843, 0.971]
Recall Score:  [0.866, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2243
Averaged Test Accurancy: 0.9233
Averaged Test AUC: 0.9855
Averaged Test F1_score: 0.9160
Averaged Test Recal score: 0.9333
Std Test Accurancy: 0.0827
Std Test AUC: 0.0087
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9052
Epoch: 0|  Loss:  1.1422 |Global loss: 5.7399| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.1401 |Global loss: 5.7361| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9107
Epoch: 2|  Loss:  1.1474 |Global loss: 5.7299| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.909
Epoch: 3|  Loss:  1.1365 |Global loss: 5.7305| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9939
Epoch: 0|  Loss:  1.5906 |Global loss: 5.8093| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 1|  NKD Loss: 1.0109
Epoch: 1|  Loss:  1.6063 |Global loss: 5.7978| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 2|  NKD Loss: 0.9898
Epoch: 2|  Loss:  1.602 |Global loss: 5.8089| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 3|  NKD Loss: 0.9902
Epoch: 3|  Loss:  1.6012 |Global loss: 5.8102| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 0|  NKD Loss: 0.8815
Epoch: 0|  Loss:  1.0932 |Global loss: 5.7406| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.8831
Epoch: 1|  Loss:  1.1048 |Global loss: 5.7381| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 2|  NKD Loss: 0.9023
Epoch: 2|  Loss:  1.1209 |Global loss: 5.7242| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 3|  NKD Loss: 0.9004
Epoch: 3|  Loss:  1.1176 |Global loss: 5.7244| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 0|  NKD Loss: 0.8714
Epoch: 0|  Loss:  1.0737 |Global loss: 5.7022| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 1|  NKD Loss: 0.8799
Epoch: 1|  Loss:  1.0838 |Global loss: 5.6974| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 0.8877
Epoch: 2|  Loss:  1.0909 |Global loss: 5.6957| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 3|  NKD Loss: 0.8878
Epoch: 3|  Loss:  1.0912 |Global loss: 5.6928| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.8877
Epoch: 0|  Loss:  1.1084 |Global loss: 5.715| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.8934
Epoch: 1|  Loss:  1.1132 |Global loss: 5.7299| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.8978
Epoch: 2|  Loss:  1.1207 |Global loss: 5.7175| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.8918
Epoch: 3|  Loss:  1.1132 |Global loss: 5.7232| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9051
Epoch: 0|  Loss:  1.1269 |Global loss: 5.7235| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9194
Epoch: 1|  Loss:  1.1431 |Global loss: 5.7235| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9034
Epoch: 2|  Loss:  1.1306 |Global loss: 5.7308| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.8998
Epoch: 3|  Loss:  1.1241 |Global loss: 5.723| Local H loss: 0.0273  | Global H loss: 0.0273
------------------------- time cost ------------------------- 3.3614625930786133
Chosen Clients:  [1, 14, 8, 3, 12, 4]

-------------Round number: 439-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.825, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.089, 119.296, 118.245, 118.936, 118.106, 117.972, 117.817, 118.956, 119.218, 119.098, 118.473, 119.114, 116.433, 115.98, 119.336]
F1 Score:  [0.84, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.866, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2198
Averaged Test Accurancy: 0.9261
Averaged Test AUC: 0.9856
Averaged Test F1_score: 0.9185
Averaged Test Recal score: 0.9355
Std Test Accurancy: 0.0753
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9318
Epoch: 0|  Loss:  1.1848 |Global loss: 5.7545| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9078
Epoch: 1|  Loss:  1.1739 |Global loss: 5.7646| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9491
Epoch: 2|  Loss:  1.2153 |Global loss: 5.7381| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9275
Epoch: 3|  Loss:  1.1954 |Global loss: 5.7562| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8962
Epoch: 0|  Loss:  1.1047 |Global loss: 5.7345| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9092
Epoch: 1|  Loss:  1.13 |Global loss: 5.72| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9158
Epoch: 2|  Loss:  1.1419 |Global loss: 5.7221| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.908
Epoch: 3|  Loss:  1.1318 |Global loss: 5.7239| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8679
Epoch: 0|  Loss:  1.0903 |Global loss: 5.7366| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 1|  NKD Loss: 0.9103
Epoch: 1|  Loss:  1.1287 |Global loss: 5.7169| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.8831
Epoch: 2|  Loss:  1.1002 |Global loss: 5.7334| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.123 |Global loss: 5.7218| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.8838
Epoch: 0|  Loss:  1.1197 |Global loss: 5.7177| Local H loss: 0.0393  | Global H loss: 0.0393
Epoch: 1|  NKD Loss: 0.8835
Epoch: 1|  Loss:  1.1193 |Global loss: 5.7128| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.9056
Epoch: 2|  Loss:  1.143 |Global loss: 5.7026| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 3|  NKD Loss: 0.8924
Epoch: 3|  Loss:  1.1254 |Global loss: 5.7078| Local H loss: 0.0394  | Global H loss: 0.0394
Epoch: 0|  NKD Loss: 0.9715
Epoch: 0|  Loss:  1.5732 |Global loss: 5.8249| Local H loss: 0.0448  | Global H loss: 0.0448
Epoch: 1|  NKD Loss: 0.9858
Epoch: 1|  Loss:  1.5894 |Global loss: 5.8164| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 2|  NKD Loss: 0.9806
Epoch: 2|  Loss:  1.5796 |Global loss: 5.8147| Local H loss: 0.0454  | Global H loss: 0.0454
Epoch: 3|  NKD Loss: 0.98
Epoch: 3|  Loss:  1.5834 |Global loss: 5.8155| Local H loss: 0.0453  | Global H loss: 0.0453
Epoch: 0|  NKD Loss: 0.895
Epoch: 0|  Loss:  1.3186 |Global loss: 5.7278| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.9156
Epoch: 1|  Loss:  1.331 |Global loss: 5.7092| Local H loss: 0.0227  | Global H loss: 0.0227
Epoch: 2|  NKD Loss: 0.9032
Epoch: 2|  Loss:  1.32 |Global loss: 5.714| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 3|  NKD Loss: 0.9211
Epoch: 3|  Loss:  1.3464 |Global loss: 5.7022| Local H loss: 0.0227  | Global H loss: 0.0227
------------------------- time cost ------------------------- 3.116915464401245
Chosen Clients:  [7, 11, 2, 5, 4, 3]

-------------Round number: 440-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.825, 0.975, 0.917, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [117.089, 119.303, 118.245, 118.937, 118.109, 117.972, 117.817, 118.956, 119.246, 119.098, 118.473, 119.114, 116.609, 115.98, 119.31]
F1 Score:  [0.84, 0.971, 0.917, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.843, 0.971]
Recall Score:  [0.866, 0.977, 0.938, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2198
Averaged Test Accurancy: 0.9267
Averaged Test AUC: 0.9857
Averaged Test F1_score: 0.9193
Averaged Test Recal score: 0.9360
Std Test Accurancy: 0.0739
Std Test AUC: 0.0084
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8855
Epoch: 0|  Loss:  1.0964 |Global loss: 5.7275| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 1|  NKD Loss: 0.8695
Epoch: 1|  Loss:  1.0914 |Global loss: 5.7504| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.8951
Epoch: 2|  Loss:  1.1138 |Global loss: 5.7338| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.9075
Epoch: 3|  Loss:  1.1277 |Global loss: 5.7205| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9116
Epoch: 0|  Loss:  1.1341 |Global loss: 5.7119| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.9068
Epoch: 1|  Loss:  1.1258 |Global loss: 5.7041| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.8895
Epoch: 2|  Loss:  1.1044 |Global loss: 5.7199| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9168
Epoch: 3|  Loss:  1.1316 |Global loss: 5.7041| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9339
Epoch: 0|  Loss:  1.231 |Global loss: 5.7816| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9432
Epoch: 1|  Loss:  1.2332 |Global loss: 5.7722| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9395
Epoch: 2|  Loss:  1.2385 |Global loss: 5.7873| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9511
Epoch: 3|  Loss:  1.2476 |Global loss: 5.7775| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9707
Epoch: 0|  Loss:  1.3069 |Global loss: 5.7618| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9507
Epoch: 1|  Loss:  1.2986 |Global loss: 5.7739| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9576
Epoch: 2|  Loss:  1.2908 |Global loss: 5.7619| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9547
Epoch: 3|  Loss:  1.2838 |Global loss: 5.7715| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9161
Epoch: 0|  Loss:  1.338 |Global loss: 5.7108| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.3546 |Global loss: 5.7083| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 0.9002
Epoch: 2|  Loss:  1.3288 |Global loss: 5.7182| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.9094
Epoch: 3|  Loss:  1.343 |Global loss: 5.7117| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 0.8905
Epoch: 0|  Loss:  1.1256 |Global loss: 5.7086| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 1|  NKD Loss: 0.8978
Epoch: 1|  Loss:  1.1325 |Global loss: 5.7053| Local H loss: 0.0392  | Global H loss: 0.0392
Epoch: 2|  NKD Loss: 0.9062
Epoch: 2|  Loss:  1.1416 |Global loss: 5.7026| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 3|  NKD Loss: 0.892
Epoch: 3|  Loss:  1.1265 |Global loss: 5.7108| Local H loss: 0.0396  | Global H loss: 0.0396
------------------------- time cost ------------------------- 2.937264919281006
Chosen Clients:  [10, 3, 6, 1, 0, 2]

-------------Round number: 441-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.825, 0.975, 0.958, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [117.089, 119.303, 118.602, 118.936, 118.102, 117.954, 117.817, 118.888, 119.246, 119.098, 118.473, 119.157, 116.609, 115.98, 119.31]
F1 Score:  [0.84, 0.971, 0.955, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.843, 0.971]
Recall Score:  [0.866, 0.977, 0.966, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2263
Averaged Test Accurancy: 0.9294
Averaged Test AUC: 0.9859
Averaged Test F1_score: 0.9218
Averaged Test Recal score: 0.9379
Std Test Accurancy: 0.0742
Std Test AUC: 0.0084
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9106
Epoch: 0|  Loss:  1.1476 |Global loss: 5.7291| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.8904
Epoch: 1|  Loss:  1.125 |Global loss: 5.743| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9094
Epoch: 2|  Loss:  1.1455 |Global loss: 5.731| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9083
Epoch: 3|  Loss:  1.1389 |Global loss: 5.738| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.8933
Epoch: 0|  Loss:  1.1189 |Global loss: 5.7085| Local H loss: 0.0395  | Global H loss: 0.0395
Epoch: 1|  NKD Loss: 0.8835
Epoch: 1|  Loss:  1.1185 |Global loss: 5.7158| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 2|  NKD Loss: 0.8779
Epoch: 2|  Loss:  1.1126 |Global loss: 5.7199| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 3|  NKD Loss: 0.8792
Epoch: 3|  Loss:  1.1131 |Global loss: 5.7143| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.9323
Epoch: 0|  Loss:  1.2225 |Global loss: 5.7525| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9519
Epoch: 1|  Loss:  1.2485 |Global loss: 5.7392| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9299
Epoch: 2|  Loss:  1.2209 |Global loss: 5.7524| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9235
Epoch: 3|  Loss:  1.2122 |Global loss: 5.7569| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9372
Epoch: 0|  Loss:  1.2042 |Global loss: 5.7433| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9425
Epoch: 1|  Loss:  1.2098 |Global loss: 5.7421| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9278
Epoch: 2|  Loss:  1.1925 |Global loss: 5.7538| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8721
Epoch: 3|  Loss:  1.1397 |Global loss: 5.7792| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9469
Epoch: 0|  Loss:  1.2906 |Global loss: 5.7406| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9257
Epoch: 1|  Loss:  1.2749 |Global loss: 5.7495| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9478
Epoch: 2|  Loss:  1.2969 |Global loss: 5.7321| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9472
Epoch: 3|  Loss:  1.2894 |Global loss: 5.7305| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9577
Epoch: 0|  Loss:  1.2517 |Global loss: 5.7722| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9499
Epoch: 1|  Loss:  1.2421 |Global loss: 5.7683| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9558
Epoch: 2|  Loss:  1.2467 |Global loss: 5.7695| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9392
Epoch: 3|  Loss:  1.2289 |Global loss: 5.7817| Local H loss: 0.0367  | Global H loss: 0.0367
------------------------- time cost ------------------------- 2.984797477722168
Chosen Clients:  [9, 5, 8, 1, 13, 2]

-------------Round number: 442-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.933, 0.983, 0.833, 0.967, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [117.264, 119.348, 118.497, 118.936, 118.102, 117.954, 117.823, 118.888, 119.246, 119.098, 118.477, 119.157, 116.609, 115.98, 119.31]
F1 Score:  [0.852, 0.971, 0.932, 0.982, 0.761, 0.964, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.843, 0.971]
Recall Score:  [0.878, 0.977, 0.949, 0.986, 0.81, 0.971, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2212
Averaged Test Accurancy: 0.9283
Averaged Test AUC: 0.9859
Averaged Test F1_score: 0.9204
Averaged Test Recal score: 0.9369
Std Test Accurancy: 0.0722
Std Test AUC: 0.0083
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8907
Epoch: 0|  Loss:  1.0934 |Global loss: 5.6912| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.8715
Epoch: 1|  Loss:  1.0753 |Global loss: 5.7083| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 2|  NKD Loss: 0.8784
Epoch: 2|  Loss:  1.0731 |Global loss: 5.7032| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 3|  NKD Loss: 0.892
Epoch: 3|  Loss:  1.0936 |Global loss: 5.6913| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 0|  NKD Loss: 0.9615
Epoch: 0|  Loss:  1.2999 |Global loss: 5.7671| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9397
Epoch: 1|  Loss:  1.2726 |Global loss: 5.7801| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9529
Epoch: 2|  Loss:  1.2836 |Global loss: 5.7718| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9458
Epoch: 3|  Loss:  1.2822 |Global loss: 5.7635| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9042
Epoch: 0|  Loss:  1.1114 |Global loss: 5.7135| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 1|  NKD Loss: 0.8879
Epoch: 1|  Loss:  1.1076 |Global loss: 5.7344| Local H loss: 0.0343  | Global H loss: 0.0343
Epoch: 2|  NKD Loss: 0.8754
Epoch: 2|  Loss:  1.0914 |Global loss: 5.7376| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 3|  NKD Loss: 0.9017
Epoch: 3|  Loss:  1.1177 |Global loss: 5.7214| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.9364
Epoch: 0|  Loss:  1.2017 |Global loss: 5.7475| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9212
Epoch: 1|  Loss:  1.1862 |Global loss: 5.76| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9061
Epoch: 2|  Loss:  1.1717 |Global loss: 5.7671| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9324
Epoch: 3|  Loss:  1.1996 |Global loss: 5.7474| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 0|  NKD Loss: 0.9335
Epoch: 0|  Loss:  1.3744 |Global loss: 5.7439| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9333
Epoch: 1|  Loss:  1.3792 |Global loss: 5.7374| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.9402
Epoch: 2|  Loss:  1.3823 |Global loss: 5.7348| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9486
Epoch: 3|  Loss:  1.3744 |Global loss: 5.7312| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.9521
Epoch: 0|  Loss:  1.2368 |Global loss: 5.7701| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9516
Epoch: 1|  Loss:  1.2451 |Global loss: 5.7756| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9467
Epoch: 2|  Loss:  1.2355 |Global loss: 5.7734| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9389
Epoch: 3|  Loss:  1.2329 |Global loss: 5.7846| Local H loss: 0.0364  | Global H loss: 0.0364
------------------------- time cost ------------------------- 3.0323331356048584
Chosen Clients:  [14, 10, 0, 2, 12, 9]

-------------Round number: 443-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.958, 0.983, 0.833, 0.967, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [117.264, 119.315, 118.58, 118.936, 118.102, 118.003, 117.823, 118.888, 119.261, 119.098, 118.477, 119.157, 116.609, 115.871, 119.31]
F1 Score:  [0.852, 0.971, 0.955, 0.982, 0.761, 0.964, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.733, 0.847, 0.971]
Recall Score:  [0.878, 0.977, 0.966, 0.986, 0.81, 0.971, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.777, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2169
Averaged Test Accurancy: 0.9300
Averaged Test AUC: 0.9859
Averaged Test F1_score: 0.9222
Averaged Test Recal score: 0.9380
Std Test Accurancy: 0.0726
Std Test AUC: 0.0084
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9122
Epoch: 0|  Loss:  1.1282 |Global loss: 5.7113| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.899
Epoch: 1|  Loss:  1.1229 |Global loss: 5.732| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9005
Epoch: 2|  Loss:  1.1252 |Global loss: 5.7279| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.8863
Epoch: 3|  Loss:  1.1101 |Global loss: 5.7436| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9076
Epoch: 0|  Loss:  1.1427 |Global loss: 5.7281| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9005
Epoch: 1|  Loss:  1.1359 |Global loss: 5.7358| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.8985
Epoch: 2|  Loss:  1.1318 |Global loss: 5.7348| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.8719
Epoch: 3|  Loss:  1.1018 |Global loss: 5.7528| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9035
Epoch: 0|  Loss:  1.2471 |Global loss: 5.7644| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9312
Epoch: 1|  Loss:  1.2795 |Global loss: 5.7495| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9321
Epoch: 2|  Loss:  1.2647 |Global loss: 5.7457| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9512
Epoch: 3|  Loss:  1.2844 |Global loss: 5.7272| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9523
Epoch: 0|  Loss:  1.2402 |Global loss: 5.7716| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9527
Epoch: 1|  Loss:  1.235 |Global loss: 5.768| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 2|  NKD Loss: 0.9326
Epoch: 2|  Loss:  1.2159 |Global loss: 5.7811| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.937
Epoch: 3|  Loss:  1.2261 |Global loss: 5.7805| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.994
Epoch: 0|  Loss:  1.5813 |Global loss: 5.8069| Local H loss: 0.0456  | Global H loss: 0.0456
Epoch: 1|  NKD Loss: 0.9801
Epoch: 1|  Loss:  1.5894 |Global loss: 5.8174| Local H loss: 0.0455  | Global H loss: 0.0455
Epoch: 2|  NKD Loss: 0.9891
Epoch: 2|  Loss:  1.5807 |Global loss: 5.813| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 3|  NKD Loss: 0.9837
Epoch: 3|  Loss:  1.5726 |Global loss: 5.8099| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 0|  NKD Loss: 0.8897
Epoch: 0|  Loss:  1.0917 |Global loss: 5.6937| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.8548
Epoch: 1|  Loss:  1.0581 |Global loss: 5.7149| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.8708
Epoch: 2|  Loss:  1.0737 |Global loss: 5.7061| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.8847
Epoch: 3|  Loss:  1.0861 |Global loss: 5.6971| Local H loss: 0.0262  | Global H loss: 0.0262
------------------------- time cost ------------------------- 3.065643548965454
Chosen Clients:  [5, 0, 4, 3, 10, 6]

-------------Round number: 444-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.825, 0.975, 0.942, 0.983, 0.833, 0.967, 0.95, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.133, 119.315, 118.517, 118.936, 118.102, 118.003, 117.823, 118.888, 119.261, 119.098, 118.486, 119.157, 116.505, 115.871, 119.329]
F1 Score:  [0.84, 0.971, 0.939, 0.982, 0.761, 0.964, 0.946, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.866, 0.977, 0.955, 0.986, 0.81, 0.971, 0.956, 0.977, 0.977, 0.984, 0.956, 0.984, 0.75, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2186
Averaged Test Accurancy: 0.9256
Averaged Test AUC: 0.9858
Averaged Test F1_score: 0.9185
Averaged Test Recal score: 0.9347
Std Test Accurancy: 0.0796
Std Test AUC: 0.0086
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9469
Epoch: 0|  Loss:  1.2928 |Global loss: 5.776| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9457
Epoch: 1|  Loss:  1.2915 |Global loss: 5.7794| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9452
Epoch: 2|  Loss:  1.2908 |Global loss: 5.775| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9614
Epoch: 3|  Loss:  1.2997 |Global loss: 5.7612| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9364
Epoch: 0|  Loss:  1.2861 |Global loss: 5.7424| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9071
Epoch: 1|  Loss:  1.2354 |Global loss: 5.7562| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9247
Epoch: 2|  Loss:  1.2784 |Global loss: 5.7523| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.9092
Epoch: 3|  Loss:  1.2581 |Global loss: 5.7577| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9066
Epoch: 0|  Loss:  1.3273 |Global loss: 5.7204| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.9137
Epoch: 1|  Loss:  1.33 |Global loss: 5.7119| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 2|  NKD Loss: 0.923
Epoch: 2|  Loss:  1.3423 |Global loss: 5.7056| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.9133
Epoch: 3|  Loss:  1.3367 |Global loss: 5.6976| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 0.8856
Epoch: 0|  Loss:  1.118 |Global loss: 5.7137| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 1|  NKD Loss: 0.8804
Epoch: 1|  Loss:  1.1138 |Global loss: 5.7138| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.8948
Epoch: 2|  Loss:  1.1254 |Global loss: 5.7027| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 3|  NKD Loss: 0.8823
Epoch: 3|  Loss:  1.1123 |Global loss: 5.7175| Local H loss: 0.0391  | Global H loss: 0.0391
Epoch: 0|  NKD Loss: 0.8989
Epoch: 0|  Loss:  1.1332 |Global loss: 5.7379| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.8991
Epoch: 1|  Loss:  1.133 |Global loss: 5.7332| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.8925
Epoch: 2|  Loss:  1.1264 |Global loss: 5.7368| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.8993
Epoch: 3|  Loss:  1.1349 |Global loss: 5.7373| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9257
Epoch: 0|  Loss:  1.2049 |Global loss: 5.7543| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.941
Epoch: 1|  Loss:  1.2337 |Global loss: 5.7435| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9322
Epoch: 2|  Loss:  1.2124 |Global loss: 5.7453| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9264
Epoch: 3|  Loss:  1.2044 |Global loss: 5.7512| Local H loss: 0.0311  | Global H loss: 0.0311
------------------------- time cost ------------------------- 3.5225489139556885
Chosen Clients:  [13, 7, 2, 9, 4, 1]

-------------Round number: 445-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.85, 0.975, 0.942, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.283, 119.315, 118.517, 118.936, 118.115, 118.01, 117.812, 118.888, 119.261, 119.098, 118.486, 119.157, 116.505, 115.871, 119.329]
F1 Score:  [0.86, 0.971, 0.939, 0.982, 0.761, 0.954, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.847, 0.971]
Recall Score:  [0.885, 0.977, 0.955, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.75, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2170
Averaged Test Accurancy: 0.9272
Averaged Test AUC: 0.9859
Averaged Test F1_score: 0.9198
Averaged Test Recal score: 0.9361
Std Test Accurancy: 0.0776
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9378
Epoch: 0|  Loss:  1.3699 |Global loss: 5.7365| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.916
Epoch: 1|  Loss:  1.3515 |Global loss: 5.7439| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.9354
Epoch: 2|  Loss:  1.381 |Global loss: 5.7429| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 3|  NKD Loss: 0.9329
Epoch: 3|  Loss:  1.3749 |Global loss: 5.7395| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 0|  NKD Loss: 0.9009
Epoch: 0|  Loss:  1.1241 |Global loss: 5.7278| Local H loss: 0.0371  | Global H loss: 0.0371
Epoch: 1|  NKD Loss: 0.8731
Epoch: 1|  Loss:  1.0889 |Global loss: 5.7425| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9069
Epoch: 2|  Loss:  1.1258 |Global loss: 5.721| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 3|  NKD Loss: 0.8926
Epoch: 3|  Loss:  1.1133 |Global loss: 5.7318| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 0|  NKD Loss: 0.9269
Epoch: 0|  Loss:  1.2133 |Global loss: 5.7786| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9583
Epoch: 1|  Loss:  1.248 |Global loss: 5.767| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9402
Epoch: 2|  Loss:  1.2297 |Global loss: 5.7772| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9383
Epoch: 3|  Loss:  1.2277 |Global loss: 5.7755| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.8433
Epoch: 0|  Loss:  1.0455 |Global loss: 5.7262| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.8708
Epoch: 1|  Loss:  1.0737 |Global loss: 5.7066| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.8629
Epoch: 2|  Loss:  1.061 |Global loss: 5.7042| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.8792
Epoch: 3|  Loss:  1.0799 |Global loss: 5.6988| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9001
Epoch: 0|  Loss:  1.3219 |Global loss: 5.7181| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.9008
Epoch: 1|  Loss:  1.3191 |Global loss: 5.7141| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 2|  NKD Loss: 0.9127
Epoch: 2|  Loss:  1.3379 |Global loss: 5.7107| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 0.9154
Epoch: 3|  Loss:  1.3356 |Global loss: 5.713| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 0|  NKD Loss: 0.9204
Epoch: 0|  Loss:  1.1847 |Global loss: 5.7492| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9265
Epoch: 1|  Loss:  1.1895 |Global loss: 5.7488| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9059
Epoch: 2|  Loss:  1.1622 |Global loss: 5.7678| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9256
Epoch: 3|  Loss:  1.1902 |Global loss: 5.7535| Local H loss: 0.0275  | Global H loss: 0.0275
------------------------- time cost ------------------------- 3.2094664573669434
Chosen Clients:  [0, 3, 10, 6, 8, 4]

-------------Round number: 446-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.85, 0.975, 0.942, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.283, 119.329, 118.575, 118.936, 118.105, 118.01, 117.812, 118.961, 119.261, 119.102, 118.486, 119.157, 116.505, 115.954, 119.329]
F1 Score:  [0.86, 0.971, 0.939, 0.982, 0.761, 0.954, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.843, 0.971]
Recall Score:  [0.885, 0.977, 0.955, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.75, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2119
Averaged Test Accurancy: 0.9272
Averaged Test AUC: 0.9860
Averaged Test F1_score: 0.9195
Averaged Test Recal score: 0.9361
Std Test Accurancy: 0.0776
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9379
Epoch: 0|  Loss:  1.2844 |Global loss: 5.7395| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.268 |Global loss: 5.7532| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.925
Epoch: 2|  Loss:  1.2644 |Global loss: 5.7437| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.918
Epoch: 3|  Loss:  1.261 |Global loss: 5.7478| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 0.875
Epoch: 0|  Loss:  1.1099 |Global loss: 5.721| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.8754
Epoch: 1|  Loss:  1.1078 |Global loss: 5.7194| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 2|  NKD Loss: 0.8639
Epoch: 2|  Loss:  1.0979 |Global loss: 5.7288| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.8912
Epoch: 3|  Loss:  1.1225 |Global loss: 5.709| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 0|  NKD Loss: 0.9075
Epoch: 0|  Loss:  1.1394 |Global loss: 5.7257| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 1|  NKD Loss: 0.9011
Epoch: 1|  Loss:  1.1363 |Global loss: 5.7307| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9072
Epoch: 2|  Loss:  1.1388 |Global loss: 5.7281| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.8877
Epoch: 3|  Loss:  1.1163 |Global loss: 5.7417| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.2237 |Global loss: 5.7483| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9288
Epoch: 1|  Loss:  1.2196 |Global loss: 5.7523| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9305
Epoch: 2|  Loss:  1.221 |Global loss: 5.745| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9292
Epoch: 3|  Loss:  1.2174 |Global loss: 5.753| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8744
Epoch: 0|  Loss:  1.0948 |Global loss: 5.7359| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 1|  NKD Loss: 0.8949
Epoch: 1|  Loss:  1.1122 |Global loss: 5.7257| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 2|  NKD Loss: 0.9012
Epoch: 2|  Loss:  1.1201 |Global loss: 5.7136| Local H loss: 0.0342  | Global H loss: 0.0342
Epoch: 3|  NKD Loss: 0.9085
Epoch: 3|  Loss:  1.1207 |Global loss: 5.7147| Local H loss: 0.0345  | Global H loss: 0.0345
Epoch: 0|  NKD Loss: 0.92
Epoch: 0|  Loss:  1.3379 |Global loss: 5.7056| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.9159
Epoch: 1|  Loss:  1.3409 |Global loss: 5.7046| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 0.9206
Epoch: 2|  Loss:  1.3551 |Global loss: 5.7057| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 3|  NKD Loss: 0.9329
Epoch: 3|  Loss:  1.3453 |Global loss: 5.694| Local H loss: 0.0226  | Global H loss: 0.0226
------------------------- time cost ------------------------- 3.280870199203491
Chosen Clients:  [1, 8, 3, 6, 2, 14]

-------------Round number: 447-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.942, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.205, 119.329, 118.575, 118.94, 118.105, 118.01, 117.857, 118.961, 119.212, 119.102, 118.484, 119.157, 116.505, 115.954, 119.329]
F1 Score:  [0.855, 0.971, 0.939, 0.982, 0.761, 0.954, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.843, 0.971]
Recall Score:  [0.877, 0.977, 0.955, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.75, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2161
Averaged Test Accurancy: 0.9267
Averaged Test AUC: 0.9860
Averaged Test F1_score: 0.9192
Averaged Test Recal score: 0.9355
Std Test Accurancy: 0.0782
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9322
Epoch: 0|  Loss:  1.1986 |Global loss: 5.747| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.9278
Epoch: 1|  Loss:  1.1919 |Global loss: 5.7491| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9258
Epoch: 2|  Loss:  1.1843 |Global loss: 5.7511| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9316
Epoch: 3|  Loss:  1.1919 |Global loss: 5.7422| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.8955
Epoch: 0|  Loss:  1.114 |Global loss: 5.7222| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9166
Epoch: 1|  Loss:  1.1341 |Global loss: 5.7128| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.8892
Epoch: 2|  Loss:  1.1079 |Global loss: 5.7212| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8897
Epoch: 3|  Loss:  1.1064 |Global loss: 5.7245| Local H loss: 0.0341  | Global H loss: 0.0341
Epoch: 0|  NKD Loss: 0.8904
Epoch: 0|  Loss:  1.1221 |Global loss: 5.7088| Local H loss: 0.0389  | Global H loss: 0.0389
Epoch: 1|  NKD Loss: 0.8899
Epoch: 1|  Loss:  1.121 |Global loss: 5.7063| Local H loss: 0.039  | Global H loss: 0.039
Epoch: 2|  NKD Loss: 0.8834
Epoch: 2|  Loss:  1.1063 |Global loss: 5.7092| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 3|  NKD Loss: 0.8715
Epoch: 3|  Loss:  1.1019 |Global loss: 5.7184| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 0|  NKD Loss: 0.923
Epoch: 0|  Loss:  1.2119 |Global loss: 5.7542| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9396
Epoch: 1|  Loss:  1.227 |Global loss: 5.7483| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9333
Epoch: 2|  Loss:  1.2131 |Global loss: 5.7377| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9292
Epoch: 3|  Loss:  1.2175 |Global loss: 5.7481| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9577
Epoch: 0|  Loss:  1.2541 |Global loss: 5.7698| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 1|  NKD Loss: 0.9475
Epoch: 1|  Loss:  1.2232 |Global loss: 5.764| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9503
Epoch: 2|  Loss:  1.2366 |Global loss: 5.7705| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.9383
Epoch: 3|  Loss:  1.2261 |Global loss: 5.7762| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9039
Epoch: 0|  Loss:  1.1274 |Global loss: 5.7217| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9112
Epoch: 1|  Loss:  1.1342 |Global loss: 5.7196| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9101
Epoch: 2|  Loss:  1.1346 |Global loss: 5.7214| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9022
Epoch: 3|  Loss:  1.1264 |Global loss: 5.7288| Local H loss: 0.0272  | Global H loss: 0.0272
------------------------- time cost ------------------------- 2.9529285430908203
Chosen Clients:  [0, 6, 12, 7, 14, 8]

-------------Round number: 448-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.958, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.205, 119.358, 118.688, 118.94, 118.105, 118.01, 117.892, 118.961, 119.245, 119.102, 118.484, 119.157, 116.505, 115.954, 119.338]
F1 Score:  [0.855, 0.971, 0.955, 0.982, 0.761, 0.954, 0.954, 0.971, 0.97, 0.981, 0.949, 0.98, 0.705, 0.843, 0.971]
Recall Score:  [0.877, 0.977, 0.966, 0.986, 0.81, 0.963, 0.962, 0.977, 0.977, 0.984, 0.956, 0.984, 0.75, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2160
Averaged Test Accurancy: 0.9278
Averaged Test AUC: 0.9861
Averaged Test F1_score: 0.9201
Averaged Test Recal score: 0.9360
Std Test Accurancy: 0.0785
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9328
Epoch: 0|  Loss:  1.2836 |Global loss: 5.7437| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9123
Epoch: 1|  Loss:  1.2565 |Global loss: 5.7572| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9331
Epoch: 2|  Loss:  1.2733 |Global loss: 5.7413| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9309
Epoch: 3|  Loss:  1.2691 |Global loss: 5.741| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9336
Epoch: 0|  Loss:  1.2054 |Global loss: 5.745| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9354
Epoch: 1|  Loss:  1.2235 |Global loss: 5.7451| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9348
Epoch: 2|  Loss:  1.222 |Global loss: 5.7435| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9343
Epoch: 3|  Loss:  1.2073 |Global loss: 5.7439| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9931
Epoch: 0|  Loss:  1.5796 |Global loss: 5.8001| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 1|  NKD Loss: 0.985
Epoch: 1|  Loss:  1.5639 |Global loss: 5.8075| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 2|  NKD Loss: 0.9903
Epoch: 2|  Loss:  1.5844 |Global loss: 5.8159| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 3|  NKD Loss: 0.9761
Epoch: 3|  Loss:  1.5649 |Global loss: 5.8135| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 0|  NKD Loss: 0.8868
Epoch: 0|  Loss:  1.1063 |Global loss: 5.7275| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.9081
Epoch: 1|  Loss:  1.1246 |Global loss: 5.7197| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.8864
Epoch: 2|  Loss:  1.106 |Global loss: 5.7283| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 3|  NKD Loss: 0.8995
Epoch: 3|  Loss:  1.1199 |Global loss: 5.7232| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.904
Epoch: 0|  Loss:  1.1275 |Global loss: 5.7285| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9075
Epoch: 1|  Loss:  1.1235 |Global loss: 5.7197| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9135
Epoch: 2|  Loss:  1.1286 |Global loss: 5.7179| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9057
Epoch: 3|  Loss:  1.1231 |Global loss: 5.7168| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9143
Epoch: 0|  Loss:  1.1321 |Global loss: 5.7094| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.8871
Epoch: 1|  Loss:  1.1038 |Global loss: 5.7277| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.8934
Epoch: 2|  Loss:  1.1053 |Global loss: 5.7211| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8944
Epoch: 3|  Loss:  1.1137 |Global loss: 5.72| Local H loss: 0.0337  | Global H loss: 0.0337
------------------------- time cost ------------------------- 3.133523464202881
Chosen Clients:  [14, 12, 6, 9, 1, 4]

-------------Round number: 449-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.958, 0.983, 0.833, 0.958, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.245, 119.358, 118.688, 118.94, 118.105, 118.01, 117.88, 118.964, 119.264, 119.102, 118.484, 119.157, 116.795, 115.954, 119.334]
F1 Score:  [0.855, 0.971, 0.955, 0.982, 0.761, 0.954, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.877, 0.977, 0.966, 0.986, 0.81, 0.963, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2134
Averaged Test Accurancy: 0.9322
Averaged Test AUC: 0.9863
Averaged Test F1_score: 0.9235
Averaged Test Recal score: 0.9398
Std Test Accurancy: 0.0670
Std Test AUC: 0.0082
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.895
Epoch: 0|  Loss:  1.1175 |Global loss: 5.7264| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9128
Epoch: 1|  Loss:  1.1337 |Global loss: 5.7139| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9226
Epoch: 2|  Loss:  1.1416 |Global loss: 5.7163| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.8987
Epoch: 3|  Loss:  1.1099 |Global loss: 5.7292| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9881
Epoch: 0|  Loss:  1.5899 |Global loss: 5.822| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 1|  NKD Loss: 0.9846
Epoch: 1|  Loss:  1.5912 |Global loss: 5.8194| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 2|  NKD Loss: 0.9883
Epoch: 2|  Loss:  1.5734 |Global loss: 5.798| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 3|  NKD Loss: 0.9975
Epoch: 3|  Loss:  1.5786 |Global loss: 5.7975| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.9198
Epoch: 0|  Loss:  1.2032 |Global loss: 5.7505| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9247
Epoch: 1|  Loss:  1.2113 |Global loss: 5.747| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9268
Epoch: 2|  Loss:  1.21 |Global loss: 5.7459| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9472
Epoch: 3|  Loss:  1.2313 |Global loss: 5.738| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8766
Epoch: 0|  Loss:  1.064 |Global loss: 5.6993| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.8777
Epoch: 1|  Loss:  1.0791 |Global loss: 5.7003| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 2|  NKD Loss: 0.8617
Epoch: 2|  Loss:  1.0512 |Global loss: 5.7049| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.8793
Epoch: 3|  Loss:  1.0806 |Global loss: 5.6988| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.9409
Epoch: 0|  Loss:  1.2043 |Global loss: 5.7381| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9246
Epoch: 1|  Loss:  1.1861 |Global loss: 5.7456| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9035
Epoch: 2|  Loss:  1.1628 |Global loss: 5.7492| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.911
Epoch: 3|  Loss:  1.1714 |Global loss: 5.7634| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9203
Epoch: 0|  Loss:  1.3297 |Global loss: 5.7069| Local H loss: 0.0226  | Global H loss: 0.0226
Epoch: 1|  NKD Loss: 0.8974
Epoch: 1|  Loss:  1.3256 |Global loss: 5.7209| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 0.9092
Epoch: 2|  Loss:  1.3284 |Global loss: 5.7044| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 3|  NKD Loss: 0.9276
Epoch: 3|  Loss:  1.3527 |Global loss: 5.6972| Local H loss: 0.0225  | Global H loss: 0.0225
------------------------- time cost ------------------------- 3.4323339462280273
Chosen Clients:  [2, 0, 5, 9, 1, 3]

-------------Round number: 450-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.958, 0.983, 0.833, 0.958, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [117.245, 119.361, 118.688, 118.94, 118.106, 118.01, 117.897, 118.964, 119.264, 119.094, 118.484, 119.157, 116.52, 115.954, 119.352]
F1 Score:  [0.855, 0.971, 0.955, 0.982, 0.761, 0.954, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.843, 0.971]
Recall Score:  [0.877, 0.977, 0.966, 0.986, 0.81, 0.963, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2193
Averaged Test Accurancy: 0.9272
Averaged Test AUC: 0.9861
Averaged Test F1_score: 0.9194
Averaged Test Recal score: 0.9357
Std Test Accurancy: 0.0819
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9466
Epoch: 0|  Loss:  1.2347 |Global loss: 5.77| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9365
Epoch: 1|  Loss:  1.2229 |Global loss: 5.7799| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9388
Epoch: 2|  Loss:  1.2185 |Global loss: 5.772| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9466
Epoch: 3|  Loss:  1.2378 |Global loss: 5.7761| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9237
Epoch: 0|  Loss:  1.2646 |Global loss: 5.7478| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9268
Epoch: 1|  Loss:  1.2544 |Global loss: 5.7361| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9442
Epoch: 2|  Loss:  1.2849 |Global loss: 5.7293| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9279
Epoch: 3|  Loss:  1.2659 |Global loss: 5.7453| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9679
Epoch: 0|  Loss:  1.3076 |Global loss: 5.7576| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9458
Epoch: 1|  Loss:  1.2856 |Global loss: 5.7701| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9484
Epoch: 2|  Loss:  1.2696 |Global loss: 5.7633| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9461
Epoch: 3|  Loss:  1.2883 |Global loss: 5.7727| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8549
Epoch: 0|  Loss:  1.0523 |Global loss: 5.7117| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.8746
Epoch: 1|  Loss:  1.0471 |Global loss: 5.6962| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 2|  NKD Loss: 0.8989
Epoch: 2|  Loss:  1.1003 |Global loss: 5.6834| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 3|  NKD Loss: 0.8996
Epoch: 3|  Loss:  1.0989 |Global loss: 5.6858| Local H loss: 0.0261  | Global H loss: 0.0261
Epoch: 0|  NKD Loss: 0.9193
Epoch: 0|  Loss:  1.1716 |Global loss: 5.7371| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 1|  NKD Loss: 0.9253
Epoch: 1|  Loss:  1.186 |Global loss: 5.7437| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9388
Epoch: 2|  Loss:  1.2013 |Global loss: 5.7445| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9177
Epoch: 3|  Loss:  1.18 |Global loss: 5.7545| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.8875
Epoch: 0|  Loss:  1.1189 |Global loss: 5.7087| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.8892
Epoch: 1|  Loss:  1.1204 |Global loss: 5.7098| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.897
Epoch: 2|  Loss:  1.1156 |Global loss: 5.7042| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.8764
Epoch: 3|  Loss:  1.1048 |Global loss: 5.7143| Local H loss: 0.0387  | Global H loss: 0.0387
------------------------- time cost ------------------------- 3.065636396408081
Chosen Clients:  [5, 6, 0, 9, 12, 11]

-------------Round number: 451-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.842, 0.975, 0.933, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.692, 0.85, 0.975]
AUC in each clients:  [117.255, 119.375, 118.431, 118.942, 118.106, 118.052, 117.897, 118.964, 119.264, 119.096, 118.484, 119.157, 116.52, 115.954, 119.352]
F1 Score:  [0.855, 0.971, 0.932, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.684, 0.843, 0.971]
Recall Score:  [0.877, 0.977, 0.949, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.737, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2178
Averaged Test Accurancy: 0.9261
Averaged Test AUC: 0.9860
Averaged Test F1_score: 0.9185
Averaged Test Recal score: 0.9351
Std Test Accurancy: 0.0818
Std Test AUC: 0.0085
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9542
Epoch: 0|  Loss:  1.2946 |Global loss: 5.7663| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9665
Epoch: 1|  Loss:  1.3034 |Global loss: 5.7633| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9428
Epoch: 2|  Loss:  1.2813 |Global loss: 5.7703| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9574
Epoch: 3|  Loss:  1.2943 |Global loss: 5.7634| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9257
Epoch: 0|  Loss:  1.2126 |Global loss: 5.7488| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9088
Epoch: 1|  Loss:  1.1859 |Global loss: 5.7537| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9257
Epoch: 2|  Loss:  1.2019 |Global loss: 5.7505| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9411
Epoch: 3|  Loss:  1.2219 |Global loss: 5.7401| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 0|  NKD Loss: 0.9224
Epoch: 0|  Loss:  1.2658 |Global loss: 5.7455| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9307
Epoch: 1|  Loss:  1.2538 |Global loss: 5.73| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9369
Epoch: 2|  Loss:  1.2609 |Global loss: 5.7319| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9265
Epoch: 3|  Loss:  1.2664 |Global loss: 5.7436| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.8693
Epoch: 0|  Loss:  1.0702 |Global loss: 5.7041| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 1|  NKD Loss: 0.8625
Epoch: 1|  Loss:  1.0626 |Global loss: 5.7082| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 2|  NKD Loss: 0.8713
Epoch: 2|  Loss:  1.0722 |Global loss: 5.7059| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.8912
Epoch: 3|  Loss:  1.092 |Global loss: 5.6848| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 0|  NKD Loss: 0.9688
Epoch: 0|  Loss:  1.5641 |Global loss: 5.8223| Local H loss: 0.0457  | Global H loss: 0.0457
Epoch: 1|  NKD Loss: 0.9853
Epoch: 1|  Loss:  1.5669 |Global loss: 5.8071| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 2|  NKD Loss: 0.9872
Epoch: 2|  Loss:  1.5807 |Global loss: 5.8123| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 3|  NKD Loss: 0.9935
Epoch: 3|  Loss:  1.5783 |Global loss: 5.8093| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 0|  NKD Loss: 0.8959
Epoch: 0|  Loss:  1.1187 |Global loss: 5.7164| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9033
Epoch: 1|  Loss:  1.1245 |Global loss: 5.7147| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9038
Epoch: 2|  Loss:  1.1217 |Global loss: 5.7104| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.8967
Epoch: 3|  Loss:  1.1156 |Global loss: 5.7214| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 3.044381618499756
Chosen Clients:  [9, 1, 7, 4, 5, 2]

-------------Round number: 452-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.833, 0.975, 0.933, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.217, 119.375, 118.431, 118.942, 118.106, 118.061, 117.931, 118.964, 119.264, 119.098, 118.484, 119.102, 116.717, 115.954, 119.352]
F1 Score:  [0.847, 0.971, 0.932, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.871, 0.977, 0.949, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2169
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9861
Averaged Test F1_score: 0.9227
Averaged Test Recal score: 0.9391
Std Test Accurancy: 0.0679
Std Test AUC: 0.0083
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8754
Epoch: 0|  Loss:  1.0588 |Global loss: 5.7015| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 1|  NKD Loss: 0.8812
Epoch: 1|  Loss:  1.0775 |Global loss: 5.6887| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.8773
Epoch: 2|  Loss:  1.0773 |Global loss: 5.6985| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.8918
Epoch: 3|  Loss:  1.0916 |Global loss: 5.6888| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 0|  NKD Loss: 0.9052
Epoch: 0|  Loss:  1.1642 |Global loss: 5.7612| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.931
Epoch: 1|  Loss:  1.1805 |Global loss: 5.7423| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9226
Epoch: 2|  Loss:  1.1826 |Global loss: 5.7477| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.936
Epoch: 3|  Loss:  1.1793 |Global loss: 5.7381| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 0|  NKD Loss: 0.9055
Epoch: 0|  Loss:  1.125 |Global loss: 5.7125| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.8998
Epoch: 1|  Loss:  1.1198 |Global loss: 5.723| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.901
Epoch: 2|  Loss:  1.117 |Global loss: 5.7282| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 3|  NKD Loss: 0.8912
Epoch: 3|  Loss:  1.1111 |Global loss: 5.7196| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9148
Epoch: 0|  Loss:  1.3465 |Global loss: 5.7073| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.9043
Epoch: 1|  Loss:  1.3312 |Global loss: 5.7229| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 0.906
Epoch: 2|  Loss:  1.3372 |Global loss: 5.7133| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 0.9207
Epoch: 3|  Loss:  1.3485 |Global loss: 5.7033| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 0.9471
Epoch: 0|  Loss:  1.287 |Global loss: 5.7711| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9586
Epoch: 1|  Loss:  1.297 |Global loss: 5.7613| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9502
Epoch: 2|  Loss:  1.2797 |Global loss: 5.764| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9414
Epoch: 3|  Loss:  1.2768 |Global loss: 5.7719| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9515
Epoch: 0|  Loss:  1.2406 |Global loss: 5.7657| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9631
Epoch: 1|  Loss:  1.2497 |Global loss: 5.7625| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.9314
Epoch: 2|  Loss:  1.2153 |Global loss: 5.7783| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9284
Epoch: 3|  Loss:  1.2119 |Global loss: 5.7756| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 3.0209901332855225
Chosen Clients:  [1, 2, 0, 10, 6, 13]

-------------Round number: 453-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.833, 0.975, 0.958, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.217, 119.361, 118.652, 118.942, 118.104, 118.045, 117.931, 118.968, 119.264, 119.098, 118.484, 119.102, 116.717, 115.954, 119.352]
F1 Score:  [0.847, 0.971, 0.955, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.871, 0.977, 0.966, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2153
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9862
Averaged Test F1_score: 0.9242
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0683
Std Test AUC: 0.0083
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9379
Epoch: 0|  Loss:  1.1944 |Global loss: 5.7367| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 1|  NKD Loss: 0.909
Epoch: 1|  Loss:  1.167 |Global loss: 5.7555| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9082
Epoch: 2|  Loss:  1.1664 |Global loss: 5.7562| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9149
Epoch: 3|  Loss:  1.1739 |Global loss: 5.7499| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.956
Epoch: 0|  Loss:  1.2436 |Global loss: 5.7643| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9409
Epoch: 1|  Loss:  1.2247 |Global loss: 5.772| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9402
Epoch: 2|  Loss:  1.2214 |Global loss: 5.7656| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 3|  NKD Loss: 0.9374
Epoch: 3|  Loss:  1.2224 |Global loss: 5.7756| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 0|  NKD Loss: 0.9291
Epoch: 0|  Loss:  1.2694 |Global loss: 5.7389| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9407
Epoch: 1|  Loss:  1.2696 |Global loss: 5.7274| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9438
Epoch: 2|  Loss:  1.2624 |Global loss: 5.7339| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.9349
Epoch: 3|  Loss:  1.2625 |Global loss: 5.7306| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8818
Epoch: 0|  Loss:  1.1177 |Global loss: 5.7464| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9014
Epoch: 1|  Loss:  1.1338 |Global loss: 5.7314| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.8926
Epoch: 2|  Loss:  1.1213 |Global loss: 5.7349| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9201
Epoch: 3|  Loss:  1.1539 |Global loss: 5.7215| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9387
Epoch: 0|  Loss:  1.2108 |Global loss: 5.7341| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9306
Epoch: 1|  Loss:  1.1975 |Global loss: 5.7386| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 2|  NKD Loss: 0.9246
Epoch: 2|  Loss:  1.1987 |Global loss: 5.7489| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 3|  NKD Loss: 0.9318
Epoch: 3|  Loss:  1.2114 |Global loss: 5.7445| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9257
Epoch: 0|  Loss:  1.3634 |Global loss: 5.7472| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.3442 |Global loss: 5.7559| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.927
Epoch: 2|  Loss:  1.3777 |Global loss: 5.7431| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.9329
Epoch: 3|  Loss:  1.3879 |Global loss: 5.7366| Local H loss: 0.0329  | Global H loss: 0.0329
------------------------- time cost ------------------------- 3.12363862991333
Chosen Clients:  [0, 5, 3, 6, 14, 2]

-------------Round number: 454-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.858, 0.975, 0.942, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.349, 119.372, 118.622, 118.942, 118.104, 118.045, 117.954, 118.968, 119.264, 119.098, 118.488, 119.102, 116.717, 116.089, 119.352]
F1 Score:  [0.868, 0.971, 0.939, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.892, 0.977, 0.955, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2165
Averaged Test Accurancy: 0.9333
Averaged Test AUC: 0.9864
Averaged Test F1_score: 0.9245
Averaged Test Recal score: 0.9409
Std Test Accurancy: 0.0658
Std Test AUC: 0.0080
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9269
Epoch: 0|  Loss:  1.2566 |Global loss: 5.7406| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9346
Epoch: 1|  Loss:  1.2649 |Global loss: 5.7358| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9267
Epoch: 2|  Loss:  1.2523 |Global loss: 5.7398| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9317
Epoch: 3|  Loss:  1.274 |Global loss: 5.7407| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9507
Epoch: 0|  Loss:  1.2696 |Global loss: 5.7666| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9702
Epoch: 1|  Loss:  1.3068 |Global loss: 5.7525| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9633
Epoch: 2|  Loss:  1.2891 |Global loss: 5.7643| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.956
Epoch: 3|  Loss:  1.2922 |Global loss: 5.7626| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8801
Epoch: 0|  Loss:  1.1124 |Global loss: 5.7204| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.8666
Epoch: 1|  Loss:  1.0987 |Global loss: 5.7223| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 2|  NKD Loss: 0.8882
Epoch: 2|  Loss:  1.1181 |Global loss: 5.7079| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 3|  NKD Loss: 0.9027
Epoch: 3|  Loss:  1.1333 |Global loss: 5.7005| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 0|  NKD Loss: 0.9363
Epoch: 0|  Loss:  1.2129 |Global loss: 5.7405| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9239
Epoch: 1|  Loss:  1.2012 |Global loss: 5.7441| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9308
Epoch: 2|  Loss:  1.2132 |Global loss: 5.7441| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9375
Epoch: 3|  Loss:  1.2199 |Global loss: 5.7336| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9072
Epoch: 0|  Loss:  1.1272 |Global loss: 5.7197| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9213
Epoch: 1|  Loss:  1.1416 |Global loss: 5.7153| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.911
Epoch: 2|  Loss:  1.1242 |Global loss: 5.7177| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9107
Epoch: 3|  Loss:  1.1303 |Global loss: 5.7156| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9482
Epoch: 0|  Loss:  1.2358 |Global loss: 5.7654| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9519
Epoch: 1|  Loss:  1.2348 |Global loss: 5.7645| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9035
Epoch: 2|  Loss:  1.182 |Global loss: 5.798| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9211
Epoch: 3|  Loss:  1.205 |Global loss: 5.7843| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 3.1147632598876953
Chosen Clients:  [8, 0, 9, 6, 3, 1]

-------------Round number: 455-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.942, 0.983, 0.833, 0.967, 0.958, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.375, 119.372, 118.688, 118.948, 118.104, 118.048, 117.977, 118.968, 119.264, 119.098, 118.488, 119.102, 116.717, 116.089, 119.353]
F1 Score:  [0.883, 0.971, 0.939, 0.982, 0.761, 0.964, 0.956, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.955, 0.986, 0.81, 0.971, 0.966, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2117
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9864
Averaged Test F1_score: 0.9250
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0644
Std Test AUC: 0.0080
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9124
Epoch: 0|  Loss:  1.1275 |Global loss: 5.7095| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.9119
Epoch: 1|  Loss:  1.1286 |Global loss: 5.7092| Local H loss: 0.0344  | Global H loss: 0.0344
Epoch: 2|  NKD Loss: 0.8923
Epoch: 2|  Loss:  1.1093 |Global loss: 5.7212| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.8923
Epoch: 3|  Loss:  1.11 |Global loss: 5.7203| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.9297
Epoch: 0|  Loss:  1.2732 |Global loss: 5.7501| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9422
Epoch: 1|  Loss:  1.283 |Global loss: 5.7294| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.929
Epoch: 2|  Loss:  1.2579 |Global loss: 5.7404| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9224
Epoch: 3|  Loss:  1.2562 |Global loss: 5.7459| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.881
Epoch: 0|  Loss:  1.0815 |Global loss: 5.6945| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8686
Epoch: 1|  Loss:  1.0681 |Global loss: 5.7092| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.8958
Epoch: 2|  Loss:  1.0946 |Global loss: 5.6841| Local H loss: 0.026  | Global H loss: 0.026
Epoch: 3|  NKD Loss: 0.8629
Epoch: 3|  Loss:  1.0625 |Global loss: 5.7085| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.9201
Epoch: 0|  Loss:  1.1985 |Global loss: 5.7475| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9152
Epoch: 1|  Loss:  1.1952 |Global loss: 5.7518| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9154
Epoch: 2|  Loss:  1.1979 |Global loss: 5.7505| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9017
Epoch: 3|  Loss:  1.1751 |Global loss: 5.7605| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.886
Epoch: 0|  Loss:  1.1145 |Global loss: 5.713| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 1|  NKD Loss: 0.8774
Epoch: 1|  Loss:  1.0985 |Global loss: 5.7129| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 2|  NKD Loss: 0.8941
Epoch: 2|  Loss:  1.1008 |Global loss: 5.7031| Local H loss: 0.0388  | Global H loss: 0.0388
Epoch: 3|  NKD Loss: 0.8884
Epoch: 3|  Loss:  1.1191 |Global loss: 5.7077| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 0|  NKD Loss: 0.9223
Epoch: 0|  Loss:  1.1833 |Global loss: 5.7423| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.9203
Epoch: 1|  Loss:  1.1532 |Global loss: 5.7431| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 2|  NKD Loss: 0.9316
Epoch: 2|  Loss:  1.1871 |Global loss: 5.7313| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9188
Epoch: 3|  Loss:  1.1567 |Global loss: 5.7474| Local H loss: 0.0274  | Global H loss: 0.0274
------------------------- time cost ------------------------- 3.2428810596466064
Chosen Clients:  [8, 12, 0, 1, 14, 3]

-------------Round number: 456-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.942, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.402, 119.384, 118.688, 118.948, 118.104, 118.048, 117.993, 118.968, 119.245, 119.097, 118.488, 119.102, 116.717, 116.089, 119.353]
F1 Score:  [0.883, 0.971, 0.939, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.955, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2093
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9865
Averaged Test F1_score: 0.9255
Averaged Test Recal score: 0.9418
Std Test Accurancy: 0.0647
Std Test AUC: 0.0080
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9131
Epoch: 0|  Loss:  1.1301 |Global loss: 5.7101| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.8963
Epoch: 1|  Loss:  1.1122 |Global loss: 5.7151| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.8836
Epoch: 2|  Loss:  1.0869 |Global loss: 5.7284| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8792
Epoch: 3|  Loss:  1.0899 |Global loss: 5.7295| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 0|  NKD Loss: 0.98
Epoch: 0|  Loss:  1.572 |Global loss: 5.8121| Local H loss: 0.0458  | Global H loss: 0.0458
Epoch: 1|  NKD Loss: 0.9889
Epoch: 1|  Loss:  1.5717 |Global loss: 5.7983| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 2|  NKD Loss: 0.9819
Epoch: 2|  Loss:  1.5516 |Global loss: 5.8075| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 3|  NKD Loss: 0.9896
Epoch: 3|  Loss:  1.5612 |Global loss: 5.8007| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.2755 |Global loss: 5.7343| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9376
Epoch: 1|  Loss:  1.2553 |Global loss: 5.7244| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9216
Epoch: 2|  Loss:  1.2511 |Global loss: 5.7386| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.9341
Epoch: 3|  Loss:  1.2675 |Global loss: 5.7277| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.9301
Epoch: 0|  Loss:  1.1864 |Global loss: 5.7364| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9338
Epoch: 1|  Loss:  1.1865 |Global loss: 5.7295| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9063
Epoch: 2|  Loss:  1.1618 |Global loss: 5.7522| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.925
Epoch: 3|  Loss:  1.1748 |Global loss: 5.738| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8936
Epoch: 0|  Loss:  1.1135 |Global loss: 5.7257| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9008
Epoch: 1|  Loss:  1.1201 |Global loss: 5.7235| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.8791
Epoch: 2|  Loss:  1.1016 |Global loss: 5.7402| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.8914
Epoch: 3|  Loss:  1.1029 |Global loss: 5.7302| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.893
Epoch: 0|  Loss:  1.1205 |Global loss: 5.6998| Local H loss: 0.0387  | Global H loss: 0.0387
Epoch: 1|  NKD Loss: 0.8801
Epoch: 1|  Loss:  1.0965 |Global loss: 5.712| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 2|  NKD Loss: 0.861
Epoch: 2|  Loss:  1.0904 |Global loss: 5.7248| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.8758
Epoch: 3|  Loss:  1.0909 |Global loss: 5.7142| Local H loss: 0.0385  | Global H loss: 0.0385
------------------------- time cost ------------------------- 3.1679859161376953
Chosen Clients:  [13, 2, 11, 10, 9, 7]

-------------Round number: 457-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.883, 0.975, 0.942, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.758, 0.85, 0.975]
AUC in each clients:  [117.449, 119.401, 118.688, 118.948, 118.104, 118.048, 117.993, 118.968, 119.27, 119.097, 118.488, 119.102, 116.772, 116.089, 119.352]
F1 Score:  [0.89, 0.971, 0.939, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.743, 0.843, 0.971]
Recall Score:  [0.91, 0.977, 0.955, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.789, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2110
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9865
Averaged Test F1_score: 0.9253
Averaged Test Recal score: 0.9412
Std Test Accurancy: 0.0670
Std Test AUC: 0.0079
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.899
Epoch: 0|  Loss:  1.3455 |Global loss: 5.765| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.9276
Epoch: 1|  Loss:  1.364 |Global loss: 5.7465| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.9329
Epoch: 2|  Loss:  1.3555 |Global loss: 5.7359| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.92
Epoch: 3|  Loss:  1.3659 |Global loss: 5.7439| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9431
Epoch: 0|  Loss:  1.2295 |Global loss: 5.7732| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9349
Epoch: 1|  Loss:  1.215 |Global loss: 5.7669| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9443
Epoch: 2|  Loss:  1.2299 |Global loss: 5.7685| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9544
Epoch: 3|  Loss:  1.231 |Global loss: 5.761| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 0|  NKD Loss: 0.8796
Epoch: 0|  Loss:  1.0982 |Global loss: 5.7264| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.8786
Epoch: 1|  Loss:  1.0979 |Global loss: 5.7223| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.8962
Epoch: 2|  Loss:  1.117 |Global loss: 5.7145| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9026
Epoch: 3|  Loss:  1.1142 |Global loss: 5.7133| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8992
Epoch: 0|  Loss:  1.1299 |Global loss: 5.7293| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.8926
Epoch: 1|  Loss:  1.1231 |Global loss: 5.7339| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.895
Epoch: 2|  Loss:  1.1262 |Global loss: 5.7391| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9068
Epoch: 3|  Loss:  1.1403 |Global loss: 5.7283| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.8755
Epoch: 0|  Loss:  1.0744 |Global loss: 5.6977| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8763
Epoch: 1|  Loss:  1.0756 |Global loss: 5.6991| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 2|  NKD Loss: 0.8902
Epoch: 2|  Loss:  1.0892 |Global loss: 5.6855| Local H loss: 0.0259  | Global H loss: 0.0259
Epoch: 3|  NKD Loss: 0.8908
Epoch: 3|  Loss:  1.0898 |Global loss: 5.6851| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.9054
Epoch: 0|  Loss:  1.1194 |Global loss: 5.715| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 1|  NKD Loss: 0.8937
Epoch: 1|  Loss:  1.1091 |Global loss: 5.7238| Local H loss: 0.0368  | Global H loss: 0.0368
Epoch: 2|  NKD Loss: 0.8985
Epoch: 2|  Loss:  1.1176 |Global loss: 5.7209| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.8908
Epoch: 3|  Loss:  1.1045 |Global loss: 5.7267| Local H loss: 0.0366  | Global H loss: 0.0366
------------------------- time cost ------------------------- 3.312340259552002
Chosen Clients:  [11, 9, 3, 12, 13, 10]

-------------Round number: 458-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.883, 0.975, 0.95, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.758, 0.85, 0.975]
AUC in each clients:  [117.449, 119.401, 118.721, 118.948, 118.104, 118.048, 117.993, 118.967, 119.27, 119.098, 118.49, 119.151, 116.772, 116.058, 119.352]
F1 Score:  [0.89, 0.971, 0.947, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.743, 0.843, 0.971]
Recall Score:  [0.91, 0.977, 0.96, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.789, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2049
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9258
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0671
Std Test AUC: 0.0080
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8925
Epoch: 0|  Loss:  1.1005 |Global loss: 5.7139| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.8832
Epoch: 1|  Loss:  1.1027 |Global loss: 5.7292| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.8816
Epoch: 2|  Loss:  1.1024 |Global loss: 5.7262| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.903
Epoch: 3|  Loss:  1.1219 |Global loss: 5.7137| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8602
Epoch: 0|  Loss:  1.0587 |Global loss: 5.7095| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.8756
Epoch: 1|  Loss:  1.074 |Global loss: 5.6966| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.8695
Epoch: 2|  Loss:  1.0689 |Global loss: 5.7008| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.8759
Epoch: 3|  Loss:  1.0743 |Global loss: 5.6961| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 0|  NKD Loss: 0.8852
Epoch: 0|  Loss:  1.0984 |Global loss: 5.7062| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.8589
Epoch: 1|  Loss:  1.0889 |Global loss: 5.7234| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.8812
Epoch: 2|  Loss:  1.1085 |Global loss: 5.7095| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.8946
Epoch: 3|  Loss:  1.1215 |Global loss: 5.7003| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.9903
Epoch: 0|  Loss:  1.5591 |Global loss: 5.8008| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 1|  NKD Loss: 1.0042
Epoch: 1|  Loss:  1.587 |Global loss: 5.7945| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 2|  NKD Loss: 0.991
Epoch: 2|  Loss:  1.5766 |Global loss: 5.8026| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 3|  NKD Loss: 0.9774
Epoch: 3|  Loss:  1.5573 |Global loss: 5.8117| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 0|  NKD Loss: 0.9098
Epoch: 0|  Loss:  1.3392 |Global loss: 5.7572| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.9252
Epoch: 1|  Loss:  1.3669 |Global loss: 5.7419| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 2|  NKD Loss: 0.933
Epoch: 2|  Loss:  1.3747 |Global loss: 5.7384| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9272
Epoch: 3|  Loss:  1.3812 |Global loss: 5.7399| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.8938
Epoch: 0|  Loss:  1.1246 |Global loss: 5.7429| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9133
Epoch: 1|  Loss:  1.1427 |Global loss: 5.7196| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 2|  NKD Loss: 0.9195
Epoch: 2|  Loss:  1.1493 |Global loss: 5.7169| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.8918
Epoch: 3|  Loss:  1.1226 |Global loss: 5.7358| Local H loss: 0.0362  | Global H loss: 0.0362
------------------------- time cost ------------------------- 3.0463762283325195
Chosen Clients:  [6, 4, 5, 13, 1, 0]

-------------Round number: 459-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.883, 0.975, 0.95, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.449, 119.401, 118.721, 118.95, 118.104, 118.048, 117.993, 118.967, 119.27, 119.1, 118.481, 119.103, 116.723, 116.138, 119.352]
F1 Score:  [0.89, 0.971, 0.947, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.91, 0.977, 0.96, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2100
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9253
Averaged Test Recal score: 0.9411
Std Test Accurancy: 0.0686
Std Test AUC: 0.0079
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9315
Epoch: 0|  Loss:  1.2119 |Global loss: 5.7406| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9222
Epoch: 1|  Loss:  1.1971 |Global loss: 5.7403| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9244
Epoch: 2|  Loss:  1.203 |Global loss: 5.7439| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9227
Epoch: 3|  Loss:  1.1904 |Global loss: 5.745| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.9195
Epoch: 0|  Loss:  1.3377 |Global loss: 5.7016| Local H loss: 0.0225  | Global H loss: 0.0225
Epoch: 1|  NKD Loss: 0.9252
Epoch: 1|  Loss:  1.3508 |Global loss: 5.7039| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 2|  NKD Loss: 0.8929
Epoch: 2|  Loss:  1.3224 |Global loss: 5.7229| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 0.9064
Epoch: 3|  Loss:  1.3216 |Global loss: 5.7115| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 0|  NKD Loss: 0.962
Epoch: 0|  Loss:  1.2943 |Global loss: 5.7496| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9529
Epoch: 1|  Loss:  1.2736 |Global loss: 5.7684| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.2888 |Global loss: 5.76| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9593
Epoch: 3|  Loss:  1.2931 |Global loss: 5.749| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9308
Epoch: 0|  Loss:  1.3658 |Global loss: 5.7365| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 0.9325
Epoch: 1|  Loss:  1.3851 |Global loss: 5.7376| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 2|  NKD Loss: 0.9493
Epoch: 2|  Loss:  1.3938 |Global loss: 5.7279| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.9186
Epoch: 3|  Loss:  1.3676 |Global loss: 5.7452| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.1839 |Global loss: 5.7361| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9203
Epoch: 1|  Loss:  1.1711 |Global loss: 5.7411| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9216
Epoch: 2|  Loss:  1.1805 |Global loss: 5.7447| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9202
Epoch: 3|  Loss:  1.1722 |Global loss: 5.7421| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.929
Epoch: 0|  Loss:  1.2586 |Global loss: 5.7389| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9338
Epoch: 1|  Loss:  1.2646 |Global loss: 5.7337| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9365
Epoch: 2|  Loss:  1.2639 |Global loss: 5.7354| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9283
Epoch: 3|  Loss:  1.2524 |Global loss: 5.7383| Local H loss: 0.0248  | Global H loss: 0.0248
------------------------- time cost ------------------------- 3.0517027378082275
Chosen Clients:  [13, 1, 9, 0, 14, 4]

-------------Round number: 460-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.867, 0.975, 0.95, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.42, 119.423, 118.721, 118.95, 118.105, 118.055, 118.027, 118.967, 119.27, 119.1, 118.481, 119.103, 116.723, 116.187, 119.352]
F1 Score:  [0.876, 0.971, 0.947, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.899, 0.977, 0.96, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2100
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9244
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0696
Std Test AUC: 0.0079
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9337
Epoch: 0|  Loss:  1.3675 |Global loss: 5.7351| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.9349
Epoch: 1|  Loss:  1.3663 |Global loss: 5.7369| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.9053
Epoch: 2|  Loss:  1.3287 |Global loss: 5.7525| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.9202
Epoch: 3|  Loss:  1.3614 |Global loss: 5.7383| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.9248
Epoch: 0|  Loss:  1.1812 |Global loss: 5.7415| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9422
Epoch: 1|  Loss:  1.1879 |Global loss: 5.7284| Local H loss: 0.0277  | Global H loss: 0.0277
Epoch: 2|  NKD Loss: 0.9346
Epoch: 2|  Loss:  1.1702 |Global loss: 5.7362| Local H loss: 0.0278  | Global H loss: 0.0278
Epoch: 3|  NKD Loss: 0.9241
Epoch: 3|  Loss:  1.1779 |Global loss: 5.7319| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8904
Epoch: 0|  Loss:  1.0894 |Global loss: 5.6878| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8549
Epoch: 1|  Loss:  1.0478 |Global loss: 5.7105| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8916
Epoch: 2|  Loss:  1.0891 |Global loss: 5.6865| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.8907
Epoch: 3|  Loss:  1.0867 |Global loss: 5.6884| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 0|  NKD Loss: 0.9243
Epoch: 0|  Loss:  1.2523 |Global loss: 5.7339| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9369
Epoch: 1|  Loss:  1.2643 |Global loss: 5.7297| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.8991
Epoch: 2|  Loss:  1.2302 |Global loss: 5.7493| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.9227
Epoch: 3|  Loss:  1.2498 |Global loss: 5.7371| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9027
Epoch: 0|  Loss:  1.1206 |Global loss: 5.7178| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.1169 |Global loss: 5.7116| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.8939
Epoch: 2|  Loss:  1.1042 |Global loss: 5.7304| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9003
Epoch: 3|  Loss:  1.1189 |Global loss: 5.7241| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.89
Epoch: 0|  Loss:  1.3157 |Global loss: 5.728| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.331 |Global loss: 5.7123| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 2|  NKD Loss: 0.9201
Epoch: 2|  Loss:  1.3444 |Global loss: 5.7045| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 0.9287
Epoch: 3|  Loss:  1.3533 |Global loss: 5.6977| Local H loss: 0.0224  | Global H loss: 0.0224
------------------------- time cost ------------------------- 3.366701602935791
Chosen Clients:  [0, 8, 11, 3, 2, 14]

-------------Round number: 461-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.95, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.458, 119.393, 118.721, 118.95, 118.103, 118.055, 118.027, 118.967, 119.27, 119.098, 118.481, 119.103, 116.723, 116.123, 119.333]
F1 Score:  [0.883, 0.971, 0.947, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.96, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2077
Averaged Test Accurancy: 0.9333
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9249
Averaged Test Recal score: 0.9407
Std Test Accurancy: 0.0691
Std Test AUC: 0.0079
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9314
Epoch: 0|  Loss:  1.2637 |Global loss: 5.7379| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9388
Epoch: 1|  Loss:  1.2707 |Global loss: 5.7334| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9316
Epoch: 2|  Loss:  1.2625 |Global loss: 5.7383| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9453
Epoch: 3|  Loss:  1.274 |Global loss: 5.7242| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 0|  NKD Loss: 0.9029
Epoch: 0|  Loss:  1.1169 |Global loss: 5.7157| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.9024
Epoch: 1|  Loss:  1.1191 |Global loss: 5.7145| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.8897
Epoch: 2|  Loss:  1.1062 |Global loss: 5.7237| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 0.9074
Epoch: 3|  Loss:  1.1142 |Global loss: 5.7029| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 0|  NKD Loss: 0.8854
Epoch: 0|  Loss:  1.1054 |Global loss: 5.724| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.1302 |Global loss: 5.706| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.8991
Epoch: 2|  Loss:  1.1192 |Global loss: 5.7162| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.8978
Epoch: 3|  Loss:  1.1176 |Global loss: 5.7153| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8822
Epoch: 0|  Loss:  1.1105 |Global loss: 5.7096| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.8878
Epoch: 1|  Loss:  1.1106 |Global loss: 5.7017| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 2|  NKD Loss: 0.884
Epoch: 2|  Loss:  1.1115 |Global loss: 5.7095| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 3|  NKD Loss: 0.8714
Epoch: 3|  Loss:  1.0994 |Global loss: 5.717| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.9571
Epoch: 0|  Loss:  1.2394 |Global loss: 5.7598| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.9337
Epoch: 1|  Loss:  1.2059 |Global loss: 5.7707| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.953
Epoch: 2|  Loss:  1.236 |Global loss: 5.7629| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.9306
Epoch: 3|  Loss:  1.2131 |Global loss: 5.7732| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8847
Epoch: 0|  Loss:  1.1047 |Global loss: 5.7392| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9096
Epoch: 1|  Loss:  1.1296 |Global loss: 5.7166| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9031
Epoch: 2|  Loss:  1.1218 |Global loss: 5.7249| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9078
Epoch: 3|  Loss:  1.1271 |Global loss: 5.7171| Local H loss: 0.0271  | Global H loss: 0.0271
------------------------- time cost ------------------------- 2.9686107635498047
Chosen Clients:  [13, 11, 10, 6, 3, 4]

-------------Round number: 462-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.908, 0.975, 0.933, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.503, 119.393, 118.622, 118.948, 118.103, 118.055, 118.027, 118.967, 119.257, 119.098, 118.481, 119.149, 116.723, 116.123, 119.348]
F1 Score:  [0.909, 0.971, 0.932, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.927, 0.977, 0.949, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2088
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9256
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0676
Std Test AUC: 0.0079
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9111
Epoch: 0|  Loss:  1.3417 |Global loss: 5.7496| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.949
Epoch: 1|  Loss:  1.3832 |Global loss: 5.7306| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.9257
Epoch: 2|  Loss:  1.3665 |Global loss: 5.7385| Local H loss: 0.0328  | Global H loss: 0.0328
Epoch: 3|  NKD Loss: 0.9388
Epoch: 3|  Loss:  1.3756 |Global loss: 5.7279| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.9113
Epoch: 0|  Loss:  1.1279 |Global loss: 5.706| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9109
Epoch: 1|  Loss:  1.1298 |Global loss: 5.7059| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.8891
Epoch: 2|  Loss:  1.1018 |Global loss: 5.721| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.8955
Epoch: 3|  Loss:  1.1112 |Global loss: 5.7145| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9096
Epoch: 0|  Loss:  1.1412 |Global loss: 5.7275| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9018
Epoch: 1|  Loss:  1.1314 |Global loss: 5.7275| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 2|  NKD Loss: 0.9084
Epoch: 2|  Loss:  1.1392 |Global loss: 5.7267| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.8942
Epoch: 3|  Loss:  1.1178 |Global loss: 5.7348| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9349
Epoch: 0|  Loss:  1.2144 |Global loss: 5.7307| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9398
Epoch: 1|  Loss:  1.2174 |Global loss: 5.7311| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9389
Epoch: 2|  Loss:  1.2138 |Global loss: 5.7351| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9265
Epoch: 3|  Loss:  1.1942 |Global loss: 5.7318| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 0|  NKD Loss: 0.8876
Epoch: 0|  Loss:  1.1163 |Global loss: 5.7096| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 1|  NKD Loss: 0.9017
Epoch: 1|  Loss:  1.1298 |Global loss: 5.6908| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 2|  NKD Loss: 0.8825
Epoch: 2|  Loss:  1.1087 |Global loss: 5.7047| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 3|  NKD Loss: 0.9032
Epoch: 3|  Loss:  1.1288 |Global loss: 5.6874| Local H loss: 0.0385  | Global H loss: 0.0385
Epoch: 0|  NKD Loss: 0.9227
Epoch: 0|  Loss:  1.3486 |Global loss: 5.7018| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.3412 |Global loss: 5.7105| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 0.9082
Epoch: 2|  Loss:  1.3272 |Global loss: 5.7057| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 0.9082
Epoch: 3|  Loss:  1.3277 |Global loss: 5.7121| Local H loss: 0.0222  | Global H loss: 0.0222
------------------------- time cost ------------------------- 3.081263303756714
Chosen Clients:  [0, 1, 10, 11, 7, 9]

-------------Round number: 463-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.908, 0.975, 0.933, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.503, 119.393, 118.622, 118.948, 118.107, 118.055, 118.08, 118.967, 119.257, 119.098, 118.495, 119.189, 116.723, 116.17, 119.348]
F1 Score:  [0.909, 0.971, 0.932, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.927, 0.977, 0.949, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2172
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9256
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0676
Std Test AUC: 0.0078
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9387
Epoch: 0|  Loss:  1.2753 |Global loss: 5.7316| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9421
Epoch: 1|  Loss:  1.2603 |Global loss: 5.724| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 2|  NKD Loss: 0.9231
Epoch: 2|  Loss:  1.2493 |Global loss: 5.7394| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.924
Epoch: 3|  Loss:  1.2495 |Global loss: 5.7377| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9235
Epoch: 0|  Loss:  1.1766 |Global loss: 5.7342| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9168
Epoch: 1|  Loss:  1.1695 |Global loss: 5.7447| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9218
Epoch: 2|  Loss:  1.1759 |Global loss: 5.7373| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9269
Epoch: 3|  Loss:  1.1789 |Global loss: 5.7337| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.9039
Epoch: 0|  Loss:  1.1283 |Global loss: 5.7273| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.91
Epoch: 1|  Loss:  1.1395 |Global loss: 5.7236| Local H loss: 0.037  | Global H loss: 0.037
Epoch: 2|  NKD Loss: 0.9149
Epoch: 2|  Loss:  1.1431 |Global loss: 5.7185| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9163
Epoch: 3|  Loss:  1.1447 |Global loss: 5.718| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.8935
Epoch: 0|  Loss:  1.1021 |Global loss: 5.7055| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.8991
Epoch: 1|  Loss:  1.1185 |Global loss: 5.7102| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.8915
Epoch: 2|  Loss:  1.1113 |Global loss: 5.7138| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.9156
Epoch: 3|  Loss:  1.1224 |Global loss: 5.6983| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8906
Epoch: 0|  Loss:  1.106 |Global loss: 5.7273| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.8788
Epoch: 1|  Loss:  1.0873 |Global loss: 5.7323| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9079
Epoch: 2|  Loss:  1.1144 |Global loss: 5.7141| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 3|  NKD Loss: 0.8871
Epoch: 3|  Loss:  1.1026 |Global loss: 5.7257| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8836
Epoch: 0|  Loss:  1.0754 |Global loss: 5.6887| Local H loss: 0.0258  | Global H loss: 0.0258
Epoch: 1|  NKD Loss: 0.8856
Epoch: 1|  Loss:  1.083 |Global loss: 5.6912| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 2|  NKD Loss: 0.893
Epoch: 2|  Loss:  1.091 |Global loss: 5.6836| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 3|  NKD Loss: 0.8865
Epoch: 3|  Loss:  1.0844 |Global loss: 5.6871| Local H loss: 0.0257  | Global H loss: 0.0257
------------------------- time cost ------------------------- 2.9219560623168945
Chosen Clients:  [4, 10, 2, 13, 14, 8]

-------------Round number: 464-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.867, 0.975, 0.933, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.388, 119.389, 118.622, 118.948, 118.107, 118.055, 118.08, 118.97, 119.257, 119.098, 118.491, 119.17, 116.723, 116.17, 119.348]
F1 Score:  [0.877, 0.971, 0.932, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.898, 0.977, 0.949, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2105
Averaged Test Accurancy: 0.9317
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9235
Averaged Test Recal score: 0.9395
Std Test Accurancy: 0.0694
Std Test AUC: 0.0079
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9222
Epoch: 0|  Loss:  1.3343 |Global loss: 5.7017| Local H loss: 0.0224  | Global H loss: 0.0224
Epoch: 1|  NKD Loss: 0.9184
Epoch: 1|  Loss:  1.3399 |Global loss: 5.7078| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 0.9205
Epoch: 2|  Loss:  1.3459 |Global loss: 5.7025| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 3|  NKD Loss: 0.8993
Epoch: 3|  Loss:  1.3121 |Global loss: 5.714| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 0.9087
Epoch: 0|  Loss:  1.1337 |Global loss: 5.7223| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.8903
Epoch: 1|  Loss:  1.123 |Global loss: 5.7397| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.8952
Epoch: 2|  Loss:  1.1244 |Global loss: 5.7288| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9079
Epoch: 3|  Loss:  1.1372 |Global loss: 5.7205| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9348
Epoch: 0|  Loss:  1.2133 |Global loss: 5.7664| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9414
Epoch: 1|  Loss:  1.2227 |Global loss: 5.7658| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9605
Epoch: 2|  Loss:  1.2409 |Global loss: 5.7548| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 3|  NKD Loss: 0.9496
Epoch: 3|  Loss:  1.2285 |Global loss: 5.7578| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9336
Epoch: 0|  Loss:  1.3792 |Global loss: 5.7353| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 1|  NKD Loss: 0.9468
Epoch: 1|  Loss:  1.3814 |Global loss: 5.7246| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 2|  NKD Loss: 0.94
Epoch: 2|  Loss:  1.3631 |Global loss: 5.727| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.9359
Epoch: 3|  Loss:  1.3637 |Global loss: 5.735| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9025
Epoch: 0|  Loss:  1.1129 |Global loss: 5.7224| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9088
Epoch: 1|  Loss:  1.1267 |Global loss: 5.7129| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9083
Epoch: 2|  Loss:  1.1255 |Global loss: 5.717| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.881
Epoch: 3|  Loss:  1.0976 |Global loss: 5.739| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.8954
Epoch: 0|  Loss:  1.1113 |Global loss: 5.7183| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 1|  NKD Loss: 0.8962
Epoch: 1|  Loss:  1.1118 |Global loss: 5.7215| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 2|  NKD Loss: 0.882
Epoch: 2|  Loss:  1.098 |Global loss: 5.7248| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.8941
Epoch: 3|  Loss:  1.096 |Global loss: 5.7172| Local H loss: 0.0338  | Global H loss: 0.0338
------------------------- time cost ------------------------- 3.673737049102783
Chosen Clients:  [0, 2, 13, 6, 14, 12]

-------------Round number: 465-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.867, 0.975, 0.942, 0.983, 0.833, 0.967, 0.967, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.388, 119.389, 118.734, 118.948, 118.109, 118.055, 118.08, 118.97, 119.235, 119.098, 118.494, 119.17, 116.723, 116.127, 119.353]
F1 Score:  [0.877, 0.971, 0.939, 0.982, 0.761, 0.964, 0.964, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.898, 0.977, 0.955, 0.986, 0.81, 0.971, 0.971, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2108
Averaged Test Accurancy: 0.9322
Averaged Test AUC: 0.9866
Averaged Test F1_score: 0.9239
Averaged Test Recal score: 0.9399
Std Test Accurancy: 0.0694
Std Test AUC: 0.0080
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9232
Epoch: 0|  Loss:  1.2547 |Global loss: 5.7391| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9355
Epoch: 1|  Loss:  1.2634 |Global loss: 5.7259| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9285
Epoch: 2|  Loss:  1.2575 |Global loss: 5.7313| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.924
Epoch: 3|  Loss:  1.2549 |Global loss: 5.7403| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.9414
Epoch: 0|  Loss:  1.2215 |Global loss: 5.7613| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.948
Epoch: 1|  Loss:  1.2291 |Global loss: 5.765| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9223
Epoch: 2|  Loss:  1.1914 |Global loss: 5.7789| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9402
Epoch: 3|  Loss:  1.2147 |Global loss: 5.7593| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.9387
Epoch: 0|  Loss:  1.3779 |Global loss: 5.73| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.9319
Epoch: 1|  Loss:  1.3606 |Global loss: 5.7306| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.9374
Epoch: 2|  Loss:  1.3531 |Global loss: 5.7245| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.917
Epoch: 3|  Loss:  1.3605 |Global loss: 5.7373| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.9184
Epoch: 0|  Loss:  1.1946 |Global loss: 5.7426| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9137
Epoch: 1|  Loss:  1.1897 |Global loss: 5.7486| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9294
Epoch: 2|  Loss:  1.2004 |Global loss: 5.7345| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 3|  NKD Loss: 0.9323
Epoch: 3|  Loss:  1.2092 |Global loss: 5.7428| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 0|  NKD Loss: 0.9165
Epoch: 0|  Loss:  1.1358 |Global loss: 5.7138| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9013
Epoch: 1|  Loss:  1.1188 |Global loss: 5.717| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9068
Epoch: 2|  Loss:  1.1204 |Global loss: 5.713| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.9005
Epoch: 3|  Loss:  1.1107 |Global loss: 5.7244| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.9855
Epoch: 0|  Loss:  1.5579 |Global loss: 5.8052| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 1|  NKD Loss: 0.9467
Epoch: 1|  Loss:  1.5176 |Global loss: 5.8321| Local H loss: 0.0452  | Global H loss: 0.0452
Epoch: 2|  NKD Loss: 0.9916
Epoch: 2|  Loss:  1.5668 |Global loss: 5.7924| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 3|  NKD Loss: 0.9751
Epoch: 3|  Loss:  1.5452 |Global loss: 5.8073| Local H loss: 0.0465  | Global H loss: 0.0465
------------------------- time cost ------------------------- 3.1245992183685303
Chosen Clients:  [4, 1, 12, 7, 8, 13]

-------------Round number: 466-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.497, 119.389, 118.607, 118.948, 118.109, 118.055, 118.167, 118.97, 119.235, 119.098, 118.494, 119.17, 116.707, 116.24, 119.364]
F1 Score:  [0.896, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2080
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9867
Averaged Test F1_score: 0.9244
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0715
Std Test AUC: 0.0077
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9012
Epoch: 0|  Loss:  1.3237 |Global loss: 5.7153| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.8921
Epoch: 1|  Loss:  1.3315 |Global loss: 5.7209| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 0.9081
Epoch: 2|  Loss:  1.3351 |Global loss: 5.7134| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9072
Epoch: 3|  Loss:  1.3244 |Global loss: 5.7112| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 0|  NKD Loss: 0.9079
Epoch: 0|  Loss:  1.161 |Global loss: 5.7467| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9185
Epoch: 1|  Loss:  1.1666 |Global loss: 5.738| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9054
Epoch: 2|  Loss:  1.1526 |Global loss: 5.7502| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9173
Epoch: 3|  Loss:  1.1667 |Global loss: 5.7388| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 1.0049
Epoch: 0|  Loss:  1.569 |Global loss: 5.7931| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 1|  NKD Loss: 0.9839
Epoch: 1|  Loss:  1.5569 |Global loss: 5.8051| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 2|  NKD Loss: 0.9675
Epoch: 2|  Loss:  1.5313 |Global loss: 5.8131| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 3|  NKD Loss: 1.0029
Epoch: 3|  Loss:  1.5636 |Global loss: 5.7915| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 0|  NKD Loss: 0.8943
Epoch: 0|  Loss:  1.1103 |Global loss: 5.726| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.8995
Epoch: 1|  Loss:  1.1163 |Global loss: 5.7165| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.8868
Epoch: 2|  Loss:  1.1021 |Global loss: 5.7293| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.8998
Epoch: 3|  Loss:  1.1177 |Global loss: 5.7243| Local H loss: 0.0369  | Global H loss: 0.0369
Epoch: 0|  NKD Loss: 0.9
Epoch: 0|  Loss:  1.1174 |Global loss: 5.7171| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 1|  NKD Loss: 0.8758
Epoch: 1|  Loss:  1.0913 |Global loss: 5.7251| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 2|  NKD Loss: 0.9001
Epoch: 2|  Loss:  1.1147 |Global loss: 5.7109| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8891
Epoch: 3|  Loss:  1.1043 |Global loss: 5.71| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 0|  NKD Loss: 0.9119
Epoch: 0|  Loss:  1.3278 |Global loss: 5.7493| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.9293
Epoch: 1|  Loss:  1.377 |Global loss: 5.7311| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.94
Epoch: 2|  Loss:  1.3599 |Global loss: 5.7313| Local H loss: 0.0329  | Global H loss: 0.0329
Epoch: 3|  NKD Loss: 0.9402
Epoch: 3|  Loss:  1.363 |Global loss: 5.7285| Local H loss: 0.0333  | Global H loss: 0.0333
------------------------- time cost ------------------------- 3.0925521850585938
Chosen Clients:  [14, 12, 8, 6, 10, 4]

-------------Round number: 467-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.497, 119.413, 118.607, 118.948, 118.105, 118.055, 118.167, 118.97, 119.257, 119.098, 118.494, 119.17, 116.689, 116.172, 119.364]
F1 Score:  [0.896, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.699, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.749, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2040
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9867
Averaged Test F1_score: 0.9229
Averaged Test Recal score: 0.9389
Std Test Accurancy: 0.0762
Std Test AUC: 0.0079
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.8877
Epoch: 0|  Loss:  1.1054 |Global loss: 5.7286| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.8943
Epoch: 1|  Loss:  1.1104 |Global loss: 5.724| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.8905
Epoch: 2|  Loss:  1.1047 |Global loss: 5.7196| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9003
Epoch: 3|  Loss:  1.117 |Global loss: 5.7213| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9782
Epoch: 0|  Loss:  1.5359 |Global loss: 5.8067| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 1|  NKD Loss: 0.994
Epoch: 1|  Loss:  1.5605 |Global loss: 5.7879| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 2|  NKD Loss: 0.9756
Epoch: 2|  Loss:  1.5332 |Global loss: 5.8089| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 3|  NKD Loss: 0.9825
Epoch: 3|  Loss:  1.5419 |Global loss: 5.8052| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 0|  NKD Loss: 0.9008
Epoch: 0|  Loss:  1.1121 |Global loss: 5.715| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 1|  NKD Loss: 0.9005
Epoch: 1|  Loss:  1.1147 |Global loss: 5.7159| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 2|  NKD Loss: 0.9077
Epoch: 2|  Loss:  1.1211 |Global loss: 5.7114| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 3|  NKD Loss: 0.8876
Epoch: 3|  Loss:  1.1022 |Global loss: 5.7235| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 0.9299
Epoch: 0|  Loss:  1.1992 |Global loss: 5.7366| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9074
Epoch: 1|  Loss:  1.1767 |Global loss: 5.748| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9195
Epoch: 2|  Loss:  1.193 |Global loss: 5.7359| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9227
Epoch: 3|  Loss:  1.1848 |Global loss: 5.7417| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.9013
Epoch: 0|  Loss:  1.1317 |Global loss: 5.7292| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8943
Epoch: 1|  Loss:  1.117 |Global loss: 5.7306| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.8942
Epoch: 2|  Loss:  1.1242 |Global loss: 5.7306| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.8876
Epoch: 3|  Loss:  1.1178 |Global loss: 5.7394| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9078
Epoch: 0|  Loss:  1.325 |Global loss: 5.7101| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.8859
Epoch: 1|  Loss:  1.2946 |Global loss: 5.7169| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 0.9185
Epoch: 2|  Loss:  1.3395 |Global loss: 5.698| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 3|  NKD Loss: 0.9268
Epoch: 3|  Loss:  1.3445 |Global loss: 5.6947| Local H loss: 0.0224  | Global H loss: 0.0224
------------------------- time cost ------------------------- 3.1366078853607178
Chosen Clients:  [3, 13, 12, 14, 2, 5]

-------------Round number: 468-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.497, 119.413, 118.607, 118.948, 118.102, 118.055, 118.195, 118.97, 119.248, 119.098, 118.498, 119.17, 116.758, 116.172, 119.355]
F1 Score:  [0.896, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2059
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9867
Averaged Test F1_score: 0.9244
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0715
Std Test AUC: 0.0078
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8871
Epoch: 0|  Loss:  1.1015 |Global loss: 5.7051| Local H loss: 0.0386  | Global H loss: 0.0386
Epoch: 1|  NKD Loss: 0.8608
Epoch: 1|  Loss:  1.0889 |Global loss: 5.7204| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.8813
Epoch: 2|  Loss:  1.0958 |Global loss: 5.7047| Local H loss: 0.0383  | Global H loss: 0.0383
Epoch: 3|  NKD Loss: 0.8902
Epoch: 3|  Loss:  1.116 |Global loss: 5.6996| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 0|  NKD Loss: 0.878
Epoch: 0|  Loss:  1.3048 |Global loss: 5.7571| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 0.8895
Epoch: 1|  Loss:  1.3323 |Global loss: 5.758| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.9065
Epoch: 2|  Loss:  1.3343 |Global loss: 5.7525| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9288
Epoch: 3|  Loss:  1.3672 |Global loss: 5.7399| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 0|  NKD Loss: 0.9843
Epoch: 0|  Loss:  1.5427 |Global loss: 5.7979| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 1|  NKD Loss: 0.968
Epoch: 1|  Loss:  1.5301 |Global loss: 5.8074| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 2|  NKD Loss: 0.9887
Epoch: 2|  Loss:  1.5236 |Global loss: 5.7984| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.9947
Epoch: 3|  Loss:  1.5483 |Global loss: 5.7884| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 0|  NKD Loss: 0.8953
Epoch: 0|  Loss:  1.1123 |Global loss: 5.7228| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9088
Epoch: 1|  Loss:  1.1259 |Global loss: 5.7162| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.8943
Epoch: 2|  Loss:  1.109 |Global loss: 5.7303| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.913
Epoch: 3|  Loss:  1.1317 |Global loss: 5.7157| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9532
Epoch: 0|  Loss:  1.2222 |Global loss: 5.7486| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9205
Epoch: 1|  Loss:  1.1972 |Global loss: 5.767| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9527
Epoch: 2|  Loss:  1.2335 |Global loss: 5.7579| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.9286
Epoch: 3|  Loss:  1.2102 |Global loss: 5.7752| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9582
Epoch: 0|  Loss:  1.294 |Global loss: 5.7476| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9507
Epoch: 1|  Loss:  1.2763 |Global loss: 5.7597| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.966
Epoch: 2|  Loss:  1.2995 |Global loss: 5.7533| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9558
Epoch: 3|  Loss:  1.2902 |Global loss: 5.7572| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 2.83693265914917
Chosen Clients:  [12, 6, 10, 1, 0, 9]

-------------Round number: 469-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.742, 0.85, 0.975]
AUC in each clients:  [117.497, 119.413, 118.808, 118.951, 118.102, 118.093, 118.195, 118.97, 119.248, 119.098, 118.498, 119.17, 116.762, 116.333, 119.361]
F1 Score:  [0.896, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.729, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.775, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2001
Averaged Test Accurancy: 0.9350
Averaged Test AUC: 0.9869
Averaged Test F1_score: 0.9265
Averaged Test Recal score: 0.9418
Std Test Accurancy: 0.0702
Std Test AUC: 0.0076
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9944
Epoch: 0|  Loss:  1.5562 |Global loss: 5.789| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 1|  NKD Loss: 0.983
Epoch: 1|  Loss:  1.5427 |Global loss: 5.8027| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 2|  NKD Loss: 0.9621
Epoch: 2|  Loss:  1.5331 |Global loss: 5.8215| Local H loss: 0.0461  | Global H loss: 0.0461
Epoch: 3|  NKD Loss: 0.9917
Epoch: 3|  Loss:  1.5473 |Global loss: 5.7948| Local H loss: 0.047  | Global H loss: 0.047
Epoch: 0|  NKD Loss: 0.9218
Epoch: 0|  Loss:  1.1977 |Global loss: 5.7376| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9222
Epoch: 1|  Loss:  1.1971 |Global loss: 5.7401| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.937
Epoch: 2|  Loss:  1.2103 |Global loss: 5.7309| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9181
Epoch: 3|  Loss:  1.1704 |Global loss: 5.7374| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 0|  NKD Loss: 0.8997
Epoch: 0|  Loss:  1.1292 |Global loss: 5.7268| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9071
Epoch: 1|  Loss:  1.1361 |Global loss: 5.726| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.8995
Epoch: 2|  Loss:  1.1284 |Global loss: 5.7265| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9113
Epoch: 3|  Loss:  1.1341 |Global loss: 5.7175| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 0|  NKD Loss: 0.9207
Epoch: 0|  Loss:  1.1706 |Global loss: 5.739| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.932
Epoch: 1|  Loss:  1.18 |Global loss: 5.7274| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.932
Epoch: 2|  Loss:  1.1837 |Global loss: 5.7283| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 3|  NKD Loss: 0.9308
Epoch: 3|  Loss:  1.1793 |Global loss: 5.7261| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9274
Epoch: 0|  Loss:  1.2524 |Global loss: 5.7379| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9112
Epoch: 1|  Loss:  1.2345 |Global loss: 5.7453| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 0.936
Epoch: 2|  Loss:  1.265 |Global loss: 5.7274| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9363
Epoch: 3|  Loss:  1.2666 |Global loss: 5.7284| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8889
Epoch: 0|  Loss:  1.0868 |Global loss: 5.6843| Local H loss: 0.0257  | Global H loss: 0.0257
Epoch: 1|  NKD Loss: 0.8758
Epoch: 1|  Loss:  1.0737 |Global loss: 5.6933| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8759
Epoch: 2|  Loss:  1.073 |Global loss: 5.6905| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.8846
Epoch: 3|  Loss:  1.0821 |Global loss: 5.6896| Local H loss: 0.0256  | Global H loss: 0.0256
------------------------- time cost ------------------------- 3.179939031600952
Chosen Clients:  [14, 8, 11, 6, 12, 2]

-------------Round number: 470-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.524, 119.489, 118.808, 118.951, 118.102, 118.093, 118.191, 118.97, 119.248, 119.097, 118.501, 119.17, 116.876, 116.333, 119.361]
F1 Score:  [0.896, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2054
Averaged Test Accurancy: 0.9356
Averaged Test AUC: 0.9871
Averaged Test F1_score: 0.9269
Averaged Test Recal score: 0.9423
Std Test Accurancy: 0.0687
Std Test AUC: 0.0075
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8912
Epoch: 0|  Loss:  1.0988 |Global loss: 5.7224| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9132
Epoch: 1|  Loss:  1.1283 |Global loss: 5.7101| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.8851
Epoch: 2|  Loss:  1.1018 |Global loss: 5.7316| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.8787
Epoch: 3|  Loss:  1.094 |Global loss: 5.739| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9057
Epoch: 0|  Loss:  1.1191 |Global loss: 5.7103| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 1|  NKD Loss: 0.9127
Epoch: 1|  Loss:  1.1259 |Global loss: 5.7081| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.8989
Epoch: 2|  Loss:  1.1129 |Global loss: 5.7154| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.9059
Epoch: 3|  Loss:  1.1194 |Global loss: 5.7066| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.8898
Epoch: 0|  Loss:  1.1078 |Global loss: 5.7198| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.1205 |Global loss: 5.7103| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9031
Epoch: 2|  Loss:  1.123 |Global loss: 5.7108| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.8954
Epoch: 3|  Loss:  1.1121 |Global loss: 5.714| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9154
Epoch: 0|  Loss:  1.191 |Global loss: 5.747| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9139
Epoch: 1|  Loss:  1.1864 |Global loss: 5.7449| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9275
Epoch: 2|  Loss:  1.2017 |Global loss: 5.7376| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9009
Epoch: 3|  Loss:  1.161 |Global loss: 5.7566| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.997
Epoch: 0|  Loss:  1.5512 |Global loss: 5.797| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 1|  NKD Loss: 0.9731
Epoch: 1|  Loss:  1.5275 |Global loss: 5.8055| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 2|  NKD Loss: 0.9749
Epoch: 2|  Loss:  1.5398 |Global loss: 5.8088| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 3|  NKD Loss: 0.9922
Epoch: 3|  Loss:  1.5592 |Global loss: 5.7947| Local H loss: 0.0472  | Global H loss: 0.0472
Epoch: 0|  NKD Loss: 0.9458
Epoch: 0|  Loss:  1.2257 |Global loss: 5.762| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.9429
Epoch: 1|  Loss:  1.2164 |Global loss: 5.7631| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9288
Epoch: 2|  Loss:  1.2075 |Global loss: 5.7749| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9178
Epoch: 3|  Loss:  1.1871 |Global loss: 5.7791| Local H loss: 0.036  | Global H loss: 0.036
------------------------- time cost ------------------------- 3.0131497383117676
Chosen Clients:  [5, 3, 10, 7, 9, 0]

-------------Round number: 471-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [117.524, 119.489, 118.802, 118.951, 118.102, 118.093, 118.227, 118.97, 119.255, 119.097, 118.501, 119.161, 116.758, 116.333, 119.357]
F1 Score:  [0.896, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2039
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9870
Averaged Test F1_score: 0.9241
Averaged Test Recal score: 0.9401
Std Test Accurancy: 0.0748
Std Test AUC: 0.0076
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9659
Epoch: 0|  Loss:  1.2995 |Global loss: 5.7557| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 1|  NKD Loss: 0.9481
Epoch: 1|  Loss:  1.2658 |Global loss: 5.7638| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.948
Epoch: 2|  Loss:  1.2777 |Global loss: 5.7631| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9449
Epoch: 3|  Loss:  1.2651 |Global loss: 5.7631| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8916
Epoch: 0|  Loss:  1.1184 |Global loss: 5.708| Local H loss: 0.0384  | Global H loss: 0.0384
Epoch: 1|  NKD Loss: 0.8856
Epoch: 1|  Loss:  1.1127 |Global loss: 5.7009| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.8801
Epoch: 2|  Loss:  1.1052 |Global loss: 5.7095| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.8731
Epoch: 3|  Loss:  1.0974 |Global loss: 5.7089| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.9051
Epoch: 0|  Loss:  1.1341 |Global loss: 5.7248| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.9051
Epoch: 1|  Loss:  1.1334 |Global loss: 5.7234| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.8961
Epoch: 2|  Loss:  1.1189 |Global loss: 5.7278| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.8972
Epoch: 3|  Loss:  1.123 |Global loss: 5.7298| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8945
Epoch: 0|  Loss:  1.0996 |Global loss: 5.7192| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.879
Epoch: 1|  Loss:  1.0929 |Global loss: 5.7348| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.8915
Epoch: 2|  Loss:  1.1045 |Global loss: 5.7278| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.8909
Epoch: 3|  Loss:  1.1071 |Global loss: 5.7259| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.8944
Epoch: 0|  Loss:  1.0915 |Global loss: 5.6837| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 1|  NKD Loss: 0.875
Epoch: 1|  Loss:  1.073 |Global loss: 5.6989| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.8753
Epoch: 2|  Loss:  1.0727 |Global loss: 5.6953| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.8826
Epoch: 3|  Loss:  1.0744 |Global loss: 5.6929| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 0|  NKD Loss: 0.9374
Epoch: 0|  Loss:  1.2556 |Global loss: 5.7239| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9064
Epoch: 1|  Loss:  1.244 |Global loss: 5.7514| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.934
Epoch: 2|  Loss:  1.2633 |Global loss: 5.7329| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9357
Epoch: 3|  Loss:  1.2612 |Global loss: 5.7342| Local H loss: 0.0247  | Global H loss: 0.0247
------------------------- time cost ------------------------- 3.4614217281341553
Chosen Clients:  [6, 13, 1, 8, 5, 4]

-------------Round number: 472-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [117.474, 119.489, 118.802, 118.951, 118.102, 118.131, 118.227, 118.967, 119.255, 119.098, 118.502, 119.161, 116.758, 116.333, 119.357]
F1 Score:  [0.883, 0.971, 0.947, 0.982, 0.761, 0.963, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.843, 0.971]
Recall Score:  [0.906, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2052
Averaged Test Accurancy: 0.9317
Averaged Test AUC: 0.9870
Averaged Test F1_score: 0.9232
Averaged Test Recal score: 0.9394
Std Test Accurancy: 0.0755
Std Test AUC: 0.0077
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.927
Epoch: 0|  Loss:  1.1859 |Global loss: 5.7386| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.8948
Epoch: 1|  Loss:  1.1585 |Global loss: 5.7478| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.8853
Epoch: 2|  Loss:  1.1571 |Global loss: 5.7605| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 3|  NKD Loss: 0.9013
Epoch: 3|  Loss:  1.1717 |Global loss: 5.743| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9172
Epoch: 0|  Loss:  1.3525 |Global loss: 5.7483| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.922
Epoch: 1|  Loss:  1.3492 |Global loss: 5.7351| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.9187
Epoch: 2|  Loss:  1.3503 |Global loss: 5.742| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 3|  NKD Loss: 0.9328
Epoch: 3|  Loss:  1.3551 |Global loss: 5.7349| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 0|  NKD Loss: 0.897
Epoch: 0|  Loss:  1.1356 |Global loss: 5.7476| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9083
Epoch: 1|  Loss:  1.1533 |Global loss: 5.738| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9039
Epoch: 2|  Loss:  1.1539 |Global loss: 5.7456| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.8949
Epoch: 3|  Loss:  1.1431 |Global loss: 5.7526| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.8986
Epoch: 0|  Loss:  1.1108 |Global loss: 5.7127| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 1|  NKD Loss: 0.905
Epoch: 1|  Loss:  1.1156 |Global loss: 5.7073| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.9048
Epoch: 2|  Loss:  1.1188 |Global loss: 5.7057| Local H loss: 0.0338  | Global H loss: 0.0338
Epoch: 3|  NKD Loss: 0.8921
Epoch: 3|  Loss:  1.1049 |Global loss: 5.7192| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 0|  NKD Loss: 0.9504
Epoch: 0|  Loss:  1.2739 |Global loss: 5.762| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 1|  NKD Loss: 0.9615
Epoch: 1|  Loss:  1.2907 |Global loss: 5.7526| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9549
Epoch: 2|  Loss:  1.2834 |Global loss: 5.7579| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9621
Epoch: 3|  Loss:  1.2963 |Global loss: 5.7501| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.9019
Epoch: 0|  Loss:  1.2967 |Global loss: 5.7095| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 1|  NKD Loss: 0.8964
Epoch: 1|  Loss:  1.3241 |Global loss: 5.718| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.9107
Epoch: 2|  Loss:  1.3305 |Global loss: 5.7067| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9084
Epoch: 3|  Loss:  1.3379 |Global loss: 5.7145| Local H loss: 0.0221  | Global H loss: 0.0221
------------------------- time cost ------------------------- 3.268174409866333
Chosen Clients:  [12, 8, 13, 9, 14, 11]

-------------Round number: 473-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.717, 0.85, 0.975]
AUC in each clients:  [117.474, 119.517, 118.802, 118.951, 118.105, 118.111, 118.264, 118.967, 119.252, 119.098, 118.502, 119.161, 116.758, 116.311, 119.357]
F1 Score:  [0.883, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.702, 0.843, 0.971]
Recall Score:  [0.906, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.755, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2001
Averaged Test Accurancy: 0.9317
Averaged Test AUC: 0.9870
Averaged Test F1_score: 0.9233
Averaged Test Recal score: 0.9394
Std Test Accurancy: 0.0755
Std Test AUC: 0.0077
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9945
Epoch: 0|  Loss:  1.5341 |Global loss: 5.7957| Local H loss: 0.0475  | Global H loss: 0.0475
Epoch: 1|  NKD Loss: 0.9996
Epoch: 1|  Loss:  1.5429 |Global loss: 5.7858| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 2|  NKD Loss: 0.9871
Epoch: 2|  Loss:  1.5462 |Global loss: 5.7952| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 3|  NKD Loss: 0.9894
Epoch: 3|  Loss:  1.5423 |Global loss: 5.7926| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 0|  NKD Loss: 0.8605
Epoch: 0|  Loss:  1.0753 |Global loss: 5.7333| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 1|  NKD Loss: 0.9134
Epoch: 1|  Loss:  1.1265 |Global loss: 5.7057| Local H loss: 0.0339  | Global H loss: 0.0339
Epoch: 2|  NKD Loss: 0.9055
Epoch: 2|  Loss:  1.1198 |Global loss: 5.7016| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.8952
Epoch: 3|  Loss:  1.1078 |Global loss: 5.7109| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 0|  NKD Loss: 0.9298
Epoch: 0|  Loss:  1.3655 |Global loss: 5.7347| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.9305
Epoch: 1|  Loss:  1.3677 |Global loss: 5.7302| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9242
Epoch: 2|  Loss:  1.3521 |Global loss: 5.7356| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.9313
Epoch: 3|  Loss:  1.3531 |Global loss: 5.7282| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 0|  NKD Loss: 0.8553
Epoch: 0|  Loss:  1.0521 |Global loss: 5.7111| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8765
Epoch: 1|  Loss:  1.0736 |Global loss: 5.6935| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.864
Epoch: 2|  Loss:  1.0608 |Global loss: 5.7055| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 3|  NKD Loss: 0.8702
Epoch: 3|  Loss:  1.0675 |Global loss: 5.6932| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.886
Epoch: 0|  Loss:  1.1024 |Global loss: 5.7266| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.8989
Epoch: 1|  Loss:  1.1062 |Global loss: 5.7221| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.9128
Epoch: 2|  Loss:  1.1182 |Global loss: 5.7102| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9111
Epoch: 3|  Loss:  1.1185 |Global loss: 5.7126| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.8966
Epoch: 0|  Loss:  1.1143 |Global loss: 5.7143| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.9032
Epoch: 1|  Loss:  1.1232 |Global loss: 5.7118| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.8933
Epoch: 2|  Loss:  1.0906 |Global loss: 5.7136| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.8888
Epoch: 3|  Loss:  1.1086 |Global loss: 5.7171| Local H loss: 0.0246  | Global H loss: 0.0246
------------------------- time cost ------------------------- 3.3351542949676514
Chosen Clients:  [12, 11, 5, 3, 0, 8]

-------------Round number: 474-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.474, 119.517, 118.802, 118.951, 118.105, 118.111, 118.264, 118.967, 119.259, 119.098, 118.502, 119.207, 117.012, 116.333, 119.356]
F1 Score:  [0.883, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.906, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2018
Averaged Test Accurancy: 0.9356
Averaged Test AUC: 0.9872
Averaged Test F1_score: 0.9267
Averaged Test Recal score: 0.9426
Std Test Accurancy: 0.0651
Std Test AUC: 0.0075
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9882
Epoch: 0|  Loss:  1.5425 |Global loss: 5.7934| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 1|  NKD Loss: 0.9728
Epoch: 1|  Loss:  1.5258 |Global loss: 5.8084| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 2|  NKD Loss: 0.9903
Epoch: 2|  Loss:  1.5477 |Global loss: 5.7977| Local H loss: 0.047  | Global H loss: 0.047
Epoch: 3|  NKD Loss: 0.9633
Epoch: 3|  Loss:  1.5132 |Global loss: 5.8086| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 0|  NKD Loss: 0.9168
Epoch: 0|  Loss:  1.1345 |Global loss: 5.6993| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.8916
Epoch: 1|  Loss:  1.1066 |Global loss: 5.721| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9034
Epoch: 2|  Loss:  1.1205 |Global loss: 5.7102| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.8888
Epoch: 3|  Loss:  1.1073 |Global loss: 5.7176| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 0.9578
Epoch: 0|  Loss:  1.2887 |Global loss: 5.7576| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9563
Epoch: 1|  Loss:  1.2884 |Global loss: 5.7538| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 2|  NKD Loss: 0.936
Epoch: 2|  Loss:  1.2617 |Global loss: 5.7741| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9691
Epoch: 3|  Loss:  1.3003 |Global loss: 5.7536| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 0|  NKD Loss: 0.886
Epoch: 0|  Loss:  1.1123 |Global loss: 5.7004| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 1|  NKD Loss: 0.8934
Epoch: 1|  Loss:  1.1163 |Global loss: 5.6934| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.888
Epoch: 2|  Loss:  1.1122 |Global loss: 5.7031| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 3|  NKD Loss: 0.876
Epoch: 3|  Loss:  1.099 |Global loss: 5.7142| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 0|  NKD Loss: 0.9286
Epoch: 0|  Loss:  1.2587 |Global loss: 5.7345| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9343
Epoch: 1|  Loss:  1.2627 |Global loss: 5.7309| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 2|  NKD Loss: 0.9201
Epoch: 2|  Loss:  1.245 |Global loss: 5.7357| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9375
Epoch: 3|  Loss:  1.2664 |Global loss: 5.7339| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.881
Epoch: 0|  Loss:  1.0916 |Global loss: 5.7169| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.8862
Epoch: 1|  Loss:  1.097 |Global loss: 5.724| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.8986
Epoch: 2|  Loss:  1.1121 |Global loss: 5.7088| Local H loss: 0.0337  | Global H loss: 0.0337
Epoch: 3|  NKD Loss: 0.9057
Epoch: 3|  Loss:  1.1173 |Global loss: 5.7065| Local H loss: 0.0334  | Global H loss: 0.0334
------------------------- time cost ------------------------- 3.238187074661255
Chosen Clients:  [14, 11, 0, 12, 1, 6]

-------------Round number: 475-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [117.524, 119.517, 118.802, 118.951, 118.105, 118.089, 118.264, 118.967, 119.255, 119.098, 118.502, 119.205, 116.878, 116.333, 119.356]
F1 Score:  [0.896, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.718, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1984
Averaged Test Accurancy: 0.9333
Averaged Test AUC: 0.9871
Averaged Test F1_score: 0.9252
Averaged Test Recal score: 0.9406
Std Test Accurancy: 0.0732
Std Test AUC: 0.0076
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9059
Epoch: 0|  Loss:  1.1213 |Global loss: 5.7105| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.8991
Epoch: 1|  Loss:  1.1047 |Global loss: 5.722| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9056
Epoch: 2|  Loss:  1.1218 |Global loss: 5.7161| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9123
Epoch: 3|  Loss:  1.1281 |Global loss: 5.7119| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8944
Epoch: 0|  Loss:  1.0988 |Global loss: 5.7105| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.8903
Epoch: 1|  Loss:  1.1065 |Global loss: 5.721| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.876
Epoch: 2|  Loss:  1.0941 |Global loss: 5.7245| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 3|  NKD Loss: 0.9019
Epoch: 3|  Loss:  1.1204 |Global loss: 5.7082| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 0.9319
Epoch: 0|  Loss:  1.2481 |Global loss: 5.7327| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9214
Epoch: 1|  Loss:  1.2495 |Global loss: 5.7384| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9482
Epoch: 2|  Loss:  1.2728 |Global loss: 5.7187| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9147
Epoch: 3|  Loss:  1.2373 |Global loss: 5.7429| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.9642
Epoch: 0|  Loss:  1.5078 |Global loss: 5.8049| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 1|  NKD Loss: 0.9683
Epoch: 1|  Loss:  1.5206 |Global loss: 5.813| Local H loss: 0.0465  | Global H loss: 0.0465
Epoch: 2|  NKD Loss: 0.9875
Epoch: 2|  Loss:  1.537 |Global loss: 5.7998| Local H loss: 0.0474  | Global H loss: 0.0474
Epoch: 3|  NKD Loss: 0.9785
Epoch: 3|  Loss:  1.5025 |Global loss: 5.7938| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 0|  NKD Loss: 0.9329
Epoch: 0|  Loss:  1.1801 |Global loss: 5.7265| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 1|  NKD Loss: 0.8988
Epoch: 1|  Loss:  1.1485 |Global loss: 5.7521| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9386
Epoch: 2|  Loss:  1.1708 |Global loss: 5.7262| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9037
Epoch: 3|  Loss:  1.1524 |Global loss: 5.7453| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.9241
Epoch: 0|  Loss:  1.19 |Global loss: 5.7293| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9191
Epoch: 1|  Loss:  1.1818 |Global loss: 5.7343| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9355
Epoch: 2|  Loss:  1.2077 |Global loss: 5.7284| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.8993
Epoch: 3|  Loss:  1.1595 |Global loss: 5.739| Local H loss: 0.0312  | Global H loss: 0.0312
------------------------- time cost ------------------------- 3.3480679988861084
Chosen Clients:  [3, 14, 6, 13, 2, 10]

-------------Round number: 476-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.538, 119.492, 118.802, 118.951, 118.105, 118.089, 118.34, 118.967, 119.255, 119.098, 118.502, 119.213, 117.048, 116.333, 119.367]
F1 Score:  [0.896, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1976
Averaged Test Accurancy: 0.9367
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9276
Averaged Test Recal score: 0.9433
Std Test Accurancy: 0.0642
Std Test AUC: 0.0074
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8788
Epoch: 0|  Loss:  1.1039 |Global loss: 5.7065| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.8715
Epoch: 1|  Loss:  1.0973 |Global loss: 5.7139| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.8737
Epoch: 2|  Loss:  1.0974 |Global loss: 5.7122| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 3|  NKD Loss: 0.8735
Epoch: 3|  Loss:  1.0971 |Global loss: 5.7084| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 0|  NKD Loss: 0.8904
Epoch: 0|  Loss:  1.1048 |Global loss: 5.7236| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 1|  NKD Loss: 0.905
Epoch: 1|  Loss:  1.1182 |Global loss: 5.7134| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9105
Epoch: 2|  Loss:  1.1157 |Global loss: 5.7119| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.8669
Epoch: 3|  Loss:  1.0813 |Global loss: 5.7325| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 0|  NKD Loss: 0.9358
Epoch: 0|  Loss:  1.2002 |Global loss: 5.7308| Local H loss: 0.0315  | Global H loss: 0.0315
Epoch: 1|  NKD Loss: 0.9281
Epoch: 1|  Loss:  1.1968 |Global loss: 5.7386| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9328
Epoch: 2|  Loss:  1.2052 |Global loss: 5.7288| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9277
Epoch: 3|  Loss:  1.1986 |Global loss: 5.7348| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9356
Epoch: 0|  Loss:  1.3577 |Global loss: 5.725| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.9227
Epoch: 1|  Loss:  1.3483 |Global loss: 5.7356| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9317
Epoch: 2|  Loss:  1.3505 |Global loss: 5.7325| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.9163
Epoch: 3|  Loss:  1.3397 |Global loss: 5.7385| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9578
Epoch: 0|  Loss:  1.2264 |Global loss: 5.7464| Local H loss: 0.0367  | Global H loss: 0.0367
Epoch: 1|  NKD Loss: 0.927
Epoch: 1|  Loss:  1.2031 |Global loss: 5.7648| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9398
Epoch: 2|  Loss:  1.2107 |Global loss: 5.7619| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9267
Epoch: 3|  Loss:  1.2053 |Global loss: 5.771| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8929
Epoch: 0|  Loss:  1.1222 |Global loss: 5.73| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.905
Epoch: 1|  Loss:  1.1296 |Global loss: 5.7232| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9111
Epoch: 2|  Loss:  1.1355 |Global loss: 5.715| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.8982
Epoch: 3|  Loss:  1.1251 |Global loss: 5.7255| Local H loss: 0.0357  | Global H loss: 0.0357
------------------------- time cost ------------------------- 2.9694371223449707
Chosen Clients:  [11, 14, 9, 1, 10, 5]

-------------Round number: 477-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.538, 119.492, 118.81, 118.952, 118.105, 118.089, 118.28, 118.967, 119.255, 119.098, 118.497, 119.213, 117.048, 116.284, 119.378]
F1 Score:  [0.896, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2022
Averaged Test Accurancy: 0.9372
Averaged Test AUC: 0.9872
Averaged Test F1_score: 0.9281
Averaged Test Recal score: 0.9437
Std Test Accurancy: 0.0643
Std Test AUC: 0.0075
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9066
Epoch: 0|  Loss:  1.1155 |Global loss: 5.701| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 1|  NKD Loss: 0.8749
Epoch: 1|  Loss:  1.0913 |Global loss: 5.7255| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 2|  NKD Loss: 0.868
Epoch: 2|  Loss:  1.0847 |Global loss: 5.7317| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1028 |Global loss: 5.6952| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.905
Epoch: 0|  Loss:  1.1104 |Global loss: 5.7184| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.1193 |Global loss: 5.7138| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.1244 |Global loss: 5.7119| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 3|  NKD Loss: 0.9089
Epoch: 3|  Loss:  1.117 |Global loss: 5.7086| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 0|  NKD Loss: 0.8812
Epoch: 0|  Loss:  1.0788 |Global loss: 5.6878| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8756
Epoch: 1|  Loss:  1.0723 |Global loss: 5.6924| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.8899
Epoch: 2|  Loss:  1.0866 |Global loss: 5.6879| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 3|  NKD Loss: 0.876
Epoch: 3|  Loss:  1.0727 |Global loss: 5.6923| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 0|  NKD Loss: 0.9241
Epoch: 0|  Loss:  1.1628 |Global loss: 5.7296| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9214
Epoch: 1|  Loss:  1.1597 |Global loss: 5.73| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9163
Epoch: 2|  Loss:  1.1627 |Global loss: 5.7376| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9023
Epoch: 3|  Loss:  1.1501 |Global loss: 5.7488| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 0|  NKD Loss: 0.8953
Epoch: 0|  Loss:  1.1182 |Global loss: 5.7242| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9045
Epoch: 1|  Loss:  1.1273 |Global loss: 5.7183| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.9179
Epoch: 2|  Loss:  1.1439 |Global loss: 5.7089| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.896
Epoch: 3|  Loss:  1.1157 |Global loss: 5.722| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9411
Epoch: 0|  Loss:  1.2743 |Global loss: 5.7639| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9078
Epoch: 1|  Loss:  1.2179 |Global loss: 5.7772| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9532
Epoch: 2|  Loss:  1.2772 |Global loss: 5.7568| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9473
Epoch: 3|  Loss:  1.2767 |Global loss: 5.761| Local H loss: 0.0267  | Global H loss: 0.0267
------------------------- time cost ------------------------- 3.3784704208374023
Chosen Clients:  [6, 13, 0, 9, 8, 2]

-------------Round number: 478-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.538, 119.518, 118.81, 118.952, 118.105, 118.135, 118.28, 118.967, 119.255, 119.095, 118.502, 119.214, 117.048, 116.284, 119.356]
F1 Score:  [0.896, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.916, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1990
Averaged Test Accurancy: 0.9372
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9281
Averaged Test Recal score: 0.9437
Std Test Accurancy: 0.0643
Std Test AUC: 0.0075
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9125
Epoch: 0|  Loss:  1.1829 |Global loss: 5.7438| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.933
Epoch: 1|  Loss:  1.2023 |Global loss: 5.7271| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9106
Epoch: 2|  Loss:  1.1834 |Global loss: 5.7424| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9118
Epoch: 3|  Loss:  1.1795 |Global loss: 5.7374| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9263
Epoch: 0|  Loss:  1.3513 |Global loss: 5.7333| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 0.9143
Epoch: 1|  Loss:  1.3484 |Global loss: 5.7421| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9131
Epoch: 2|  Loss:  1.3458 |Global loss: 5.7379| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9076
Epoch: 3|  Loss:  1.3348 |Global loss: 5.746| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9035
Epoch: 0|  Loss:  1.2304 |Global loss: 5.7467| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.2505 |Global loss: 5.7379| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.939
Epoch: 2|  Loss:  1.2624 |Global loss: 5.7266| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9198
Epoch: 3|  Loss:  1.247 |Global loss: 5.7416| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 0|  NKD Loss: 0.8654
Epoch: 0|  Loss:  1.0583 |Global loss: 5.6989| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.886
Epoch: 1|  Loss:  1.0678 |Global loss: 5.688| Local H loss: 0.0256  | Global H loss: 0.0256
Epoch: 2|  NKD Loss: 0.8621
Epoch: 2|  Loss:  1.058 |Global loss: 5.7095| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.8482
Epoch: 3|  Loss:  1.0449 |Global loss: 5.7109| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.877
Epoch: 0|  Loss:  1.0888 |Global loss: 5.7256| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 1|  NKD Loss: 0.9106
Epoch: 1|  Loss:  1.1215 |Global loss: 5.7048| Local H loss: 0.034  | Global H loss: 0.034
Epoch: 2|  NKD Loss: 0.8966
Epoch: 2|  Loss:  1.103 |Global loss: 5.714| Local H loss: 0.0336  | Global H loss: 0.0336
Epoch: 3|  NKD Loss: 0.8831
Epoch: 3|  Loss:  1.0955 |Global loss: 5.7207| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.937
Epoch: 0|  Loss:  1.2124 |Global loss: 5.7685| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 1|  NKD Loss: 0.906
Epoch: 1|  Loss:  1.1803 |Global loss: 5.7794| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9311
Epoch: 2|  Loss:  1.2043 |Global loss: 5.7594| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9223
Epoch: 3|  Loss:  1.1866 |Global loss: 5.7659| Local H loss: 0.036  | Global H loss: 0.036
------------------------- time cost ------------------------- 2.9514806270599365
Chosen Clients:  [6, 4, 13, 11, 9, 3]

-------------Round number: 479-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.526, 119.518, 118.865, 118.952, 118.105, 118.135, 118.343, 118.967, 119.248, 119.098, 118.502, 119.214, 117.048, 116.411, 119.356]
F1 Score:  [0.897, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.917, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1971
Averaged Test Accurancy: 0.9372
Averaged Test AUC: 0.9874
Averaged Test F1_score: 0.9282
Averaged Test Recal score: 0.9437
Std Test Accurancy: 0.0643
Std Test AUC: 0.0073
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9083
Epoch: 0|  Loss:  1.1768 |Global loss: 5.7397| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.1841 |Global loss: 5.7319| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9328
Epoch: 2|  Loss:  1.1981 |Global loss: 5.7267| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9175
Epoch: 3|  Loss:  1.1829 |Global loss: 5.7359| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9115
Epoch: 0|  Loss:  1.3206 |Global loss: 5.7066| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.8886
Epoch: 1|  Loss:  1.3104 |Global loss: 5.7242| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.9046
Epoch: 2|  Loss:  1.3282 |Global loss: 5.7076| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9121
Epoch: 3|  Loss:  1.3166 |Global loss: 5.6951| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 0|  NKD Loss: 0.929
Epoch: 0|  Loss:  1.3437 |Global loss: 5.7301| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 1|  NKD Loss: 0.9224
Epoch: 1|  Loss:  1.3489 |Global loss: 5.7374| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 2|  NKD Loss: 0.9363
Epoch: 2|  Loss:  1.3812 |Global loss: 5.7256| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.9091
Epoch: 3|  Loss:  1.3398 |Global loss: 5.7435| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.8951
Epoch: 0|  Loss:  1.1105 |Global loss: 5.7111| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 1|  NKD Loss: 0.8958
Epoch: 1|  Loss:  1.1118 |Global loss: 5.7189| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9077
Epoch: 2|  Loss:  1.1239 |Global loss: 5.7029| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 3|  NKD Loss: 0.88
Epoch: 3|  Loss:  1.0903 |Global loss: 5.7198| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 0.8739
Epoch: 0|  Loss:  1.0553 |Global loss: 5.6944| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 1|  NKD Loss: 0.8814
Epoch: 1|  Loss:  1.0779 |Global loss: 5.6891| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.889
Epoch: 2|  Loss:  1.0855 |Global loss: 5.6843| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.8695
Epoch: 3|  Loss:  1.0657 |Global loss: 5.6945| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 0|  NKD Loss: 0.8925
Epoch: 0|  Loss:  1.1141 |Global loss: 5.7026| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 1|  NKD Loss: 0.8787
Epoch: 1|  Loss:  1.1029 |Global loss: 5.7055| Local H loss: 0.0381  | Global H loss: 0.0381
Epoch: 2|  NKD Loss: 0.8661
Epoch: 2|  Loss:  1.0915 |Global loss: 5.7177| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.8877
Epoch: 3|  Loss:  1.1097 |Global loss: 5.7035| Local H loss: 0.0381  | Global H loss: 0.0381
------------------------- time cost ------------------------- 2.5560951232910156
Chosen Clients:  [11, 4, 12, 1, 2, 10]

-------------Round number: 480-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.526, 119.518, 118.865, 118.953, 118.11, 118.135, 118.364, 118.967, 119.248, 119.098, 118.502, 119.177, 117.048, 116.469, 119.356]
F1 Score:  [0.897, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.917, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1988
Averaged Test Accurancy: 0.9372
Averaged Test AUC: 0.9874
Averaged Test F1_score: 0.9282
Averaged Test Recal score: 0.9437
Std Test Accurancy: 0.0643
Std Test AUC: 0.0072
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9092
Epoch: 0|  Loss:  1.121 |Global loss: 5.6999| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.8903
Epoch: 1|  Loss:  1.1005 |Global loss: 5.7172| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 2|  NKD Loss: 0.9037
Epoch: 2|  Loss:  1.1147 |Global loss: 5.7077| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.8791
Epoch: 3|  Loss:  1.0852 |Global loss: 5.7158| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 0.9095
Epoch: 0|  Loss:  1.3217 |Global loss: 5.7107| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.9199
Epoch: 1|  Loss:  1.3497 |Global loss: 5.7038| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 0.9072
Epoch: 2|  Loss:  1.332 |Global loss: 5.7112| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9077
Epoch: 3|  Loss:  1.3264 |Global loss: 5.7081| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 0.9883
Epoch: 0|  Loss:  1.5303 |Global loss: 5.7931| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 1|  NKD Loss: 0.9802
Epoch: 1|  Loss:  1.5187 |Global loss: 5.7992| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 2|  NKD Loss: 0.9831
Epoch: 2|  Loss:  1.5157 |Global loss: 5.7945| Local H loss: 0.047  | Global H loss: 0.047
Epoch: 3|  NKD Loss: 0.9776
Epoch: 3|  Loss:  1.521 |Global loss: 5.8008| Local H loss: 0.0467  | Global H loss: 0.0467
Epoch: 0|  NKD Loss: 0.9199
Epoch: 0|  Loss:  1.1582 |Global loss: 5.7215| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 1|  NKD Loss: 0.9334
Epoch: 1|  Loss:  1.1786 |Global loss: 5.7222| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9384
Epoch: 2|  Loss:  1.1855 |Global loss: 5.7204| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 3|  NKD Loss: 0.9366
Epoch: 3|  Loss:  1.1813 |Global loss: 5.7223| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.9473
Epoch: 0|  Loss:  1.2124 |Global loss: 5.7564| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.9437
Epoch: 1|  Loss:  1.2186 |Global loss: 5.7589| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 2|  NKD Loss: 0.9215
Epoch: 2|  Loss:  1.1961 |Global loss: 5.7748| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9458
Epoch: 3|  Loss:  1.2215 |Global loss: 5.7533| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.881
Epoch: 0|  Loss:  1.1046 |Global loss: 5.7375| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9204
Epoch: 1|  Loss:  1.1438 |Global loss: 5.7104| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9127
Epoch: 2|  Loss:  1.1374 |Global loss: 5.7095| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.899
Epoch: 3|  Loss:  1.1206 |Global loss: 5.7248| Local H loss: 0.0363  | Global H loss: 0.0363
------------------------- time cost ------------------------- 2.6241044998168945
Chosen Clients:  [1, 7, 13, 2, 14, 9]

-------------Round number: 481-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.526, 119.523, 118.86, 118.953, 118.106, 118.135, 118.364, 118.967, 119.248, 119.098, 118.499, 119.216, 116.811, 116.469, 119.356]
F1 Score:  [0.897, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.691, 0.843, 0.971]
Recall Score:  [0.917, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.748, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2028
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9240
Averaged Test Recal score: 0.9401
Std Test Accurancy: 0.0765
Std Test AUC: 0.0074
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9249
Epoch: 0|  Loss:  1.1696 |Global loss: 5.7283| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9165
Epoch: 1|  Loss:  1.1474 |Global loss: 5.7309| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 2|  NKD Loss: 0.9161
Epoch: 2|  Loss:  1.1631 |Global loss: 5.7293| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9011
Epoch: 3|  Loss:  1.1275 |Global loss: 5.7303| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9065
Epoch: 0|  Loss:  1.1166 |Global loss: 5.7127| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.8956
Epoch: 1|  Loss:  1.1004 |Global loss: 5.7093| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.893
Epoch: 2|  Loss:  1.1058 |Global loss: 5.7224| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.8844
Epoch: 3|  Loss:  1.099 |Global loss: 5.73| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9239
Epoch: 0|  Loss:  1.3287 |Global loss: 5.741| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 1|  NKD Loss: 0.9066
Epoch: 1|  Loss:  1.3294 |Global loss: 5.7396| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.9371
Epoch: 2|  Loss:  1.3399 |Global loss: 5.7236| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.9245
Epoch: 3|  Loss:  1.3574 |Global loss: 5.7361| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.9503
Epoch: 0|  Loss:  1.2223 |Global loss: 5.7515| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9274
Epoch: 1|  Loss:  1.2032 |Global loss: 5.7625| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9404
Epoch: 2|  Loss:  1.2122 |Global loss: 5.7615| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.933
Epoch: 3|  Loss:  1.2055 |Global loss: 5.7633| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9129
Epoch: 0|  Loss:  1.125 |Global loss: 5.7085| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.8917
Epoch: 1|  Loss:  1.1034 |Global loss: 5.7193| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.8987
Epoch: 2|  Loss:  1.1123 |Global loss: 5.7219| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.9048
Epoch: 3|  Loss:  1.1122 |Global loss: 5.7149| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.8935
Epoch: 0|  Loss:  1.0767 |Global loss: 5.6779| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 1|  NKD Loss: 0.8696
Epoch: 1|  Loss:  1.0652 |Global loss: 5.7024| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.876
Epoch: 2|  Loss:  1.0713 |Global loss: 5.6893| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.8753
Epoch: 3|  Loss:  1.0676 |Global loss: 5.6868| Local H loss: 0.0253  | Global H loss: 0.0253
------------------------- time cost ------------------------- 2.651034355163574
Chosen Clients:  [7, 12, 9, 6, 13, 14]

-------------Round number: 482-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.708, 0.85, 0.975]
AUC in each clients:  [117.526, 119.528, 118.713, 118.953, 118.106, 118.135, 118.364, 118.975, 119.248, 119.096, 118.499, 119.216, 116.811, 116.435, 119.367]
F1 Score:  [0.897, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.691, 0.843, 0.971]
Recall Score:  [0.917, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.748, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2005
Averaged Test Accurancy: 0.9311
Averaged Test AUC: 0.9872
Averaged Test F1_score: 0.9225
Averaged Test Recal score: 0.9389
Std Test Accurancy: 0.0762
Std Test AUC: 0.0075
Std Test F1: 0.0007
Std Test Recall: 0.0006
Epoch: 0|  NKD Loss: 0.9129
Epoch: 0|  Loss:  1.1273 |Global loss: 5.7109| Local H loss: 0.0366  | Global H loss: 0.0366
Epoch: 1|  NKD Loss: 0.8953
Epoch: 1|  Loss:  1.0991 |Global loss: 5.7149| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.899
Epoch: 2|  Loss:  1.1129 |Global loss: 5.7182| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.898
Epoch: 3|  Loss:  1.113 |Global loss: 5.7167| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 0|  NKD Loss: 0.9557
Epoch: 0|  Loss:  1.5062 |Global loss: 5.8207| Local H loss: 0.0462  | Global H loss: 0.0462
Epoch: 1|  NKD Loss: 0.9495
Epoch: 1|  Loss:  1.4868 |Global loss: 5.8137| Local H loss: 0.0459  | Global H loss: 0.0459
Epoch: 2|  NKD Loss: 0.9866
Epoch: 2|  Loss:  1.5267 |Global loss: 5.8009| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 3|  NKD Loss: 0.9656
Epoch: 3|  Loss:  1.514 |Global loss: 5.8115| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 0|  NKD Loss: 0.8473
Epoch: 0|  Loss:  1.0434 |Global loss: 5.7054| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.882
Epoch: 1|  Loss:  1.0765 |Global loss: 5.6901| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 2|  NKD Loss: 0.8889
Epoch: 2|  Loss:  1.0843 |Global loss: 5.6847| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 3|  NKD Loss: 0.8949
Epoch: 3|  Loss:  1.0842 |Global loss: 5.6763| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 0|  NKD Loss: 0.9167
Epoch: 0|  Loss:  1.1782 |Global loss: 5.7361| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 1|  NKD Loss: 0.9389
Epoch: 1|  Loss:  1.2063 |Global loss: 5.7228| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9265
Epoch: 2|  Loss:  1.1919 |Global loss: 5.7349| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9328
Epoch: 3|  Loss:  1.1982 |Global loss: 5.7274| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.9288
Epoch: 0|  Loss:  1.3636 |Global loss: 5.7341| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.92
Epoch: 1|  Loss:  1.3399 |Global loss: 5.7324| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 2|  NKD Loss: 0.9165
Epoch: 2|  Loss:  1.3479 |Global loss: 5.7402| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9174
Epoch: 3|  Loss:  1.3437 |Global loss: 5.7409| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8928
Epoch: 0|  Loss:  1.1064 |Global loss: 5.7292| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.8847
Epoch: 1|  Loss:  1.0985 |Global loss: 5.7302| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.884
Epoch: 2|  Loss:  1.0971 |Global loss: 5.728| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 3|  NKD Loss: 0.8824
Epoch: 3|  Loss:  1.0923 |Global loss: 5.7217| Local H loss: 0.0266  | Global H loss: 0.0266
------------------------- time cost ------------------------- 2.596595048904419
Chosen Clients:  [0, 12, 8, 4, 6, 13]

-------------Round number: 483-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.892, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.526, 119.528, 118.713, 118.953, 118.106, 118.135, 118.336, 118.974, 119.248, 119.093, 118.499, 119.216, 116.967, 116.505, 119.359]
F1 Score:  [0.897, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.917, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1951
Averaged Test Accurancy: 0.9339
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9255
Averaged Test Recal score: 0.9412
Std Test Accurancy: 0.0684
Std Test AUC: 0.0072
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9334
Epoch: 0|  Loss:  1.2568 |Global loss: 5.7287| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.9265
Epoch: 1|  Loss:  1.2449 |Global loss: 5.7409| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9388
Epoch: 2|  Loss:  1.2586 |Global loss: 5.7277| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9285
Epoch: 3|  Loss:  1.2432 |Global loss: 5.7308| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 0|  NKD Loss: 0.9608
Epoch: 0|  Loss:  1.5083 |Global loss: 5.8125| Local H loss: 0.0464  | Global H loss: 0.0464
Epoch: 1|  NKD Loss: 0.9654
Epoch: 1|  Loss:  1.5051 |Global loss: 5.8096| Local H loss: 0.0466  | Global H loss: 0.0466
Epoch: 2|  NKD Loss: 0.9623
Epoch: 2|  Loss:  1.4887 |Global loss: 5.8101| Local H loss: 0.0468  | Global H loss: 0.0468
Epoch: 3|  NKD Loss: 0.9736
Epoch: 3|  Loss:  1.5009 |Global loss: 5.7988| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 0|  NKD Loss: 0.8896
Epoch: 0|  Loss:  1.0966 |Global loss: 5.7137| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.9037
Epoch: 1|  Loss:  1.1079 |Global loss: 5.7027| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.8782
Epoch: 2|  Loss:  1.0888 |Global loss: 5.7231| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.8707
Epoch: 3|  Loss:  1.0826 |Global loss: 5.7289| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 0|  NKD Loss: 0.906
Epoch: 0|  Loss:  1.3178 |Global loss: 5.7129| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 1|  NKD Loss: 0.9269
Epoch: 1|  Loss:  1.3284 |Global loss: 5.6977| Local H loss: 0.0223  | Global H loss: 0.0223
Epoch: 2|  NKD Loss: 0.9206
Epoch: 2|  Loss:  1.3559 |Global loss: 5.701| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 3|  NKD Loss: 0.9124
Epoch: 3|  Loss:  1.3316 |Global loss: 5.7054| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 0.9243
Epoch: 0|  Loss:  1.1948 |Global loss: 5.7328| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9172
Epoch: 1|  Loss:  1.1789 |Global loss: 5.7383| Local H loss: 0.0314  | Global H loss: 0.0314
Epoch: 2|  NKD Loss: 0.9247
Epoch: 2|  Loss:  1.1895 |Global loss: 5.73| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9046
Epoch: 3|  Loss:  1.1618 |Global loss: 5.7439| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.9161
Epoch: 0|  Loss:  1.3446 |Global loss: 5.7433| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.9205
Epoch: 1|  Loss:  1.3415 |Global loss: 5.73| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.9304
Epoch: 2|  Loss:  1.351 |Global loss: 5.7322| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 3|  NKD Loss: 0.9287
Epoch: 3|  Loss:  1.3579 |Global loss: 5.7264| Local H loss: 0.0323  | Global H loss: 0.0323
------------------------- time cost ------------------------- 2.7004997730255127
Chosen Clients:  [7, 10, 3, 4, 13, 14]

-------------Round number: 484-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [117.538, 119.528, 118.713, 118.953, 118.105, 118.135, 118.385, 118.974, 119.252, 119.093, 118.499, 119.216, 116.923, 116.533, 119.359]
F1 Score:  [0.903, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.718, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1962
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9873
Averaged Test F1_score: 0.9247
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0727
Std Test AUC: 0.0072
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8799
Epoch: 0|  Loss:  1.0831 |Global loss: 5.7295| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.8895
Epoch: 1|  Loss:  1.0925 |Global loss: 5.7174| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9064
Epoch: 2|  Loss:  1.1171 |Global loss: 5.7122| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.8915
Epoch: 3|  Loss:  1.1027 |Global loss: 5.7186| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9004
Epoch: 0|  Loss:  1.1285 |Global loss: 5.724| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8977
Epoch: 1|  Loss:  1.1196 |Global loss: 5.7207| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.906
Epoch: 2|  Loss:  1.1299 |Global loss: 5.7185| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.8861
Epoch: 3|  Loss:  1.1114 |Global loss: 5.7347| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.8799
Epoch: 0|  Loss:  1.1033 |Global loss: 5.7072| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 1|  NKD Loss: 0.8802
Epoch: 1|  Loss:  1.1013 |Global loss: 5.705| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.8875
Epoch: 2|  Loss:  1.1096 |Global loss: 5.7013| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 3|  NKD Loss: 0.8884
Epoch: 3|  Loss:  1.1092 |Global loss: 5.6965| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.9132
Epoch: 0|  Loss:  1.3211 |Global loss: 5.702| Local H loss: 0.0222  | Global H loss: 0.0222
Epoch: 1|  NKD Loss: 0.9105
Epoch: 1|  Loss:  1.3298 |Global loss: 5.7077| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.9083
Epoch: 2|  Loss:  1.333 |Global loss: 5.7107| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9147
Epoch: 3|  Loss:  1.3375 |Global loss: 5.7019| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 0.9081
Epoch: 0|  Loss:  1.3356 |Global loss: 5.7438| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.937
Epoch: 1|  Loss:  1.3461 |Global loss: 5.7256| Local H loss: 0.0326  | Global H loss: 0.0326
Epoch: 2|  NKD Loss: 0.9375
Epoch: 2|  Loss:  1.3648 |Global loss: 5.7261| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.927
Epoch: 3|  Loss:  1.349 |Global loss: 5.7245| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.9131
Epoch: 0|  Loss:  1.1261 |Global loss: 5.7075| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.9133
Epoch: 1|  Loss:  1.1248 |Global loss: 5.7056| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.8853
Epoch: 2|  Loss:  1.098 |Global loss: 5.7276| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9053
Epoch: 3|  Loss:  1.1173 |Global loss: 5.7165| Local H loss: 0.0265  | Global H loss: 0.0265
------------------------- time cost ------------------------- 2.5963125228881836
Chosen Clients:  [4, 14, 9, 13, 7, 12]

-------------Round number: 485-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.725, 0.85, 0.975]
AUC in each clients:  [117.538, 119.528, 118.713, 118.955, 118.107, 118.135, 118.385, 118.977, 119.252, 119.093, 118.497, 119.216, 116.923, 116.586, 119.368]
F1 Score:  [0.903, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.718, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.763, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1993
Averaged Test Accurancy: 0.9328
Averaged Test AUC: 0.9874
Averaged Test F1_score: 0.9247
Averaged Test Recal score: 0.9403
Std Test Accurancy: 0.0727
Std Test AUC: 0.0072
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.904
Epoch: 0|  Loss:  1.3289 |Global loss: 5.7119| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.9057
Epoch: 1|  Loss:  1.3314 |Global loss: 5.7086| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.9052
Epoch: 2|  Loss:  1.3171 |Global loss: 5.7101| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.8918
Epoch: 3|  Loss:  1.2978 |Global loss: 5.7123| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 0.9083
Epoch: 0|  Loss:  1.1213 |Global loss: 5.7153| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9
Epoch: 1|  Loss:  1.1127 |Global loss: 5.7187| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 2|  NKD Loss: 0.9039
Epoch: 2|  Loss:  1.1142 |Global loss: 5.7041| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.9065
Epoch: 3|  Loss:  1.1184 |Global loss: 5.7164| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.8762
Epoch: 0|  Loss:  1.0717 |Global loss: 5.6863| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.8911
Epoch: 1|  Loss:  1.0855 |Global loss: 5.6805| Local H loss: 0.0254  | Global H loss: 0.0254
Epoch: 2|  NKD Loss: 0.8848
Epoch: 2|  Loss:  1.0788 |Global loss: 5.6863| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.8711
Epoch: 3|  Loss:  1.0665 |Global loss: 5.6874| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 0|  NKD Loss: 0.9226
Epoch: 0|  Loss:  1.3515 |Global loss: 5.7304| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.9231
Epoch: 1|  Loss:  1.3537 |Global loss: 5.7257| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.9175
Epoch: 2|  Loss:  1.3435 |Global loss: 5.7321| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.905
Epoch: 3|  Loss:  1.3281 |Global loss: 5.7441| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 0|  NKD Loss: 0.8925
Epoch: 0|  Loss:  1.105 |Global loss: 5.7104| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.8946
Epoch: 1|  Loss:  1.1069 |Global loss: 5.7197| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.8929
Epoch: 2|  Loss:  1.106 |Global loss: 5.719| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.8931
Epoch: 3|  Loss:  1.1028 |Global loss: 5.7175| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.9962
Epoch: 0|  Loss:  1.5158 |Global loss: 5.7751| Local H loss: 0.0474  | Global H loss: 0.0474
Epoch: 1|  NKD Loss: 0.9667
Epoch: 1|  Loss:  1.4953 |Global loss: 5.8035| Local H loss: 0.0463  | Global H loss: 0.0463
Epoch: 2|  NKD Loss: 0.973
Epoch: 2|  Loss:  1.5067 |Global loss: 5.8038| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 3|  NKD Loss: 0.9702
Epoch: 3|  Loss:  1.4937 |Global loss: 5.803| Local H loss: 0.0468  | Global H loss: 0.0468
------------------------- time cost ------------------------- 2.734123468399048
Chosen Clients:  [8, 7, 12, 11, 5, 14]

-------------Round number: 486-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.538, 119.528, 118.713, 118.955, 118.11, 118.135, 118.385, 118.958, 119.252, 119.094, 118.497, 119.216, 117.067, 116.646, 119.371]
F1 Score:  [0.903, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2018
Averaged Test Accurancy: 0.9361
Averaged Test AUC: 0.9875
Averaged Test F1_score: 0.9271
Averaged Test Recal score: 0.9430
Std Test Accurancy: 0.0637
Std Test AUC: 0.0069
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8865
Epoch: 0|  Loss:  1.0951 |Global loss: 5.7132| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.8832
Epoch: 1|  Loss:  1.081 |Global loss: 5.7151| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 2|  NKD Loss: 0.8678
Epoch: 2|  Loss:  1.0774 |Global loss: 5.7325| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.908
Epoch: 3|  Loss:  1.1138 |Global loss: 5.7051| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.8935
Epoch: 0|  Loss:  1.1078 |Global loss: 5.7154| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.8876
Epoch: 1|  Loss:  1.0994 |Global loss: 5.7209| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 2|  NKD Loss: 0.8994
Epoch: 2|  Loss:  1.112 |Global loss: 5.7116| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.913
Epoch: 3|  Loss:  1.1254 |Global loss: 5.7098| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9867
Epoch: 0|  Loss:  1.5145 |Global loss: 5.7891| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 1|  NKD Loss: 0.9856
Epoch: 1|  Loss:  1.5237 |Global loss: 5.7874| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 2|  NKD Loss: 0.9838
Epoch: 2|  Loss:  1.5168 |Global loss: 5.7928| Local H loss: 0.0474  | Global H loss: 0.0474
Epoch: 3|  NKD Loss: 0.9826
Epoch: 3|  Loss:  1.507 |Global loss: 5.7894| Local H loss: 0.0472  | Global H loss: 0.0472
Epoch: 0|  NKD Loss: 0.8804
Epoch: 0|  Loss:  1.0952 |Global loss: 5.7087| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 1|  NKD Loss: 0.913
Epoch: 1|  Loss:  1.1264 |Global loss: 5.7054| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.9107
Epoch: 2|  Loss:  1.126 |Global loss: 5.6967| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.9044
Epoch: 3|  Loss:  1.1171 |Global loss: 5.7023| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 0|  NKD Loss: 0.9592
Epoch: 0|  Loss:  1.2823 |Global loss: 5.7516| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9617
Epoch: 1|  Loss:  1.2817 |Global loss: 5.7425| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9562
Epoch: 2|  Loss:  1.2691 |Global loss: 5.7556| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9387
Epoch: 3|  Loss:  1.2689 |Global loss: 5.7616| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.9084
Epoch: 0|  Loss:  1.121 |Global loss: 5.7118| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.9083
Epoch: 1|  Loss:  1.12 |Global loss: 5.7128| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.9067
Epoch: 2|  Loss:  1.1189 |Global loss: 5.7083| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 3|  NKD Loss: 0.906
Epoch: 3|  Loss:  1.1179 |Global loss: 5.7139| Local H loss: 0.0265  | Global H loss: 0.0265
------------------------- time cost ------------------------- 2.545868396759033
Chosen Clients:  [14, 6, 10, 2, 1, 3]

-------------Round number: 487-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.933, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.783, 0.85, 0.975]
AUC in each clients:  [117.538, 119.528, 118.713, 118.955, 118.11, 118.145, 118.385, 118.977, 119.252, 119.094, 118.497, 119.211, 117.204, 116.646, 119.377]
F1 Score:  [0.903, 0.971, 0.932, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.759, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.949, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.81, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.2014
Averaged Test Accurancy: 0.9367
Averaged Test AUC: 0.9876
Averaged Test F1_score: 0.9274
Averaged Test Recal score: 0.9435
Std Test Accurancy: 0.0623
Std Test AUC: 0.0068
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8973
Epoch: 0|  Loss:  1.1026 |Global loss: 5.7178| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 1|  NKD Loss: 0.8986
Epoch: 1|  Loss:  1.1107 |Global loss: 5.7158| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9044
Epoch: 2|  Loss:  1.11 |Global loss: 5.708| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8977
Epoch: 3|  Loss:  1.109 |Global loss: 5.7188| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9255
Epoch: 0|  Loss:  1.1925 |Global loss: 5.7301| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.1818 |Global loss: 5.7295| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9182
Epoch: 2|  Loss:  1.183 |Global loss: 5.7319| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9118
Epoch: 3|  Loss:  1.1786 |Global loss: 5.7386| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 0|  NKD Loss: 0.912
Epoch: 0|  Loss:  1.134 |Global loss: 5.713| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9128
Epoch: 1|  Loss:  1.1389 |Global loss: 5.7123| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.8987
Epoch: 2|  Loss:  1.1252 |Global loss: 5.7222| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.8782
Epoch: 3|  Loss:  1.1019 |Global loss: 5.7379| Local H loss: 0.0351  | Global H loss: 0.0351
Epoch: 0|  NKD Loss: 0.9423
Epoch: 0|  Loss:  1.2152 |Global loss: 5.7512| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.942
Epoch: 1|  Loss:  1.2159 |Global loss: 5.7552| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9306
Epoch: 2|  Loss:  1.1978 |Global loss: 5.7556| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9168
Epoch: 3|  Loss:  1.1834 |Global loss: 5.7716| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9117
Epoch: 0|  Loss:  1.1561 |Global loss: 5.7278| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9115
Epoch: 1|  Loss:  1.1554 |Global loss: 5.731| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 2|  NKD Loss: 0.9154
Epoch: 2|  Loss:  1.1566 |Global loss: 5.7316| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.9088
Epoch: 3|  Loss:  1.1518 |Global loss: 5.7361| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.8789
Epoch: 0|  Loss:  1.1029 |Global loss: 5.7071| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 1|  NKD Loss: 0.8797
Epoch: 1|  Loss:  1.1016 |Global loss: 5.7044| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.8752
Epoch: 2|  Loss:  1.085 |Global loss: 5.7063| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.8947
Epoch: 3|  Loss:  1.118 |Global loss: 5.6889| Local H loss: 0.0379  | Global H loss: 0.0379
------------------------- time cost ------------------------- 2.9795079231262207
Chosen Clients:  [10, 9, 1, 13, 8, 14]

-------------Round number: 488-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.783, 0.85, 0.975]
AUC in each clients:  [117.538, 119.539, 118.862, 118.96, 118.11, 118.145, 118.448, 118.977, 119.252, 119.094, 118.505, 119.211, 117.204, 116.646, 119.373]
F1 Score:  [0.903, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.759, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.81, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1951
Averaged Test Accurancy: 0.9378
Averaged Test AUC: 0.9877
Averaged Test F1_score: 0.9284
Averaged Test Recal score: 0.9442
Std Test Accurancy: 0.0624
Std Test AUC: 0.0069
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9184
Epoch: 0|  Loss:  1.1424 |Global loss: 5.7071| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.8983
Epoch: 1|  Loss:  1.1253 |Global loss: 5.7252| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.8908
Epoch: 2|  Loss:  1.1153 |Global loss: 5.7297| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.8844
Epoch: 3|  Loss:  1.1092 |Global loss: 5.7315| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.8671
Epoch: 0|  Loss:  1.0627 |Global loss: 5.6956| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.893
Epoch: 1|  Loss:  1.0738 |Global loss: 5.6757| Local H loss: 0.0255  | Global H loss: 0.0255
Epoch: 2|  NKD Loss: 0.8807
Epoch: 2|  Loss:  1.0707 |Global loss: 5.6875| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 3|  NKD Loss: 0.8813
Epoch: 3|  Loss:  1.0708 |Global loss: 5.6844| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.9233
Epoch: 0|  Loss:  1.1681 |Global loss: 5.7288| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.915
Epoch: 1|  Loss:  1.1405 |Global loss: 5.7296| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9142
Epoch: 2|  Loss:  1.1589 |Global loss: 5.7312| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 3|  NKD Loss: 0.921
Epoch: 3|  Loss:  1.163 |Global loss: 5.7294| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9247
Epoch: 0|  Loss:  1.3547 |Global loss: 5.7389| Local H loss: 0.0319  | Global H loss: 0.0319
Epoch: 1|  NKD Loss: 0.9012
Epoch: 1|  Loss:  1.3232 |Global loss: 5.7477| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 2|  NKD Loss: 0.9281
Epoch: 2|  Loss:  1.3377 |Global loss: 5.7276| Local H loss: 0.0324  | Global H loss: 0.0324
Epoch: 3|  NKD Loss: 0.9079
Epoch: 3|  Loss:  1.3269 |Global loss: 5.7385| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.8799
Epoch: 0|  Loss:  1.079 |Global loss: 5.7186| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 1|  NKD Loss: 0.8984
Epoch: 1|  Loss:  1.107 |Global loss: 5.7135| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 2|  NKD Loss: 0.8979
Epoch: 2|  Loss:  1.1081 |Global loss: 5.7083| Local H loss: 0.0334  | Global H loss: 0.0334
Epoch: 3|  NKD Loss: 0.8924
Epoch: 3|  Loss:  1.1007 |Global loss: 5.7183| Local H loss: 0.0335  | Global H loss: 0.0335
Epoch: 0|  NKD Loss: 0.8897
Epoch: 0|  Loss:  1.0973 |Global loss: 5.7205| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.9104
Epoch: 1|  Loss:  1.1192 |Global loss: 5.7086| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.9029
Epoch: 2|  Loss:  1.1144 |Global loss: 5.7124| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 3|  NKD Loss: 0.8766
Epoch: 3|  Loss:  1.0865 |Global loss: 5.7309| Local H loss: 0.0262  | Global H loss: 0.0262
------------------------- time cost ------------------------- 2.778074264526367
Chosen Clients:  [12, 11, 10, 13, 6, 2]

-------------Round number: 489-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.783, 0.85, 0.975]
AUC in each clients:  [117.538, 119.534, 118.862, 118.96, 118.11, 118.145, 118.448, 118.977, 119.246, 119.094, 118.505, 119.211, 117.204, 116.596, 119.372]
F1 Score:  [0.903, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.759, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.81, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1943
Averaged Test Accurancy: 0.9378
Averaged Test AUC: 0.9877
Averaged Test F1_score: 0.9284
Averaged Test Recal score: 0.9442
Std Test Accurancy: 0.0624
Std Test AUC: 0.0069
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.998
Epoch: 0|  Loss:  1.5244 |Global loss: 5.781| Local H loss: 0.0476  | Global H loss: 0.0476
Epoch: 1|  NKD Loss: 0.9656
Epoch: 1|  Loss:  1.4871 |Global loss: 5.7994| Local H loss: 0.0471  | Global H loss: 0.0471
Epoch: 2|  NKD Loss: 0.9864
Epoch: 2|  Loss:  1.5042 |Global loss: 5.7873| Local H loss: 0.0478  | Global H loss: 0.0478
Epoch: 3|  NKD Loss: 0.972
Epoch: 3|  Loss:  1.4999 |Global loss: 5.7905| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 0|  NKD Loss: 0.8815
Epoch: 0|  Loss:  1.098 |Global loss: 5.7187| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.9005
Epoch: 1|  Loss:  1.1095 |Global loss: 5.7099| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 2|  NKD Loss: 0.8953
Epoch: 2|  Loss:  1.1072 |Global loss: 5.7136| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.8951
Epoch: 3|  Loss:  1.1117 |Global loss: 5.7145| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 0|  NKD Loss: 0.8916
Epoch: 0|  Loss:  1.1171 |Global loss: 5.7293| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 1|  NKD Loss: 0.898
Epoch: 1|  Loss:  1.1211 |Global loss: 5.7215| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.8881
Epoch: 2|  Loss:  1.1082 |Global loss: 5.7266| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9025
Epoch: 3|  Loss:  1.1212 |Global loss: 5.7141| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 0|  NKD Loss: 0.9038
Epoch: 0|  Loss:  1.3303 |Global loss: 5.7387| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 1|  NKD Loss: 0.9161
Epoch: 1|  Loss:  1.3378 |Global loss: 5.7419| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.9152
Epoch: 2|  Loss:  1.3204 |Global loss: 5.7372| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.9073
Epoch: 3|  Loss:  1.326 |Global loss: 5.7417| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 0|  NKD Loss: 0.9335
Epoch: 0|  Loss:  1.1962 |Global loss: 5.7269| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9168
Epoch: 1|  Loss:  1.181 |Global loss: 5.7323| Local H loss: 0.031  | Global H loss: 0.031
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.1885 |Global loss: 5.7316| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9182
Epoch: 3|  Loss:  1.1712 |Global loss: 5.7368| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 0|  NKD Loss: 0.9287
Epoch: 0|  Loss:  1.1976 |Global loss: 5.7634| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9463
Epoch: 1|  Loss:  1.213 |Global loss: 5.7485| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9354
Epoch: 2|  Loss:  1.1963 |Global loss: 5.7496| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 3|  NKD Loss: 0.937
Epoch: 3|  Loss:  1.2056 |Global loss: 5.7588| Local H loss: 0.0363  | Global H loss: 0.0363
------------------------- time cost ------------------------- 2.665900707244873
Chosen Clients:  [5, 14, 8, 4, 7, 1]

-------------Round number: 490-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.538, 119.534, 118.877, 118.96, 118.11, 118.145, 118.443, 118.977, 119.246, 119.094, 118.508, 119.196, 117.041, 116.639, 119.372]
F1 Score:  [0.903, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1931
Averaged Test Accurancy: 0.9350
Averaged Test AUC: 0.9876
Averaged Test F1_score: 0.9264
Averaged Test Recal score: 0.9419
Std Test Accurancy: 0.0714
Std Test AUC: 0.0070
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9547
Epoch: 0|  Loss:  1.2773 |Global loss: 5.7556| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9485
Epoch: 1|  Loss:  1.2563 |Global loss: 5.7487| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 2|  NKD Loss: 0.9678
Epoch: 2|  Loss:  1.2765 |Global loss: 5.7461| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 3|  NKD Loss: 0.944
Epoch: 3|  Loss:  1.2664 |Global loss: 5.7604| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.8895
Epoch: 0|  Loss:  1.0911 |Global loss: 5.7178| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.9024
Epoch: 1|  Loss:  1.1064 |Global loss: 5.7122| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 2|  NKD Loss: 0.9022
Epoch: 2|  Loss:  1.1031 |Global loss: 5.7151| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9022
Epoch: 3|  Loss:  1.1115 |Global loss: 5.7114| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.8385
Epoch: 0|  Loss:  1.0507 |Global loss: 5.7384| Local H loss: 0.0325  | Global H loss: 0.0325
Epoch: 1|  NKD Loss: 0.8835
Epoch: 1|  Loss:  1.0931 |Global loss: 5.7194| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.8905
Epoch: 2|  Loss:  1.0999 |Global loss: 5.7147| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.8969
Epoch: 3|  Loss:  1.1064 |Global loss: 5.7052| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 0|  NKD Loss: 0.9206
Epoch: 0|  Loss:  1.3424 |Global loss: 5.7018| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.9004
Epoch: 1|  Loss:  1.3164 |Global loss: 5.7082| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.8957
Epoch: 2|  Loss:  1.3126 |Global loss: 5.7184| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9153
Epoch: 3|  Loss:  1.3442 |Global loss: 5.7061| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 0.9053
Epoch: 0|  Loss:  1.1156 |Global loss: 5.7133| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.8827
Epoch: 1|  Loss:  1.0967 |Global loss: 5.725| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.8834
Epoch: 2|  Loss:  1.0941 |Global loss: 5.7217| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.8827
Epoch: 3|  Loss:  1.0942 |Global loss: 5.7226| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 0|  NKD Loss: 0.9154
Epoch: 0|  Loss:  1.1592 |Global loss: 5.734| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 1|  NKD Loss: 0.9072
Epoch: 1|  Loss:  1.1512 |Global loss: 5.7368| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9267
Epoch: 2|  Loss:  1.1702 |Global loss: 5.7208| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.912
Epoch: 3|  Loss:  1.1461 |Global loss: 5.7339| Local H loss: 0.0272  | Global H loss: 0.0272
------------------------- time cost ------------------------- 2.5391979217529297
Chosen Clients:  [10, 1, 5, 2, 4, 7]

-------------Round number: 491-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.538, 119.539, 118.877, 118.96, 118.104, 118.15, 118.443, 118.977, 119.245, 119.094, 118.508, 119.196, 117.041, 116.639, 119.376]
F1 Score:  [0.903, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1973
Averaged Test Accurancy: 0.9350
Averaged Test AUC: 0.9876
Averaged Test F1_score: 0.9264
Averaged Test Recal score: 0.9419
Std Test Accurancy: 0.0714
Std Test AUC: 0.0070
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8896
Epoch: 0|  Loss:  1.1096 |Global loss: 5.7289| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.8894
Epoch: 1|  Loss:  1.1149 |Global loss: 5.7272| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 2|  NKD Loss: 0.8838
Epoch: 2|  Loss:  1.1061 |Global loss: 5.7364| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9024
Epoch: 3|  Loss:  1.1239 |Global loss: 5.7131| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9145
Epoch: 0|  Loss:  1.155 |Global loss: 5.7332| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9266
Epoch: 1|  Loss:  1.1669 |Global loss: 5.7204| Local H loss: 0.0275  | Global H loss: 0.0275
Epoch: 2|  NKD Loss: 0.9203
Epoch: 2|  Loss:  1.1571 |Global loss: 5.7284| Local H loss: 0.0276  | Global H loss: 0.0276
Epoch: 3|  NKD Loss: 0.9192
Epoch: 3|  Loss:  1.154 |Global loss: 5.73| Local H loss: 0.0273  | Global H loss: 0.0273
Epoch: 0|  NKD Loss: 0.9542
Epoch: 0|  Loss:  1.2817 |Global loss: 5.7519| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9255
Epoch: 1|  Loss:  1.2509 |Global loss: 5.7718| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 2|  NKD Loss: 0.9334
Epoch: 2|  Loss:  1.2496 |Global loss: 5.7642| Local H loss: 0.027  | Global H loss: 0.027
Epoch: 3|  NKD Loss: 0.9518
Epoch: 3|  Loss:  1.2751 |Global loss: 5.754| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 0|  NKD Loss: 0.9403
Epoch: 0|  Loss:  1.2108 |Global loss: 5.7534| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 1|  NKD Loss: 0.9323
Epoch: 1|  Loss:  1.2007 |Global loss: 5.7581| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9232
Epoch: 2|  Loss:  1.1958 |Global loss: 5.7648| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9228
Epoch: 3|  Loss:  1.1914 |Global loss: 5.7696| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9055
Epoch: 0|  Loss:  1.3172 |Global loss: 5.708| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.9067
Epoch: 1|  Loss:  1.3136 |Global loss: 5.704| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.9044
Epoch: 2|  Loss:  1.327 |Global loss: 5.7053| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 0.9073
Epoch: 3|  Loss:  1.3341 |Global loss: 5.7104| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 0.8974
Epoch: 0|  Loss:  1.1088 |Global loss: 5.7164| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.8708
Epoch: 1|  Loss:  1.0813 |Global loss: 5.7347| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 2|  NKD Loss: 0.8831
Epoch: 2|  Loss:  1.095 |Global loss: 5.7212| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.87
Epoch: 3|  Loss:  1.0812 |Global loss: 5.731| Local H loss: 0.0354  | Global H loss: 0.0354
------------------------- time cost ------------------------- 2.626490831375122
Chosen Clients:  [7, 8, 3, 14, 13, 6]

-------------Round number: 492-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.538, 119.555, 118.894, 118.96, 118.105, 118.155, 118.443, 118.975, 119.245, 119.094, 118.507, 119.196, 117.041, 116.639, 119.376]
F1 Score:  [0.903, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1946
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9876
Averaged Test F1_score: 0.9259
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0713
Std Test AUC: 0.0070
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8658
Epoch: 0|  Loss:  1.0671 |Global loss: 5.7329| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 1|  NKD Loss: 0.9065
Epoch: 1|  Loss:  1.104 |Global loss: 5.7022| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.903
Epoch: 2|  Loss:  1.1115 |Global loss: 5.7105| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.8696
Epoch: 3|  Loss:  1.0813 |Global loss: 5.7388| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.8782
Epoch: 0|  Loss:  1.0761 |Global loss: 5.7164| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 1|  NKD Loss: 0.8827
Epoch: 1|  Loss:  1.0915 |Global loss: 5.7155| Local H loss: 0.033  | Global H loss: 0.033
Epoch: 2|  NKD Loss: 0.8695
Epoch: 2|  Loss:  1.0802 |Global loss: 5.7255| Local H loss: 0.0331  | Global H loss: 0.0331
Epoch: 3|  NKD Loss: 0.8905
Epoch: 3|  Loss:  1.0979 |Global loss: 5.714| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 0|  NKD Loss: 0.857
Epoch: 0|  Loss:  1.0806 |Global loss: 5.7197| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 1|  NKD Loss: 0.8927
Epoch: 1|  Loss:  1.1162 |Global loss: 5.6979| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.8574
Epoch: 2|  Loss:  1.0762 |Global loss: 5.7178| Local H loss: 0.0375  | Global H loss: 0.0375
Epoch: 3|  NKD Loss: 0.8734
Epoch: 3|  Loss:  1.0941 |Global loss: 5.7098| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 0|  NKD Loss: 0.9025
Epoch: 0|  Loss:  1.103 |Global loss: 5.7111| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 1|  NKD Loss: 0.8952
Epoch: 1|  Loss:  1.1042 |Global loss: 5.7174| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.895
Epoch: 2|  Loss:  1.102 |Global loss: 5.7164| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9093
Epoch: 3|  Loss:  1.1189 |Global loss: 5.7086| Local H loss: 0.0266  | Global H loss: 0.0266
Epoch: 0|  NKD Loss: 0.9337
Epoch: 0|  Loss:  1.3443 |Global loss: 5.728| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 1|  NKD Loss: 0.933
Epoch: 1|  Loss:  1.3409 |Global loss: 5.7304| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 2|  NKD Loss: 0.9315
Epoch: 2|  Loss:  1.3383 |Global loss: 5.7197| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 3|  NKD Loss: 0.9144
Epoch: 3|  Loss:  1.3228 |Global loss: 5.7365| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 0|  NKD Loss: 0.913
Epoch: 0|  Loss:  1.1681 |Global loss: 5.7307| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 1|  NKD Loss: 0.9214
Epoch: 1|  Loss:  1.1701 |Global loss: 5.7293| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 2|  NKD Loss: 0.9232
Epoch: 2|  Loss:  1.188 |Global loss: 5.7256| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9185
Epoch: 3|  Loss:  1.1794 |Global loss: 5.72| Local H loss: 0.0312  | Global H loss: 0.0312
------------------------- time cost ------------------------- 2.787954807281494
Chosen Clients:  [6, 4, 0, 9, 2, 5]

-------------Round number: 493-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.9, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.538, 119.555, 118.894, 118.958, 118.105, 118.155, 118.491, 118.976, 119.247, 119.094, 118.507, 119.196, 117.041, 116.612, 119.378]
F1 Score:  [0.903, 0.971, 0.947, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.923, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1871
Averaged Test Accurancy: 0.9344
Averaged Test AUC: 0.9876
Averaged Test F1_score: 0.9259
Averaged Test Recal score: 0.9415
Std Test Accurancy: 0.0713
Std Test AUC: 0.0071
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9109
Epoch: 0|  Loss:  1.1756 |Global loss: 5.7259| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9234
Epoch: 1|  Loss:  1.1851 |Global loss: 5.729| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 2|  NKD Loss: 0.9315
Epoch: 2|  Loss:  1.1906 |Global loss: 5.7198| Local H loss: 0.0313  | Global H loss: 0.0313
Epoch: 3|  NKD Loss: 0.9179
Epoch: 3|  Loss:  1.182 |Global loss: 5.7338| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 0|  NKD Loss: 0.8943
Epoch: 0|  Loss:  1.3109 |Global loss: 5.7213| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.9155
Epoch: 1|  Loss:  1.3278 |Global loss: 5.7068| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.3357 |Global loss: 5.7028| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 3|  NKD Loss: 0.9302
Epoch: 3|  Loss:  1.334 |Global loss: 5.686| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 0|  NKD Loss: 0.9393
Epoch: 0|  Loss:  1.258 |Global loss: 5.7277| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 1|  NKD Loss: 0.9329
Epoch: 1|  Loss:  1.2537 |Global loss: 5.7268| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9362
Epoch: 2|  Loss:  1.252 |Global loss: 5.7315| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.9275
Epoch: 3|  Loss:  1.2551 |Global loss: 5.7344| Local H loss: 0.0246  | Global H loss: 0.0246
Epoch: 0|  NKD Loss: 0.8816
Epoch: 0|  Loss:  1.0751 |Global loss: 5.6919| Local H loss: 0.0253  | Global H loss: 0.0253
Epoch: 1|  NKD Loss: 0.8815
Epoch: 1|  Loss:  1.0761 |Global loss: 5.6873| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 2|  NKD Loss: 0.8751
Epoch: 2|  Loss:  1.0688 |Global loss: 5.6895| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 3|  NKD Loss: 0.8763
Epoch: 3|  Loss:  1.0708 |Global loss: 5.6895| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.9466
Epoch: 0|  Loss:  1.212 |Global loss: 5.7458| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.9394
Epoch: 1|  Loss:  1.2109 |Global loss: 5.7567| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 2|  NKD Loss: 0.9317
Epoch: 2|  Loss:  1.1971 |Global loss: 5.7663| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 3|  NKD Loss: 0.9148
Epoch: 3|  Loss:  1.1812 |Global loss: 5.767| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.955
Epoch: 0|  Loss:  1.2804 |Global loss: 5.7526| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 1|  NKD Loss: 0.9414
Epoch: 1|  Loss:  1.2672 |Global loss: 5.7665| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9581
Epoch: 2|  Loss:  1.2784 |Global loss: 5.7456| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9369
Epoch: 3|  Loss:  1.2516 |Global loss: 5.7592| Local H loss: 0.0268  | Global H loss: 0.0268
------------------------- time cost ------------------------- 2.5437827110290527
Chosen Clients:  [2, 7, 13, 3, 10, 4]

-------------Round number: 494-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.908, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.608, 119.555, 118.953, 118.958, 118.105, 118.162, 118.495, 118.976, 119.247, 119.092, 118.507, 119.196, 117.041, 116.612, 119.378]
F1 Score:  [0.909, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.927, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1941
Averaged Test Accurancy: 0.9356
Averaged Test AUC: 0.9877
Averaged Test F1_score: 0.9268
Averaged Test Recal score: 0.9421
Std Test Accurancy: 0.0712
Std Test AUC: 0.0070
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.921
Epoch: 0|  Loss:  1.1882 |Global loss: 5.765| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9327
Epoch: 1|  Loss:  1.1924 |Global loss: 5.7454| Local H loss: 0.0364  | Global H loss: 0.0364
Epoch: 2|  NKD Loss: 0.9044
Epoch: 2|  Loss:  1.1712 |Global loss: 5.7779| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9479
Epoch: 3|  Loss:  1.2036 |Global loss: 5.7415| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 0|  NKD Loss: 0.8849
Epoch: 0|  Loss:  1.0955 |Global loss: 5.7281| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.9034
Epoch: 1|  Loss:  1.1136 |Global loss: 5.7082| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.8976
Epoch: 2|  Loss:  1.1056 |Global loss: 5.7119| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 3|  NKD Loss: 0.8964
Epoch: 3|  Loss:  1.1072 |Global loss: 5.7132| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.9338
Epoch: 0|  Loss:  1.3348 |Global loss: 5.7237| Local H loss: 0.0323  | Global H loss: 0.0323
Epoch: 1|  NKD Loss: 0.9265
Epoch: 1|  Loss:  1.3308 |Global loss: 5.7311| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 2|  NKD Loss: 0.9058
Epoch: 2|  Loss:  1.3072 |Global loss: 5.7417| Local H loss: 0.032  | Global H loss: 0.032
Epoch: 3|  NKD Loss: 0.9223
Epoch: 3|  Loss:  1.3427 |Global loss: 5.7331| Local H loss: 0.0322  | Global H loss: 0.0322
Epoch: 0|  NKD Loss: 0.8725
Epoch: 0|  Loss:  1.0951 |Global loss: 5.7124| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8917
Epoch: 1|  Loss:  1.1129 |Global loss: 5.6964| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 2|  NKD Loss: 0.8864
Epoch: 2|  Loss:  1.1037 |Global loss: 5.7003| Local H loss: 0.0379  | Global H loss: 0.0379
Epoch: 3|  NKD Loss: 0.8942
Epoch: 3|  Loss:  1.1098 |Global loss: 5.6939| Local H loss: 0.038  | Global H loss: 0.038
Epoch: 0|  NKD Loss: 0.8717
Epoch: 0|  Loss:  1.0972 |Global loss: 5.7392| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 1|  NKD Loss: 0.9039
Epoch: 1|  Loss:  1.1256 |Global loss: 5.7128| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 2|  NKD Loss: 0.8951
Epoch: 2|  Loss:  1.1175 |Global loss: 5.7181| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 3|  NKD Loss: 0.9038
Epoch: 3|  Loss:  1.1274 |Global loss: 5.7132| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 0|  NKD Loss: 0.9055
Epoch: 0|  Loss:  1.315 |Global loss: 5.7058| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 1|  NKD Loss: 0.914
Epoch: 1|  Loss:  1.3155 |Global loss: 5.7013| Local H loss: 0.0221  | Global H loss: 0.0221
Epoch: 2|  NKD Loss: 0.918
Epoch: 2|  Loss:  1.3389 |Global loss: 5.7005| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 3|  NKD Loss: 0.9101
Epoch: 3|  Loss:  1.3332 |Global loss: 5.6957| Local H loss: 0.0219  | Global H loss: 0.0219
------------------------- time cost ------------------------- 2.6176764965057373
Chosen Clients:  [2, 4, 13, 12, 11, 0]

-------------Round number: 495-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.908, 0.975, 0.958, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.733, 0.85, 0.975]
AUC in each clients:  [117.608, 119.555, 118.945, 118.959, 118.108, 118.162, 118.495, 118.978, 119.247, 119.092, 118.519, 119.196, 117.041, 116.617, 119.378]
F1 Score:  [0.909, 0.971, 0.955, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.721, 0.843, 0.971]
Recall Score:  [0.927, 0.977, 0.966, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.769, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1945
Averaged Test Accurancy: 0.9356
Averaged Test AUC: 0.9877
Averaged Test F1_score: 0.9268
Averaged Test Recal score: 0.9421
Std Test Accurancy: 0.0712
Std Test AUC: 0.0070
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9236
Epoch: 0|  Loss:  1.1869 |Global loss: 5.7556| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 1|  NKD Loss: 0.9395
Epoch: 1|  Loss:  1.2029 |Global loss: 5.7508| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9097
Epoch: 2|  Loss:  1.177 |Global loss: 5.7721| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9413
Epoch: 3|  Loss:  1.2066 |Global loss: 5.7492| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.9093
Epoch: 0|  Loss:  1.336 |Global loss: 5.7065| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 1|  NKD Loss: 0.917
Epoch: 1|  Loss:  1.3342 |Global loss: 5.6982| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 2|  NKD Loss: 0.8887
Epoch: 2|  Loss:  1.3119 |Global loss: 5.7138| Local H loss: 0.0217  | Global H loss: 0.0217
Epoch: 3|  NKD Loss: 0.9117
Epoch: 3|  Loss:  1.3223 |Global loss: 5.7002| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 0|  NKD Loss: 0.9187
Epoch: 0|  Loss:  1.3338 |Global loss: 5.7277| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 1|  NKD Loss: 0.9081
Epoch: 1|  Loss:  1.3213 |Global loss: 5.7399| Local H loss: 0.0318  | Global H loss: 0.0318
Epoch: 2|  NKD Loss: 0.9282
Epoch: 2|  Loss:  1.3306 |Global loss: 5.7241| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.9271
Epoch: 3|  Loss:  1.363 |Global loss: 5.7199| Local H loss: 0.0317  | Global H loss: 0.0317
Epoch: 0|  NKD Loss: 0.9939
Epoch: 0|  Loss:  1.503 |Global loss: 5.7776| Local H loss: 0.0478  | Global H loss: 0.0478
Epoch: 1|  NKD Loss: 0.9765
Epoch: 1|  Loss:  1.4927 |Global loss: 5.797| Local H loss: 0.0474  | Global H loss: 0.0474
Epoch: 2|  NKD Loss: 0.9918
Epoch: 2|  Loss:  1.5061 |Global loss: 5.7837| Local H loss: 0.0478  | Global H loss: 0.0478
Epoch: 3|  NKD Loss: 0.9616
Epoch: 3|  Loss:  1.4873 |Global loss: 5.8063| Local H loss: 0.0469  | Global H loss: 0.0469
Epoch: 0|  NKD Loss: 0.9163
Epoch: 0|  Loss:  1.1326 |Global loss: 5.6961| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 1|  NKD Loss: 0.9097
Epoch: 1|  Loss:  1.1257 |Global loss: 5.6988| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9022
Epoch: 2|  Loss:  1.111 |Global loss: 5.7045| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.9024
Epoch: 3|  Loss:  1.1168 |Global loss: 5.703| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 0|  NKD Loss: 0.9186
Epoch: 0|  Loss:  1.2357 |Global loss: 5.7342| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 1|  NKD Loss: 0.9286
Epoch: 1|  Loss:  1.2437 |Global loss: 5.7347| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 2|  NKD Loss: 0.9356
Epoch: 2|  Loss:  1.2471 |Global loss: 5.7303| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 3|  NKD Loss: 0.9282
Epoch: 3|  Loss:  1.2471 |Global loss: 5.7318| Local H loss: 0.0248  | Global H loss: 0.0248
------------------------- time cost ------------------------- 2.5664329528808594
Chosen Clients:  [7, 11, 10, 5, 3, 9]

-------------Round number: 496-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.967, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.513, 119.555, 118.99, 118.959, 118.105, 118.162, 118.495, 118.978, 119.247, 119.092, 118.519, 119.225, 117.187, 116.692, 119.378]
F1 Score:  [0.883, 0.971, 0.964, 0.982, 0.761, 0.964, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.971, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1987
Averaged Test Accurancy: 0.9350
Averaged Test AUC: 0.9878
Averaged Test F1_score: 0.9267
Averaged Test Recal score: 0.9419
Std Test Accurancy: 0.0697
Std Test AUC: 0.0069
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8849
Epoch: 0|  Loss:  1.0943 |Global loss: 5.72| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.8709
Epoch: 1|  Loss:  1.0823 |Global loss: 5.732| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.9047
Epoch: 2|  Loss:  1.1091 |Global loss: 5.7099| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.89
Epoch: 3|  Loss:  1.1001 |Global loss: 5.7174| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.8717
Epoch: 0|  Loss:  1.083 |Global loss: 5.7186| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 1|  NKD Loss: 0.9076
Epoch: 1|  Loss:  1.1084 |Global loss: 5.7023| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 2|  NKD Loss: 0.9154
Epoch: 2|  Loss:  1.1237 |Global loss: 5.6962| Local H loss: 0.0244  | Global H loss: 0.0244
Epoch: 3|  NKD Loss: 0.8956
Epoch: 3|  Loss:  1.11 |Global loss: 5.7083| Local H loss: 0.0242  | Global H loss: 0.0242
Epoch: 0|  NKD Loss: 0.8927
Epoch: 0|  Loss:  1.1159 |Global loss: 5.7286| Local H loss: 0.0358  | Global H loss: 0.0358
Epoch: 1|  NKD Loss: 0.9051
Epoch: 1|  Loss:  1.1283 |Global loss: 5.7168| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9114
Epoch: 2|  Loss:  1.1347 |Global loss: 5.7106| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 3|  NKD Loss: 0.9044
Epoch: 3|  Loss:  1.1266 |Global loss: 5.7166| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 0|  NKD Loss: 0.9271
Epoch: 0|  Loss:  1.2472 |Global loss: 5.7649| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9545
Epoch: 1|  Loss:  1.2743 |Global loss: 5.7522| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.953
Epoch: 2|  Loss:  1.2734 |Global loss: 5.7531| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9315
Epoch: 3|  Loss:  1.2557 |Global loss: 5.7647| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 0|  NKD Loss: 0.8712
Epoch: 0|  Loss:  1.0879 |Global loss: 5.7044| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 1|  NKD Loss: 0.9007
Epoch: 1|  Loss:  1.1215 |Global loss: 5.688| Local H loss: 0.0377  | Global H loss: 0.0377
Epoch: 2|  NKD Loss: 0.8807
Epoch: 2|  Loss:  1.0894 |Global loss: 5.7043| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 3|  NKD Loss: 0.8942
Epoch: 3|  Loss:  1.1133 |Global loss: 5.6998| Local H loss: 0.0382  | Global H loss: 0.0382
Epoch: 0|  NKD Loss: 0.8684
Epoch: 0|  Loss:  1.0623 |Global loss: 5.6926| Local H loss: 0.0251  | Global H loss: 0.0251
Epoch: 1|  NKD Loss: 0.8764
Epoch: 1|  Loss:  1.0555 |Global loss: 5.6927| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.8761
Epoch: 2|  Loss:  1.0702 |Global loss: 5.6852| Local H loss: 0.025  | Global H loss: 0.025
Epoch: 3|  NKD Loss: 0.8632
Epoch: 3|  Loss:  1.0569 |Global loss: 5.6972| Local H loss: 0.025  | Global H loss: 0.025
------------------------- time cost ------------------------- 2.529468536376953
Chosen Clients:  [2, 7, 1, 14, 12, 6]

-------------Round number: 497-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.967, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.75, 0.85, 0.975]
AUC in each clients:  [117.513, 119.555, 118.99, 118.961, 118.105, 118.2, 118.495, 118.98, 119.247, 119.092, 118.516, 119.23, 117.187, 116.692, 119.378]
F1 Score:  [0.883, 0.971, 0.964, 0.982, 0.761, 0.963, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.736, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.971, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.782, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1946
Averaged Test Accurancy: 0.9350
Averaged Test AUC: 0.9879
Averaged Test F1_score: 0.9266
Averaged Test Recal score: 0.9419
Std Test Accurancy: 0.0697
Std Test AUC: 0.0069
Std Test F1: 0.0007
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9328
Epoch: 0|  Loss:  1.1994 |Global loss: 5.7535| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.9178
Epoch: 1|  Loss:  1.1828 |Global loss: 5.7604| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.9238
Epoch: 2|  Loss:  1.1905 |Global loss: 5.7612| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 3|  NKD Loss: 0.9432
Epoch: 3|  Loss:  1.2092 |Global loss: 5.749| Local H loss: 0.0362  | Global H loss: 0.0362
Epoch: 0|  NKD Loss: 0.8904
Epoch: 0|  Loss:  1.0995 |Global loss: 5.7117| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 1|  NKD Loss: 0.9036
Epoch: 1|  Loss:  1.1125 |Global loss: 5.7047| Local H loss: 0.0356  | Global H loss: 0.0356
Epoch: 2|  NKD Loss: 0.8759
Epoch: 2|  Loss:  1.0845 |Global loss: 5.721| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 3|  NKD Loss: 0.897
Epoch: 3|  Loss:  1.1046 |Global loss: 5.7121| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 0|  NKD Loss: 0.9289
Epoch: 0|  Loss:  1.1668 |Global loss: 5.7158| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9147
Epoch: 1|  Loss:  1.1556 |Global loss: 5.724| Local H loss: 0.0271  | Global H loss: 0.0271
Epoch: 2|  NKD Loss: 0.9139
Epoch: 2|  Loss:  1.1564 |Global loss: 5.7294| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9268
Epoch: 3|  Loss:  1.1681 |Global loss: 5.7154| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 0|  NKD Loss: 0.8994
Epoch: 0|  Loss:  1.1097 |Global loss: 5.7117| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 1|  NKD Loss: 0.8915
Epoch: 1|  Loss:  1.101 |Global loss: 5.7163| Local H loss: 0.0263  | Global H loss: 0.0263
Epoch: 2|  NKD Loss: 0.9108
Epoch: 2|  Loss:  1.1208 |Global loss: 5.7015| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.9038
Epoch: 3|  Loss:  1.1037 |Global loss: 5.71| Local H loss: 0.0265  | Global H loss: 0.0265
Epoch: 0|  NKD Loss: 0.9938
Epoch: 0|  Loss:  1.5242 |Global loss: 5.7877| Local H loss: 0.0475  | Global H loss: 0.0475
Epoch: 1|  NKD Loss: 0.9821
Epoch: 1|  Loss:  1.5078 |Global loss: 5.7885| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 2|  NKD Loss: 0.979
Epoch: 2|  Loss:  1.4986 |Global loss: 5.8025| Local H loss: 0.0473  | Global H loss: 0.0473
Epoch: 3|  NKD Loss: 0.9866
Epoch: 3|  Loss:  1.5122 |Global loss: 5.7873| Local H loss: 0.0475  | Global H loss: 0.0475
Epoch: 0|  NKD Loss: 0.9174
Epoch: 0|  Loss:  1.1832 |Global loss: 5.7325| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 1|  NKD Loss: 0.9196
Epoch: 1|  Loss:  1.1824 |Global loss: 5.7318| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9033
Epoch: 2|  Loss:  1.1534 |Global loss: 5.7411| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9259
Epoch: 3|  Loss:  1.1875 |Global loss: 5.7292| Local H loss: 0.031  | Global H loss: 0.031
------------------------- time cost ------------------------- 2.5615806579589844
Chosen Clients:  [6, 7, 2, 0, 13, 8]

-------------Round number: 498-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.875, 0.975, 0.95, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.513, 119.536, 118.927, 118.961, 118.105, 118.2, 118.469, 118.979, 119.247, 119.092, 118.516, 119.23, 117.239, 116.692, 119.389]
F1 Score:  [0.883, 0.971, 0.947, 0.982, 0.761, 0.963, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.905, 0.977, 0.96, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1901
Averaged Test Accurancy: 0.9356
Averaged Test AUC: 0.9878
Averaged Test F1_score: 0.9267
Averaged Test Recal score: 0.9425
Std Test Accurancy: 0.0651
Std Test AUC: 0.0068
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9075
Epoch: 0|  Loss:  1.1721 |Global loss: 5.7387| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 1|  NKD Loss: 0.9089
Epoch: 1|  Loss:  1.1726 |Global loss: 5.7391| Local H loss: 0.0309  | Global H loss: 0.0309
Epoch: 2|  NKD Loss: 0.899
Epoch: 2|  Loss:  1.1583 |Global loss: 5.7417| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 3|  NKD Loss: 0.9196
Epoch: 3|  Loss:  1.1718 |Global loss: 5.7234| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.883
Epoch: 0|  Loss:  1.0905 |Global loss: 5.7246| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.9048
Epoch: 1|  Loss:  1.1043 |Global loss: 5.6991| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 2|  NKD Loss: 0.8882
Epoch: 2|  Loss:  1.0843 |Global loss: 5.7163| Local H loss: 0.0357  | Global H loss: 0.0357
Epoch: 3|  NKD Loss: 0.8874
Epoch: 3|  Loss:  1.0969 |Global loss: 5.7169| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9287
Epoch: 0|  Loss:  1.1863 |Global loss: 5.7524| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 1|  NKD Loss: 0.9301
Epoch: 1|  Loss:  1.1941 |Global loss: 5.7557| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 2|  NKD Loss: 0.9285
Epoch: 2|  Loss:  1.1939 |Global loss: 5.7554| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 3|  NKD Loss: 0.9395
Epoch: 3|  Loss:  1.2027 |Global loss: 5.7443| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 0|  NKD Loss: 0.9393
Epoch: 0|  Loss:  1.2636 |Global loss: 5.7219| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 1|  NKD Loss: 0.9251
Epoch: 1|  Loss:  1.2362 |Global loss: 5.7336| Local H loss: 0.0248  | Global H loss: 0.0248
Epoch: 2|  NKD Loss: 0.9211
Epoch: 2|  Loss:  1.2343 |Global loss: 5.7264| Local H loss: 0.0247  | Global H loss: 0.0247
Epoch: 3|  NKD Loss: 0.9406
Epoch: 3|  Loss:  1.2554 |Global loss: 5.7246| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 0|  NKD Loss: 0.8931
Epoch: 0|  Loss:  1.3089 |Global loss: 5.7549| Local H loss: 0.0316  | Global H loss: 0.0316
Epoch: 1|  NKD Loss: 0.9321
Epoch: 1|  Loss:  1.351 |Global loss: 5.7191| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 2|  NKD Loss: 0.9289
Epoch: 2|  Loss:  1.346 |Global loss: 5.7249| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 3|  NKD Loss: 0.928
Epoch: 3|  Loss:  1.3421 |Global loss: 5.7262| Local H loss: 0.0321  | Global H loss: 0.0321
Epoch: 0|  NKD Loss: 0.8972
Epoch: 0|  Loss:  1.1042 |Global loss: 5.713| Local H loss: 0.0327  | Global H loss: 0.0327
Epoch: 1|  NKD Loss: 0.8963
Epoch: 1|  Loss:  1.1054 |Global loss: 5.7087| Local H loss: 0.0332  | Global H loss: 0.0332
Epoch: 2|  NKD Loss: 0.8896
Epoch: 2|  Loss:  1.0997 |Global loss: 5.7132| Local H loss: 0.0333  | Global H loss: 0.0333
Epoch: 3|  NKD Loss: 0.9035
Epoch: 3|  Loss:  1.1146 |Global loss: 5.7055| Local H loss: 0.0331  | Global H loss: 0.0331
------------------------- time cost ------------------------- 2.630478620529175
Chosen Clients:  [14, 7, 11, 3, 4, 10]

-------------Round number: 499-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.975, 0.975, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.619, 119.536, 119.022, 118.961, 118.105, 118.2, 118.573, 118.981, 119.25, 119.092, 118.516, 119.23, 117.239, 116.679, 119.389]
F1 Score:  [0.916, 0.971, 0.973, 0.982, 0.761, 0.963, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.934, 0.977, 0.977, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1925
Averaged Test Accurancy: 0.9400
Averaged Test AUC: 0.9880
Averaged Test F1_score: 0.9306
Averaged Test Recal score: 0.9456
Std Test Accurancy: 0.0639
Std Test AUC: 0.0068
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.8835
Epoch: 0|  Loss:  1.0943 |Global loss: 5.726| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 1|  NKD Loss: 0.9091
Epoch: 1|  Loss:  1.1063 |Global loss: 5.7038| Local H loss: 0.0267  | Global H loss: 0.0267
Epoch: 2|  NKD Loss: 0.8938
Epoch: 2|  Loss:  1.0966 |Global loss: 5.7121| Local H loss: 0.0264  | Global H loss: 0.0264
Epoch: 3|  NKD Loss: 0.8813
Epoch: 3|  Loss:  1.0887 |Global loss: 5.7249| Local H loss: 0.0262  | Global H loss: 0.0262
Epoch: 0|  NKD Loss: 0.8813
Epoch: 0|  Loss:  1.0903 |Global loss: 5.7196| Local H loss: 0.0352  | Global H loss: 0.0352
Epoch: 1|  NKD Loss: 0.8886
Epoch: 1|  Loss:  1.0974 |Global loss: 5.7177| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.8944
Epoch: 2|  Loss:  1.0992 |Global loss: 5.7141| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.8935
Epoch: 3|  Loss:  1.1009 |Global loss: 5.7125| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.883
Epoch: 0|  Loss:  1.0816 |Global loss: 5.7098| Local H loss: 0.0243  | Global H loss: 0.0243
Epoch: 1|  NKD Loss: 0.8752
Epoch: 1|  Loss:  1.0886 |Global loss: 5.7292| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 2|  NKD Loss: 0.8942
Epoch: 2|  Loss:  1.0905 |Global loss: 5.7119| Local H loss: 0.0245  | Global H loss: 0.0245
Epoch: 3|  NKD Loss: 0.8798
Epoch: 3|  Loss:  1.0962 |Global loss: 5.7169| Local H loss: 0.0241  | Global H loss: 0.0241
Epoch: 0|  NKD Loss: 0.857
Epoch: 0|  Loss:  1.0771 |Global loss: 5.7183| Local H loss: 0.0373  | Global H loss: 0.0373
Epoch: 1|  NKD Loss: 0.8714
Epoch: 1|  Loss:  1.0923 |Global loss: 5.7074| Local H loss: 0.0378  | Global H loss: 0.0378
Epoch: 2|  NKD Loss: 0.8865
Epoch: 2|  Loss:  1.1076 |Global loss: 5.6975| Local H loss: 0.0374  | Global H loss: 0.0374
Epoch: 3|  NKD Loss: 0.867
Epoch: 3|  Loss:  1.0882 |Global loss: 5.7117| Local H loss: 0.0372  | Global H loss: 0.0372
Epoch: 0|  NKD Loss: 0.9136
Epoch: 0|  Loss:  1.3326 |Global loss: 5.7067| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 1|  NKD Loss: 0.9014
Epoch: 1|  Loss:  1.3175 |Global loss: 5.712| Local H loss: 0.0219  | Global H loss: 0.0219
Epoch: 2|  NKD Loss: 0.8909
Epoch: 2|  Loss:  1.3115 |Global loss: 5.7148| Local H loss: 0.0218  | Global H loss: 0.0218
Epoch: 3|  NKD Loss: 0.9109
Epoch: 3|  Loss:  1.3212 |Global loss: 5.7001| Local H loss: 0.022  | Global H loss: 0.022
Epoch: 0|  NKD Loss: 0.9029
Epoch: 0|  Loss:  1.1224 |Global loss: 5.7176| Local H loss: 0.036  | Global H loss: 0.036
Epoch: 1|  NKD Loss: 0.883
Epoch: 1|  Loss:  1.1067 |Global loss: 5.7289| Local H loss: 0.0353  | Global H loss: 0.0353
Epoch: 2|  NKD Loss: 0.8698
Epoch: 2|  Loss:  1.093 |Global loss: 5.7433| Local H loss: 0.0354  | Global H loss: 0.0354
Epoch: 3|  NKD Loss: 0.8882
Epoch: 3|  Loss:  1.1051 |Global loss: 5.7256| Local H loss: 0.0356  | Global H loss: 0.0356
------------------------- time cost ------------------------- 2.7617039680480957
Chosen Clients:  [2, 9, 1, 6, 10, 5]

-------------Round number: 500-------------

Evaluate personalized models
Client ID:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
Accuracy in each clients:  [0.917, 0.975, 0.975, 0.983, 0.833, 0.967, 0.975, 0.975, 0.975, 0.983, 0.958, 0.983, 0.775, 0.85, 0.975]
AUC in each clients:  [117.619, 119.536, 119.022, 118.96, 118.102, 118.2, 118.573, 118.983, 119.25, 119.092, 118.505, 119.229, 117.239, 116.679, 119.386]
F1 Score:  [0.916, 0.971, 0.973, 0.982, 0.761, 0.963, 0.974, 0.971, 0.97, 0.981, 0.949, 0.98, 0.754, 0.843, 0.971]
Recall Score:  [0.934, 0.977, 0.977, 0.986, 0.81, 0.971, 0.977, 0.977, 0.977, 0.984, 0.956, 0.984, 0.803, 0.894, 0.977]
Number of sample in client:  [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]
Averaged Train Loss: 1.1876
Averaged Test Accurancy: 0.9400
Averaged Test AUC: 0.9880
Averaged Test F1_score: 0.9306
Averaged Test Recal score: 0.9456
Std Test Accurancy: 0.0639
Std Test AUC: 0.0068
Std Test F1: 0.0006
Std Test Recall: 0.0005
Epoch: 0|  NKD Loss: 0.9458
Epoch: 0|  Loss:  1.2051 |Global loss: 5.7418| Local H loss: 0.0365  | Global H loss: 0.0365
Epoch: 1|  NKD Loss: 0.927
Epoch: 1|  Loss:  1.177 |Global loss: 5.7471| Local H loss: 0.0363  | Global H loss: 0.0363
Epoch: 2|  NKD Loss: 0.9212
Epoch: 2|  Loss:  1.1845 |Global loss: 5.7571| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 3|  NKD Loss: 0.9339
Epoch: 3|  Loss:  1.1994 |Global loss: 5.7506| Local H loss: 0.0361  | Global H loss: 0.0361
Epoch: 0|  NKD Loss: 0.8478
Epoch: 0|  Loss:  1.0415 |Global loss: 5.7102| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 1|  NKD Loss: 0.8819
Epoch: 1|  Loss:  1.0607 |Global loss: 5.6842| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 2|  NKD Loss: 0.8689
Epoch: 2|  Loss:  1.063 |Global loss: 5.6925| Local H loss: 0.0249  | Global H loss: 0.0249
Epoch: 3|  NKD Loss: 0.8832
Epoch: 3|  Loss:  1.0768 |Global loss: 5.6852| Local H loss: 0.0252  | Global H loss: 0.0252
Epoch: 0|  NKD Loss: 0.9266
Epoch: 0|  Loss:  1.142 |Global loss: 5.7177| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 1|  NKD Loss: 0.9044
Epoch: 1|  Loss:  1.1418 |Global loss: 5.7284| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 2|  NKD Loss: 0.9129
Epoch: 2|  Loss:  1.151 |Global loss: 5.7246| Local H loss: 0.0272  | Global H loss: 0.0272
Epoch: 3|  NKD Loss: 0.9193
Epoch: 3|  Loss:  1.1561 |Global loss: 5.7251| Local H loss: 0.0274  | Global H loss: 0.0274
Epoch: 0|  NKD Loss: 0.8958
Epoch: 0|  Loss:  1.1572 |Global loss: 5.7418| Local H loss: 0.0307  | Global H loss: 0.0307
Epoch: 1|  NKD Loss: 0.9163
Epoch: 1|  Loss:  1.1621 |Global loss: 5.7296| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 2|  NKD Loss: 0.9229
Epoch: 2|  Loss:  1.1802 |Global loss: 5.7235| Local H loss: 0.0312  | Global H loss: 0.0312
Epoch: 3|  NKD Loss: 0.9034
Epoch: 3|  Loss:  1.1648 |Global loss: 5.7423| Local H loss: 0.0311  | Global H loss: 0.0311
Epoch: 0|  NKD Loss: 0.8767
Epoch: 0|  Loss:  1.097 |Global loss: 5.7306| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 1|  NKD Loss: 0.8911
Epoch: 1|  Loss:  1.115 |Global loss: 5.7321| Local H loss: 0.0359  | Global H loss: 0.0359
Epoch: 2|  NKD Loss: 0.8831
Epoch: 2|  Loss:  1.1053 |Global loss: 5.7325| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 3|  NKD Loss: 0.8906
Epoch: 3|  Loss:  1.1127 |Global loss: 5.7286| Local H loss: 0.0355  | Global H loss: 0.0355
Epoch: 0|  NKD Loss: 0.9548
Epoch: 0|  Loss:  1.2754 |Global loss: 5.7502| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 1|  NKD Loss: 0.9518
Epoch: 1|  Loss:  1.2715 |Global loss: 5.7518| Local H loss: 0.0268  | Global H loss: 0.0268
Epoch: 2|  NKD Loss: 0.9245
Epoch: 2|  Loss:  1.233 |Global loss: 5.7584| Local H loss: 0.0269  | Global H loss: 0.0269
Epoch: 3|  NKD Loss: 0.9529
Epoch: 3|  Loss:  1.2728 |Global loss: 5.754| Local H loss: 0.0269  | Global H loss: 0.0269
------------------------- time cost ------------------------- 2.6048152446746826

Best accuracy.
0.94

Average time cost per round.
2.98406635761261
File path: ../results/SLEEP_FedKD_test_0.h5
All Client results path:  ../results/SLEEP_FedKD_test_0_all_resuls_0.9_64_500_15_2024_12_31_17_45.pkl

Average time cost: 1498.16s.
Length:  501
std for best accurancy: 0.0
mean for best accurancy: 0.94
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 135548740 	Used Memory: 345.34M
The allocated memory on cuda:0: 369.79M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 7380 	Used Memory: 45.00K
-------------------------------------------------------------------------------
